Rank =    0  Free Memory = 89897 MB
Rank =    1  Free Memory = 89897 MB
Rank =    2  Free Memory = 89897 MB
Rank =    3  Free Memory = 89897 MB
Rank =    4  Free Memory = 89897 MB
Rank =    5  Free Memory = 89897 MB
Rank =    6  Free Memory = 89897 MB
Rank =    7  Free Memory = 89897 MB
Rank =    8  Free Memory = 89897 MB
Rank =    9  Free Memory = 89897 MB
Rank =   10  Free Memory = 89897 MB
Rank =   11  Free Memory = 89897 MB
Rank =   12  Free Memory = 89897 MB
Rank =   13  Free Memory = 89897 MB
Rank =   14  Free Memory = 89896 MB
Rank =   15  Free Memory = 89884 MB
Rank =   16  Free Memory = 89884 MB
Rank =   17  Free Memory = 89884 MB
Rank =   18  Free Memory = 89884 MB
Rank =   19  Free Memory = 89884 MB
Rank =   20  Free Memory = 89884 MB
Rank =   21  Free Memory = 89884 MB
Rank =   22  Free Memory = 89884 MB
Rank =   23  Free Memory = 89884 MB
Rank =   24  Free Memory = 89884 MB
Rank =   25  Free Memory = 89884 MB
Rank =   26  Free Memory = 89884 MB
Rank =   27  Free Memory = 89884 MB
Rank =   28  Free Memory = 89884 MB
Rank =   29  Free Memory = 89884 MB
Rank =   30  Free Memory = 89884 MB
Rank =   31  Free Memory = 89884 MB
Rank =   32  Free Memory = 90535 MB
Rank =   33  Free Memory = 90535 MB
Rank =   34  Free Memory = 90535 MB
Rank =   35  Free Memory = 90535 MB
Rank =   36  Free Memory = 90535 MB
Rank =   37  Free Memory = 90534 MB
Rank =   38  Free Memory = 90534 MB
Rank =   39  Free Memory = 90534 MB
Rank =   40  Free Memory = 90534 MB
Rank =   41  Free Memory = 90534 MB
Rank =   42  Free Memory = 90534 MB
Rank =   43  Free Memory = 90534 MB
Rank =   44  Free Memory = 90534 MB
Rank =   45  Free Memory = 90534 MB
Rank =   46  Free Memory = 90534 MB
Rank =   47  Free Memory = 90534 MB
Rank =   48  Free Memory = 90534 MB
Rank =   49  Free Memory = 90534 MB
Rank =   50  Free Memory = 90534 MB
Rank =   51  Free Memory = 90534 MB
Rank =   52  Free Memory = 90534 MB
Rank =   53  Free Memory = 90534 MB
Rank =   54  Free Memory = 90534 MB
Rank =   55  Free Memory = 90534 MB
Rank =   56  Free Memory = 90534 MB
Rank =   57  Free Memory = 90534 MB
Rank =   58  Free Memory = 90534 MB
Rank =   59  Free Memory = 90534 MB
Rank =   60  Free Memory = 90534 MB
Rank =   61  Free Memory = 90534 MB
Rank =   62  Free Memory = 90533 MB
Rank =   63  Free Memory = 90533 MB
Rank =   64  Free Memory = 89003 MB
Rank =   65  Free Memory = 89003 MB
Rank =   66  Free Memory = 89003 MB
Rank =   67  Free Memory = 89003 MB
Rank =   68  Free Memory = 89003 MB
Rank =   69  Free Memory = 89003 MB
Rank =   70  Free Memory = 89003 MB
Rank =   71  Free Memory = 89003 MB
Rank =   72  Free Memory = 89003 MB
Rank =   73  Free Memory = 89003 MB
Rank =   74  Free Memory = 89003 MB
Rank =   75  Free Memory = 89003 MB
Rank =   76  Free Memory = 89003 MB
Rank =   77  Free Memory = 89003 MB
Rank =   78  Free Memory = 89003 MB
Rank =   79  Free Memory = 89003 MB
Rank =   80  Free Memory = 89003 MB
Rank =   81  Free Memory = 89003 MB
Rank =   82  Free Memory = 89003 MB
Rank =   83  Free Memory = 89003 MB
Rank =   84  Free Memory = 89003 MB
Rank =   85  Free Memory = 89003 MB
Rank =   86  Free Memory = 89003 MB
Rank =   87  Free Memory = 89003 MB
Rank =   88  Free Memory = 89003 MB
Rank =   89  Free Memory = 89003 MB
Rank =   90  Free Memory = 89003 MB
Rank =   91  Free Memory = 89003 MB
Rank =   92  Free Memory = 89003 MB
Rank =   93  Free Memory = 89003 MB
Rank =   94  Free Memory = 89003 MB
Rank =   95  Free Memory = 89003 MB
Rank =   96  Free Memory = 90031 MB
Rank =   97  Free Memory = 90031 MB
Rank =   98  Free Memory = 90031 MB
Rank =   99  Free Memory = 90031 MB
Rank =  100  Free Memory = 90031 MB
Rank =  101  Free Memory = 90031 MB
Rank =  102  Free Memory = 90031 MB
Rank =  103  Free Memory = 90031 MB
Rank =  104  Free Memory = 90031 MB
Rank =  105  Free Memory = 90031 MB
Rank =  106  Free Memory = 90031 MB
Rank =  107  Free Memory = 90031 MB
Rank =  108  Free Memory = 90031 MB
Rank =  109  Free Memory = 90031 MB
Rank =  110  Free Memory = 90031 MB
Rank =  111  Free Memory = 90031 MB
Rank =  112  Free Memory = 90031 MB
Rank =  113  Free Memory = 90031 MB
Rank =  114  Free Memory = 90031 MB
Rank =  115  Free Memory = 90031 MB
Rank =  116  Free Memory = 90031 MB
Rank =  117  Free Memory = 90031 MB
Rank =  118  Free Memory = 90031 MB
Rank =  119  Free Memory = 90031 MB
Rank =  120  Free Memory = 90031 MB
Rank =  121  Free Memory = 90031 MB
Rank =  122  Free Memory = 90031 MB
Rank =  123  Free Memory = 90031 MB
Rank =  124  Free Memory = 90031 MB
Rank =  125  Free Memory = 90031 MB
Rank =  127  Free Memory = 90031 MB
Rank =  126  Free Memory = 90031 MB
  Input file(s): opt_h2o_gs_tett_run001b.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_tett_run001b.xml

  Project = H2O
  date    = 2023-03-06 17:12:56 PST
  host    = n0017.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 920

  Range of prime numbers to use as seeds over processors and threads = 7213-8387


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 1.920054e-01    1         1  ON     0
     uu_1                 3.590195e-02    1         1  ON     1
     uu_2                -4.559320e-02    1         1  ON     2
     uu_3                -9.369633e-02    1         1  ON     3
     uu_4                -1.254424e-01    1         1  ON     4
     uu_5                -1.327025e-01    1         1  ON     5
     uu_6                -1.091659e-01    1         1  ON     6
     uu_7                -3.320891e-02    1         1  ON     7
     uu_8                 1.030981e-01    1         1  ON     8
     uu_9                 1.188130e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.150780e-01    1         1  ON     0
     ud_1                 7.590189e-02    1         1  ON     1
     ud_2                -7.338664e-03    1         1  ON     2
     ud_3                -5.544926e-02    1         1  ON     3
     ud_4                -1.064782e-01    1         1  ON     4
     ud_5                -1.490405e-01    1         1  ON     5
     ud_6                -1.574171e-01    1         1  ON     6
     ud_7                -1.077761e-01    1         1  ON     7
     ud_8                 9.772284e-03    1         1  ON     8
     ud_9                 9.249491e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -6.811694e-01    1         1  ON     0
     eO_1                -4.031104e-01    1         1  ON     1
     eO_2                -6.148616e-02    1         1  ON     2
     eO_3                 1.622033e-01    1         1  ON     3
     eO_4                 2.643764e-01    1         1  ON     4
     eO_5                 3.070668e-01    1         1  ON     5
     eO_6                 2.482256e-01    1         1  ON     6
     eO_7                 1.081366e-01    1         1  ON     7
     eO_8                 2.727328e-02    1         1  ON     8
     eO_9                 1.812982e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.758229e-01    1         1  ON     0
     eH1_1                -9.847470e-02    1         1  ON     1
     eH1_2                -6.212571e-02    1         1  ON     2
     eH1_3                -2.890051e-02    1         1  ON     3
     eH1_4                 1.766763e-02    1         1  ON     4
     eH1_5                 3.105966e-02    1         1  ON     5
     eH1_6                 7.793809e-02    1         1  ON     6
     eH1_7                 1.115220e-01    1         1  ON     7
     eH1_8                 8.853209e-02    1         1  ON     8
     eH1_9                 2.358450e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.775251e-01    1         1  ON     0
     eH2_1                -1.001865e-01    1         1  ON     1
     eH2_2                -6.424989e-02    1         1  ON     2
     eH2_3                -3.037191e-02    1         1  ON     3
     eH2_4                 1.621523e-02    1         1  ON     4
     eH2_5                 3.146665e-02    1         1  ON     5
     eH2_6                 8.031567e-02    1         1  ON     6
     eH2_7                 1.152651e-01    1         1  ON     7
     eH2_8                 9.158550e-02    1         1  ON     8
     eH2_9                 2.561491e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.702352e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.3468e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 60
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2158
    reference variance = 0.344503
====================================================
  Execution time = 2.0653e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.9162e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5298e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291576538351
                                         uncertainty =       0.004914648261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291576538351
                                         uncertainty =       0.004914648261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381850767
  error estimate for blocks of size 2^( 2) =       0.000395766217
  error estimate for blocks of size 2^( 3) =       0.000408133292
  error estimate for blocks of size 2^( 4) =       0.000416660794
  error estimate for blocks of size 2^( 5) =       0.000420965174
  error estimate for blocks of size 2^( 6) =       0.000422185993
  error estimate for blocks of size 2^( 7) =       0.000424216236

      target function =      -0.925552578034
              le_mean =     -17.211377968548
             les_mean =     296.523151446754
             stat err =       0.000421007049
             autocorr =       1.215601986098
   target nu stat err =       0.000421007049
   target dn stat err =       0.004855913171
      target stat err =       0.007928016484
              std dev =       0.540018533347
             le_variance =       0.291620016358


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721137796855e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925620142504       residual = 3.72e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.928026930195       residual = 2.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.928499608461       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.928772490042       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.928978914501       residual = 5.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929214387503       residual = 3.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.929314887490       residual = 4.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.929399312885       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.929447549064       residual = 5.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.929464308456       residual = 9.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929472719265       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.929479834348       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.929488131029       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.929493759369       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.929500751537       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.929506565457       residual = 9.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929508372725       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.929509862524       residual = 6.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.929509838189       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.929510300635       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929510774173       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.929510793234       residual = 4.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929511126438       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.929511274665       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.929511427166       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929511322413       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 5.639580e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925620142504       residual = 3.72e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926350561614       residual = 2.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926503784355       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926584993110       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926641763410       residual = 5.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926709681226       residual = 3.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.926738237274       residual = 4.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.926764490111       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.926778367531       residual = 4.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.926783054839       residual = 8.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.926785177397       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926787402965       residual = 4.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.926789563346       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.926791094819       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.926792770821       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.926794110335       residual = 8.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.926794534238       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.926794820417       residual = 4.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.926794802376       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.926794887012       residual = 5.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.926794977598       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.926794958997       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.926795034279       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.926795056992       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.926795086251       residual = 9.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.679537e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925620142504       residual = 3.72e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925813036244       residual = 2.97e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925854307477       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925875796068       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925890186599       residual = 5.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925907819242       residual = 3.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925915246022       residual = 4.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925922171860       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925925777235       residual = 4.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925926981144       residual = 8.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925927513492       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925928101055       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925928646066       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925929036459       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925929451494       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925929771483       residual = 7.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925929875008       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925929939259       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.925929934042       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.925929953225       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.925929972369       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.925929968251       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.925929986582       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.925929990971       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.925929997734       residual = 7.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 4.411157e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.024777 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6221e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  1.922960e-01                 1 1 ON  0
uu_1  3.633817e-02                 1 1 ON  1
uu_2  -4.547357e-02                1 1 ON  2
uu_3  -9.376449e-02                1 1 ON  3
uu_4  -1.254821e-01                1 1 ON  4
uu_5  -1.326269e-01                1 1 ON  5
uu_6  -1.091375e-01                1 1 ON  6
uu_7  -3.376101e-02                1 1 ON  7
uu_8  1.025657e-01                 1 1 ON  8
uu_9  1.189543e-01                 1 1 ON  9
ud_0  3.140090e-01                 1 1 ON  10
ud_1  7.606953e-02                 1 1 ON  11
ud_2  -8.163064e-03                1 1 ON  12
ud_3  -5.639440e-02                1 1 ON  13
ud_4  -1.065545e-01                1 1 ON  14
ud_5  -1.481291e-01                1 1 ON  15
ud_6  -1.561632e-01                1 1 ON  16
ud_7  -1.071722e-01                1 1 ON  17
ud_8  9.738826e-03                 1 1 ON  18
ud_9  9.242722e-02                 1 1 ON  19
eO_0  -6.813032e-01                1 1 ON  20
eO_1  -4.035794e-01                1 1 ON  21
eO_2  -6.048055e-02                1 1 ON  22
eO_3  1.629410e-01                 1 1 ON  23
eO_4  2.634829e-01                 1 1 ON  24
eO_5  3.060363e-01                 1 1 ON  25
eO_6  2.485959e-01                 1 1 ON  26
eO_7  1.085039e-01                 1 1 ON  27
eO_8  2.731166e-02                 1 1 ON  28
eO_9  1.814001e-02                 1 1 ON  29
eH1_0 -1.772723e-01                1 1 ON  30
eH1_1 -9.836276e-02                1 1 ON  31
eH1_2 -6.119498e-02                1 1 ON  32
eH1_3 -2.814384e-02                1 1 ON  33
eH1_4 1.764986e-02                 1 1 ON  34
eH1_5 3.056233e-02                 1 1 ON  35
eH1_6 7.791002e-02                 1 1 ON  36
eH1_7 1.115491e-01                 1 1 ON  37
eH1_8 8.866991e-02                 1 1 ON  38
eH1_9 2.361606e-02                 1 1 ON  39
eH2_0 -1.792046e-01                1 1 ON  40
eH2_1 -1.000832e-01                1 1 ON  41
eH2_2 -6.319539e-02                1 1 ON  42
eH2_3 -2.988608e-02                1 1 ON  43
eH2_4 1.644325e-02                 1 1 ON  44
eH2_5 3.114727e-02                 1 1 ON  45
eH2_6 8.021930e-02                 1 1 ON  46
eH2_7 1.152310e-01                 1 1 ON  47
eH2_8 9.181572e-02                 1 1 ON  48
eH2_9 2.564306e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2249
    reference variance = 0.154865
====================================================
  Execution time = 2.0289e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9795e-01
  Total weights = 2.0000e+06
  Execution time = 1.8336e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299215913478
                                         uncertainty =       0.007784309069

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299215913478
                                         uncertainty =       0.007784309069

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386756198
  error estimate for blocks of size 2^( 2) =       0.000400435194
  error estimate for blocks of size 2^( 3) =       0.000412494270
  error estimate for blocks of size 2^( 4) =       0.000421819981
  error estimate for blocks of size 2^( 5) =       0.000427194286
  error estimate for blocks of size 2^( 6) =       0.000430080765
  error estimate for blocks of size 2^( 7) =       0.000431656244

      target function =      -0.913299974322
              le_mean =     -17.212068116831
             les_mean =     296.554449421922
             stat err =       0.000427687819
             autocorr =       1.222866923034
   target nu stat err =       0.000427687819
   target dn stat err =       0.008040898590
      target stat err =       0.012766811062
              std dev =       0.546955860268
             le_variance =       0.299160713081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295636222329
                                         uncertainty =       0.007685971177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295636222329
                                         uncertainty =       0.007685971177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384434990
  error estimate for blocks of size 2^( 2) =       0.000398015885
  error estimate for blocks of size 2^( 3) =       0.000410024122
  error estimate for blocks of size 2^( 4) =       0.000419324070
  error estimate for blocks of size 2^( 5) =       0.000424694355
  error estimate for blocks of size 2^( 6) =       0.000427621222
  error estimate for blocks of size 2^( 7) =       0.000429157275

      target function =      -0.919008888141
              le_mean =     -17.212133713701
             les_mean =     296.553127354041
             stat err =       0.000425199231
             autocorr =       1.223317311345
   target nu stat err =       0.000425199231
   target dn stat err =       0.007935785220
      target stat err =       0.012759536474
              std dev =       0.543673177104
             le_variance =       0.295580523502

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296891615522
                                         uncertainty =       0.007721591396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296891615522
                                         uncertainty =       0.007721591396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385250645
  error estimate for blocks of size 2^( 2) =       0.000398864440
  error estimate for blocks of size 2^( 3) =       0.000410886527
  error estimate for blocks of size 2^( 4) =       0.000420191433
  error estimate for blocks of size 2^( 5) =       0.000425560615
  error estimate for blocks of size 2^( 6) =       0.000428469846
  error estimate for blocks of size 2^( 7) =       0.000430021586

      target function =      -0.916999804544
              le_mean =     -17.212087823594
             les_mean =     296.552803218361
             stat err =       0.000426060870
             autocorr =       1.223084746027
   target nu stat err =       0.000426060870
   target dn stat err =       0.007973924786
      target stat err =       0.012763737963
              std dev =       0.544826687729
             le_variance =       0.296836119662

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298884375183
                                         uncertainty =       0.007775846079

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298884375183
                                         uncertainty =       0.007775846079

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386541806
  error estimate for blocks of size 2^( 2) =       0.000400211112
  error estimate for blocks of size 2^( 3) =       0.000412264357
  error estimate for blocks of size 2^( 4) =       0.000421586663
  error estimate for blocks of size 2^( 5) =       0.000426959952
  error estimate for blocks of size 2^( 6) =       0.000429849220
  error estimate for blocks of size 2^( 7) =       0.000431421624

      target function =      -0.913826089301
              le_mean =     -17.212067295536
             les_mean =     296.554089572191
             stat err =       0.000427454365
             autocorr =       1.222887679791
   target nu stat err =       0.000427454365
   target dn stat err =       0.008031867667
      target stat err =       0.012767146436
              std dev =       0.546652664448
             le_variance =       0.298829135548


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913299974322        initial
     2.5000e-01     2.5000e+00             5.6396e-03        -0.919008888141  <--
     1.0000e+00     1.0000e+01             1.6795e-03        -0.916999804544
     4.0000e+00     4.0000e+01             4.4112e-04        -0.913826089301

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9564e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 1.930409e-01 1 1  ON 0
 uu_1                 3.739548e-02 1 1  ON 1
 uu_2                -4.513397e-02 1 1  ON 2
 uu_3                -9.386661e-02 1 1  ON 3
 uu_4                -1.255324e-01 1 1  ON 4
 uu_5                -1.324114e-01 1 1  ON 5
 uu_6                -1.090581e-01 1 1  ON 6
 uu_7                -3.519059e-02 1 1  ON 7
 uu_8                 1.009996e-01 1 1  ON 8
 uu_9                 1.193630e-01 1 1  ON 9
 ud_0                 3.114308e-01 1 1  ON 10
 ud_1                 7.620631e-02 1 1  ON 11
 ud_2                -1.023884e-02 1 1  ON 12
 ud_3                -5.873904e-02 1 1  ON 13
 ud_4                -1.068424e-01 1 1  ON 14
 ud_5                -1.459706e-01 1 1  ON 15
 ud_6                -1.529917e-01 1 1  ON 16
 ud_7                -1.053917e-01 1 1  ON 17
 ud_8                 9.743775e-03 1 1  ON 18
 ud_9                 9.222549e-02 1 1  ON 19
 eO_0                -6.815366e-01 1 1  ON 20
 eO_1                -4.045193e-01 1 1  ON 21
 eO_2                -5.815184e-02 1 1  ON 22
 eO_3                 1.645741e-01 1 1  ON 23
 eO_4                 2.611870e-01 1 1  ON 24
 eO_5                 3.032452e-01 1 1  ON 25
 eO_6                 2.496449e-01 1 1  ON 26
 eO_7                 1.096120e-01 1 1  ON 27
 eO_8                 2.743017e-02 1 1  ON 28
 eO_9                 1.817023e-02 1 1  ON 29
eH1_0                -1.806635e-01 1 1  ON 30
eH1_1                -9.806373e-02 1 1  ON 31
eH1_2                -5.898536e-02 1 1  ON 32
eH1_3                -2.634401e-02 1 1  ON 33
eH1_4                 1.755692e-02 1 1  ON 34
eH1_5                 2.922611e-02 1 1  ON 35
eH1_6                 7.782971e-02 1 1  ON 36
eH1_7                 1.116418e-01 1 1  ON 37
eH1_8                 8.908256e-02 1 1  ON 38
eH1_9                 2.371257e-02 1 1  ON 39
eH2_0                -1.831647e-01 1 1  ON 40
eH2_1                -9.982612e-02 1 1  ON 41
eH2_2                -6.073032e-02 1 1  ON 42
eH2_3                -2.872394e-02 1 1  ON 43
eH2_4                 1.691894e-02 1 1  ON 44
eH2_5                 3.031964e-02 1 1  ON 45
eH2_6                 7.997016e-02 1 1  ON 46
eH2_7                 1.151387e-01 1 1  ON 47
eH2_8                 9.250011e-02 1 1  ON 48
eH2_9                 2.572928e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5792e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2246
    reference variance = 0.306631
====================================================
  Execution time = 2.2352e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8781e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5660e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287779760692
                                         uncertainty =       0.002462992785

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287779760692
                                         uncertainty =       0.002462992785

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379347210
  error estimate for blocks of size 2^( 2) =       0.000393002559
  error estimate for blocks of size 2^( 3) =       0.000405193717
  error estimate for blocks of size 2^( 4) =       0.000414292586
  error estimate for blocks of size 2^( 5) =       0.000419645809
  error estimate for blocks of size 2^( 6) =       0.000423670031
  error estimate for blocks of size 2^( 7) =       0.000426949707

      target function =      -0.931825418348
              le_mean =     -17.211822220786
             les_mean =     296.534632627809
             stat err =       0.000421139533
             autocorr =       1.232475328039
   target nu stat err =       0.000421139533
   target dn stat err =       0.002532189696
      target stat err =       0.004241429534
              std dev =       0.536477969501
             le_variance =       0.287808611760


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721182222079e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931843636506       residual = 2.25e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935284956113       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935938060210       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936425380458       residual = 8.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936838655758       residual = 3.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937192608371       residual = 2.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937440439358       residual = 3.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937543256394       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937632042217       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937658644643       residual = 8.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.937672254335       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.937683245768       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.937703381398       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.937713237222       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.937728672004       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.937735326963       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.937738843795       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.937745797496       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.937745542706       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.937747092297       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.937747082643       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.937749165953       residual = 9.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.937751050610       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.937751246839       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.937751511316       residual = 8.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.937751437663       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.937751671973       residual = 6.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         26 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 1.081381e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931843636506       residual = 2.25e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933312378514       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933630064928       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933812119276       residual = 8.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933977171645       residual = 3.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934115814719       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934191990393       residual = 3.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934255468314       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934292732440       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934302542288       residual = 7.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934306533868       residual = 9.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934311077935       residual = 4.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934317718577       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934320868288       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934324734376       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934326703816       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934327454845       residual = 7.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934328912409       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934328694852       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934328917240       residual = 7.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934328907331       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934329254874       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934329539729       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934329489603       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934329537660       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.934329524250       residual = 8.43e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 4.263532e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931843636506       residual = 2.25e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932289397065       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932391843506       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932445437139       residual = 8.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932492389142       residual = 3.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932532434986       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932553482479       residual = 3.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932573430137       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932584473281       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932587252110       residual = 6.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932588297542       residual = 8.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932589639186       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932591409134       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932592222701       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932593137832       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932593626047       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932593785222       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.932594088328       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932594021276       residual = 1.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.932594060934       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.932594065846       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932594131353       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.932594183872       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.932594167481       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.932594178669       residual = 5.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 1.279877e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.048026 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7951e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.939936e-01 1 1  ON 0
 uu_1                 3.880105e-02 1 1  ON 1
 uu_2                -4.452497e-02 1 1  ON 2
 uu_3                -9.381940e-02 1 1  ON 3
 uu_4                -1.252149e-01 1 1  ON 4
 uu_5                -1.323482e-01 1 1  ON 5
 uu_6                -1.093049e-01 1 1  ON 6
 uu_7                -3.676577e-02 1 1  ON 7
 uu_8                 9.846231e-02 1 1  ON 8
 uu_9                 1.199310e-01 1 1  ON 9
 ud_0                 3.091751e-01 1 1  ON 10
 ud_1                 7.675844e-02 1 1  ON 11
 ud_2                -1.224723e-02 1 1  ON 12
 ud_3                -6.153847e-02 1 1  ON 13
 ud_4                -1.073598e-01 1 1  ON 14
 ud_5                -1.433144e-01 1 1  ON 15
 ud_6                -1.490298e-01 1 1  ON 16
 ud_7                -1.035470e-01 1 1  ON 17
 ud_8                 8.103558e-03 1 1  ON 18
 ud_9                 9.195352e-02 1 1  ON 19
 eO_0                -6.826395e-01 1 1  ON 20
 eO_1                -4.063990e-01 1 1  ON 21
 eO_2                -5.550396e-02 1 1  ON 22
 eO_3                 1.669878e-01 1 1  ON 23
 eO_4                 2.598488e-01 1 1  ON 24
 eO_5                 3.009933e-01 1 1  ON 25
 eO_6                 2.499027e-01 1 1  ON 26
 eO_7                 1.107197e-01 1 1  ON 27
 eO_8                 2.751490e-02 1 1  ON 28
 eO_9                 1.821496e-02 1 1  ON 29
eH1_0                -1.849270e-01 1 1  ON 30
eH1_1                -9.785314e-02 1 1  ON 31
eH1_2                -5.620082e-02 1 1  ON 32
eH1_3                -2.424351e-02 1 1  ON 33
eH1_4                 1.752633e-02 1 1  ON 34
eH1_5                 2.797796e-02 1 1  ON 35
eH1_6                 7.789290e-02 1 1  ON 36
eH1_7                 1.114885e-01 1 1  ON 37
eH1_8                 8.950862e-02 1 1  ON 38
eH1_9                 2.380593e-02 1 1  ON 39
eH2_0                -1.871318e-01 1 1  ON 40
eH2_1                -9.936173e-02 1 1  ON 41
eH2_2                -5.797791e-02 1 1  ON 42
eH2_3                -2.626790e-02 1 1  ON 43
eH2_4                 1.679895e-02 1 1  ON 44
eH2_5                 2.922266e-02 1 1  ON 45
eH2_6                 7.920167e-02 1 1  ON 46
eH2_7                 1.146960e-01 1 1  ON 47
eH2_8                 9.308859e-02 1 1  ON 48
eH2_9                 2.584425e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1705
    reference variance = 0.229028
====================================================
  Execution time = 2.0212e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8448e-01
  Total weights = 2.0000e+06
  Execution time = 1.8299e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286485241321
                                         uncertainty =       0.004612777291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286485241321
                                         uncertainty =       0.004612777291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378447738
  error estimate for blocks of size 2^( 2) =       0.000391860784
  error estimate for blocks of size 2^( 3) =       0.000403762903
  error estimate for blocks of size 2^( 4) =       0.000412087914
  error estimate for blocks of size 2^( 5) =       0.000416902014
  error estimate for blocks of size 2^( 6) =       0.000419785719
  error estimate for blocks of size 2^( 7) =       0.000422285739

      target function =      -0.934029454608
              le_mean =     -17.211979022014
             les_mean =     296.538667091214
             stat err =       0.000417765346
             autocorr =       1.218577060541
   target nu stat err =       0.000417765346
   target dn stat err =       0.004627167661
      target stat err =       0.007704481228
              std dev =       0.535205923159
             le_variance =       0.286445380185

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282986473107
                                         uncertainty =       0.004629656273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282986473107
                                         uncertainty =       0.004629656273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376128480
  error estimate for blocks of size 2^( 2) =       0.000389438472
  error estimate for blocks of size 2^( 3) =       0.000401357329
  error estimate for blocks of size 2^( 4) =       0.000409871472
  error estimate for blocks of size 2^( 5) =       0.000414708973
  error estimate for blocks of size 2^( 6) =       0.000417723279
  error estimate for blocks of size 2^( 7) =       0.000420300163

      target function =      -0.939864132981
              le_mean =     -17.212044668037
             les_mean =     296.537426779877
             stat err =       0.000415650972
             autocorr =       1.221195407296
   target nu stat err =       0.000415650972
   target dn stat err =       0.004639871920
      target stat err =       0.007822439242
              std dev =       0.531925997516
             le_variance =       0.282945266833

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283230451228
                                         uncertainty =       0.004622604875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283230451228
                                         uncertainty =       0.004622604875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376290769
  error estimate for blocks of size 2^( 2) =       0.000389594602
  error estimate for blocks of size 2^( 3) =       0.000401483528
  error estimate for blocks of size 2^( 4) =       0.000409943462
  error estimate for blocks of size 2^( 5) =       0.000414762398
  error estimate for blocks of size 2^( 6) =       0.000417739748
  error estimate for blocks of size 2^( 7) =       0.000420301319

      target function =      -0.939455727145
              le_mean =     -17.211991624000
             les_mean =     296.535845009106
             stat err =       0.000415686732
             autocorr =       1.220352218684
   target nu stat err =       0.000415686732
   target dn stat err =       0.004633133882
      target stat err =       0.007803642932
              std dev =       0.532155509275
             le_variance =       0.283189486052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285812115407
                                         uncertainty =       0.004613781100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285812115407
                                         uncertainty =       0.004613781100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378002701
  error estimate for blocks of size 2^( 2) =       0.000391388211
  error estimate for blocks of size 2^( 3) =       0.000403278560
  error estimate for blocks of size 2^( 4) =       0.000411616653
  error estimate for blocks of size 2^( 5) =       0.000416427394
  error estimate for blocks of size 2^( 6) =       0.000419322910
  error estimate for blocks of size 2^( 7) =       0.000421832121

      target function =      -0.935147213579
              le_mean =     -17.211952975007
             les_mean =     296.537097155088
             stat err =       0.000417299770
             autocorr =       1.218727142859
   target nu stat err =       0.000417299770
   target dn stat err =       0.004627533550
      target stat err =       0.007722991661
              std dev =       0.534576546544
             le_variance =       0.285772084115


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.934029454608        initial
     6.2500e-02     6.2500e-01             1.0814e-02        -0.939864132981  <--
     2.5000e-01     2.5000e+00             4.2635e-03        -0.939455727145
     1.0000e+00     1.0000e+01             1.2799e-03        -0.935147213579

*****************************************************************************
Applying the update for shift_i =   6.2500e-02     and shift_s =   6.2500e-01
*****************************************************************************

  Execution time = 2.9489e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.959236e-01 1 1  ON 0
 uu_1                 4.124307e-02 1 1  ON 1
 uu_2                -4.312230e-02 1 1  ON 2
 uu_3                -9.321001e-02 1 1  ON 3
 uu_4                -1.243732e-01 1 1  ON 4
 uu_5                -1.319362e-01 1 1  ON 5
 uu_6                -1.096681e-01 1 1  ON 6
 uu_7                -3.998529e-02 1 1  ON 7
 uu_8                 9.184863e-02 1 1  ON 8
 uu_9                 1.213619e-01 1 1  ON 9
 ud_0                 3.056300e-01 1 1  ON 10
 ud_1                 7.654874e-02 1 1  ON 11
 ud_2                -1.565798e-02 1 1  ON 12
 ud_3                -6.594297e-02 1 1  ON 13
 ud_4                -1.085032e-01 1 1  ON 14
 ud_5                -1.394411e-01 1 1  ON 15
 ud_6                -1.421779e-01 1 1  ON 16
 ud_7                -9.897814e-02 1 1  ON 17
 ud_8                 5.041653e-03 1 1  ON 18
 ud_9                 9.110833e-02 1 1  ON 19
 eO_0                -6.841321e-01 1 1  ON 20
 eO_1                -4.086743e-01 1 1  ON 21
 eO_2                -5.211118e-02 1 1  ON 22
 eO_3                 1.699053e-01 1 1  ON 23
 eO_4                 2.575496e-01 1 1  ON 24
 eO_5                 2.964565e-01 1 1  ON 25
 eO_6                 2.505940e-01 1 1  ON 26
 eO_7                 1.138886e-01 1 1  ON 27
 eO_8                 2.778071e-02 1 1  ON 28
 eO_9                 1.833722e-02 1 1  ON 29
eH1_0                -1.908773e-01 1 1  ON 30
eH1_1                -9.739403e-02 1 1  ON 31
eH1_2                -5.221618e-02 1 1  ON 32
eH1_3                -2.119271e-02 1 1  ON 33
eH1_4                 1.725224e-02 1 1  ON 34
eH1_5                 2.551561e-02 1 1  ON 35
eH1_6                 7.781687e-02 1 1  ON 36
eH1_7                 1.112179e-01 1 1  ON 37
eH1_8                 9.072253e-02 1 1  ON 38
eH1_9                 2.408127e-02 1 1  ON 39
eH2_0                -1.924804e-01 1 1  ON 40
eH2_1                -9.836632e-02 1 1  ON 41
eH2_2                -5.381756e-02 1 1  ON 42
eH2_3                -2.255662e-02 1 1  ON 43
eH2_4                 1.657945e-02 1 1  ON 44
eH2_5                 2.690493e-02 1 1  ON 45
eH2_6                 7.728890e-02 1 1  ON 46
eH2_7                 1.135856e-01 1 1  ON 47
eH2_8                 9.473775e-02 1 1  ON 48
eH2_9                 2.618321e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7447e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2017
    reference variance = 0.346998
====================================================
  Execution time = 2.0235e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8257e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5502e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282559435388
                                         uncertainty =       0.003005416203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282559435388
                                         uncertainty =       0.003005416203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375880136
  error estimate for blocks of size 2^( 2) =       0.000389415299
  error estimate for blocks of size 2^( 3) =       0.000401725067
  error estimate for blocks of size 2^( 4) =       0.000410917047
  error estimate for blocks of size 2^( 5) =       0.000415009463
  error estimate for blocks of size 2^( 6) =       0.000417379053
  error estimate for blocks of size 2^( 7) =       0.000419544105

      target function =      -0.940524559004
              le_mean =     -17.212145312883
             les_mean =     296.540517883674
             stat err =       0.000415712417
             autocorr =       1.223171188704
   target nu stat err =       0.000415712417
   target dn stat err =       0.003135657550
      target stat err =       0.005322925257
              std dev =       0.531574786048
             le_variance =       0.282571753162


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721214531288e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-02, overlap shift 1.5625e-01 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940554260448       residual = 4.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941480257627       residual = 3.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941692750621       residual = 3.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941898300041       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942093720327       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942249451219       residual = 7.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942361986127       residual = 5.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942399861600       residual = 5.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942438199458       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942465579693       residual = 8.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.942498792527       residual = 7.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.942523740380       residual = 7.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.942532102405       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.942541404424       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.942549249626       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.942556093308       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.942573524560       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.942586569342       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.942592710334       residual = 9.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.942595121880       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.942596796691       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.942601867614       residual = 4.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.942607810979       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.942617348348       residual = 9.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.942617555585       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.942616767915       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.942618406600       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.942617929139       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.942619187923       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.942620131053       residual = 6.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         29 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e-02 is 2.857374e-02

solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940554260448       residual = 4.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941172788740       residual = 3.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941325761786       residual = 3.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941446688485       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941567504973       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941663455985       residual = 8.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941712865251       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941751120932       residual = 3.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941782803663       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941798904506       residual = 6.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941817937860       residual = 5.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941827280455       residual = 6.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941832424444       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941835896635       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941838641921       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941841551122       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941848063672       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941853729547       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941855106608       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941856164586       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941856088051       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941857244462       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941858108605       residual = 5.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941859703278       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.941859015654       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.941858806030       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.941859013179       residual = 9.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         26 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 9.436641e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940554260448       residual = 4.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940819861890       residual = 3.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940890965213       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940937774578       residual = 2.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940984400156       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941020702336       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941039884682       residual = 7.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941058136617       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941070117960       residual = 9.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941076045186       residual = 5.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941082517572       residual = 5.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941084221044       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941086788943       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941087393558       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941088074846       residual = 6.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941088868785       residual = 7.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941090510022       residual = 8.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941092034491       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941092012956       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941092360910       residual = 5.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941092330776       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941092483186       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941092536013       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941092749049       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.941092613024       residual = 9.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 2.725458e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.075024 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5823e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.998519e-01 1 1  ON 0
 uu_1                 4.514734e-02 1 1  ON 1
 uu_2                -4.025373e-02 1 1  ON 2
 uu_3                -9.081090e-02 1 1  ON 3
 uu_4                -1.228829e-01 1 1  ON 4
 uu_5                -1.325434e-01 1 1  ON 5
 uu_6                -1.131672e-01 1 1  ON 6
 uu_7                -4.443186e-02 1 1  ON 7
 uu_8                 8.241199e-02 1 1  ON 8
 uu_9                 1.228801e-01 1 1  ON 9
 ud_0                 3.012922e-01 1 1  ON 10
 ud_1                 7.470915e-02 1 1  ON 11
 ud_2                -1.943472e-02 1 1  ON 12
 ud_3                -6.963625e-02 1 1  ON 13
 ud_4                -1.085874e-01 1 1  ON 14
 ud_5                -1.342388e-01 1 1  ON 15
 ud_6                -1.346539e-01 1 1  ON 16
 ud_7                -9.364485e-02 1 1  ON 17
 ud_8                -4.122097e-04 1 1  ON 18
 ud_9                 8.987615e-02 1 1  ON 19
 eO_0                -6.853923e-01 1 1  ON 20
 eO_1                -4.108484e-01 1 1  ON 21
 eO_2                -5.045046e-02 1 1  ON 22
 eO_3                 1.718074e-01 1 1  ON 23
 eO_4                 2.565029e-01 1 1  ON 24
 eO_5                 2.942294e-01 1 1  ON 25
 eO_6                 2.500263e-01 1 1  ON 26
 eO_7                 1.172115e-01 1 1  ON 27
 eO_8                 2.784392e-02 1 1  ON 28
 eO_9                 1.838984e-02 1 1  ON 29
eH1_0                -1.965287e-01 1 1  ON 30
eH1_1                -9.640213e-02 1 1  ON 31
eH1_2                -4.915516e-02 1 1  ON 32
eH1_3                -1.889375e-02 1 1  ON 33
eH1_4                 1.641865e-02 1 1  ON 34
eH1_5                 2.429572e-02 1 1  ON 35
eH1_6                 7.798846e-02 1 1  ON 36
eH1_7                 1.103877e-01 1 1  ON 37
eH1_8                 9.239655e-02 1 1  ON 38
eH1_9                 2.418639e-02 1 1  ON 39
eH2_0                -1.960785e-01 1 1  ON 40
eH2_1                -9.604687e-02 1 1  ON 41
eH2_2                -4.911443e-02 1 1  ON 42
eH2_3                -1.962398e-02 1 1  ON 43
eH2_4                 1.469611e-02 1 1  ON 44
eH2_5                 2.156439e-02 1 1  ON 45
eH2_6                 7.615319e-02 1 1  ON 46
eH2_7                 1.128602e-01 1 1  ON 47
eH2_8                 9.686886e-02 1 1  ON 48
eH2_9                 2.672365e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2018
    reference variance = 0.198117
====================================================
  Execution time = 1.9674e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8079e-01
  Total weights = 2.0000e+06
  Execution time = 1.8266e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281137985342
                                         uncertainty =       0.003676740623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281137985342
                                         uncertainty =       0.003676740623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374873701
  error estimate for blocks of size 2^( 2) =       0.000388428407
  error estimate for blocks of size 2^( 3) =       0.000400835675
  error estimate for blocks of size 2^( 4) =       0.000410042180
  error estimate for blocks of size 2^( 5) =       0.000415019459
  error estimate for blocks of size 2^( 6) =       0.000417688004
  error estimate for blocks of size 2^( 7) =       0.000420780215

      target function =      -0.943063419922
              le_mean =     -17.212063743765
             les_mean =     296.536198761603
             stat err =       0.000415882464
             autocorr =       1.230754041389
   target nu stat err =       0.000415882464
   target dn stat err =       0.003603979238
      target stat err =       0.006135321414
              std dev =       0.530151471470
             le_variance =       0.281060582701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281067338043
                                         uncertainty =       0.003705953859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281067338043
                                         uncertainty =       0.003705953859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374827998
  error estimate for blocks of size 2^( 2) =       0.000388668445
  error estimate for blocks of size 2^( 3) =       0.000401432679
  error estimate for blocks of size 2^( 4) =       0.000410992656
  error estimate for blocks of size 2^( 5) =       0.000416201260
  error estimate for blocks of size 2^( 6) =       0.000419005413
  error estimate for blocks of size 2^( 7) =       0.000422245008

      target function =      -0.943179004562
              le_mean =     -17.212021869896
             les_mean =     296.534688765339
             stat err =       0.000417111084
             autocorr =       1.238338614722
   target nu stat err =       0.000417111084
   target dn stat err =       0.003637171548
      target stat err =       0.006192281658
              std dev =       0.530086838226
             le_variance =       0.280992056060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281392258953
                                         uncertainty =       0.003704103354

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281392258953
                                         uncertainty =       0.003704103354

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375044975
  error estimate for blocks of size 2^( 2) =       0.000388978375
  error estimate for blocks of size 2^( 3) =       0.000401844910
  error estimate for blocks of size 2^( 4) =       0.000411494715
  error estimate for blocks of size 2^( 5) =       0.000416762128
  error estimate for blocks of size 2^( 6) =       0.000419593326
  error estimate for blocks of size 2^( 7) =       0.000422853711

      target function =      -0.942628660528
              le_mean =     -17.212077247899
             les_mean =     296.536920513786
             stat err =       0.000417675970
             autocorr =       1.240258685749
   target nu stat err =       0.000417675970
   target dn stat err =       0.003636311398
      target stat err =       0.006184441181
              std dev =       0.530393690389
             le_variance =       0.281317466804

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280920802503
                                         uncertainty =       0.003680071954

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280920802503
                                         uncertainty =       0.003680071954

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374729171
  error estimate for blocks of size 2^( 2) =       0.000388333366
  error estimate for blocks of size 2^( 3) =       0.000400807577
  error estimate for blocks of size 2^( 4) =       0.000410085455
  error estimate for blocks of size 2^( 5) =       0.000415108669
  error estimate for blocks of size 2^( 6) =       0.000417804292
  error estimate for blocks of size 2^( 7) =       0.000420927133

      target function =      -0.943430228117
              le_mean =     -17.212010120950
             les_mean =     296.534136166408
             stat err =       0.000415981387
             autocorr =       1.232289627883
   target nu stat err =       0.000415981387
   target dn stat err =       0.003608342904
      target stat err =       0.006146780746
              std dev =       0.529947075804
             le_variance =       0.280843903153


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943063419922        initial
     1.5625e-02     1.5625e-01             2.8574e-02        -0.943179004562
     6.2500e-02     6.2500e-01             9.4366e-03        -0.942628660528
     2.5000e-01     2.5000e+00             2.7255e-03        -0.943430228117  <--

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.8923e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.972783e-01 1 1  ON 0
 uu_1                 4.259928e-02 1 1  ON 1
 uu_2                -4.220889e-02 1 1  ON 2
 uu_3                -9.246551e-02 1 1  ON 3
 uu_4                -1.239631e-01 1 1  ON 4
 uu_5                -1.323191e-01 1 1  ON 5
 uu_6                -1.110455e-01 1 1  ON 6
 uu_7                -4.135704e-02 1 1  ON 7
 uu_8                 8.929161e-02 1 1  ON 8
 uu_9                 1.217941e-01 1 1  ON 9
 ud_0                 3.039661e-01 1 1  ON 10
 ud_1                 7.601417e-02 1 1  ON 11
 ud_2                -1.706553e-02 1 1  ON 12
 ud_3                -6.734686e-02 1 1  ON 13
 ud_4                -1.084537e-01 1 1  ON 14
 ud_5                -1.373607e-01 1 1  ON 15
 ud_6                -1.394525e-01 1 1  ON 16
 ud_7                -9.737609e-02 1 1  ON 17
 ud_8                 3.275506e-03 1 1  ON 18
 ud_9                 9.081906e-02 1 1  ON 19
 eO_0                -6.845033e-01 1 1  ON 20
 eO_1                -4.094946e-01 1 1  ON 21
 eO_2                -5.126243e-02 1 1  ON 22
 eO_3                 1.707728e-01 1 1  ON 23
 eO_4                 2.570780e-01 1 1  ON 24
 eO_5                 2.956424e-01 1 1  ON 25
 eO_6                 2.504138e-01 1 1  ON 26
 eO_7                 1.147343e-01 1 1  ON 27
 eO_8                 2.779129e-02 1 1  ON 28
 eO_9                 1.835180e-02 1 1  ON 29
eH1_0                -1.932229e-01 1 1  ON 30
eH1_1                -9.697543e-02 1 1  ON 31
eH1_2                -5.094618e-02 1 1  ON 32
eH1_3                -2.022521e-02 1 1  ON 33
eH1_4                 1.699280e-02 1 1  ON 34
eH1_5                 2.516998e-02 1 1  ON 35
eH1_6                 7.786714e-02 1 1  ON 36
eH1_7                 1.109516e-01 1 1  ON 37
eH1_8                 9.114810e-02 1 1  ON 38
eH1_9                 2.410624e-02 1 1  ON 39
eH2_0                -1.941179e-01 1 1  ON 40
eH2_1                -9.752811e-02 1 1  ON 41
eH2_2                -5.197110e-02 1 1  ON 42
eH2_3                -2.142125e-02 1 1  ON 43
eH2_4                 1.590146e-02 1 1  ON 44
eH2_5                 2.512416e-02 1 1  ON 45
eH2_6                 7.709165e-02 1 1  ON 46
eH2_7                 1.133648e-01 1 1  ON 47
eH2_8                 9.528115e-02 1 1  ON 48
eH2_9                 2.631994e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4752e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7207e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2226
    reference variance = 0.138015
====================================================
  Execution time = 2.1406e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8182e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7008e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281899010486
                                         uncertainty =       0.003426990110

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281899010486
                                         uncertainty =       0.003426990110

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375382307
  error estimate for blocks of size 2^( 2) =       0.000388970412
  error estimate for blocks of size 2^( 3) =       0.000401137830
  error estimate for blocks of size 2^( 4) =       0.000409687545
  error estimate for blocks of size 2^( 5) =       0.000415627218
  error estimate for blocks of size 2^( 6) =       0.000419591142
  error estimate for blocks of size 2^( 7) =       0.000420156104

      target function =      -0.941782533393
              le_mean =     -17.212507959648
             les_mean =     296.552253873530
             stat err =       0.000416265502
             autocorr =       1.229683205218
   target nu stat err =       0.000416265502
   target dn stat err =       0.002908844890
      target stat err =       0.004962319854
              std dev =       0.530870750276
             le_variance =       0.281823753499


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721250795965e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941807437115       residual = 3.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942271389282       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942330342862       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942410613161       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942493261355       residual = 8.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942563986159       residual = 4.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942596674935       residual = 5.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942610345219       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942620798035       residual = 6.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942623358292       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.942627885429       residual = 5.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.942631682840       residual = 4.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.942643071337       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.942653804582       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.942667914212       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.942672894412       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.942674774779       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.942679426854       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.942679256572       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.942679841276       residual = 8.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.942679859792       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.942680744521       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.942681534337       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.942681723632       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.942681658683       residual = 3.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.942681653195       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.942682103528       residual = 8.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         26 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 7.694441e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941807437115       residual = 3.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942006454845       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942034981362       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942067573381       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942098094955       residual = 8.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942126966571       residual = 4.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942138061676       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942145606822       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942149559112       residual = 5.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942150241102       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.942151701338       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.942152841378       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.942156739501       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.942160151865       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.942163432936       residual = 8.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.942164716716       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.942164961963       residual = 6.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.942165727401       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.942165626106       residual = 9.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.942165676222       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.942165710991       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.942165840661       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.942165957955       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.942165933818       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.942165907165       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 2.407626e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941807437115       residual = 3.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941868031356       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941877295001       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941887320813       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941895547348       residual = 8.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941904106697       residual = 4.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941907344680       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941909592174       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941910735483       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941910892370       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941911281660       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941911578945       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941912646947       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941913546616       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941914277515       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941914581603       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941914610569       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941914759519       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941914733061       residual = 6.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941914735339       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941914750661       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941914776721       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941914794485       residual = 6.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941914785022       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.941914779963       residual = 2.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 6.419199e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.097772 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7141e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.982250e-01 1 1  ON 0
 uu_1                 4.329549e-02 1 1  ON 1
 uu_2                -4.182767e-02 1 1  ON 2
 uu_3                -9.219032e-02 1 1  ON 3
 uu_4                -1.237460e-01 1 1  ON 4
 uu_5                -1.321288e-01 1 1  ON 5
 uu_6                -1.112176e-01 1 1  ON 6
 uu_7                -4.268818e-02 1 1  ON 7
 uu_8                 8.728421e-02 1 1  ON 8
 uu_9                 1.219117e-01 1 1  ON 9
 ud_0                 3.031499e-01 1 1  ON 10
 ud_1                 7.597376e-02 1 1  ON 11
 ud_2                -1.805412e-02 1 1  ON 12
 ud_3                -6.838227e-02 1 1  ON 13
 ud_4                -1.085932e-01 1 1  ON 14
 ud_5                -1.361310e-01 1 1  ON 15
 ud_6                -1.375736e-01 1 1  ON 16
 ud_7                -9.643152e-02 1 1  ON 17
 ud_8                 1.764706e-03 1 1  ON 18
 ud_9                 9.061248e-02 1 1  ON 19
 eO_0                -6.842832e-01 1 1  ON 20
 eO_1                -4.093178e-01 1 1  ON 21
 eO_2                -4.983584e-02 1 1  ON 22
 eO_3                 1.713782e-01 1 1  ON 23
 eO_4                 2.555647e-01 1 1  ON 24
 eO_5                 2.932347e-01 1 1  ON 25
 eO_6                 2.505817e-01 1 1  ON 26
 eO_7                 1.159173e-01 1 1  ON 27
 eO_8                 2.787484e-02 1 1  ON 28
 eO_9                 1.840800e-02 1 1  ON 29
eH1_0                -1.950751e-01 1 1  ON 30
eH1_1                -9.666893e-02 1 1  ON 31
eH1_2                -4.971421e-02 1 1  ON 32
eH1_3                -1.910497e-02 1 1  ON 33
eH1_4                 1.737265e-02 1 1  ON 34
eH1_5                 2.498342e-02 1 1  ON 35
eH1_6                 7.649259e-02 1 1  ON 36
eH1_7                 1.107371e-01 1 1  ON 37
eH1_8                 9.154285e-02 1 1  ON 38
eH1_9                 2.422424e-02 1 1  ON 39
eH2_0                -1.954068e-01 1 1  ON 40
eH2_1                -9.668040e-02 1 1  ON 41
eH2_2                -5.048886e-02 1 1  ON 42
eH2_3                -2.044036e-02 1 1  ON 43
eH2_4                 1.612468e-02 1 1  ON 44
eH2_5                 2.386317e-02 1 1  ON 45
eH2_6                 7.572504e-02 1 1  ON 46
eH2_7                 1.131225e-01 1 1  ON 47
eH2_8                 9.577643e-02 1 1  ON 48
eH2_9                 2.642855e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.236
    reference variance = 0.243237
====================================================
  Execution time = 2.0075e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8076e-01
  Total weights = 2.0000e+06
  Execution time = 1.8180e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280838292813
                                         uncertainty =       0.002535030311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280838292813
                                         uncertainty =       0.002535030311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374687761
  error estimate for blocks of size 2^( 2) =       0.000388193523
  error estimate for blocks of size 2^( 3) =       0.000400770532
  error estimate for blocks of size 2^( 4) =       0.000409428659
  error estimate for blocks of size 2^( 5) =       0.000416308000
  error estimate for blocks of size 2^( 6) =       0.000418469812
  error estimate for blocks of size 2^( 7) =       0.000420926037

      target function =      -0.943553155622
              le_mean =     -17.212339472942
             les_mean =     296.545411828547
             stat err =       0.000416283127
             autocorr =       1.234350792064
   target nu stat err =       0.000416283127
   target dn stat err =       0.002396787621
      target stat err =       0.004124408139
              std dev =       0.529888513891
             le_variance =       0.280781837153

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280896922384
                                         uncertainty =       0.002533096291

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280896922384
                                         uncertainty =       0.002533096291

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374727203
  error estimate for blocks of size 2^( 2) =       0.000388287592
  error estimate for blocks of size 2^( 3) =       0.000400984827
  error estimate for blocks of size 2^( 4) =       0.000409762577
  error estimate for blocks of size 2^( 5) =       0.000416739691
  error estimate for blocks of size 2^( 6) =       0.000418908476
  error estimate for blocks of size 2^( 7) =       0.000421399853

      target function =      -0.943452845663
              le_mean =     -17.212365086935
             les_mean =     296.546352699432
             stat err =       0.000416702649
             autocorr =       1.236579605117
   target nu stat err =       0.000416702649
   target dn stat err =       0.002392089216
      target stat err =       0.004116064145
              std dev =       0.529944293227
             le_variance =       0.280840953924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280875335018
                                         uncertainty =       0.002532922791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280875335018
                                         uncertainty =       0.002532922791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374712773
  error estimate for blocks of size 2^( 2) =       0.000388255353
  error estimate for blocks of size 2^( 3) =       0.000400920727
  error estimate for blocks of size 2^( 4) =       0.000409666656
  error estimate for blocks of size 2^( 5) =       0.000416623601
  error estimate for blocks of size 2^( 6) =       0.000418786855
  error estimate for blocks of size 2^( 7) =       0.000421268299

      target function =      -0.943489604296
              le_mean =     -17.212352771758
             les_mean =     296.545907123526
             stat err =       0.000416586353
             autocorr =       1.235984666053
   target nu stat err =       0.000416586353
   target dn stat err =       0.002392348011
      target stat err =       0.004116676046
              std dev =       0.529923885556
             le_variance =       0.280819324483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280821195084
                                         uncertainty =       0.002534644249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280821195084
                                         uncertainty =       0.002534644249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374676398
  error estimate for blocks of size 2^( 2) =       0.000388185432
  error estimate for blocks of size 2^( 3) =       0.000400773470
  error estimate for blocks of size 2^( 4) =       0.000409443040
  error estimate for blocks of size 2^( 5) =       0.000416333337
  error estimate for blocks of size 2^( 6) =       0.000418494868
  error estimate for blocks of size 2^( 7) =       0.000420954585

      target function =      -0.943582020672
              le_mean =     -17.212337036655
             les_mean =     296.545310928727
             stat err =       0.000416306457
             autocorr =       1.234564040875
   target nu stat err =       0.000416306457
   target dn stat err =       0.002396045163
      target stat err =       0.004123408971
              std dev =       0.529872442869
             le_variance =       0.280764805712


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943553155622        initial
     6.2500e-02     6.2500e-01             7.6944e-03        -0.943452845663
     2.5000e-01     2.5000e+00             2.4076e-03        -0.943489604296
     1.0000e+00     1.0000e+01             6.4192e-04        -0.943582020672  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.9290e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.975519e-01 1 1  ON 0
 uu_1                 4.279521e-02 1 1  ON 1
 uu_2                -4.210984e-02 1 1  ON 2
 uu_3                -9.239783e-02 1 1  ON 3
 uu_4                -1.239122e-01 1 1  ON 4
 uu_5                -1.322748e-01 1 1  ON 5
 uu_6                -1.111015e-01 1 1  ON 6
 uu_7                -4.172435e-02 1 1  ON 7
 uu_8                 8.877579e-02 1 1  ON 8
 uu_9                 1.218262e-01 1 1  ON 9
 ud_0                 3.037308e-01 1 1  ON 10
 ud_1                 7.602401e-02 1 1  ON 11
 ud_2                -1.735097e-02 1 1  ON 12
 ud_3                -6.764829e-02 1 1  ON 13
 ud_4                -1.084903e-01 1 1  ON 14
 ud_5                -1.370010e-01 1 1  ON 15
 ud_6                -1.389250e-01 1 1  ON 16
 ud_7                -9.713334e-02 1 1  ON 17
 ud_8                 2.869632e-03 1 1  ON 18
 ud_9                 9.076845e-02 1 1  ON 19
 eO_0                -6.844633e-01 1 1  ON 20
 eO_1                -4.094708e-01 1 1  ON 21
 eO_2                -5.084171e-02 1 1  ON 22
 eO_3                 1.709648e-01 1 1  ON 23
 eO_4                 2.566567e-01 1 1  ON 24
 eO_5                 2.950005e-01 1 1  ON 25
 eO_6                 2.504626e-01 1 1  ON 26
 eO_7                 1.150364e-01 1 1  ON 27
 eO_8                 2.781243e-02 1 1  ON 28
 eO_9                 1.836628e-02 1 1  ON 29
eH1_0                -1.937838e-01 1 1  ON 30
eH1_1                -9.689247e-02 1 1  ON 31
eH1_2                -5.058509e-02 1 1  ON 32
eH1_3                -1.989854e-02 1 1  ON 33
eH1_4                 1.710026e-02 1 1  ON 34
eH1_5                 2.512205e-02 1 1  ON 35
eH1_6                 7.749916e-02 1 1  ON 36
eH1_7                 1.108992e-01 1 1  ON 37
eH1_8                 9.124943e-02 1 1  ON 38
eH1_9                 2.413638e-02 1 1  ON 39
eH2_0                -1.945225e-01 1 1  ON 40
eH2_1                -9.728929e-02 1 1  ON 41
eH2_2                -5.154119e-02 1 1  ON 42
eH2_3                -2.114246e-02 1 1  ON 43
eH2_4                 1.596689e-02 1 1  ON 44
eH2_5                 2.477145e-02 1 1  ON 45
eH2_6                 7.673580e-02 1 1  ON 46
eH2_7                 1.133050e-01 1 1  ON 47
eH2_8                 9.540817e-02 1 1  ON 48
eH2_9                 2.634754e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6438e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.3142
    reference variance = 0.319919
====================================================
  Execution time = 2.0220e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8084e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5889e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280877146233
                                         uncertainty =       0.002889251465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280877146233
                                         uncertainty =       0.002889251465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374724943
  error estimate for blocks of size 2^( 2) =       0.000388436223
  error estimate for blocks of size 2^( 3) =       0.000400786897
  error estimate for blocks of size 2^( 4) =       0.000409737166
  error estimate for blocks of size 2^( 5) =       0.000416113050
  error estimate for blocks of size 2^( 6) =       0.000417996715
  error estimate for blocks of size 2^( 7) =       0.000419212464

      target function =      -0.943450186972
              le_mean =     -17.212682126415
             les_mean =     296.557263409950
             stat err =       0.000415764849
             autocorr =       1.231034808587
   target nu stat err =       0.000415764849
   target dn stat err =       0.002646092832
      target stat err =       0.004541844115
              std dev =       0.529941096117
             le_variance =       0.280837565353


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721268212642e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943471269077       residual = 2.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943632391800       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943661279526       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943689798698       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943714229512       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943729147676       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943742952360       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943745968780       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943752142871       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943752557352       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943755306657       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943756731787       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943758666642       residual = 9.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943759529121       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943761096173       residual = 7.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943760834163       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943761365703       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943762352967       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943762482992       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943762651570       residual = 2.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943762511653       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943762493492       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943762575211       residual = 9.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943762640511       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.943762578799       residual = 8.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.896588e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943471269077       residual = 2.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943520271292       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943529690942       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943538233986       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943545149422       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943549433691       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943553559459       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943554459896       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943556213836       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943556334900       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943557084227       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943557447478       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943557982708       residual = 7.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943558232198       residual = 8.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943558588311       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943558487653       residual = 2.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943558617026       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943558839830       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943558856193       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943558886024       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943558845034       residual = 9.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943558848824       residual = 9.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943558860774       residual = 5.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943558873442       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.943558861557       residual = 3.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 4.897899e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943471269077       residual = 2.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943484220568       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943486763250       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943489031243       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943490799517       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943491911122       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943492996104       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943493234143       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943493684986       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943493716900       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943493907590       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943494000080       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943494136202       residual = 7.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943494201492       residual = 8.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943494286425       residual = 5.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943494258919       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943494290787       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943494344852       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943494347447       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943494354205       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943494343916       residual = 6.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943494345698       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943494347616       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943494350587       residual = 9.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.221973e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.117641 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5840e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.975706e-01 1 1  ON 0
 uu_1                 4.291720e-02 1 1  ON 1
 uu_2                -4.205848e-02 1 1  ON 2
 uu_3                -9.239633e-02 1 1  ON 3
 uu_4                -1.238866e-01 1 1  ON 4
 uu_5                -1.321888e-01 1 1  ON 5
 uu_6                -1.110128e-01 1 1  ON 6
 uu_7                -4.189368e-02 1 1  ON 7
 uu_8                 8.828600e-02 1 1  ON 8
 uu_9                 1.218732e-01 1 1  ON 9
 ud_0                 3.035034e-01 1 1  ON 10
 ud_1                 7.603862e-02 1 1  ON 11
 ud_2                -1.760572e-02 1 1  ON 12
 ud_3                -6.793962e-02 1 1  ON 13
 ud_4                -1.084773e-01 1 1  ON 14
 ud_5                -1.366959e-01 1 1  ON 15
 ud_6                -1.384686e-01 1 1  ON 16
 ud_7                -9.691588e-02 1 1  ON 17
 ud_8                 2.521242e-03 1 1  ON 18
 ud_9                 9.074720e-02 1 1  ON 19
 eO_0                -6.845011e-01 1 1  ON 20
 eO_1                -4.095813e-01 1 1  ON 21
 eO_2                -5.053526e-02 1 1  ON 22
 eO_3                 1.711038e-01 1 1  ON 23
 eO_4                 2.562093e-01 1 1  ON 24
 eO_5                 2.945767e-01 1 1  ON 25
 eO_6                 2.506850e-01 1 1  ON 26
 eO_7                 1.153418e-01 1 1  ON 27
 eO_8                 2.784779e-02 1 1  ON 28
 eO_9                 1.836684e-02 1 1  ON 29
eH1_0                -1.941486e-01 1 1  ON 30
eH1_1                -9.676288e-02 1 1  ON 31
eH1_2                -5.027836e-02 1 1  ON 32
eH1_3                -1.968907e-02 1 1  ON 33
eH1_4                 1.696844e-02 1 1  ON 34
eH1_5                 2.492512e-02 1 1  ON 35
eH1_6                 7.736544e-02 1 1  ON 36
eH1_7                 1.108704e-01 1 1  ON 37
eH1_8                 9.141352e-02 1 1  ON 38
eH1_9                 2.416471e-02 1 1  ON 39
eH2_0                -1.949407e-01 1 1  ON 40
eH2_1                -9.727113e-02 1 1  ON 41
eH2_2                -5.123316e-02 1 1  ON 42
eH2_3                -2.089786e-02 1 1  ON 43
eH2_4                 1.584476e-02 1 1  ON 44
eH2_5                 2.467483e-02 1 1  ON 45
eH2_6                 7.671364e-02 1 1  ON 46
eH2_7                 1.132190e-01 1 1  ON 47
eH2_8                 9.554512e-02 1 1  ON 48
eH2_9                 2.637429e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2205
    reference variance = 0.23271
====================================================
  Execution time = 1.9861e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9095e-01
  Total weights = 2.0000e+06
  Execution time = 1.8356e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291101312862
                                         uncertainty =       0.004291384254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291101312862
                                         uncertainty =       0.004291384254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381443218
  error estimate for blocks of size 2^( 2) =       0.000395041658
  error estimate for blocks of size 2^( 3) =       0.000406684739
  error estimate for blocks of size 2^( 4) =       0.000414840105
  error estimate for blocks of size 2^( 5) =       0.000419817953
  error estimate for blocks of size 2^( 6) =       0.000421879259
  error estimate for blocks of size 2^( 7) =       0.000424974286

      target function =      -0.926536803529
              le_mean =     -17.212394475473
             les_mean =     296.557521290237
             stat err =       0.000420377901
             autocorr =       1.214562758120
   target nu stat err =       0.000420377901
   target dn stat err =       0.004289748001
      target stat err =       0.007040418030
              std dev =       0.539442171544
             le_variance =       0.290997856440

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290988058011
                                         uncertainty =       0.004289642916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290988058011
                                         uncertainty =       0.004289642916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381369020
  error estimate for blocks of size 2^( 2) =       0.000394984644
  error estimate for blocks of size 2^( 3) =       0.000406660733
  error estimate for blocks of size 2^( 4) =       0.000414861827
  error estimate for blocks of size 2^( 5) =       0.000419862747
  error estimate for blocks of size 2^( 6) =       0.000421937880
  error estimate for blocks of size 2^( 7) =       0.000425026495

      target function =      -0.926721739398
              le_mean =     -17.212391593153
             les_mean =     296.557308869024
             stat err =       0.000420422237
             autocorr =       1.215291712599
   target nu stat err =       0.000420422237
   target dn stat err =       0.004287986346
      target stat err =       0.007040322356
              std dev =       0.539337239972
             le_variance =       0.290884658421

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291022493347
                                         uncertainty =       0.004290190308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291022493347
                                         uncertainty =       0.004290190308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381391580
  error estimate for blocks of size 2^( 2) =       0.000394998752
  error estimate for blocks of size 2^( 3) =       0.000406659822
  error estimate for blocks of size 2^( 4) =       0.000414841078
  error estimate for blocks of size 2^( 5) =       0.000419832159
  error estimate for blocks of size 2^( 6) =       0.000421901193
  error estimate for blocks of size 2^( 7) =       0.000424992250

      target function =      -0.926665575862
              le_mean =     -17.212390881788
             les_mean =     296.557318796095
             stat err =       0.000420391670
             autocorr =       1.214971255267
   target nu stat err =       0.000420391670
   target dn stat err =       0.004288537489
      target stat err =       0.007040353393
              std dev =       0.539369144567
             le_variance =       0.290919074111

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291089268219
                                         uncertainty =       0.004291219857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291089268219
                                         uncertainty =       0.004291219857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381435327
  error estimate for blocks of size 2^( 2) =       0.000395034744
  error estimate for blocks of size 2^( 3) =       0.000406680018
  error estimate for blocks of size 2^( 4) =       0.000414838664
  error estimate for blocks of size 2^( 5) =       0.000419818183
  error estimate for blocks of size 2^( 6) =       0.000421880463
  error estimate for blocks of size 2^( 7) =       0.000424974954

      target function =      -0.926556489954
              le_mean =     -17.212393703478
             les_mean =     296.557482674894
             stat err =       0.000420378066
             autocorr =       1.214613966139
   target nu stat err =       0.000420378066
   target dn stat err =       0.004289581543
      target stat err =       0.007040435059
              std dev =       0.539431012126
             le_variance =       0.290985816843


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926536803529        initial
     2.5000e-01     2.5000e+00             1.8966e-03        -0.926721739398  <--
     1.0000e+00     1.0000e+01             4.8979e-04        -0.926665575862
     4.0000e+00     4.0000e+01             1.2220e-04        -0.926556489954

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.9191e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.976437e-01 1 1  ON 0
 uu_1                 4.321713e-02 1 1  ON 1
 uu_2                -4.191660e-02 1 1  ON 2
 uu_3                -9.236801e-02 1 1  ON 3
 uu_4                -1.238024e-01 1 1  ON 4
 uu_5                -1.319604e-01 1 1  ON 5
 uu_6                -1.107849e-01 1 1  ON 6
 uu_7                -4.234240e-02 1 1  ON 7
 uu_8                 8.687921e-02 1 1  ON 8
 uu_9                 1.220052e-01 1 1  ON 9
 ud_0                 3.029403e-01 1 1  ON 10
 ud_1                 7.600588e-02 1 1  ON 11
 ud_2                -1.823983e-02 1 1  ON 12
 ud_3                -6.865023e-02 1 1  ON 13
 ud_4                -1.084660e-01 1 1  ON 14
 ud_5                -1.359476e-01 1 1  ON 15
 ud_6                -1.372912e-01 1 1  ON 16
 ud_7                -9.629490e-02 1 1  ON 17
 ud_8                 1.572094e-03 1 1  ON 18
 ud_9                 9.067897e-02 1 1  ON 19
 eO_0                -6.845649e-01 1 1  ON 20
 eO_1                -4.098011e-01 1 1  ON 21
 eO_2                -4.983899e-02 1 1  ON 22
 eO_3                 1.713622e-01 1 1  ON 23
 eO_4                 2.550412e-01 1 1  ON 24
 eO_5                 2.933929e-01 1 1  ON 25
 eO_6                 2.513297e-01 1 1  ON 26
 eO_7                 1.162406e-01 1 1  ON 27
 eO_8                 2.795314e-02 1 1  ON 28
 eO_9                 1.836826e-02 1 1  ON 29
eH1_0                -1.949899e-01 1 1  ON 30
eH1_1                -9.644172e-02 1 1  ON 31
eH1_2                -4.954333e-02 1 1  ON 32
eH1_3                -1.918863e-02 1 1  ON 33
eH1_4                 1.663466e-02 1 1  ON 34
eH1_5                 2.438843e-02 1 1  ON 35
eH1_6                 7.698374e-02 1 1  ON 36
eH1_7                 1.107898e-01 1 1  ON 37
eH1_8                 9.189457e-02 1 1  ON 38
eH1_9                 2.424861e-02 1 1  ON 39
eH2_0                -1.959270e-01 1 1  ON 40
eH2_1                -9.721486e-02 1 1  ON 41
eH2_2                -5.050350e-02 1 1  ON 42
eH2_3                -2.032012e-02 1 1  ON 43
eH2_4                 1.554192e-02 1 1  ON 44
eH2_5                 2.439759e-02 1 1  ON 45
eH2_6                 7.664910e-02 1 1  ON 46
eH2_7                 1.129751e-01 1 1  ON 47
eH2_8                 9.594581e-02 1 1  ON 48
eH2_9                 2.645346e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5037e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1586
    reference variance = 0.23291
====================================================
  Execution time = 2.0241e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7622e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5818e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276245871142
                                         uncertainty =       0.002099478299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276245871142
                                         uncertainty =       0.002099478299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371634751
  error estimate for blocks of size 2^( 2) =       0.000385329370
  error estimate for blocks of size 2^( 3) =       0.000397864889
  error estimate for blocks of size 2^( 4) =       0.000406976716
  error estimate for blocks of size 2^( 5) =       0.000412344811
  error estimate for blocks of size 2^( 6) =       0.000414697872
  error estimate for blocks of size 2^( 7) =       0.000418597282

      target function =      -0.951331479022
              le_mean =     -17.212169699578
             les_mean =     296.535010405723
             stat err =       0.000413154170
             autocorr =       1.235923658617
   target nu stat err =       0.000413154170
   target dn stat err =       0.002194211812
      target stat err =       0.003846880323
              std dev =       0.525570905565
             le_variance =       0.276224776776


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721216969958e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951345887693       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951581841869       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951634502965       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.951694413868       residual = 8.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.951738243677       residual = 4.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.951766627458       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.951791331753       residual = 4.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.951808452850       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.951815871000       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.951824074185       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.951825940024       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.951830013167       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.951831750969       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.951838490741       residual = 9.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.951840366856       residual = 7.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.951841849064       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.951844199121       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.951844497770       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.951844901409       residual = 7.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.951845266063       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.951845664639       residual = 6.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.951847021338       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.951846865709       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.951846933334       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.951846974428       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.951846849099       residual = 7.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-02 is 6.390095e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951345887693       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951447308166       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951472418501       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.951493880247       residual = 9.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.951512256679       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.951523312557       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.951533183077       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.951541065776       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.951544263820       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.951547039521       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.951547736242       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.951549198389       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.951549886535       residual = 9.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.951551895146       residual = 5.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.951552282737       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.951552608739       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.951553003078       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.951552951126       residual = 5.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.951553040242       residual = 4.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.951553134658       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.951553111990       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.951553457155       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.951553380564       residual = 8.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.951553359949       residual = 7.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 1.757027e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951345887693       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951376800869       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951384815343       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.951390959450       residual = 9.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.951396338206       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.951399572643       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.951402569274       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.951404867580       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.951405847235       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.951406600577       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.951406805711       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.951407216275       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.951407419206       residual = 7.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.951407922990       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.951408000563       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.951408072879       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.951408135713       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.951408121765       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.951408146912       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.951408168984       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.951408155891       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.951408236666       residual = 7.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.951408213038       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.951408208084       residual = 4.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 4.638530e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.137872 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5854e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.985995e-01 1 1  ON 0
 uu_1                 4.408168e-02 1 1  ON 1
 uu_2                -4.154666e-02 1 1  ON 2
 uu_3                -9.222144e-02 1 1  ON 3
 uu_4                -1.234938e-01 1 1  ON 4
 uu_5                -1.316054e-01 1 1  ON 5
 uu_6                -1.112422e-01 1 1  ON 6
 uu_7                -4.368310e-02 1 1  ON 7
 uu_8                 8.515966e-02 1 1  ON 8
 uu_9                 1.221791e-01 1 1  ON 9
 ud_0                 3.026328e-01 1 1  ON 10
 ud_1                 7.616750e-02 1 1  ON 11
 ud_2                -1.875973e-02 1 1  ON 12
 ud_3                -6.929727e-02 1 1  ON 13
 ud_4                -1.084306e-01 1 1  ON 14
 ud_5                -1.348203e-01 1 1  ON 15
 ud_6                -1.359291e-01 1 1  ON 16
 ud_7                -9.594365e-02 1 1  ON 17
 ud_8                -1.849332e-04 1 1  ON 18
 ud_9                 9.054510e-02 1 1  ON 19
 eO_0                -6.853258e-01 1 1  ON 20
 eO_1                -4.101056e-01 1 1  ON 21
 eO_2                -4.877524e-02 1 1  ON 22
 eO_3                 1.720862e-01 1 1  ON 23
 eO_4                 2.543077e-01 1 1  ON 24
 eO_5                 2.925020e-01 1 1  ON 25
 eO_6                 2.514263e-01 1 1  ON 26
 eO_7                 1.170797e-01 1 1  ON 27
 eO_8                 2.792219e-02 1 1  ON 28
 eO_9                 1.835423e-02 1 1  ON 29
eH1_0                -1.964677e-01 1 1  ON 30
eH1_1                -9.630823e-02 1 1  ON 31
eH1_2                -4.850405e-02 1 1  ON 32
eH1_3                -1.834446e-02 1 1  ON 33
eH1_4                 1.688826e-02 1 1  ON 34
eH1_5                 2.378091e-02 1 1  ON 35
eH1_6                 7.665913e-02 1 1  ON 36
eH1_7                 1.104175e-01 1 1  ON 37
eH1_8                 9.239582e-02 1 1  ON 38
eH1_9                 2.428053e-02 1 1  ON 39
eH2_0                -1.969794e-01 1 1  ON 40
eH2_1                -9.722778e-02 1 1  ON 41
eH2_2                -4.958027e-02 1 1  ON 42
eH2_3                -1.961403e-02 1 1  ON 43
eH2_4                 1.571247e-02 1 1  ON 44
eH2_5                 2.405903e-02 1 1  ON 45
eH2_6                 7.613757e-02 1 1  ON 46
eH2_7                 1.126826e-01 1 1  ON 47
eH2_8                 9.623478e-02 1 1  ON 48
eH2_9                 2.658515e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.237
    reference variance = 0.172749
====================================================
  Execution time = 2.0006e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7638e-01
  Total weights = 2.0000e+06
  Execution time = 1.8227e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276287381906
                                         uncertainty =       0.002046377816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276287381906
                                         uncertainty =       0.002046377816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371669045
  error estimate for blocks of size 2^( 2) =       0.000385680990
  error estimate for blocks of size 2^( 3) =       0.000397496871
  error estimate for blocks of size 2^( 4) =       0.000406758048
  error estimate for blocks of size 2^( 5) =       0.000411403792
  error estimate for blocks of size 2^( 6) =       0.000414059631
  error estimate for blocks of size 2^( 7) =       0.000415139496

      target function =      -0.951242502957
              le_mean =     -17.211700260587
             les_mean =     296.518901480753
             stat err =       0.000411840242
             autocorr =       1.227848476649
   target nu stat err =       0.000411840242
   target dn stat err =       0.002182090520
      target stat err =       0.003821857920
              std dev =       0.525619404705
             le_variance =       0.276275758603

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276600004602
                                         uncertainty =       0.002059575094

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276600004602
                                         uncertainty =       0.002059575094

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371879417
  error estimate for blocks of size 2^( 2) =       0.000385898457
  error estimate for blocks of size 2^( 3) =       0.000397773745
  error estimate for blocks of size 2^( 4) =       0.000407117280
  error estimate for blocks of size 2^( 5) =       0.000411820469
  error estimate for blocks of size 2^( 6) =       0.000414499474
  error estimate for blocks of size 2^( 7) =       0.000415560652

      target function =      -0.950705138297
              le_mean =     -17.211685647572
             les_mean =     296.518711294559
             stat err =       0.000412249469
             autocorr =       1.228898248879
   target nu stat err =       0.000412249469
   target dn stat err =       0.002195014868
      target stat err =       0.003839416684
              std dev =       0.525916915506
             le_variance =       0.276588602015

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276551702982
                                         uncertainty =       0.002057811866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276551702982
                                         uncertainty =       0.002057811866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371846942
  error estimate for blocks of size 2^( 2) =       0.000385858821
  error estimate for blocks of size 2^( 3) =       0.000397717048
  error estimate for blocks of size 2^( 4) =       0.000407041743
  error estimate for blocks of size 2^( 5) =       0.000411732662
  error estimate for blocks of size 2^( 6) =       0.000414407590
  error estimate for blocks of size 2^( 7) =       0.000415462807

      target function =      -0.950788054698
              le_mean =     -17.211683627215
             les_mean =     296.518593441015
             stat err =       0.000412161201
             autocorr =       1.228586630806
   target nu stat err =       0.000412161201
   target dn stat err =       0.002193300280
      target stat err =       0.003837141246
              std dev =       0.525870987928
             le_variance =       0.276540295945

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276314644841
                                         uncertainty =       0.002048094180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276314644841
                                         uncertainty =       0.002048094180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371687406
  error estimate for blocks of size 2^( 2) =       0.000385697899
  error estimate for blocks of size 2^( 3) =       0.000397518771
  error estimate for blocks of size 2^( 4) =       0.000406788571
  error estimate for blocks of size 2^( 5) =       0.000411440555
  error estimate for blocks of size 2^( 6) =       0.000414099062
  error estimate for blocks of size 2^( 7) =       0.000415174591

      target function =      -0.951195567048
              le_mean =     -17.211695150211
             les_mean =     296.518752861916
             stat err =       0.000411875695
             autocorr =       1.227938555973
   target nu stat err =       0.000411875695
   target dn stat err =       0.002183774755
      target stat err =       0.003824301263
              std dev =       0.525645371194
             le_variance =       0.276303056257


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.951242502957        initial  <--
     6.2500e-02     6.2500e-01             6.3901e-03        -0.950705138297
     2.5000e-01     2.5000e+00             1.7570e-03        -0.950788054698
     1.0000e+00     1.0000e+01             4.6385e-04        -0.951195567048

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2946
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.976437e-01 1 1  ON 0
 uu_1                 4.321713e-02 1 1  ON 1
 uu_2                -4.191660e-02 1 1  ON 2
 uu_3                -9.236801e-02 1 1  ON 3
 uu_4                -1.238024e-01 1 1  ON 4
 uu_5                -1.319604e-01 1 1  ON 5
 uu_6                -1.107849e-01 1 1  ON 6
 uu_7                -4.234240e-02 1 1  ON 7
 uu_8                 8.687921e-02 1 1  ON 8
 uu_9                 1.220052e-01 1 1  ON 9
 ud_0                 3.029403e-01 1 1  ON 10
 ud_1                 7.600588e-02 1 1  ON 11
 ud_2                -1.823983e-02 1 1  ON 12
 ud_3                -6.865023e-02 1 1  ON 13
 ud_4                -1.084660e-01 1 1  ON 14
 ud_5                -1.359476e-01 1 1  ON 15
 ud_6                -1.372912e-01 1 1  ON 16
 ud_7                -9.629490e-02 1 1  ON 17
 ud_8                 1.572094e-03 1 1  ON 18
 ud_9                 9.067897e-02 1 1  ON 19
 eO_0                -6.845649e-01 1 1  ON 20
 eO_1                -4.098011e-01 1 1  ON 21
 eO_2                -4.983899e-02 1 1  ON 22
 eO_3                 1.713622e-01 1 1  ON 23
 eO_4                 2.550412e-01 1 1  ON 24
 eO_5                 2.933929e-01 1 1  ON 25
 eO_6                 2.513297e-01 1 1  ON 26
 eO_7                 1.162406e-01 1 1  ON 27
 eO_8                 2.795314e-02 1 1  ON 28
 eO_9                 1.836826e-02 1 1  ON 29
eH1_0                -1.949899e-01 1 1  ON 30
eH1_1                -9.644172e-02 1 1  ON 31
eH1_2                -4.954333e-02 1 1  ON 32
eH1_3                -1.918863e-02 1 1  ON 33
eH1_4                 1.663466e-02 1 1  ON 34
eH1_5                 2.438843e-02 1 1  ON 35
eH1_6                 7.698374e-02 1 1  ON 36
eH1_7                 1.107898e-01 1 1  ON 37
eH1_8                 9.189457e-02 1 1  ON 38
eH1_9                 2.424861e-02 1 1  ON 39
eH2_0                -1.959270e-01 1 1  ON 40
eH2_1                -9.721486e-02 1 1  ON 41
eH2_2                -5.050350e-02 1 1  ON 42
eH2_3                -2.032012e-02 1 1  ON 43
eH2_4                 1.554192e-02 1 1  ON 44
eH2_5                 2.439759e-02 1 1  ON 45
eH2_6                 7.664910e-02 1 1  ON 46
eH2_7                 1.129751e-01 1 1  ON 47
eH2_8                 9.594581e-02 1 1  ON 48
eH2_9                 2.645346e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5155e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2466
    reference variance = 0.208829
====================================================
  Execution time = 2.0347e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7653e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5685e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276315811896
                                         uncertainty =       0.002606402794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276315811896
                                         uncertainty =       0.002606402794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371837052
  error estimate for blocks of size 2^( 2) =       0.000385940255
  error estimate for blocks of size 2^( 3) =       0.000398178775
  error estimate for blocks of size 2^( 4) =       0.000408046012
  error estimate for blocks of size 2^( 5) =       0.000414119372
  error estimate for blocks of size 2^( 6) =       0.000417604248
  error estimate for blocks of size 2^( 7) =       0.000419369808

      target function =      -0.950812969855
              le_mean =     -17.211965003364
             les_mean =     296.528264724753
             stat err =       0.000414784860
             autocorr =       1.244344022711
   target nu stat err =       0.000414784860
   target dn stat err =       0.002261649734
      target stat err =       0.003955502456
              std dev =       0.525857001478
             le_variance =       0.276525586004


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721196500336e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950828478341       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950862223198       residual = 9.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950871608831       residual = 9.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.950879737812       residual = 8.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950886124767       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.950888847007       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.950890613521       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.950894690637       residual = 7.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.950895845565       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.950896615640       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.950897580029       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.950899068952       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.950899971955       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.950900472950       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.950901223317       residual = 5.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.950901255244       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.950901582019       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.950901510685       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.950901403503       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.950901389347       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.950901404052       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.950901405212       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.950901460662       residual = 5.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.950901442091       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.950901402861       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 9.654048e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950828478341       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950837688166       residual = 9.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950840291542       residual = 9.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.950842506802       residual = 8.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950844170887       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.950844892765       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.950845359691       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.950846461198       residual = 7.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.950846771214       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.950846976910       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.950847242361       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.950847636314       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.950847843508       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.950847963725       residual = 9.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.950848138853       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.950848139077       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.950848212900       residual = 7.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.950848193419       residual = 4.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.950848166213       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.950848164415       residual = 9.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.950848167886       residual = 9.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.950848168202       residual = 7.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.950848181129       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.950848176519       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.950848168010       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 2.449894e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950828478341       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950830834818       residual = 9.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950831503727       residual = 9.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.950832071344       residual = 8.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950832490893       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.950832674057       residual = 2.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.950832792590       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.950833073471       residual = 7.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.950833152439       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.950833204728       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.950833272871       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.950833373301       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.950833423050       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.950833452757       residual = 9.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.950833495609       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.950833495174       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.950833513106       residual = 6.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.950833508134       residual = 4.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.950833501335       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.950833501002       residual = 9.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.950833501854       residual = 8.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.950833501941       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.950833505109       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.950833503962       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.950833501918       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 6.148109e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.166692 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9517e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 1.976680e-01 1 1  ON 0
 uu_1                 4.324213e-02 1 1  ON 1
 uu_2                -4.192083e-02 1 1  ON 2
 uu_3                -9.236871e-02 1 1  ON 3
 uu_4                -1.237852e-01 1 1  ON 4
 uu_5                -1.319243e-01 1 1  ON 5
 uu_6                -1.107173e-01 1 1  ON 6
 uu_7                -4.237075e-02 1 1  ON 7
 uu_8                 8.663422e-02 1 1  ON 8
 uu_9                 1.220309e-01 1 1  ON 9
 ud_0                 3.028666e-01 1 1  ON 10
 ud_1                 7.598400e-02 1 1  ON 11
 ud_2                -1.833973e-02 1 1  ON 12
 ud_3                -6.876017e-02 1 1  ON 13
 ud_4                -1.084958e-01 1 1  ON 14
 ud_5                -1.358090e-01 1 1  ON 15
 ud_6                -1.370906e-01 1 1  ON 16
 ud_7                -9.623396e-02 1 1  ON 17
 ud_8                 1.439766e-03 1 1  ON 18
 ud_9                 9.067894e-02 1 1  ON 19
 eO_0                -6.845583e-01 1 1  ON 20
 eO_1                -4.097995e-01 1 1  ON 21
 eO_2                -4.971151e-02 1 1  ON 22
 eO_3                 1.714064e-01 1 1  ON 23
 eO_4                 2.548851e-01 1 1  ON 24
 eO_5                 2.931828e-01 1 1  ON 25
 eO_6                 2.513808e-01 1 1  ON 26
 eO_7                 1.163641e-01 1 1  ON 27
 eO_8                 2.795635e-02 1 1  ON 28
 eO_9                 1.837287e-02 1 1  ON 29
eH1_0                -1.950951e-01 1 1  ON 30
eH1_1                -9.636662e-02 1 1  ON 31
eH1_2                -4.940470e-02 1 1  ON 32
eH1_3                -1.907794e-02 1 1  ON 33
eH1_4                 1.663308e-02 1 1  ON 34
eH1_5                 2.431489e-02 1 1  ON 35
eH1_6                 7.678412e-02 1 1  ON 36
eH1_7                 1.107443e-01 1 1  ON 37
eH1_8                 9.197378e-02 1 1  ON 38
eH1_9                 2.426529e-02 1 1  ON 39
eH2_0                -1.960374e-01 1 1  ON 40
eH2_1                -9.716272e-02 1 1  ON 41
eH2_2                -5.038765e-02 1 1  ON 42
eH2_3                -2.023148e-02 1 1  ON 43
eH2_4                 1.551740e-02 1 1  ON 44
eH2_5                 2.433108e-02 1 1  ON 45
eH2_6                 7.658175e-02 1 1  ON 46
eH2_7                 1.129419e-01 1 1  ON 47
eH2_8                 9.598800e-02 1 1  ON 48
eH2_9                 2.645661e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.317
    reference variance = 0.272477
====================================================
  Execution time = 2.0036e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8230e-01
  Total weights = 2.0000e+06
  Execution time = 1.8183e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282299034037
                                         uncertainty =       0.005775048492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282299034037
                                         uncertainty =       0.005775048492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375700100
  error estimate for blocks of size 2^( 2) =       0.000389066734
  error estimate for blocks of size 2^( 3) =       0.000401703888
  error estimate for blocks of size 2^( 4) =       0.000410458476
  error estimate for blocks of size 2^( 5) =       0.000416710019
  error estimate for blocks of size 2^( 6) =       0.000420967969
  error estimate for blocks of size 2^( 7) =       0.000422631830

      target function =      -0.940943446951
              le_mean =     -17.211606143356
             les_mean =     296.521687022627
             stat err =       0.000417692074
             autocorr =       1.236032377353
   target nu stat err =       0.000417692074
   target dn stat err =       0.004982486053
      target stat err =       0.008407660064
              std dev =       0.531320176324
             le_variance =       0.282301129769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282298617030
                                         uncertainty =       0.005775242007

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282298617030
                                         uncertainty =       0.005775242007

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375699736
  error estimate for blocks of size 2^( 2) =       0.000389072680
  error estimate for blocks of size 2^( 3) =       0.000401724508
  error estimate for blocks of size 2^( 4) =       0.000410497371
  error estimate for blocks of size 2^( 5) =       0.000416761453
  error estimate for blocks of size 2^( 6) =       0.000421021497
  error estimate for blocks of size 2^( 7) =       0.000422688935

      target function =      -0.940944310379
              le_mean =     -17.211609656735
             les_mean =     296.521807418295
             stat err =       0.000417742314
             autocorr =       1.236332131359
   target nu stat err =       0.000417742314
   target dn stat err =       0.004982450060
      target stat err =       0.008407679220
              std dev =       0.531319662375
             le_variance =       0.282300583626

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282298223527
                                         uncertainty =       0.005775156967

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282298223527
                                         uncertainty =       0.005775156967

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375699513
  error estimate for blocks of size 2^( 2) =       0.000389069264
  error estimate for blocks of size 2^( 3) =       0.000401714028
  error estimate for blocks of size 2^( 4) =       0.000410478194
  error estimate for blocks of size 2^( 5) =       0.000416736339
  error estimate for blocks of size 2^( 6) =       0.000420995282
  error estimate for blocks of size 2^( 7) =       0.000422661115

      target function =      -0.940944902371
              le_mean =     -17.211607821277
             les_mean =     296.521743900490
             stat err =       0.000417717733
             autocorr =       1.236188103024
   target nu stat err =       0.000417717733
   target dn stat err =       0.004982470386
      target stat err =       0.008407690595
              std dev =       0.531319346724
             le_variance =       0.282300248204

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282298803985
                                         uncertainty =       0.005775062243

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282298803985
                                         uncertainty =       0.005775062243

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375699941
  error estimate for blocks of size 2^( 2) =       0.000389066952
  error estimate for blocks of size 2^( 3) =       0.000401705057
  error estimate for blocks of size 2^( 4) =       0.000410460851
  error estimate for blocks of size 2^( 5) =       0.000416713227
  error estimate for blocks of size 2^( 6) =       0.000420971297
  error estimate for blocks of size 2^( 7) =       0.000422635409

      target function =      -0.940943846010
              le_mean =     -17.211606327748
             les_mean =     296.521693130826
             stat err =       0.000417695196
             autocorr =       1.236051904274
   target nu stat err =       0.000417695196
   target dn stat err =       0.004982484019
      target stat err =       0.008407667201
              std dev =       0.531319951256
             le_variance =       0.282300890603


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940943446951        initial
     6.2500e-01     6.2500e+00             9.6540e-04        -0.940944310379
     2.5000e+00     2.5000e+01             2.4499e-04        -0.940944902371  <--
     1.0000e+01     1.0000e+02             6.1481e-05        -0.940943846010

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.9234e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 1.976680e-01 1 1  ON 0
 uu_1                 4.324213e-02 1 1  ON 1
 uu_2                -4.192083e-02 1 1  ON 2
 uu_3                -9.236871e-02 1 1  ON 3
 uu_4                -1.237852e-01 1 1  ON 4
 uu_5                -1.319243e-01 1 1  ON 5
 uu_6                -1.107173e-01 1 1  ON 6
 uu_7                -4.237075e-02 1 1  ON 7
 uu_8                 8.663422e-02 1 1  ON 8
 uu_9                 1.220309e-01 1 1  ON 9
 ud_0                 3.028666e-01 1 1  ON 10
 ud_1                 7.598400e-02 1 1  ON 11
 ud_2                -1.833973e-02 1 1  ON 12
 ud_3                -6.876017e-02 1 1  ON 13
 ud_4                -1.084958e-01 1 1  ON 14
 ud_5                -1.358090e-01 1 1  ON 15
 ud_6                -1.370906e-01 1 1  ON 16
 ud_7                -9.623396e-02 1 1  ON 17
 ud_8                 1.439766e-03 1 1  ON 18
 ud_9                 9.067894e-02 1 1  ON 19
 eO_0                -6.845583e-01 1 1  ON 20
 eO_1                -4.097995e-01 1 1  ON 21
 eO_2                -4.971151e-02 1 1  ON 22
 eO_3                 1.714064e-01 1 1  ON 23
 eO_4                 2.548851e-01 1 1  ON 24
 eO_5                 2.931828e-01 1 1  ON 25
 eO_6                 2.513808e-01 1 1  ON 26
 eO_7                 1.163641e-01 1 1  ON 27
 eO_8                 2.795635e-02 1 1  ON 28
 eO_9                 1.837287e-02 1 1  ON 29
eH1_0                -1.950951e-01 1 1  ON 30
eH1_1                -9.636662e-02 1 1  ON 31
eH1_2                -4.940470e-02 1 1  ON 32
eH1_3                -1.907794e-02 1 1  ON 33
eH1_4                 1.663308e-02 1 1  ON 34
eH1_5                 2.431489e-02 1 1  ON 35
eH1_6                 7.678412e-02 1 1  ON 36
eH1_7                 1.107443e-01 1 1  ON 37
eH1_8                 9.197378e-02 1 1  ON 38
eH1_9                 2.426529e-02 1 1  ON 39
eH2_0                -1.960374e-01 1 1  ON 40
eH2_1                -9.716272e-02 1 1  ON 41
eH2_2                -5.038765e-02 1 1  ON 42
eH2_3                -2.023148e-02 1 1  ON 43
eH2_4                 1.551740e-02 1 1  ON 44
eH2_5                 2.433108e-02 1 1  ON 45
eH2_6                 7.658175e-02 1 1  ON 46
eH2_7                 1.129419e-01 1 1  ON 47
eH2_8                 9.598800e-02 1 1  ON 48
eH2_9                 2.645661e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8767e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7228e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2149
    reference variance = 0.472067
====================================================
  Execution time = 2.0431e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8115e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6290e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281066440801
                                         uncertainty =       0.003194076357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281066440801
                                         uncertainty =       0.003194076357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374935130
  error estimate for blocks of size 2^( 2) =       0.000388229881
  error estimate for blocks of size 2^( 3) =       0.000400578793
  error estimate for blocks of size 2^( 4) =       0.000408780928
  error estimate for blocks of size 2^( 5) =       0.000414195627
  error estimate for blocks of size 2^( 6) =       0.000416158387
  error estimate for blocks of size 2^( 7) =       0.000416766199

      target function =      -0.942917835116
              le_mean =     -17.211712994342
             les_mean =     296.524216763049
             stat err =       0.000413975286
             autocorr =       1.219092219837
   target nu stat err =       0.000413975286
   target dn stat err =       0.003337640729
      target stat err =       0.005682855976
              std dev =       0.530238346429
             le_variance =       0.281152704024


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721171299434e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942951228538       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943000342812       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943015039017       residual = 9.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943022314454       residual = 9.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943035397111       residual = 5.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943042274075       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943045213287       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943047676604       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943049989130       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943050729927       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943051047093       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943051937745       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943052838718       residual = 9.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943053115189       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943053571091       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943053609350       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943053647860       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943053861630       residual = 5.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943053990060       residual = 7.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943054063935       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943054072387       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943054254279       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943054235149       residual = 4.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943054213148       residual = 9.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e-01 is 8.289324e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942951228538       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942964626671       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942968683970       residual = 8.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942970690513       residual = 9.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942974126175       residual = 5.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942975973813       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942976756034       residual = 3.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942977410003       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942978025979       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942978211181       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.942978296008       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.942978525908       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.942978762234       residual = 9.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.942978821685       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.942978934860       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.942978941021       residual = 2.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.942978952843       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.942979000696       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.942979033027       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.942979049800       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.942979051370       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.942979092155       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.942979087217       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.942979081934       residual = 7.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 2.227408e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942951228538       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942954656201       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942955697374       residual = 8.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942956214060       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942957082547       residual = 5.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942957552895       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942957751847       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942957917729       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942958074249       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942958120498       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.942958142068       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.942958200033       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.942958259827       residual = 8.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.942958273983       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.942958302187       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.942958303509       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.942958306634       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.942958318199       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.942958326309       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.942958330365       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.942958330726       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.942958340614       residual = 9.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.942958339373       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.942958338071       residual = 6.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 5.676913e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.185092 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6089e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 1.977869e-01 1 1  ON 0
 uu_1                 4.331432e-02 1 1  ON 1
 uu_2                -4.188748e-02 1 1  ON 2
 uu_3                -9.237633e-02 1 1  ON 3
 uu_4                -1.237787e-01 1 1  ON 4
 uu_5                -1.319275e-01 1 1  ON 5
 uu_6                -1.107809e-01 1 1  ON 6
 uu_7                -4.238865e-02 1 1  ON 7
 uu_8                 8.642365e-02 1 1  ON 8
 uu_9                 1.220470e-01 1 1  ON 9
 ud_0                 3.027605e-01 1 1  ON 10
 ud_1                 7.595122e-02 1 1  ON 11
 ud_2                -1.845537e-02 1 1  ON 12
 ud_3                -6.888177e-02 1 1  ON 13
 ud_4                -1.085103e-01 1 1  ON 14
 ud_5                -1.357011e-01 1 1  ON 15
 ud_6                -1.369213e-01 1 1  ON 16
 ud_7                -9.602737e-02 1 1  ON 17
 ud_8                 1.307944e-03 1 1  ON 18
 ud_9                 9.066287e-02 1 1  ON 19
 eO_0                -6.846137e-01 1 1  ON 20
 eO_1                -4.098485e-01 1 1  ON 21
 eO_2                -4.962780e-02 1 1  ON 22
 eO_3                 1.714886e-01 1 1  ON 23
 eO_4                 2.548598e-01 1 1  ON 24
 eO_5                 2.929963e-01 1 1  ON 25
 eO_6                 2.514046e-01 1 1  ON 26
 eO_7                 1.164814e-01 1 1  ON 27
 eO_8                 2.796359e-02 1 1  ON 28
 eO_9                 1.837214e-02 1 1  ON 29
eH1_0                -1.953178e-01 1 1  ON 30
eH1_1                -9.637410e-02 1 1  ON 31
eH1_2                -4.931277e-02 1 1  ON 32
eH1_3                -1.898466e-02 1 1  ON 33
eH1_4                 1.665704e-02 1 1  ON 34
eH1_5                 2.428221e-02 1 1  ON 35
eH1_6                 7.673067e-02 1 1  ON 36
eH1_7                 1.107476e-01 1 1  ON 37
eH1_8                 9.206284e-02 1 1  ON 38
eH1_9                 2.427815e-02 1 1  ON 39
eH2_0                -1.961819e-01 1 1  ON 40
eH2_1                -9.712008e-02 1 1  ON 41
eH2_2                -5.027030e-02 1 1  ON 42
eH2_3                -2.011616e-02 1 1  ON 43
eH2_4                 1.553450e-02 1 1  ON 44
eH2_5                 2.418377e-02 1 1  ON 45
eH2_6                 7.653851e-02 1 1  ON 46
eH2_7                 1.129361e-01 1 1  ON 47
eH2_8                 9.602221e-02 1 1  ON 48
eH2_9                 2.646538e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2171
    reference variance = 0.357757
====================================================
  Execution time = 2.0514e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8108e-01
  Total weights = 2.0000e+06
  Execution time = 1.8409e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281056753311
                                         uncertainty =       0.002118444409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281056753311
                                         uncertainty =       0.002118444409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374880915
  error estimate for blocks of size 2^( 2) =       0.000388751387
  error estimate for blocks of size 2^( 3) =       0.000401625514
  error estimate for blocks of size 2^( 4) =       0.000410874901
  error estimate for blocks of size 2^( 5) =       0.000416177329
  error estimate for blocks of size 2^( 6) =       0.000420007914
  error estimate for blocks of size 2^( 7) =       0.000420783584

      target function =      -0.943063075856
              le_mean =     -17.212361221958
             les_mean =     296.546450095821
             stat err =       0.000416960932
             autocorr =       1.237097890159
   target nu stat err =       0.000416960932
   target dn stat err =       0.002398896761
      target stat err =       0.004124092322
              std dev =       0.530161674581
             le_variance =       0.281071401195

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281100817258
                                         uncertainty =       0.002118446396

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281100817258
                                         uncertainty =       0.002118446396

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374910187
  error estimate for blocks of size 2^( 2) =       0.000388789445
  error estimate for blocks of size 2^( 3) =       0.000401679115
  error estimate for blocks of size 2^( 4) =       0.000410948396
  error estimate for blocks of size 2^( 5) =       0.000416266745
  error estimate for blocks of size 2^( 6) =       0.000420104688
  error estimate for blocks of size 2^( 7) =       0.000420884637

      target function =      -0.942988912591
              le_mean =     -17.212358400692
             les_mean =     296.546396869617
             stat err =       0.000417051116
             autocorr =       1.237439839979
   target nu stat err =       0.000417051116
   target dn stat err =       0.002398757185
      target stat err =       0.004123229502
              std dev =       0.530203070826
             le_variance =       0.281115296313

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281079327655
                                         uncertainty =       0.002118441618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281079327655
                                         uncertainty =       0.002118441618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374895909
  error estimate for blocks of size 2^( 2) =       0.000388770857
  error estimate for blocks of size 2^( 3) =       0.000401653076
  error estimate for blocks of size 2^( 4) =       0.000410912933
  error estimate for blocks of size 2^( 5) =       0.000416223799
  error estimate for blocks of size 2^( 6) =       0.000420058332
  error estimate for blocks of size 2^( 7) =       0.000420836249

      target function =      -0.943025092351
              le_mean =     -17.212359402598
             les_mean =     296.546409948445
             stat err =       0.000417007828
             autocorr =       1.237277211610
   target nu stat err =       0.000417007828
   target dn stat err =       0.002398818229
      target stat err =       0.004123635980
              std dev =       0.530182878627
             le_variance =       0.281093884790

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281059445173
                                         uncertainty =       0.002118443594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281059445173
                                         uncertainty =       0.002118443594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374882703
  error estimate for blocks of size 2^( 2) =       0.000388753724
  error estimate for blocks of size 2^( 3) =       0.000401628863
  error estimate for blocks of size 2^( 4) =       0.000410879568
  error estimate for blocks of size 2^( 5) =       0.000416183062
  error estimate for blocks of size 2^( 6) =       0.000420014148
  error estimate for blocks of size 2^( 7) =       0.000420790100

      target function =      -0.943058548368
              le_mean =     -17.212360951686
             les_mean =     296.546443472093
             stat err =       0.000416966720
             autocorr =       1.237120437049
   target nu stat err =       0.000416966720
   target dn stat err =       0.002398886326
      target stat err =       0.004124035783
              std dev =       0.530164202394
             le_variance =       0.281074081501


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943063075856        initial  <--
     6.2500e-01     6.2500e+00             8.2893e-04        -0.942988912591
     2.5000e+00     2.5000e+01             2.2274e-04        -0.943025092351
     1.0000e+01     1.0000e+02             5.6769e-05        -0.943058548368

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.7544
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 1.976680e-01 1 1  ON 0
 uu_1                 4.324213e-02 1 1  ON 1
 uu_2                -4.192083e-02 1 1  ON 2
 uu_3                -9.236871e-02 1 1  ON 3
 uu_4                -1.237852e-01 1 1  ON 4
 uu_5                -1.319243e-01 1 1  ON 5
 uu_6                -1.107173e-01 1 1  ON 6
 uu_7                -4.237075e-02 1 1  ON 7
 uu_8                 8.663422e-02 1 1  ON 8
 uu_9                 1.220309e-01 1 1  ON 9
 ud_0                 3.028666e-01 1 1  ON 10
 ud_1                 7.598400e-02 1 1  ON 11
 ud_2                -1.833973e-02 1 1  ON 12
 ud_3                -6.876017e-02 1 1  ON 13
 ud_4                -1.084958e-01 1 1  ON 14
 ud_5                -1.358090e-01 1 1  ON 15
 ud_6                -1.370906e-01 1 1  ON 16
 ud_7                -9.623396e-02 1 1  ON 17
 ud_8                 1.439766e-03 1 1  ON 18
 ud_9                 9.067894e-02 1 1  ON 19
 eO_0                -6.845583e-01 1 1  ON 20
 eO_1                -4.097995e-01 1 1  ON 21
 eO_2                -4.971151e-02 1 1  ON 22
 eO_3                 1.714064e-01 1 1  ON 23
 eO_4                 2.548851e-01 1 1  ON 24
 eO_5                 2.931828e-01 1 1  ON 25
 eO_6                 2.513808e-01 1 1  ON 26
 eO_7                 1.163641e-01 1 1  ON 27
 eO_8                 2.795635e-02 1 1  ON 28
 eO_9                 1.837287e-02 1 1  ON 29
eH1_0                -1.950951e-01 1 1  ON 30
eH1_1                -9.636662e-02 1 1  ON 31
eH1_2                -4.940470e-02 1 1  ON 32
eH1_3                -1.907794e-02 1 1  ON 33
eH1_4                 1.663308e-02 1 1  ON 34
eH1_5                 2.431489e-02 1 1  ON 35
eH1_6                 7.678412e-02 1 1  ON 36
eH1_7                 1.107443e-01 1 1  ON 37
eH1_8                 9.197378e-02 1 1  ON 38
eH1_9                 2.426529e-02 1 1  ON 39
eH2_0                -1.960374e-01 1 1  ON 40
eH2_1                -9.716272e-02 1 1  ON 41
eH2_2                -5.038765e-02 1 1  ON 42
eH2_3                -2.023148e-02 1 1  ON 43
eH2_4                 1.551740e-02 1 1  ON 44
eH2_5                 2.433108e-02 1 1  ON 45
eH2_6                 7.658175e-02 1 1  ON 46
eH2_7                 1.129419e-01 1 1  ON 47
eH2_8                 9.598800e-02 1 1  ON 48
eH2_9                 2.645661e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5850e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2859
    reference variance = 0.202604
====================================================
  Execution time = 2.0866e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8067e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5166e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280651667203
                                         uncertainty =       0.002566015238

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280651667203
                                         uncertainty =       0.002566015238

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374611850
  error estimate for blocks of size 2^( 2) =       0.000388209589
  error estimate for blocks of size 2^( 3) =       0.000400513014
  error estimate for blocks of size 2^( 4) =       0.000409364226
  error estimate for blocks of size 2^( 5) =       0.000414913996
  error estimate for blocks of size 2^( 6) =       0.000417254559
  error estimate for blocks of size 2^( 7) =       0.000418300609

      target function =      -0.943753977385
              le_mean =     -17.211730796042
             les_mean =     296.524344930879
             stat err =       0.000414958348
             autocorr =       1.227004031485
   target nu stat err =       0.000414958348
   target dn stat err =       0.002305928605
      target stat err =       0.003969896319
              std dev =       0.529781158389
             le_variance =       0.280668075784


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721173079604e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943769889239       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943775328524       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943776872130       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943778017197       residual = 9.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943778874803       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943779403497       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943779724876       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943780194379       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943780416765       residual = 2.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943780492755       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943780594984       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943780683816       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943780786170       residual = 1.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943780882093       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943780921652       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943780935852       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943780946031       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943780987680       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943780999910       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943781012437       residual = 3.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943781014923       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943781010837       residual = 8.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943781007232       residual = 5.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943781010713       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.943781010969       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 9.422804e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943769889239       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943771261891       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943771652222       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943771941595       residual = 9.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943772156520       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943772289517       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943772370465       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943772488675       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943772544694       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943772563711       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943772589349       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943772611685       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943772637279       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943772661239       residual = 8.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943772671070       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943772674595       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943772677128       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943772687489       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943772690535       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943772693611       residual = 3.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943772694210       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943772693186       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943772692284       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943772693143       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.943772693202       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 2.363479e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943769889239       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943770233214       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943770331077       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943770403618       residual = 9.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943770457381       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943770490682       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943770510957       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943770540562       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943770554593       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943770559349       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943770565763       residual = 2.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943770571355       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943770577754       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943770583742       residual = 8.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943770586197       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943770587076       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943770587709       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943770590296       residual = 8.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943770591057       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943770591822       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943770591970       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943770591714       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943770591489       residual = 4.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943770591703       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.943770591718       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 5.913575e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.205022 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6413e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 1.976749e-01 1 1  ON 0
 uu_1                 4.324735e-02 1 1  ON 1
 uu_2                -4.191934e-02 1 1  ON 2
 uu_3                -9.236837e-02 1 1  ON 3
 uu_4                -1.237825e-01 1 1  ON 4
 uu_5                -1.319190e-01 1 1  ON 5
 uu_6                -1.107118e-01 1 1  ON 6
 uu_7                -4.238867e-02 1 1  ON 7
 uu_8                 8.661526e-02 1 1  ON 8
 uu_9                 1.220350e-01 1 1  ON 9
 ud_0                 3.028539e-01 1 1  ON 10
 ud_1                 7.598015e-02 1 1  ON 11
 ud_2                -1.835263e-02 1 1  ON 12
 ud_3                -6.877492e-02 1 1  ON 13
 ud_4                -1.085022e-01 1 1  ON 14
 ud_5                -1.358035e-01 1 1  ON 15
 ud_6                -1.370743e-01 1 1  ON 16
 ud_7                -9.621032e-02 1 1  ON 17
 ud_8                 1.438840e-03 1 1  ON 18
 ud_9                 9.067838e-02 1 1  ON 19
 eO_0                -6.845636e-01 1 1  ON 20
 eO_1                -4.098064e-01 1 1  ON 21
 eO_2                -4.970284e-02 1 1  ON 22
 eO_3                 1.714125e-01 1 1  ON 23
 eO_4                 2.548750e-01 1 1  ON 24
 eO_5                 2.931633e-01 1 1  ON 25
 eO_6                 2.513861e-01 1 1  ON 26
 eO_7                 1.163841e-01 1 1  ON 27
 eO_8                 2.795706e-02 1 1  ON 28
 eO_9                 1.837347e-02 1 1  ON 29
eH1_0                -1.951077e-01 1 1  ON 30
eH1_1                -9.636363e-02 1 1  ON 31
eH1_2                -4.939008e-02 1 1  ON 32
eH1_3                -1.906623e-02 1 1  ON 33
eH1_4                 1.662984e-02 1 1  ON 34
eH1_5                 2.430207e-02 1 1  ON 35
eH1_6                 7.677711e-02 1 1  ON 36
eH1_7                 1.107447e-01 1 1  ON 37
eH1_8                 9.197849e-02 1 1  ON 38
eH1_9                 2.426615e-02 1 1  ON 39
eH2_0                -1.960561e-01 1 1  ON 40
eH2_1                -9.716532e-02 1 1  ON 41
eH2_2                -5.037806e-02 1 1  ON 42
eH2_3                -2.022237e-02 1 1  ON 43
eH2_4                 1.551908e-02 1 1  ON 44
eH2_5                 2.432277e-02 1 1  ON 45
eH2_6                 7.657256e-02 1 1  ON 46
eH2_7                 1.129425e-01 1 1  ON 47
eH2_8                 9.600308e-02 1 1  ON 48
eH2_9                 2.645893e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1616
    reference variance = 0.204665
====================================================
  Execution time = 2.2522e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7614e-01
  Total weights = 2.0000e+06
  Execution time = 1.8193e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276182163703
                                         uncertainty =       0.002120513552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276182163703
                                         uncertainty =       0.002120513552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371578041
  error estimate for blocks of size 2^( 2) =       0.000385370613
  error estimate for blocks of size 2^( 3) =       0.000397751066
  error estimate for blocks of size 2^( 4) =       0.000406741939
  error estimate for blocks of size 2^( 5) =       0.000412438935
  error estimate for blocks of size 2^( 6) =       0.000414808201
  error estimate for blocks of size 2^( 7) =       0.000415352324

      target function =      -0.951477399605
              le_mean =     -17.212258004031
             les_mean =     296.537965939932
             stat err =       0.000412335350
             autocorr =       1.231405408938
   target nu stat err =       0.000412335350
   target dn stat err =       0.002140918159
      target stat err =       0.003758474322
              std dev =       0.525490704634
             le_variance =       0.276140480657

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276182111390
                                         uncertainty =       0.002120254135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276182111390
                                         uncertainty =       0.002120254135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371577997
  error estimate for blocks of size 2^( 2) =       0.000385371528
  error estimate for blocks of size 2^( 3) =       0.000397753768
  error estimate for blocks of size 2^( 4) =       0.000406746149
  error estimate for blocks of size 2^( 5) =       0.000412443143
  error estimate for blocks of size 2^( 6) =       0.000414812674
  error estimate for blocks of size 2^( 7) =       0.000415355342

      target function =      -0.951477513852
              le_mean =     -17.212258476232
             les_mean =     296.537982130841
             stat err =       0.000412339327
             autocorr =       1.231429449970
   target nu stat err =       0.000412339327
   target dn stat err =       0.002140726474
      target stat err =       0.003758156732
              std dev =       0.525490643394
             le_variance =       0.276140416295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276182121228
                                         uncertainty =       0.002120382575

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276182121228
                                         uncertainty =       0.002120382575

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371578008
  error estimate for blocks of size 2^( 2) =       0.000385371060
  error estimate for blocks of size 2^( 3) =       0.000397752410
  error estimate for blocks of size 2^( 4) =       0.000406744041
  error estimate for blocks of size 2^( 5) =       0.000412441034
  error estimate for blocks of size 2^( 6) =       0.000414810432
  error estimate for blocks of size 2^( 7) =       0.000415353822

      target function =      -0.951477484906
              le_mean =     -17.212258238854
             les_mean =     296.537973975035
             stat err =       0.000412337332
             autocorr =       1.231417466107
   target nu stat err =       0.000412337332
   target dn stat err =       0.002140821335
      target stat err =       0.003758314078
              std dev =       0.525490658438
             le_variance =       0.276140432105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276182156427
                                         uncertainty =       0.002120497138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276182156427
                                         uncertainty =       0.002120497138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371578035
  error estimate for blocks of size 2^( 2) =       0.000385370668
  error estimate for blocks of size 2^( 3) =       0.000397751232
  error estimate for blocks of size 2^( 4) =       0.000406742200
  error estimate for blocks of size 2^( 5) =       0.000412439196
  error estimate for blocks of size 2^( 6) =       0.000414808479
  error estimate for blocks of size 2^( 7) =       0.000415352510

      target function =      -0.951477413655
              le_mean =     -17.212258033069
             les_mean =     296.537966931481
             stat err =       0.000412335596
             autocorr =       1.231406915757
   target nu stat err =       0.000412335596
   target dn stat err =       0.002140906023
      target stat err =       0.003758454259
              std dev =       0.525490696986
             le_variance =       0.276140472619


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.951477399605        initial
     6.2500e+00     6.2500e+01             9.4228e-05        -0.951477513852  <--
     2.5000e+01     2.5000e+02             2.3635e-05        -0.951477484906
     1.0000e+02     1.0000e+03             5.9136e-06        -0.951477413655

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 3.1754e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 1.976954e-01 1 1  ON 0
 uu_1                 4.326292e-02 1 1  ON 1
 uu_2                -4.191482e-02 1 1  ON 2
 uu_3                -9.236724e-02 1 1  ON 3
 uu_4                -1.237745e-01 1 1  ON 4
 uu_5                -1.319033e-01 1 1  ON 5
 uu_6                -1.106953e-01 1 1  ON 6
 uu_7                -4.244215e-02 1 1  ON 7
 uu_8                 8.655843e-02 1 1  ON 8
 uu_9                 1.220470e-01 1 1  ON 9
 ud_0                 3.028158e-01 1 1  ON 10
 ud_1                 7.596847e-02 1 1  ON 11
 ud_2                -1.839111e-02 1 1  ON 12
 ud_3                -6.881887e-02 1 1  ON 13
 ud_4                -1.085212e-01 1 1  ON 14
 ud_5                -1.357871e-01 1 1  ON 15
 ud_6                -1.370256e-01 1 1  ON 16
 ud_7                -9.613973e-02 1 1  ON 17
 ud_8                 1.436195e-03 1 1  ON 18
 ud_9                 9.067670e-02 1 1  ON 19
 eO_0                -6.845791e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967723e-02 1 1  ON 22
 eO_3                 1.714305e-01 1 1  ON 23
 eO_4                 2.548446e-01 1 1  ON 24
 eO_5                 2.931052e-01 1 1  ON 25
 eO_6                 2.514021e-01 1 1  ON 26
 eO_7                 1.164438e-01 1 1  ON 27
 eO_8                 2.795920e-02 1 1  ON 28
 eO_9                 1.837526e-02 1 1  ON 29
eH1_0                -1.951449e-01 1 1  ON 30
eH1_1                -9.635466e-02 1 1  ON 31
eH1_2                -4.934662e-02 1 1  ON 32
eH1_3                -1.903140e-02 1 1  ON 33
eH1_4                 1.662019e-02 1 1  ON 34
eH1_5                 2.426378e-02 1 1  ON 35
eH1_6                 7.675611e-02 1 1  ON 36
eH1_7                 1.107458e-01 1 1  ON 37
eH1_8                 9.199262e-02 1 1  ON 38
eH1_9                 2.426872e-02 1 1  ON 39
eH2_0                -1.961117e-01 1 1  ON 40
eH2_1                -9.717306e-02 1 1  ON 41
eH2_2                -5.034962e-02 1 1  ON 42
eH2_3                -2.019537e-02 1 1  ON 43
eH2_4                 1.552401e-02 1 1  ON 44
eH2_5                 2.429793e-02 1 1  ON 45
eH2_6                 7.654505e-02 1 1  ON 46
eH2_7                 1.129441e-01 1 1  ON 47
eH2_8                 9.604829e-02 1 1  ON 48
eH2_9                 2.646588e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8173e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1581
    reference variance = 0.364971
====================================================
  Execution time = 2.0367e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8298e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6016e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283019684780
                                         uncertainty =       0.005993733758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283019684780
                                         uncertainty =       0.005993733758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376154889
  error estimate for blocks of size 2^( 2) =       0.000389695992
  error estimate for blocks of size 2^( 3) =       0.000402043965
  error estimate for blocks of size 2^( 4) =       0.000410238594
  error estimate for blocks of size 2^( 5) =       0.000415666102
  error estimate for blocks of size 2^( 6) =       0.000417483098
  error estimate for blocks of size 2^( 7) =       0.000420177888

      target function =      -0.939755106104
              le_mean =     -17.212055708761
             les_mean =     296.537846581313
             stat err =       0.000415891420
             autocorr =       1.222437038943
   target nu stat err =       0.000415891420
   target dn stat err =       0.006009672205
      target stat err =       0.010111727491
              std dev =       0.531963345833
             le_variance =       0.282985001310


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721205570876e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939861819839       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939875487579       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939882178584       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939888296493       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939890885362       residual = 5.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939894360627       residual = 3.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939897587960       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939899048814       residual = 8.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939899344727       residual = 3.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939899452226       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939899836659       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939900185832       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939900679931       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939900899078       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939901134397       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939901252607       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939901386182       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939901425970       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939901427425       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939901477964       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939901489646       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939901491009       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939901504739       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939901521959       residual = 4.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+00 is 3.801216e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939861819839       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939865365679       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939867107863       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939868708646       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939869351881       residual = 5.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939870241834       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939871065592       residual = 4.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939871446454       residual = 8.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939871520942       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939871548159       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939871645949       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939871727653       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939871858079       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939871914424       residual = 9.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939871971666       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939872000806       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939872032702       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939872042070       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939872042451       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939872054932       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939872057497       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939872057734       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939872060982       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939872064994       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 9.809664e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939861819839       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939862714739       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939863154836       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939863559804       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939863720246       residual = 5.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939863944074       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939864151130       residual = 4.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939864247330       residual = 8.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939864265987       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939864272811       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939864297348       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939864317492       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939864350481       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939864364659       residual = 9.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939864378865       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939864386123       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939864394000       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939864396305       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939864396402       residual = 4.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939864399512       residual = 3.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939864400130       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939864400183       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939864400984       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939864401968       residual = 3.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 2.472377e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.223471 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6000e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 1.977522e-01 1 1  ON 0
 uu_1                 4.330429e-02 1 1  ON 1
 uu_2                -4.188401e-02 1 1  ON 2
 uu_3                -9.234883e-02 1 1  ON 3
 uu_4                -1.237712e-01 1 1  ON 4
 uu_5                -1.319029e-01 1 1  ON 5
 uu_6                -1.107344e-01 1 1  ON 6
 uu_7                -4.253479e-02 1 1  ON 7
 uu_8                 8.648004e-02 1 1  ON 8
 uu_9                 1.220568e-01 1 1  ON 9
 ud_0                 3.027578e-01 1 1  ON 10
 ud_1                 7.594392e-02 1 1  ON 11
 ud_2                -1.844323e-02 1 1  ON 12
 ud_3                -6.886916e-02 1 1  ON 13
 ud_4                -1.085414e-01 1 1  ON 14
 ud_5                -1.357485e-01 1 1  ON 15
 ud_6                -1.369477e-01 1 1  ON 16
 ud_7                -9.608475e-02 1 1  ON 17
 ud_8                 1.423313e-03 1 1  ON 18
 ud_9                 9.066622e-02 1 1  ON 19
 eO_0                -6.845722e-01 1 1  ON 20
 eO_1                -4.098468e-01 1 1  ON 21
 eO_2                -4.965535e-02 1 1  ON 22
 eO_3                 1.714431e-01 1 1  ON 23
 eO_4                 2.548180e-01 1 1  ON 24
 eO_5                 2.930390e-01 1 1  ON 25
 eO_6                 2.514101e-01 1 1  ON 26
 eO_7                 1.164901e-01 1 1  ON 27
 eO_8                 2.796670e-02 1 1  ON 28
 eO_9                 1.837926e-02 1 1  ON 29
eH1_0                -1.952430e-01 1 1  ON 30
eH1_1                -9.634818e-02 1 1  ON 31
eH1_2                -4.931074e-02 1 1  ON 32
eH1_3                -1.897591e-02 1 1  ON 33
eH1_4                 1.664541e-02 1 1  ON 34
eH1_5                 2.422269e-02 1 1  ON 35
eH1_6                 7.674026e-02 1 1  ON 36
eH1_7                 1.107425e-01 1 1  ON 37
eH1_8                 9.202076e-02 1 1  ON 38
eH1_9                 2.426978e-02 1 1  ON 39
eH2_0                -1.961941e-01 1 1  ON 40
eH2_1                -9.718383e-02 1 1  ON 41
eH2_2                -5.031329e-02 1 1  ON 42
eH2_3                -2.012486e-02 1 1  ON 43
eH2_4                 1.553810e-02 1 1  ON 44
eH2_5                 2.425569e-02 1 1  ON 45
eH2_6                 7.652849e-02 1 1  ON 46
eH2_7                 1.129331e-01 1 1  ON 47
eH2_8                 9.608132e-02 1 1  ON 48
eH2_9                 2.646915e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2231
    reference variance = 0.260169
====================================================
  Execution time = 1.9926e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7901e-01
  Total weights = 2.0000e+06
  Execution time = 1.8250e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279024935166
                                         uncertainty =       0.002509571259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279024935166
                                         uncertainty =       0.002509571259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373504383
  error estimate for blocks of size 2^( 2) =       0.000387148658
  error estimate for blocks of size 2^( 3) =       0.000399612676
  error estimate for blocks of size 2^( 4) =       0.000408007493
  error estimate for blocks of size 2^( 5) =       0.000412915069
  error estimate for blocks of size 2^( 6) =       0.000416264400
  error estimate for blocks of size 2^( 7) =       0.000416607006

      target function =      -0.946562983669
              le_mean =     -17.211435560747
             les_mean =     296.512524970991
             stat err =       0.000413448492
             autocorr =       1.225325350940
   target nu stat err =       0.000413448492
   target dn stat err =       0.002509344491
      target stat err =       0.004330715956
              std dev =       0.528214964518
             le_variance =       0.279011048741

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279029745205
                                         uncertainty =       0.002509454560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279029745205
                                         uncertainty =       0.002509454560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373507617
  error estimate for blocks of size 2^( 2) =       0.000387158398
  error estimate for blocks of size 2^( 3) =       0.000399631313
  error estimate for blocks of size 2^( 4) =       0.000408034330
  error estimate for blocks of size 2^( 5) =       0.000412947940
  error estimate for blocks of size 2^( 6) =       0.000416300810
  error estimate for blocks of size 2^( 7) =       0.000416638322

      target function =      -0.946554769121
              le_mean =     -17.211435570390
             les_mean =     296.512530134795
             stat err =       0.000413480350
             autocorr =       1.225492970707
   target nu stat err =       0.000413480350
   target dn stat err =       0.002509278606
      target stat err =       0.004330541422
              std dev =       0.528219538289
             le_variance =       0.279015880630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279027154903
                                         uncertainty =       0.002509506664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279027154903
                                         uncertainty =       0.002509506664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373505877
  error estimate for blocks of size 2^( 2) =       0.000387153469
  error estimate for blocks of size 2^( 3) =       0.000399622032
  error estimate for blocks of size 2^( 4) =       0.000408021037
  error estimate for blocks of size 2^( 5) =       0.000412931693
  error estimate for blocks of size 2^( 6) =       0.000416282835
  error estimate for blocks of size 2^( 7) =       0.000416622799

      target function =      -0.946559191114
              le_mean =     -17.211435512370
             les_mean =     296.512525536702
             stat err =       0.000413464591
             autocorr =       1.225410977580
   target nu stat err =       0.000413464591
   target dn stat err =       0.002509306716
      target stat err =       0.004330623045
              std dev =       0.528217076343
             le_variance =       0.279013279741

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279025183701
                                         uncertainty =       0.002509562960

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279025183701
                                         uncertainty =       0.002509562960

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373504551
  error estimate for blocks of size 2^( 2) =       0.000387149240
  error estimate for blocks of size 2^( 3) =       0.000399613827
  error estimate for blocks of size 2^( 4) =       0.000408009169
  error estimate for blocks of size 2^( 5) =       0.000412917131
  error estimate for blocks of size 2^( 6) =       0.000416266690
  error estimate for blocks of size 2^( 7) =       0.000416608962

      target function =      -0.946562558799
              le_mean =     -17.211435548274
             les_mean =     296.512524791565
             stat err =       0.000413450488
             autocorr =       1.225336083091
   target nu stat err =       0.000413450488
   target dn stat err =       0.002509339583
      target stat err =       0.004330704415
              std dev =       0.528215201121
             le_variance =       0.279011298695


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946562983669        initial  <--
     1.5625e+00     1.5625e+01             3.8012e-04        -0.946554769121
     6.2500e+00     6.2500e+01             9.8097e-05        -0.946559191114
     2.5000e+01     2.5000e+02             2.4724e-05        -0.946562558799

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1354
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 1.976954e-01 1 1  ON 0
 uu_1                 4.326292e-02 1 1  ON 1
 uu_2                -4.191482e-02 1 1  ON 2
 uu_3                -9.236724e-02 1 1  ON 3
 uu_4                -1.237745e-01 1 1  ON 4
 uu_5                -1.319033e-01 1 1  ON 5
 uu_6                -1.106953e-01 1 1  ON 6
 uu_7                -4.244215e-02 1 1  ON 7
 uu_8                 8.655843e-02 1 1  ON 8
 uu_9                 1.220470e-01 1 1  ON 9
 ud_0                 3.028158e-01 1 1  ON 10
 ud_1                 7.596847e-02 1 1  ON 11
 ud_2                -1.839111e-02 1 1  ON 12
 ud_3                -6.881887e-02 1 1  ON 13
 ud_4                -1.085212e-01 1 1  ON 14
 ud_5                -1.357871e-01 1 1  ON 15
 ud_6                -1.370256e-01 1 1  ON 16
 ud_7                -9.613973e-02 1 1  ON 17
 ud_8                 1.436195e-03 1 1  ON 18
 ud_9                 9.067670e-02 1 1  ON 19
 eO_0                -6.845791e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967723e-02 1 1  ON 22
 eO_3                 1.714305e-01 1 1  ON 23
 eO_4                 2.548446e-01 1 1  ON 24
 eO_5                 2.931052e-01 1 1  ON 25
 eO_6                 2.514021e-01 1 1  ON 26
 eO_7                 1.164438e-01 1 1  ON 27
 eO_8                 2.795920e-02 1 1  ON 28
 eO_9                 1.837526e-02 1 1  ON 29
eH1_0                -1.951449e-01 1 1  ON 30
eH1_1                -9.635466e-02 1 1  ON 31
eH1_2                -4.934662e-02 1 1  ON 32
eH1_3                -1.903140e-02 1 1  ON 33
eH1_4                 1.662019e-02 1 1  ON 34
eH1_5                 2.426378e-02 1 1  ON 35
eH1_6                 7.675611e-02 1 1  ON 36
eH1_7                 1.107458e-01 1 1  ON 37
eH1_8                 9.199262e-02 1 1  ON 38
eH1_9                 2.426872e-02 1 1  ON 39
eH2_0                -1.961117e-01 1 1  ON 40
eH2_1                -9.717306e-02 1 1  ON 41
eH2_2                -5.034962e-02 1 1  ON 42
eH2_3                -2.019537e-02 1 1  ON 43
eH2_4                 1.552401e-02 1 1  ON 44
eH2_5                 2.429793e-02 1 1  ON 45
eH2_6                 7.654505e-02 1 1  ON 46
eH2_7                 1.129441e-01 1 1  ON 47
eH2_8                 9.604829e-02 1 1  ON 48
eH2_9                 2.646588e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5141e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2129
    reference variance = 0.139111
====================================================
  Execution time = 2.0253e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8480e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5321e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284680803708
                                         uncertainty =       0.005978880924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284680803708
                                         uncertainty =       0.005978880924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377361016
  error estimate for blocks of size 2^( 2) =       0.000390646874
  error estimate for blocks of size 2^( 3) =       0.000402464668
  error estimate for blocks of size 2^( 4) =       0.000411958241
  error estimate for blocks of size 2^( 5) =       0.000417536909
  error estimate for blocks of size 2^( 6) =       0.000420989314
  error estimate for blocks of size 2^( 7) =       0.000420857199

      target function =      -0.936706740055
              le_mean =     -17.212324741826
             les_mean =     296.548925549196
             stat err =       0.000417835416
             autocorr =       1.226016824336
   target nu stat err =       0.000417835416
   target dn stat err =       0.006061326637
      target stat err =       0.010137744181
              std dev =       0.533669067429
             le_variance =       0.284802673530


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721232474183e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936814497973       residual = 9.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936815894826       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936816660794       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936817140341       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936817623839       residual = 5.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936818071152       residual = 3.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936818280797       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936818350189       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936818399049       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936818439162       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936818520215       residual = 4.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936818544166       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.936818598192       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.936818622241       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.936818665314       residual = 5.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936818668197       residual = 5.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936818694108       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936818689805       residual = 8.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.936818687556       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936818692732       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.936818694676       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.936818693861       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.936818693059       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936818693372       residual = 7.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 5.415041e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936814497973       residual = 9.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936814848427       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936815040746       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936815161092       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936815282082       residual = 5.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936815394322       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936815446762       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936815464165       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936815476403       residual = 4.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936815486454       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936815506748       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936815512744       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.936815526247       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.936815532261       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.936815543003       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936815543726       residual = 5.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936815550180       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936815549098       residual = 8.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.936815548535       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936815549831       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.936815550311       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.936815550109       residual = 7.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.936815549906       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936815549986       residual = 7.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 1.355000e-05

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936814497973       residual = 9.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936814585665       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936814633796       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936814663911       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936814694166       residual = 5.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936814722252       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936814735364       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936814739718       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936814742779       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936814745293       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.936814750369       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936814751868       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.936814755244       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.936814756748       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.936814759432       residual = 5.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.936814759611       residual = 5.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.936814761224       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.936814760953       residual = 8.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.936814760812       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936814761137       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.936814761257       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.936814761206       residual = 7.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.936814761155       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.936814761176       residual = 7.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 3.388277e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.241741 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5815e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 1.977028e-01 1 1  ON 0
 uu_1                 4.326904e-02 1 1  ON 1
 uu_2                -4.191071e-02 1 1  ON 2
 uu_3                -9.236563e-02 1 1  ON 3
 uu_4                -1.237755e-01 1 1  ON 4
 uu_5                -1.319058e-01 1 1  ON 5
 uu_6                -1.106994e-01 1 1  ON 6
 uu_7                -4.244758e-02 1 1  ON 7
 uu_8                 8.654889e-02 1 1  ON 8
 uu_9                 1.220488e-01 1 1  ON 9
 ud_0                 3.028115e-01 1 1  ON 10
 ud_1                 7.596683e-02 1 1  ON 11
 ud_2                -1.839489e-02 1 1  ON 12
 ud_3                -6.882220e-02 1 1  ON 13
 ud_4                -1.085210e-01 1 1  ON 14
 ud_5                -1.357815e-01 1 1  ON 15
 ud_6                -1.370183e-01 1 1  ON 16
 ud_7                -9.613655e-02 1 1  ON 17
 ud_8                 1.431373e-03 1 1  ON 18
 ud_9                 9.067594e-02 1 1  ON 19
 eO_0                -6.845781e-01 1 1  ON 20
 eO_1                -4.098257e-01 1 1  ON 21
 eO_2                -4.966992e-02 1 1  ON 22
 eO_3                 1.714342e-01 1 1  ON 23
 eO_4                 2.548372e-01 1 1  ON 24
 eO_5                 2.930917e-01 1 1  ON 25
 eO_6                 2.514050e-01 1 1  ON 26
 eO_7                 1.164482e-01 1 1  ON 27
 eO_8                 2.795938e-02 1 1  ON 28
 eO_9                 1.837517e-02 1 1  ON 29
eH1_0                -1.951527e-01 1 1  ON 30
eH1_1                -9.635447e-02 1 1  ON 31
eH1_2                -4.934049e-02 1 1  ON 32
eH1_3                -1.902576e-02 1 1  ON 33
eH1_4                 1.662181e-02 1 1  ON 34
eH1_5                 2.426184e-02 1 1  ON 35
eH1_6                 7.675171e-02 1 1  ON 36
eH1_7                 1.107437e-01 1 1  ON 37
eH1_8                 9.199511e-02 1 1  ON 38
eH1_9                 2.426867e-02 1 1  ON 39
eH2_0                -1.961186e-01 1 1  ON 40
eH2_1                -9.717341e-02 1 1  ON 41
eH2_2                -5.034551e-02 1 1  ON 42
eH2_3                -2.019132e-02 1 1  ON 43
eH2_4                 1.552609e-02 1 1  ON 44
eH2_5                 2.429873e-02 1 1  ON 45
eH2_6                 7.653995e-02 1 1  ON 46
eH2_7                 1.129431e-01 1 1  ON 47
eH2_8                 9.605033e-02 1 1  ON 48
eH2_9                 2.646610e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.1842
    reference variance = 0.203962
====================================================
  Execution time = 1.9772e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8162e-01
  Total weights = 2.0000e+06
  Execution time = 1.8188e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281590888303
                                         uncertainty =       0.004370445999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281590888303
                                         uncertainty =       0.004370445999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375245156
  error estimate for blocks of size 2^( 2) =       0.000388836651
  error estimate for blocks of size 2^( 3) =       0.000400988375
  error estimate for blocks of size 2^( 4) =       0.000409810888
  error estimate for blocks of size 2^( 5) =       0.000415630535
  error estimate for blocks of size 2^( 6) =       0.000418623275
  error estimate for blocks of size 2^( 7) =       0.000420613021

      target function =      -0.942103142362
              le_mean =     -17.211775061324
             les_mean =     296.526818475230
             stat err =       0.000416169430
             autocorr =       1.230014300777
   target nu stat err =       0.000416169430
   target dn stat err =       0.004605448293
      target stat err =       0.007797876641
              std dev =       0.530676789047
             le_variance =       0.281617854433

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281593321788
                                         uncertainty =       0.004370651144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281593321788
                                         uncertainty =       0.004370651144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375246780
  error estimate for blocks of size 2^( 2) =       0.000388838700
  error estimate for blocks of size 2^( 3) =       0.000400991142
  error estimate for blocks of size 2^( 4) =       0.000409814570
  error estimate for blocks of size 2^( 5) =       0.000415635083
  error estimate for blocks of size 2^( 6) =       0.000418627797
  error estimate for blocks of size 2^( 7) =       0.000420616912

      target function =      -0.942099029017
              le_mean =     -17.211775020003
             les_mean =     296.526819490847
             stat err =       0.000416173591
             autocorr =       1.230028247905
   target nu stat err =       0.000416173591
   target dn stat err =       0.004605644456
      target stat err =       0.007798138106
              std dev =       0.530679086119
             le_variance =       0.281620292444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281592106866
                                         uncertainty =       0.004370548877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281592106866
                                         uncertainty =       0.004370548877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375245970
  error estimate for blocks of size 2^( 2) =       0.000388837677
  error estimate for blocks of size 2^( 3) =       0.000400989761
  error estimate for blocks of size 2^( 4) =       0.000409812732
  error estimate for blocks of size 2^( 5) =       0.000415632814
  error estimate for blocks of size 2^( 6) =       0.000418625541
  error estimate for blocks of size 2^( 7) =       0.000420614970

      target function =      -0.942101082605
              le_mean =     -17.211775039924
             les_mean =     296.526818959394
             stat err =       0.000416171514
             autocorr =       1.230021289869
   target nu stat err =       0.000416171514
   target dn stat err =       0.004605546658
      target stat err =       0.007798007790
              std dev =       0.530677939307
             le_variance =       0.281619075268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281591040480
                                         uncertainty =       0.004370458869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281591040480
                                         uncertainty =       0.004370458869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375245258
  error estimate for blocks of size 2^( 2) =       0.000388836779
  error estimate for blocks of size 2^( 3) =       0.000400988548
  error estimate for blocks of size 2^( 4) =       0.000409811118
  error estimate for blocks of size 2^( 5) =       0.000415630820
  error estimate for blocks of size 2^( 6) =       0.000418623558
  error estimate for blocks of size 2^( 7) =       0.000420613264

      target function =      -0.942102885133
              le_mean =     -17.211775058574
             les_mean =     296.526818533019
             stat err =       0.000416169690
             autocorr =       1.230015174504
   target nu stat err =       0.000416169690
   target dn stat err =       0.004605460597
      target stat err =       0.007797893052
              std dev =       0.530676932695
             le_variance =       0.281618006894


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942103142362        initial  <--
     1.5625e+01     1.5625e+02             5.4150e-05        -0.942099029017
     6.2500e+01     6.2500e+02             1.3550e-05        -0.942101082605
     2.5000e+02     2.5000e+03             3.3883e-06        -0.942102885133

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0009
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 1.976954e-01 1 1  ON 0
 uu_1                 4.326292e-02 1 1  ON 1
 uu_2                -4.191482e-02 1 1  ON 2
 uu_3                -9.236724e-02 1 1  ON 3
 uu_4                -1.237745e-01 1 1  ON 4
 uu_5                -1.319033e-01 1 1  ON 5
 uu_6                -1.106953e-01 1 1  ON 6
 uu_7                -4.244215e-02 1 1  ON 7
 uu_8                 8.655843e-02 1 1  ON 8
 uu_9                 1.220470e-01 1 1  ON 9
 ud_0                 3.028158e-01 1 1  ON 10
 ud_1                 7.596847e-02 1 1  ON 11
 ud_2                -1.839111e-02 1 1  ON 12
 ud_3                -6.881887e-02 1 1  ON 13
 ud_4                -1.085212e-01 1 1  ON 14
 ud_5                -1.357871e-01 1 1  ON 15
 ud_6                -1.370256e-01 1 1  ON 16
 ud_7                -9.613973e-02 1 1  ON 17
 ud_8                 1.436195e-03 1 1  ON 18
 ud_9                 9.067670e-02 1 1  ON 19
 eO_0                -6.845791e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967723e-02 1 1  ON 22
 eO_3                 1.714305e-01 1 1  ON 23
 eO_4                 2.548446e-01 1 1  ON 24
 eO_5                 2.931052e-01 1 1  ON 25
 eO_6                 2.514021e-01 1 1  ON 26
 eO_7                 1.164438e-01 1 1  ON 27
 eO_8                 2.795920e-02 1 1  ON 28
 eO_9                 1.837526e-02 1 1  ON 29
eH1_0                -1.951449e-01 1 1  ON 30
eH1_1                -9.635466e-02 1 1  ON 31
eH1_2                -4.934662e-02 1 1  ON 32
eH1_3                -1.903140e-02 1 1  ON 33
eH1_4                 1.662019e-02 1 1  ON 34
eH1_5                 2.426378e-02 1 1  ON 35
eH1_6                 7.675611e-02 1 1  ON 36
eH1_7                 1.107458e-01 1 1  ON 37
eH1_8                 9.199262e-02 1 1  ON 38
eH1_9                 2.426872e-02 1 1  ON 39
eH2_0                -1.961117e-01 1 1  ON 40
eH2_1                -9.717306e-02 1 1  ON 41
eH2_2                -5.034962e-02 1 1  ON 42
eH2_3                -2.019537e-02 1 1  ON 43
eH2_4                 1.552401e-02 1 1  ON 44
eH2_5                 2.429793e-02 1 1  ON 45
eH2_6                 7.654505e-02 1 1  ON 46
eH2_7                 1.129441e-01 1 1  ON 47
eH2_8                 9.604829e-02 1 1  ON 48
eH2_9                 2.646588e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4823e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.255
    reference variance = 0.45084
====================================================
  Execution time = 2.0491e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9148e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5759e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291500083315
                                         uncertainty =       0.011778773931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291500083315
                                         uncertainty =       0.011778773931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381762206
  error estimate for blocks of size 2^( 2) =       0.000395230498
  error estimate for blocks of size 2^( 3) =       0.000407393020
  error estimate for blocks of size 2^( 4) =       0.000416366765
  error estimate for blocks of size 2^( 5) =       0.000421591070
  error estimate for blocks of size 2^( 6) =       0.000422812599
  error estimate for blocks of size 2^( 7) =       0.000424526582

      target function =      -0.925467218787
              le_mean =     -17.211503255697
             les_mean =     296.527328939377
             stat err =       0.000421324254
             autocorr =       1.217999350703
   target nu stat err =       0.000421324254
   target dn stat err =       0.011310036653
      target stat err =       0.018406701162
              std dev =       0.539893289705
             le_variance =       0.291484764268


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721150325570e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925834735817       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925834948955       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925835080908       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925835148656       residual = 9.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925835175791       residual = 3.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925835203764       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925835217150       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925835248277       residual = 8.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925835254427       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925835257211       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925835264023       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925835267007       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925835269827       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925835272706       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925835274930       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925835275123       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925835275668       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925835276245       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.925835276416       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.925835276556       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.925835276314       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.925835276627       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.925835276544       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.925835276534       residual = 8.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 4.355124e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925834735817       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925834789121       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925834822124       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925834839067       residual = 9.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925834845852       residual = 3.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925834852846       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925834856194       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925834863977       residual = 8.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925834865515       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925834866212       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925834867915       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925834868657       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925834869367       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925834870086       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925834870641       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925834870688       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925834870825       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925834870971       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.925834871013       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.925834871047       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.925834870986       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.925834871062       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.925834871044       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.925834871041       residual = 8.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 1.089063e-06

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925834735817       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925834749144       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.925834757396       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.925834761632       residual = 9.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.925834763328       residual = 3.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.925834765076       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.925834765912       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.925834767859       residual = 8.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.925834768243       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.925834768417       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.925834768850       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.925834769039       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.925834769207       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.925834769397       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.925834769527       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.925834769538       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.925834769576       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.925834769613       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.925834769617       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.925834769631       residual = 2.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.925834769613       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.925834769626       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.925834769615       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.925834769631       residual = 8.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+03 is 2.722833e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.259875 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6095e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 1.976957e-01 1 1  ON 0
 uu_1                 4.326315e-02 1 1  ON 1
 uu_2                -4.191478e-02 1 1  ON 2
 uu_3                -9.236733e-02 1 1  ON 3
 uu_4                -1.237746e-01 1 1  ON 4
 uu_5                -1.319033e-01 1 1  ON 5
 uu_6                -1.106954e-01 1 1  ON 6
 uu_7                -4.244225e-02 1 1  ON 7
 uu_8                 8.655792e-02 1 1  ON 8
 uu_9                 1.220472e-01 1 1  ON 9
 ud_0                 3.028153e-01 1 1  ON 10
 ud_1                 7.596841e-02 1 1  ON 11
 ud_2                -1.839149e-02 1 1  ON 12
 ud_3                -6.881932e-02 1 1  ON 13
 ud_4                -1.085213e-01 1 1  ON 14
 ud_5                -1.357866e-01 1 1  ON 15
 ud_6                -1.370250e-01 1 1  ON 16
 ud_7                -9.613915e-02 1 1  ON 17
 ud_8                 1.435794e-03 1 1  ON 18
 ud_9                 9.067674e-02 1 1  ON 19
 eO_0                -6.845792e-01 1 1  ON 20
 eO_1                -4.098274e-01 1 1  ON 21
 eO_2                -4.967690e-02 1 1  ON 22
 eO_3                 1.714308e-01 1 1  ON 23
 eO_4                 2.548442e-01 1 1  ON 24
 eO_5                 2.931045e-01 1 1  ON 25
 eO_6                 2.514024e-01 1 1  ON 26
 eO_7                 1.164443e-01 1 1  ON 27
 eO_8                 2.795922e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951454e-01 1 1  ON 30
eH1_1                -9.635448e-02 1 1  ON 31
eH1_2                -4.934598e-02 1 1  ON 32
eH1_3                -1.903031e-02 1 1  ON 33
eH1_4                 1.662025e-02 1 1  ON 34
eH1_5                 2.426312e-02 1 1  ON 35
eH1_6                 7.675537e-02 1 1  ON 36
eH1_7                 1.107455e-01 1 1  ON 37
eH1_8                 9.199269e-02 1 1  ON 38
eH1_9                 2.426876e-02 1 1  ON 39
eH2_0                -1.961122e-01 1 1  ON 40
eH2_1                -9.717327e-02 1 1  ON 41
eH2_2                -5.034927e-02 1 1  ON 42
eH2_3                -2.019493e-02 1 1  ON 43
eH2_4                 1.552422e-02 1 1  ON 44
eH2_5                 2.429767e-02 1 1  ON 45
eH2_6                 7.654466e-02 1 1  ON 46
eH2_7                 1.129440e-01 1 1  ON 47
eH2_8                 9.604860e-02 1 1  ON 48
eH2_9                 2.646595e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1774
    reference variance = 0.256295
====================================================
  Execution time = 2.1831e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7708e-01
  Total weights = 2.0000e+06
  Execution time = 1.8124e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277087581626
                                         uncertainty =       0.002568838441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277087581626
                                         uncertainty =       0.002568838441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372212729
  error estimate for blocks of size 2^( 2) =       0.000385884557
  error estimate for blocks of size 2^( 3) =       0.000398943705
  error estimate for blocks of size 2^( 4) =       0.000408303646
  error estimate for blocks of size 2^( 5) =       0.000414951523
  error estimate for blocks of size 2^( 6) =       0.000418097984
  error estimate for blocks of size 2^( 7) =       0.000421472746

      target function =      -0.949850221175
              le_mean =     -17.211316691762
             les_mean =     296.506506756235
             stat err =       0.000415706475
             autocorr =       1.247358055681
   target nu stat err =       0.000415706475
   target dn stat err =       0.002483895426
      target stat err =       0.004317208248
              std dev =       0.526388288872
             le_variance =       0.277084630662

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277087616465
                                         uncertainty =       0.002568838894

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277087616465
                                         uncertainty =       0.002568838894

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372212752
  error estimate for blocks of size 2^( 2) =       0.000385884620
  error estimate for blocks of size 2^( 3) =       0.000398943842
  error estimate for blocks of size 2^( 4) =       0.000408303861
  error estimate for blocks of size 2^( 5) =       0.000414951760
  error estimate for blocks of size 2^( 6) =       0.000418098280
  error estimate for blocks of size 2^( 7) =       0.000421473046

      target function =      -0.949850161097
              le_mean =     -17.211316696842
             les_mean =     296.506506966205
             stat err =       0.000415706737
             autocorr =       1.247359471077
   target nu stat err =       0.000415706737
   target dn stat err =       0.002483898117
      target stat err =       0.004317212372
              std dev =       0.526388322196
             le_variance =       0.277084665744

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277087599014
                                         uncertainty =       0.002568838667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277087599014
                                         uncertainty =       0.002568838667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372212740
  error estimate for blocks of size 2^( 2) =       0.000385884589
  error estimate for blocks of size 2^( 3) =       0.000398943773
  error estimate for blocks of size 2^( 4) =       0.000408303753
  error estimate for blocks of size 2^( 5) =       0.000414951642
  error estimate for blocks of size 2^( 6) =       0.000418098132
  error estimate for blocks of size 2^( 7) =       0.000421472896

      target function =      -0.949850191189
              le_mean =     -17.211316694297
             les_mean =     296.506506861019
             stat err =       0.000415706606
             autocorr =       1.247358763535
   target nu stat err =       0.000415706606
   target dn stat err =       0.002483896772
      target stat err =       0.004317210311
              std dev =       0.526388305504
             le_variance =       0.277084648172

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277087583796
                                         uncertainty =       0.002568838469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277087583796
                                         uncertainty =       0.002568838469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372212730
  error estimate for blocks of size 2^( 2) =       0.000385884561
  error estimate for blocks of size 2^( 3) =       0.000398943714
  error estimate for blocks of size 2^( 4) =       0.000408303659
  error estimate for blocks of size 2^( 5) =       0.000414951538
  error estimate for blocks of size 2^( 6) =       0.000418098002
  error estimate for blocks of size 2^( 7) =       0.000421472765

      target function =      -0.949850217434
              le_mean =     -17.211316692078
             les_mean =     296.506506769306
             stat err =       0.000415706491
             autocorr =       1.247358144182
   target nu stat err =       0.000415706491
   target dn stat err =       0.002483895594
      target stat err =       0.004317208506
              std dev =       0.526388290947
             le_variance =       0.277084632847


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949850221175        initial  <--
     1.5625e+02     1.5625e+03             4.3551e-06        -0.949850161097
     6.2500e+02     6.2500e+03             1.0891e-06        -0.949850191189
     2.5000e+03     2.5000e+04             2.7228e-07        -0.949850217434

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.0899
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 1.976954e-01 1 1  ON 0
 uu_1                 4.326292e-02 1 1  ON 1
 uu_2                -4.191482e-02 1 1  ON 2
 uu_3                -9.236724e-02 1 1  ON 3
 uu_4                -1.237745e-01 1 1  ON 4
 uu_5                -1.319033e-01 1 1  ON 5
 uu_6                -1.106953e-01 1 1  ON 6
 uu_7                -4.244215e-02 1 1  ON 7
 uu_8                 8.655843e-02 1 1  ON 8
 uu_9                 1.220470e-01 1 1  ON 9
 ud_0                 3.028158e-01 1 1  ON 10
 ud_1                 7.596847e-02 1 1  ON 11
 ud_2                -1.839111e-02 1 1  ON 12
 ud_3                -6.881887e-02 1 1  ON 13
 ud_4                -1.085212e-01 1 1  ON 14
 ud_5                -1.357871e-01 1 1  ON 15
 ud_6                -1.370256e-01 1 1  ON 16
 ud_7                -9.613973e-02 1 1  ON 17
 ud_8                 1.436195e-03 1 1  ON 18
 ud_9                 9.067670e-02 1 1  ON 19
 eO_0                -6.845791e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967723e-02 1 1  ON 22
 eO_3                 1.714305e-01 1 1  ON 23
 eO_4                 2.548446e-01 1 1  ON 24
 eO_5                 2.931052e-01 1 1  ON 25
 eO_6                 2.514021e-01 1 1  ON 26
 eO_7                 1.164438e-01 1 1  ON 27
 eO_8                 2.795920e-02 1 1  ON 28
 eO_9                 1.837526e-02 1 1  ON 29
eH1_0                -1.951449e-01 1 1  ON 30
eH1_1                -9.635466e-02 1 1  ON 31
eH1_2                -4.934662e-02 1 1  ON 32
eH1_3                -1.903140e-02 1 1  ON 33
eH1_4                 1.662019e-02 1 1  ON 34
eH1_5                 2.426378e-02 1 1  ON 35
eH1_6                 7.675611e-02 1 1  ON 36
eH1_7                 1.107458e-01 1 1  ON 37
eH1_8                 9.199262e-02 1 1  ON 38
eH1_9                 2.426872e-02 1 1  ON 39
eH2_0                -1.961117e-01 1 1  ON 40
eH2_1                -9.717306e-02 1 1  ON 41
eH2_2                -5.034962e-02 1 1  ON 42
eH2_3                -2.019537e-02 1 1  ON 43
eH2_4                 1.552401e-02 1 1  ON 44
eH2_5                 2.429793e-02 1 1  ON 45
eH2_6                 7.654505e-02 1 1  ON 46
eH2_7                 1.129441e-01 1 1  ON 47
eH2_8                 9.604829e-02 1 1  ON 48
eH2_9                 2.646588e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7191e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2159
    reference variance = 0.421071
====================================================
  Execution time = 2.0592e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7385e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4652e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273752457243
                                         uncertainty =       0.001493788939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273752457243
                                         uncertainty =       0.001493788939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370032609
  error estimate for blocks of size 2^( 2) =       0.000383597978
  error estimate for blocks of size 2^( 3) =       0.000396083569
  error estimate for blocks of size 2^( 4) =       0.000405037868
  error estimate for blocks of size 2^( 5) =       0.000410681975
  error estimate for blocks of size 2^( 6) =       0.000412417366
  error estimate for blocks of size 2^( 7) =       0.000415917322

      target function =      -0.955442158882
              le_mean =     -17.212287721408
             les_mean =     296.536696731492
             stat err =       0.000411013633
             autocorr =       1.233765034850
   target nu stat err =       0.000411013633
   target dn stat err =       0.001807243775
      target stat err =       0.003223372167
              std dev =       0.523305134570
             le_variance =       0.273848263867


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721228772141e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.955451962104       residual = 8.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.955451974803       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.955451980881       residual = 9.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.955451984123       residual = 7.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.955451986916       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.955451988286       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.955451989911       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.955451991239       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.955451992115       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.955451992455       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.955451992767       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.955451992850       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.955451993251       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.955451993412       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.955451993578       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.955451993630       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.955451993788       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.955451993916       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.955451993933       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.955451993909       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.955451993913       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.955451993911       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.955451993908       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.955451993907       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 3.365194e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.955451962104       residual = 8.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.955451965279       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.955451966799       residual = 9.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.955451967609       residual = 7.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.955451968301       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.955451968649       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.955451969063       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.955451969372       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.955451969615       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.955451969696       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.955451969767       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.955451969778       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.955451969891       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.955451969946       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.955451969975       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.955451969974       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.955451970022       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.955451970059       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.955451970043       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.955451970054       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.955451970055       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.955451970081       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.955451970067       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.955451970023       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 8.413163e-08

solving harmonic davidson linear method for identity shift 2.5000e+04, overlap shift 2.5000e+05 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.955451962104       residual = 8.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.955451962898       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.955451963278       residual = 9.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.955451963483       residual = 7.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.955451963745       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.955451963799       residual = 2.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.955451963840       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.955451963949       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.955451963997       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.955451964022       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.955451963974       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.955451964048       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.955451964082       residual = 7.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.955451964112       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.955451963983       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.955451964093       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.955451964095       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.955451964063       residual = 6.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.955451964042       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.955451964108       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.955451964095       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.955451964150       residual = 7.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.955451963962       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.955451964089       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+04 is 2.103302e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.278065 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6087e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 1.976954e-01 1 1  ON 0
 uu_1                 4.326295e-02 1 1  ON 1
 uu_2                -4.191481e-02 1 1  ON 2
 uu_3                -9.236724e-02 1 1  ON 3
 uu_4                -1.237745e-01 1 1  ON 4
 uu_5                -1.319033e-01 1 1  ON 5
 uu_6                -1.106953e-01 1 1  ON 6
 uu_7                -4.244220e-02 1 1  ON 7
 uu_8                 8.655836e-02 1 1  ON 8
 uu_9                 1.220470e-01 1 1  ON 9
 ud_0                 3.028158e-01 1 1  ON 10
 ud_1                 7.596846e-02 1 1  ON 11
 ud_2                -1.839115e-02 1 1  ON 12
 ud_3                -6.881891e-02 1 1  ON 13
 ud_4                -1.085212e-01 1 1  ON 14
 ud_5                -1.357870e-01 1 1  ON 15
 ud_6                -1.370255e-01 1 1  ON 16
 ud_7                -9.613968e-02 1 1  ON 17
 ud_8                 1.436151e-03 1 1  ON 18
 ud_9                 9.067668e-02 1 1  ON 19
 eO_0                -6.845792e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967720e-02 1 1  ON 22
 eO_3                 1.714305e-01 1 1  ON 23
 eO_4                 2.548446e-01 1 1  ON 24
 eO_5                 2.931052e-01 1 1  ON 25
 eO_6                 2.514021e-01 1 1  ON 26
 eO_7                 1.164438e-01 1 1  ON 27
 eO_8                 2.795920e-02 1 1  ON 28
 eO_9                 1.837526e-02 1 1  ON 29
eH1_0                -1.951450e-01 1 1  ON 30
eH1_1                -9.635466e-02 1 1  ON 31
eH1_2                -4.934659e-02 1 1  ON 32
eH1_3                -1.903139e-02 1 1  ON 33
eH1_4                 1.662018e-02 1 1  ON 34
eH1_5                 2.426377e-02 1 1  ON 35
eH1_6                 7.675612e-02 1 1  ON 36
eH1_7                 1.107458e-01 1 1  ON 37
eH1_8                 9.199264e-02 1 1  ON 38
eH1_9                 2.426872e-02 1 1  ON 39
eH2_0                -1.961118e-01 1 1  ON 40
eH2_1                -9.717306e-02 1 1  ON 41
eH2_2                -5.034957e-02 1 1  ON 42
eH2_3                -2.019533e-02 1 1  ON 43
eH2_4                 1.552403e-02 1 1  ON 44
eH2_5                 2.429793e-02 1 1  ON 45
eH2_6                 7.654501e-02 1 1  ON 46
eH2_7                 1.129441e-01 1 1  ON 47
eH2_8                 9.604831e-02 1 1  ON 48
eH2_9                 2.646588e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2743
    reference variance = 0.347263
====================================================
  Execution time = 1.9816e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7775e-01
  Total weights = 2.0000e+06
  Execution time = 1.8067e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277815386225
                                         uncertainty =       0.002212378935

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277815386225
                                         uncertainty =       0.002212378935

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372661122
  error estimate for blocks of size 2^( 2) =       0.000386568002
  error estimate for blocks of size 2^( 3) =       0.000399036313
  error estimate for blocks of size 2^( 4) =       0.000407874870
  error estimate for blocks of size 2^( 5) =       0.000414963429
  error estimate for blocks of size 2^( 6) =       0.000417794591
  error estimate for blocks of size 2^( 7) =       0.000418729767

      target function =      -0.948708059143
              le_mean =     -17.212630122701
             les_mean =     296.552388225739
             stat err =       0.000414840664
             autocorr =       1.239180206891
   target nu stat err =       0.000414840664
   target dn stat err =       0.002301299428
      target stat err =       0.004009985981
              std dev =       0.527022412910
             le_variance =       0.277752623710

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277815374993
                                         uncertainty =       0.002212378725

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277815374993
                                         uncertainty =       0.002212378725

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372661114
  error estimate for blocks of size 2^( 2) =       0.000386567996
  error estimate for blocks of size 2^( 3) =       0.000399036311
  error estimate for blocks of size 2^( 4) =       0.000407874873
  error estimate for blocks of size 2^( 5) =       0.000414963435
  error estimate for blocks of size 2^( 6) =       0.000417794602
  error estimate for blocks of size 2^( 7) =       0.000418729777

      target function =      -0.948708078378
              le_mean =     -17.212630124544
             les_mean =     296.552388277952
             stat err =       0.000414840672
             autocorr =       1.239180300957
   target nu stat err =       0.000414840672
   target dn stat err =       0.002301299186
      target stat err =       0.004009985751
              std dev =       0.527022402247
             le_variance =       0.277752612470

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277815380609
                                         uncertainty =       0.002212378830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277815380609
                                         uncertainty =       0.002212378830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372661118
  error estimate for blocks of size 2^( 2) =       0.000386567999
  error estimate for blocks of size 2^( 3) =       0.000399036312
  error estimate for blocks of size 2^( 4) =       0.000407874872
  error estimate for blocks of size 2^( 5) =       0.000414963432
  error estimate for blocks of size 2^( 6) =       0.000417794597
  error estimate for blocks of size 2^( 7) =       0.000418729772

      target function =      -0.948708068761
              le_mean =     -17.212630123622
             les_mean =     296.552388251845
             stat err =       0.000414840668
             autocorr =       1.239180253936
   target nu stat err =       0.000414840668
   target dn stat err =       0.002301299307
      target stat err =       0.004009985866
              std dev =       0.527022407578
             le_variance =       0.277752618089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277815385523
                                         uncertainty =       0.002212378921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277815385523
                                         uncertainty =       0.002212378921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372661122
  error estimate for blocks of size 2^( 2) =       0.000386568002
  error estimate for blocks of size 2^( 3) =       0.000399036312
  error estimate for blocks of size 2^( 4) =       0.000407874871
  error estimate for blocks of size 2^( 5) =       0.000414963429
  error estimate for blocks of size 2^( 6) =       0.000417794592
  error estimate for blocks of size 2^( 7) =       0.000418729768

      target function =      -0.948708060345
              le_mean =     -17.212630122816
             les_mean =     296.552388229002
             stat err =       0.000414840665
             autocorr =       1.239180212769
   target nu stat err =       0.000414840665
   target dn stat err =       0.002301299413
      target stat err =       0.004009985967
              std dev =       0.527022412244
             le_variance =       0.277752623007


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948708059143        initial
     1.5625e+03     1.5625e+04             3.3652e-07        -0.948708078378  <--
     6.2500e+03     6.2500e+04             8.4132e-08        -0.948708068761
     2.5000e+04     2.5000e+05             2.1033e-08        -0.948708060345

*****************************************************************************
Applying the update for shift_i =   1.5625e+03     and shift_s =   1.5625e+04
*****************************************************************************

  Execution time = 2.8960e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326304e-02 1 1  ON 1
 uu_2                -4.191477e-02 1 1  ON 2
 uu_3                -9.236721e-02 1 1  ON 3
 uu_4                -1.237745e-01 1 1  ON 4
 uu_5                -1.319033e-01 1 1  ON 5
 uu_6                -1.106954e-01 1 1  ON 6
 uu_7                -4.244234e-02 1 1  ON 7
 uu_8                 8.655816e-02 1 1  ON 8
 uu_9                 1.220470e-01 1 1  ON 9
 ud_0                 3.028157e-01 1 1  ON 10
 ud_1                 7.596843e-02 1 1  ON 11
 ud_2                -1.839127e-02 1 1  ON 12
 ud_3                -6.881905e-02 1 1  ON 13
 ud_4                -1.085212e-01 1 1  ON 14
 ud_5                -1.357869e-01 1 1  ON 15
 ud_6                -1.370253e-01 1 1  ON 16
 ud_7                -9.613956e-02 1 1  ON 17
 ud_8                 1.436021e-03 1 1  ON 18
 ud_9                 9.067664e-02 1 1  ON 19
 eO_0                -6.845792e-01 1 1  ON 20
 eO_1                -4.098271e-01 1 1  ON 21
 eO_2                -4.967710e-02 1 1  ON 22
 eO_3                 1.714305e-01 1 1  ON 23
 eO_4                 2.548444e-01 1 1  ON 24
 eO_5                 2.931051e-01 1 1  ON 25
 eO_6                 2.514022e-01 1 1  ON 26
 eO_7                 1.164439e-01 1 1  ON 27
 eO_8                 2.795921e-02 1 1  ON 28
 eO_9                 1.837527e-02 1 1  ON 29
eH1_0                -1.951452e-01 1 1  ON 30
eH1_1                -9.635468e-02 1 1  ON 31
eH1_2                -4.934652e-02 1 1  ON 32
eH1_3                -1.903136e-02 1 1  ON 33
eH1_4                 1.662014e-02 1 1  ON 34
eH1_5                 2.426377e-02 1 1  ON 35
eH1_6                 7.675614e-02 1 1  ON 36
eH1_7                 1.107458e-01 1 1  ON 37
eH1_8                 9.199272e-02 1 1  ON 38
eH1_9                 2.426873e-02 1 1  ON 39
eH2_0                -1.961119e-01 1 1  ON 40
eH2_1                -9.717305e-02 1 1  ON 41
eH2_2                -5.034943e-02 1 1  ON 42
eH2_3                -2.019519e-02 1 1  ON 43
eH2_4                 1.552409e-02 1 1  ON 44
eH2_5                 2.429792e-02 1 1  ON 45
eH2_6                 7.654488e-02 1 1  ON 46
eH2_7                 1.129439e-01 1 1  ON 47
eH2_8                 9.604836e-02 1 1  ON 48
eH2_9                 2.646590e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5053e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7222e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.207
    reference variance = 0.35784
====================================================
  Execution time = 2.0332e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8541e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4546e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285271822669
                                         uncertainty =       0.002956193695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285271822669
                                         uncertainty =       0.002956193695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377761341
  error estimate for blocks of size 2^( 2) =       0.000391115938
  error estimate for blocks of size 2^( 3) =       0.000403875220
  error estimate for blocks of size 2^( 4) =       0.000413100217
  error estimate for blocks of size 2^( 5) =       0.000418671884
  error estimate for blocks of size 2^( 6) =       0.000421853325
  error estimate for blocks of size 2^( 7) =       0.000424711955

      target function =      -0.935771991155
              le_mean =     -17.212626226719
             les_mean =     296.559908739914
             stat err =       0.000419584345
             autocorr =       1.233682855951
   target nu stat err =       0.000419584345
   target dn stat err =       0.003005905679
      target stat err =       0.005061730452
              std dev =       0.534235212141
             le_variance =       0.285407261891


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721262622672e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935798602719       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935798677351       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935798707823       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935798729954       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.935798744926       residual = 5.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.935798763223       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.935798773603       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.935798777754       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.935798780808       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.935798781311       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.935798785300       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.935798787027       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.935798789008       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.935798790724       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.935798792083       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.935798792386       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.935798792698       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.935798793526       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.935798793500       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.935798793512       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.935798793582       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.935798793671       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.935798793604       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.935798793586       residual = 9.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 1.758973e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935798602719       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935798621380       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935798628999       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935798634533       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.935798638277       residual = 5.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.935798642849       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.935798645444       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.935798646482       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.935798647248       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.935798647370       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.935798648370       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.935798648806       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.935798649296       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.935798649727       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.935798650066       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.935798650141       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.935798650224       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.935798650427       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.935798650418       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.935798650421       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.935798650439       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.935798650464       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.935798650446       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.935798650441       residual = 9.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 4.397789e-07

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935798602719       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935798607384       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935798609289       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935798610673       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.935798611609       residual = 5.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.935798612755       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.935798613401       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.935798613657       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.935798613837       residual = 5.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.935798613885       residual = 3.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.935798614137       residual = 4.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.935798614220       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.935798614377       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.935798614468       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.935798614541       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.935798614563       residual = 2.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.935798614579       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.935798614650       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.935798614644       residual = 5.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.935798614656       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.935798614646       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.935798614669       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.935798614649       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.935798614641       residual = 9.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+03 is 1.099470e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.296189 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5816e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326309e-02 1 1  ON 1
 uu_2                -4.191476e-02 1 1  ON 2
 uu_3                -9.236725e-02 1 1  ON 3
 uu_4                -1.237746e-01 1 1  ON 4
 uu_5                -1.319034e-01 1 1  ON 5
 uu_6                -1.106953e-01 1 1  ON 6
 uu_7                -4.244234e-02 1 1  ON 7
 uu_8                 8.655816e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028154e-01 1 1  ON 10
 ud_1                 7.596828e-02 1 1  ON 11
 ud_2                -1.839153e-02 1 1  ON 12
 ud_3                -6.881927e-02 1 1  ON 13
 ud_4                -1.085213e-01 1 1  ON 14
 ud_5                -1.357866e-01 1 1  ON 15
 ud_6                -1.370248e-01 1 1  ON 16
 ud_7                -9.613917e-02 1 1  ON 17
 ud_8                 1.435955e-03 1 1  ON 18
 ud_9                 9.067658e-02 1 1  ON 19
 eO_0                -6.845791e-01 1 1  ON 20
 eO_1                -4.098271e-01 1 1  ON 21
 eO_2                -4.967703e-02 1 1  ON 22
 eO_3                 1.714305e-01 1 1  ON 23
 eO_4                 2.548441e-01 1 1  ON 24
 eO_5                 2.931047e-01 1 1  ON 25
 eO_6                 2.514026e-01 1 1  ON 26
 eO_7                 1.164441e-01 1 1  ON 27
 eO_8                 2.795920e-02 1 1  ON 28
 eO_9                 1.837527e-02 1 1  ON 29
eH1_0                -1.951456e-01 1 1  ON 30
eH1_1                -9.635476e-02 1 1  ON 31
eH1_2                -4.934646e-02 1 1  ON 32
eH1_3                -1.903124e-02 1 1  ON 33
eH1_4                 1.662010e-02 1 1  ON 34
eH1_5                 2.426368e-02 1 1  ON 35
eH1_6                 7.675622e-02 1 1  ON 36
eH1_7                 1.107460e-01 1 1  ON 37
eH1_8                 9.199284e-02 1 1  ON 38
eH1_9                 2.426874e-02 1 1  ON 39
eH2_0                -1.961123e-01 1 1  ON 40
eH2_1                -9.717296e-02 1 1  ON 41
eH2_2                -5.034920e-02 1 1  ON 42
eH2_3                -2.019503e-02 1 1  ON 43
eH2_4                 1.552410e-02 1 1  ON 44
eH2_5                 2.429766e-02 1 1  ON 45
eH2_6                 7.654493e-02 1 1  ON 46
eH2_7                 1.129439e-01 1 1  ON 47
eH2_8                 9.604844e-02 1 1  ON 48
eH2_9                 2.646590e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1758
    reference variance = 0.197833
====================================================
  Execution time = 1.9849e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8011e-01
  Total weights = 2.0000e+06
  Execution time = 1.8161e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280138888931
                                         uncertainty =       0.002719475978

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280138888931
                                         uncertainty =       0.002719475978

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374236341
  error estimate for blocks of size 2^( 2) =       0.000387862426
  error estimate for blocks of size 2^( 3) =       0.000399870185
  error estimate for blocks of size 2^( 4) =       0.000409543797
  error estimate for blocks of size 2^( 5) =       0.000415090747
  error estimate for blocks of size 2^( 6) =       0.000417633293
  error estimate for blocks of size 2^( 7) =       0.000418431313

      target function =      -0.944699273794
              le_mean =     -17.211338070932
             les_mean =     296.510263729647
             stat err =       0.000415174787
             autocorr =       1.230750518310
   target nu stat err =       0.000415174787
   target dn stat err =       0.002941361852
      target stat err =       0.005035836517
              std dev =       0.529250108921
             le_variance =       0.280105677793

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280138849208
                                         uncertainty =       0.002719476320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280138849208
                                         uncertainty =       0.002719476320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374236314
  error estimate for blocks of size 2^( 2) =       0.000387862444
  error estimate for blocks of size 2^( 3) =       0.000399870263
  error estimate for blocks of size 2^( 4) =       0.000409543931
  error estimate for blocks of size 2^( 5) =       0.000415090923
  error estimate for blocks of size 2^( 6) =       0.000417633490
  error estimate for blocks of size 2^( 7) =       0.000418431519

      target function =      -0.944699340974
              le_mean =     -17.211338073496
             les_mean =     296.510263778209
             stat err =       0.000415174966
             autocorr =       1.230751751866
   target nu stat err =       0.000415174966
   target dn stat err =       0.002941362119
      target stat err =       0.005035837745
              std dev =       0.529250071423
             le_variance =       0.280105638101

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280138869061
                                         uncertainty =       0.002719476149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280138869061
                                         uncertainty =       0.002719476149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374236328
  error estimate for blocks of size 2^( 2) =       0.000387862435
  error estimate for blocks of size 2^( 3) =       0.000399870224
  error estimate for blocks of size 2^( 4) =       0.000409543864
  error estimate for blocks of size 2^( 5) =       0.000415090835
  error estimate for blocks of size 2^( 6) =       0.000417633392
  error estimate for blocks of size 2^( 7) =       0.000418431416

      target function =      -0.944699307398
              le_mean =     -17.211338072213
             les_mean =     296.510263753884
             stat err =       0.000415174877
             autocorr =       1.230751135151
   target nu stat err =       0.000415174877
   target dn stat err =       0.002941361985
      target stat err =       0.005035837131
              std dev =       0.529250090164
             le_variance =       0.280105657939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280138886447
                                         uncertainty =       0.002719476000

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280138886447
                                         uncertainty =       0.002719476000

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374236339
  error estimate for blocks of size 2^( 2) =       0.000387862427
  error estimate for blocks of size 2^( 3) =       0.000399870190
  error estimate for blocks of size 2^( 4) =       0.000409543806
  error estimate for blocks of size 2^( 5) =       0.000415090758
  error estimate for blocks of size 2^( 6) =       0.000417633305
  error estimate for blocks of size 2^( 7) =       0.000418431326

      target function =      -0.944699277996
              le_mean =     -17.211338071092
             les_mean =     296.510263732671
             stat err =       0.000415174799
             autocorr =       1.230750595409
   target nu stat err =       0.000415174799
   target dn stat err =       0.002941361868
      target stat err =       0.005035836594
              std dev =       0.529250106576
             le_variance =       0.280105675311


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.944699273794        initial
     3.9062e+02     3.9062e+03             1.7590e-06        -0.944699340974  <--
     1.5625e+03     1.5625e+04             4.3978e-07        -0.944699307398
     6.2500e+03     6.2500e+04             1.0995e-07        -0.944699277996

*****************************************************************************
Applying the update for shift_i =   3.9062e+02     and shift_s =   3.9062e+03
*****************************************************************************

  Execution time = 2.9101e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244236e-02 1 1  ON 7
 uu_8                 8.655818e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881991e-02 1 1  ON 13
 ud_4                -1.085213e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613800e-02 1 1  ON 17
 ud_8                 1.435760e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429686e-02 1 1  ON 45
eH2_6                 7.654508e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4923e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1835
    reference variance = 0.215749
====================================================
  Execution time = 2.2294e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8053e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6389e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280616024512
                                         uncertainty =       0.002647191339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280616024512
                                         uncertainty =       0.002647191339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374520308
  error estimate for blocks of size 2^( 2) =       0.000388237172
  error estimate for blocks of size 2^( 3) =       0.000400831042
  error estimate for blocks of size 2^( 4) =       0.000410413188
  error estimate for blocks of size 2^( 5) =       0.000417152853
  error estimate for blocks of size 2^( 6) =       0.000419856045
  error estimate for blocks of size 2^( 7) =       0.000422073416

      target function =      -0.943974656773
              le_mean =     -17.212107545542
             les_mean =     296.537176940519
             stat err =       0.000417373876
             autocorr =       1.241937616868
   target nu stat err =       0.000417373876
   target dn stat err =       0.002784378400
      target stat err =       0.004773440550
              std dev =       0.529651698259
             le_variance =       0.280530921468


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721210754554e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943997853594       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943998093727       residual = 8.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943998166188       residual = 7.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943998221601       residual = 7.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943998261027       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943998295335       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943998307197       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943998324947       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943998329637       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943998334244       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943998337283       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943998344781       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943998351787       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943998354484       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943998357539       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943998359898       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943998360287       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943998361320       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943998360863       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943998360859       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943998361465       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943998361552       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943998361767       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943998361700       residual = 6.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 5.298402e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943997853594       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943997913663       residual = 8.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943997931793       residual = 7.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943997945652       residual = 7.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943997955512       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943997964093       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943997967062       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943997971500       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943997972674       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943997973826       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943997974586       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943997976462       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943997978212       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943997978887       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943997979650       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943997980240       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943997980336       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943997980594       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943997980481       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943997980480       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943997980629       residual = 6.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943997980651       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943997980706       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943997980690       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 1.324727e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943997853594       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943997868613       residual = 8.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943997873147       residual = 7.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943997876612       residual = 7.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943997879078       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943997881222       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943997881963       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943997883076       residual = 6.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943997883368       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943997883654       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943997883846       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943997884313       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943997884754       residual = 7.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943997884921       residual = 5.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943997885117       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943997885256       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943997885281       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943997885345       residual = 4.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943997885320       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943997885320       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943997885366       residual = 6.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943997885354       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943997885380       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943997885373       residual = 6.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 3.311896e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.330570 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7980e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.976960e-01 1 1  ON 0
 uu_1                 4.326373e-02 1 1  ON 1
 uu_2                -4.191459e-02 1 1  ON 2
 uu_3                -9.236737e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319038e-01 1 1  ON 5
 uu_6                -1.106953e-01 1 1  ON 6
 uu_7                -4.244271e-02 1 1  ON 7
 uu_8                 8.655685e-02 1 1  ON 8
 uu_9                 1.220473e-01 1 1  ON 9
 ud_0                 3.028138e-01 1 1  ON 10
 ud_1                 7.596768e-02 1 1  ON 11
 ud_2                -1.839287e-02 1 1  ON 12
 ud_3                -6.882056e-02 1 1  ON 13
 ud_4                -1.085215e-01 1 1  ON 14
 ud_5                -1.357853e-01 1 1  ON 15
 ud_6                -1.370226e-01 1 1  ON 16
 ud_7                -9.613715e-02 1 1  ON 17
 ud_8                 1.435157e-03 1 1  ON 18
 ud_9                 9.067615e-02 1 1  ON 19
 eO_0                -6.845790e-01 1 1  ON 20
 eO_1                -4.098272e-01 1 1  ON 21
 eO_2                -4.967608e-02 1 1  ON 22
 eO_3                 1.714305e-01 1 1  ON 23
 eO_4                 2.548420e-01 1 1  ON 24
 eO_5                 2.931026e-01 1 1  ON 25
 eO_6                 2.514043e-01 1 1  ON 26
 eO_7                 1.164454e-01 1 1  ON 27
 eO_8                 2.795932e-02 1 1  ON 28
 eO_9                 1.837532e-02 1 1  ON 29
eH1_0                -1.951477e-01 1 1  ON 30
eH1_1                -9.635512e-02 1 1  ON 31
eH1_2                -4.934596e-02 1 1  ON 32
eH1_3                -1.903059e-02 1 1  ON 33
eH1_4                 1.661998e-02 1 1  ON 34
eH1_5                 2.426370e-02 1 1  ON 35
eH1_6                 7.675636e-02 1 1  ON 36
eH1_7                 1.107462e-01 1 1  ON 37
eH1_8                 9.199365e-02 1 1  ON 38
eH1_9                 2.426890e-02 1 1  ON 39
eH2_0                -1.961144e-01 1 1  ON 40
eH2_1                -9.717233e-02 1 1  ON 41
eH2_2                -5.034786e-02 1 1  ON 42
eH2_3                -2.019403e-02 1 1  ON 43
eH2_4                 1.552426e-02 1 1  ON 44
eH2_5                 2.429634e-02 1 1  ON 45
eH2_6                 7.654456e-02 1 1  ON 46
eH2_7                 1.129440e-01 1 1  ON 47
eH2_8                 9.604892e-02 1 1  ON 48
eH2_9                 2.646604e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1406
    reference variance = 0.261177
====================================================
  Execution time = 1.9641e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8099e-01
  Total weights = 2.0000e+06
  Execution time = 1.8126e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280866251971
                                         uncertainty =       0.002866948209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280866251971
                                         uncertainty =       0.002866948209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374823802
  error estimate for blocks of size 2^( 2) =       0.000388439687
  error estimate for blocks of size 2^( 3) =       0.000400825037
  error estimate for blocks of size 2^( 4) =       0.000410075243
  error estimate for blocks of size 2^( 5) =       0.000414971648
  error estimate for blocks of size 2^( 6) =       0.000417974915
  error estimate for blocks of size 2^( 7) =       0.000420588988

      target function =      -0.943205906462
              le_mean =     -17.212018376423
             les_mean =     296.534562214292
             stat err =       0.000415902698
             autocorr =       1.231201551166
   target nu stat err =       0.000415902698
   target dn stat err =       0.002820449122
      target stat err =       0.004824768675
              std dev =       0.530080903698
             le_variance =       0.280985764466

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280866401534
                                         uncertainty =       0.002866966892

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280866401534
                                         uncertainty =       0.002866966892

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374823902
  error estimate for blocks of size 2^( 2) =       0.000388439836
  error estimate for blocks of size 2^( 3) =       0.000400825280
  error estimate for blocks of size 2^( 4) =       0.000410075589
  error estimate for blocks of size 2^( 5) =       0.000414972030
  error estimate for blocks of size 2^( 6) =       0.000417975322
  error estimate for blocks of size 2^( 7) =       0.000420589432

      target function =      -0.943205651154
              le_mean =     -17.212018389396
             les_mean =     296.534562811641
             stat err =       0.000415903093
             autocorr =       1.231203229167
   target nu stat err =       0.000415903093
   target dn stat err =       0.002820468994
      target stat err =       0.004824799506
              std dev =       0.530081045908
             le_variance =       0.280985915231

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280866326739
                                         uncertainty =       0.002866957556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280866326739
                                         uncertainty =       0.002866957556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374823852
  error estimate for blocks of size 2^( 2) =       0.000388439761
  error estimate for blocks of size 2^( 3) =       0.000400825158
  error estimate for blocks of size 2^( 4) =       0.000410075416
  error estimate for blocks of size 2^( 5) =       0.000414971839
  error estimate for blocks of size 2^( 6) =       0.000417975119
  error estimate for blocks of size 2^( 7) =       0.000420589210

      target function =      -0.943205778832
              le_mean =     -17.212018382902
             les_mean =     296.534562512713
             stat err =       0.000415902896
             autocorr =       1.231202390453
   target nu stat err =       0.000415902896
   target dn stat err =       0.002820459064
      target stat err =       0.004824784101
              std dev =       0.530080974790
             le_variance =       0.280985839835

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280866261312
                                         uncertainty =       0.002866949378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280866261312
                                         uncertainty =       0.002866949378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374823808
  error estimate for blocks of size 2^( 2) =       0.000388439696
  error estimate for blocks of size 2^( 3) =       0.000400825052
  error estimate for blocks of size 2^( 4) =       0.000410075265
  error estimate for blocks of size 2^( 5) =       0.000414971671
  error estimate for blocks of size 2^( 6) =       0.000417974941
  error estimate for blocks of size 2^( 7) =       0.000420589016

      target function =      -0.943205890517
              le_mean =     -17.212018377232
             les_mean =     296.534562251556
             stat err =       0.000415902723
             autocorr =       1.231201656083
   target nu stat err =       0.000415902723
   target dn stat err =       0.002820450365
      target stat err =       0.004824770603
              std dev =       0.530080912580
             le_variance =       0.280985773882


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943205906462        initial  <--
     9.7656e+01     9.7656e+02             5.2984e-06        -0.943205651154
     3.9062e+02     3.9062e+03             1.3247e-06        -0.943205778832
     1.5625e+03     1.5625e+04             3.3119e-07        -0.943205890517

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8214
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244236e-02 1 1  ON 7
 uu_8                 8.655818e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881991e-02 1 1  ON 13
 ud_4                -1.085213e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613800e-02 1 1  ON 17
 ud_8                 1.435760e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429686e-02 1 1  ON 45
eH2_6                 7.654508e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6808e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2899
    reference variance = 0.189075
====================================================
  Execution time = 2.0274e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7884e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5663e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278845899791
                                         uncertainty =       0.002636897477

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278845899791
                                         uncertainty =       0.002636897477

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373387248
  error estimate for blocks of size 2^( 2) =       0.000386537036
  error estimate for blocks of size 2^( 3) =       0.000398230283
  error estimate for blocks of size 2^( 4) =       0.000407119050
  error estimate for blocks of size 2^( 5) =       0.000412685430
  error estimate for blocks of size 2^( 6) =       0.000416511394
  error estimate for blocks of size 2^( 7) =       0.000416980813

      target function =      -0.946853776065
              le_mean =     -17.212328299536
             les_mean =     296.543081426112
             stat err =       0.000413324172
             autocorr =       1.225357022941
   target nu stat err =       0.000413324172
   target dn stat err =       0.002644533150
      target stat err =       0.004567814301
              std dev =       0.528049310677
             le_variance =       0.278836074506


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721232829954e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946874906568       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946874937239       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946874945929       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946874952525       residual = 9.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946874958054       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946874962286       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946874964333       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946874966805       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946874967816       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946874968705       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946874969779       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946874970273       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946874971214       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946874971446       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946874971339       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946874971407       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946874971491       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946874971559       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946874971552       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946874971601       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946874971568       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946874971627       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946874971623       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946874971642       residual = 6.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 5.485580e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946874906568       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946874914236       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946874916409       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946874918058       residual = 9.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946874919440       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946874920495       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946874921010       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946874921616       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946874921881       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946874922097       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946874922370       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946874922491       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946874922711       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946874922782       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946874922757       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946874922778       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946874922788       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946874922807       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946874922819       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946874922809       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946874922815       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946874922822       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946874922839       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946874922848       residual = 6.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 1.371465e-07

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946874906568       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946874908485       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946874909028       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946874909432       residual = 9.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946874909826       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946874910044       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946874910181       residual = 3.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946874910328       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946874910407       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946874910461       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946874910503       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946874910537       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946874910607       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946874910604       residual = 5.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946874910579       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946874910621       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946874910590       residual = 1.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946874910623       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946874910596       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946874910560       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946874910579       residual = 2.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946874910662       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946874910665       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946874910625       residual = 6.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+04 is 3.428705e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.348665 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5869e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326330e-02 1 1  ON 1
 uu_2                -4.191470e-02 1 1  ON 2
 uu_3                -9.236736e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244245e-02 1 1  ON 7
 uu_8                 8.655807e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028144e-01 1 1  ON 10
 ud_1                 7.596778e-02 1 1  ON 11
 ud_2                -1.839239e-02 1 1  ON 12
 ud_3                -6.882000e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357859e-01 1 1  ON 15
 ud_6                -1.370234e-01 1 1  ON 16
 ud_7                -9.613786e-02 1 1  ON 17
 ud_8                 1.435699e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845789e-01 1 1  ON 20
 eO_1                -4.098271e-01 1 1  ON 21
 eO_2                -4.967679e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931035e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164448e-01 1 1  ON 27
 eO_8                 2.795920e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951467e-01 1 1  ON 30
eH1_1                -9.635500e-02 1 1  ON 31
eH1_2                -4.934623e-02 1 1  ON 32
eH1_3                -1.903082e-02 1 1  ON 33
eH1_4                 1.661998e-02 1 1  ON 34
eH1_5                 2.426340e-02 1 1  ON 35
eH1_6                 7.675642e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199326e-02 1 1  ON 38
eH1_9                 2.426880e-02 1 1  ON 39
eH2_0                -1.961134e-01 1 1  ON 40
eH2_1                -9.717266e-02 1 1  ON 41
eH2_2                -5.034843e-02 1 1  ON 42
eH2_3                -2.019448e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429676e-02 1 1  ON 45
eH2_6                 7.654505e-02 1 1  ON 46
eH2_7                 1.129439e-01 1 1  ON 47
eH2_8                 9.604871e-02 1 1  ON 48
eH2_9                 2.646593e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1975
    reference variance = 0.212149
====================================================
  Execution time = 1.9630e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7617e-01
  Total weights = 2.0000e+06
  Execution time = 1.8180e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276089754742
                                         uncertainty =       0.001637761225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276089754742
                                         uncertainty =       0.001637761225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371601225
  error estimate for blocks of size 2^( 2) =       0.000385346678
  error estimate for blocks of size 2^( 3) =       0.000397834723
  error estimate for blocks of size 2^( 4) =       0.000407935579
  error estimate for blocks of size 2^( 5) =       0.000412608046
  error estimate for blocks of size 2^( 6) =       0.000415801957
  error estimate for blocks of size 2^( 7) =       0.000417396933

      target function =      -0.951420421773
              le_mean =     -17.211856681027
             les_mean =     296.524185211483
             stat err =       0.000413435629
             autocorr =       1.237831486553
   target nu stat err =       0.000413435629
   target dn stat err =       0.001859498693
      target stat err =       0.003282834151
              std dev =       0.525523492669
             le_variance =       0.276174941347

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276089766130
                                         uncertainty =       0.001637760688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276089766130
                                         uncertainty =       0.001637760688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371601233
  error estimate for blocks of size 2^( 2) =       0.000385346698
  error estimate for blocks of size 2^( 3) =       0.000397834762
  error estimate for blocks of size 2^( 4) =       0.000407935633
  error estimate for blocks of size 2^( 5) =       0.000412608112
  error estimate for blocks of size 2^( 6) =       0.000415802035
  error estimate for blocks of size 2^( 7) =       0.000417397008

      target function =      -0.951420402260
              le_mean =     -17.211856678404
             les_mean =     296.524185132520
             stat err =       0.000413435697
             autocorr =       1.237831844032
   target nu stat err =       0.000413435697
   target dn stat err =       0.001859498148
      target stat err =       0.003282833119
              std dev =       0.525523503467
             le_variance =       0.276174952696

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276089760436
                                         uncertainty =       0.001637760957

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276089760436
                                         uncertainty =       0.001637760957

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371601229
  error estimate for blocks of size 2^( 2) =       0.000385346688
  error estimate for blocks of size 2^( 3) =       0.000397834742
  error estimate for blocks of size 2^( 4) =       0.000407935606
  error estimate for blocks of size 2^( 5) =       0.000412608079
  error estimate for blocks of size 2^( 6) =       0.000415801996
  error estimate for blocks of size 2^( 7) =       0.000417396970

      target function =      -0.951420412017
              le_mean =     -17.211856679715
             les_mean =     296.524185171993
             stat err =       0.000413435663
             autocorr =       1.237831665306
   target nu stat err =       0.000413435663
   target dn stat err =       0.001859498420
      target stat err =       0.003282833635
              std dev =       0.525523498067
             le_variance =       0.276174947021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276089755454
                                         uncertainty =       0.001637761192

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276089755454
                                         uncertainty =       0.001637761192

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371601226
  error estimate for blocks of size 2^( 2) =       0.000385346679
  error estimate for blocks of size 2^( 3) =       0.000397834725
  error estimate for blocks of size 2^( 4) =       0.000407935582
  error estimate for blocks of size 2^( 5) =       0.000412608050
  error estimate for blocks of size 2^( 6) =       0.000415801962
  error estimate for blocks of size 2^( 7) =       0.000417396938

      target function =      -0.951420420554
              le_mean =     -17.211856680863
             les_mean =     296.524185206546
             stat err =       0.000413435633
             autocorr =       1.237831508908
   target nu stat err =       0.000413435633
   target dn stat err =       0.001859498659
      target stat err =       0.003282834086
              std dev =       0.525523493344
             le_variance =       0.276174942056


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.951420421773        initial  <--
     9.7656e+02     9.7656e+03             5.4856e-07        -0.951420402260
     3.9062e+03     3.9062e+04             1.3715e-07        -0.951420412017
     1.5625e+04     1.5625e+05             3.4287e-08        -0.951420420554

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8360
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244236e-02 1 1  ON 7
 uu_8                 8.655818e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881991e-02 1 1  ON 13
 ud_4                -1.085213e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613800e-02 1 1  ON 17
 ud_8                 1.435760e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429686e-02 1 1  ON 45
eH2_6                 7.654508e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4712e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1541
    reference variance = 0.267152
====================================================
  Execution time = 2.0294e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8688e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5609e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286898874504
                                         uncertainty =       0.006035995912

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286898874504
                                         uncertainty =       0.006035995912

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378733489
  error estimate for blocks of size 2^( 2) =       0.000391917497
  error estimate for blocks of size 2^( 3) =       0.000404206081
  error estimate for blocks of size 2^( 4) =       0.000413312857
  error estimate for blocks of size 2^( 5) =       0.000417823715
  error estimate for blocks of size 2^( 6) =       0.000420061333
  error estimate for blocks of size 2^( 7) =       0.000422338973

      target function =      -0.933265474370
              le_mean =     -17.211973990098
             les_mean =     296.538926603078
             stat err =       0.000418384220
             autocorr =       1.220346542461
   target nu stat err =       0.000418384220
   target dn stat err =       0.006168865887
      target stat err =       0.010234460798
              std dev =       0.535610036029
             le_variance =       0.286878110695


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721197399010e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933375934606       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933375937329       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933375938260       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933375938973       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933375939858       residual = 5.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933375940629       residual = 4.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933375941065       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933375941232       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933375941435       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933375941591       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933375941745       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933375941793       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933375941833       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933375941920       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933375941974       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933375941966       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933375942008       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933375942034       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.933375942045       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933375942021       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.933375942049       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.933375942036       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.933375942057       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.933375942017       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 6.762578e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933375934606       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933375935287       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933375935519       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933375935697       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933375935919       residual = 5.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933375936111       residual = 4.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933375936221       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933375936262       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933375936336       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933375936374       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933375936424       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933375936406       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933375936446       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933375936433       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933375936499       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933375936515       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933375936487       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933375936471       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.933375936458       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933375936412       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.933375936440       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.933375936354       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.933375936455       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.933375936437       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 1.690647e-08

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933375934606       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933375934776       residual = 1.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933375934834       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933375934879       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933375934855       residual = 5.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933375934982       residual = 4.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933375935010       residual = 3.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933375935158       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933375934704       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933375935339       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933375934912       residual = 2.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933375935025       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933375934770       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933375935413       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933375935140       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933375935172       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933375935288       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933375935130       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.933375935234       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933375935072       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.933375935032       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.933375934880       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.933375935306       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.933375934891       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+05 is 4.226619e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.366762 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5884e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326324e-02 1 1  ON 1
 uu_2                -4.191473e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244238e-02 1 1  ON 7
 uu_8                 8.655816e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839232e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085213e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435752e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903087e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034851e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552416e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654508e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1721
    reference variance = 0.136879
====================================================
  Execution time = 1.9779e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8669e-01
  Total weights = 2.0000e+06
  Execution time = 1.8230e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286753503341
                                         uncertainty =       0.003299552977

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286753503341
                                         uncertainty =       0.003299552977

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378606669
  error estimate for blocks of size 2^( 2) =       0.000392147970
  error estimate for blocks of size 2^( 3) =       0.000404212807
  error estimate for blocks of size 2^( 4) =       0.000413425734
  error estimate for blocks of size 2^( 5) =       0.000418251742
  error estimate for blocks of size 2^( 6) =       0.000420902077
  error estimate for blocks of size 2^( 7) =       0.000422408532

      target function =      -0.933652701956
              le_mean =     -17.212190889148
             les_mean =     296.546201081330
             stat err =       0.000418747021
             autocorr =       1.223283002313
   target nu stat err =       0.000418747021
   target dn stat err =       0.003474736487
      target stat err =       0.005804031067
              std dev =       0.535430686649
             le_variance =       0.286686020205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286753504229
                                         uncertainty =       0.003299552882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286753504229
                                         uncertainty =       0.003299552882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378606670
  error estimate for blocks of size 2^( 2) =       0.000392147972
  error estimate for blocks of size 2^( 3) =       0.000404212810
  error estimate for blocks of size 2^( 4) =       0.000413425740
  error estimate for blocks of size 2^( 5) =       0.000418251749
  error estimate for blocks of size 2^( 6) =       0.000420902085
  error estimate for blocks of size 2^( 7) =       0.000422408539

      target function =      -0.933652700499
              le_mean =     -17.212190889069
             les_mean =     296.546201079480
             stat err =       0.000418747028
             autocorr =       1.223283040370
   target nu stat err =       0.000418747028
   target dn stat err =       0.003474736370
      target stat err =       0.005804030858
              std dev =       0.535430687473
             le_variance =       0.286686021087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286753503785
                                         uncertainty =       0.003299552929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286753503785
                                         uncertainty =       0.003299552929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378606670
  error estimate for blocks of size 2^( 2) =       0.000392147971
  error estimate for blocks of size 2^( 3) =       0.000404212809
  error estimate for blocks of size 2^( 4) =       0.000413425737
  error estimate for blocks of size 2^( 5) =       0.000418251745
  error estimate for blocks of size 2^( 6) =       0.000420902081
  error estimate for blocks of size 2^( 7) =       0.000422408536

      target function =      -0.933652701228
              le_mean =     -17.212190889108
             les_mean =     296.546201080405
             stat err =       0.000418747025
             autocorr =       1.223283021337
   target nu stat err =       0.000418747025
   target dn stat err =       0.003474736429
      target stat err =       0.005804030962
              std dev =       0.535430687061
             le_variance =       0.286686020646

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286753503397
                                         uncertainty =       0.003299552971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286753503397
                                         uncertainty =       0.003299552971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378606669
  error estimate for blocks of size 2^( 2) =       0.000392147971
  error estimate for blocks of size 2^( 3) =       0.000404212807
  error estimate for blocks of size 2^( 4) =       0.000413425735
  error estimate for blocks of size 2^( 5) =       0.000418251742
  error estimate for blocks of size 2^( 6) =       0.000420902077
  error estimate for blocks of size 2^( 7) =       0.000422408532

      target function =      -0.933652701865
              le_mean =     -17.212190889143
             les_mean =     296.546201081215
             stat err =       0.000418747022
             autocorr =       1.223283004673
   target nu stat err =       0.000418747022
   target dn stat err =       0.003474736480
      target stat err =       0.005804031054
              std dev =       0.535430686700
             le_variance =       0.286686020260


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.933652701956        initial  <--
     9.7656e+03     9.7656e+04             6.7626e-08        -0.933652700499
     3.9062e+04     3.9062e+05             1.6906e-08        -0.933652701228
     1.5625e+05     1.5625e+06             4.2266e-09        -0.933652701865

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0031
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244236e-02 1 1  ON 7
 uu_8                 8.655818e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881991e-02 1 1  ON 13
 ud_4                -1.085213e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613800e-02 1 1  ON 17
 ud_8                 1.435760e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429686e-02 1 1  ON 45
eH2_6                 7.654508e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4893e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1975
    reference variance = 0.252988
====================================================
  Execution time = 2.2558e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7815e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6023e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278005185512
                                         uncertainty =       0.002214651403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278005185512
                                         uncertainty =       0.002214651403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372930762
  error estimate for blocks of size 2^( 2) =       0.000386625405
  error estimate for blocks of size 2^( 3) =       0.000398558967
  error estimate for blocks of size 2^( 4) =       0.000407995670
  error estimate for blocks of size 2^( 5) =       0.000413863433
  error estimate for blocks of size 2^( 6) =       0.000417348277
  error estimate for blocks of size 2^( 7) =       0.000419963047

      target function =      -0.948021581302
              le_mean =     -17.212280755810
             les_mean =     296.540763384733
             stat err =       0.000414792606
             autocorr =       1.237102245595
   target nu stat err =       0.000414792606
   target dn stat err =       0.002320540825
      target stat err =       0.004033907800
              std dev =       0.527403741907
             le_variance =       0.278154706978


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721228075581e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948037759914       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948037760155       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948037760215       residual = 6.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948037760273       residual = 7.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948037760319       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948037760186       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948037760377       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948037759994       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948037760375       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948037760412       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948037760347       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.948037760388       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.948037760340       residual = 8.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.948037760503       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.948037760430       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.948037760707       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.948037760344       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.948037760168       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.948037760986       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.948037760517       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.948037760537       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948037760042       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.948037760365       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.948037760686       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.948037760188       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 6.482560e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948037759914       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948037759974       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948037759989       residual = 6.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948037760004       residual = 7.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948037760015       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948037759677       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948037758903       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948037759578       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948037761037       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948037759298       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948037759580       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.948037759859       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.948037761120       residual = 8.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.948037759721       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.948037760778       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.948037759618       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.948037760158       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.948037758760       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.948037760253       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.948037760835       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.948037759736       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948037759977       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.948037758325       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.948037759248       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.948037758917       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 1.620639e-09

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948037759914       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948037759929       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948037759933       residual = 6.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948037759936       residual = 7.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948037759521       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948037759385       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948037762019       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948037756534       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948037758973       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948037760652       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948037759178       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.948037757497       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.948037759901       residual = 8.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.948037758431       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.948037761037       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.948037766057       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.948037752859       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.948037759620       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.948037761277       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.948037761521       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.948037759024       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948037761913       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.948037762842       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.948037756007       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.948037762917       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+06 is 4.051601e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.386643 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8192e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244236e-02 1 1  ON 7
 uu_8                 8.655818e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881991e-02 1 1  ON 13
 ud_4                -1.085213e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613800e-02 1 1  ON 17
 ud_8                 1.435759e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654508e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1681
    reference variance = 0.281009
====================================================
  Execution time = 1.9685e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8696e-01
  Total weights = 2.0000e+06
  Execution time = 1.8187e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286985472016
                                         uncertainty =       0.004076658889

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286985472016
                                         uncertainty =       0.004076658889

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378787395
  error estimate for blocks of size 2^( 2) =       0.000392438546
  error estimate for blocks of size 2^( 3) =       0.000404443135
  error estimate for blocks of size 2^( 4) =       0.000413130119
  error estimate for blocks of size 2^( 5) =       0.000417629412
  error estimate for blocks of size 2^( 6) =       0.000420383346
  error estimate for blocks of size 2^( 7) =       0.000422764047

      target function =      -0.933191167611
              le_mean =     -17.211831705119
             les_mean =     296.534110282996
             stat err =       0.000418476731
             autocorr =       1.220538806983
   target nu stat err =       0.000418476731
   target dn stat err =       0.004261325502
      target stat err =       0.007086622238
              std dev =       0.535686271188
             le_variance =       0.286959781140

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286985471798
                                         uncertainty =       0.004076658877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286985471798
                                         uncertainty =       0.004076658877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378787395
  error estimate for blocks of size 2^( 2) =       0.000392438545
  error estimate for blocks of size 2^( 3) =       0.000404443135
  error estimate for blocks of size 2^( 4) =       0.000413130119
  error estimate for blocks of size 2^( 5) =       0.000417629412
  error estimate for blocks of size 2^( 6) =       0.000420383346
  error estimate for blocks of size 2^( 7) =       0.000422764047

      target function =      -0.933191167970
              le_mean =     -17.211831705095
             les_mean =     296.534110281967
             stat err =       0.000418476731
             autocorr =       1.220538808614
   target nu stat err =       0.000418476731
   target dn stat err =       0.004261325489
      target stat err =       0.007086622221
              std dev =       0.535686270986
             le_variance =       0.286959780923

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286985471907
                                         uncertainty =       0.004076658883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286985471907
                                         uncertainty =       0.004076658883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378787395
  error estimate for blocks of size 2^( 2) =       0.000392438545
  error estimate for blocks of size 2^( 3) =       0.000404443135
  error estimate for blocks of size 2^( 4) =       0.000413130119
  error estimate for blocks of size 2^( 5) =       0.000417629412
  error estimate for blocks of size 2^( 6) =       0.000420383346
  error estimate for blocks of size 2^( 7) =       0.000422764047

      target function =      -0.933191167791
              le_mean =     -17.211831705107
             les_mean =     296.534110282481
             stat err =       0.000418476731
             autocorr =       1.220538807789
   target nu stat err =       0.000418476731
   target dn stat err =       0.004261325495
      target stat err =       0.007086622230
              std dev =       0.535686271087
             le_variance =       0.286959781031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286985472002
                                         uncertainty =       0.004076658888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286985472002
                                         uncertainty =       0.004076658888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378787395
  error estimate for blocks of size 2^( 2) =       0.000392438546
  error estimate for blocks of size 2^( 3) =       0.000404443135
  error estimate for blocks of size 2^( 4) =       0.000413130119
  error estimate for blocks of size 2^( 5) =       0.000417629412
  error estimate for blocks of size 2^( 6) =       0.000420383346
  error estimate for blocks of size 2^( 7) =       0.000422764047

      target function =      -0.933191167634
              le_mean =     -17.211831705117
             les_mean =     296.534110282932
             stat err =       0.000418476731
             autocorr =       1.220538807089
   target nu stat err =       0.000418476731
   target dn stat err =       0.004261325501
      target stat err =       0.007086622237
              std dev =       0.535686271176
             le_variance =       0.286959781126


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.933191167611        initial
     9.7656e+04     9.7656e+05             6.4826e-09        -0.933191167970  <--
     3.9062e+05     3.9062e+06             1.6206e-09        -0.933191167791
     1.5625e+06     1.5625e+07             4.0516e-10        -0.933191167634

*****************************************************************************
Applying the update for shift_i =   9.7656e+04     and shift_s =   9.7656e+05
*****************************************************************************

  Execution time = 2.8896e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435758e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654508e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7095e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2579
    reference variance = 0.228384
====================================================
  Execution time = 2.0089e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7944e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5638e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279479082267
                                         uncertainty =       0.002364522705

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279479082267
                                         uncertainty =       0.002364522705

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373793564
  error estimate for blocks of size 2^( 2) =       0.000387582056
  error estimate for blocks of size 2^( 3) =       0.000399178935
  error estimate for blocks of size 2^( 4) =       0.000407835502
  error estimate for blocks of size 2^( 5) =       0.000413361761
  error estimate for blocks of size 2^( 6) =       0.000416005826
  error estimate for blocks of size 2^( 7) =       0.000417653357

      target function =      -0.945820870602
              le_mean =     -17.212604442379
             les_mean =     296.553194807546
             stat err =       0.000413714112
             autocorr =       1.225002654412
   target nu stat err =       0.000413714112
   target dn stat err =       0.002461345130
      target stat err =       0.004253288597
              std dev =       0.528623928201
             le_variance =       0.279443257466


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721260444238e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945838724239       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945838725454       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945838725794       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945838726080       residual = 9.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945838726253       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945838726371       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945838726482       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945838726576       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945838726633       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945838726504       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945838726692       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945838726600       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945838726708       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945838726851       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.945838726728       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945838726734       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.945838726728       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945838726714       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945838726756       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945838726847       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945838726669       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945838726787       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945838726727       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945838726640       residual = 7.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+04 is 2.359333e-08

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945838724239       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945838724543       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945838724628       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945838724699       residual = 9.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945838724749       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945838724716       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945838724944       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945838725218       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945838724943       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945838725107       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945838724891       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945838724861       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945838724747       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945838724997       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.945838725078       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945838724480       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.945838724254       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945838724814       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945838724884       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945838724738       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945838724787       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945838724106       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945838725076       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945838725284       residual = 7.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+04 is 5.898343e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945838724239       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945838724315       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945838724336       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945838724354       residual = 9.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945838724373       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945838723517       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945838724249       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945838724276       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945838724388       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945838725129       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945838723749       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945838725016       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945838722851       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945838724848       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.945838725135       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945838723875       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.945838724345       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945838725578       residual = 7.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945838723847       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945838724100       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945838724751       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945838724176       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945838723334       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945838723977       residual = 7.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+05 is 1.474587e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.404805 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5682e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326324e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839232e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435755e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654508e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.1859
    reference variance = 0.185083
====================================================
  Execution time = 1.9999e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8095e-01
  Total weights = 2.0000e+06
  Execution time = 1.8159e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280988428661
                                         uncertainty =       0.005376277337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280988428661
                                         uncertainty =       0.005376277337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374797277
  error estimate for blocks of size 2^( 2) =       0.000388197029
  error estimate for blocks of size 2^( 3) =       0.000400251035
  error estimate for blocks of size 2^( 4) =       0.000409122705
  error estimate for blocks of size 2^( 5) =       0.000414332659
  error estimate for blocks of size 2^( 6) =       0.000417345936
  error estimate for blocks of size 2^( 7) =       0.000418096039

      target function =      -0.943200784445
              le_mean =     -17.212256950633
             les_mean =     296.542735191356
             stat err =       0.000414724335
             autocorr =       1.224408075884
   target nu stat err =       0.000414724335
   target dn stat err =       0.005568748771
      target stat err =       0.009445954217
              std dev =       0.530043391827
             le_variance =       0.280945997220

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280988429502
                                         uncertainty =       0.005376277503

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280988429502
                                         uncertainty =       0.005376277503

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374797277
  error estimate for blocks of size 2^( 2) =       0.000388197030
  error estimate for blocks of size 2^( 3) =       0.000400251036
  error estimate for blocks of size 2^( 4) =       0.000409122706
  error estimate for blocks of size 2^( 5) =       0.000414332659
  error estimate for blocks of size 2^( 6) =       0.000417345937
  error estimate for blocks of size 2^( 7) =       0.000418096040

      target function =      -0.943200783024
              le_mean =     -17.212256950590
             les_mean =     296.542735190723
             stat err =       0.000414724336
             autocorr =       1.224408076765
   target nu stat err =       0.000414724336
   target dn stat err =       0.005568748940
      target stat err =       0.009445954473
              std dev =       0.530043392617
             le_variance =       0.280945998057

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280988429081
                                         uncertainty =       0.005376277420

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280988429081
                                         uncertainty =       0.005376277420

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374797277
  error estimate for blocks of size 2^( 2) =       0.000388197030
  error estimate for blocks of size 2^( 3) =       0.000400251036
  error estimate for blocks of size 2^( 4) =       0.000409122706
  error estimate for blocks of size 2^( 5) =       0.000414332659
  error estimate for blocks of size 2^( 6) =       0.000417345937
  error estimate for blocks of size 2^( 7) =       0.000418096039

      target function =      -0.943200783734
              le_mean =     -17.212256950612
             les_mean =     296.542735191040
             stat err =       0.000414724335
             autocorr =       1.224408076328
   target nu stat err =       0.000414724335
   target dn stat err =       0.005568748856
      target stat err =       0.009445954345
              std dev =       0.530043392222
             le_variance =       0.280945997639

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280988428714
                                         uncertainty =       0.005376277347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280988428714
                                         uncertainty =       0.005376277347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374797277
  error estimate for blocks of size 2^( 2) =       0.000388197029
  error estimate for blocks of size 2^( 3) =       0.000400251035
  error estimate for blocks of size 2^( 4) =       0.000409122706
  error estimate for blocks of size 2^( 5) =       0.000414332659
  error estimate for blocks of size 2^( 6) =       0.000417345936
  error estimate for blocks of size 2^( 7) =       0.000418096039

      target function =      -0.943200784356
              le_mean =     -17.212256950630
             les_mean =     296.542735191317
             stat err =       0.000414724335
             autocorr =       1.224408075937
   target nu stat err =       0.000414724335
   target dn stat err =       0.005568748782
      target stat err =       0.009445954233
              std dev =       0.530043391877
             le_variance =       0.280945997272


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943200784445        initial  <--
     2.4414e+04     2.4414e+05             2.3593e-08        -0.943200783024
     9.7656e+04     9.7656e+05             5.8983e-09        -0.943200783734
     3.9062e+05     3.9062e+06             1.4746e-09        -0.943200784356

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1958
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435758e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654508e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4883e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1947
    reference variance = 0.189179
====================================================
  Execution time = 2.0274e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7725e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.8578e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277296544165
                                         uncertainty =       0.002581954853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277296544165
                                         uncertainty =       0.002581954853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372323717
  error estimate for blocks of size 2^( 2) =       0.000385844832
  error estimate for blocks of size 2^( 3) =       0.000398351872
  error estimate for blocks of size 2^( 4) =       0.000407569809
  error estimate for blocks of size 2^( 5) =       0.000412867122
  error estimate for blocks of size 2^( 6) =       0.000415325891
  error estimate for blocks of size 2^( 7) =       0.000415591889

      target function =      -0.949563999500
              le_mean =     -17.211496947188
             les_mean =     296.512876924337
             stat err =       0.000412838678
             autocorr =       1.229474015584
   target nu stat err =       0.000412838678
   target dn stat err =       0.002693972750
      target stat err =       0.004669772076
              std dev =       0.526545249609
             le_variance =       0.277249899886


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721149694719e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949586010559       residual = 8.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949586010654       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949586010702       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949586010745       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949586010331       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949586010839       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949586011500       residual = 4.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949586011196       residual = 8.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949586010583       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949586011253       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.949586010521       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.949586010382       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.949586010707       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.949586010886       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.949586011524       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.949586010812       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.949586010693       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.949586010594       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.949586010529       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.949586010172       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.949586011414       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.949586010885       residual = 8.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.949586010432       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.949586011093       residual = 5.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 2.089090e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949586010559       residual = 8.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949586010583       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949586010595       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949586010643       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949586010612       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949586012104       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949586010479       residual = 4.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949586011839       residual = 8.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949586010819       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949586009005       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.949586009854       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.949586009449       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.949586011610       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.949586010572       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.949586007469       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.949586012512       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.949586010541       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.949586011016       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.949586007042       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.949586009022       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.949586010049       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.949586012590       residual = 8.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.949586008359       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.949586008650       residual = 5.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 5.222731e-10

solving harmonic davidson linear method for identity shift 3.9062e+06, overlap shift 3.9062e+07 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949586010559       residual = 8.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949586010565       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949586010568       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949586010526       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949586010419       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949586005628       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949586008765       residual = 4.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949586006870       residual = 8.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949586006698       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949586013096       residual = 2.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.949585996186       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.949586016298       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.949586010381       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.949586009764       residual = 7.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.949586021044       residual = 2.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.949586004084       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.949586012958       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.949586003379       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.949586020890       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.949586007671       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.949586006633       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.949585997682       residual = 8.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.949586018665       residual = 4.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.949586005704       residual = 5.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+06 is 1.305685e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.426357 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8411e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435758e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654508e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.3464
    reference variance = 1.09292
====================================================
  Execution time = 1.9736e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8229e-01
  Total weights = 2.0000e+06
  Execution time = 1.8133e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282244851127
                                         uncertainty =       0.004010054091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282244851127
                                         uncertainty =       0.004010054091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375693894
  error estimate for blocks of size 2^( 2) =       0.000389369657
  error estimate for blocks of size 2^( 3) =       0.000401662017
  error estimate for blocks of size 2^( 4) =       0.000410732236
  error estimate for blocks of size 2^( 5) =       0.000415643673
  error estimate for blocks of size 2^( 6) =       0.000418893449
  error estimate for blocks of size 2^( 7) =       0.000419045028

      target function =      -0.940979894480
              le_mean =     -17.212003198162
             les_mean =     296.535345756860
             stat err =       0.000416078597
             autocorr =       1.226542150785
   target nu stat err =       0.000416078597
   target dn stat err =       0.003966898757
      target stat err =       0.006714185043
              std dev =       0.531311400652
             le_variance =       0.282291804463

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282244851079
                                         uncertainty =       0.004010054117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282244851079
                                         uncertainty =       0.004010054117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375693894
  error estimate for blocks of size 2^( 2) =       0.000389369657
  error estimate for blocks of size 2^( 3) =       0.000401662017
  error estimate for blocks of size 2^( 4) =       0.000410732236
  error estimate for blocks of size 2^( 5) =       0.000415643673
  error estimate for blocks of size 2^( 6) =       0.000418893449
  error estimate for blocks of size 2^( 7) =       0.000419045028

      target function =      -0.940979894560
              le_mean =     -17.212003198173
             les_mean =     296.535345757179
             stat err =       0.000416078597
             autocorr =       1.226542151813
   target nu stat err =       0.000416078597
   target dn stat err =       0.003966898782
      target stat err =       0.006714185087
              std dev =       0.531311400607
             le_variance =       0.282291804415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282244851103
                                         uncertainty =       0.004010054104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282244851103
                                         uncertainty =       0.004010054104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375693894
  error estimate for blocks of size 2^( 2) =       0.000389369657
  error estimate for blocks of size 2^( 3) =       0.000401662017
  error estimate for blocks of size 2^( 4) =       0.000410732236
  error estimate for blocks of size 2^( 5) =       0.000415643673
  error estimate for blocks of size 2^( 6) =       0.000418893449
  error estimate for blocks of size 2^( 7) =       0.000419045028

      target function =      -0.940979894520
              le_mean =     -17.212003198167
             les_mean =     296.535345757019
             stat err =       0.000416078597
             autocorr =       1.226542151303
   target nu stat err =       0.000416078597
   target dn stat err =       0.003966898769
      target stat err =       0.006714185065
              std dev =       0.531311400630
             le_variance =       0.282291804439

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282244851124
                                         uncertainty =       0.004010054092

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282244851124
                                         uncertainty =       0.004010054092

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375693894
  error estimate for blocks of size 2^( 2) =       0.000389369657
  error estimate for blocks of size 2^( 3) =       0.000401662017
  error estimate for blocks of size 2^( 4) =       0.000410732236
  error estimate for blocks of size 2^( 5) =       0.000415643673
  error estimate for blocks of size 2^( 6) =       0.000418893449
  error estimate for blocks of size 2^( 7) =       0.000419045028

      target function =      -0.940979894485
              le_mean =     -17.212003198163
             les_mean =     296.535345756880
             stat err =       0.000416078597
             autocorr =       1.226542150863
   target nu stat err =       0.000416078597
   target dn stat err =       0.003966898758
      target stat err =       0.006714185046
              std dev =       0.531311400649
             le_variance =       0.282291804460


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940979894480        initial
     2.4414e+05     2.4414e+06             2.0891e-09        -0.940979894560  <--
     9.7656e+05     9.7656e+06             5.2227e-10        -0.940979894520
     3.9062e+06     3.9062e+07             1.3057e-10        -0.940979894485

*****************************************************************************
Applying the update for shift_i =   2.4414e+05     and shift_s =   2.4414e+06
*****************************************************************************

  Execution time = 2.8924e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654508e-02 1 1  ON 46
eH2_7                 1.129439e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7342e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1891
    reference variance = 0.326265
====================================================
  Execution time = 2.0079e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8659e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4816e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286499913143
                                         uncertainty =       0.005314638751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286499913143
                                         uncertainty =       0.005314638751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378546504
  error estimate for blocks of size 2^( 2) =       0.000392017654
  error estimate for blocks of size 2^( 3) =       0.000403614084
  error estimate for blocks of size 2^( 4) =       0.000412369758
  error estimate for blocks of size 2^( 5) =       0.000417717447
  error estimate for blocks of size 2^( 6) =       0.000421406366
  error estimate for blocks of size 2^( 7) =       0.000423817315

      target function =      -0.933756076399
              le_mean =     -17.212225513579
             les_mean =     296.547301898845
             stat err =       0.000418827721
             autocorr =       1.224143577105
   target nu stat err =       0.000418827721
   target dn stat err =       0.005285882565
      target stat err =       0.008791070103
              std dev =       0.535345600375
             le_variance =       0.286594911841


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721222551358e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933837235486       residual = 1.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933837236171       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933837236342       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933837236459       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933837236568       residual = 7.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933837236684       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933837236574       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933837236786       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933837236658       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933837236691       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933837236838       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933837236789       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933837236972       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933837236831       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933837236802       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933837236824       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933837236952       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933837237202       residual = 5.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.933837236705       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933837236666       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.933837236977       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.933837236741       residual = 9.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.933837236982       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.933837236752       residual = 6.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 1.222258e-08

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933837235486       residual = 1.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933837235657       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933837235700       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933837235732       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933837235905       residual = 7.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933837235780       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933837235885       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933837235813       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933837235834       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933837235022       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933837235824       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933837235828       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933837235379       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933837235831       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933837235831       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933837236226       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933837235947       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933837235263       residual = 5.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.933837235449       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933837235462       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.933837236701       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.933837236158       residual = 9.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.933837235793       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.933837236100       residual = 6.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+05 is 3.055646e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933837235486       residual = 1.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933837235529       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933837235540       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933837235526       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933837235554       residual = 7.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933837235924       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933837236415       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933837235568       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933837235526       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933837235577       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933837235044       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933837234690       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933837234611       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933837232334       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933837233474       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933837234017       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933837234130       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933837232063       residual = 5.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.933837232787       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933837238616       residual = 3.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.933837235547       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.933837231250       residual = 9.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.933837236392       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.933837231414       residual = 6.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+05 is 7.639126e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.444754 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5590e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326324e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435755e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2626
    reference variance = 0.419102
====================================================
  Execution time = 1.9930e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8209e-01
  Total weights = 2.0000e+06
  Execution time = 1.8125e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282139603862
                                         uncertainty =       0.003350280703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282139603862
                                         uncertainty =       0.003350280703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375562627
  error estimate for blocks of size 2^( 2) =       0.000389110356
  error estimate for blocks of size 2^( 3) =       0.000401473373
  error estimate for blocks of size 2^( 4) =       0.000410184446
  error estimate for blocks of size 2^( 5) =       0.000415114933
  error estimate for blocks of size 2^( 6) =       0.000418503934
  error estimate for blocks of size 2^( 7) =       0.000423040828

      target function =      -0.941321015456
              le_mean =     -17.212197605497
             les_mean =     296.541840843644
             stat err =       0.000416711036
             autocorr =       1.231133833539
   target nu stat err =       0.000416711036
   target dn stat err =       0.003429366185
      target stat err =       0.005822812621
              std dev =       0.531125761007
             le_variance =       0.282094574005

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282139604537
                                         uncertainty =       0.003350280699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282139604537
                                         uncertainty =       0.003350280699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375562628
  error estimate for blocks of size 2^( 2) =       0.000389110357
  error estimate for blocks of size 2^( 3) =       0.000401473374
  error estimate for blocks of size 2^( 4) =       0.000410184447
  error estimate for blocks of size 2^( 5) =       0.000415114934
  error estimate for blocks of size 2^( 6) =       0.000418503936
  error estimate for blocks of size 2^( 7) =       0.000423040830

      target function =      -0.941321014319
              le_mean =     -17.212197605528
             les_mean =     296.541840845375
             stat err =       0.000416711037
             autocorr =       1.231133837673
   target nu stat err =       0.000416711037
   target dn stat err =       0.003429366179
      target stat err =       0.005822812597
              std dev =       0.531125761643
             le_variance =       0.282094574680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282139604199
                                         uncertainty =       0.003350280701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282139604199
                                         uncertainty =       0.003350280701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375562627
  error estimate for blocks of size 2^( 2) =       0.000389110356
  error estimate for blocks of size 2^( 3) =       0.000401473373
  error estimate for blocks of size 2^( 4) =       0.000410184447
  error estimate for blocks of size 2^( 5) =       0.000415114934
  error estimate for blocks of size 2^( 6) =       0.000418503935
  error estimate for blocks of size 2^( 7) =       0.000423040829

      target function =      -0.941321014887
              le_mean =     -17.212197605513
             les_mean =     296.541840844509
             stat err =       0.000416711036
             autocorr =       1.231133835605
   target nu stat err =       0.000416711036
   target dn stat err =       0.003429366182
      target stat err =       0.005822812609
              std dev =       0.531125761325
             le_variance =       0.282094574343

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282139603904
                                         uncertainty =       0.003350280703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282139603904
                                         uncertainty =       0.003350280703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375562627
  error estimate for blocks of size 2^( 2) =       0.000389110356
  error estimate for blocks of size 2^( 3) =       0.000401473373
  error estimate for blocks of size 2^( 4) =       0.000410184446
  error estimate for blocks of size 2^( 5) =       0.000415114933
  error estimate for blocks of size 2^( 6) =       0.000418503935
  error estimate for blocks of size 2^( 7) =       0.000423040828

      target function =      -0.941321015385
              le_mean =     -17.212197605499
             les_mean =     296.541840843752
             stat err =       0.000416711036
             autocorr =       1.231133833804
   target nu stat err =       0.000416711036
   target dn stat err =       0.003429366185
      target stat err =       0.005822812619
              std dev =       0.531125761047
             le_variance =       0.282094574048


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.941321015456        initial  <--
     6.1035e+04     6.1035e+05             1.2223e-08        -0.941321014319
     2.4414e+05     2.4414e+06             3.0556e-09        -0.941321014887
     9.7656e+05     9.7656e+06             7.6391e-10        -0.941321015385

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1109
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654508e-02 1 1  ON 46
eH2_7                 1.129439e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4707e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2278
    reference variance = 0.12894
====================================================
  Execution time = 2.0009e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7912e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5334e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279145415247
                                         uncertainty =       0.002617962077

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279145415247
                                         uncertainty =       0.002617962077

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373580517
  error estimate for blocks of size 2^( 2) =       0.000386949298
  error estimate for blocks of size 2^( 3) =       0.000399069554
  error estimate for blocks of size 2^( 4) =       0.000408991310
  error estimate for blocks of size 2^( 5) =       0.000414071621
  error estimate for blocks of size 2^( 6) =       0.000417248275
  error estimate for blocks of size 2^( 7) =       0.000419020927

      target function =      -0.946368190042
              le_mean =     -17.212106223213
             les_mean =     296.535725305239
             stat err =       0.000414833033
             autocorr =       1.233043012106
   target nu stat err =       0.000414833033
   target dn stat err =       0.002348557582
      target stat err =       0.004065630787
              std dev =       0.528322634029
             le_variance =       0.279124805628


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721210622321e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946384707223       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946384707273       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946384707288       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946384707303       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946384707563       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946384706882       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946384706994       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946384708759       residual = 9.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946384707386       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946384707450       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946384707262       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946384707646       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946384706560       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946384705659       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946384706816       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946384709758       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946384707967       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946384709909       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946384705701       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946384706188       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946384705829       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946384709829       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946384710736       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946384706218       residual = 5.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 8.650940e-10

solving harmonic davidson linear method for identity shift 2.4414e+06, overlap shift 2.4414e+07 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946384707223       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946384707236       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946384707239       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946384707240       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946384707108       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946384707223       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946384708378       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946384707249       residual = 9.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946384707372       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946384707970       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946384703063       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946384698986       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946384706537       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946384710853       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946384706272       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946384707705       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946384700077       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946384709884       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946384697977       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946384702818       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946384712414       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946384719736       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946384711688       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946384715825       residual = 5.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+06 is 2.162743e-10

solving harmonic davidson linear method for identity shift 9.7656e+06, overlap shift 9.7656e+07 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946384707223       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946384707226       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946384707227       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946384707228       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946384713113       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946384722302       residual = 3.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946384715228       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946384708996       residual = 9.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946384697220       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946384719843       residual = 1.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946384695797       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946384730219       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946384744511       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946384700645       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946384731646       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946384683292       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946384707734       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946384709432       residual = 6.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946384688433       residual = 6.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946384715839       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946384715782       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946384696688       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946384701466       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946384713450       residual = 5.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+06 is 5.406868e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.462892 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5572e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654508e-02 1 1  ON 46
eH2_7                 1.129439e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1622
    reference variance = 0.174339
====================================================
  Execution time = 1.9550e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7703e-01
  Total weights = 2.0000e+06
  Execution time = 1.8084e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276906030414
                                         uncertainty =       0.002403170422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276906030414
                                         uncertainty =       0.002403170422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372178185
  error estimate for blocks of size 2^( 2) =       0.000386133819
  error estimate for blocks of size 2^( 3) =       0.000398895174
  error estimate for blocks of size 2^( 4) =       0.000407632733
  error estimate for blocks of size 2^( 5) =       0.000413144178
  error estimate for blocks of size 2^( 6) =       0.000416051475
  error estimate for blocks of size 2^( 7) =       0.000417793908

      target function =      -0.949935327821
              le_mean =     -17.211201424248
             les_mean =     296.502487529743
             stat err =       0.000413655573
             autocorr =       1.235309934506
   target nu stat err =       0.000413655573
   target dn stat err =       0.002636533783
      target stat err =       0.004573959646
              std dev =       0.526339436333
             le_variance =       0.277033202239

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276906030446
                                         uncertainty =       0.002403170424

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276906030446
                                         uncertainty =       0.002403170424

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372178185
  error estimate for blocks of size 2^( 2) =       0.000386133819
  error estimate for blocks of size 2^( 3) =       0.000398895174
  error estimate for blocks of size 2^( 4) =       0.000407632733
  error estimate for blocks of size 2^( 5) =       0.000413144178
  error estimate for blocks of size 2^( 6) =       0.000416051475
  error estimate for blocks of size 2^( 7) =       0.000417793908

      target function =      -0.949935327767
              le_mean =     -17.211201424246
             les_mean =     296.502487529730
             stat err =       0.000413655574
             autocorr =       1.235309934648
   target nu stat err =       0.000413655574
   target dn stat err =       0.002636533785
      target stat err =       0.004573959649
              std dev =       0.526339436363
             le_variance =       0.277033202271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276906030430
                                         uncertainty =       0.002403170423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276906030430
                                         uncertainty =       0.002403170423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372178185
  error estimate for blocks of size 2^( 2) =       0.000386133819
  error estimate for blocks of size 2^( 3) =       0.000398895174
  error estimate for blocks of size 2^( 4) =       0.000407632733
  error estimate for blocks of size 2^( 5) =       0.000413144178
  error estimate for blocks of size 2^( 6) =       0.000416051475
  error estimate for blocks of size 2^( 7) =       0.000417793908

      target function =      -0.949935327794
              le_mean =     -17.211201424247
             les_mean =     296.502487529737
             stat err =       0.000413655573
             autocorr =       1.235309934584
   target nu stat err =       0.000413655573
   target dn stat err =       0.002636533784
      target stat err =       0.004573959648
              std dev =       0.526339436348
             le_variance =       0.277033202255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276906030416
                                         uncertainty =       0.002403170422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276906030416
                                         uncertainty =       0.002403170422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372178185
  error estimate for blocks of size 2^( 2) =       0.000386133819
  error estimate for blocks of size 2^( 3) =       0.000398895174
  error estimate for blocks of size 2^( 4) =       0.000407632733
  error estimate for blocks of size 2^( 5) =       0.000413144178
  error estimate for blocks of size 2^( 6) =       0.000416051475
  error estimate for blocks of size 2^( 7) =       0.000417793908

      target function =      -0.949935327818
              le_mean =     -17.211201424247
             les_mean =     296.502487529742
             stat err =       0.000413655573
             autocorr =       1.235309934510
   target nu stat err =       0.000413655573
   target dn stat err =       0.002636533783
      target stat err =       0.004573959646
              std dev =       0.526339436335
             le_variance =       0.277033202242


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949935327821        initial  <--
     6.1035e+05     6.1035e+06             8.6509e-10        -0.949935327767
     2.4414e+06     2.4414e+07             2.1627e-10        -0.949935327794
     9.7656e+06     9.7656e+07             5.4069e-11        -0.949935327818

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.7400
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654508e-02 1 1  ON 46
eH2_7                 1.129439e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4318e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2092
    reference variance = 0.286723
====================================================
  Execution time = 2.0297e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8396e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5231e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284029524027
                                         uncertainty =       0.003076247081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284029524027
                                         uncertainty =       0.003076247081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376803444
  error estimate for blocks of size 2^( 2) =       0.000390482003
  error estimate for blocks of size 2^( 3) =       0.000402732633
  error estimate for blocks of size 2^( 4) =       0.000412114790
  error estimate for blocks of size 2^( 5) =       0.000416635960
  error estimate for blocks of size 2^( 6) =       0.000419912654
  error estimate for blocks of size 2^( 7) =       0.000422384954

      target function =      -0.938196848645
              le_mean =     -17.212095165558
             les_mean =     296.540181517559
             stat err =       0.000417762090
             autocorr =       1.229216342330
   target nu stat err =       0.000417762090
   target dn stat err =       0.003072206253
      target stat err =       0.005191820639
              std dev =       0.532880541318
             le_variance =       0.283961671315


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721209516556e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938224734402       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938224734407       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938224734408       residual = 7.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938224734409       residual = 8.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938224733724       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938224729905       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938224746147       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938224730729       residual = 8.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938224731504       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938224705386       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938224732869       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938224734286       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938224719235       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.938224733324       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938224723223       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938224727547       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938224725765       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.938224768780       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938224754854       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.938224714167       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.938224717974       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.938224752493       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938224735270       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938224698951       residual = 1.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.938224749663       residual = 1.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 8.574391e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938224734402       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938224734403       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938224734404       residual = 7.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938224728241       residual = 8.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938224713777       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938224734404       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938224734404       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938224766841       residual = 8.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938224743936       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938224734404       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938224625665       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938224734404       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938224686147       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.938224775200       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938224734404       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938224734404       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938224734404       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.938224734404       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938224744822       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.938224821084       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.938224865412       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.938224817739       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938224728626       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938224692159       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.938224655468       residual = 1.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 2.143659e-11

solving harmonic davidson linear method for identity shift 9.7656e+07, overlap shift 9.7656e+08 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938224734402       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938224734403       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938224734403       residual = 7.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938224734403       residual = 8.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938224734403       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938224734403       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938224734403       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938224734403       residual = 8.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938224734403       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938224734403       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938224796612       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938224734403       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938224546690       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.938224769257       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938224566153       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938224977622       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938225036042       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.938224486730       residual = 8.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938224627501       residual = 5.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.938225008713       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.938224797155       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.938224745772       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938224608074       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938225106825       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.938224868086       residual = 1.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+07 is 5.360452e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.482733 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5852e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654508e-02 1 1  ON 46
eH2_7                 1.129439e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2096
    reference variance = 0.324215
====================================================
  Execution time = 2.1345e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8176e-01
  Total weights = 2.0000e+06
  Execution time = 1.8086e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281806728845
                                         uncertainty =       0.003697949082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281806728845
                                         uncertainty =       0.003697949082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375339066
  error estimate for blocks of size 2^( 2) =       0.000388860808
  error estimate for blocks of size 2^( 3) =       0.000401549324
  error estimate for blocks of size 2^( 4) =       0.000410890341
  error estimate for blocks of size 2^( 5) =       0.000416851888
  error estimate for blocks of size 2^( 6) =       0.000419738584
  error estimate for blocks of size 2^( 7) =       0.000418919792

      target function =      -0.941884433900
              le_mean =     -17.212371312035
             les_mean =     296.547484872139
             stat err =       0.000416600151
             autocorr =       1.231944966699
   target nu stat err =       0.000416600151
   target dn stat err =       0.003433710247
      target stat err =       0.005838891111
              std dev =       0.530809598292
             le_variance =       0.281758829639

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281806728845
                                         uncertainty =       0.003697949082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281806728845
                                         uncertainty =       0.003697949082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375339066
  error estimate for blocks of size 2^( 2) =       0.000388860808
  error estimate for blocks of size 2^( 3) =       0.000401549324
  error estimate for blocks of size 2^( 4) =       0.000410890341
  error estimate for blocks of size 2^( 5) =       0.000416851888
  error estimate for blocks of size 2^( 6) =       0.000419738584
  error estimate for blocks of size 2^( 7) =       0.000418919792

      target function =      -0.941884433901
              le_mean =     -17.212371312036
             les_mean =     296.547484872143
             stat err =       0.000416600151
             autocorr =       1.231944966755
   target nu stat err =       0.000416600151
   target dn stat err =       0.003433710248
      target stat err =       0.005838891111
              std dev =       0.530809598292
             le_variance =       0.281758829639

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281806728845
                                         uncertainty =       0.003697949082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281806728845
                                         uncertainty =       0.003697949082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375339066
  error estimate for blocks of size 2^( 2) =       0.000388860808
  error estimate for blocks of size 2^( 3) =       0.000401549324
  error estimate for blocks of size 2^( 4) =       0.000410890341
  error estimate for blocks of size 2^( 5) =       0.000416851888
  error estimate for blocks of size 2^( 6) =       0.000419738584
  error estimate for blocks of size 2^( 7) =       0.000418919792

      target function =      -0.941884433900
              le_mean =     -17.212371312035
             les_mean =     296.547484872141
             stat err =       0.000416600151
             autocorr =       1.231944966723
   target nu stat err =       0.000416600151
   target dn stat err =       0.003433710248
      target stat err =       0.005838891111
              std dev =       0.530809598292
             le_variance =       0.281758829639

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281806728845
                                         uncertainty =       0.003697949082

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281806728845
                                         uncertainty =       0.003697949082

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375339066
  error estimate for blocks of size 2^( 2) =       0.000388860808
  error estimate for blocks of size 2^( 3) =       0.000401549324
  error estimate for blocks of size 2^( 4) =       0.000410890341
  error estimate for blocks of size 2^( 5) =       0.000416851888
  error estimate for blocks of size 2^( 6) =       0.000419738584
  error estimate for blocks of size 2^( 7) =       0.000418919792

      target function =      -0.941884433900
              le_mean =     -17.212371312035
             les_mean =     296.547484872139
             stat err =       0.000416600151
             autocorr =       1.231944966710
   target nu stat err =       0.000416600151
   target dn stat err =       0.003433710247
      target stat err =       0.005838891111
              std dev =       0.530809598292
             le_variance =       0.281758829639


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.941884433900        initial
     6.1035e+06     6.1035e+07             8.5744e-11        -0.941884433901  <--
     2.4414e+07     2.4414e+08             2.1437e-11        -0.941884433900
     9.7656e+07     9.7656e+08             5.3605e-12        -0.941884433900

*****************************************************************************
Applying the update for shift_i =   6.1035e+06     and shift_s =   6.1035e+07
*****************************************************************************

  Execution time = 3.0506e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654508e-02 1 1  ON 46
eH2_7                 1.129439e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6364e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2334
    reference variance = 0.211052
====================================================
  Execution time = 2.0118e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8852e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5339e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288517823975
                                         uncertainty =       0.006133829771

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288517823975
                                         uncertainty =       0.006133829771

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379814793
  error estimate for blocks of size 2^( 2) =       0.000393611914
  error estimate for blocks of size 2^( 3) =       0.000405570892
  error estimate for blocks of size 2^( 4) =       0.000415183590
  error estimate for blocks of size 2^( 5) =       0.000420437809
  error estimate for blocks of size 2^( 6) =       0.000423725522
  error estimate for blocks of size 2^( 7) =       0.000424584052

      target function =      -0.930568327670
              le_mean =     -17.212115999083
             les_mean =     296.545455574904
             stat err =       0.000420982743
             autocorr =       1.228527370814
   target nu stat err =       0.000420982743
   target dn stat err =       0.005752035585
      target stat err =       0.009494520555
              std dev =       0.537139230810
             le_variance =       0.288518553275


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721211599908e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930663980074       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930663980093       residual = 2.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930663980108       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930663980118       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930663980121       residual = 4.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930663980126       residual = 6.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930663980128       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930663980131       residual = 9.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930663980131       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930663980131       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930663980132       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930663978927       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930663979787       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930663976152       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930663982071       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930663980459       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930663978812       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.930663976700       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.930663982918       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.930663976324       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.930663981534       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.930663978728       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.930663975662       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.930663983570       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.930663979564       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 3.796908e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930663980074       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930663980079       residual = 2.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930663980082       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930663982111       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930663980086       residual = 4.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930663979283       residual = 6.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930663979355       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930663982668       residual = 9.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930663972786       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930663952931       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930663986714       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930663984490       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930663980089       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930663997578       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930663968688       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930663981000       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930663974907       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.930663972843       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.930663981784       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.930663973261       residual = 5.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.930663969430       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.930663990424       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.930663956533       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.930664011025       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.930664002320       residual = 4.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 9.492212e-11

solving harmonic davidson linear method for identity shift 2.4414e+07, overlap shift 2.4414e+08 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930663980074       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930663980075       residual = 2.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930663980076       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930663980081       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930663997570       residual = 4.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930663980077       residual = 6.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930663936170       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930663976563       residual = 9.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930663948967       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930663988853       residual = 3.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930663948966       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930664031906       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930663980078       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930663982556       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930663959635       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930663978722       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930664056380       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.930664003094       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.930663929762       residual = 6.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.930664099857       residual = 5.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.930664072070       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.930664049600       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.930663999021       residual = 3.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.930663967117       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.930664002320       residual = 4.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+07 is 2.372994e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.502676 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5683e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654508e-02 1 1  ON 46
eH2_7                 1.129439e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2711
    reference variance = 0.235904
====================================================
  Execution time = 1.9586e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8359e-01
  Total weights = 2.0000e+06
  Execution time = 1.8074e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283581979209
                                         uncertainty =       0.004762525431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283581979209
                                         uncertainty =       0.004762525431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376554540
  error estimate for blocks of size 2^( 2) =       0.000389771581
  error estimate for blocks of size 2^( 3) =       0.000402280392
  error estimate for blocks of size 2^( 4) =       0.000410555340
  error estimate for blocks of size 2^( 5) =       0.000415558357
  error estimate for blocks of size 2^( 6) =       0.000417388597
  error estimate for blocks of size 2^( 7) =       0.000417805155

      target function =      -0.938790838265
              le_mean =     -17.212273662947
             les_mean =     296.545951149250
             stat err =       0.000415326862
             autocorr =       1.216534041633
   target nu stat err =       0.000415326862
   target dn stat err =       0.004408101752
      target stat err =       0.007421533664
              std dev =       0.532528537132
             le_variance =       0.283586642860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283581979214
                                         uncertainty =       0.004762525433

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283581979214
                                         uncertainty =       0.004762525433

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376554540
  error estimate for blocks of size 2^( 2) =       0.000389771581
  error estimate for blocks of size 2^( 3) =       0.000402280392
  error estimate for blocks of size 2^( 4) =       0.000410555340
  error estimate for blocks of size 2^( 5) =       0.000415558357
  error estimate for blocks of size 2^( 6) =       0.000417388598
  error estimate for blocks of size 2^( 7) =       0.000417805155

      target function =      -0.938790838256
              le_mean =     -17.212273662947
             les_mean =     296.545951149251
             stat err =       0.000415326862
             autocorr =       1.216534041883
   target nu stat err =       0.000415326862
   target dn stat err =       0.004408101754
      target stat err =       0.007421533667
              std dev =       0.532528537137
             le_variance =       0.283586642865

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283581979211
                                         uncertainty =       0.004762525432

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283581979211
                                         uncertainty =       0.004762525432

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376554540
  error estimate for blocks of size 2^( 2) =       0.000389771581
  error estimate for blocks of size 2^( 3) =       0.000402280392
  error estimate for blocks of size 2^( 4) =       0.000410555340
  error estimate for blocks of size 2^( 5) =       0.000415558357
  error estimate for blocks of size 2^( 6) =       0.000417388597
  error estimate for blocks of size 2^( 7) =       0.000417805155

      target function =      -0.938790838260
              le_mean =     -17.212273662947
             les_mean =     296.545951149251
             stat err =       0.000415326862
             autocorr =       1.216534041758
   target nu stat err =       0.000415326862
   target dn stat err =       0.004408101753
      target stat err =       0.007421533666
              std dev =       0.532528537135
             le_variance =       0.283586642863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283581979209
                                         uncertainty =       0.004762525431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283581979209
                                         uncertainty =       0.004762525431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376554540
  error estimate for blocks of size 2^( 2) =       0.000389771581
  error estimate for blocks of size 2^( 3) =       0.000402280392
  error estimate for blocks of size 2^( 4) =       0.000410555340
  error estimate for blocks of size 2^( 5) =       0.000415558357
  error estimate for blocks of size 2^( 6) =       0.000417388597
  error estimate for blocks of size 2^( 7) =       0.000417805155

      target function =      -0.938790838264
              le_mean =     -17.212273662947
             les_mean =     296.545951149250
             stat err =       0.000415326862
             autocorr =       1.216534041654
   target nu stat err =       0.000415326862
   target dn stat err =       0.004408101752
      target stat err =       0.007421533664
              std dev =       0.532528537132
             le_variance =       0.283586642860


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.938790838265        initial  <--
     1.5259e+06     1.5259e+07             3.7969e-10        -0.938790838256
     6.1035e+06     6.1035e+07             9.4922e-11        -0.938790838260
     2.4414e+07     2.4414e+08             2.3730e-11        -0.938790838264

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.7548
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654508e-02 1 1  ON 46
eH2_7                 1.129439e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4443e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2551
    reference variance = 0.174175
====================================================
  Execution time = 2.0324e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8843e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6117e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288386612418
                                         uncertainty =       0.004375033187

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288386612418
                                         uncertainty =       0.004375033187

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379755142
  error estimate for blocks of size 2^( 2) =       0.000393130521
  error estimate for blocks of size 2^( 3) =       0.000405522756
  error estimate for blocks of size 2^( 4) =       0.000414736848
  error estimate for blocks of size 2^( 5) =       0.000419160570
  error estimate for blocks of size 2^( 6) =       0.000422691764
  error estimate for blocks of size 2^( 7) =       0.000421392263

      target function =      -0.930784894211
              le_mean =     -17.211401033499
             les_mean =     296.520753327968
             stat err =       0.000419495361
             autocorr =       1.220244893673
   target nu stat err =       0.000419495361
   target dn stat err =       0.004315190266
      target stat err =       0.007132813017
              std dev =       0.537054872649
             le_variance =       0.288427936236


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721140103350e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930837850026       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930837850028       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930837850029       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930837852336       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930837850030       residual = 5.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930837850030       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930837830630       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930837848557       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930837870793       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930837841398       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930837815782       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930837866524       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930837860251       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930837858141       residual = 9.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930837858890       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930837811498       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930837831321       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.930837860223       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.930837829106       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.930837840937       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.930837851893       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.930837830266       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.930837829576       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.930837841512       residual = 7.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 4.005154e-11

solving harmonic davidson linear method for identity shift 6.1035e+07, overlap shift 6.1035e+08 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930837850026       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930837850026       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930837850026       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930837850026       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930837850027       residual = 5.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930837902147       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930837899207       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930837768434       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930837774519       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930837818474       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930837847578       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930837797172       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930837821470       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930838003404       residual = 9.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930837908729       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930837902459       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930837701198       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.930837875788       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.930837744418       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.930837696555       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.930837858582       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.930837705249       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.930838009375       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.930838118679       residual = 7.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+07 is 1.001304e-11

solving harmonic davidson linear method for identity shift 2.4414e+08, overlap shift 2.4414e+09 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.930837850026       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.930837850026       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.930837850026       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.930837850026       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.930837859451       residual = 5.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.930837718721       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930837850026       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.930838019676       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930837850026       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.930837403631       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930838213662       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.930838423648       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.930838186523       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.930838484449       residual = 9.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.930837796863       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.930837628527       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.930837368570       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.930837003572       residual = 3.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.930838580451       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.930838511071       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.930837817621       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.930838120535       residual = 6.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.930838897547       residual = 5.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.930838160507       residual = 7.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+08 is 2.502560e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.521031 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5965e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654508e-02 1 1  ON 46
eH2_7                 1.129439e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1372
    reference variance = 0.264648
====================================================
  Execution time = 1.9770e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7828e-01
  Total weights = 2.0000e+06
  Execution time = 2.0340e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278319927085
                                         uncertainty =       0.002633735863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278319927085
                                         uncertainty =       0.002633735863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373016207
  error estimate for blocks of size 2^( 2) =       0.000386756836
  error estimate for blocks of size 2^( 3) =       0.000399040472
  error estimate for blocks of size 2^( 4) =       0.000408161161
  error estimate for blocks of size 2^( 5) =       0.000414641078
  error estimate for blocks of size 2^( 6) =       0.000418137284
  error estimate for blocks of size 2^( 7) =       0.000420849347

      target function =      -0.947800819105
              le_mean =     -17.212349330325
             les_mean =     296.543251511572
             stat err =       0.000415447218
             autocorr =       1.240441552015
   target nu stat err =       0.000415447218
   target dn stat err =       0.002525960105
      target stat err =       0.004377996789
              std dev =       0.527524579109
             le_variance =       0.278282181564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278319927088
                                         uncertainty =       0.002633735863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278319927088
                                         uncertainty =       0.002633735863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373016207
  error estimate for blocks of size 2^( 2) =       0.000386756836
  error estimate for blocks of size 2^( 3) =       0.000399040472
  error estimate for blocks of size 2^( 4) =       0.000408161161
  error estimate for blocks of size 2^( 5) =       0.000414641078
  error estimate for blocks of size 2^( 6) =       0.000418137284
  error estimate for blocks of size 2^( 7) =       0.000420849347

      target function =      -0.947800819100
              le_mean =     -17.212349330325
             les_mean =     296.543251511575
             stat err =       0.000415447218
             autocorr =       1.240441552025
   target nu stat err =       0.000415447218
   target dn stat err =       0.002525960105
      target stat err =       0.004377996789
              std dev =       0.527524579111
             le_variance =       0.278282181566

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278319927086
                                         uncertainty =       0.002633735863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278319927086
                                         uncertainty =       0.002633735863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373016207
  error estimate for blocks of size 2^( 2) =       0.000386756836
  error estimate for blocks of size 2^( 3) =       0.000399040472
  error estimate for blocks of size 2^( 4) =       0.000408161161
  error estimate for blocks of size 2^( 5) =       0.000414641078
  error estimate for blocks of size 2^( 6) =       0.000418137284
  error estimate for blocks of size 2^( 7) =       0.000420849347

      target function =      -0.947800819102
              le_mean =     -17.212349330325
             les_mean =     296.543251511573
             stat err =       0.000415447218
             autocorr =       1.240441552015
   target nu stat err =       0.000415447218
   target dn stat err =       0.002525960105
      target stat err =       0.004377996789
              std dev =       0.527524579110
             le_variance =       0.278282181565

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278319927085
                                         uncertainty =       0.002633735863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278319927085
                                         uncertainty =       0.002633735863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373016207
  error estimate for blocks of size 2^( 2) =       0.000386756836
  error estimate for blocks of size 2^( 3) =       0.000399040472
  error estimate for blocks of size 2^( 4) =       0.000408161161
  error estimate for blocks of size 2^( 5) =       0.000414641078
  error estimate for blocks of size 2^( 6) =       0.000418137284
  error estimate for blocks of size 2^( 7) =       0.000420849347

      target function =      -0.947800819104
              le_mean =     -17.212349330325
             les_mean =     296.543251511572
             stat err =       0.000415447218
             autocorr =       1.240441552004
   target nu stat err =       0.000415447218
   target dn stat err =       0.002525960105
      target stat err =       0.004377996789
              std dev =       0.527524579109
             le_variance =       0.278282181564


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947800819105        initial  <--
     1.5259e+07     1.5259e+08             4.0052e-11        -0.947800819100
     6.1035e+07     6.1035e+08             1.0013e-11        -0.947800819102
     2.4414e+08     2.4414e+09             2.5026e-12        -0.947800819104

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.8173
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654508e-02 1 1  ON 46
eH2_7                 1.129439e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6789e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2086
    reference variance = 0.288727
====================================================
  Execution time = 2.0240e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9586e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4772e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295839462313
                                         uncertainty =       0.009224788524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295839462313
                                         uncertainty =       0.009224788524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384617129
  error estimate for blocks of size 2^( 2) =       0.000397829108
  error estimate for blocks of size 2^( 3) =       0.000409692172
  error estimate for blocks of size 2^( 4) =       0.000418665034
  error estimate for blocks of size 2^( 5) =       0.000423827022
  error estimate for blocks of size 2^( 6) =       0.000426853187
  error estimate for blocks of size 2^( 7) =       0.000427784356

      target function =      -0.918491295026
              le_mean =     -17.211874424864
             les_mean =     296.544481740819
             stat err =       0.000424282400
             autocorr =       1.216894112429
   target nu stat err =       0.000424282400
   target dn stat err =       0.009581835613
      target stat err =       0.015374355323
              std dev =       0.543930759814
             le_variance =       0.295860671471


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721187442486e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+08, overlap shift 1.5259e+09 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918749540680       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918749540680       residual = 6.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918749540681       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918749540681       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918749571780       residual = 7.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918749596608       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918749684245       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918749628409       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918749059615       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918749454561       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918749128674       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918749470215       residual = 4.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918749504151       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918749407809       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918749724268       residual = 9.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918749172619       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918749968415       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918750181697       residual = 3.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918748906677       residual = 1.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918749501559       residual = 5.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918749209338       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918749560807       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918749437992       residual = 6.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918749400253       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918748288242       residual = 6.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+08 is 5.858446e-12

solving harmonic davidson linear method for identity shift 6.1035e+08, overlap shift 6.1035e+09 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918749540680       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918749540680       residual = 6.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918749540680       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918749540679       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918749270851       residual = 7.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918749656282       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918748697848       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918748040293       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918748923415       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918750895145       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918748787376       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918748733879       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918749522427       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918748916215       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918748422494       residual = 9.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918751251073       residual = 6.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918749020290       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918748971355       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918751181612       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918749713283       residual = 5.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918749631747       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918747240681       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918751527628       residual = 6.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918749432314       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918749956671       residual = 6.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+08 is 1.464694e-12

solving harmonic davidson linear method for identity shift 2.4414e+09, overlap shift 2.4414e+10 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918749540680       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918749540680       residual = 6.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918749540680       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918749540679       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918750750057       residual = 7.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918747312477       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918750065546       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918748609732       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918742550819       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918747524256       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918749244867       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918745981703       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.918749457568       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.918743892740       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.918749212366       residual = 9.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.918749431938       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.918743492806       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.918755232383       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918749898047       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.918748473287       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.918755145732       residual = 6.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.918748972536       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.918744654978       residual = 7.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.918763679295       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.918744398138       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.918740683028       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.918748617678       residual = 5.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         26 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+09 is 3.671693e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.542286 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5750e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654508e-02 1 1  ON 46
eH2_7                 1.129439e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.3103
    reference variance = 0.328975
====================================================
  Execution time = 1.9678e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8527e-01
  Total weights = 2.0000e+06
  Execution time = 1.8065e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285207678835
                                         uncertainty =       0.003674179723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285207678835
                                         uncertainty =       0.003674179723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377670083
  error estimate for blocks of size 2^( 2) =       0.000391270741
  error estimate for blocks of size 2^( 3) =       0.000403601405
  error estimate for blocks of size 2^( 4) =       0.000412572381
  error estimate for blocks of size 2^( 5) =       0.000418647859
  error estimate for blocks of size 2^( 6) =       0.000420837931
  error estimate for blocks of size 2^( 7) =       0.000421265136

      target function =      -0.936011309207
              le_mean =     -17.211937660884
             les_mean =     296.536067282971
             stat err =       0.000418330826
             autocorr =       1.226915263176
   target nu stat err =       0.000418330826
   target dn stat err =       0.003492276828
      target stat err =       0.005859209377
              std dev =       0.534106153727
             le_variance =       0.285269383449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285207678835
                                         uncertainty =       0.003674179723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285207678835
                                         uncertainty =       0.003674179723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377670083
  error estimate for blocks of size 2^( 2) =       0.000391270741
  error estimate for blocks of size 2^( 3) =       0.000403601405
  error estimate for blocks of size 2^( 4) =       0.000412572381
  error estimate for blocks of size 2^( 5) =       0.000418647859
  error estimate for blocks of size 2^( 6) =       0.000420837931
  error estimate for blocks of size 2^( 7) =       0.000421265136

      target function =      -0.936011309208
              le_mean =     -17.211937660884
             les_mean =     296.536067282971
             stat err =       0.000418330826
             autocorr =       1.226915263190
   target nu stat err =       0.000418330826
   target dn stat err =       0.003492276828
      target stat err =       0.005859209377
              std dev =       0.534106153726
             le_variance =       0.285269383449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285207678835
                                         uncertainty =       0.003674179723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285207678835
                                         uncertainty =       0.003674179723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377670083
  error estimate for blocks of size 2^( 2) =       0.000391270741
  error estimate for blocks of size 2^( 3) =       0.000403601405
  error estimate for blocks of size 2^( 4) =       0.000412572381
  error estimate for blocks of size 2^( 5) =       0.000418647859
  error estimate for blocks of size 2^( 6) =       0.000420837931
  error estimate for blocks of size 2^( 7) =       0.000421265136

      target function =      -0.936011309208
              le_mean =     -17.211937660884
             les_mean =     296.536067282971
             stat err =       0.000418330826
             autocorr =       1.226915263183
   target nu stat err =       0.000418330826
   target dn stat err =       0.003492276828
      target stat err =       0.005859209377
              std dev =       0.534106153727
             le_variance =       0.285269383449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285207678835
                                         uncertainty =       0.003674179723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285207678835
                                         uncertainty =       0.003674179723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377670083
  error estimate for blocks of size 2^( 2) =       0.000391270741
  error estimate for blocks of size 2^( 3) =       0.000403601405
  error estimate for blocks of size 2^( 4) =       0.000412572381
  error estimate for blocks of size 2^( 5) =       0.000418647859
  error estimate for blocks of size 2^( 6) =       0.000420837931
  error estimate for blocks of size 2^( 7) =       0.000421265136

      target function =      -0.936011309207
              le_mean =     -17.211937660884
             les_mean =     296.536067282971
             stat err =       0.000418330826
             autocorr =       1.226915263176
   target nu stat err =       0.000418330826
   target dn stat err =       0.003492276828
      target stat err =       0.005859209377
              std dev =       0.534106153727
             le_variance =       0.285269383449


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.936011309207        initial
     1.5259e+08     1.5259e+09             5.8584e-12        -0.936011309208  <--
     6.1035e+08     6.1035e+09             1.4647e-12        -0.936011309208
     2.4414e+09     2.4414e+10             3.6717e-13        -0.936011309207

*****************************************************************************
Applying the update for shift_i =   1.5259e+08     and shift_s =   1.5259e+09
*****************************************************************************

  Execution time = 2.8818e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654508e-02 1 1  ON 46
eH2_7                 1.129439e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4574e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2195
    reference variance = 0.244831
====================================================
  Execution time = 2.0053e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8668e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5362e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286764930095
                                         uncertainty =       0.003699252902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286764930095
                                         uncertainty =       0.003699252902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378600254
  error estimate for blocks of size 2^( 2) =       0.000391923477
  error estimate for blocks of size 2^( 3) =       0.000404274275
  error estimate for blocks of size 2^( 4) =       0.000412937922
  error estimate for blocks of size 2^( 5) =       0.000419220792
  error estimate for blocks of size 2^( 6) =       0.000423130045
  error estimate for blocks of size 2^( 7) =       0.000424123938

      target function =      -0.933686244847
              le_mean =     -17.211331460274
             les_mean =     296.516606796291
             stat err =       0.000419853174
             autocorr =       1.229796013595
   target nu stat err =       0.000419853174
   target dn stat err =       0.003838378176
      target stat err =       0.006392249031
              std dev =       0.535421613501
             le_variance =       0.286676304204


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721133146027e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933728599689       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933728599690       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933728599690       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933728577781       residual = 6.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933728599713       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933728619475       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933728585600       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933728580704       residual = 9.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933728576360       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933728566000       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933728479054       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933728577789       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933728604760       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933728594468       residual = 4.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933728560357       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933728521413       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933728665397       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933728644741       residual = 8.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.933728632393       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933728488644       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.933728373466       residual = 2.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.933728537322       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.933728823071       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.933728200774       residual = 8.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+07 is 1.916773e-11

solving harmonic davidson linear method for identity shift 1.5259e+08, overlap shift 1.5259e+09 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933728599689       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933728599689       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933728599689       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933728599689       residual = 6.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933728599689       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933728599689       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933728813625       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933728599690       residual = 9.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933728598404       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933729048677       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933728814492       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933728584576       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933728066182       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933728630772       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933728965318       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933728548914       residual = 4.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933728844351       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933728558381       residual = 8.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.933728941777       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933728393068       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.933729016687       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.933729041609       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.933728576445       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.933728539659       residual = 8.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+08 is 4.791415e-12

solving harmonic davidson linear method for identity shift 6.1035e+08, overlap shift 6.1035e+09 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933728599689       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933728599689       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933728599689       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933728599689       residual = 6.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933728599689       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933728412826       residual = 2.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933729102577       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933728599689       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933728599689       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933728518452       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933728460519       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933728299830       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933727198647       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933728235866       residual = 4.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933726795250       residual = 4.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933729973862       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933725611785       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933728694078       residual = 8.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.933728533795       residual = 4.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933727536540       residual = 2.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.933727976837       residual = 2.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.933731287242       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.933729344646       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.933730598129       residual = 8.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+08 is 1.197718e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.560407 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5619e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654508e-02 1 1  ON 46
eH2_7                 1.129439e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2301
    reference variance = 0.159665
====================================================
  Execution time = 1.9675e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7688e-01
  Total weights = 2.0000e+06
  Execution time = 1.8047e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276771317663
                                         uncertainty =       0.002377818710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276771317663
                                         uncertainty =       0.002377818710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372074121
  error estimate for blocks of size 2^( 2) =       0.000386103970
  error estimate for blocks of size 2^( 3) =       0.000398571069
  error estimate for blocks of size 2^( 4) =       0.000408178128
  error estimate for blocks of size 2^( 5) =       0.000413365132
  error estimate for blocks of size 2^( 6) =       0.000416534070
  error estimate for blocks of size 2^( 7) =       0.000416530982

      target function =      -0.950206081941
              le_mean =     -17.211928855696
             les_mean =     296.527373097947
             stat err =       0.000413652078
             autocorr =       1.235980138699
   target nu stat err =       0.000413652078
   target dn stat err =       0.002368264480
      target stat err =       0.004129584721
              std dev =       0.526192267958
             le_variance =       0.276878302858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276771317663
                                         uncertainty =       0.002377818710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276771317663
                                         uncertainty =       0.002377818710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372074121
  error estimate for blocks of size 2^( 2) =       0.000386103970
  error estimate for blocks of size 2^( 3) =       0.000398571069
  error estimate for blocks of size 2^( 4) =       0.000408178128
  error estimate for blocks of size 2^( 5) =       0.000413365132
  error estimate for blocks of size 2^( 6) =       0.000416534070
  error estimate for blocks of size 2^( 7) =       0.000416530982

      target function =      -0.950206081942
              le_mean =     -17.211928855696
             les_mean =     296.527373097948
             stat err =       0.000413652078
             autocorr =       1.235980138716
   target nu stat err =       0.000413652078
   target dn stat err =       0.002368264480
      target stat err =       0.004129584721
              std dev =       0.526192267957
             le_variance =       0.276878302858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276771317663
                                         uncertainty =       0.002377818710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276771317663
                                         uncertainty =       0.002377818710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372074121
  error estimate for blocks of size 2^( 2) =       0.000386103970
  error estimate for blocks of size 2^( 3) =       0.000398571069
  error estimate for blocks of size 2^( 4) =       0.000408178128
  error estimate for blocks of size 2^( 5) =       0.000413365132
  error estimate for blocks of size 2^( 6) =       0.000416534070
  error estimate for blocks of size 2^( 7) =       0.000416530982

      target function =      -0.950206081942
              le_mean =     -17.211928855696
             les_mean =     296.527373097948
             stat err =       0.000413652078
             autocorr =       1.235980138712
   target nu stat err =       0.000413652078
   target dn stat err =       0.002368264480
      target stat err =       0.004129584721
              std dev =       0.526192267957
             le_variance =       0.276878302858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276771317663
                                         uncertainty =       0.002377818710

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276771317663
                                         uncertainty =       0.002377818710

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372074121
  error estimate for blocks of size 2^( 2) =       0.000386103970
  error estimate for blocks of size 2^( 3) =       0.000398571069
  error estimate for blocks of size 2^( 4) =       0.000408178128
  error estimate for blocks of size 2^( 5) =       0.000413365132
  error estimate for blocks of size 2^( 6) =       0.000416534070
  error estimate for blocks of size 2^( 7) =       0.000416530982

      target function =      -0.950206081941
              le_mean =     -17.211928855696
             les_mean =     296.527373097947
             stat err =       0.000413652078
             autocorr =       1.235980138711
   target nu stat err =       0.000413652078
   target dn stat err =       0.002368264480
      target stat err =       0.004129584721
              std dev =       0.526192267958
             le_variance =       0.276878302858


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.950206081941        initial
     3.8147e+07     3.8147e+08             1.9168e-11        -0.950206081942  <--
     1.5259e+08     1.5259e+09             4.7914e-12        -0.950206081942
     6.1035e+08     6.1035e+09             1.1977e-12        -0.950206081941

*****************************************************************************
Applying the update for shift_i =   3.8147e+07     and shift_s =   3.8147e+08
*****************************************************************************

  Execution time = 2.8819e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654508e-02 1 1  ON 46
eH2_7                 1.129439e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4445e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2068
    reference variance = 0.244335
====================================================
  Execution time = 2.0404e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8306e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4854e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283049190514
                                         uncertainty =       0.002928222484

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283049190514
                                         uncertainty =       0.002928222484

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376206204
  error estimate for blocks of size 2^( 2) =       0.000390097589
  error estimate for blocks of size 2^( 3) =       0.000402729462
  error estimate for blocks of size 2^( 4) =       0.000412091926
  error estimate for blocks of size 2^( 5) =       0.000417037736
  error estimate for blocks of size 2^( 6) =       0.000419991815
  error estimate for blocks of size 2^( 7) =       0.000422968185

      target function =      -0.939695118890
              le_mean =     -17.212590597858
             les_mean =     296.556337164070
             stat err =       0.000418022415
             autocorr =       1.234659589094
   target nu stat err =       0.000418022415
   target dn stat err =       0.002976471371
      target stat err =       0.005054147440
              std dev =       0.532035916215
             le_variance =       0.283062216143


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721259059786e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939721511021       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939721511024       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939721511024       residual = 7.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939721511025       residual = 7.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939721508874       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939721522802       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939721494013       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939721508116       residual = 5.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939721487088       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939721504384       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939721535107       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939721515277       residual = 9.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939721513257       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939721538622       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939721504766       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939721523132       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939721510058       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939721505370       residual = 7.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939721526101       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939721497139       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939721480722       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939721524291       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939721538026       residual = 2.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939721477871       residual = 7.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 4.966372e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939721511021       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939721511022       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939721511022       residual = 7.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939721511021       residual = 7.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939721509534       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939721534648       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939721499739       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939721619670       residual = 5.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939721492350       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939721446832       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939721518494       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939721408053       residual = 9.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939721475869       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939721491350       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939721390020       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939721505635       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939721315808       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939721308290       residual = 7.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939721645057       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939721683757       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939721421226       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939721170025       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939721569472       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939721455725       residual = 7.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+07 is 1.241674e-11

solving harmonic davidson linear method for identity shift 1.5259e+08, overlap shift 1.5259e+09 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939721511021       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939721511021       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939721511021       residual = 7.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939721511021       residual = 7.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939721511021       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939721572426       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939721546164       residual = 2.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939721218695       residual = 5.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939721556137       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939721514746       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.939721698630       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.939721465888       residual = 9.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.939721409979       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.939721541304       residual = 4.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.939721726932       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939721339149       residual = 1.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.939721950292       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.939721561777       residual = 7.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.939722041657       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.939721889347       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.939721279772       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939720720064       residual = 8.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939721884588       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.939721812321       residual = 7.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+08 is 3.103507e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.578912 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5919e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654508e-02 1 1  ON 46
eH2_7                 1.129439e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1425
    reference variance = 0.304311
====================================================
  Execution time = 1.9518e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7793e-01
  Total weights = 2.0000e+06
  Execution time = 1.8116e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278016818367
                                         uncertainty =       0.003074307263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278016818367
                                         uncertainty =       0.003074307263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372783236
  error estimate for blocks of size 2^( 2) =       0.000386364420
  error estimate for blocks of size 2^( 3) =       0.000398546134
  error estimate for blocks of size 2^( 4) =       0.000407889699
  error estimate for blocks of size 2^( 5) =       0.000413226120
  error estimate for blocks of size 2^( 6) =       0.000415700850
  error estimate for blocks of size 2^( 7) =       0.000417612273

      target function =      -0.948387534242
              le_mean =     -17.211772385721
             les_mean =     296.523043201437
             stat err =       0.000413607236
             autocorr =       1.231015458661
   target nu stat err =       0.000413607236
   target dn stat err =       0.003013271724
      target stat err =       0.005200104655
              std dev =       0.527195108605
             le_variance =       0.277934682537

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278016818363
                                         uncertainty =       0.003074307263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278016818363
                                         uncertainty =       0.003074307263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372783236
  error estimate for blocks of size 2^( 2) =       0.000386364420
  error estimate for blocks of size 2^( 3) =       0.000398546134
  error estimate for blocks of size 2^( 4) =       0.000407889699
  error estimate for blocks of size 2^( 5) =       0.000413226120
  error estimate for blocks of size 2^( 6) =       0.000415700850
  error estimate for blocks of size 2^( 7) =       0.000417612273

      target function =      -0.948387534248
              le_mean =     -17.211772385721
             les_mean =     296.523043201433
             stat err =       0.000413607236
             autocorr =       1.231015458696
   target nu stat err =       0.000413607236
   target dn stat err =       0.003013271724
      target stat err =       0.005200104655
              std dev =       0.527195108602
             le_variance =       0.277934682534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278016818365
                                         uncertainty =       0.003074307263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278016818365
                                         uncertainty =       0.003074307263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372783236
  error estimate for blocks of size 2^( 2) =       0.000386364420
  error estimate for blocks of size 2^( 3) =       0.000398546134
  error estimate for blocks of size 2^( 4) =       0.000407889699
  error estimate for blocks of size 2^( 5) =       0.000413226120
  error estimate for blocks of size 2^( 6) =       0.000415700850
  error estimate for blocks of size 2^( 7) =       0.000417612273

      target function =      -0.948387534245
              le_mean =     -17.211772385721
             les_mean =     296.523043201435
             stat err =       0.000413607236
             autocorr =       1.231015458678
   target nu stat err =       0.000413607236
   target dn stat err =       0.003013271724
      target stat err =       0.005200104655
              std dev =       0.527195108604
             le_variance =       0.277934682536

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278016818367
                                         uncertainty =       0.003074307263

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278016818367
                                         uncertainty =       0.003074307263

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372783236
  error estimate for blocks of size 2^( 2) =       0.000386364420
  error estimate for blocks of size 2^( 3) =       0.000398546134
  error estimate for blocks of size 2^( 4) =       0.000407889699
  error estimate for blocks of size 2^( 5) =       0.000413226120
  error estimate for blocks of size 2^( 6) =       0.000415700850
  error estimate for blocks of size 2^( 7) =       0.000417612273

      target function =      -0.948387534242
              le_mean =     -17.211772385721
             les_mean =     296.523043201437
             stat err =       0.000413607236
             autocorr =       1.231015458669
   target nu stat err =       0.000413607236
   target dn stat err =       0.003013271724
      target stat err =       0.005200104655
              std dev =       0.527195108605
             le_variance =       0.277934682537


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948387534242        initial
     9.5367e+06     9.5367e+07             4.9664e-11        -0.948387534248  <--
     3.8147e+07     3.8147e+08             1.2417e-11        -0.948387534245
     1.5259e+08     1.5259e+09             3.1035e-12        -0.948387534242

*****************************************************************************
Applying the update for shift_i =   9.5367e+06     and shift_s =   9.5367e+07
*****************************************************************************

  Execution time = 3.2443e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654508e-02 1 1  ON 46
eH2_7                 1.129439e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8370e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2544
    reference variance = 0.209202
====================================================
  Execution time = 2.0217e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7707e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4704e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277123449750
                                         uncertainty =       0.002068824701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277123449750
                                         uncertainty =       0.002068824701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372205574
  error estimate for blocks of size 2^( 2) =       0.000385907973
  error estimate for blocks of size 2^( 3) =       0.000398480166
  error estimate for blocks of size 2^( 4) =       0.000408002396
  error estimate for blocks of size 2^( 5) =       0.000413528849
  error estimate for blocks of size 2^( 6) =       0.000418240755
  error estimate for blocks of size 2^( 7) =       0.000420004053

      target function =      -0.949873933641
              le_mean =     -17.212731405637
             les_mean =     296.555196283285
             stat err =       0.000414944013
             autocorr =       1.242834382784
   target nu stat err =       0.000414944013
   target dn stat err =       0.002086113144
      target stat err =       0.003658256538
              std dev =       0.526378171313
             le_variance =       0.277073979235


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721273140564e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949886812098       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949886812109       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949886812113       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949886811816       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949886814024       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949886808748       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949886803114       residual = 4.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949886805897       residual = 7.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949886812984       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949886806253       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.949886812305       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.949886808231       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.949886814475       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.949886812122       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.949886817887       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.949886812524       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.949886814781       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.949886809228       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.949886814721       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.949886804789       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.949886800590       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.949886798998       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.949886836726       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.949886807079       residual = 6.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 2.602132e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949886812098       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949886812101       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949886812102       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949886815523       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949886812103       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949886779633       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949886814616       residual = 4.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949886817531       residual = 7.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949886787758       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949886807128       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.949886797280       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.949886767771       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.949886798353       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.949886810206       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.949886799014       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.949886806440       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.949886785956       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.949886815529       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.949886787454       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.949886830458       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.949886832003       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.949886834118       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.949886810750       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.949886829588       residual = 6.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 6.505407e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949886812098       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949886812099       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949886812099       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949886812099       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949886812100       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949886797378       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949886768670       residual = 4.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949886751111       residual = 7.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949886831330       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949886780765       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.949886765099       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.949886785742       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.949886910737       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.949886964421       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.949886695909       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.949886812653       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.949886656183       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.949886938145       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.949886673421       residual = 5.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.949886866781       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.949886859620       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.949886965878       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.949886891718       residual = 3.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.949886812131       residual = 6.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+07 is 1.626524e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.597269 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5717e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654508e-02 1 1  ON 46
eH2_7                 1.129439e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1893
    reference variance = 0.18781
====================================================
  Execution time = 2.0121e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8734e-01
  Total weights = 2.0000e+06
  Execution time = 1.8312e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287376831401
                                         uncertainty =       0.008848081165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287376831401
                                         uncertainty =       0.008848081165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379037316
  error estimate for blocks of size 2^( 2) =       0.000392163220
  error estimate for blocks of size 2^( 3) =       0.000404415904
  error estimate for blocks of size 2^( 4) =       0.000413246391
  error estimate for blocks of size 2^( 5) =       0.000418854184
  error estimate for blocks of size 2^( 6) =       0.000421736697
  error estimate for blocks of size 2^( 7) =       0.000423550635

      target function =      -0.932426364315
              le_mean =     -17.210945281193
             les_mean =     296.503975903004
             stat err =       0.000419346977
             autocorr =       1.224004728456
   target nu stat err =       0.000419346977
   target dn stat err =       0.008725451648
      target stat err =       0.014404610232
              std dev =       0.536039713493
             le_variance =       0.287338574441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287376831399
                                         uncertainty =       0.008848081164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287376831399
                                         uncertainty =       0.008848081164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379037316
  error estimate for blocks of size 2^( 2) =       0.000392163220
  error estimate for blocks of size 2^( 3) =       0.000404415904
  error estimate for blocks of size 2^( 4) =       0.000413246391
  error estimate for blocks of size 2^( 5) =       0.000418854184
  error estimate for blocks of size 2^( 6) =       0.000421736697
  error estimate for blocks of size 2^( 7) =       0.000423550635

      target function =      -0.932426364318
              le_mean =     -17.210945281194
             les_mean =     296.503975903008
             stat err =       0.000419346977
             autocorr =       1.224004728557
   target nu stat err =       0.000419346977
   target dn stat err =       0.008725451648
      target stat err =       0.014404610232
              std dev =       0.536039713491
             le_variance =       0.287338574440

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287376831400
                                         uncertainty =       0.008848081164

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287376831400
                                         uncertainty =       0.008848081164

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379037316
  error estimate for blocks of size 2^( 2) =       0.000392163220
  error estimate for blocks of size 2^( 3) =       0.000404415904
  error estimate for blocks of size 2^( 4) =       0.000413246391
  error estimate for blocks of size 2^( 5) =       0.000418854184
  error estimate for blocks of size 2^( 6) =       0.000421736697
  error estimate for blocks of size 2^( 7) =       0.000423550635

      target function =      -0.932426364317
              le_mean =     -17.210945281193
             les_mean =     296.503975903006
             stat err =       0.000419346977
             autocorr =       1.224004728497
   target nu stat err =       0.000419346977
   target dn stat err =       0.008725451648
      target stat err =       0.014404610232
              std dev =       0.536039713492
             le_variance =       0.287338574441

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287376831401
                                         uncertainty =       0.008848081165

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287376831401
                                         uncertainty =       0.008848081165

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379037316
  error estimate for blocks of size 2^( 2) =       0.000392163220
  error estimate for blocks of size 2^( 3) =       0.000404415904
  error estimate for blocks of size 2^( 4) =       0.000413246391
  error estimate for blocks of size 2^( 5) =       0.000418854184
  error estimate for blocks of size 2^( 6) =       0.000421736697
  error estimate for blocks of size 2^( 7) =       0.000423550635

      target function =      -0.932426364316
              le_mean =     -17.210945281193
             les_mean =     296.503975903004
             stat err =       0.000419346977
             autocorr =       1.224004728463
   target nu stat err =       0.000419346977
   target dn stat err =       0.008725451648
      target stat err =       0.014404610232
              std dev =       0.536039713493
             le_variance =       0.287338574441


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.932426364315        initial
     2.3842e+06     2.3842e+07             2.6021e-10        -0.932426364318  <--
     9.5367e+06     9.5367e+07             6.5054e-11        -0.932426364317
     3.8147e+07     3.8147e+08             1.6265e-11        -0.932426364316

*****************************************************************************
Applying the update for shift_i =   2.3842e+06     and shift_s =   2.3842e+07
*****************************************************************************

  Execution time = 2.9364e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129439e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5087e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2367
    reference variance = 0.232881
====================================================
  Execution time = 2.0790e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7747e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4654e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277566986727
                                         uncertainty =       0.002314530739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277566986727
                                         uncertainty =       0.002314530739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372471494
  error estimate for blocks of size 2^( 2) =       0.000385993462
  error estimate for blocks of size 2^( 3) =       0.000397791519
  error estimate for blocks of size 2^( 4) =       0.000406294553
  error estimate for blocks of size 2^( 5) =       0.000412707387
  error estimate for blocks of size 2^( 6) =       0.000415543911
  error estimate for blocks of size 2^( 7) =       0.000415762234

      target function =      -0.949194246896
              le_mean =     -17.210808811765
             les_mean =     296.489409843947
             stat err =       0.000412577021
             autocorr =       1.226941879404
   target nu stat err =       0.000412577021
   target dn stat err =       0.002168301025
      target stat err =       0.003776463831
              std dev =       0.526754238293
             le_variance =       0.277470027560


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721080881176e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949208270279       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949208270329       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949208270340       residual = 8.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949208270351       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949208270484       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949208271375       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949208269191       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949208268715       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949208269778       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949208270371       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.949208270603       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.949208269834       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.949208270883       residual = 8.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.949208270201       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.949208269601       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.949208270649       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.949208270072       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.949208270387       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.949208271987       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.949208268673       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.949208270480       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.949208271900       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.949208270218       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.949208270206       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 1.013782e-09

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949208270279       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949208270291       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949208270294       residual = 8.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949208270297       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949208270299       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949208271220       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949208267740       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949208270643       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949208270302       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949208272871       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.949208268706       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.949208272813       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.949208272222       residual = 8.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.949208265802       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.949208274762       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.949208269404       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.949208270845       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.949208271239       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.949208275436       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.949208273152       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.949208272409       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.949208274346       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.949208266883       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.949208268942       residual = 6.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 2.534458e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949208270279       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949208270282       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949208270283       residual = 8.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949208268682       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949208270284       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949208270284       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949208268232       residual = 3.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949208261461       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949208256456       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949208278178       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.949208259090       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.949208248570       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.949208250510       residual = 8.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.949208265413       residual = 5.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.949208245279       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.949208280244       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.949208263452       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.949208257552       residual = 5.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.949208227420       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.949208266234       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.949208277356       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.949208261353       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.949208270678       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.949208301781       residual = 6.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 6.336075e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.615345 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6285e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2121
    reference variance = 0.203756
====================================================
  Execution time = 2.0113e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8131e-01
  Total weights = 2.0000e+06
  Execution time = 1.8354e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281368708053
                                         uncertainty =       0.003975729559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281368708053
                                         uncertainty =       0.003975729559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375039044
  error estimate for blocks of size 2^( 2) =       0.000388643819
  error estimate for blocks of size 2^( 3) =       0.000401150419
  error estimate for blocks of size 2^( 4) =       0.000410436120
  error estimate for blocks of size 2^( 5) =       0.000416901561
  error estimate for blocks of size 2^( 6) =       0.000420554946
  error estimate for blocks of size 2^( 7) =       0.000420582722

      target function =      -0.942626719602
              le_mean =     -17.212731698283
             les_mean =     296.559440946196
             stat err =       0.000417118838
             autocorr =       1.236991285727
   target nu stat err =       0.000417118838
   target dn stat err =       0.003983914599
      target stat err =       0.006775687599
              std dev =       0.530385303143
             le_variance =       0.281308569790

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281368708080
                                         uncertainty =       0.003975729554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281368708080
                                         uncertainty =       0.003975729554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375039045
  error estimate for blocks of size 2^( 2) =       0.000388643819
  error estimate for blocks of size 2^( 3) =       0.000401150419
  error estimate for blocks of size 2^( 4) =       0.000410436120
  error estimate for blocks of size 2^( 5) =       0.000416901561
  error estimate for blocks of size 2^( 6) =       0.000420554946
  error estimate for blocks of size 2^( 7) =       0.000420582723

      target function =      -0.942626719557
              le_mean =     -17.212731698282
             les_mean =     296.559440946195
             stat err =       0.000417118838
             autocorr =       1.236991285825
   target nu stat err =       0.000417118838
   target dn stat err =       0.003983914594
      target stat err =       0.006775687589
              std dev =       0.530385303169
             le_variance =       0.281308569817

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281368708066
                                         uncertainty =       0.003975729556

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281368708066
                                         uncertainty =       0.003975729556

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375039045
  error estimate for blocks of size 2^( 2) =       0.000388643819
  error estimate for blocks of size 2^( 3) =       0.000401150419
  error estimate for blocks of size 2^( 4) =       0.000410436120
  error estimate for blocks of size 2^( 5) =       0.000416901561
  error estimate for blocks of size 2^( 6) =       0.000420554946
  error estimate for blocks of size 2^( 7) =       0.000420582722

      target function =      -0.942626719580
              le_mean =     -17.212731698282
             les_mean =     296.559440946195
             stat err =       0.000417118838
             autocorr =       1.236991285773
   target nu stat err =       0.000417118838
   target dn stat err =       0.003983914597
      target stat err =       0.006775687594
              std dev =       0.530385303156
             le_variance =       0.281308569804

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281368708055
                                         uncertainty =       0.003975729559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281368708055
                                         uncertainty =       0.003975729559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375039044
  error estimate for blocks of size 2^( 2) =       0.000388643819
  error estimate for blocks of size 2^( 3) =       0.000401150419
  error estimate for blocks of size 2^( 4) =       0.000410436120
  error estimate for blocks of size 2^( 5) =       0.000416901561
  error estimate for blocks of size 2^( 6) =       0.000420554946
  error estimate for blocks of size 2^( 7) =       0.000420582722

      target function =      -0.942626719599
              le_mean =     -17.212731698282
             les_mean =     296.559440946196
             stat err =       0.000417118838
             autocorr =       1.236991285730
   target nu stat err =       0.000417118838
   target dn stat err =       0.003983914599
      target stat err =       0.006775687599
              std dev =       0.530385303145
             le_variance =       0.281308569792


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942626719602        initial  <--
     5.9605e+05     5.9605e+06             1.0138e-09        -0.942626719557
     2.3842e+06     2.3842e+07             2.5345e-10        -0.942626719580
     9.5367e+06     9.5367e+07             6.3361e-11        -0.942626719599

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3699
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129439e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5661e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2403
    reference variance = 0.164675
====================================================
  Execution time = 2.2372e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8043e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4656e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280257472066
                                         uncertainty =       0.002608887686

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280257472066
                                         uncertainty =       0.002608887686

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374454438
  error estimate for blocks of size 2^( 2) =       0.000388020626
  error estimate for blocks of size 2^( 3) =       0.000400469940
  error estimate for blocks of size 2^( 4) =       0.000408914315
  error estimate for blocks of size 2^( 5) =       0.000415165840
  error estimate for blocks of size 2^( 6) =       0.000418057195
  error estimate for blocks of size 2^( 7) =       0.000419681823

      target function =      -0.944153189497
              le_mean =     -17.211732823939
             les_mean =     296.524178914684
             stat err =       0.000415454793
             autocorr =       1.230975993031
   target nu stat err =       0.000415454793
   target dn stat err =       0.002307944885
      target stat err =       0.003976729926
              std dev =       0.529558544664
             le_variance =       0.280432252226


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721173282394e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944168854370       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944168854375       residual = 9.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944168854376       residual = 6.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944168854377       residual = 9.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944168854363       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944168857279       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944168872022       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944168853076       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944168850403       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944168857113       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944168850101       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944168854738       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944168840978       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944168853180       residual = 7.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944168859888       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944168847578       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944168843330       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944168850334       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944168846009       residual = 7.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944168861266       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944168853404       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944168837117       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944168871526       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944168856770       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.944168865714       residual = 4.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 9.500304e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944168854370       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944168854371       residual = 9.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944168854372       residual = 6.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944168854943       residual = 9.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944168856329       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944168843864       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944168851741       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944168866606       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944168834899       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944168803879       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944168763149       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944168890835       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944168848450       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944168871742       residual = 7.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944168895324       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944168994773       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944168776258       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944168684810       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944168883292       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944168842601       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944168814273       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944168719209       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944168877037       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944168902902       residual = 9.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 2.352498e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944168854370       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944168854370       residual = 9.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944168854370       residual = 6.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944168849915       residual = 9.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944168822367       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944168958631       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944168837084       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944168674759       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944169019084       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944168894362       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944168773922       residual = 2.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944168960333       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944168806529       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944169208374       residual = 7.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944169072711       residual = 4.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944168882653       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944169180134       residual = 3.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944168785936       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944168633206       residual = 7.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944168534988       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944168907405       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944169028475       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944168936814       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944168806584       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.944169044100       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 5.937574e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.634594 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7868e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129439e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2141
    reference variance = 0.252489
====================================================
  Execution time = 2.0069e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7957e-01
  Total weights = 2.0000e+06
  Execution time = 1.8398e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279635801097
                                         uncertainty =       0.002304537493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279635801097
                                         uncertainty =       0.002304537493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373875268
  error estimate for blocks of size 2^( 2) =       0.000387145947
  error estimate for blocks of size 2^( 3) =       0.000399423844
  error estimate for blocks of size 2^( 4) =       0.000408609895
  error estimate for blocks of size 2^( 5) =       0.000413441046
  error estimate for blocks of size 2^( 6) =       0.000417242060
  error estimate for blocks of size 2^( 7) =       0.000418657277

      target function =      -0.945623238743
              le_mean =     -17.211634924302
             les_mean =     296.519942059586
             stat err =       0.000414487570
             autocorr =       1.229049987683
   target nu stat err =       0.000414487570
   target dn stat err =       0.002309940762
      target stat err =       0.003991169000
              std dev =       0.528739474535
             le_variance =       0.279565431931

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279635801102
                                         uncertainty =       0.002304537493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279635801102
                                         uncertainty =       0.002304537493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373875268
  error estimate for blocks of size 2^( 2) =       0.000387145947
  error estimate for blocks of size 2^( 3) =       0.000399423844
  error estimate for blocks of size 2^( 4) =       0.000408609895
  error estimate for blocks of size 2^( 5) =       0.000413441046
  error estimate for blocks of size 2^( 6) =       0.000417242060
  error estimate for blocks of size 2^( 7) =       0.000418657277

      target function =      -0.945623238735
              le_mean =     -17.211634924302
             les_mean =     296.519942059589
             stat err =       0.000414487570
             autocorr =       1.229049987704
   target nu stat err =       0.000414487570
   target dn stat err =       0.002309940763
      target stat err =       0.003991169000
              std dev =       0.528739474539
             le_variance =       0.279565431936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279635801100
                                         uncertainty =       0.002304537493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279635801100
                                         uncertainty =       0.002304537493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373875268
  error estimate for blocks of size 2^( 2) =       0.000387145947
  error estimate for blocks of size 2^( 3) =       0.000399423844
  error estimate for blocks of size 2^( 4) =       0.000408609895
  error estimate for blocks of size 2^( 5) =       0.000413441046
  error estimate for blocks of size 2^( 6) =       0.000417242060
  error estimate for blocks of size 2^( 7) =       0.000418657277

      target function =      -0.945623238739
              le_mean =     -17.211634924302
             les_mean =     296.519942059587
             stat err =       0.000414487570
             autocorr =       1.229049987696
   target nu stat err =       0.000414487570
   target dn stat err =       0.002309940762
      target stat err =       0.003991169000
              std dev =       0.528739474537
             le_variance =       0.279565431934

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279635801098
                                         uncertainty =       0.002304537493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279635801098
                                         uncertainty =       0.002304537493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373875268
  error estimate for blocks of size 2^( 2) =       0.000387145947
  error estimate for blocks of size 2^( 3) =       0.000399423844
  error estimate for blocks of size 2^( 4) =       0.000408609895
  error estimate for blocks of size 2^( 5) =       0.000413441046
  error estimate for blocks of size 2^( 6) =       0.000417242060
  error estimate for blocks of size 2^( 7) =       0.000418657277

      target function =      -0.945623238743
              le_mean =     -17.211634924302
             les_mean =     296.519942059586
             stat err =       0.000414487570
             autocorr =       1.229049987687
   target nu stat err =       0.000414487570
   target dn stat err =       0.002309940762
      target stat err =       0.003991169000
              std dev =       0.528739474535
             le_variance =       0.279565431931


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945623238743        initial  <--
     5.9605e+06     5.9605e+07             9.5003e-11        -0.945623238735
     2.3842e+07     2.3842e+08             2.3525e-11        -0.945623238739
     9.5367e+07     9.5367e+08             5.9376e-12        -0.945623238743

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3678
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129439e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7242e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2131
    reference variance = 0.135894
====================================================
  Execution time = 2.0324e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8673e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5024e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286575543712
                                         uncertainty =       0.005228240475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286575543712
                                         uncertainty =       0.005228240475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378632865
  error estimate for blocks of size 2^( 2) =       0.000392422509
  error estimate for blocks of size 2^( 3) =       0.000405192768
  error estimate for blocks of size 2^( 4) =       0.000414328528
  error estimate for blocks of size 2^( 5) =       0.000419230592
  error estimate for blocks of size 2^( 6) =       0.000423452263
  error estimate for blocks of size 2^( 7) =       0.000425582657

      target function =      -0.933553431204
              le_mean =     -17.211879522733
             les_mean =     296.535522255340
             stat err =       0.000420648510
             autocorr =       1.234247036461
   target nu stat err =       0.000420648510
   target dn stat err =       0.005165083065
      target stat err =       0.008582508418
              std dev =       0.535467733518
             le_variance =       0.286725693639


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721187952273e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933631069515       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933631069515       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933631069516       residual = 9.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933631069516       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933631069024       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933631069516       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933631074048       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933630984823       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933630944147       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933631113126       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933631037415       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933631060233       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933630944996       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933631076426       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933631129166       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933630906349       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933631182659       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933630840367       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.933631278945       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933631086085       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.933630869956       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.933630836051       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.933631354643       residual = 3.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.933631089497       residual = 8.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+07 is 1.050869e-11

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933631069515       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933631069515       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933631069515       residual = 9.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933631069515       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933631064987       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933631071760       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933631262288       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933630675474       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933630745994       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933631091427       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933630919410       residual = 4.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933631916312       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933630950439       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933631292161       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933630371944       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933631251855       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933631529973       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933630423525       residual = 7.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.933631655314       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933631181990       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.933630917879       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.933630084970       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.933630726563       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.933630590276       residual = 8.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+08 is 2.627432e-12

solving harmonic davidson linear method for identity shift 9.5367e+08, overlap shift 9.5367e+09 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933631069515       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933631069515       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933631069515       residual = 9.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933631088690       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933631069515       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933630304129       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933632391568       residual = 2.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933632416619       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933631008770       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933631918404       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933631493806       residual = 4.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.933633072418       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.933630650148       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.933630588109       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933631430055       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.933632158549       residual = 3.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.933632519726       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.933628757336       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.933629211495       residual = 3.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933632388709       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.933632341342       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.933632193507       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.933628553795       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.933633842107       residual = 9.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+08 is 6.565159e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.652667 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5855e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129439e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2596
    reference variance = 0.256738
====================================================
  Execution time = 2.0005e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8195e-01
  Total weights = 2.0000e+06
  Execution time = 1.8314e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281969282772
                                         uncertainty =       0.002809146776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281969282772
                                         uncertainty =       0.002809146776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375465335
  error estimate for blocks of size 2^( 2) =       0.000389142681
  error estimate for blocks of size 2^( 3) =       0.000401657787
  error estimate for blocks of size 2^( 4) =       0.000410813567
  error estimate for blocks of size 2^( 5) =       0.000415885078
  error estimate for blocks of size 2^( 6) =       0.000417694673
  error estimate for blocks of size 2^( 7) =       0.000419049346

      target function =      -0.941589804658
              le_mean =     -17.211552476282
             les_mean =     296.519486939067
             stat err =       0.000415860666
             autocorr =       1.226749799276
   target nu stat err =       0.000415860666
   target dn stat err =       0.002728995264
      target stat err =       0.004652188664
              std dev =       0.530988169588
             le_variance =       0.281948436243

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281969282772
                                         uncertainty =       0.002809146776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281969282772
                                         uncertainty =       0.002809146776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375465335
  error estimate for blocks of size 2^( 2) =       0.000389142681
  error estimate for blocks of size 2^( 3) =       0.000401657787
  error estimate for blocks of size 2^( 4) =       0.000410813567
  error estimate for blocks of size 2^( 5) =       0.000415885078
  error estimate for blocks of size 2^( 6) =       0.000417694673
  error estimate for blocks of size 2^( 7) =       0.000419049346

      target function =      -0.941589804658
              le_mean =     -17.211552476282
             les_mean =     296.519486939065
             stat err =       0.000415860666
             autocorr =       1.226749799281
   target nu stat err =       0.000415860666
   target dn stat err =       0.002728995264
      target stat err =       0.004652188664
              std dev =       0.530988169588
             le_variance =       0.281948436242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281969282772
                                         uncertainty =       0.002809146776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281969282772
                                         uncertainty =       0.002809146776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375465335
  error estimate for blocks of size 2^( 2) =       0.000389142681
  error estimate for blocks of size 2^( 3) =       0.000401657787
  error estimate for blocks of size 2^( 4) =       0.000410813567
  error estimate for blocks of size 2^( 5) =       0.000415885078
  error estimate for blocks of size 2^( 6) =       0.000417694673
  error estimate for blocks of size 2^( 7) =       0.000419049346

      target function =      -0.941589804658
              le_mean =     -17.211552476282
             les_mean =     296.519486939066
             stat err =       0.000415860666
             autocorr =       1.226749799289
   target nu stat err =       0.000415860666
   target dn stat err =       0.002728995264
      target stat err =       0.004652188664
              std dev =       0.530988169588
             le_variance =       0.281948436242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281969282772
                                         uncertainty =       0.002809146776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281969282772
                                         uncertainty =       0.002809146776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375465335
  error estimate for blocks of size 2^( 2) =       0.000389142681
  error estimate for blocks of size 2^( 3) =       0.000401657787
  error estimate for blocks of size 2^( 4) =       0.000410813567
  error estimate for blocks of size 2^( 5) =       0.000415885078
  error estimate for blocks of size 2^( 6) =       0.000417694673
  error estimate for blocks of size 2^( 7) =       0.000419049346

      target function =      -0.941589804658
              le_mean =     -17.211552476282
             les_mean =     296.519486939067
             stat err =       0.000415860666
             autocorr =       1.226749799286
   target nu stat err =       0.000415860666
   target dn stat err =       0.002728995264
      target stat err =       0.004652188664
              std dev =       0.530988169588
             le_variance =       0.281948436243


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.941589804658        initial
     5.9605e+07     5.9605e+08             1.0509e-11        -0.941589804658  <--
     2.3842e+08     2.3842e+09             2.6274e-12        -0.941589804658
     9.5367e+08     9.5367e+09             6.5652e-13        -0.941589804658

*****************************************************************************
Applying the update for shift_i =   5.9605e+07     and shift_s =   5.9605e+08
*****************************************************************************

  Execution time = 2.9254e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129439e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5117e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2205
    reference variance = 0.192621
====================================================
  Execution time = 2.0304e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7497e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4587e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274952199295
                                         uncertainty =       0.002113268251

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274952199295
                                         uncertainty =       0.002113268251

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370786944
  error estimate for blocks of size 2^( 2) =       0.000384057870
  error estimate for blocks of size 2^( 3) =       0.000395913657
  error estimate for blocks of size 2^( 4) =       0.000404556726
  error estimate for blocks of size 2^( 5) =       0.000410179738
  error estimate for blocks of size 2^( 6) =       0.000413655430
  error estimate for blocks of size 2^( 7) =       0.000414409958

      target function =      -0.953504749154
              le_mean =     -17.212309401520
             les_mean =     296.538560711969
             stat err =       0.000410700463
             autocorr =       1.226878392838
   target nu stat err =       0.000410700463
   target dn stat err =       0.001995496656
      target stat err =       0.003527943259
              std dev =       0.524371925083
             le_variance =       0.274965915815


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721230940152e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.953516754708       residual = 8.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.953516754710       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.953516754710       residual = 9.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.953516754711       residual = 7.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.953516754711       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.953516754711       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.953516754712       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.953516754712       residual = 5.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.953516754712       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.953516827607       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.953516783244       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.953516806884       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.953516764144       residual = 9.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.953516729878       residual = 9.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.953516765166       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.953516757063       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.953516750090       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.953516811872       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.953516737576       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.953516735649       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.953516816310       residual = 9.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.953516851954       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.953516765002       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.953516704485       residual = 5.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 3.737135e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.953516754708       residual = 8.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.953516754709       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.953516754709       residual = 9.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.953516754709       residual = 7.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.953516754709       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.953516754709       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.953516754709       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.953516754709       residual = 5.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.953516754709       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.953516754709       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.953516747117       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.953516754709       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.953516754709       residual = 9.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.953516572391       residual = 9.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.953516969057       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.953516742717       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.953516660632       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.953516975940       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.953516924172       residual = 4.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.953516821527       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.953516646307       residual = 9.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.953516685237       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.953516593828       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.953516575664       residual = 5.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+07 is 9.342737e-12

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.953516754708       residual = 8.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.953516754709       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.953516754709       residual = 9.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.953516754709       residual = 7.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.953516754709       residual = 3.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.953516655822       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.953516824886       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.953516754709       residual = 5.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.953516642454       residual = 4.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.953516754709       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.953516529208       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.953516756063       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.953516754709       residual = 9.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.953516580064       residual = 9.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.953517208519       residual = 4.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.953516460679       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.953517807630       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.953516260144       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.953516465205       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.953516357606       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.953517083983       residual = 9.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.953517595128       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.953516818017       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.953517525938       residual = 5.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+08 is 2.335192e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.670743 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5792e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129439e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.1319
    reference variance = 0.247439
====================================================
  Execution time = 2.0248e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8871e-01
  Total weights = 2.0000e+06
  Execution time = 1.8365e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288708712533
                                         uncertainty =       0.006291935298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288708712533
                                         uncertainty =       0.006291935298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379939613
  error estimate for blocks of size 2^( 2) =       0.000393172618
  error estimate for blocks of size 2^( 3) =       0.000405536035
  error estimate for blocks of size 2^( 4) =       0.000414281276
  error estimate for blocks of size 2^( 5) =       0.000420195671
  error estimate for blocks of size 2^( 6) =       0.000422699946
  error estimate for blocks of size 2^( 7) =       0.000423986299

      target function =      -0.930243591647
              le_mean =     -17.211775062660
             les_mean =     296.533908882824
             stat err =       0.000420290798
             autocorr =       1.223687744131
   target nu stat err =       0.000420290798
   target dn stat err =       0.006356181766
      target stat err =       0.010472017782
              std dev =       0.537315754085
             le_variance =       0.288708219588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288708712532
                                         uncertainty =       0.006291935299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288708712532
                                         uncertainty =       0.006291935299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379939613
  error estimate for blocks of size 2^( 2) =       0.000393172618
  error estimate for blocks of size 2^( 3) =       0.000405536035
  error estimate for blocks of size 2^( 4) =       0.000414281276
  error estimate for blocks of size 2^( 5) =       0.000420195671
  error estimate for blocks of size 2^( 6) =       0.000422699946
  error estimate for blocks of size 2^( 7) =       0.000423986299

      target function =      -0.930243591649
              le_mean =     -17.211775062659
             les_mean =     296.533908882820
             stat err =       0.000420290798
             autocorr =       1.223687744142
   target nu stat err =       0.000420290798
   target dn stat err =       0.006356181766
      target stat err =       0.010472017782
              std dev =       0.537315754084
             le_variance =       0.288708219587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288708712533
                                         uncertainty =       0.006291935298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288708712533
                                         uncertainty =       0.006291935298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379939613
  error estimate for blocks of size 2^( 2) =       0.000393172618
  error estimate for blocks of size 2^( 3) =       0.000405536035
  error estimate for blocks of size 2^( 4) =       0.000414281276
  error estimate for blocks of size 2^( 5) =       0.000420195671
  error estimate for blocks of size 2^( 6) =       0.000422699946
  error estimate for blocks of size 2^( 7) =       0.000423986299

      target function =      -0.930243591648
              le_mean =     -17.211775062660
             les_mean =     296.533908882822
             stat err =       0.000420290798
             autocorr =       1.223687744137
   target nu stat err =       0.000420290798
   target dn stat err =       0.006356181766
      target stat err =       0.010472017782
              std dev =       0.537315754084
             le_variance =       0.288708219587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288708712533
                                         uncertainty =       0.006291935298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288708712533
                                         uncertainty =       0.006291935298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379939613
  error estimate for blocks of size 2^( 2) =       0.000393172618
  error estimate for blocks of size 2^( 3) =       0.000405536035
  error estimate for blocks of size 2^( 4) =       0.000414281276
  error estimate for blocks of size 2^( 5) =       0.000420195671
  error estimate for blocks of size 2^( 6) =       0.000422699946
  error estimate for blocks of size 2^( 7) =       0.000423986299

      target function =      -0.930243591648
              le_mean =     -17.211775062660
             les_mean =     296.533908882824
             stat err =       0.000420290798
             autocorr =       1.223687744126
   target nu stat err =       0.000420290798
   target dn stat err =       0.006356181766
      target stat err =       0.010472017782
              std dev =       0.537315754085
             le_variance =       0.288708219588


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.930243591647        initial
     1.4901e+07     1.4901e+08             3.7371e-11        -0.930243591649  <--
     5.9605e+07     5.9605e+08             9.3427e-12        -0.930243591648
     2.3842e+08     2.3842e+09             2.3352e-12        -0.930243591648

*****************************************************************************
Applying the update for shift_i =   1.4901e+07     and shift_s =   1.4901e+08
*****************************************************************************

  Execution time = 2.9518e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5315e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1838
    reference variance = 0.225733
====================================================
  Execution time = 2.2463e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8284e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4828e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282815299969
                                         uncertainty =       0.004126243501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282815299969
                                         uncertainty =       0.004126243501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376059670
  error estimate for blocks of size 2^( 2) =       0.000389755006
  error estimate for blocks of size 2^( 3) =       0.000401685792
  error estimate for blocks of size 2^( 4) =       0.000411130471
  error estimate for blocks of size 2^( 5) =       0.000416417851
  error estimate for blocks of size 2^( 6) =       0.000418329259
  error estimate for blocks of size 2^( 7) =       0.000420457418

      target function =      -0.940058357257
              le_mean =     -17.211759386681
             les_mean =     296.527502794134
             stat err =       0.000416583750
             autocorr =       1.227131568067
   target nu stat err =       0.000416583750
   target dn stat err =       0.004084987603
      target stat err =       0.006895102509
              std dev =       0.531828685355
             le_variance =       0.282841750566


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721175938668e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940107613241       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940107613248       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940107613251       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940107613480       residual = 9.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940107613254       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940107621714       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940107621154       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940107618464       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940107618423       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940107618963       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.940107608043       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.940107613497       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.940107602526       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.940107614595       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.940107604182       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.940107610941       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.940107623073       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.940107611362       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.940107606658       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.940107604812       residual = 8.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.940107622424       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.940107620449       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.940107607216       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.940107609816       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.940107610136       residual = 1.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 1.685423e-10

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940107613241       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940107613243       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940107613243       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940107613683       residual = 9.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940107603814       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940107606926       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940107571513       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940107598120       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940107618566       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940107627205       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.940107605240       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.940107667531       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.940107647880       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.940107608619       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.940107622716       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.940107604415       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.940107571607       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.940107630047       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.940107626039       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.940107581216       residual = 8.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.940107643795       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.940107613745       residual = 7.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.940107594748       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.940107650096       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.940107609456       residual = 1.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 4.213583e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940107613241       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940107613241       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940107613242       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940107613242       residual = 9.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940107622721       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940107567265       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940107576117       residual = 3.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940107638278       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940107544739       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940107536330       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.940107643615       residual = 3.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.940107186913       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.940107559119       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.940107705604       residual = 8.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.940107708874       residual = 5.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.940107385875       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.940107755751       residual = 3.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.940107738656       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.940107460573       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.940107492531       residual = 8.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.940107678675       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.940107759320       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.940107254265       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.940107626404       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.940107390719       residual = 1.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+07 is 1.053457e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.690551 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7976e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2822
    reference variance = 0.472874
====================================================
  Execution time = 2.0086e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7906e-01
  Total weights = 2.0000e+06
  Execution time = 1.8157e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279089511107
                                         uncertainty =       0.002572044024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279089511107
                                         uncertainty =       0.002572044024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373540401
  error estimate for blocks of size 2^( 2) =       0.000387128664
  error estimate for blocks of size 2^( 3) =       0.000399394538
  error estimate for blocks of size 2^( 4) =       0.000408006506
  error estimate for blocks of size 2^( 5) =       0.000413335306
  error estimate for blocks of size 2^( 6) =       0.000415541046
  error estimate for blocks of size 2^( 7) =       0.000417731393

      target function =      -0.946466495050
              le_mean =     -17.211840153881
             les_mean =     296.526506205821
             stat err =       0.000413653563
             autocorr =       1.226304655327
   target nu stat err =       0.000413653563
   target dn stat err =       0.002695308836
      target stat err =       0.004645243772
              std dev =       0.528265901426
             le_variance =       0.279064862609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279089511103
                                         uncertainty =       0.002572044024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279089511103
                                         uncertainty =       0.002572044024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373540401
  error estimate for blocks of size 2^( 2) =       0.000387128664
  error estimate for blocks of size 2^( 3) =       0.000399394538
  error estimate for blocks of size 2^( 4) =       0.000408006506
  error estimate for blocks of size 2^( 5) =       0.000413335306
  error estimate for blocks of size 2^( 6) =       0.000415541046
  error estimate for blocks of size 2^( 7) =       0.000417731393

      target function =      -0.946466495058
              le_mean =     -17.211840153880
             les_mean =     296.526506205784
             stat err =       0.000413653563
             autocorr =       1.226304655413
   target nu stat err =       0.000413653563
   target dn stat err =       0.002695308836
      target stat err =       0.004645243771
              std dev =       0.528265901421
             le_variance =       0.279064862604

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279089511105
                                         uncertainty =       0.002572044024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279089511105
                                         uncertainty =       0.002572044024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373540401
  error estimate for blocks of size 2^( 2) =       0.000387128664
  error estimate for blocks of size 2^( 3) =       0.000399394538
  error estimate for blocks of size 2^( 4) =       0.000408006506
  error estimate for blocks of size 2^( 5) =       0.000413335306
  error estimate for blocks of size 2^( 6) =       0.000415541046
  error estimate for blocks of size 2^( 7) =       0.000417731393

      target function =      -0.946466495054
              le_mean =     -17.211840153880
             les_mean =     296.526506205802
             stat err =       0.000413653563
             autocorr =       1.226304655374
   target nu stat err =       0.000413653563
   target dn stat err =       0.002695308836
      target stat err =       0.004645243771
              std dev =       0.528265901423
             le_variance =       0.279064862607

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279089511107
                                         uncertainty =       0.002572044024

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279089511107
                                         uncertainty =       0.002572044024

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373540401
  error estimate for blocks of size 2^( 2) =       0.000387128664
  error estimate for blocks of size 2^( 3) =       0.000399394538
  error estimate for blocks of size 2^( 4) =       0.000408006506
  error estimate for blocks of size 2^( 5) =       0.000413335306
  error estimate for blocks of size 2^( 6) =       0.000415541046
  error estimate for blocks of size 2^( 7) =       0.000417731393

      target function =      -0.946466495051
              le_mean =     -17.211840153881
             les_mean =     296.526506205818
             stat err =       0.000413653563
             autocorr =       1.226304655343
   target nu stat err =       0.000413653563
   target dn stat err =       0.002695308836
      target stat err =       0.004645243772
              std dev =       0.528265901425
             le_variance =       0.279064862609


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946466495050        initial
     3.7253e+06     3.7253e+07             1.6854e-10        -0.946466495058  <--
     1.4901e+07     1.4901e+08             4.2136e-11        -0.946466495054
     5.9605e+07     5.9605e+08             1.0535e-11        -0.946466495051

*****************************************************************************
Applying the update for shift_i =   3.7253e+06     and shift_s =   3.7253e+07
*****************************************************************************

  Execution time = 2.9324e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7306e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1766
    reference variance = 0.355874
====================================================
  Execution time = 2.0408e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7979e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5644e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279701480141
                                         uncertainty =       0.002444324167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279701480141
                                         uncertainty =       0.002444324167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374026018
  error estimate for blocks of size 2^( 2) =       0.000387709264
  error estimate for blocks of size 2^( 3) =       0.000400436226
  error estimate for blocks of size 2^( 4) =       0.000408915445
  error estimate for blocks of size 2^( 5) =       0.000414427123
  error estimate for blocks of size 2^( 6) =       0.000416945540
  error estimate for blocks of size 2^( 7) =       0.000416546003

      target function =      -0.945238054836
              le_mean =     -17.211579768406
             les_mean =     296.518268908258
             stat err =       0.000414208528
             autocorr =       1.226406504045
   target nu stat err =       0.000414208528
   target dn stat err =       0.002500436394
      target stat err =       0.004305312563
              std dev =       0.528952667008
             le_variance =       0.279790923935


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721157976841e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+05, overlap shift 9.3132e+06 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945256760689       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945256760723       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945256760733       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945256760741       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945256761214       residual = 5.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945256759471       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945256760388       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945256761361       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945256761546       residual = 5.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945256758735       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945256760119       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945256760623       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945256760830       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945256761408       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.945256759871       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945256760408       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.945256767050       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945256758795       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945256762010       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945256762481       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945256763427       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945256759635       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945256761512       residual = 7.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945256762540       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.945256764060       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+05 is 6.925046e-10

solving harmonic davidson linear method for identity shift 3.7253e+06, overlap shift 3.7253e+07 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945256760689       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945256760698       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945256760700       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945256760972       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945256760714       residual = 5.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945256759676       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945256761504       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945256755669       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945256764319       residual = 5.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945256758169       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945256752718       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945256753063       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945256757543       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945256767725       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.945256763424       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945256756498       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.945256762547       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945256747036       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945256767374       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945256747817       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945256754151       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945256775262       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945256758637       residual = 7.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945256753205       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.945256777219       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+06 is 1.731246e-10

solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945256760689       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945256760691       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945256760692       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945256760693       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945256760951       residual = 5.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945256768232       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945256761534       residual = 3.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945256755183       residual = 1.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945256764998       residual = 5.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945256720079       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945256748548       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945256729240       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945256720625       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945256739669       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.945256790036       residual = 5.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945256751021       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.945256802281       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945256811392       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945256762172       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945256703807       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945256771070       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945256754877       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945256756348       residual = 7.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945256741841       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.945256787456       residual = 4.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 4.328103e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.710397 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6003e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.3561
    reference variance = 0.339912
====================================================
  Execution time = 1.9705e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7751e-01
  Total weights = 2.0000e+06
  Execution time = 1.8137e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277586833496
                                         uncertainty =       0.003388161974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277586833496
                                         uncertainty =       0.003388161974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372497845
  error estimate for blocks of size 2^( 2) =       0.000385981962
  error estimate for blocks of size 2^( 3) =       0.000398594080
  error estimate for blocks of size 2^( 4) =       0.000407881778
  error estimate for blocks of size 2^( 5) =       0.000412944936
  error estimate for blocks of size 2^( 6) =       0.000417825918
  error estimate for blocks of size 2^( 7) =       0.000420007012

      target function =      -0.949106089840
              le_mean =     -17.211537612000
             les_mean =     296.514536119105
             stat err =       0.000414664911
             autocorr =       1.239216095398
   target nu stat err =       0.000414664911
   target dn stat err =       0.003478369780
      target stat err =       0.005993978591
              std dev =       0.526791503895
             le_variance =       0.277509288576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277586833508
                                         uncertainty =       0.003388161972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277586833508
                                         uncertainty =       0.003388161972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372497845
  error estimate for blocks of size 2^( 2) =       0.000385981962
  error estimate for blocks of size 2^( 3) =       0.000398594080
  error estimate for blocks of size 2^( 4) =       0.000407881778
  error estimate for blocks of size 2^( 5) =       0.000412944936
  error estimate for blocks of size 2^( 6) =       0.000417825918
  error estimate for blocks of size 2^( 7) =       0.000420007012

      target function =      -0.949106089818
              le_mean =     -17.211537611999
             les_mean =     296.514536119097
             stat err =       0.000414664911
             autocorr =       1.239216095717
   target nu stat err =       0.000414664911
   target dn stat err =       0.003478369778
      target stat err =       0.005993978587
              std dev =       0.526791503907
             le_variance =       0.277509288589

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277586833502
                                         uncertainty =       0.003388161973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277586833502
                                         uncertainty =       0.003388161973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372497845
  error estimate for blocks of size 2^( 2) =       0.000385981962
  error estimate for blocks of size 2^( 3) =       0.000398594080
  error estimate for blocks of size 2^( 4) =       0.000407881778
  error estimate for blocks of size 2^( 5) =       0.000412944936
  error estimate for blocks of size 2^( 6) =       0.000417825918
  error estimate for blocks of size 2^( 7) =       0.000420007012

      target function =      -0.949106089829
              le_mean =     -17.211537611999
             les_mean =     296.514536119101
             stat err =       0.000414664911
             autocorr =       1.239216095557
   target nu stat err =       0.000414664911
   target dn stat err =       0.003478369779
      target stat err =       0.005993978589
              std dev =       0.526791503901
             le_variance =       0.277509288583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277586833497
                                         uncertainty =       0.003388161974

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277586833497
                                         uncertainty =       0.003388161974

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372497845
  error estimate for blocks of size 2^( 2) =       0.000385981962
  error estimate for blocks of size 2^( 3) =       0.000398594080
  error estimate for blocks of size 2^( 4) =       0.000407881778
  error estimate for blocks of size 2^( 5) =       0.000412944936
  error estimate for blocks of size 2^( 6) =       0.000417825918
  error estimate for blocks of size 2^( 7) =       0.000420007012

      target function =      -0.949106089838
              le_mean =     -17.211537612000
             les_mean =     296.514536119104
             stat err =       0.000414664911
             autocorr =       1.239216095428
   target nu stat err =       0.000414664911
   target dn stat err =       0.003478369780
      target stat err =       0.005993978591
              std dev =       0.526791503896
             le_variance =       0.277509288577


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949106089840        initial  <--
     9.3132e+05     9.3132e+06             6.9250e-10        -0.949106089818
     3.7253e+06     3.7253e+07             1.7312e-10        -0.949106089829
     1.4901e+07     1.4901e+08             4.3281e-11        -0.949106089838

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9348
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4944e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.182
    reference variance = 0.214655
====================================================
  Execution time = 2.0216e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8106e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5271e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281037460191
                                         uncertainty =       0.003387162704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281037460191
                                         uncertainty =       0.003387162704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374873519
  error estimate for blocks of size 2^( 2) =       0.000388460198
  error estimate for blocks of size 2^( 3) =       0.000401143217
  error estimate for blocks of size 2^( 4) =       0.000410152713
  error estimate for blocks of size 2^( 5) =       0.000414396634
  error estimate for blocks of size 2^( 6) =       0.000415578043
  error estimate for blocks of size 2^( 7) =       0.000416265354

      target function =      -0.943060541078
              le_mean =     -17.212581077033
             les_mean =     296.554007502893
             stat err =       0.000414098186
             autocorr =       1.220217167258
   target nu stat err =       0.000414098186
   target dn stat err =       0.003442212795
      target stat err =       0.005869395228
              std dev =       0.530151214263
             le_variance =       0.281060309985


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721258107703e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+06, overlap shift 9.3132e+07 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943095780268       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943095780271       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943095780272       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943095781222       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943095780274       residual = 6.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943095780275       residual = 5.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943095780275       residual = 6.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943095774304       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943095780276       residual = 6.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943095776320       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943095795047       residual = 7.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943095791439       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943095780277       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943095773356       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943095822619       residual = 8.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943095754104       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943095849731       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943095805651       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943095736327       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943095752681       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943095768811       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943095753952       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943095781122       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943095807054       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.943095755290       residual = 6.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+06 is 1.118308e-10

solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943095780268       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943095780268       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943095780269       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943095780269       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943095777639       residual = 6.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943095782711       residual = 5.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943095732203       residual = 6.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943095745938       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943095734402       residual = 6.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943095773785       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943095799867       residual = 7.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943095737527       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943095701154       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943095714820       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943095686887       residual = 8.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943095732804       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943095717707       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943095880228       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943095750189       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943095841068       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943095858965       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943095756127       residual = 3.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943095782958       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943095745588       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.943095790752       residual = 6.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 2.795716e-11

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943095780268       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943095780268       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943095780268       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943095780268       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943095721875       residual = 6.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943095330962       residual = 5.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943095655083       residual = 6.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943095712061       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943096139376       residual = 6.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943096116325       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943095844764       residual = 7.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943096007914       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943095513192       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943095752865       residual = 8.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943095457558       residual = 8.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943096337935       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943096125792       residual = 4.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943095648610       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943096062525       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943095485275       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943096251629       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943095947214       residual = 3.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943095457247       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943095982271       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.943095969004       residual = 6.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+08 is 6.989078e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.730325 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5774e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1868
    reference variance = 0.231567
====================================================
  Execution time = 2.1778e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8074e-01
  Total weights = 2.0000e+06
  Execution time = 1.8071e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280799845428
                                         uncertainty =       0.002576400076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280799845428
                                         uncertainty =       0.002576400076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374658613
  error estimate for blocks of size 2^( 2) =       0.000388313976
  error estimate for blocks of size 2^( 3) =       0.000400642999
  error estimate for blocks of size 2^( 4) =       0.000408783076
  error estimate for blocks of size 2^( 5) =       0.000413859055
  error estimate for blocks of size 2^( 6) =       0.000416026872
  error estimate for blocks of size 2^( 7) =       0.000416375244

      target function =      -0.943625554869
              le_mean =     -17.212307705848
             les_mean =     296.544274573680
             stat err =       0.000413761061
             autocorr =       1.219629138256
   target nu stat err =       0.000413761061
   target dn stat err =       0.002531031105
      target stat err =       0.004347668345
              std dev =       0.529847292399
             le_variance =       0.280738153263

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280799845431
                                         uncertainty =       0.002576400076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280799845431
                                         uncertainty =       0.002576400076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374658613
  error estimate for blocks of size 2^( 2) =       0.000388313976
  error estimate for blocks of size 2^( 3) =       0.000400642999
  error estimate for blocks of size 2^( 4) =       0.000408783076
  error estimate for blocks of size 2^( 5) =       0.000413859055
  error estimate for blocks of size 2^( 6) =       0.000416026872
  error estimate for blocks of size 2^( 7) =       0.000416375244

      target function =      -0.943625554864
              le_mean =     -17.212307705848
             les_mean =     296.544274573677
             stat err =       0.000413761061
             autocorr =       1.219629138281
   target nu stat err =       0.000413761061
   target dn stat err =       0.002531031105
      target stat err =       0.004347668345
              std dev =       0.529847292402
             le_variance =       0.280738153266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280799845430
                                         uncertainty =       0.002576400076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280799845430
                                         uncertainty =       0.002576400076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374658613
  error estimate for blocks of size 2^( 2) =       0.000388313976
  error estimate for blocks of size 2^( 3) =       0.000400642999
  error estimate for blocks of size 2^( 4) =       0.000408783076
  error estimate for blocks of size 2^( 5) =       0.000413859055
  error estimate for blocks of size 2^( 6) =       0.000416026872
  error estimate for blocks of size 2^( 7) =       0.000416375244

      target function =      -0.943625554866
              le_mean =     -17.212307705848
             les_mean =     296.544274573678
             stat err =       0.000413761061
             autocorr =       1.219629138269
   target nu stat err =       0.000413761061
   target dn stat err =       0.002531031105
      target stat err =       0.004347668345
              std dev =       0.529847292401
             le_variance =       0.280738153264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280799845428
                                         uncertainty =       0.002576400076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280799845428
                                         uncertainty =       0.002576400076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374658613
  error estimate for blocks of size 2^( 2) =       0.000388313976
  error estimate for blocks of size 2^( 3) =       0.000400642999
  error estimate for blocks of size 2^( 4) =       0.000408783076
  error estimate for blocks of size 2^( 5) =       0.000413859055
  error estimate for blocks of size 2^( 6) =       0.000416026872
  error estimate for blocks of size 2^( 7) =       0.000416375244

      target function =      -0.943625554868
              le_mean =     -17.212307705848
             les_mean =     296.544274573680
             stat err =       0.000413761061
             autocorr =       1.219629138259
   target nu stat err =       0.000413761061
   target dn stat err =       0.002531031105
      target stat err =       0.004347668345
              std dev =       0.529847292399
             le_variance =       0.280738153263


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943625554869        initial  <--
     9.3132e+06     9.3132e+07             1.1183e-10        -0.943625554864
     3.7253e+07     3.7253e+08             2.7957e-11        -0.943625554866
     1.4901e+08     1.4901e+09             6.9891e-12        -0.943625554868

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.9526
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6732e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1562
    reference variance = 0.205288
====================================================
  Execution time = 2.0056e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8108e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4868e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281077975532
                                         uncertainty =       0.002065498772

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281077975532
                                         uncertainty =       0.002065498772

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374883650
  error estimate for blocks of size 2^( 2) =       0.000388297844
  error estimate for blocks of size 2^( 3) =       0.000400360956
  error estimate for blocks of size 2^( 4) =       0.000408965597
  error estimate for blocks of size 2^( 5) =       0.000414315353
  error estimate for blocks of size 2^( 6) =       0.000416681133
  error estimate for blocks of size 2^( 7) =       0.000418791810

      target function =      -0.943068392691
              le_mean =     -17.211753254445
             les_mean =     296.525525453965
             stat err =       0.000414688473
             autocorr =       1.223632284751
   target nu stat err =       0.000414688473
   target dn stat err =       0.002105440660
      target stat err =       0.003632270372
              std dev =       0.530165542649
             le_variance =       0.281075502613


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721175325444e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943081100090       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943081100091       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943081100091       residual = 8.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943081100091       residual = 9.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943081100091       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943081237583       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943081090100       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943080975709       residual = 9.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943081032295       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943081236499       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943080946237       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943081208012       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943081196436       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943081088809       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943081053719       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943081032980       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943080956437       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943080908197       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943080742570       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943081200364       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943080920251       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943081470147       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943081454095       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943081171287       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.943081057669       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 5.229425e-12

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943081100090       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943081100091       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943081100091       residual = 8.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943081100091       residual = 9.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943080709501       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943081241653       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943080858248       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943079893303       residual = 9.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943081099868       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943081191484       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943081178824       residual = 2.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943079815807       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943080650375       residual = 8.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943081364048       residual = 4.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943081366304       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943082299672       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943081577205       residual = 2.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943080732817       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943082133542       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943082418870       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943079437557       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943080607425       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943080851638       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943080849139       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.943080195008       residual = 3.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+08 is 1.306937e-12

solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943081100090       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943081100090       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943081100090       residual = 8.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943081100090       residual = 9.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943081100090       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943081100090       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943078826229       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943081100091       residual = 9.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943083609862       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943077763436       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.943080931323       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.943086920206       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.943081275404       residual = 8.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.943084157981       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943081971118       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943077271946       residual = 1.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943078089541       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.943082749538       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.943084170717       residual = 7.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.943086857109       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.943083459425       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.943082405162       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.943082146245       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943079785026       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.943082676119       residual = 4.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+09 is 3.271108e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.750223 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5573e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2309
    reference variance = 0.296574
====================================================
  Execution time = 1.9590e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8889e-01
  Total weights = 2.0000e+06
  Execution time = 1.8273e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288922913599
                                         uncertainty =       0.007614981369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288922913599
                                         uncertainty =       0.007614981369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380057529
  error estimate for blocks of size 2^( 2) =       0.000393651260
  error estimate for blocks of size 2^( 3) =       0.000406030201
  error estimate for blocks of size 2^( 4) =       0.000414888311
  error estimate for blocks of size 2^( 5) =       0.000420446843
  error estimate for blocks of size 2^( 6) =       0.000423931901
  error estimate for blocks of size 2^( 7) =       0.000425624763

      target function =      -0.929883634485
              le_mean =     -17.212334783758
             les_mean =     296.553356015078
             stat err =       0.000421222955
             autocorr =       1.228359187714
   target nu stat err =       0.000421222955
   target dn stat err =       0.007581027767
      target stat err =       0.012484991984
              std dev =       0.537482512605
             le_variance =       0.288887451356

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288922913599
                                         uncertainty =       0.007614981369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288922913599
                                         uncertainty =       0.007614981369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380057529
  error estimate for blocks of size 2^( 2) =       0.000393651260
  error estimate for blocks of size 2^( 3) =       0.000406030201
  error estimate for blocks of size 2^( 4) =       0.000414888311
  error estimate for blocks of size 2^( 5) =       0.000420446843
  error estimate for blocks of size 2^( 6) =       0.000423931901
  error estimate for blocks of size 2^( 7) =       0.000425624763

      target function =      -0.929883634485
              le_mean =     -17.212334783758
             les_mean =     296.553356015078
             stat err =       0.000421222955
             autocorr =       1.228359187711
   target nu stat err =       0.000421222955
   target dn stat err =       0.007581027767
      target stat err =       0.012484991984
              std dev =       0.537482512605
             le_variance =       0.288887451356

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288922913599
                                         uncertainty =       0.007614981369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288922913599
                                         uncertainty =       0.007614981369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380057529
  error estimate for blocks of size 2^( 2) =       0.000393651260
  error estimate for blocks of size 2^( 3) =       0.000406030201
  error estimate for blocks of size 2^( 4) =       0.000414888311
  error estimate for blocks of size 2^( 5) =       0.000420446843
  error estimate for blocks of size 2^( 6) =       0.000423931901
  error estimate for blocks of size 2^( 7) =       0.000425624763

      target function =      -0.929883634485
              le_mean =     -17.212334783758
             les_mean =     296.553356015078
             stat err =       0.000421222955
             autocorr =       1.228359187709
   target nu stat err =       0.000421222955
   target dn stat err =       0.007581027767
      target stat err =       0.012484991984
              std dev =       0.537482512605
             le_variance =       0.288887451356

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288922913599
                                         uncertainty =       0.007614981369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288922913599
                                         uncertainty =       0.007614981369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380057529
  error estimate for blocks of size 2^( 2) =       0.000393651260
  error estimate for blocks of size 2^( 3) =       0.000406030201
  error estimate for blocks of size 2^( 4) =       0.000414888311
  error estimate for blocks of size 2^( 5) =       0.000420446843
  error estimate for blocks of size 2^( 6) =       0.000423931901
  error estimate for blocks of size 2^( 7) =       0.000425624763

      target function =      -0.929883634485
              le_mean =     -17.212334783758
             les_mean =     296.553356015078
             stat err =       0.000421222955
             autocorr =       1.228359187716
   target nu stat err =       0.000421222955
   target dn stat err =       0.007581027767
      target stat err =       0.012484991984
              std dev =       0.537482512605
             le_variance =       0.288887451356


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.929883634485        initial
     9.3132e+07     9.3132e+08             5.2294e-12        -0.929883634485  <--
     3.7253e+08     3.7253e+09             1.3069e-12        -0.929883634485
     1.4901e+09     1.4901e+10             3.2711e-13        -0.929883634485

*****************************************************************************
Applying the update for shift_i =   9.3132e+07     and shift_s =   9.3132e+08
*****************************************************************************

  Execution time = 2.8818e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4398e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2299
    reference variance = 0.174351
====================================================
  Execution time = 1.9863e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7961e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4716e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279638458634
                                         uncertainty =       0.003447758740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279638458634
                                         uncertainty =       0.003447758740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373908134
  error estimate for blocks of size 2^( 2) =       0.000387561112
  error estimate for blocks of size 2^( 3) =       0.000399716777
  error estimate for blocks of size 2^( 4) =       0.000408690981
  error estimate for blocks of size 2^( 5) =       0.000414294122
  error estimate for blocks of size 2^( 6) =       0.000417566292
  error estimate for blocks of size 2^( 7) =       0.000420561779

      target function =      -0.945525896622
              le_mean =     -17.210799702203
             les_mean =     296.491240835503
             stat err =       0.000415278293
             autocorr =       1.233526930740
   target nu stat err =       0.000415278293
   target dn stat err =       0.003390336200
      target stat err =       0.005793028547
              std dev =       0.528785954782
             le_variance =       0.279614585975


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721079970220e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945560074760       residual = 9.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945560074761       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945560074761       residual = 6.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945560074762       residual = 5.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945560074762       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945560089864       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945560012058       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945560066441       residual = 9.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945560063551       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945560008119       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945560071092       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945560095455       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945560029301       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945559995484       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.945560136123       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945560078292       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.945560100546       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945560093601       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945560101705       residual = 3.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945560143208       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945560061483       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945560055727       residual = 9.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945560008936       residual = 3.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945560228652       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.945560044881       residual = 1.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 2.382406e-11

solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945560074760       residual = 9.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945560074760       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945560074761       residual = 6.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945560074761       residual = 5.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945560040051       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945560073407       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945559942310       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945560294986       residual = 9.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945559979374       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945560007097       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945560194628       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945560006592       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945559951041       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945560138172       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.945560019452       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945560068608       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.945559998369       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945559615787       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945560069117       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945559835967       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945560425801       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945559502701       residual = 9.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945560280443       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945560270043       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.945559890946       residual = 1.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 5.955639e-12

solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945560074760       residual = 9.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945560074760       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945560074760       residual = 6.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945560074760       residual = 5.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945560075967       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945560105208       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945560214820       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945560836406       residual = 9.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945560297851       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945560836308       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945560714589       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945559790090       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945560583711       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945559903453       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.945560278004       residual = 4.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945561433207       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.945559327302       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945558999658       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945559256482       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945560069524       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945559889538       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945559598363       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945558032733       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945559610555       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.945558324162       residual = 1.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+08 is 1.487022e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.770047 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5366e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1793
    reference variance = 0.24752
====================================================
  Execution time = 1.9825e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7948e-01
  Total weights = 2.0000e+06
  Execution time = 1.7962e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279528125090
                                         uncertainty =       0.002185928509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279528125090
                                         uncertainty =       0.002185928509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373818347
  error estimate for blocks of size 2^( 2) =       0.000387846580
  error estimate for blocks of size 2^( 3) =       0.000400823448
  error estimate for blocks of size 2^( 4) =       0.000409839600
  error estimate for blocks of size 2^( 5) =       0.000414938103
  error estimate for blocks of size 2^( 6) =       0.000417707456
  error estimate for blocks of size 2^( 7) =       0.000417731738

      target function =      -0.945766419096
              le_mean =     -17.211963515097
             les_mean =     296.531168218893
             stat err =       0.000415054224
             autocorr =       1.232788146893
   target nu stat err =       0.000415054224
   target dn stat err =       0.002235808923
      target stat err =       0.003871361562
              std dev =       0.528658976649
             le_variance =       0.279480313591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279528125090
                                         uncertainty =       0.002185928509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279528125090
                                         uncertainty =       0.002185928509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373818347
  error estimate for blocks of size 2^( 2) =       0.000387846580
  error estimate for blocks of size 2^( 3) =       0.000400823448
  error estimate for blocks of size 2^( 4) =       0.000409839600
  error estimate for blocks of size 2^( 5) =       0.000414938103
  error estimate for blocks of size 2^( 6) =       0.000417707456
  error estimate for blocks of size 2^( 7) =       0.000417731738

      target function =      -0.945766419097
              le_mean =     -17.211963515097
             les_mean =     296.531168218893
             stat err =       0.000415054224
             autocorr =       1.232788146909
   target nu stat err =       0.000415054224
   target dn stat err =       0.002235808923
      target stat err =       0.003871361562
              std dev =       0.528658976648
             le_variance =       0.279480313591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279528125090
                                         uncertainty =       0.002185928509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279528125090
                                         uncertainty =       0.002185928509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373818347
  error estimate for blocks of size 2^( 2) =       0.000387846580
  error estimate for blocks of size 2^( 3) =       0.000400823448
  error estimate for blocks of size 2^( 4) =       0.000409839600
  error estimate for blocks of size 2^( 5) =       0.000414938103
  error estimate for blocks of size 2^( 6) =       0.000417707456
  error estimate for blocks of size 2^( 7) =       0.000417731738

      target function =      -0.945766419097
              le_mean =     -17.211963515097
             les_mean =     296.531168218893
             stat err =       0.000415054224
             autocorr =       1.232788146913
   target nu stat err =       0.000415054224
   target dn stat err =       0.002235808923
      target stat err =       0.003871361562
              std dev =       0.528658976648
             le_variance =       0.279480313591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279528125090
                                         uncertainty =       0.002185928509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279528125090
                                         uncertainty =       0.002185928509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373818347
  error estimate for blocks of size 2^( 2) =       0.000387846580
  error estimate for blocks of size 2^( 3) =       0.000400823448
  error estimate for blocks of size 2^( 4) =       0.000409839600
  error estimate for blocks of size 2^( 5) =       0.000414938103
  error estimate for blocks of size 2^( 6) =       0.000417707456
  error estimate for blocks of size 2^( 7) =       0.000417731738

      target function =      -0.945766419096
              le_mean =     -17.211963515097
             les_mean =     296.531168218893
             stat err =       0.000415054224
             autocorr =       1.232788146899
   target nu stat err =       0.000415054224
   target dn stat err =       0.002235808923
      target stat err =       0.003871361562
              std dev =       0.528658976649
             le_variance =       0.279480313591


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945766419096        initial
     2.3283e+07     2.3283e+08             2.3824e-11        -0.945766419097  <--
     9.3132e+07     9.3132e+08             5.9556e-12        -0.945766419097
     3.7253e+08     3.7253e+09             1.4870e-12        -0.945766419096

*****************************************************************************
Applying the update for shift_i =   2.3283e+07     and shift_s =   2.3283e+08
*****************************************************************************

  Execution time = 2.9020e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4392e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1732
    reference variance = 0.185261
====================================================
  Execution time = 2.0084e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8591e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5620e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285908921529
                                         uncertainty =       0.005283106122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285908921529
                                         uncertainty =       0.005283106122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378095121
  error estimate for blocks of size 2^( 2) =       0.000391955465
  error estimate for blocks of size 2^( 3) =       0.000404523931
  error estimate for blocks of size 2^( 4) =       0.000413543062
  error estimate for blocks of size 2^( 5) =       0.000418857266
  error estimate for blocks of size 2^( 6) =       0.000421588192
  error estimate for blocks of size 2^( 7) =       0.000422055259

      target function =      -0.934885005473
              le_mean =     -17.212171213602
             les_mean =     296.544749584588
             stat err =       0.000419010945
             autocorr =       1.228142011683
   target nu stat err =       0.000419010945
   target dn stat err =       0.005424901733
      target stat err =       0.009041546692
              std dev =       0.534707248109
             le_variance =       0.285911841180


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721217121360e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934972215153       residual = 6.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934972215155       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934972215157       residual = 6.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934972215157       residual = 9.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934972215158       residual = 5.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934972210914       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934972203051       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934972212728       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934972202070       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934972219975       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934972219329       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934972222139       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934972206504       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934972213263       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934972218293       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934972227524       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934972191676       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934972218436       residual = 4.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934972214151       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934972204190       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934972227789       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934972213632       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934972208703       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934972241573       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934972204838       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 9.638149e-11

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934972215153       residual = 6.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934972215153       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934972215154       residual = 6.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934972213488       residual = 9.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934972191082       residual = 5.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934972214668       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934972236261       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934972240572       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934972178665       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934972331587       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934972236897       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934972224313       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934972223560       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934972185636       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934972172117       residual = 4.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934972193001       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934972269447       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934972201806       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934972158949       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934972169520       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934972161292       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934972275461       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934972222872       residual = 3.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934972164544       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934972226400       residual = 1.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 2.409601e-11

solving harmonic davidson linear method for identity shift 9.3132e+07, overlap shift 9.3132e+08 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934972215153       residual = 6.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934972215153       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934972215153       residual = 6.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934972215153       residual = 9.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934972215153       residual = 5.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934972215153       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934972215153       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934972215153       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934972215153       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934972215153       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934972421051       residual = 5.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934972444453       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934972268790       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934972506358       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934972422634       residual = 4.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934972228213       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934972402210       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934972020606       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934972056145       residual = 5.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934971692929       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934972363863       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934972136800       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934971922095       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934972102158       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934972344036       residual = 1.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+07 is 6.024302e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.789906 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5678e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2774
    reference variance = 0.22303
====================================================
  Execution time = 2.1729e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8553e-01
  Total weights = 2.0000e+06
  Execution time = 1.8074e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285590499382
                                         uncertainty =       0.003512073952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285590499382
                                         uncertainty =       0.003512073952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377845085
  error estimate for blocks of size 2^( 2) =       0.000391356857
  error estimate for blocks of size 2^( 3) =       0.000403822040
  error estimate for blocks of size 2^( 4) =       0.000412443753
  error estimate for blocks of size 2^( 5) =       0.000417504374
  error estimate for blocks of size 2^( 6) =       0.000419626242
  error estimate for blocks of size 2^( 7) =       0.000422521468

      target function =      -0.935571554241
              le_mean =     -17.212008106405
             les_mean =     296.538756728751
             stat err =       0.000418023959
             autocorr =       1.223981330683
   target nu stat err =       0.000418023959
   target dn stat err =       0.003386908825
      target stat err =       0.005680700807
              std dev =       0.534353643716
             le_variance =       0.285533816552

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285590499380
                                         uncertainty =       0.003512073952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285590499380
                                         uncertainty =       0.003512073952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377845085
  error estimate for blocks of size 2^( 2) =       0.000391356857
  error estimate for blocks of size 2^( 3) =       0.000403822040
  error estimate for blocks of size 2^( 4) =       0.000412443753
  error estimate for blocks of size 2^( 5) =       0.000417504374
  error estimate for blocks of size 2^( 6) =       0.000419626242
  error estimate for blocks of size 2^( 7) =       0.000422521468

      target function =      -0.935571554245
              le_mean =     -17.212008106405
             les_mean =     296.538756728748
             stat err =       0.000418023959
             autocorr =       1.223981330725
   target nu stat err =       0.000418023959
   target dn stat err =       0.003386908825
      target stat err =       0.005680700807
              std dev =       0.534353643713
             le_variance =       0.285533816550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285590499381
                                         uncertainty =       0.003512073952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285590499381
                                         uncertainty =       0.003512073952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377845085
  error estimate for blocks of size 2^( 2) =       0.000391356857
  error estimate for blocks of size 2^( 3) =       0.000403822040
  error estimate for blocks of size 2^( 4) =       0.000412443753
  error estimate for blocks of size 2^( 5) =       0.000417504374
  error estimate for blocks of size 2^( 6) =       0.000419626242
  error estimate for blocks of size 2^( 7) =       0.000422521468

      target function =      -0.935571554243
              le_mean =     -17.212008106405
             les_mean =     296.538756728750
             stat err =       0.000418023959
             autocorr =       1.223981330704
   target nu stat err =       0.000418023959
   target dn stat err =       0.003386908825
      target stat err =       0.005680700807
              std dev =       0.534353643715
             le_variance =       0.285533816551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285590499382
                                         uncertainty =       0.003512073952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285590499382
                                         uncertainty =       0.003512073952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377845085
  error estimate for blocks of size 2^( 2) =       0.000391356857
  error estimate for blocks of size 2^( 3) =       0.000403822040
  error estimate for blocks of size 2^( 4) =       0.000412443753
  error estimate for blocks of size 2^( 5) =       0.000417504374
  error estimate for blocks of size 2^( 6) =       0.000419626242
  error estimate for blocks of size 2^( 7) =       0.000422521468

      target function =      -0.935571554241
              le_mean =     -17.212008106405
             les_mean =     296.538756728751
             stat err =       0.000418023959
             autocorr =       1.223981330699
   target nu stat err =       0.000418023959
   target dn stat err =       0.003386908825
      target stat err =       0.005680700807
              std dev =       0.534353643716
             le_variance =       0.285533816552


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.935571554241        initial
     5.8208e+06     5.8208e+07             9.6381e-11        -0.935571554245  <--
     2.3283e+07     2.3283e+08             2.4096e-11        -0.935571554243
     9.3132e+07     9.3132e+08             6.0243e-12        -0.935571554241

*****************************************************************************
Applying the update for shift_i =   5.8208e+06     and shift_s =   5.8208e+07
*****************************************************************************

  Execution time = 3.0877e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6561e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2409
    reference variance = 0.168098
====================================================
  Execution time = 2.0137e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8040e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5065e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280438118588
                                         uncertainty =       0.002869526849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280438118588
                                         uncertainty =       0.002869526849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374430746
  error estimate for blocks of size 2^( 2) =       0.000387994926
  error estimate for blocks of size 2^( 3) =       0.000400667558
  error estimate for blocks of size 2^( 4) =       0.000409192508
  error estimate for blocks of size 2^( 5) =       0.000413780765
  error estimate for blocks of size 2^( 6) =       0.000416967555
  error estimate for blocks of size 2^( 7) =       0.000419458426

      target function =      -0.944191050722
              le_mean =     -17.212806396435
             les_mean =     296.561100668488
             stat err =       0.000414849813
             autocorr =       1.227548870372
   target nu stat err =       0.000414849813
   target dn stat err =       0.002906819449
      target stat err =       0.004986504133
              std dev =       0.529525039579
             le_variance =       0.280396767541


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721280639643e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+06, overlap shift 1.4552e+07 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944216565138       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944216565157       residual = 9.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944216565162       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944216565433       residual = 8.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944216564808       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944216566609       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944216564563       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944216566048       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944216565026       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944216564347       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944216562932       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944216561059       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944216567243       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944216563787       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944216562569       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944216567300       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944216562125       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944216568378       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944216579212       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944216563158       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944216568532       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944216564424       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944216558181       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944216544193       residual = 2.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+06 is 3.599504e-10

solving harmonic davidson linear method for identity shift 5.8208e+06, overlap shift 5.8208e+07 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944216565138       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944216565143       residual = 9.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944216565144       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944216565145       residual = 8.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944216564910       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944216580114       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944216565147       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944216565147       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944216565881       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944216567249       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944216555517       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944216549345       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944216568756       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944216569270       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944216570058       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944216560702       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944216565096       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944216572166       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944216545847       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944216562083       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944216563277       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944216576379       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944216575626       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944216535616       residual = 2.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+06 is 8.998774e-11

solving harmonic davidson linear method for identity shift 2.3283e+07, overlap shift 2.3283e+08 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944216565138       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944216565139       residual = 9.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944216565139       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944216556693       residual = 8.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944216565128       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944216565140       residual = 2.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944216562326       residual = 3.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944216555177       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944216584240       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944216564498       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944216535763       residual = 2.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944216533170       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944216567350       residual = 6.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944216593831       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944216531421       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944216537715       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944216575292       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944216514939       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944216551112       residual = 2.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944216583646       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944216558259       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944216583078       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944216595068       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944216575649       residual = 2.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+07 is 2.249726e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.807989 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5672e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.174
    reference variance = 0.454891
====================================================
  Execution time = 1.9566e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7918e-01
  Total weights = 2.0000e+06
  Execution time = 1.8201e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279233774351
                                         uncertainty =       0.002733207971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279233774351
                                         uncertainty =       0.002733207971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373620126
  error estimate for blocks of size 2^( 2) =       0.000387255552
  error estimate for blocks of size 2^( 3) =       0.000400141993
  error estimate for blocks of size 2^( 4) =       0.000409157784
  error estimate for blocks of size 2^( 5) =       0.000414436103
  error estimate for blocks of size 2^( 6) =       0.000416397054
  error estimate for blocks of size 2^( 7) =       0.000419442084

      target function =      -0.946259749980
              le_mean =     -17.212286565041
             les_mean =     296.541992654111
             stat err =       0.000414858256
             autocorr =       1.232931506128
   target nu stat err =       0.000414858256
   target dn stat err =       0.002764848533
      target stat err =       0.004764387443
              std dev =       0.528378648896
             le_variance =       0.279183996610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279233774352
                                         uncertainty =       0.002733207971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279233774352
                                         uncertainty =       0.002733207971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373620126
  error estimate for blocks of size 2^( 2) =       0.000387255552
  error estimate for blocks of size 2^( 3) =       0.000400141993
  error estimate for blocks of size 2^( 4) =       0.000409157784
  error estimate for blocks of size 2^( 5) =       0.000414436103
  error estimate for blocks of size 2^( 6) =       0.000416397054
  error estimate for blocks of size 2^( 7) =       0.000419442084

      target function =      -0.946259749979
              le_mean =     -17.212286565041
             les_mean =     296.541992654106
             stat err =       0.000414858256
             autocorr =       1.232931506268
   target nu stat err =       0.000414858256
   target dn stat err =       0.002764848533
      target stat err =       0.004764387442
              std dev =       0.528378648897
             le_variance =       0.279183996610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279233774352
                                         uncertainty =       0.002733207971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279233774352
                                         uncertainty =       0.002733207971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373620126
  error estimate for blocks of size 2^( 2) =       0.000387255552
  error estimate for blocks of size 2^( 3) =       0.000400141993
  error estimate for blocks of size 2^( 4) =       0.000409157784
  error estimate for blocks of size 2^( 5) =       0.000414436103
  error estimate for blocks of size 2^( 6) =       0.000416397054
  error estimate for blocks of size 2^( 7) =       0.000419442084

      target function =      -0.946259749979
              le_mean =     -17.212286565041
             les_mean =     296.541992654108
             stat err =       0.000414858256
             autocorr =       1.232931506211
   target nu stat err =       0.000414858256
   target dn stat err =       0.002764848533
      target stat err =       0.004764387442
              std dev =       0.528378648897
             le_variance =       0.279183996610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279233774351
                                         uncertainty =       0.002733207971

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279233774351
                                         uncertainty =       0.002733207971

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373620126
  error estimate for blocks of size 2^( 2) =       0.000387255552
  error estimate for blocks of size 2^( 3) =       0.000400141993
  error estimate for blocks of size 2^( 4) =       0.000409157784
  error estimate for blocks of size 2^( 5) =       0.000414436103
  error estimate for blocks of size 2^( 6) =       0.000416397054
  error estimate for blocks of size 2^( 7) =       0.000419442084

      target function =      -0.946259749980
              le_mean =     -17.212286565041
             les_mean =     296.541992654111
             stat err =       0.000414858256
             autocorr =       1.232931506141
   target nu stat err =       0.000414858256
   target dn stat err =       0.002764848533
      target stat err =       0.004764387443
              std dev =       0.528378648896
             le_variance =       0.279183996609


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946259749980        initial  <--
     1.4552e+06     1.4552e+07             3.5995e-10        -0.946259749979
     5.8208e+06     5.8208e+07             8.9988e-11        -0.946259749979
     2.3283e+07     2.3283e+08             2.2497e-11        -0.946259749980

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.7926
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4471e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.252
    reference variance = 0.278487
====================================================
  Execution time = 2.0252e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7765e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5804e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277665031602
                                         uncertainty =       0.002015588985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277665031602
                                         uncertainty =       0.002015588985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372594894
  error estimate for blocks of size 2^( 2) =       0.000386125617
  error estimate for blocks of size 2^( 3) =       0.000398511793
  error estimate for blocks of size 2^( 4) =       0.000407796533
  error estimate for blocks of size 2^( 5) =       0.000412409421
  error estimate for blocks of size 2^( 6) =       0.000416281158
  error estimate for blocks of size 2^( 7) =       0.000414929414

      target function =      -0.948880446517
              le_mean =     -17.211565057208
             les_mean =     296.515625490344
             stat err =       0.000412854131
             autocorr =       1.227776935570
   target nu stat err =       0.000412854131
   target dn stat err =       0.002202487903
      target stat err =       0.003836834808
              std dev =       0.526928752921
             le_variance =       0.277653910655


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721156505721e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+07, overlap shift 1.4552e+08 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948895113307       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948895113309       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948895113310       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948895113310       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948895110878       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948895122260       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948895129074       residual = 4.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948895098009       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948895124182       residual = 5.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948895064167       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948895110252       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.948895096457       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.948895104300       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.948895101553       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.948895096545       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.948895099222       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.948895109841       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.948895042666       residual = 8.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.948895085528       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.948895108554       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.948895123997       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948895130054       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.948895167681       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.948895104568       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.948895096545       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+07 is 5.587119e-11

solving harmonic davidson linear method for identity shift 5.8208e+07, overlap shift 5.8208e+08 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948895113307       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948895113308       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948895113308       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948895127290       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948895113072       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948895202910       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948895112929       residual = 4.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948895035886       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948895060523       residual = 5.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948895066055       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948894929816       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.948895229123       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.948895186772       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.948895171090       residual = 6.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.948894944731       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.948895242215       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.948895121300       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.948895150828       residual = 8.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.948895010103       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.948895193214       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.948895149679       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948894968617       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.948895075705       residual = 4.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.948895175357       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.948895211368       residual = 4.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+07 is 1.396755e-11

solving harmonic davidson linear method for identity shift 2.3283e+08, overlap shift 2.3283e+09 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948895113307       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948895113307       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948895113307       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948895113307       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948895025279       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948895141360       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948895430146       residual = 4.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948894895206       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948895635286       residual = 5.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948894968132       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948895248400       residual = 3.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.948896716573       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.948895087692       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.948895005869       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.948895392415       residual = 5.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.948895498136       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.948895216774       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.948895441612       residual = 8.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.948893786460       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.948895494085       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.948895459498       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948895691303       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.948894275458       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.948894770992       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.948895014385       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+08 is 3.491638e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.827763 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5864e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.1705
    reference variance = 0.241988
====================================================
  Execution time = 1.9872e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7884e-01
  Total weights = 2.0000e+06
  Execution time = 1.8060e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278760099305
                                         uncertainty =       0.002730719791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278760099305
                                         uncertainty =       0.002730719791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373388627
  error estimate for blocks of size 2^( 2) =       0.000386972587
  error estimate for blocks of size 2^( 3) =       0.000399322041
  error estimate for blocks of size 2^( 4) =       0.000408087418
  error estimate for blocks of size 2^( 5) =       0.000412773310
  error estimate for blocks of size 2^( 6) =       0.000416027785
  error estimate for blocks of size 2^( 7) =       0.000417504489

      target function =      -0.946851233502
              le_mean =     -17.212606032724
             les_mean =     296.552644431226
             stat err =       0.000413598250
             autocorr =       1.226973590304
   target nu stat err =       0.000413598250
   target dn stat err =       0.002450010578
      target stat err =       0.004243368573
              std dev =       0.528051259718
             le_variance =       0.278838132890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278760099306
                                         uncertainty =       0.002730719791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278760099306
                                         uncertainty =       0.002730719791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373388627
  error estimate for blocks of size 2^( 2) =       0.000386972587
  error estimate for blocks of size 2^( 3) =       0.000399322041
  error estimate for blocks of size 2^( 4) =       0.000408087418
  error estimate for blocks of size 2^( 5) =       0.000412773310
  error estimate for blocks of size 2^( 6) =       0.000416027785
  error estimate for blocks of size 2^( 7) =       0.000417504489

      target function =      -0.946851233500
              le_mean =     -17.212606032724
             les_mean =     296.552644431232
             stat err =       0.000413598250
             autocorr =       1.226973590323
   target nu stat err =       0.000413598250
   target dn stat err =       0.002450010578
      target stat err =       0.004243368573
              std dev =       0.528051259719
             le_variance =       0.278838132891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278760099306
                                         uncertainty =       0.002730719791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278760099306
                                         uncertainty =       0.002730719791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373388627
  error estimate for blocks of size 2^( 2) =       0.000386972587
  error estimate for blocks of size 2^( 3) =       0.000399322041
  error estimate for blocks of size 2^( 4) =       0.000408087418
  error estimate for blocks of size 2^( 5) =       0.000412773310
  error estimate for blocks of size 2^( 6) =       0.000416027785
  error estimate for blocks of size 2^( 7) =       0.000417504489

      target function =      -0.946851233501
              le_mean =     -17.212606032724
             les_mean =     296.552644431229
             stat err =       0.000413598250
             autocorr =       1.226973590321
   target nu stat err =       0.000413598250
   target dn stat err =       0.002450010578
      target stat err =       0.004243368573
              std dev =       0.528051259719
             le_variance =       0.278838132890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278760099305
                                         uncertainty =       0.002730719791

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278760099305
                                         uncertainty =       0.002730719791

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373388627
  error estimate for blocks of size 2^( 2) =       0.000386972587
  error estimate for blocks of size 2^( 3) =       0.000399322041
  error estimate for blocks of size 2^( 4) =       0.000408087417
  error estimate for blocks of size 2^( 5) =       0.000412773310
  error estimate for blocks of size 2^( 6) =       0.000416027785
  error estimate for blocks of size 2^( 7) =       0.000417504489

      target function =      -0.946851233502
              le_mean =     -17.212606032724
             les_mean =     296.552644431227
             stat err =       0.000413598250
             autocorr =       1.226973590306
   target nu stat err =       0.000413598250
   target dn stat err =       0.002450010578
      target stat err =       0.004243368573
              std dev =       0.528051259718
             le_variance =       0.278838132890


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946851233502        initial  <--
     1.4552e+07     1.4552e+08             5.5871e-11        -0.946851233500
     5.8208e+07     5.8208e+08             1.3968e-11        -0.946851233501
     2.3283e+08     2.3283e+09             3.4916e-12        -0.946851233502

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0231
  </log>
  <optVariables href="H2O.s040.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4893e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.1935
    reference variance = 0.237433
====================================================
  Execution time = 2.2386e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8035e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5368e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280370967017
                                         uncertainty =       0.002349657310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280370967017
                                         uncertainty =       0.002349657310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374397980
  error estimate for blocks of size 2^( 2) =       0.000387943744
  error estimate for blocks of size 2^( 3) =       0.000400467649
  error estimate for blocks of size 2^( 4) =       0.000409790707
  error estimate for blocks of size 2^( 5) =       0.000414612088
  error estimate for blocks of size 2^( 6) =       0.000416587973
  error estimate for blocks of size 2^( 7) =       0.000418639473

      target function =      -0.944282924948
              le_mean =     -17.212445055620
             les_mean =     296.548612347215
             stat err =       0.000414907560
             autocorr =       1.228105576825
   target nu stat err =       0.000414907560
   target dn stat err =       0.002672508927
      target stat err =       0.004591640844
              std dev =       0.529478700833
             le_variance =       0.280347694636


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721244505562e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+08, overlap shift 1.4552e+09 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944304355077       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944304355077       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944304355077       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944304514619       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944304355077       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944304355077       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944304178419       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944304355077       residual = 8.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944304355077       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944304355077       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944304222422       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944304051982       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944304355077       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944304267216       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944304059557       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944304530571       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944305113888       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944304820960       residual = 6.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944303923900       residual = 4.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944304315579       residual = 2.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944304428226       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944304109431       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944304159320       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944304707798       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+08 is 3.790982e-12

solving harmonic davidson linear method for identity shift 5.8208e+08, overlap shift 5.8208e+09 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944304355077       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944304355077       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944304355077       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944304355077       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944304355077       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944304355077       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944304355077       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944304355077       residual = 8.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944304355077       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944304355077       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944303341310       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944304355077       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944305593171       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944304430192       residual = 6.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944304355077       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944304355077       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944304355077       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944304355077       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944304355077       residual = 4.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944304355077       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944304355077       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944305162870       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944305684770       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944304131245       residual = 5.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+08 is 9.470671e-13

solving harmonic davidson linear method for identity shift 2.3283e+09, overlap shift 2.3283e+10 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944304355077       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944304355077       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944304355077       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944304355077       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944304355077       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944304355077       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944305341213       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944307996896       residual = 8.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944300389608       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944304355077       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944307054384       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944297204503       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944293214586       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944304324854       residual = 6.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944301424829       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944308680395       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944302144712       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944309652260       residual = 5.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944310886848       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944304370931       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944295704702       residual = 2.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944305994356       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944306022372       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944313467111       residual = 9.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+09 is 2.370811e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.846030 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7952e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.2229
    reference variance = 0.136671
====================================================
  Execution time = 1.9609e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8275e-01
  Total weights = 2.0000e+06
  Execution time = 1.8518e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282680767962
                                         uncertainty =       0.003977691129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282680767962
                                         uncertainty =       0.003977691129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376001346
  error estimate for blocks of size 2^( 2) =       0.000389549239
  error estimate for blocks of size 2^( 3) =       0.000402380695
  error estimate for blocks of size 2^( 4) =       0.000411659158
  error estimate for blocks of size 2^( 5) =       0.000417331260
  error estimate for blocks of size 2^( 6) =       0.000420405884
  error estimate for blocks of size 2^( 7) =       0.000418681258

      target function =      -0.940204135752
              le_mean =     -17.212119218637
             les_mean =     296.539801879610
             stat err =       0.000417019390
             autocorr =       1.230080965472
   target nu stat err =       0.000417019390
   target dn stat err =       0.003839962804
      target stat err =       0.006492974093
              std dev =       0.531746203023
             le_variance =       0.282754024429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282680767962
                                         uncertainty =       0.003977691129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282680767962
                                         uncertainty =       0.003977691129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376001346
  error estimate for blocks of size 2^( 2) =       0.000389549239
  error estimate for blocks of size 2^( 3) =       0.000402380695
  error estimate for blocks of size 2^( 4) =       0.000411659158
  error estimate for blocks of size 2^( 5) =       0.000417331260
  error estimate for blocks of size 2^( 6) =       0.000420405884
  error estimate for blocks of size 2^( 7) =       0.000418681258

      target function =      -0.940204135751
              le_mean =     -17.212119218637
             les_mean =     296.539801879609
             stat err =       0.000417019390
             autocorr =       1.230080965470
   target nu stat err =       0.000417019390
   target dn stat err =       0.003839962804
      target stat err =       0.006492974093
              std dev =       0.531746203023
             le_variance =       0.282754024429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282680767962
                                         uncertainty =       0.003977691129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282680767962
                                         uncertainty =       0.003977691129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376001346
  error estimate for blocks of size 2^( 2) =       0.000389549239
  error estimate for blocks of size 2^( 3) =       0.000402380695
  error estimate for blocks of size 2^( 4) =       0.000411659158
  error estimate for blocks of size 2^( 5) =       0.000417331260
  error estimate for blocks of size 2^( 6) =       0.000420405884
  error estimate for blocks of size 2^( 7) =       0.000418681258

      target function =      -0.940204135752
              le_mean =     -17.212119218637
             les_mean =     296.539801879609
             stat err =       0.000417019390
             autocorr =       1.230080965472
   target nu stat err =       0.000417019390
   target dn stat err =       0.003839962804
      target stat err =       0.006492974093
              std dev =       0.531746203023
             le_variance =       0.282754024429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282680767962
                                         uncertainty =       0.003977691129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282680767962
                                         uncertainty =       0.003977691129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376001346
  error estimate for blocks of size 2^( 2) =       0.000389549239
  error estimate for blocks of size 2^( 3) =       0.000402380695
  error estimate for blocks of size 2^( 4) =       0.000411659158
  error estimate for blocks of size 2^( 5) =       0.000417331260
  error estimate for blocks of size 2^( 6) =       0.000420405884
  error estimate for blocks of size 2^( 7) =       0.000418681258

      target function =      -0.940204135752
              le_mean =     -17.212119218637
             les_mean =     296.539801879610
             stat err =       0.000417019390
             autocorr =       1.230080965468
   target nu stat err =       0.000417019390
   target dn stat err =       0.003839962804
      target stat err =       0.006492974093
              std dev =       0.531746203023
             le_variance =       0.282754024429


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940204135752        initial  <--
     1.4552e+08     1.4552e+09             3.7910e-12        -0.940204135751
     5.8208e+08     5.8208e+09             9.4707e-13        -0.940204135752
     2.3283e+09     2.3283e+10             2.3708e-13        -0.940204135752

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8461
  </log>
  <optVariables href="H2O.s041.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6804e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2498
    reference variance = 0.137741
====================================================
  Execution time = 1.9959e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7910e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5555e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279055656215
                                         uncertainty =       0.002779054452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279055656215
                                         uncertainty =       0.002779054452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373566124
  error estimate for blocks of size 2^( 2) =       0.000387307047
  error estimate for blocks of size 2^( 3) =       0.000399914624
  error estimate for blocks of size 2^( 4) =       0.000408775354
  error estimate for blocks of size 2^( 5) =       0.000414110618
  error estimate for blocks of size 2^( 6) =       0.000416863116
  error estimate for blocks of size 2^( 7) =       0.000420841950

      target function =      -0.946393870904
              le_mean =     -17.212319847446
             les_mean =     296.543057688687
             stat err =       0.000415147760
             autocorr =       1.235009860748
   target nu stat err =       0.000415147760
   target dn stat err =       0.002946832312
      target stat err =       0.005072357778
              std dev =       0.528302278473
             le_variance =       0.279103297440


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721231984745e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+09, overlap shift 1.4552e+10 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946419776384       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946419776384       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946419776384       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946419776384       residual = 7.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946419776384       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946419776384       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946419776384       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946419776384       residual = 9.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946419776384       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946419887928       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946418854450       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946419566729       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946419776384       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946415149241       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946416345196       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946418019565       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946418042291       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946420972116       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946420391843       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946416020323       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946421881600       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946424213455       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946424581554       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946421038073       residual = 7.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+09 is 4.110820e-13

solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946419776384       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946419776384       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946419776384       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946419776384       residual = 7.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946419776384       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946419776384       residual = 3.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946431604823       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946419776384       residual = 9.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946419776384       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946419776384       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946419776384       residual = 4.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946424930140       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946419776384       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946403999234       residual = 9.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946421243343       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946439996010       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946403279944       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946421323140       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946450868760       residual = 3.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946418972282       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946410482160       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946441351212       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946422537354       residual = 6.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946431417727       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.946392690009       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.946433450769       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.946442047927       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.946408814658       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.946422185384       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.946382504949       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.946404628589       residual = 8.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.946469233731       residual = 6.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.946532882642       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.946842040975       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.946872225541       residual = 3.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.946106892537       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.946731573967       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.946464480622       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.945181910125       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.947470313144       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.945777115206       residual = 1.03e-04           smallest_sin_value = 9.92e-01
davidson iteration   41 stopping due to small subspace S singular value of 7.62e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+09 is 1.053027e-13

solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946419776384       residual = 1.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946419776384       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946419776384       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946419776384       residual = 7.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946419776384       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946419776384       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946419776384       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946419776384       residual = 9.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946419776384       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946435276030       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946414116005       residual = 4.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946419776384       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946392184862       residual = 8.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946419776384       residual = 9.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946345989452       residual = 5.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946407346612       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946418743610       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946396295065       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946426810767       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946420274574       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946461318531       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946502099280       residual = 1.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946353991177       residual = 6.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946384933975       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.946313599972       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.946411954341       residual = 6.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.946362805272       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.946420339499       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.946362698461       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.946091999677       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.946563954086       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.946267184810       residual = 6.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.947138948373       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.946645704145       residual = 7.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.948115069318       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.946339514785       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.938912500637       residual = 5.28e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.943027084862       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.948317063027       residual = 8.18e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.947125094228       residual = 4.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   40 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+10 is 2.570556e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.903361 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5584e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2154
    reference variance = 0.163741
====================================================
  Execution time = 1.9596e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9611e-01
  Total weights = 2.0000e+06
  Execution time = 1.8144e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296136539799
                                         uncertainty =       0.014227313553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296136539799
                                         uncertainty =       0.014227313553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384779233
  error estimate for blocks of size 2^( 2) =       0.000398095545
  error estimate for blocks of size 2^( 3) =       0.000410192713
  error estimate for blocks of size 2^( 4) =       0.000419463151
  error estimate for blocks of size 2^( 5) =       0.000425932340
  error estimate for blocks of size 2^( 6) =       0.000428338375
  error estimate for blocks of size 2^( 7) =       0.000431672302

      target function =      -0.917801046490
              le_mean =     -17.211556821347
             les_mean =     296.533798182545
             stat err =       0.000426351542
             autocorr =       1.227757021160
   target nu stat err =       0.000426351542
   target dn stat err =       0.014225986347
      target stat err =       0.022771365670
              std dev =       0.544160009678
             le_variance =       0.296110116133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296136539799
                                         uncertainty =       0.014227313553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296136539799
                                         uncertainty =       0.014227313553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384779233
  error estimate for blocks of size 2^( 2) =       0.000398095545
  error estimate for blocks of size 2^( 3) =       0.000410192713
  error estimate for blocks of size 2^( 4) =       0.000419463151
  error estimate for blocks of size 2^( 5) =       0.000425932340
  error estimate for blocks of size 2^( 6) =       0.000428338375
  error estimate for blocks of size 2^( 7) =       0.000431672302

      target function =      -0.917801046490
              le_mean =     -17.211556821347
             les_mean =     296.533798182545
             stat err =       0.000426351542
             autocorr =       1.227757021152
   target nu stat err =       0.000426351542
   target dn stat err =       0.014225986347
      target stat err =       0.022771365670
              std dev =       0.544160009678
             le_variance =       0.296110116133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296136539799
                                         uncertainty =       0.014227313553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296136539799
                                         uncertainty =       0.014227313553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384779233
  error estimate for blocks of size 2^( 2) =       0.000398095545
  error estimate for blocks of size 2^( 3) =       0.000410192713
  error estimate for blocks of size 2^( 4) =       0.000419463151
  error estimate for blocks of size 2^( 5) =       0.000425932340
  error estimate for blocks of size 2^( 6) =       0.000428338375
  error estimate for blocks of size 2^( 7) =       0.000431672302

      target function =      -0.917801046490
              le_mean =     -17.211556821347
             les_mean =     296.533798182545
             stat err =       0.000426351542
             autocorr =       1.227757021160
   target nu stat err =       0.000426351542
   target dn stat err =       0.014225986347
      target stat err =       0.022771365670
              std dev =       0.544160009678
             le_variance =       0.296110116133

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296136539799
                                         uncertainty =       0.014227313553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296136539799
                                         uncertainty =       0.014227313553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384779233
  error estimate for blocks of size 2^( 2) =       0.000398095545
  error estimate for blocks of size 2^( 3) =       0.000410192713
  error estimate for blocks of size 2^( 4) =       0.000419463151
  error estimate for blocks of size 2^( 5) =       0.000425932340
  error estimate for blocks of size 2^( 6) =       0.000428338375
  error estimate for blocks of size 2^( 7) =       0.000431672302

      target function =      -0.917801046490
              le_mean =     -17.211556821347
             les_mean =     296.533798182545
             stat err =       0.000426351542
             autocorr =       1.227757021160
   target nu stat err =       0.000426351542
   target dn stat err =       0.014225986347
      target stat err =       0.022771365670
              std dev =       0.544160009678
             le_variance =       0.296110116133


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.917801046490        initial
     1.4552e+09     1.4552e+10             4.1108e-13        -0.917801046490
     5.8208e+09     5.8208e+10             1.0530e-13        -0.917801046490
     2.3283e+10     2.3283e+11             2.5706e-14        -0.917801046490  <--

*****************************************************************************
Applying the update for shift_i =   2.3283e+10     and shift_s =   2.3283e+11
*****************************************************************************

  Execution time = 2.8803e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4393e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.1551
    reference variance = 0.24099
====================================================
  Execution time = 2.0181e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8000e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5857e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279987746425
                                         uncertainty =       0.002281888247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279987746425
                                         uncertainty =       0.002281888247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374168222
  error estimate for blocks of size 2^( 2) =       0.000387952264
  error estimate for blocks of size 2^( 3) =       0.000399956733
  error estimate for blocks of size 2^( 4) =       0.000409041680
  error estimate for blocks of size 2^( 5) =       0.000414421920
  error estimate for blocks of size 2^( 6) =       0.000416619820
  error estimate for blocks of size 2^( 7) =       0.000419146902

      target function =      -0.944865717895
              le_mean =     -17.212619221562
             les_mean =     296.554264042837
             stat err =       0.000414807580
             autocorr =       1.229021749019
   target nu stat err =       0.000414807580
   target dn stat err =       0.002597903434
      target stat err =       0.004473766312
              std dev =       0.529153773816
             le_variance =       0.280003716343


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721261922156e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944885945929       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944885945929       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944885945929       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944885945929       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944885945929       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944885945929       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944885945929       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944880005481       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944885945929       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944885945929       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944882873911       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944885945929       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944885945929       residual = 8.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944885945929       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944893852804       residual = 3.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944897743306       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944929131161       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944880627412       residual = 9.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944871128572       residual = 6.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944879676451       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944875164659       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944865613194       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944899851284       residual = 6.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944897142909       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.944864909501       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.944914258662       residual = 9.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.944903035617       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.944904606097       residual = 6.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.944962327171       residual = 6.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.944893376069       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.944898389732       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.944879136632       residual = 2.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.944822028056       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.945096420219       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.944778301962       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.945198726372       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.945894114423       residual = 9.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.945400790085       residual = 8.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.944839847264       residual = 5.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.945745165446       residual = 1.20e-04           smallest_sin_value = 9.99e-01
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.940526181948       residual = 2.10e-03           smallest_sin_value = 9.98e-01
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.945852897188       residual = 4.87e-04           smallest_sin_value = 9.98e-01
davidson iteration   42 stopping due to small subspace S singular value of 8.95e-01
davidson solver did not converge after         42 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+09 is 8.890196e-14

solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944885945929       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944885945929       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944885945929       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944869328092       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944871152436       residual = 3.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944885945929       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944885945929       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944885945929       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944891588729       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944878614951       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944868573251       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944832568350       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944885945929       residual = 8.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944892053160       residual = 4.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944903246247       residual = 3.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944840876091       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944864353594       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944885945929       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944884709940       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944837393033       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944929293159       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944866490932       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944847607730       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944900471314       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.944864388306       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.944851867662       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.944876064707       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.944903536920       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.945321806943       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.944244618037       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.945108828874       residual = 8.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.945260034003       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.945057281181       residual = 2.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.944523254471       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.943898609628       residual = 8.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.945269832998       residual = 8.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.945999687521       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.943862557283       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.950016470306       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.946136608726       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.941288248516       residual = 2.34e-03           smallest_sin_value = 9.92e-01
davidson iteration   41 stopping due to small subspace S singular value of 8.37e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+10 is 2.218847e-14

solving harmonic davidson linear method for identity shift 9.3132e+10, overlap shift 9.3132e+11 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944885945929       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944885945929       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944885945929       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944904710772       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944885945929       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944884960446       residual = 2.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944722098692       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944917889448       residual = 1.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945007854782       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944810100199       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944730865156       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944951454012       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945079992044       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944776469649       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944715211393       residual = 5.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944844734718       residual = 3.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944099138276       residual = 5.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944694606993       residual = 4.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945051942257       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945114876127       residual = 7.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944768306170       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945692190835       residual = 6.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944621550745       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944173110875       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.944043808375       residual = 5.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.945410223276       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.942462156847       residual = 5.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.943757387083       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.943631035509       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.941771497252       residual = 8.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.945540356183       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.946594829627       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.942557730522       residual = 5.02e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.943076757599       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.945229401830       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.942835357961       residual = 6.12e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.947156216565       residual = 4.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.928361132499       residual = 2.19e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.922251725041       residual = 7.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.947663554977       residual = 2.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.916623259638       residual = 8.87e-02           smallest_sin_value = 9.99e-01
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.935827718022       residual = 3.49e-01           smallest_sin_value = 9.98e-01
davidson iteration   42 stopping due to small subspace S singular value of 7.30e-01
davidson solver did not converge after         42 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+10 is 5.632299e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.985980 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5861e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.1664
    reference variance = 0.171068
====================================================
  Execution time = 1.9986e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8006e-01
  Total weights = 2.0000e+06
  Execution time = 1.8111e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280129018451
                                         uncertainty =       0.002003267327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280129018451
                                         uncertainty =       0.002003267327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374206681
  error estimate for blocks of size 2^( 2) =       0.000388088987
  error estimate for blocks of size 2^( 3) =       0.000399590513
  error estimate for blocks of size 2^( 4) =       0.000408636300
  error estimate for blocks of size 2^( 5) =       0.000413527351
  error estimate for blocks of size 2^( 6) =       0.000415609980
  error estimate for blocks of size 2^( 7) =       0.000416633328

      target function =      -0.944781088537
              le_mean =     -17.212122825132
             les_mean =     296.537233287456
             stat err =       0.000413601740
             autocorr =       1.221635486716
   target nu stat err =       0.000413601740
   target dn stat err =       0.002062518435
      target stat err =       0.003576116344
              std dev =       0.529208163251
             le_variance =       0.280061280052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280129018451
                                         uncertainty =       0.002003267327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280129018451
                                         uncertainty =       0.002003267327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374206681
  error estimate for blocks of size 2^( 2) =       0.000388088987
  error estimate for blocks of size 2^( 3) =       0.000399590513
  error estimate for blocks of size 2^( 4) =       0.000408636300
  error estimate for blocks of size 2^( 5) =       0.000413527351
  error estimate for blocks of size 2^( 6) =       0.000415609980
  error estimate for blocks of size 2^( 7) =       0.000416633328

      target function =      -0.944781088537
              le_mean =     -17.212122825132
             les_mean =     296.537233287456
             stat err =       0.000413601740
             autocorr =       1.221635486707
   target nu stat err =       0.000413601740
   target dn stat err =       0.002062518435
      target stat err =       0.003576116344
              std dev =       0.529208163251
             le_variance =       0.280061280052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280129018451
                                         uncertainty =       0.002003267327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280129018451
                                         uncertainty =       0.002003267327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374206681
  error estimate for blocks of size 2^( 2) =       0.000388088987
  error estimate for blocks of size 2^( 3) =       0.000399590513
  error estimate for blocks of size 2^( 4) =       0.000408636300
  error estimate for blocks of size 2^( 5) =       0.000413527351
  error estimate for blocks of size 2^( 6) =       0.000415609980
  error estimate for blocks of size 2^( 7) =       0.000416633328

      target function =      -0.944781088537
              le_mean =     -17.212122825132
             les_mean =     296.537233287456
             stat err =       0.000413601740
             autocorr =       1.221635486704
   target nu stat err =       0.000413601740
   target dn stat err =       0.002062518435
      target stat err =       0.003576116344
              std dev =       0.529208163251
             le_variance =       0.280061280052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280129018451
                                         uncertainty =       0.002003267327

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280129018451
                                         uncertainty =       0.002003267327

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374206681
  error estimate for blocks of size 2^( 2) =       0.000388088987
  error estimate for blocks of size 2^( 3) =       0.000399590513
  error estimate for blocks of size 2^( 4) =       0.000408636300
  error estimate for blocks of size 2^( 5) =       0.000413527351
  error estimate for blocks of size 2^( 6) =       0.000415609980
  error estimate for blocks of size 2^( 7) =       0.000416633328

      target function =      -0.944781088537
              le_mean =     -17.212122825132
             les_mean =     296.537233287456
             stat err =       0.000413601740
             autocorr =       1.221635486714
   target nu stat err =       0.000413601740
   target dn stat err =       0.002062518435
      target stat err =       0.003576116344
              std dev =       0.529208163251
             le_variance =       0.280061280052


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.944781088537        initial
     5.8208e+09     5.8208e+10             8.8902e-14        -0.944781088537  <--
     2.3283e+10     2.3283e+11             2.2188e-14        -0.944781088537
     9.3132e+10     9.3132e+11             5.6323e-15        -0.944781088537

*****************************************************************************
Applying the update for shift_i =   5.8208e+09     and shift_s =   5.8208e+10
*****************************************************************************

  Execution time = 2.9153e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5019e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.2813
    reference variance = 0.290277
====================================================
  Execution time = 2.1996e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8194e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5204e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281972462310
                                         uncertainty =       0.004587659006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281972462310
                                         uncertainty =       0.004587659006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375459004
  error estimate for blocks of size 2^( 2) =       0.000388923574
  error estimate for blocks of size 2^( 3) =       0.000401691701
  error estimate for blocks of size 2^( 4) =       0.000410587380
  error estimate for blocks of size 2^( 5) =       0.000416121462
  error estimate for blocks of size 2^( 6) =       0.000419519651
  error estimate for blocks of size 2^( 7) =       0.000419789213

      target function =      -0.941541948067
              le_mean =     -17.212711432808
             les_mean =     296.559373655480
             stat err =       0.000416504427
             autocorr =       1.230592305735
   target nu stat err =       0.000416504427
   target dn stat err =       0.004730110844
      target stat err =       0.008011903334
              std dev =       0.530979215522
             le_variance =       0.281938927316


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721271143281e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+09, overlap shift 1.4552e+10 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941609650690       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941609650691       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941609650691       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941609650691       residual = 9.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941609650629       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941609651186       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941610041205       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941607858801       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941610422882       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941610255153       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941607577133       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941610127100       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941609994389       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941612517189       residual = 5.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941609975451       residual = 5.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941610023609       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941610691371       residual = 2.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941608755728       residual = 8.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941609449515       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941609061035       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941604333064       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941610590339       residual = 9.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941605968494       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941611424929       residual = 7.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4552e+09 is 3.919600e-13

solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941609650690       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941609650691       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941609650691       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941609511684       residual = 9.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941609650691       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941609676824       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941609323140       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941615384489       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941618056143       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941622264074       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941603841987       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941611923534       residual = 3.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941617970687       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941591547948       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941606577639       residual = 5.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941612101327       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941627655736       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941620731662       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941584106952       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941620901508       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941603943824       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941599134224       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941622010333       residual = 6.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941628658250       residual = 4.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.941596745250       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.941613572536       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.941547447612       residual = 2.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.941581223273       residual = 6.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.941601482631       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.941650097195       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.941539092950       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.941497154920       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.941593717377       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.941408967960       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.941365825271       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.940382872993       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.941296032146       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.941562680858       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.940993897826       residual = 6.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.941420013701       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.940355321736       residual = 6.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   41 stopping due to small subspace S singular value of 9.71e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+09 is 9.750088e-14

solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941609650690       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941609650690       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941609650690       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941609650690       residual = 9.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941609650691       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941609650692       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941607503889       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941616487905       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941601618763       residual = 4.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941613779853       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941693112705       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941508616494       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941640173819       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941609975632       residual = 5.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941603420528       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941644559999       residual = 2.56e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941605442344       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941627786633       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941576170433       residual = 8.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941635165193       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941613639186       residual = 5.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941626503564       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941643174059       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941584678837       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.941557633743       residual = 7.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.941554885694       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.941602596586       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.941692870178       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.941567961539       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.941489424155       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.941913035114       residual = 9.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.941806096201       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.941800121430       residual = 5.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.940800740502       residual = 8.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.941965853761       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.942212466615       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.943545955495       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.937936155851       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.943580357569       residual = 7.75e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.942177882952       residual = 2.20e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.948303875676       residual = 6.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   41 stopping due to small subspace S singular value of 9.78e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+10 is 2.493491e-14

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.043825 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7585e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.1781
    reference variance = 0.250626
====================================================
  Execution time = 1.9729e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9103e-01
  Total weights = 2.0000e+06
  Execution time = 1.8089e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291110583656
                                         uncertainty =       0.009430528948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291110583656
                                         uncertainty =       0.009430528948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381463586
  error estimate for blocks of size 2^( 2) =       0.000394945344
  error estimate for blocks of size 2^( 3) =       0.000407061390
  error estimate for blocks of size 2^( 4) =       0.000416342938
  error estimate for blocks of size 2^( 5) =       0.000421008616
  error estimate for blocks of size 2^( 6) =       0.000423279546
  error estimate for blocks of size 2^( 7) =       0.000422859039

      target function =      -0.926294580593
              le_mean =     -17.211865401647
             les_mean =     296.539339393283
             stat err =       0.000420872535
             autocorr =       1.217292645103
   target nu stat err =       0.000420872535
   target dn stat err =       0.009625010016
      target stat err =       0.015706248981
              std dev =       0.539470976407
             le_variance =       0.291028934385

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291110583656
                                         uncertainty =       0.009430528948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291110583656
                                         uncertainty =       0.009430528948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381463586
  error estimate for blocks of size 2^( 2) =       0.000394945344
  error estimate for blocks of size 2^( 3) =       0.000407061390
  error estimate for blocks of size 2^( 4) =       0.000416342938
  error estimate for blocks of size 2^( 5) =       0.000421008616
  error estimate for blocks of size 2^( 6) =       0.000423279546
  error estimate for blocks of size 2^( 7) =       0.000422859039

      target function =      -0.926294580593
              le_mean =     -17.211865401647
             les_mean =     296.539339393283
             stat err =       0.000420872535
             autocorr =       1.217292645106
   target nu stat err =       0.000420872535
   target dn stat err =       0.009625010016
      target stat err =       0.015706248981
              std dev =       0.539470976407
             le_variance =       0.291028934385

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291110583656
                                         uncertainty =       0.009430528948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291110583656
                                         uncertainty =       0.009430528948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381463586
  error estimate for blocks of size 2^( 2) =       0.000394945344
  error estimate for blocks of size 2^( 3) =       0.000407061390
  error estimate for blocks of size 2^( 4) =       0.000416342938
  error estimate for blocks of size 2^( 5) =       0.000421008616
  error estimate for blocks of size 2^( 6) =       0.000423279546
  error estimate for blocks of size 2^( 7) =       0.000422859039

      target function =      -0.926294580593
              le_mean =     -17.211865401647
             les_mean =     296.539339393283
             stat err =       0.000420872535
             autocorr =       1.217292645102
   target nu stat err =       0.000420872535
   target dn stat err =       0.009625010016
      target stat err =       0.015706248981
              std dev =       0.539470976407
             le_variance =       0.291028934385

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291110583656
                                         uncertainty =       0.009430528948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291110583656
                                         uncertainty =       0.009430528948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381463586
  error estimate for blocks of size 2^( 2) =       0.000394945344
  error estimate for blocks of size 2^( 3) =       0.000407061390
  error estimate for blocks of size 2^( 4) =       0.000416342938
  error estimate for blocks of size 2^( 5) =       0.000421008616
  error estimate for blocks of size 2^( 6) =       0.000423279546
  error estimate for blocks of size 2^( 7) =       0.000422859039

      target function =      -0.926294580593
              le_mean =     -17.211865401647
             les_mean =     296.539339393283
             stat err =       0.000420872535
             autocorr =       1.217292645106
   target nu stat err =       0.000420872535
   target dn stat err =       0.009625010016
      target stat err =       0.015706248981
              std dev =       0.539470976407
             le_variance =       0.291028934385


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926294580593        initial
     1.4552e+09     1.4552e+10             3.9196e-13        -0.926294580593
     5.8208e+09     5.8208e+10             9.7501e-14        -0.926294580593
     2.3283e+10     2.3283e+11             2.4935e-14        -0.926294580593  <--

*****************************************************************************
Applying the update for shift_i =   2.3283e+10     and shift_s =   2.3283e+11
*****************************************************************************

  Execution time = 2.8917e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6508e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.2135
    reference variance = 0.269891
====================================================
  Execution time = 2.0082e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8596e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6129e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285953890813
                                         uncertainty =       0.005406004204

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285953890813
                                         uncertainty =       0.005406004204

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378127787
  error estimate for blocks of size 2^( 2) =       0.000391333193
  error estimate for blocks of size 2^( 3) =       0.000403137807
  error estimate for blocks of size 2^( 4) =       0.000411832682
  error estimate for blocks of size 2^( 5) =       0.000416914942
  error estimate for blocks of size 2^( 6) =       0.000420273252
  error estimate for blocks of size 2^( 7) =       0.000423449263

      target function =      -0.934801743071
              le_mean =     -17.212271878596
             les_mean =     296.548264326046
             stat err =       0.000418117535
             autocorr =       1.222699055911
   target nu stat err =       0.000418117535
   target dn stat err =       0.005396511764
      target stat err =       0.008994528134
              std dev =       0.534753444429
             le_variance =       0.285961246329


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721227187860e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934887264466       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934887264466       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934887264466       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934885813393       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934885962796       residual = 5.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934882848812       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934880462772       residual = 4.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934885736126       residual = 7.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934889491712       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934903585982       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934886278297       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934879445550       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934889582260       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934878836565       residual = 5.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934911887450       residual = 5.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934883762405       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934900801214       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934872593963       residual = 9.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934888431919       residual = 6.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934881201096       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934883529990       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934891530612       residual = 8.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934895209090       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934868878987       residual = 6.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934876734532       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.934866224207       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.934882371297       residual = 6.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         26 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+09 is 1.107298e-13

solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934887264466       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934887264466       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934887264466       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934887264466       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934888188231       residual = 5.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934889002488       residual = 5.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934914980993       residual = 4.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934901658835       residual = 7.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934902790133       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934844841718       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934935302689       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.934867575205       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934898653861       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.934865808545       residual = 5.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.934832783586       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.934902236481       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934876820190       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934941996592       residual = 1.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934907217826       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934935836757       residual = 7.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934860888008       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934902158099       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934997465227       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934869357601       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934859745715       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.934942555560       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.934896765207       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.934856873587       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.935024976006       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.935069203939       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.934783237149       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.934986553348       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.935161001532       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.935548511805       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.935085194589       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.935723160732       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.936150620386       residual = 9.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.951847168934       residual = 2.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.939588520037       residual = 8.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.937600000832       residual = 4.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.935721394636       residual = 1.74e-03           smallest_sin_value = 9.98e-01
davidson iteration   41 stopping due to small subspace S singular value of 9.18e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+10 is 2.744978e-14

solving harmonic davidson linear method for identity shift 9.3132e+10, overlap shift 9.3132e+11 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934887264466       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934887264466       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934887264466       residual = 1.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934893502270       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934857761053       residual = 5.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934887264466       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934789985441       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934843401551       residual = 7.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.935077055602       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934887264466       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934964356903       residual = 4.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.935085352238       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.934633904589       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.935036835968       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.935123026486       residual = 8.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.935009973554       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.934917162040       residual = 3.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.934623517743       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.934832268941       residual = 5.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.934750296510       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.934682785587       residual = 7.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.934783856864       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.934492764949       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.934962210757       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.934915759004       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.934420820821       residual = 2.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.934747001069       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.934853335091       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.935021348775       residual = 9.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.935381087483       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.935087370484       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.931009049810       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.931886298145       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.934571385475       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.935377015799       residual = 5.51e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.945667432262       residual = 1.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.946751178450       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.951342341857       residual = 2.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.931736713552       residual = 1.92e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.925039280743       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.928180864876       residual = 3.30e-02           smallest_sin_value = 9.99e-01
davidson iteration   41 stopping due to small subspace S singular value of 9.40e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+10 is 6.767569e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.104874 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5767e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.2177
    reference variance = 0.23289
====================================================
  Execution time = 1.9850e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8286e-01
  Total weights = 2.0000e+06
  Execution time = 1.8095e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282872053344
                                         uncertainty =       0.003277609358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282872053344
                                         uncertainty =       0.003277609358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376073417
  error estimate for blocks of size 2^( 2) =       0.000389796412
  error estimate for blocks of size 2^( 3) =       0.000402358225
  error estimate for blocks of size 2^( 4) =       0.000411974538
  error estimate for blocks of size 2^( 5) =       0.000418176827
  error estimate for blocks of size 2^( 6) =       0.000421291108
  error estimate for blocks of size 2^( 7) =       0.000423977850

      target function =      -0.940037198985
              le_mean =     -17.211953303206
             les_mean =     296.534198799941
             stat err =       0.000418855081
             autocorr =       1.240458684494
   target nu stat err =       0.000418855081
   target dn stat err =       0.003317277141
      target stat err =       0.005618320300
              std dev =       0.531848126471
             le_variance =       0.282862429631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282872053344
                                         uncertainty =       0.003277609358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282872053344
                                         uncertainty =       0.003277609358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376073417
  error estimate for blocks of size 2^( 2) =       0.000389796412
  error estimate for blocks of size 2^( 3) =       0.000402358225
  error estimate for blocks of size 2^( 4) =       0.000411974538
  error estimate for blocks of size 2^( 5) =       0.000418176827
  error estimate for blocks of size 2^( 6) =       0.000421291108
  error estimate for blocks of size 2^( 7) =       0.000423977850

      target function =      -0.940037198985
              le_mean =     -17.211953303206
             les_mean =     296.534198799941
             stat err =       0.000418855081
             autocorr =       1.240458684497
   target nu stat err =       0.000418855081
   target dn stat err =       0.003317277141
      target stat err =       0.005618320300
              std dev =       0.531848126471
             le_variance =       0.282862429631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282872053344
                                         uncertainty =       0.003277609358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282872053344
                                         uncertainty =       0.003277609358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376073417
  error estimate for blocks of size 2^( 2) =       0.000389796412
  error estimate for blocks of size 2^( 3) =       0.000402358225
  error estimate for blocks of size 2^( 4) =       0.000411974538
  error estimate for blocks of size 2^( 5) =       0.000418176827
  error estimate for blocks of size 2^( 6) =       0.000421291108
  error estimate for blocks of size 2^( 7) =       0.000423977850

      target function =      -0.940037198985
              le_mean =     -17.211953303206
             les_mean =     296.534198799941
             stat err =       0.000418855081
             autocorr =       1.240458684499
   target nu stat err =       0.000418855081
   target dn stat err =       0.003317277141
      target stat err =       0.005618320300
              std dev =       0.531848126471
             le_variance =       0.282862429631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282872053344
                                         uncertainty =       0.003277609358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282872053344
                                         uncertainty =       0.003277609358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376073417
  error estimate for blocks of size 2^( 2) =       0.000389796412
  error estimate for blocks of size 2^( 3) =       0.000402358225
  error estimate for blocks of size 2^( 4) =       0.000411974538
  error estimate for blocks of size 2^( 5) =       0.000418176827
  error estimate for blocks of size 2^( 6) =       0.000421291108
  error estimate for blocks of size 2^( 7) =       0.000423977850

      target function =      -0.940037198985
              le_mean =     -17.211953303206
             les_mean =     296.534198799941
             stat err =       0.000418855081
             autocorr =       1.240458684498
   target nu stat err =       0.000418855081
   target dn stat err =       0.003317277141
      target stat err =       0.005618320300
              std dev =       0.531848126471
             le_variance =       0.282862429631


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940037198985        initial
     5.8208e+09     5.8208e+10             1.1073e-13        -0.940037198985
     2.3283e+10     2.3283e+11             2.7450e-14        -0.940037198985
     9.3132e+10     9.3132e+11             6.7676e-15        -0.940037198985  <--

*****************************************************************************
Applying the update for shift_i =   9.3132e+10     and shift_s =   9.3132e+11
*****************************************************************************

  Execution time = 2.9005e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4778e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.1606
    reference variance = 0.137767
====================================================
  Execution time = 2.0262e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7929e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.9996e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279276901976
                                         uncertainty =       0.001879476856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279276901976
                                         uncertainty =       0.001879476856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373691880
  error estimate for blocks of size 2^( 2) =       0.000387639941
  error estimate for blocks of size 2^( 3) =       0.000399962268
  error estimate for blocks of size 2^( 4) =       0.000409239149
  error estimate for blocks of size 2^( 5) =       0.000415381875
  error estimate for blocks of size 2^( 6) =       0.000416884737
  error estimate for blocks of size 2^( 7) =       0.000419398548

      target function =      -0.946085020399
              le_mean =     -17.212668001850
             les_mean =     296.555230844226
             stat err =       0.000415226077
             autocorr =       1.234644481000
   target nu stat err =       0.000415226077
   target dn stat err =       0.002026672224
      target stat err =       0.003530434796
              std dev =       0.528480124465
             le_variance =       0.279291241955


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721266800185e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946096848391       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946096848391       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946096848391       residual = 9.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946096848391       residual = 8.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946096848487       residual = 3.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946096848464       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946099782902       residual = 3.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946102839008       residual = 8.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946053476488       residual = 2.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946106742497       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946132819662       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946113881188       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946028667696       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946029235092       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946108641891       residual = 4.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946054583113       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946125412218       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946136109104       residual = 1.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946140683509       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946077944524       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946163493827       residual = 7.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946139708393       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946032903547       residual = 4.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945934494090       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.946109554024       residual = 5.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.946114785972       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.945779619888       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.946013285664       residual = 6.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.945745234219       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.945958066586       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.946318703374       residual = 7.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.946308773638       residual = 4.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.946054235891       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.946756690261       residual = 8.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.943196203182       residual = 2.56e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.944049138732       residual = 3.96e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.947275466981       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.944096909459       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.945935198708       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.954948420123       residual = 1.63e-02           smallest_sin_value = 9.99e-01
davidson iteration   40 stopping due to small subspace S singular value of 9.87e-01
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+10 is 2.129223e-14

solving harmonic davidson linear method for identity shift 9.3132e+10, overlap shift 9.3132e+11 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946096848391       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946096848391       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946096848391       residual = 9.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946096848391       residual = 8.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946096848501       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946096913376       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946196449593       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946062362280       residual = 8.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946358844416       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946303766078       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945973416100       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946193451427       residual = 2.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946336785320       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946124261597       residual = 7.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.945868797299       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946106126349       residual = 6.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946210757968       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946186427471       residual = 3.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945826402518       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946187283187       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946288822414       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945683921722       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945686056157       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946037908411       residual = 1.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.946256392853       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.945454525018       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.945895263665       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.945197300850       residual = 7.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.948113716466       residual = 3.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.946020088096       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.942604823857       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.945918410182       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.950867894390       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.947524059831       residual = 3.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.932755163988       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.956439736522       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.942562600649       residual = 3.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.928912820609       residual = 6.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.983816886475       residual = 2.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.903902155182       residual = 2.33e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.957655948404       residual = 5.94e-02           smallest_sin_value = 9.97e-01
davidson iteration   41 stopping due to small subspace S singular value of 9.79e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+10 is 5.574530e-15

solving harmonic davidson linear method for identity shift 3.7253e+11, overlap shift 3.7253e+12 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946096848391       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946096848391       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946096848391       residual = 9.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946096848391       residual = 8.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946096848391       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946096859346       residual = 3.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946105630506       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946699952493       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946263158176       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946312060388       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.947529120208       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946213995690       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945161287981       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945666194339       residual = 5.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944637495155       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945559732288       residual = 5.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944182890207       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946570129922       residual = 9.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946026729804       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.948601250237       residual = 6.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944829756511       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.947899916970       residual = 3.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944682890065       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946086579963       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.946720472402       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.950212379620       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.946220766173       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.951384009421       residual = 2.84e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.944042179518       residual = 2.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.942279627034       residual = 3.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.939985623104       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.936209863106       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.915375068802       residual = 9.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.885328280159       residual = 4.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.943203462277       residual = 1.02e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.678640365951       residual = 7.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.079625773701       residual = 3.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.988214030514       residual = 7.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.983248254193       residual = 1.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.916141142900       residual = 1.44e+00           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.879570982964       residual = 1.40e+00           smallest_sin_value = 9.92e-01
davidson iteration   41 stopping due to small subspace S singular value of 8.39e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+11 is 1.170189e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.181534 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7548e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.2123
    reference variance = 0.181935
====================================================
  Execution time = 2.0052e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8676e-01
  Total weights = 2.0000e+06
  Execution time = 1.8169e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286798210160
                                         uncertainty =       0.008046017678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286798210160
                                         uncertainty =       0.008046017678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378652778
  error estimate for blocks of size 2^( 2) =       0.000392573450
  error estimate for blocks of size 2^( 3) =       0.000404293338
  error estimate for blocks of size 2^( 4) =       0.000413044384
  error estimate for blocks of size 2^( 5) =       0.000418658076
  error estimate for blocks of size 2^( 6) =       0.000422012260
  error estimate for blocks of size 2^( 7) =       0.000425910738

      target function =      -0.933382968399
              le_mean =     -17.212165350596
             les_mean =     296.545391765406
             stat err =       0.000419906365
             autocorr =       1.229766392600
   target nu stat err =       0.000419906365
   target dn stat err =       0.008081052024
      target stat err =       0.013401694171
              std dev =       0.535495894022
             le_variance =       0.286755852514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286798210160
                                         uncertainty =       0.008046017678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286798210160
                                         uncertainty =       0.008046017678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378652778
  error estimate for blocks of size 2^( 2) =       0.000392573450
  error estimate for blocks of size 2^( 3) =       0.000404293338
  error estimate for blocks of size 2^( 4) =       0.000413044384
  error estimate for blocks of size 2^( 5) =       0.000418658076
  error estimate for blocks of size 2^( 6) =       0.000422012260
  error estimate for blocks of size 2^( 7) =       0.000425910738

      target function =      -0.933382968399
              le_mean =     -17.212165350596
             les_mean =     296.545391765406
             stat err =       0.000419906365
             autocorr =       1.229766392597
   target nu stat err =       0.000419906365
   target dn stat err =       0.008081052024
      target stat err =       0.013401694171
              std dev =       0.535495894022
             le_variance =       0.286755852514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286798210160
                                         uncertainty =       0.008046017678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286798210160
                                         uncertainty =       0.008046017678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378652778
  error estimate for blocks of size 2^( 2) =       0.000392573450
  error estimate for blocks of size 2^( 3) =       0.000404293338
  error estimate for blocks of size 2^( 4) =       0.000413044384
  error estimate for blocks of size 2^( 5) =       0.000418658076
  error estimate for blocks of size 2^( 6) =       0.000422012260
  error estimate for blocks of size 2^( 7) =       0.000425910738

      target function =      -0.933382968399
              le_mean =     -17.212165350596
             les_mean =     296.545391765406
             stat err =       0.000419906365
             autocorr =       1.229766392590
   target nu stat err =       0.000419906365
   target dn stat err =       0.008081052024
      target stat err =       0.013401694171
              std dev =       0.535495894022
             le_variance =       0.286755852514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286798210160
                                         uncertainty =       0.008046017678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286798210160
                                         uncertainty =       0.008046017678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378652778
  error estimate for blocks of size 2^( 2) =       0.000392573450
  error estimate for blocks of size 2^( 3) =       0.000404293338
  error estimate for blocks of size 2^( 4) =       0.000413044384
  error estimate for blocks of size 2^( 5) =       0.000418658076
  error estimate for blocks of size 2^( 6) =       0.000422012260
  error estimate for blocks of size 2^( 7) =       0.000425910738

      target function =      -0.933382968399
              le_mean =     -17.212165350596
             les_mean =     296.545391765406
             stat err =       0.000419906365
             autocorr =       1.229766392590
   target nu stat err =       0.000419906365
   target dn stat err =       0.008081052024
      target stat err =       0.013401694171
              std dev =       0.535495894022
             le_variance =       0.286755852514


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.933382968399        initial
     2.3283e+10     2.3283e+11             2.1292e-14        -0.933382968399
     9.3132e+10     9.3132e+11             5.5745e-15        -0.933382968399  <--
     3.7253e+11     3.7253e+12             1.1702e-15        -0.933382968399

*****************************************************************************
Applying the update for shift_i =   9.3132e+10     and shift_s =   9.3132e+11
*****************************************************************************

  Execution time = 2.9260e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6814e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2642
    reference variance = 0.496504
====================================================
  Execution time = 1.9990e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8243e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4705e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282475343236
                                         uncertainty =       0.003183633995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282475343236
                                         uncertainty =       0.003183633995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375785290
  error estimate for blocks of size 2^( 2) =       0.000389377502
  error estimate for blocks of size 2^( 3) =       0.000401955406
  error estimate for blocks of size 2^( 4) =       0.000411613807
  error estimate for blocks of size 2^( 5) =       0.000416107356
  error estimate for blocks of size 2^( 6) =       0.000418847179
  error estimate for blocks of size 2^( 7) =       0.000420108664

      target function =      -0.940774235049
              le_mean =     -17.211587304396
             les_mean =     296.521166563329
             stat err =       0.000416669251
             autocorr =       1.229428720280
   target nu stat err =       0.000416669251
   target dn stat err =       0.003142608497
      target stat err =       0.005331881322
              std dev =       0.531440653031
             le_variance =       0.282429167695


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721158730440e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940803234287       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940803234287       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940803234287       residual = 9.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940803234287       residual = 8.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940810791050       residual = 3.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940803177004       residual = 2.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940809909881       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940795079858       residual = 9.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940802009550       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940834784534       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.940868302968       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.940786232075       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.940793454130       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.940801938461       residual = 4.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.940832969784       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.940720965920       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.940856376391       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.940799257602       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.940775168919       residual = 8.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.940842418730       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.940763771549       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.940788014716       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.940893541651       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.940674931981       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.940694935503       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.940778462646       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.940929404813       residual = 3.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.940893835302       residual = 1.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.940829307486       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.940847901809       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.940669171765       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.940430167916       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.940689346868       residual = 5.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.939975628074       residual = 7.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.942169049840       residual = 2.98e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.939535804843       residual = 4.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.944251059089       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.942575893884       residual = 8.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.939937188152       residual = 5.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.942940376495       residual = 8.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.941131483710       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.940524074264       residual = 2.85e-03           smallest_sin_value = 1.00e+00
davidson iteration   42 stopping due to small subspace S singular value of 9.72e-01
davidson solver did not converge after         42 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+10 is 1.623361e-14

solving harmonic davidson linear method for identity shift 9.3132e+10, overlap shift 9.3132e+11 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940803234287       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940803234287       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940803234287       residual = 9.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940803234287       residual = 8.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940806531038       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940805515850       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940813374607       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940762037324       residual = 9.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940717981582       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940893903613       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.940816762955       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.940811503886       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.940807868077       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.940895081691       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.940794650303       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941415836885       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.940512740019       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.940913242010       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.940959401619       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.940996558003       residual = 4.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.940867260374       residual = 3.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941057346695       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.940971845318       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.940940437616       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.940543714660       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.941300924068       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.940455768992       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.941273062093       residual = 4.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.937762939920       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.942731626306       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.938310695337       residual = 5.43e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.937703213013       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.942461646760       residual = 7.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.959350038322       residual = 2.86e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.949305430433       residual = 9.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.937680861647       residual = 8.17e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.934547560056       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.954060484913       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.938537296757       residual = 8.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.935210179397       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -1.011438800084       residual = 4.07e-01           smallest_sin_value = 9.96e-01
davidson iteration   41 stopping due to small subspace S singular value of 9.37e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+10 is 4.389470e-15

solving harmonic davidson linear method for identity shift 3.7253e+11, overlap shift 3.7253e+12 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940803234287       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940803234287       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940803234287       residual = 9.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940881493858       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940803234287       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940986255740       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940642846991       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940654533232       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941659058999       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942192420216       residual = 3.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.942336980902       residual = 2.86e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.940024985692       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.940740529749       residual = 4.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.940097479920       residual = 9.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.940131205794       residual = 7.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939754472985       residual = 1.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941619044960       residual = 8.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941268062367       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.940249166483       residual = 8.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.942158886564       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.940146749209       residual = 9.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939445042956       residual = 3.08e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945578812554       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.943009702906       residual = 4.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.939944287921       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.945344171961       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.943826993349       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.940693248536       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.939135248380       residual = 3.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.943454044066       residual = 3.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.938388797142       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.941744809942       residual = 7.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.937410058915       residual = 4.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.943188868873       residual = 4.30e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.924091084714       residual = 5.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.011832585403       residual = 5.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.930829365166       residual = 2.58e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.933158668232       residual = 1.39e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.959455865106       residual = 9.74e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.955937422320       residual = 1.08e-01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.904866570679       residual = 2.84e-01           smallest_sin_value = 9.97e-01
davidson iteration   41 stopping due to small subspace S singular value of 8.41e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+11 is 1.084351e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.261894 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5552e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.1934
    reference variance = 0.195173
====================================================
  Execution time = 1.9733e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7903e-01
  Total weights = 2.0000e+06
  Execution time = 1.8089e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279053874753
                                         uncertainty =       0.002623257352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279053874753
                                         uncertainty =       0.002623257352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373518225
  error estimate for blocks of size 2^( 2) =       0.000387017586
  error estimate for blocks of size 2^( 3) =       0.000399688449
  error estimate for blocks of size 2^( 4) =       0.000409463651
  error estimate for blocks of size 2^( 5) =       0.000415340455
  error estimate for blocks of size 2^( 6) =       0.000418408173
  error estimate for blocks of size 2^( 7) =       0.000419481040

      target function =      -0.946523132785
              le_mean =     -17.212202640132
             les_mean =     296.538951314692
             stat err =       0.000415673330
             autocorr =       1.238456412701
   target nu stat err =       0.000415673330
   target dn stat err =       0.002560025296
      target stat err =       0.004422381795
              std dev =       0.528234539978
             le_variance =       0.279031729226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279053874753
                                         uncertainty =       0.002623257352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279053874753
                                         uncertainty =       0.002623257352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373518225
  error estimate for blocks of size 2^( 2) =       0.000387017586
  error estimate for blocks of size 2^( 3) =       0.000399688449
  error estimate for blocks of size 2^( 4) =       0.000409463651
  error estimate for blocks of size 2^( 5) =       0.000415340455
  error estimate for blocks of size 2^( 6) =       0.000418408173
  error estimate for blocks of size 2^( 7) =       0.000419481040

      target function =      -0.946523132785
              le_mean =     -17.212202640132
             les_mean =     296.538951314692
             stat err =       0.000415673330
             autocorr =       1.238456412699
   target nu stat err =       0.000415673330
   target dn stat err =       0.002560025296
      target stat err =       0.004422381795
              std dev =       0.528234539978
             le_variance =       0.279031729226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279053874753
                                         uncertainty =       0.002623257352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279053874753
                                         uncertainty =       0.002623257352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373518225
  error estimate for blocks of size 2^( 2) =       0.000387017586
  error estimate for blocks of size 2^( 3) =       0.000399688449
  error estimate for blocks of size 2^( 4) =       0.000409463651
  error estimate for blocks of size 2^( 5) =       0.000415340455
  error estimate for blocks of size 2^( 6) =       0.000418408173
  error estimate for blocks of size 2^( 7) =       0.000419481040

      target function =      -0.946523132785
              le_mean =     -17.212202640132
             les_mean =     296.538951314692
             stat err =       0.000415673330
             autocorr =       1.238456412700
   target nu stat err =       0.000415673330
   target dn stat err =       0.002560025296
      target stat err =       0.004422381795
              std dev =       0.528234539978
             le_variance =       0.279031729226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279053874753
                                         uncertainty =       0.002623257352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279053874753
                                         uncertainty =       0.002623257352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373518225
  error estimate for blocks of size 2^( 2) =       0.000387017586
  error estimate for blocks of size 2^( 3) =       0.000399688449
  error estimate for blocks of size 2^( 4) =       0.000409463651
  error estimate for blocks of size 2^( 5) =       0.000415340455
  error estimate for blocks of size 2^( 6) =       0.000418408173
  error estimate for blocks of size 2^( 7) =       0.000419481040

      target function =      -0.946523132785
              le_mean =     -17.212202640132
             les_mean =     296.538951314692
             stat err =       0.000415673330
             autocorr =       1.238456412701
   target nu stat err =       0.000415673330
   target dn stat err =       0.002560025296
      target stat err =       0.004422381795
              std dev =       0.528234539978
             le_variance =       0.279031729226


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946523132785        initial
     2.3283e+10     2.3283e+11             1.6234e-14        -0.946523132785  <--
     9.3132e+10     9.3132e+11             4.3895e-15        -0.946523132785
     3.7253e+11     3.7253e+12             1.0844e-15        -0.946523132785

*****************************************************************************
Applying the update for shift_i =   2.3283e+10     and shift_s =   2.3283e+11
*****************************************************************************

  Execution time = 2.8896e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4453e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.267
    reference variance = 0.24201
====================================================
  Execution time = 2.0442e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9236e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5364e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292420121646
                                         uncertainty =       0.008158661698

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292420121646
                                         uncertainty =       0.008158661698

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382336004
  error estimate for blocks of size 2^( 2) =       0.000395868145
  error estimate for blocks of size 2^( 3) =       0.000408371284
  error estimate for blocks of size 2^( 4) =       0.000416975094
  error estimate for blocks of size 2^( 5) =       0.000424398831
  error estimate for blocks of size 2^( 6) =       0.000427685494
  error estimate for blocks of size 2^( 7) =       0.000427741455

      target function =      -0.924187169165
              le_mean =     -17.212146092878
             les_mean =     296.550334615826
             stat err =       0.000424200219
             autocorr =       1.230981093965
   target nu stat err =       0.000424200219
   target dn stat err =       0.008213869102
      target stat err =       0.013354622200
              std dev =       0.540704761814
             le_variance =       0.292361639448


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721214609288e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+09, overlap shift 5.8208e+10 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924380581859       residual = 2.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924380581859       residual = 4.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924380581859       residual = 3.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924377822677       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924380581858       residual = 7.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924376605833       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924387502949       residual = 5.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924367027673       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924379571313       residual = 7.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924369288025       residual = 4.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924357754325       residual = 5.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924356182438       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924367877814       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924352940824       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924383524939       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924392062145       residual = 4.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924382152084       residual = 4.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924349972945       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.924388848405       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.924409702938       residual = 7.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.924344857303       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.924366552012       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.924371943645       residual = 7.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.924368647509       residual = 2.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.924384857320       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.924361909832       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.924363061894       residual = 4.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.924365377542       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.924356768562       residual = 4.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.924379668281       residual = 3.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.924436140692       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.924241056660       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.924400539007       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.924204428901       residual = 4.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.924934969364       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.924131259615       residual = 7.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.924243774216       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.927656094282       residual = 9.38e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.925123603564       residual = 8.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.925361387427       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.922563487102       residual = 7.61e-04           smallest_sin_value = 9.98e-01
davidson iteration   41 stopping due to small subspace S singular value of 8.65e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+09 is 1.513063e-13

solving harmonic davidson linear method for identity shift 2.3283e+10, overlap shift 2.3283e+11 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924380581859       residual = 2.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924380581859       residual = 4.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924380581859       residual = 3.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924380581857       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924397249445       residual = 7.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924398878311       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924357335586       residual = 5.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924406147506       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924379685700       residual = 6.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924386239092       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924313983539       residual = 5.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924474934797       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924385677979       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924305416380       residual = 6.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924377706525       residual = 6.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924338193264       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924398805200       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924360456355       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.924366781988       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.924303488682       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.924408262720       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.924387982304       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.924383601765       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.924310895890       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.924273170413       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.924212056393       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.924367729751       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.924443554490       residual = 6.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.924330443403       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.924448880153       residual = 5.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.924424186514       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.924541834893       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.924117647934       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.923382281756       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.925523796782       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.924234807963       residual = 4.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.922761914017       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.925222855404       residual = 5.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.930821205267       residual = 5.87e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.928002524689       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.925460245811       residual = 1.27e-03           smallest_sin_value = 9.99e-01
davidson iteration   41 stopping due to small subspace S singular value of 9.49e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+10 is 3.761881e-14

solving harmonic davidson linear method for identity shift 9.3132e+10, overlap shift 9.3132e+11 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.924380581859       residual = 2.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.924380581859       residual = 4.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.924380581859       residual = 3.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.924377410901       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.924340878155       residual = 7.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.924383079533       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.924355665879       residual = 5.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.924412681650       residual = 1.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.924296906287       residual = 6.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.924453600326       residual = 4.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.924318086346       residual = 5.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924370987102       residual = 3.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924355727566       residual = 2.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.924387673588       residual = 9.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.924470411339       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.924856381918       residual = 2.97e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924398743512       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.924249089682       residual = 8.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.924093251557       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.924167824995       residual = 6.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.924384557632       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.924430088311       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.924642154608       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.924590050025       residual = 4.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.924264647007       residual = 3.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.924352864609       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.924660136439       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.924404816842       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.923659168441       residual = 5.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.925616051710       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.926019816469       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.923260806734       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.924229076306       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.916237649384       residual = 1.41e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.932493957348       residual = 8.82e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.955415915034       residual = 9.09e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.892685843672       residual = 1.15e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.913620408719       residual = 3.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.928126906090       residual = 3.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.915512955649       residual = 2.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.942422952592       residual = 3.73e-02           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.919939296666       residual = 5.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   42 stopping due to small subspace S singular value of 9.67e-01
davidson solver did not converge after         42 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+10 is 9.329875e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.341905 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6071e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.1674
    reference variance = 0.288423
====================================================
  Execution time = 1.9627e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7958e-01
  Total weights = 2.0000e+06
  Execution time = 1.8154e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279508673754
                                         uncertainty =       0.004320326715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279508673754
                                         uncertainty =       0.004320326715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373883461
  error estimate for blocks of size 2^( 2) =       0.000387797396
  error estimate for blocks of size 2^( 3) =       0.000399906126
  error estimate for blocks of size 2^( 4) =       0.000409040000
  error estimate for blocks of size 2^( 5) =       0.000414668566
  error estimate for blocks of size 2^( 6) =       0.000416216894
  error estimate for blocks of size 2^( 7) =       0.000418391246

      target function =      -0.945566474107
              le_mean =     -17.212260678688
             les_mean =     296.541495215512
             stat err =       0.000414579177
             autocorr =       1.229539432839
   target nu stat err =       0.000414579177
   target dn stat err =       0.003935677231
      target stat err =       0.006729675175
              std dev =       0.528751060686
             le_variance =       0.279577684177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279508673754
                                         uncertainty =       0.004320326715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279508673754
                                         uncertainty =       0.004320326715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373883461
  error estimate for blocks of size 2^( 2) =       0.000387797396
  error estimate for blocks of size 2^( 3) =       0.000399906126
  error estimate for blocks of size 2^( 4) =       0.000409040000
  error estimate for blocks of size 2^( 5) =       0.000414668566
  error estimate for blocks of size 2^( 6) =       0.000416216894
  error estimate for blocks of size 2^( 7) =       0.000418391246

      target function =      -0.945566474107
              le_mean =     -17.212260678688
             les_mean =     296.541495215512
             stat err =       0.000414579177
             autocorr =       1.229539432842
   target nu stat err =       0.000414579177
   target dn stat err =       0.003935677231
      target stat err =       0.006729675175
              std dev =       0.528751060686
             le_variance =       0.279577684177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279508673754
                                         uncertainty =       0.004320326715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279508673754
                                         uncertainty =       0.004320326715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373883461
  error estimate for blocks of size 2^( 2) =       0.000387797396
  error estimate for blocks of size 2^( 3) =       0.000399906126
  error estimate for blocks of size 2^( 4) =       0.000409040000
  error estimate for blocks of size 2^( 5) =       0.000414668566
  error estimate for blocks of size 2^( 6) =       0.000416216894
  error estimate for blocks of size 2^( 7) =       0.000418391246

      target function =      -0.945566474107
              le_mean =     -17.212260678688
             les_mean =     296.541495215512
             stat err =       0.000414579177
             autocorr =       1.229539432839
   target nu stat err =       0.000414579177
   target dn stat err =       0.003935677231
      target stat err =       0.006729675175
              std dev =       0.528751060686
             le_variance =       0.279577684177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279508673754
                                         uncertainty =       0.004320326715

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279508673754
                                         uncertainty =       0.004320326715

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373883461
  error estimate for blocks of size 2^( 2) =       0.000387797396
  error estimate for blocks of size 2^( 3) =       0.000399906126
  error estimate for blocks of size 2^( 4) =       0.000409040000
  error estimate for blocks of size 2^( 5) =       0.000414668566
  error estimate for blocks of size 2^( 6) =       0.000416216894
  error estimate for blocks of size 2^( 7) =       0.000418391246

      target function =      -0.945566474107
              le_mean =     -17.212260678688
             les_mean =     296.541495215512
             stat err =       0.000414579177
             autocorr =       1.229539432838
   target nu stat err =       0.000414579177
   target dn stat err =       0.003935677231
      target stat err =       0.006729675175
              std dev =       0.528751060686
             le_variance =       0.279577684177


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945566474107        initial  <--
     5.8208e+09     5.8208e+10             1.5131e-13        -0.945566474107
     2.3283e+10     2.3283e+11             3.7619e-14        -0.945566474107
     9.3132e+10     9.3132e+11             9.3299e-15        -0.945566474107

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.8169
  </log>
  <optVariables href="H2O.s048.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4893e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.2162
    reference variance = 0.392938
====================================================
  Execution time = 1.9843e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7405e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5255e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273940233054
                                         uncertainty =       0.001843476677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273940233054
                                         uncertainty =       0.001843476677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370170907
  error estimate for blocks of size 2^( 2) =       0.000384081953
  error estimate for blocks of size 2^( 3) =       0.000396626976
  error estimate for blocks of size 2^( 4) =       0.000405533289
  error estimate for blocks of size 2^( 5) =       0.000411602284
  error estimate for blocks of size 2^( 6) =       0.000414488009
  error estimate for blocks of size 2^( 7) =       0.000416249296

      target function =      -0.955081509390
              le_mean =     -17.211811191473
             les_mean =     296.520497355381
             stat err =       0.000411968220
             autocorr =       1.238576575294
   target nu stat err =       0.000411968220
   target dn stat err =       0.001898660966
      target stat err =       0.003372723489
              std dev =       0.523500717769
             le_variance =       0.274053001505


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721181119147e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+10, overlap shift 5.8208e+11 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.955092137777       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.955092137777       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.955092137777       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.955092137776       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.955122987653       residual = 4.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.955110918633       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.955075138945       residual = 4.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.955060849782       residual = 6.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.954999476774       residual = 2.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.955092192405       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.955111615881       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.955295156009       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.954995318221       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.955178037680       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.955140752202       residual = 5.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.955309573501       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.955003365025       residual = 4.89e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.955230109683       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.955158271473       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.954956120532       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.955256997130       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.955132286462       residual = 1.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.955227512816       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.955040759810       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.954195870714       residual = 7.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.954977790830       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.954385984271       residual = 5.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.955808559087       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.954512895926       residual = 3.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.955703058286       residual = 9.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.956275997444       residual = 1.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.953897783525       residual = 1.78e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.957163520021       residual = 4.29e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.938988822587       residual = 2.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.946478558029       residual = 6.74e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.936885370660       residual = 2.77e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.919617281214       residual = 1.11e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.963206286760       residual = 5.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.958329925379       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.943743679568       residual = 1.36e-02           smallest_sin_value = 9.99e-01
davidson iteration   40 stopping due to small subspace S singular value of 9.79e-01
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+10 is 1.005327e-14

solving harmonic davidson linear method for identity shift 2.3283e+11, overlap shift 2.3283e+12 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.955092137777       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.955092137777       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.955092137777       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.955092137777       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.955092137777       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.955092137777       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.955011733592       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.955092137777       residual = 6.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.955354785590       residual = 4.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.954688212891       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.955092137777       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.955836560678       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.954460938565       residual = 7.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.954434870763       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.954940770429       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.954128801945       residual = 9.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.955929592803       residual = 7.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.955401521607       residual = 7.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.954518521454       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.954789059292       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.955066388395       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.953405041992       residual = 2.61e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.955799114327       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.954140628861       residual = 9.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.955154630694       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.954630574075       residual = 5.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.957145959380       residual = 5.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.957238099259       residual = 8.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.959030620923       residual = 3.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.950658271033       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.961173000137       residual = 4.33e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.966466014770       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.951831984601       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.934284591534       residual = 4.97e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.946615352349       residual = 8.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.940410836155       residual = 6.45e-02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.940437924079       residual = 3.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -1.071433582453       residual = 2.01e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -1.035203936978       residual = 1.54e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.809955633351       residual = 2.42e+00           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.824345905638       residual = 3.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -1.057958212817       residual = 2.98e+00           smallest_sin_value = 9.95e-01
davidson iteration   42 stopping due to small subspace S singular value of 9.85e-01
davidson solver did not converge after         42 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+11 is 2.362659e-15

solving harmonic davidson linear method for identity shift 9.3132e+11, overlap shift 9.3132e+12 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.955092137777       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.955092137777       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.955092137777       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.955092137777       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.955092137777       residual = 5.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.955092137777       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.955092137777       residual = 4.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.956670214214       residual = 8.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.954393981515       residual = 2.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.957328114154       residual = 8.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.953335265318       residual = 6.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.954796613093       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.955003062687       residual = 2.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.953405387785       residual = 6.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.953422985064       residual = 6.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.954914225242       residual = 1.54e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.955516203533       residual = 5.32e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.952209718743       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.955745885101       residual = 6.62e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.950347192390       residual = 3.65e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.948057049299       residual = 3.96e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.956113075789       residual = 8.67e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.959251586867       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.954312642757       residual = 4.59e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.948268778197       residual = 5.04e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.960207625763       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939081140680       residual = 3.00e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.958265938177       residual = 4.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.960318559446       residual = 6.02e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.954190771095       residual = 3.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.972533678350       residual = 1.41e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.927203655995       residual = 2.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -1.113206169793       residual = 1.90e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.920614654282       residual = 1.42e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.927714940962       residual = 1.28e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.082100618057       residual = 5.38e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.085062208803       residual = 4.97e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.935970838681       residual = 2.46e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -1.054604971479       residual = 1.32e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.556043372770       residual = 1.97e+01           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.722990220611       residual = 1.46e+01           smallest_sin_value = 9.94e-01
davidson iteration   41 stopping due to small subspace S singular value of 7.36e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+11 is 7.460495e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.421450 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5459e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.1927
    reference variance = 0.20165
====================================================
  Execution time = 2.1680e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8291e-01
  Total weights = 2.0000e+06
  Execution time = 1.8051e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282946926370
                                         uncertainty =       0.003028208115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282946926370
                                         uncertainty =       0.003028208115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376103702
  error estimate for blocks of size 2^( 2) =       0.000389721806
  error estimate for blocks of size 2^( 3) =       0.000402200882
  error estimate for blocks of size 2^( 4) =       0.000411015833
  error estimate for blocks of size 2^( 5) =       0.000416788177
  error estimate for blocks of size 2^( 6) =       0.000420896477
  error estimate for blocks of size 2^( 7) =       0.000422288283

      target function =      -0.939963547846
              le_mean =     -17.211491953456
             les_mean =     296.518363112278
             stat err =       0.000417747193
             autocorr =       1.233706527799
   target nu stat err =       0.000417747193
   target dn stat err =       0.003562911699
      target stat err =       0.006020792879
              std dev =       0.531890956736
             le_variance =       0.282907989857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282946926370
                                         uncertainty =       0.003028208115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282946926370
                                         uncertainty =       0.003028208115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376103702
  error estimate for blocks of size 2^( 2) =       0.000389721806
  error estimate for blocks of size 2^( 3) =       0.000402200882
  error estimate for blocks of size 2^( 4) =       0.000411015833
  error estimate for blocks of size 2^( 5) =       0.000416788177
  error estimate for blocks of size 2^( 6) =       0.000420896477
  error estimate for blocks of size 2^( 7) =       0.000422288283

      target function =      -0.939963547846
              le_mean =     -17.211491953456
             les_mean =     296.518363112278
             stat err =       0.000417747193
             autocorr =       1.233706527798
   target nu stat err =       0.000417747193
   target dn stat err =       0.003562911699
      target stat err =       0.006020792879
              std dev =       0.531890956736
             le_variance =       0.282907989857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282946926370
                                         uncertainty =       0.003028208115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282946926370
                                         uncertainty =       0.003028208115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376103702
  error estimate for blocks of size 2^( 2) =       0.000389721806
  error estimate for blocks of size 2^( 3) =       0.000402200882
  error estimate for blocks of size 2^( 4) =       0.000411015833
  error estimate for blocks of size 2^( 5) =       0.000416788177
  error estimate for blocks of size 2^( 6) =       0.000420896477
  error estimate for blocks of size 2^( 7) =       0.000422288283

      target function =      -0.939963547846
              le_mean =     -17.211491953456
             les_mean =     296.518363112278
             stat err =       0.000417747193
             autocorr =       1.233706527798
   target nu stat err =       0.000417747193
   target dn stat err =       0.003562911699
      target stat err =       0.006020792879
              std dev =       0.531890956736
             le_variance =       0.282907989857

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282946926370
                                         uncertainty =       0.003028208115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282946926370
                                         uncertainty =       0.003028208115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376103702
  error estimate for blocks of size 2^( 2) =       0.000389721806
  error estimate for blocks of size 2^( 3) =       0.000402200882
  error estimate for blocks of size 2^( 4) =       0.000411015833
  error estimate for blocks of size 2^( 5) =       0.000416788177
  error estimate for blocks of size 2^( 6) =       0.000420896477
  error estimate for blocks of size 2^( 7) =       0.000422288283

      target function =      -0.939963547846
              le_mean =     -17.211491953456
             les_mean =     296.518363112278
             stat err =       0.000417747193
             autocorr =       1.233706527798
   target nu stat err =       0.000417747193
   target dn stat err =       0.003562911699
      target stat err =       0.006020792879
              std dev =       0.531890956736
             le_variance =       0.282907989857


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.939963547846        initial  <--
     5.8208e+10     5.8208e+11             1.0053e-14        -0.939963547846
     2.3283e+11     2.3283e+12             2.3627e-15        -0.939963547846
     9.3132e+11     9.3132e+12             7.4605e-16        -0.939963547846

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.9136
  </log>
  <optVariables href="H2O.s049.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6379e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2575
    reference variance = 0.602936
====================================================
  Execution time = 2.0008e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8005e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6263e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280047069513
                                         uncertainty =       0.003600418469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280047069513
                                         uncertainty =       0.003600418469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374200391
  error estimate for blocks of size 2^( 2) =       0.000387732133
  error estimate for blocks of size 2^( 3) =       0.000400348376
  error estimate for blocks of size 2^( 4) =       0.000409154836
  error estimate for blocks of size 2^( 5) =       0.000413981915
  error estimate for blocks of size 2^( 6) =       0.000414960112
  error estimate for blocks of size 2^( 7) =       0.000416936757

      target function =      -0.944766659899
              le_mean =     -17.212155411611
             les_mean =     296.538345638320
             stat err =       0.000413758405
             autocorr =       1.222602232953
   target nu stat err =       0.000413758405
   target dn stat err =       0.003741336627
      target stat err =       0.006389316884
              std dev =       0.529199267677
             le_variance =       0.280051864910


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721215541161e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+11, overlap shift 5.8208e+12 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944809210571       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944809210571       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944809210571       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944809210571       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944807299434       residual = 4.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944809210571       residual = 5.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944931167052       residual = 5.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943225104693       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944054052475       residual = 4.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944976764094       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944393726685       residual = 8.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944153570395       residual = 1.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944079180001       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945942814816       residual = 2.39e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.943183688521       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.939743953499       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.943930021361       residual = 2.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945251349585       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944400615004       residual = 8.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.948609359788       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946983107224       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946570690402       residual = 5.01e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945314688960       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946916839473       residual = 5.92e-04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.947481846960       residual = 8.95e-04           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.945054352679       residual = 5.51e-04           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.942473301251       residual = 7.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.940674790490       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.923659676689       residual = 3.64e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.984893362184       residual = 1.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.962076112949       residual = 5.07e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.980512389345       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.882856909470       residual = 3.10e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.941862482055       residual = 3.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.998988886836       residual = 8.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.851253909080       residual = 9.40e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.994327953160       residual = 5.87e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.881187701858       residual = 2.89e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -1.062574456746       residual = 5.74e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.986135015590       residual = 2.92e+00           smallest_sin_value = 9.97e-01
davidson iteration   40 stopping due to small subspace S singular value of 9.35e-01
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+11 is 2.100673e-15

solving harmonic davidson linear method for identity shift 2.3283e+12, overlap shift 2.3283e+13 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944809210571       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944809210571       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944809210571       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946022845108       residual = 9.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944270743115       residual = 6.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944251605884       residual = 7.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943484249930       residual = 8.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948362621043       residual = 5.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945534567768       residual = 6.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946376803907       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944946374037       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.936318822074       residual = 8.57e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.940919045182       residual = 4.12e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.948030243394       residual = 1.58e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.948270825907       residual = 7.72e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946388437689       residual = 6.94e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941273538911       residual = 4.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945289023423       residual = 5.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944186807425       residual = 5.07e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944307292352       residual = 3.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.959372295389       residual = 2.72e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.953867509346       residual = 6.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945320516545       residual = 5.53e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.963864470127       residual = 3.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.980058222553       residual = 1.36e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.964517294537       residual = 4.21e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.925020471290       residual = 7.22e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.969780739267       residual = 1.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.863043591456       residual = 7.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.859640862403       residual = 8.54e-01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.677402977537       residual = 7.48e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.879785237591       residual = 3.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -1.684405320024       residual = 5.70e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -1.026201030013       residual = 1.29e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.160130834857       residual = 7.05e+01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.982460034715       residual = 1.56e+01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.128206771212       residual = 8.47e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -1.793331681901       residual = 7.36e+01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.213341812498       residual = 7.21e+01           smallest_sin_value = 1.00e+00
davidson iteration   39 stopping due to small subspace S singular value of 9.56e-01
davidson solver did not converge after         39 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+12 is 5.240971e-16

solving harmonic davidson linear method for identity shift 9.3132e+12, overlap shift 9.3132e+13 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944809210571       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944809210571       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.42e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+12 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.470565 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5695e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.179
    reference variance = 0.325262
====================================================
  Execution time = 2.0062e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8820e-01
  Total weights = 2.0000e+06
  Execution time = 1.8020e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288236248093
                                         uncertainty =       0.004131033495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288236248093
                                         uncertainty =       0.004131033495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379604874
  error estimate for blocks of size 2^( 2) =       0.000392885827
  error estimate for blocks of size 2^( 3) =       0.000404295891
  error estimate for blocks of size 2^( 4) =       0.000413433876
  error estimate for blocks of size 2^( 5) =       0.000417679494
  error estimate for blocks of size 2^( 6) =       0.000418933135
  error estimate for blocks of size 2^( 7) =       0.000422546468

      target function =      -0.931160259170
              le_mean =     -17.211806048205
             les_mean =     296.534467016931
             stat err =       0.000418148243
             autocorr =       1.213380453044
   target nu stat err =       0.000418148243
   target dn stat err =       0.003706331183
      target stat err =       0.006147401250
              std dev =       0.536842360493
             le_variance =       0.288199720019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288236248093
                                         uncertainty =       0.004131033495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288236248093
                                         uncertainty =       0.004131033495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379604874
  error estimate for blocks of size 2^( 2) =       0.000392885827
  error estimate for blocks of size 2^( 3) =       0.000404295891
  error estimate for blocks of size 2^( 4) =       0.000413433876
  error estimate for blocks of size 2^( 5) =       0.000417679494
  error estimate for blocks of size 2^( 6) =       0.000418933135
  error estimate for blocks of size 2^( 7) =       0.000422546468

      target function =      -0.931160259170
              le_mean =     -17.211806048205
             les_mean =     296.534467016931
             stat err =       0.000418148243
             autocorr =       1.213380453049
   target nu stat err =       0.000418148243
   target dn stat err =       0.003706331183
      target stat err =       0.006147401250
              std dev =       0.536842360493
             le_variance =       0.288199720019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288236248093
                                         uncertainty =       0.004131033495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288236248093
                                         uncertainty =       0.004131033495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379604874
  error estimate for blocks of size 2^( 2) =       0.000392885827
  error estimate for blocks of size 2^( 3) =       0.000404295891
  error estimate for blocks of size 2^( 4) =       0.000413433876
  error estimate for blocks of size 2^( 5) =       0.000417679494
  error estimate for blocks of size 2^( 6) =       0.000418933135
  error estimate for blocks of size 2^( 7) =       0.000422546468

      target function =      -0.931160259170
              le_mean =     -17.211806048205
             les_mean =     296.534467016931
             stat err =       0.000418148243
             autocorr =       1.213380453042
   target nu stat err =       0.000418148243
   target dn stat err =       0.003706331183
      target stat err =       0.006147401250
              std dev =       0.536842360493
             le_variance =       0.288199720019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288236248093
                                         uncertainty =       0.004131033495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288236248093
                                         uncertainty =       0.004131033495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379604874
  error estimate for blocks of size 2^( 2) =       0.000392885827
  error estimate for blocks of size 2^( 3) =       0.000404295891
  error estimate for blocks of size 2^( 4) =       0.000413433876
  error estimate for blocks of size 2^( 5) =       0.000417679494
  error estimate for blocks of size 2^( 6) =       0.000418933135
  error estimate for blocks of size 2^( 7) =       0.000422546468

      target function =      -0.931160259170
              le_mean =     -17.211806048205
             les_mean =     296.534467016931
             stat err =       0.000418148243
             autocorr =       1.213380453044
   target nu stat err =       0.000418148243
   target dn stat err =       0.003706331183
      target stat err =       0.006147401250
              std dev =       0.536842360493
             le_variance =       0.288199720019


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.931160259170        initial  <--
     5.8208e+11     5.8208e+12             2.1007e-15        -0.931160259170
     2.3283e+12     2.3283e+13             5.2410e-16        -0.931160259170
     9.3132e+12     9.3132e+13             0.0000e+00        -0.931160259170

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1995
  </log>
  <optVariables href="H2O.s050.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4901e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.1607
    reference variance = 0.247643
====================================================
  Execution time = 1.9840e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8377e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6181e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283709340236
                                         uncertainty =       0.003254205565

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283709340236
                                         uncertainty =       0.003254205565

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376674160
  error estimate for blocks of size 2^( 2) =       0.000389920869
  error estimate for blocks of size 2^( 3) =       0.000402123134
  error estimate for blocks of size 2^( 4) =       0.000411125284
  error estimate for blocks of size 2^( 5) =       0.000416759488
  error estimate for blocks of size 2^( 6) =       0.000420173498
  error estimate for blocks of size 2^( 7) =       0.000422250755

      target function =      -0.938527490606
              le_mean =     -17.211973089307
             les_mean =     296.535784331185
             stat err =       0.000417577256
             autocorr =       1.228972075584
   target nu stat err =       0.000417577256
   target dn stat err =       0.002955887602
      target stat err =       0.005001637294
              std dev =       0.532697706069
             le_variance =       0.283766846051


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721197308931e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+12, overlap shift 5.8208e+13 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938553292582       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938553292582       residual = 9.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938553292582       residual = 2.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938553292582       residual = 4.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938553292582       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941894347232       residual = 4.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931771074773       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941349563907       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937288414710       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934710358206       residual = 5.26e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.929569884275       residual = 1.84e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921961611534       residual = 2.46e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917200097178       residual = 5.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.910124672542       residual = 2.30e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.978697349968       residual = 1.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.961338047369       residual = 7.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932034584049       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.937206233344       residual = 6.26e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945777494777       residual = 4.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.964334738453       residual = 1.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.929969132100       residual = 3.98e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.909625482041       residual = 1.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.823627768023       residual = 1.11e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.954812691741       residual = 3.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.962835772416       residual = 3.45e+00           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.991992775292       residual = 3.13e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.964320342912       residual = 3.48e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.923666333292       residual = 4.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.627854316279       residual = 1.76e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -1.725663285903       residual = 8.30e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.518318341550       residual = 2.73e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -1.905974280093       residual = 1.90e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -1.564487371901       residual = 2.03e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =       0.078674104643       residual = 1.77e+02           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.939819029233       residual = 1.20e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.282561758453       residual = 2.74e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.493308197025       residual = 9.81e+01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -2.716475883162       residual = 3.27e+02           smallest_sin_value = 9.99e-01
davidson iteration   38 stopping due to small subspace S singular value of 9.86e-01
davidson solver did not converge after         38 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+12 is 3.001931e-17

solving harmonic davidson linear method for identity shift 2.3283e+13, overlap shift 2.3283e+14 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938553292582       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938553292582       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.3132e+13, overlap shift 9.3132e+14 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938553292582       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938553292582       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.19e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+13 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.493174 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5492e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.2459
    reference variance = 0.32434
====================================================
  Execution time = 1.9944e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7929e-01
  Total weights = 2.0000e+06
  Execution time = 1.8118e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279295769773
                                         uncertainty =       0.002420742188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279295769773
                                         uncertainty =       0.002420742188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373693846
  error estimate for blocks of size 2^( 2) =       0.000387455491
  error estimate for blocks of size 2^( 3) =       0.000400273138
  error estimate for blocks of size 2^( 4) =       0.000409277011
  error estimate for blocks of size 2^( 5) =       0.000414677319
  error estimate for blocks of size 2^( 6) =       0.000416703973
  error estimate for blocks of size 2^( 7) =       0.000417923145

      target function =      -0.946077659272
              le_mean =     -17.212156450997
             les_mean =     296.537623734538
             stat err =       0.000414645362
             autocorr =       1.231180512012
   target nu stat err =       0.000414645362
   target dn stat err =       0.002497635343
      target stat err =       0.004313018520
              std dev =       0.528482904726
             le_variance =       0.279294180587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279295769773
                                         uncertainty =       0.002420742188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279295769773
                                         uncertainty =       0.002420742188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373693846
  error estimate for blocks of size 2^( 2) =       0.000387455491
  error estimate for blocks of size 2^( 3) =       0.000400273138
  error estimate for blocks of size 2^( 4) =       0.000409277011
  error estimate for blocks of size 2^( 5) =       0.000414677319
  error estimate for blocks of size 2^( 6) =       0.000416703973
  error estimate for blocks of size 2^( 7) =       0.000417923145

      target function =      -0.946077659272
              le_mean =     -17.212156450997
             les_mean =     296.537623734538
             stat err =       0.000414645362
             autocorr =       1.231180512013
   target nu stat err =       0.000414645362
   target dn stat err =       0.002497635343
      target stat err =       0.004313018520
              std dev =       0.528482904726
             le_variance =       0.279294180587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279295769773
                                         uncertainty =       0.002420742188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279295769773
                                         uncertainty =       0.002420742188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373693846
  error estimate for blocks of size 2^( 2) =       0.000387455491
  error estimate for blocks of size 2^( 3) =       0.000400273138
  error estimate for blocks of size 2^( 4) =       0.000409277011
  error estimate for blocks of size 2^( 5) =       0.000414677319
  error estimate for blocks of size 2^( 6) =       0.000416703973
  error estimate for blocks of size 2^( 7) =       0.000417923145

      target function =      -0.946077659272
              le_mean =     -17.212156450997
             les_mean =     296.537623734538
             stat err =       0.000414645362
             autocorr =       1.231180512011
   target nu stat err =       0.000414645362
   target dn stat err =       0.002497635343
      target stat err =       0.004313018520
              std dev =       0.528482904726
             le_variance =       0.279294180587

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279295769773
                                         uncertainty =       0.002420742188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279295769773
                                         uncertainty =       0.002420742188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373693846
  error estimate for blocks of size 2^( 2) =       0.000387455491
  error estimate for blocks of size 2^( 3) =       0.000400273138
  error estimate for blocks of size 2^( 4) =       0.000409277011
  error estimate for blocks of size 2^( 5) =       0.000414677319
  error estimate for blocks of size 2^( 6) =       0.000416703973
  error estimate for blocks of size 2^( 7) =       0.000417923145

      target function =      -0.946077659272
              le_mean =     -17.212156450997
             les_mean =     296.537623734538
             stat err =       0.000414645362
             autocorr =       1.231180512011
   target nu stat err =       0.000414645362
   target dn stat err =       0.002497635343
      target stat err =       0.004313018520
              std dev =       0.528482904726
             le_variance =       0.279294180587


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946077659272        initial  <--
     5.8208e+12     5.8208e+13             3.0019e-17        -0.946077659272
     2.3283e+13     2.3283e+14             0.0000e+00        -0.946077659272
     9.3132e+13     9.3132e+14             0.0000e+00        -0.946077659272

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.6565
  </log>
  <optVariables href="H2O.s051.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7154e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.2407
    reference variance = 0.199655
====================================================
  Execution time = 2.0112e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8430e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4994e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284280280224
                                         uncertainty =       0.002599768462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284280280224
                                         uncertainty =       0.002599768462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377027018
  error estimate for blocks of size 2^( 2) =       0.000390645806
  error estimate for blocks of size 2^( 3) =       0.000403111942
  error estimate for blocks of size 2^( 4) =       0.000412195445
  error estimate for blocks of size 2^( 5) =       0.000417166779
  error estimate for blocks of size 2^( 6) =       0.000421357329
  error estimate for blocks of size 2^( 7) =       0.000422200891

      target function =      -0.937639185404
              le_mean =     -17.212133965713
             les_mean =     296.541854256786
             stat err =       0.000418230111
             autocorr =       1.230511415845
   target nu stat err =       0.000418230111
   target dn stat err =       0.002702081896
      target stat err =       0.004575135130
              std dev =       0.533196722877
             le_variance =       0.284298745286


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721213396571e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+13, overlap shift 5.8208e+14 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937660413998       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937660413998       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 2.3283e+14, overlap shift 2.3283e+15 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937660413998       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937660413998       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 9.3132e+14, overlap shift 9.3132e+15 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937660413998       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937660413998       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.494237 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5624e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.1386
    reference variance = 0.122835
====================================================
  Execution time = 1.9829e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8370e-01
  Total weights = 2.0000e+06
  Execution time = 1.8553e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283566686519
                                         uncertainty =       0.003639451431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283566686519
                                         uncertainty =       0.003639451431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376631601
  error estimate for blocks of size 2^( 2) =       0.000389908266
  error estimate for blocks of size 2^( 3) =       0.000401906952
  error estimate for blocks of size 2^( 4) =       0.000410453712
  error estimate for blocks of size 2^( 5) =       0.000416194166
  error estimate for blocks of size 2^( 6) =       0.000417932399
  error estimate for blocks of size 2^( 7) =       0.000418167211

      target function =      -0.938631700838
              le_mean =     -17.211567032055
             les_mean =     296.521742283007
             stat err =       0.000415686872
             autocorr =       1.218145329822
   target nu stat err =       0.000415686872
   target dn stat err =       0.003533437492
      target stat err =       0.005955361423
              std dev =       0.532637518345
             le_variance =       0.283702725949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283566686519
                                         uncertainty =       0.003639451431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283566686519
                                         uncertainty =       0.003639451431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376631601
  error estimate for blocks of size 2^( 2) =       0.000389908266
  error estimate for blocks of size 2^( 3) =       0.000401906952
  error estimate for blocks of size 2^( 4) =       0.000410453712
  error estimate for blocks of size 2^( 5) =       0.000416194166
  error estimate for blocks of size 2^( 6) =       0.000417932399
  error estimate for blocks of size 2^( 7) =       0.000418167211

      target function =      -0.938631700838
              le_mean =     -17.211567032055
             les_mean =     296.521742283007
             stat err =       0.000415686872
             autocorr =       1.218145329822
   target nu stat err =       0.000415686872
   target dn stat err =       0.003533437492
      target stat err =       0.005955361423
              std dev =       0.532637518345
             le_variance =       0.283702725949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283566686519
                                         uncertainty =       0.003639451431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283566686519
                                         uncertainty =       0.003639451431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376631601
  error estimate for blocks of size 2^( 2) =       0.000389908266
  error estimate for blocks of size 2^( 3) =       0.000401906952
  error estimate for blocks of size 2^( 4) =       0.000410453712
  error estimate for blocks of size 2^( 5) =       0.000416194166
  error estimate for blocks of size 2^( 6) =       0.000417932399
  error estimate for blocks of size 2^( 7) =       0.000418167211

      target function =      -0.938631700838
              le_mean =     -17.211567032055
             les_mean =     296.521742283007
             stat err =       0.000415686872
             autocorr =       1.218145329822
   target nu stat err =       0.000415686872
   target dn stat err =       0.003533437492
      target stat err =       0.005955361423
              std dev =       0.532637518345
             le_variance =       0.283702725949

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283566686519
                                         uncertainty =       0.003639451431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283566686519
                                         uncertainty =       0.003639451431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376631601
  error estimate for blocks of size 2^( 2) =       0.000389908266
  error estimate for blocks of size 2^( 3) =       0.000401906952
  error estimate for blocks of size 2^( 4) =       0.000410453712
  error estimate for blocks of size 2^( 5) =       0.000416194166
  error estimate for blocks of size 2^( 6) =       0.000417932399
  error estimate for blocks of size 2^( 7) =       0.000418167211

      target function =      -0.938631700838
              le_mean =     -17.211567032055
             les_mean =     296.521742283007
             stat err =       0.000415686872
             autocorr =       1.218145329822
   target nu stat err =       0.000415686872
   target dn stat err =       0.003533437492
      target stat err =       0.005955361423
              std dev =       0.532637518345
             le_variance =       0.283702725949


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.938631700838        initial  <--
     5.8208e+13     5.8208e+14             0.0000e+00        -0.938631700838
     2.3283e+14     2.3283e+15             0.0000e+00        -0.938631700838
     9.3132e+14     9.3132e+15             0.0000e+00        -0.938631700838

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2602
  </log>
  <optVariables href="H2O.s052.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4891e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.147
    reference variance = 0.208183
====================================================
  Execution time = 2.0074e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9104e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7159e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291069587666
                                         uncertainty =       0.006344220513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291069587666
                                         uncertainty =       0.006344220513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381470209
  error estimate for blocks of size 2^( 2) =       0.000394887340
  error estimate for blocks of size 2^( 3) =       0.000407384077
  error estimate for blocks of size 2^( 4) =       0.000416767702
  error estimate for blocks of size 2^( 5) =       0.000421814843
  error estimate for blocks of size 2^( 6) =       0.000424139718
  error estimate for blocks of size 2^( 7) =       0.000425752083

      target function =      -0.926412655607
              le_mean =     -17.211991631972
             les_mean =     296.543694833562
             stat err =       0.000422118586
             autocorr =       1.224468723574
   target nu stat err =       0.000422118586
   target dn stat err =       0.006687992750
      target stat err =       0.010930462164
              std dev =       0.539480342553
             le_variance =       0.291039040001


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721199163197e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+14, overlap shift 5.8208e+15 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926539750083       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926539750083       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926539750083       residual = 8.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.926539750083       residual = 4.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926539750082       residual = 9.69e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.530032327607       residual = 1.38e+01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.957194055953       residual = 1.27e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.303103266722       residual = 1.42e+02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949717526835       residual = 1.60e+01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.192417982231       residual = 9.93e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.532253055754       residual = 1.36e+02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -2.979975831393       residual = 3.43e+02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -1.207323038494       residual = 5.16e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =       0.759731739853       residual = 3.74e+02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -1.988215300939       residual = 3.58e+02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -1.058301479490       residual = 2.47e+01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -3.450012470927       residual = 6.28e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -2.089486334558       residual = 2.57e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =       0.883760818855       residual = 3.69e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.856417862814       residual = 1.41e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.134012871216       residual = 5.35e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =       0.895314561951       residual = 6.95e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =       6.099547929522       residual = 4.59e+03           smallest_sin_value = 1.00e+00
davidson iteration   23 stopping due to too large eigenvalue change
davidson solver did not converge after         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+14 is 2.919560e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+15, overlap shift 2.3283e+16 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926539750083       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926539750083       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926539750083       residual = 8.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.122749391567       residual = 5.62e+01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.926539750082       residual = 2.47e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =       0.578801286681       residual = 2.03e+02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930113330710       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -2.501699213989       residual = 7.12e+02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -1.987613514518       residual = 8.03e+02           smallest_sin_value = 1.00e+00
davidson iteration    9 stopping due to too large eigenvalue change
davidson solver did not converge after          9 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+15 is 7.298901e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+15, overlap shift 9.3132e+16 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.926539750083       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.926539750083       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.926539750083       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to small subspace S singular value of 6.18e-01
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+15 is 1.684531e-20

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.502201 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5809e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.1737
    reference variance = 0.236053
====================================================
  Execution time = 1.9603e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9032e-01
  Total weights = 2.0000e+06
  Execution time = 1.8542e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290423363496
                                         uncertainty =       0.012867918527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290423363496
                                         uncertainty =       0.012867918527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380998133
  error estimate for blocks of size 2^( 2) =       0.000394403859
  error estimate for blocks of size 2^( 3) =       0.000406497883
  error estimate for blocks of size 2^( 4) =       0.000415847601
  error estimate for blocks of size 2^( 5) =       0.000420891601
  error estimate for blocks of size 2^( 6) =       0.000425391523
  error estimate for blocks of size 2^( 7) =       0.000427505674

      target function =      -0.927257978772
              le_mean =     -17.211788694784
             les_mean =     296.535989083744
             stat err =       0.000422409100
             autocorr =       1.229195143796
   target nu stat err =       0.000422409100
   target dn stat err =       0.012771650205
      target stat err =       0.020875815521
              std dev =       0.538812727229
             le_variance =       0.290319155024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290423363496
                                         uncertainty =       0.012867918527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290423363496
                                         uncertainty =       0.012867918527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380998133
  error estimate for blocks of size 2^( 2) =       0.000394403859
  error estimate for blocks of size 2^( 3) =       0.000406497883
  error estimate for blocks of size 2^( 4) =       0.000415847601
  error estimate for blocks of size 2^( 5) =       0.000420891601
  error estimate for blocks of size 2^( 6) =       0.000425391523
  error estimate for blocks of size 2^( 7) =       0.000427505674

      target function =      -0.927257978772
              le_mean =     -17.211788694784
             les_mean =     296.535989083744
             stat err =       0.000422409100
             autocorr =       1.229195143796
   target nu stat err =       0.000422409100
   target dn stat err =       0.012771650205
      target stat err =       0.020875815521
              std dev =       0.538812727229
             le_variance =       0.290319155024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290423363496
                                         uncertainty =       0.012867918527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290423363496
                                         uncertainty =       0.012867918527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380998133
  error estimate for blocks of size 2^( 2) =       0.000394403859
  error estimate for blocks of size 2^( 3) =       0.000406497883
  error estimate for blocks of size 2^( 4) =       0.000415847601
  error estimate for blocks of size 2^( 5) =       0.000420891601
  error estimate for blocks of size 2^( 6) =       0.000425391523
  error estimate for blocks of size 2^( 7) =       0.000427505674

      target function =      -0.927257978772
              le_mean =     -17.211788694784
             les_mean =     296.535989083744
             stat err =       0.000422409100
             autocorr =       1.229195143796
   target nu stat err =       0.000422409100
   target dn stat err =       0.012771650205
      target stat err =       0.020875815521
              std dev =       0.538812727229
             le_variance =       0.290319155024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290423363496
                                         uncertainty =       0.012867918527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290423363496
                                         uncertainty =       0.012867918527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380998133
  error estimate for blocks of size 2^( 2) =       0.000394403859
  error estimate for blocks of size 2^( 3) =       0.000406497883
  error estimate for blocks of size 2^( 4) =       0.000415847601
  error estimate for blocks of size 2^( 5) =       0.000420891601
  error estimate for blocks of size 2^( 6) =       0.000425391523
  error estimate for blocks of size 2^( 7) =       0.000427505674

      target function =      -0.927257978772
              le_mean =     -17.211788694784
             les_mean =     296.535989083744
             stat err =       0.000422409100
             autocorr =       1.229195143796
   target nu stat err =       0.000422409100
   target dn stat err =       0.012771650205
      target stat err =       0.020875815521
              std dev =       0.538812727229
             le_variance =       0.290319155024


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.927257978772        initial  <--
     5.8208e+14     5.8208e+15             2.9196e-19        -0.927257978772
     2.3283e+15     2.3283e+16             7.2989e-20        -0.927257978772
     9.3132e+15     9.3132e+16             1.6845e-20        -0.927257978772

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0273
  </log>
  <optVariables href="H2O.s053.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4842e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.2246
    reference variance = 0.388241
====================================================
  Execution time = 1.9988e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7837e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5104e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278353236602
                                         uncertainty =       0.002060762281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278353236602
                                         uncertainty =       0.002060762281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373072596
  error estimate for blocks of size 2^( 2) =       0.000386873105
  error estimate for blocks of size 2^( 3) =       0.000399139043
  error estimate for blocks of size 2^( 4) =       0.000407850301
  error estimate for blocks of size 2^( 5) =       0.000413817100
  error estimate for blocks of size 2^( 6) =       0.000417251347
  error estimate for blocks of size 2^( 7) =       0.000418687993

      target function =      -0.947660501279
              le_mean =     -17.212530786041
             les_mean =     296.549582244385
             stat err =       0.000414401685
             autocorr =       1.233832848000
   target nu stat err =       0.000414401685
   target dn stat err =       0.002204278323
      target stat err =       0.003837729489
              std dev =       0.527604324445
             le_variance =       0.278366323174


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721253078604e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+15, overlap shift 5.8208e+16 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947675030371       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947675030371       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947675030371       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947675030372       residual = 1.19e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -1.161872238840       residual = 3.89e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -3.159360157879       residual = 4.18e+02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =       0.420615383919       residual = 4.17e+04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -1.227609017197       residual = 1.94e+04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =       1.122956786622       residual = 6.01e+03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -5.257406152714       residual = 2.42e+04           smallest_sin_value = 1.00e+00
davidson iteration   10 stopping due to too large eigenvalue change
davidson solver did not converge after         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+15 is 2.558137e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+16, overlap shift 2.3283e+17 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947675030371       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947675030371       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947675030371       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947675030371       residual = 5.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -1.140403724319       residual = 3.67e+00           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+16 is 6.395341e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+16, overlap shift 9.3132e+17 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947675030371       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947675030371       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947675030371       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+16 is 1.514686e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.504605 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5512e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.1855
    reference variance = 0.935587
====================================================
  Execution time = 1.9811e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8274e-01
  Total weights = 2.0000e+06
  Execution time = 1.8649e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282785367008
                                         uncertainty =       0.002831704740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282785367008
                                         uncertainty =       0.002831704740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375991393
  error estimate for blocks of size 2^( 2) =       0.000389552641
  error estimate for blocks of size 2^( 3) =       0.000401983676
  error estimate for blocks of size 2^( 4) =       0.000411045237
  error estimate for blocks of size 2^( 5) =       0.000416584188
  error estimate for blocks of size 2^( 6) =       0.000419398427
  error estimate for blocks of size 2^( 7) =       0.000419945369

      target function =      -0.940253421076
              le_mean =     -17.211711411770
             les_mean =     296.525748636264
             stat err =       0.000416743305
             autocorr =       1.228517808543
   target nu stat err =       0.000416743305
   target dn stat err =       0.003061743918
      target stat err =       0.005192929100
              std dev =       0.531732127659
             le_variance =       0.282739055585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282785367008
                                         uncertainty =       0.002831704740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282785367008
                                         uncertainty =       0.002831704740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375991393
  error estimate for blocks of size 2^( 2) =       0.000389552641
  error estimate for blocks of size 2^( 3) =       0.000401983676
  error estimate for blocks of size 2^( 4) =       0.000411045237
  error estimate for blocks of size 2^( 5) =       0.000416584188
  error estimate for blocks of size 2^( 6) =       0.000419398427
  error estimate for blocks of size 2^( 7) =       0.000419945369

      target function =      -0.940253421076
              le_mean =     -17.211711411770
             les_mean =     296.525748636264
             stat err =       0.000416743305
             autocorr =       1.228517808543
   target nu stat err =       0.000416743305
   target dn stat err =       0.003061743918
      target stat err =       0.005192929100
              std dev =       0.531732127659
             le_variance =       0.282739055585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282785367008
                                         uncertainty =       0.002831704740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282785367008
                                         uncertainty =       0.002831704740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375991393
  error estimate for blocks of size 2^( 2) =       0.000389552641
  error estimate for blocks of size 2^( 3) =       0.000401983676
  error estimate for blocks of size 2^( 4) =       0.000411045237
  error estimate for blocks of size 2^( 5) =       0.000416584188
  error estimate for blocks of size 2^( 6) =       0.000419398427
  error estimate for blocks of size 2^( 7) =       0.000419945369

      target function =      -0.940253421076
              le_mean =     -17.211711411770
             les_mean =     296.525748636264
             stat err =       0.000416743305
             autocorr =       1.228517808543
   target nu stat err =       0.000416743305
   target dn stat err =       0.003061743918
      target stat err =       0.005192929100
              std dev =       0.531732127659
             le_variance =       0.282739055585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282785367008
                                         uncertainty =       0.002831704740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282785367008
                                         uncertainty =       0.002831704740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375991393
  error estimate for blocks of size 2^( 2) =       0.000389552641
  error estimate for blocks of size 2^( 3) =       0.000401983676
  error estimate for blocks of size 2^( 4) =       0.000411045237
  error estimate for blocks of size 2^( 5) =       0.000416584188
  error estimate for blocks of size 2^( 6) =       0.000419398427
  error estimate for blocks of size 2^( 7) =       0.000419945369

      target function =      -0.940253421076
              le_mean =     -17.211711411770
             les_mean =     296.525748636264
             stat err =       0.000416743305
             autocorr =       1.228517808543
   target nu stat err =       0.000416743305
   target dn stat err =       0.003061743918
      target stat err =       0.005192929100
              std dev =       0.531732127659
             le_variance =       0.282739055585


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940253421076        initial  <--
     5.8208e+15     5.8208e+16             2.5581e-20        -0.940253421076
     2.3283e+16     2.3283e+17             6.3953e-21        -0.940253421076
     9.3132e+16     9.3132e+17             1.5147e-21        -0.940253421076

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.2057
  </log>
  <optVariables href="H2O.s054.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7724e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.179
    reference variance = 0.165747
====================================================
  Execution time = 2.0231e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8171e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6165e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281745234837
                                         uncertainty =       0.002841979983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281745234837
                                         uncertainty =       0.002841979983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375303946
  error estimate for blocks of size 2^( 2) =       0.000388943340
  error estimate for blocks of size 2^( 3) =       0.000401306562
  error estimate for blocks of size 2^( 4) =       0.000410549005
  error estimate for blocks of size 2^( 5) =       0.000416764072
  error estimate for blocks of size 2^( 6) =       0.000419831745
  error estimate for blocks of size 2^( 7) =       0.000421877582

      target function =      -0.941990261756
              le_mean =     -17.212078792480
             les_mean =     296.537362320942
             stat err =       0.000417255601
             autocorr =       1.236055835933
   target nu stat err =       0.000417255601
   target dn stat err =       0.002743108700
      target stat err =       0.004684640637
              std dev =       0.530759929969
             le_variance =       0.281706103261


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721207879248e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+16, overlap shift 5.8208e+17 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942012662629       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942012662629       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942012662629       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942012662815       residual = 4.88e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.861543362822       residual = 5.51e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.748676204784       residual = 1.07e+01           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+16 is 2.311731e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+17, overlap shift 2.3283e+18 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942012662629       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942012662629       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942012662629       residual = 3.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942012662628       residual = 1.26e+01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+17 is 5.779329e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+17, overlap shift 9.3132e+18 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942012662629       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942012662629       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942012662629       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942012662629       residual = 1.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+17 is 1.444832e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.506413 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5862e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.1468
    reference variance = 0.231851
====================================================
  Execution time = 1.9645e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8109e-01
  Total weights = 2.0000e+06
  Execution time = 1.8475e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280912504682
                                         uncertainty =       0.002337878089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280912504682
                                         uncertainty =       0.002337878089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374896226
  error estimate for blocks of size 2^( 2) =       0.000388564543
  error estimate for blocks of size 2^( 3) =       0.000401631960
  error estimate for blocks of size 2^( 4) =       0.000410702285
  error estimate for blocks of size 2^( 5) =       0.000416299836
  error estimate for blocks of size 2^( 6) =       0.000418007097
  error estimate for blocks of size 2^( 7) =       0.000420408800

      target function =      -0.943024700657
              le_mean =     -17.212273753477
             les_mean =     296.543461984898
             stat err =       0.000416354505
             autocorr =       1.233401290120
   target nu stat err =       0.000416354505
   target dn stat err =       0.002468642096
      target stat err =       0.004238877960
              std dev =       0.530183327553
             le_variance =       0.281094360816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280912504682
                                         uncertainty =       0.002337878089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280912504682
                                         uncertainty =       0.002337878089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374896226
  error estimate for blocks of size 2^( 2) =       0.000388564543
  error estimate for blocks of size 2^( 3) =       0.000401631960
  error estimate for blocks of size 2^( 4) =       0.000410702285
  error estimate for blocks of size 2^( 5) =       0.000416299836
  error estimate for blocks of size 2^( 6) =       0.000418007097
  error estimate for blocks of size 2^( 7) =       0.000420408800

      target function =      -0.943024700657
              le_mean =     -17.212273753477
             les_mean =     296.543461984898
             stat err =       0.000416354505
             autocorr =       1.233401290120
   target nu stat err =       0.000416354505
   target dn stat err =       0.002468642096
      target stat err =       0.004238877960
              std dev =       0.530183327553
             le_variance =       0.281094360816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280912504682
                                         uncertainty =       0.002337878089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280912504682
                                         uncertainty =       0.002337878089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374896226
  error estimate for blocks of size 2^( 2) =       0.000388564543
  error estimate for blocks of size 2^( 3) =       0.000401631960
  error estimate for blocks of size 2^( 4) =       0.000410702285
  error estimate for blocks of size 2^( 5) =       0.000416299836
  error estimate for blocks of size 2^( 6) =       0.000418007097
  error estimate for blocks of size 2^( 7) =       0.000420408800

      target function =      -0.943024700657
              le_mean =     -17.212273753477
             les_mean =     296.543461984898
             stat err =       0.000416354505
             autocorr =       1.233401290120
   target nu stat err =       0.000416354505
   target dn stat err =       0.002468642096
      target stat err =       0.004238877960
              std dev =       0.530183327553
             le_variance =       0.281094360816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280912504682
                                         uncertainty =       0.002337878089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280912504682
                                         uncertainty =       0.002337878089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374896226
  error estimate for blocks of size 2^( 2) =       0.000388564543
  error estimate for blocks of size 2^( 3) =       0.000401631960
  error estimate for blocks of size 2^( 4) =       0.000410702285
  error estimate for blocks of size 2^( 5) =       0.000416299836
  error estimate for blocks of size 2^( 6) =       0.000418007097
  error estimate for blocks of size 2^( 7) =       0.000420408800

      target function =      -0.943024700657
              le_mean =     -17.212273753477
             les_mean =     296.543461984898
             stat err =       0.000416354505
             autocorr =       1.233401290120
   target nu stat err =       0.000416354505
   target dn stat err =       0.002468642096
      target stat err =       0.004238877960
              std dev =       0.530183327553
             le_variance =       0.281094360816


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943024700657        initial  <--
     5.8208e+16     5.8208e+17             2.3117e-21        -0.943024700657
     2.3283e+17     2.3283e+18             5.7793e-22        -0.943024700657
     9.3132e+17     9.3132e+18             1.4448e-22        -0.943024700657

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0168
  </log>
  <optVariables href="H2O.s055.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4884e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.1875
    reference variance = 0.262583
====================================================
  Execution time = 1.9841e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8176e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4884e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281802804455
                                         uncertainty =       0.003025746270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281802804455
                                         uncertainty =       0.003025746270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375340828
  error estimate for blocks of size 2^( 2) =       0.000388849014
  error estimate for blocks of size 2^( 3) =       0.000401473228
  error estimate for blocks of size 2^( 4) =       0.000409936811
  error estimate for blocks of size 2^( 5) =       0.000416349568
  error estimate for blocks of size 2^( 6) =       0.000419263294
  error estimate for blocks of size 2^( 7) =       0.000421217338

      target function =      -0.941903432811
              le_mean =     -17.211405281479
             les_mean =     296.514233097010
             stat err =       0.000416691753
             autocorr =       1.232475213701
   target nu stat err =       0.000416691753
   target dn stat err =       0.002928929109
      target stat err =       0.004986740469
              std dev =       0.530812089703
             le_variance =       0.281761474575


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721140528148e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+17, overlap shift 5.8208e+18 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941928757113       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941928757113       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+17 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+18, overlap shift 2.3283e+19 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941928757113       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941928757113       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+18, overlap shift 9.3132e+19 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941928757113       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941928757113       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.507469 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5342e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.1011
    reference variance = 0.339501
====================================================
  Execution time = 1.9840e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8119e-01
  Total weights = 2.0000e+06
  Execution time = 1.8643e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281140635846
                                         uncertainty =       0.002603850379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281140635846
                                         uncertainty =       0.002603850379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374959959
  error estimate for blocks of size 2^( 2) =       0.000387973491
  error estimate for blocks of size 2^( 3) =       0.000400345663
  error estimate for blocks of size 2^( 4) =       0.000409080164
  error estimate for blocks of size 2^( 5) =       0.000413838477
  error estimate for blocks of size 2^( 6) =       0.000415726021
  error estimate for blocks of size 2^( 7) =       0.000417405138

      target function =      -0.942861923295
              le_mean =     -17.212105516684
             les_mean =     296.537766118944
             stat err =       0.000414012450
             autocorr =       1.219149643445
   target nu stat err =       0.000414012450
   target dn stat err =       0.002686462829
      target stat err =       0.004598059976
              std dev =       0.530273459702
             le_variance =       0.281189942064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281140635846
                                         uncertainty =       0.002603850379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281140635846
                                         uncertainty =       0.002603850379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374959959
  error estimate for blocks of size 2^( 2) =       0.000387973491
  error estimate for blocks of size 2^( 3) =       0.000400345663
  error estimate for blocks of size 2^( 4) =       0.000409080164
  error estimate for blocks of size 2^( 5) =       0.000413838477
  error estimate for blocks of size 2^( 6) =       0.000415726021
  error estimate for blocks of size 2^( 7) =       0.000417405138

      target function =      -0.942861923295
              le_mean =     -17.212105516684
             les_mean =     296.537766118944
             stat err =       0.000414012450
             autocorr =       1.219149643445
   target nu stat err =       0.000414012450
   target dn stat err =       0.002686462829
      target stat err =       0.004598059976
              std dev =       0.530273459702
             le_variance =       0.281189942064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281140635846
                                         uncertainty =       0.002603850379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281140635846
                                         uncertainty =       0.002603850379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374959959
  error estimate for blocks of size 2^( 2) =       0.000387973491
  error estimate for blocks of size 2^( 3) =       0.000400345663
  error estimate for blocks of size 2^( 4) =       0.000409080164
  error estimate for blocks of size 2^( 5) =       0.000413838477
  error estimate for blocks of size 2^( 6) =       0.000415726021
  error estimate for blocks of size 2^( 7) =       0.000417405138

      target function =      -0.942861923295
              le_mean =     -17.212105516684
             les_mean =     296.537766118944
             stat err =       0.000414012450
             autocorr =       1.219149643445
   target nu stat err =       0.000414012450
   target dn stat err =       0.002686462829
      target stat err =       0.004598059976
              std dev =       0.530273459702
             le_variance =       0.281189942064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281140635846
                                         uncertainty =       0.002603850379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281140635846
                                         uncertainty =       0.002603850379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374959959
  error estimate for blocks of size 2^( 2) =       0.000387973491
  error estimate for blocks of size 2^( 3) =       0.000400345663
  error estimate for blocks of size 2^( 4) =       0.000409080164
  error estimate for blocks of size 2^( 5) =       0.000413838477
  error estimate for blocks of size 2^( 6) =       0.000415726021
  error estimate for blocks of size 2^( 7) =       0.000417405138

      target function =      -0.942861923295
              le_mean =     -17.212105516684
             les_mean =     296.537766118944
             stat err =       0.000414012450
             autocorr =       1.219149643445
   target nu stat err =       0.000414012450
   target dn stat err =       0.002686462829
      target stat err =       0.004598059976
              std dev =       0.530273459702
             le_variance =       0.281189942064


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942861923295        initial  <--
     5.8208e+17     5.8208e+18             0.0000e+00        -0.942861923295
     2.3283e+18     2.3283e+19             0.0000e+00        -0.942861923295
     9.3132e+18     9.3132e+19             0.0000e+00        -0.942861923295

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2550
  </log>
  <optVariables href="H2O.s056.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4602e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.2162
    reference variance = 0.410971
====================================================
  Execution time = 2.2154e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9196e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5251e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291970453850
                                         uncertainty =       0.007219804567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291970453850
                                         uncertainty =       0.007219804567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382075860
  error estimate for blocks of size 2^( 2) =       0.000395641558
  error estimate for blocks of size 2^( 3) =       0.000408125971
  error estimate for blocks of size 2^( 4) =       0.000416305322
  error estimate for blocks of size 2^( 5) =       0.000422426280
  error estimate for blocks of size 2^( 6) =       0.000425248794
  error estimate for blocks of size 2^( 7) =       0.000425330587

      target function =      -0.924886266373
              le_mean =     -17.212081209333
             les_mean =     296.547703335980
             stat err =       0.000422327746
             autocorr =       1.221799744322
   target nu stat err =       0.000422327746
   target dn stat err =       0.007125558015
      target stat err =       0.011606342167
              std dev =       0.540336862786
             le_variance =       0.291963925285


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721208120933e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+18, overlap shift 5.8208e+19 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925029791573       residual = 2.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925029791573       residual = 2.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+18 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+19, overlap shift 2.3283e+20 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925029791573       residual = 2.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925029791573       residual = 2.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+19, overlap shift 9.3132e+20 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.925029791573       residual = 2.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.925029791573       residual = 2.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+19 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.508569 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7691e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.2041
    reference variance = 0.194512
====================================================
  Execution time = 1.9616e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8162e-01
  Total weights = 2.0000e+06
  Execution time = 1.8607e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281686625312
                                         uncertainty =       0.003133872312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281686625312
                                         uncertainty =       0.003133872312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375248959
  error estimate for blocks of size 2^( 2) =       0.000389081930
  error estimate for blocks of size 2^( 3) =       0.000401174882
  error estimate for blocks of size 2^( 4) =       0.000409683484
  error estimate for blocks of size 2^( 5) =       0.000415955593
  error estimate for blocks of size 2^( 6) =       0.000418861193
  error estimate for blocks of size 2^( 7) =       0.000420446019

      target function =      -0.942122950412
              le_mean =     -17.212236204447
             les_mean =     296.542698579951
             stat err =       0.000416236572
             autocorr =       1.230386280177
   target nu stat err =       0.000416236572
   target dn stat err =       0.002988379480
      target stat err =       0.005095991427
              std dev =       0.530682167662
             le_variance =       0.281623563075

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281686625312
                                         uncertainty =       0.003133872312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281686625312
                                         uncertainty =       0.003133872312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375248959
  error estimate for blocks of size 2^( 2) =       0.000389081930
  error estimate for blocks of size 2^( 3) =       0.000401174882
  error estimate for blocks of size 2^( 4) =       0.000409683484
  error estimate for blocks of size 2^( 5) =       0.000415955593
  error estimate for blocks of size 2^( 6) =       0.000418861193
  error estimate for blocks of size 2^( 7) =       0.000420446019

      target function =      -0.942122950412
              le_mean =     -17.212236204447
             les_mean =     296.542698579951
             stat err =       0.000416236572
             autocorr =       1.230386280177
   target nu stat err =       0.000416236572
   target dn stat err =       0.002988379480
      target stat err =       0.005095991427
              std dev =       0.530682167662
             le_variance =       0.281623563075

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281686625312
                                         uncertainty =       0.003133872312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281686625312
                                         uncertainty =       0.003133872312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375248959
  error estimate for blocks of size 2^( 2) =       0.000389081930
  error estimate for blocks of size 2^( 3) =       0.000401174882
  error estimate for blocks of size 2^( 4) =       0.000409683484
  error estimate for blocks of size 2^( 5) =       0.000415955593
  error estimate for blocks of size 2^( 6) =       0.000418861193
  error estimate for blocks of size 2^( 7) =       0.000420446019

      target function =      -0.942122950412
              le_mean =     -17.212236204447
             les_mean =     296.542698579951
             stat err =       0.000416236572
             autocorr =       1.230386280177
   target nu stat err =       0.000416236572
   target dn stat err =       0.002988379480
      target stat err =       0.005095991427
              std dev =       0.530682167662
             le_variance =       0.281623563075

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281686625312
                                         uncertainty =       0.003133872312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281686625312
                                         uncertainty =       0.003133872312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375248959
  error estimate for blocks of size 2^( 2) =       0.000389081930
  error estimate for blocks of size 2^( 3) =       0.000401174882
  error estimate for blocks of size 2^( 4) =       0.000409683484
  error estimate for blocks of size 2^( 5) =       0.000415955593
  error estimate for blocks of size 2^( 6) =       0.000418861193
  error estimate for blocks of size 2^( 7) =       0.000420446019

      target function =      -0.942122950412
              le_mean =     -17.212236204447
             les_mean =     296.542698579951
             stat err =       0.000416236572
             autocorr =       1.230386280177
   target nu stat err =       0.000416236572
   target dn stat err =       0.002988379480
      target stat err =       0.005095991427
              std dev =       0.530682167662
             le_variance =       0.281623563075


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942122950412        initial  <--
     5.8208e+18     5.8208e+19             0.0000e+00        -0.942122950412
     2.3283e+19     2.3283e+20             0.0000e+00        -0.942122950412
     9.3132e+19     9.3132e+20             0.0000e+00        -0.942122950412

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0422
  </log>
  <optVariables href="H2O.s057.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6739e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2162
    reference variance = 0.232017
====================================================
  Execution time = 2.0138e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7693e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4863e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276998486542
                                         uncertainty =       0.002200262947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276998486542
                                         uncertainty =       0.002200262947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372105827
  error estimate for blocks of size 2^( 2) =       0.000386077100
  error estimate for blocks of size 2^( 3) =       0.000398465568
  error estimate for blocks of size 2^( 4) =       0.000407382218
  error estimate for blocks of size 2^( 5) =       0.000412379670
  error estimate for blocks of size 2^( 6) =       0.000416173397
  error estimate for blocks of size 2^( 7) =       0.000421410808

      target function =      -0.950128810064
              le_mean =     -17.212128384434
             les_mean =     296.534288876165
             stat err =       0.000414336523
             autocorr =       1.239862411899
   target nu stat err =       0.000414336523
   target dn stat err =       0.002122221397
      target stat err =       0.003716411929
              std dev =       0.526237106636
             le_variance =       0.276925492400


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721212838443e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+19, overlap shift 5.8208e+20 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950142277861       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950142277861       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950142277861       residual = 8.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.950142277861       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950142277861       residual = 4.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+19 is 4.669855e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+20, overlap shift 2.3283e+21 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950142277861       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950142277861       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950142277861       residual = 8.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.950142277861       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950142235212       residual = 2.75e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+20 is 6.122541e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+20, overlap shift 9.3132e+21 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950142277861       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950142277861       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950142277861       residual = 8.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.950142277861       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950142279267       residual = 3.56e+04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.950141003941       residual = 1.15e+04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.952659120999       residual = 4.65e+03           smallest_sin_value = 1.00e+00
davidson iteration    7 stopping due to too large eigenvalue change
davidson solver did not converge after          7 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+20 is 1.530635e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.510740 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5638e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2022
    reference variance = 0.170449
====================================================
  Execution time = 1.9683e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.1512e-01
  Total weights = 2.0000e+06
  Execution time = 1.8586e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315222944589
                                         uncertainty =       0.034538895902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315222944589
                                         uncertainty =       0.034538895902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396936684
  error estimate for blocks of size 2^( 2) =       0.000409991346
  error estimate for blocks of size 2^( 3) =       0.000421448897
  error estimate for blocks of size 2^( 4) =       0.000429854708
  error estimate for blocks of size 2^( 5) =       0.000435599775
  error estimate for blocks of size 2^( 6) =       0.000437805848
  error estimate for blocks of size 2^( 7) =       0.000439204402

      target function =      -0.885808005562
              le_mean =     -17.212291918141
             les_mean =     296.578110379918
             stat err =       0.000435616183
             autocorr =       1.204385551397
   target nu stat err =       0.000435616183
   target dn stat err =       0.034704120190
      target stat err =       0.051940085814
              std dev =       0.561353241874
             le_variance =       0.315117462163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315222944589
                                         uncertainty =       0.034538895902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315222944589
                                         uncertainty =       0.034538895902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396936684
  error estimate for blocks of size 2^( 2) =       0.000409991346
  error estimate for blocks of size 2^( 3) =       0.000421448897
  error estimate for blocks of size 2^( 4) =       0.000429854708
  error estimate for blocks of size 2^( 5) =       0.000435599775
  error estimate for blocks of size 2^( 6) =       0.000437805848
  error estimate for blocks of size 2^( 7) =       0.000439204402

      target function =      -0.885808005562
              le_mean =     -17.212291918141
             les_mean =     296.578110379918
             stat err =       0.000435616183
             autocorr =       1.204385551398
   target nu stat err =       0.000435616183
   target dn stat err =       0.034704120190
      target stat err =       0.051940085814
              std dev =       0.561353241874
             le_variance =       0.315117462163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315222944589
                                         uncertainty =       0.034538895902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315222944589
                                         uncertainty =       0.034538895902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396936684
  error estimate for blocks of size 2^( 2) =       0.000409991346
  error estimate for blocks of size 2^( 3) =       0.000421448897
  error estimate for blocks of size 2^( 4) =       0.000429854708
  error estimate for blocks of size 2^( 5) =       0.000435599775
  error estimate for blocks of size 2^( 6) =       0.000437805848
  error estimate for blocks of size 2^( 7) =       0.000439204402

      target function =      -0.885808005562
              le_mean =     -17.212291918141
             les_mean =     296.578110379918
             stat err =       0.000435616183
             autocorr =       1.204385551398
   target nu stat err =       0.000435616183
   target dn stat err =       0.034704120190
      target stat err =       0.051940085814
              std dev =       0.561353241874
             le_variance =       0.315117462163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315222944589
                                         uncertainty =       0.034538895902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.315222944589
                                         uncertainty =       0.034538895902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000396936684
  error estimate for blocks of size 2^( 2) =       0.000409991346
  error estimate for blocks of size 2^( 3) =       0.000421448897
  error estimate for blocks of size 2^( 4) =       0.000429854708
  error estimate for blocks of size 2^( 5) =       0.000435599775
  error estimate for blocks of size 2^( 6) =       0.000437805848
  error estimate for blocks of size 2^( 7) =       0.000439204402

      target function =      -0.885808005562
              le_mean =     -17.212291918141
             les_mean =     296.578110379918
             stat err =       0.000435616183
             autocorr =       1.204385551398
   target nu stat err =       0.000435616183
   target dn stat err =       0.034704120190
      target stat err =       0.051940085814
              std dev =       0.561353241874
             le_variance =       0.315117462163


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.885808005562        initial  <--
     5.8208e+19     5.8208e+20             4.6699e-24        -0.885808005562
     2.3283e+20     2.3283e+21             6.1225e-25        -0.885808005562
     9.3132e+20     9.3132e+21             1.5306e-25        -0.885808005562

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1131
  </log>
  <optVariables href="H2O.s058.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4756e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.2087
    reference variance = 0.262374
====================================================
  Execution time = 2.0091e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8537e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4832e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285436022967
                                         uncertainty =       0.004878180560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285436022967
                                         uncertainty =       0.004878180560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377734332
  error estimate for blocks of size 2^( 2) =       0.000391068060
  error estimate for blocks of size 2^( 3) =       0.000402739153
  error estimate for blocks of size 2^( 4) =       0.000412117089
  error estimate for blocks of size 2^( 5) =       0.000417051482
  error estimate for blocks of size 2^( 6) =       0.000418204713
  error estimate for blocks of size 2^( 7) =       0.000421314109

      target function =      -0.935820505275
              le_mean =     -17.211876025106
             les_mean =     296.534042612538
             stat err =       0.000417171848
             autocorr =       1.219711356648
   target nu stat err =       0.000417171848
   target dn stat err =       0.004740434422
      target stat err =       0.007919889353
              std dev =       0.534197015735
             le_variance =       0.285366451620


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721187602511e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+20, overlap shift 5.8208e+21 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935886808590       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935886808590       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935886808590       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.8208e+20 is 1.861137e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 2.3283e+21, overlap shift 2.3283e+22 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935886808590       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935886808590       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935886808590       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3283e+21 is 4.652842e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 9.3132e+21, overlap shift 9.3132e+22 and omega -1.7738e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935886808590       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935886808590       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935886808590       residual = 8.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935886808892       residual = 1.84e+06           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+21 is 1.359941e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.512157 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5587e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.1697
    reference variance = 0.215647
====================================================
  Execution time = 1.9835e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8065e-01
  Total weights = 2.0000e+06
  Execution time = 1.8602e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280747811962
                                         uncertainty =       0.002157520215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280747811962
                                         uncertainty =       0.002157520215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374600204
  error estimate for blocks of size 2^( 2) =       0.000388445477
  error estimate for blocks of size 2^( 3) =       0.000400790601
  error estimate for blocks of size 2^( 4) =       0.000410158459
  error estimate for blocks of size 2^( 5) =       0.000415669797
  error estimate for blocks of size 2^( 6) =       0.000417985025
  error estimate for blocks of size 2^( 7) =       0.000418679805

      target function =      -0.943769569396
              le_mean =     -17.212831521807
             les_mean =     296.562219483463
             stat err =       0.000415623271
             autocorr =       1.231015988567
   target nu stat err =       0.000415623271
   target dn stat err =       0.002339281594
      target stat err =       0.004034099768
              std dev =       0.529764688971
             le_variance =       0.280650625680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280747811962
                                         uncertainty =       0.002157520215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280747811962
                                         uncertainty =       0.002157520215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374600204
  error estimate for blocks of size 2^( 2) =       0.000388445477
  error estimate for blocks of size 2^( 3) =       0.000400790601
  error estimate for blocks of size 2^( 4) =       0.000410158459
  error estimate for blocks of size 2^( 5) =       0.000415669797
  error estimate for blocks of size 2^( 6) =       0.000417985025
  error estimate for blocks of size 2^( 7) =       0.000418679805

      target function =      -0.943769569396
              le_mean =     -17.212831521807
             les_mean =     296.562219483463
             stat err =       0.000415623271
             autocorr =       1.231015988567
   target nu stat err =       0.000415623271
   target dn stat err =       0.002339281594
      target stat err =       0.004034099768
              std dev =       0.529764688971
             le_variance =       0.280650625680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280747811962
                                         uncertainty =       0.002157520215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280747811962
                                         uncertainty =       0.002157520215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374600204
  error estimate for blocks of size 2^( 2) =       0.000388445477
  error estimate for blocks of size 2^( 3) =       0.000400790601
  error estimate for blocks of size 2^( 4) =       0.000410158459
  error estimate for blocks of size 2^( 5) =       0.000415669797
  error estimate for blocks of size 2^( 6) =       0.000417985025
  error estimate for blocks of size 2^( 7) =       0.000418679805

      target function =      -0.943769569396
              le_mean =     -17.212831521807
             les_mean =     296.562219483463
             stat err =       0.000415623271
             autocorr =       1.231015988567
   target nu stat err =       0.000415623271
   target dn stat err =       0.002339281594
      target stat err =       0.004034099768
              std dev =       0.529764688971
             le_variance =       0.280650625680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280747811962
                                         uncertainty =       0.002157520215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280747811962
                                         uncertainty =       0.002157520215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374600204
  error estimate for blocks of size 2^( 2) =       0.000388445477
  error estimate for blocks of size 2^( 3) =       0.000400790601
  error estimate for blocks of size 2^( 4) =       0.000410158459
  error estimate for blocks of size 2^( 5) =       0.000415669797
  error estimate for blocks of size 2^( 6) =       0.000417985025
  error estimate for blocks of size 2^( 7) =       0.000418679805

      target function =      -0.943769569396
              le_mean =     -17.212831521807
             les_mean =     296.562219483463
             stat err =       0.000415623271
             autocorr =       1.231015988567
   target nu stat err =       0.000415623271
   target dn stat err =       0.002339281594
      target stat err =       0.004034099768
              std dev =       0.529764688971
             le_variance =       0.280650625680


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943769569396        initial  <--
     5.8208e+20     5.8208e+21             1.8611e-25        -0.943769569396
     2.3283e+21     2.3283e+22             4.6528e-26        -0.943769569396
     9.3132e+21     9.3132e+22             1.3599e-26        -0.943769569396

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2690
  </log>
  <optVariables href="H2O.s059.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4861e+01 secs
  Total Execution time = 3.3424e+03 secs

=========================================================
  A new xml input file : H2O.s059.cont.xml
