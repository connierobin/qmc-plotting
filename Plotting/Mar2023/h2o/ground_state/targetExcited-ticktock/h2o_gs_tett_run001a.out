Rank =    0  Free Memory = 85846 MB
Rank =    1  Free Memory = 85846 MB
Rank =    2  Free Memory = 85846 MB
Rank =    3  Free Memory = 85846 MB
Rank =    4  Free Memory = 85846 MB
Rank =    5  Free Memory = 85846 MB
Rank =    6  Free Memory = 85846 MB
Rank =    7  Free Memory = 85846 MB
Rank =    8  Free Memory = 85846 MB
Rank =    9  Free Memory = 85845 MB
Rank =   10  Free Memory = 85844 MB
Rank =   11  Free Memory = 85844 MB
Rank =   12  Free Memory = 85844 MB
Rank =   13  Free Memory = 85844 MB
Rank =   14  Free Memory = 85836 MB
Rank =   15  Free Memory = 85832 MB
Rank =   16  Free Memory = 85831 MB
Rank =   17  Free Memory = 85831 MB
Rank =   18  Free Memory = 85831 MB
Rank =   19  Free Memory = 85831 MB
Rank =   20  Free Memory = 85831 MB
Rank =   21  Free Memory = 85831 MB
Rank =   22  Free Memory = 85831 MB
Rank =   23  Free Memory = 85831 MB
Rank =   24  Free Memory = 85831 MB
Rank =   25  Free Memory = 85831 MB
Rank =   26  Free Memory = 85831 MB
Rank =   27  Free Memory = 85831 MB
Rank =   28  Free Memory = 85831 MB
Rank =   29  Free Memory = 85831 MB
Rank =   30  Free Memory = 85831 MB
Rank =   31  Free Memory = 85831 MB
Rank =   32  Free Memory = 74272 MB
Rank =   33  Free Memory = 74272 MB
Rank =   34  Free Memory = 74272 MB
Rank =   35  Free Memory = 74272 MB
Rank =   36  Free Memory = 74272 MB
Rank =   37  Free Memory = 74272 MB
Rank =   38  Free Memory = 74272 MB
Rank =   39  Free Memory = 74272 MB
Rank =   40  Free Memory = 74272 MB
Rank =   41  Free Memory = 74272 MB
Rank =   42  Free Memory = 74272 MB
Rank =   43  Free Memory = 74272 MB
Rank =   44  Free Memory = 74272 MB
Rank =   45  Free Memory = 74272 MB
Rank =   46  Free Memory = 74272 MB
Rank =   47  Free Memory = 74272 MB
Rank =   48  Free Memory = 74272 MB
Rank =   49  Free Memory = 74272 MB
Rank =   50  Free Memory = 74272 MB
Rank =   51  Free Memory = 74272 MB
Rank =   52  Free Memory = 74272 MB
Rank =   53  Free Memory = 74272 MB
Rank =   54  Free Memory = 74272 MB
Rank =   55  Free Memory = 74272 MB
Rank =   56  Free Memory = 74272 MB
Rank =   57  Free Memory = 74272 MB
Rank =   58  Free Memory = 74272 MB
Rank =   59  Free Memory = 74272 MB
Rank =   60  Free Memory = 74272 MB
Rank =   61  Free Memory = 74272 MB
Rank =   62  Free Memory = 74272 MB
Rank =   63  Free Memory = 74272 MB
Rank =   64  Free Memory = 72740 MB
Rank =   65  Free Memory = 72740 MB
Rank =   66  Free Memory = 72740 MB
Rank =   67  Free Memory = 72740 MB
Rank =   68  Free Memory = 72740 MB
Rank =   69  Free Memory = 72740 MB
Rank =   70  Free Memory = 72740 MB
Rank =   71  Free Memory = 72740 MB
Rank =   72  Free Memory = 72740 MB
Rank =   73  Free Memory = 72740 MB
Rank =   74  Free Memory = 72740 MB
Rank =   75  Free Memory = 72740 MB
Rank =   76  Free Memory = 72740 MB
Rank =   77  Free Memory = 72740 MB
Rank =   78  Free Memory = 72740 MB
Rank =   79  Free Memory = 72740 MB
Rank =   80  Free Memory = 72740 MB
Rank =   81  Free Memory = 72740 MB
Rank =   82  Free Memory = 72740 MB
Rank =   83  Free Memory = 72740 MB
Rank =   84  Free Memory = 72740 MB
Rank =   85  Free Memory = 72740 MB
Rank =   86  Free Memory = 72740 MB
Rank =   87  Free Memory = 72740 MB
Rank =   88  Free Memory = 72740 MB
Rank =   89  Free Memory = 72740 MB
Rank =   90  Free Memory = 72740 MB
Rank =   91  Free Memory = 72740 MB
Rank =   92  Free Memory = 72740 MB
Rank =   93  Free Memory = 72740 MB
Rank =   94  Free Memory = 72740 MB
Rank =   95  Free Memory = 72740 MB
Rank =   96  Free Memory = 86604 MB
Rank =   97  Free Memory = 86604 MB
Rank =   98  Free Memory = 86604 MB
Rank =   99  Free Memory = 86604 MB
Rank =  100  Free Memory = 86604 MB
Rank =  101  Free Memory = 86604 MB
Rank =  102  Free Memory = 86604 MB
Rank =  103  Free Memory = 86604 MB
Rank =  104  Free Memory = 86604 MB
Rank =  105  Free Memory = 86604 MB
Rank =  106  Free Memory = 86604 MB
Rank =  107  Free Memory = 86604 MB
Rank =  108  Free Memory = 86604 MB
Rank =  109  Free Memory = 86604 MB
Rank =  110  Free Memory = 86604 MB
Rank =  111  Free Memory = 86604 MB
Rank =  112  Free Memory = 86604 MB
Rank =  113  Free Memory = 86604 MB
Rank =  114  Free Memory = 86604 MB
Rank =  115  Free Memory = 86604 MB
Rank =  116  Free Memory = 86604 MB
Rank =  117  Free Memory = 86604 MB
Rank =  118  Free Memory = 86604 MB
Rank =  119  Free Memory = 86604 MB
Rank =  120  Free Memory = 86604 MB
Rank =  121  Free Memory = 86604 MB
Rank =  122  Free Memory = 86604 MB
Rank =  123  Free Memory = 86604 MB
Rank =  124  Free Memory = 86604 MB
Rank =  125  Free Memory = 86604 MB
Rank =  126  Free Memory = 86604 MB
Rank =  127  Free Memory = 86604 MB
  Input file(s): opt_h2o_gs_tett_run001a.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_tett_run001a.xml

  Project = H2O
  date    = 2023-03-06 11:01:15 PST
  host    = n0089.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 123

  Range of prime numbers to use as seeds over processors and threads = 691-1607


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 1.920054e-01    1         1 OFF
     uu_1                 3.590195e-02    1         1 OFF
     uu_2                -4.559320e-02    1         1 OFF
     uu_3                -9.369633e-02    1         1 OFF
     uu_4                -1.254424e-01    1         1 OFF
     uu_5                -1.327025e-01    1         1 OFF
     uu_6                -1.091659e-01    1         1 OFF
     uu_7                -3.320891e-02    1         1 OFF
     uu_8                 1.030981e-01    1         1 OFF
     uu_9                 1.188130e-01    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.150780e-01    1         1 OFF
     ud_1                 7.590189e-02    1         1 OFF
     ud_2                -7.338664e-03    1         1 OFF
     ud_3                -5.544926e-02    1         1 OFF
     ud_4                -1.064782e-01    1         1 OFF
     ud_5                -1.490405e-01    1         1 OFF
     ud_6                -1.574171e-01    1         1 OFF
     ud_7                -1.077761e-01    1         1 OFF
     ud_8                 9.772284e-03    1         1 OFF
     ud_9                 9.249491e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -6.811694e-01    1         1 OFF
     eO_1                -4.031104e-01    1         1 OFF
     eO_2                -6.148616e-02    1         1 OFF
     eO_3                 1.622033e-01    1         1 OFF
     eO_4                 2.643764e-01    1         1 OFF
     eO_5                 3.070668e-01    1         1 OFF
     eO_6                 2.482256e-01    1         1 OFF
     eO_7                 1.081366e-01    1         1 OFF
     eO_8                 2.727328e-02    1         1 OFF
     eO_9                 1.812982e-02    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.758229e-01    1         1 OFF
     eH1_1                -9.847470e-02    1         1 OFF
     eH1_2                -6.212571e-02    1         1 OFF
     eH1_3                -2.890051e-02    1         1 OFF
     eH1_4                 1.766763e-02    1         1 OFF
     eH1_5                 3.105966e-02    1         1 OFF
     eH1_6                 7.793809e-02    1         1 OFF
     eH1_7                 1.115220e-01    1         1 OFF
     eH1_8                 8.853209e-02    1         1 OFF
     eH1_9                 2.358450e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.775251e-01    1         1 OFF
     eH2_1                -1.001865e-01    1         1 OFF
     eH2_2                -6.424989e-02    1         1 OFF
     eH2_3                -3.037191e-02    1         1 OFF
     eH2_4                 1.621523e-02    1         1 OFF
     eH2_5                 3.146665e-02    1         1 OFF
     eH2_6                 8.031567e-02    1         1 OFF
     eH2_7                 1.152651e-01    1         1 OFF
     eH2_8                 9.158550e-02    1         1 OFF
     eH2_9                 2.561491e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.955546e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.9341e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 69
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.23
    reference variance = 0.619454
====================================================
  Execution time = 1.4671e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5257e+04
  VMC Eavg = -1.7200e+01
  VMC Evar = 4.2089e-01
  Total weights = 1.953826033e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5078e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.396448546559
                                         uncertainty =       0.003189745241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.396448546559
                                         uncertainty =       0.003189745241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000445325647
  error estimate for blocks of size 2^( 2) =       0.000456816743
  error estimate for blocks of size 2^( 3) =       0.000466710439
  error estimate for blocks of size 2^( 4) =       0.000472710383
  error estimate for blocks of size 2^( 5) =       0.000476781335
  error estimate for blocks of size 2^( 6) =       0.000479181430
  error estimate for blocks of size 2^( 7) =       0.000477927807

      target function =      -0.770626903564
              le_mean =     -17.200490300876
             les_mean =     296.277756758910
             stat err =       0.000476650239
             autocorr =       1.145629572490
   target nu stat err =       0.000476650239
   target dn stat err =       0.004476640476
      target stat err =       0.004088643074
              std dev =       0.629785569049
             le_variance =       0.396629862983


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.720049030088e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.770647413128       residual = 1.75e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.793749015373       residual = 3.03e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.798180392128       residual = 7.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.799400248139       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.799561391577       residual = 2.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.799596753267       residual = 9.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.799606209248       residual = 1.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.799609204546       residual = 5.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.799610274337       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.799610453935       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.799610709400       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.799610700058       residual = 8.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.799610705382       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.799610712858       residual = 1.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 5.651892e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.770647413128       residual = 1.75e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.777350644596       residual = 2.80e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.778564369107       residual = 6.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.778878563187       residual = 9.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.778918617917       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.778927118032       residual = 6.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.778929038684       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.778929636751       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.778929862782       residual = 7.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.778929900384       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.778929957412       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.778929953924       residual = 4.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.778929955049       residual = 7.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.692378e-03

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.770647413128       residual = 1.75e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.772390742024       residual = 2.73e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.772700225217       residual = 6.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.772778787416       residual = 8.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.772788694363       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.772790777732       residual = 5.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.772791227312       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.772791365349       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.772791417337       residual = 6.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.772791426260       residual = 8.77e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.772791439886       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.772791438952       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.772791439224       residual = 5.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 4.442822e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.009070 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7194e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_001 -6.497440e-02                3 1 ON  0
ci_002 -5.057202e-02                3 1 ON  1
ci_003 -3.623205e-02                3 1 ON  2
ci_004 3.575462e-02                 3 1 ON  3
ci_005 3.581832e-02                 3 1 ON  4
ci_006 -3.459534e-02                3 1 ON  5
ci_007 -3.457616e-02                3 1 ON  6
ci_008 -2.984622e-02                3 1 ON  7
ci_009 -2.841216e-02                3 1 ON  8
ci_010 -2.782073e-02                3 1 ON  9
ci_011 -2.738403e-02                3 1 ON  10
ci_012 -2.742732e-02                3 1 ON  11
ci_013 -2.650454e-02                3 1 ON  12
ci_014 2.577829e-02                 3 1 ON  13
ci_015 2.576165e-02                 3 1 ON  14
ci_016 2.505091e-02                 3 1 ON  15
ci_017 2.501833e-02                 3 1 ON  16
ci_018 2.411255e-02                 3 1 ON  17
ci_019 2.412190e-02                 3 1 ON  18
ci_020 2.428612e-02                 3 1 ON  19
ci_021 2.436766e-02                 3 1 ON  20
ci_022 2.123466e-02                 3 1 ON  21
ci_023 2.118512e-02                 3 1 ON  22
ci_024 2.116692e-02                 3 1 ON  23
ci_025 2.117946e-02                 3 1 ON  24
ci_026 2.110791e-02                 3 1 ON  25
ci_027 2.097055e-02                 3 1 ON  26
ci_028 -2.082774e-02                3 1 ON  27
ci_029 -2.090581e-02                3 1 ON  28
ci_030 -1.940183e-02                3 1 ON  29
ci_031 -1.935069e-02                3 1 ON  30
ci_032 -1.841644e-02                3 1 ON  31
ci_033 1.766842e-02                 3 1 ON  32
ci_034 1.759799e-02                 3 1 ON  33
ci_035 -1.729614e-02                3 1 ON  34
ci_036 -1.787156e-02                3 1 ON  35
ci_037 -1.791723e-02                3 1 ON  36
ci_038 1.655107e-02                 3 1 ON  37
ci_039 1.659640e-02                 3 1 ON  38
ci_040 -1.576739e-02                3 1 ON  39
ci_041 1.606392e-02                 3 1 ON  40
ci_042 1.610440e-02                 3 1 ON  41
ci_043 -1.541105e-02                3 1 ON  42
ci_044 -1.529081e-02                3 1 ON  43
ci_045 -1.494958e-02                3 1 ON  44
ci_046 1.449401e-02                 3 1 ON  45
ci_047 1.448039e-02                 3 1 ON  46
ci_048 -1.445926e-02                3 1 ON  47
ci_049 -1.442409e-02                3 1 ON  48
ci_050 1.295817e-02                 3 1 ON  49
ci_051 1.289156e-02                 3 1 ON  50
ci_052 -1.201593e-02                3 1 ON  51
ci_053 -1.212965e-02                3 1 ON  52
ci_054 -1.207074e-02                3 1 ON  53
ci_055 -1.204908e-02                3 1 ON  54
ci_056 1.210917e-02                 3 1 ON  55
ci_057 1.208811e-02                 3 1 ON  56
ci_058 -1.168310e-02                3 1 ON  57
ci_059 -1.175567e-02                3 1 ON  58
ci_060 1.152807e-02                 3 1 ON  59
ci_061 1.152610e-02                 3 1 ON  60
ci_062 -1.110090e-02                3 1 ON  61
ci_063 -1.106167e-02                3 1 ON  62
ci_064 -1.044558e-02                3 1 ON  63
ci_065 -1.038368e-02                3 1 ON  64
ci_066 1.034370e-02                 3 1 ON  65
ci_067 1.036206e-02                 3 1 ON  66
ci_068 -9.739274e-03                3 1 ON  67
ci_069 -9.770999e-03                3 1 ON  68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.24
    reference variance = 0.209974
====================================================
  Execution time = 1.3637e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7202e+01
  VMC Evar = 3.9651e-01
  Total weights = 1.9542e+06
  Execution time = 1.8338e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.397527868965
                                         uncertainty =       0.005106666653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.397527868965
                                         uncertainty =       0.005106666653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000446024922
  error estimate for blocks of size 2^( 2) =       0.000457324593
  error estimate for blocks of size 2^( 3) =       0.000465977743
  error estimate for blocks of size 2^( 4) =       0.000473500809
  error estimate for blocks of size 2^( 5) =       0.000476157816
  error estimate for blocks of size 2^( 6) =       0.000478788547
  error estimate for blocks of size 2^( 7) =       0.000477814719

      target function =      -0.061650336629
              le_mean =     -17.202246790656
             les_mean =     301.589723658230
             stat err =       0.000476565473
             autocorr =       1.141634007384
   target nu stat err =       0.000476565473
   target dn stat err =       5.252280364602
      target stat err =       0.053074013765
              std dev =       0.630774493802
             le_variance =       0.397876462031

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.420314554031
                                         uncertainty =       0.063268173497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.420314554031
                                         uncertainty =       0.063268173497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000458488936
  error estimate for blocks of size 2^( 2) =       0.000468523276
  error estimate for blocks of size 2^( 3) =       0.000476271127
  error estimate for blocks of size 2^( 4) =       0.000483103814
  error estimate for blocks of size 2^( 5) =       0.000485540748
  error estimate for blocks of size 2^( 6) =       0.000488662359
  error estimate for blocks of size 2^( 7) =       0.000488231138

      target function =      -0.599456354550
              le_mean =     -17.202680060886
             les_mean =     296.577541026442
             stat err =       0.000486384515
             autocorr =       1.125386650804
   target nu stat err =       0.000486384515
   target dn stat err =       0.139245845784
      target stat err =       0.077768734691
              std dev =       0.648401271210
             le_variance =       0.420424208506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359754002633
                                         uncertainty =       0.002848947025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.359754002633
                                         uncertainty =       0.002848947025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000424307881
  error estimate for blocks of size 2^( 2) =       0.000435432630
  error estimate for blocks of size 2^( 3) =       0.000444062410
  error estimate for blocks of size 2^( 4) =       0.000451495315
  error estimate for blocks of size 2^( 5) =       0.000454131552
  error estimate for blocks of size 2^( 6) =       0.000456665950
  error estimate for blocks of size 2^( 7) =       0.000455706089

      target function =      -0.796618997945
              le_mean =     -17.202350349979
             les_mean =     296.314032580945
             stat err =       0.000454499726
             autocorr =       1.147374133022
   target nu stat err =       0.000454499726
   target dn stat err =       0.006386552219
      target stat err =       0.006216886962
              std dev =       0.600061960531
             le_variance =       0.360074356476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.388102132654
                                         uncertainty =       0.003002427385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.388102132654
                                         uncertainty =       0.003002427385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000440715947
  error estimate for blocks of size 2^( 2) =       0.000452018193
  error estimate for blocks of size 2^( 3) =       0.000460685333
  error estimate for blocks of size 2^( 4) =       0.000468192859
  error estimate for blocks of size 2^( 5) =       0.000470872342
  error estimate for blocks of size 2^( 6) =       0.000473357026
  error estimate for blocks of size 2^( 7) =       0.000472312270

      target function =      -0.767447100141
              le_mean =     -17.202168338754
             les_mean =     296.339000483237
             stat err =       0.000471183624
             autocorr =       1.143043733151
   target nu stat err =       0.000471183624
   target dn stat err =       0.006617331933
      target stat err =       0.005978598842
              std dev =       0.623266468815
             le_variance =       0.388461091149


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.061650336629        initial
     2.5000e-01     2.5000e+00             5.6519e-03        -0.599456354550  <--
            N/A            N/A                    N/A                    N/A     bad update
            N/A            N/A                    N/A                    N/A     bad update

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.3050e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_001                -6.140333e-02 3 1  ON 0
ci_002                -4.765994e-02 3 1  ON 1
ci_003                -3.471542e-02 3 1  ON 2
ci_004                 3.395030e-02 3 1  ON 3
ci_005                 3.414799e-02 3 1  ON 4
ci_006                -3.244845e-02 3 1  ON 5
ci_007                -3.238669e-02 3 1  ON 6
ci_008                -2.588671e-02 3 1  ON 7
ci_009                -2.575152e-02 3 1  ON 8
ci_010                -2.483783e-02 3 1  ON 9
ci_011                -2.421680e-02 3 1  ON 10
ci_012                -2.436261e-02 3 1  ON 11
ci_013                -2.534439e-02 3 1  ON 12
ci_014                 2.351968e-02 3 1  ON 13
ci_015                 2.346852e-02 3 1  ON 14
ci_016                 2.375415e-02 3 1  ON 15
ci_017                 2.363828e-02 3 1  ON 16
ci_018                 2.174341e-02 3 1  ON 17
ci_019                 2.176738e-02 3 1  ON 18
ci_020                 2.318363e-02 3 1  ON 19
ci_021                 2.346159e-02 3 1  ON 20
ci_022                 1.923222e-02 3 1  ON 21
ci_023                 1.906301e-02 3 1  ON 22
ci_024                 1.921807e-02 3 1  ON 23
ci_025                 1.925417e-02 3 1  ON 24
ci_026                 1.955685e-02 3 1  ON 25
ci_027                 1.910418e-02 3 1  ON 26
ci_028                -1.983168e-02 3 1  ON 27
ci_029                -2.010221e-02 3 1  ON 28
ci_030                -1.771748e-02 3 1  ON 29
ci_031                -1.754822e-02 3 1  ON 30
ci_032                -1.771189e-02 3 1  ON 31
ci_033                 1.573174e-02 3 1  ON 32
ci_034                 1.549918e-02 3 1  ON 33
ci_035                -1.508628e-02 3 1  ON 34
ci_036                -1.712566e-02 3 1  ON 35
ci_037                -1.727833e-02 3 1  ON 36
ci_038                 1.382595e-02 3 1  ON 37
ci_039                 1.397919e-02 3 1  ON 38
ci_040                -1.325230e-02 3 1  ON 39
ci_041                 1.457944e-02 3 1  ON 40
ci_042                 1.472514e-02 3 1  ON 41
ci_043                -1.331326e-02 3 1  ON 42
ci_044                -1.330896e-02 3 1  ON 43
ci_045                -1.285581e-02 3 1  ON 44
ci_046                 1.306958e-02 3 1  ON 45
ci_047                 1.302311e-02 3 1  ON 46
ci_048                -1.429475e-02 3 1  ON 47
ci_049                -1.416768e-02 3 1  ON 48
ci_050                 1.132121e-02 3 1  ON 49
ci_051                 1.110695e-02 3 1  ON 50
ci_052                -1.001683e-02 3 1  ON 51
ci_053                -1.039713e-02 3 1  ON 52
ci_054                -1.047081e-02 3 1  ON 53
ci_055                -1.039958e-02 3 1  ON 54
ci_056                 1.109364e-02 3 1  ON 55
ci_057                 1.102293e-02 3 1  ON 56
ci_058                -9.748064e-03 3 1  ON 57
ci_059                -9.995498e-03 3 1  ON 58
ci_060                 1.051756e-02 3 1  ON 59
ci_061                 1.051584e-02 3 1  ON 60
ci_062                -1.005582e-02 3 1  ON 61
ci_063                -9.927559e-03 3 1  ON 62
ci_064                -8.943059e-03 3 1  ON 63
ci_065                -9.136095e-03 3 1  ON 64
ci_066                 9.288714e-03 3 1  ON 65
ci_067                 9.354730e-03 3 1  ON 66
ci_068                -8.817616e-03 3 1  ON 67
ci_069                -8.914693e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0250e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7235e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1295
    reference variance = 0.444114
====================================================
  Execution time = 1.3884e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5253e+04
  VMC Eavg = -1.7207e+01
  VMC Evar = 3.6753e-01
  Total weights = 1.954186072e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4863e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349784417743
                                         uncertainty =       0.003774310810

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.349784417743
                                         uncertainty =       0.003774310810

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000418175233
  error estimate for blocks of size 2^( 2) =       0.000429198386
  error estimate for blocks of size 2^( 3) =       0.000438568851
  error estimate for blocks of size 2^( 4) =       0.000444748847
  error estimate for blocks of size 2^( 5) =       0.000449204608
  error estimate for blocks of size 2^( 6) =       0.000452751434
  error estimate for blocks of size 2^( 7) =       0.000454151426

      target function =      -0.822701077453
              le_mean =     -17.206689484948
             les_mean =     296.437695780161
             stat err =       0.000450214079
             autocorr =       1.159101665091
   target nu stat err =       0.000450214079
   target dn stat err =       0.004823799301
      target stat err =       0.005053684019
              std dev =       0.591389085260
             le_variance =       0.349741050164


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720668948495e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.822731578930       residual = 1.32e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.862059804586       residual = 2.15e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.869417038919       residual = 5.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.871499233495       residual = 8.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.871795913613       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.871863000566       residual = 4.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.871877906654       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.871883938141       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.871886243358       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.871886680578       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.871886842650       residual = 3.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.871886955027       residual = 9.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.871886963167       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.871886975992       residual = 3.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         13 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 1.043238e-02

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.822731578930       residual = 1.32e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.838875949466       residual = 1.93e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.841665129367       residual = 4.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.842373037311       residual = 6.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.842465405406       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.842484545122       residual = 3.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.842488669873       residual = 7.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.842490334954       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.842490876152       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.842490988699       residual = 5.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.842491034773       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.842491055879       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.842491058908       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 4.404507e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.822731578930       residual = 1.32e+00           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.827502676601       residual = 1.81e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.828286181940       residual = 4.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.828473721565       residual = 5.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.828497161891       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.828501855891       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.828502837012       residual = 5.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.828503232611       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.828503350966       residual = 1.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.828503376294       residual = 3.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.828503387724       residual = 7.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.828503391688       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.828503392549       residual = 2.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.330064e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.015186 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6382e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_001                -5.729211e-02 3 1  ON 0
ci_002                -4.444812e-02 3 1  ON 1
ci_003                -3.318707e-02 3 1  ON 2
ci_004                 3.184070e-02 3 1  ON 3
ci_005                 3.221616e-02 3 1  ON 4
ci_006                -3.014059e-02 3 1  ON 5
ci_007                -2.998771e-02 3 1  ON 6
ci_008                -2.148220e-02 3 1  ON 7
ci_009                -2.294551e-02 3 1  ON 8
ci_010                -2.152790e-02 3 1  ON 9
ci_011                -2.106934e-02 3 1  ON 10
ci_012                -2.113306e-02 3 1  ON 11
ci_013                -2.437095e-02 3 1  ON 12
ci_014                 2.100220e-02 3 1  ON 13
ci_015                 2.099071e-02 3 1  ON 14
ci_016                 2.209020e-02 3 1  ON 15
ci_017                 2.218047e-02 3 1  ON 16
ci_018                 1.908321e-02 3 1  ON 17
ci_019                 1.887928e-02 3 1  ON 18
ci_020                 2.233385e-02 3 1  ON 19
ci_021                 2.213819e-02 3 1  ON 20
ci_022                 1.703481e-02 3 1  ON 21
ci_023                 1.664935e-02 3 1  ON 22
ci_024                 1.741957e-02 3 1  ON 23
ci_025                 1.714847e-02 3 1  ON 24
ci_026                 1.752352e-02 3 1  ON 25
ci_027                 1.752703e-02 3 1  ON 26
ci_028                -1.866579e-02 3 1  ON 27
ci_029                -1.899814e-02 3 1  ON 28
ci_030                -1.579193e-02 3 1  ON 29
ci_031                -1.546852e-02 3 1  ON 30
ci_032                -1.698352e-02 3 1  ON 31
ci_033                 1.337351e-02 3 1  ON 32
ci_034                 1.347170e-02 3 1  ON 33
ci_035                -1.272289e-02 3 1  ON 34
ci_036                -1.637821e-02 3 1  ON 35
ci_037                -1.644080e-02 3 1  ON 36
ci_038                 1.098635e-02 3 1  ON 37
ci_039                 1.111777e-02 3 1  ON 38
ci_040                -1.079590e-02 3 1  ON 39
ci_041                 1.317273e-02 3 1  ON 40
ci_042                 1.308845e-02 3 1  ON 41
ci_043                -1.118261e-02 3 1  ON 42
ci_044                -1.162205e-02 3 1  ON 43
ci_045                -1.060486e-02 3 1  ON 44
ci_046                 1.120569e-02 3 1  ON 45
ci_047                 1.147927e-02 3 1  ON 46
ci_048                -1.412054e-02 3 1  ON 47
ci_049                -1.370294e-02 3 1  ON 48
ci_050                 9.330378e-03 3 1  ON 49
ci_051                 9.203513e-03 3 1  ON 50
ci_052                -7.945782e-03 3 1  ON 51
ci_053                -8.297255e-03 3 1  ON 52
ci_054                -8.803362e-03 3 1  ON 53
ci_055                -8.822716e-03 3 1  ON 54
ci_056                 9.835224e-03 3 1  ON 55
ci_057                 9.534695e-03 3 1  ON 56
ci_058                -7.825378e-03 3 1  ON 57
ci_059                -8.148859e-03 3 1  ON 58
ci_060                 9.238815e-03 3 1  ON 59
ci_061                 8.975210e-03 3 1  ON 60
ci_062                -8.697977e-03 3 1  ON 61
ci_063                -8.655082e-03 3 1  ON 62
ci_064                -7.485515e-03 3 1  ON 63
ci_065                -7.818171e-03 3 1  ON 64
ci_066                 8.209632e-03 3 1  ON 65
ci_067                 8.325101e-03 3 1  ON 66
ci_068                -8.135744e-03 3 1  ON 67
ci_069                -8.099779e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.2422
    reference variance = 0.230086
====================================================
  Execution time = 1.3538e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.3951e-01
  Total weights = 1.9551e+06
  Execution time = 1.8684e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366496282106
                                         uncertainty =       0.007121658749

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366496282106
                                         uncertainty =       0.007121658749

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000428048999
  error estimate for blocks of size 2^( 2) =       0.000439591219
  error estimate for blocks of size 2^( 3) =       0.000449483959
  error estimate for blocks of size 2^( 4) =       0.000456029479
  error estimate for blocks of size 2^( 5) =       0.000459716610
  error estimate for blocks of size 2^( 6) =       0.000461293830
  error estimate for blocks of size 2^( 7) =       0.000464230508

      target function =      -0.487110853062
              le_mean =     -17.211408924715
             les_mean =     297.061981895240
             stat err =       0.000460317607
             autocorr =       1.156453574122
   target nu stat err =       0.000460317607
   target dn stat err =       0.314078423859
      target stat err =       0.122781164240
              std dev =       0.605352699298
             le_variance =       0.366451890548

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513576865939
                                         uncertainty =       0.210389042797

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.513576865939
                                         uncertainty =       0.210389042797

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000506527310
  error estimate for blocks of size 2^( 2) =       0.000515561309
  error estimate for blocks of size 2^( 3) =       0.000524870222
  error estimate for blocks of size 2^( 4) =       0.000530330034
  error estimate for blocks of size 2^( 5) =       0.000533886341
  error estimate for blocks of size 2^( 6) =       0.000533592321
  error estimate for blocks of size 2^( 7) =       0.000535745956

      target function =      -0.209354703554
              le_mean =     -17.212383500723
             les_mean =     298.326030285630
             stat err =       0.000533388663
             autocorr =       1.108873053751
   target nu stat err =       0.000533388663
   target dn stat err =       1.222233859856
      target stat err =       0.103373897170
              std dev =       0.716337791332
             le_variance =       0.513139831291

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298621003155
                                         uncertainty =       0.002971310425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298621003155
                                         uncertainty =       0.002971310425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386388120
  error estimate for blocks of size 2^( 2) =       0.000398098235
  error estimate for blocks of size 2^( 3) =       0.000408688017
  error estimate for blocks of size 2^( 4) =       0.000415514748
  error estimate for blocks of size 2^( 5) =       0.000419874504
  error estimate for blocks of size 2^( 6) =       0.000421485224
  error estimate for blocks of size 2^( 7) =       0.000423813848

      target function =      -0.738064906250
              le_mean =     -17.211485352223
             les_mean =     296.680697284498
             stat err =       0.000420172081
             autocorr =       1.182515528331
   target nu stat err =       0.000420172081
   target dn stat err =       0.103586174394
      target stat err =       0.088690430523
              std dev =       0.546435320011
             le_variance =       0.298591558956

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357106154176
                                         uncertainty =       0.008461108394

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357106154176
                                         uncertainty =       0.008461108394

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422531070
  error estimate for blocks of size 2^( 2) =       0.000433931589
  error estimate for blocks of size 2^( 3) =       0.000443627575
  error estimate for blocks of size 2^( 4) =       0.000449773464
  error estimate for blocks of size 2^( 5) =       0.000453496848
  error estimate for blocks of size 2^( 6) =       0.000455244121
  error estimate for blocks of size 2^( 7) =       0.000458074612

      target function =      -0.559595675059
              le_mean =     -17.210994578754
             les_mean =     296.925200667902
             stat err =       0.000454147261
             autocorr =       1.155250327691
   target nu stat err =       0.000454147261
   target dn stat err =       0.184304064745
      target stat err =       0.091753093894
              std dev =       0.597549169448
             le_variance =       0.357065009908


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.487110853062        initial
     6.2500e-02     6.2500e-01             1.0432e-02        -0.209354703554
     2.5000e-01     2.5000e+00             4.4045e-03        -0.738064906250  <--
     1.0000e+00     1.0000e+01             1.3301e-03        -0.559595675059

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.2992e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_001                -5.729211e-02 3 1  ON 0
ci_002                -4.444812e-02 3 1  ON 1
ci_003                -3.318707e-02 3 1  ON 2
ci_004                 3.184070e-02 3 1  ON 3
ci_005                 3.221616e-02 3 1  ON 4
ci_006                -3.014059e-02 3 1  ON 5
ci_007                -2.998771e-02 3 1  ON 6
ci_008                -2.148220e-02 3 1  ON 7
ci_009                -2.294551e-02 3 1  ON 8
ci_010                -2.152790e-02 3 1  ON 9
ci_011                -2.106934e-02 3 1  ON 10
ci_012                -2.113306e-02 3 1  ON 11
ci_013                -2.437095e-02 3 1  ON 12
ci_014                 2.100220e-02 3 1  ON 13
ci_015                 2.099071e-02 3 1  ON 14
ci_016                 2.209020e-02 3 1  ON 15
ci_017                 2.218047e-02 3 1  ON 16
ci_018                 1.908321e-02 3 1  ON 17
ci_019                 1.887928e-02 3 1  ON 18
ci_020                 2.233385e-02 3 1  ON 19
ci_021                 2.213819e-02 3 1  ON 20
ci_022                 1.703481e-02 3 1  ON 21
ci_023                 1.664935e-02 3 1  ON 22
ci_024                 1.741957e-02 3 1  ON 23
ci_025                 1.714847e-02 3 1  ON 24
ci_026                 1.752352e-02 3 1  ON 25
ci_027                 1.752703e-02 3 1  ON 26
ci_028                -1.866579e-02 3 1  ON 27
ci_029                -1.899814e-02 3 1  ON 28
ci_030                -1.579193e-02 3 1  ON 29
ci_031                -1.546852e-02 3 1  ON 30
ci_032                -1.698352e-02 3 1  ON 31
ci_033                 1.337351e-02 3 1  ON 32
ci_034                 1.347170e-02 3 1  ON 33
ci_035                -1.272289e-02 3 1  ON 34
ci_036                -1.637821e-02 3 1  ON 35
ci_037                -1.644080e-02 3 1  ON 36
ci_038                 1.098635e-02 3 1  ON 37
ci_039                 1.111777e-02 3 1  ON 38
ci_040                -1.079590e-02 3 1  ON 39
ci_041                 1.317273e-02 3 1  ON 40
ci_042                 1.308845e-02 3 1  ON 41
ci_043                -1.118261e-02 3 1  ON 42
ci_044                -1.162205e-02 3 1  ON 43
ci_045                -1.060486e-02 3 1  ON 44
ci_046                 1.120569e-02 3 1  ON 45
ci_047                 1.147927e-02 3 1  ON 46
ci_048                -1.412054e-02 3 1  ON 47
ci_049                -1.370294e-02 3 1  ON 48
ci_050                 9.330378e-03 3 1  ON 49
ci_051                 9.203513e-03 3 1  ON 50
ci_052                -7.945782e-03 3 1  ON 51
ci_053                -8.297255e-03 3 1  ON 52
ci_054                -8.803362e-03 3 1  ON 53
ci_055                -8.822716e-03 3 1  ON 54
ci_056                 9.835224e-03 3 1  ON 55
ci_057                 9.534695e-03 3 1  ON 56
ci_058                -7.825378e-03 3 1  ON 57
ci_059                -8.148859e-03 3 1  ON 58
ci_060                 9.238815e-03 3 1  ON 59
ci_061                 8.975210e-03 3 1  ON 60
ci_062                -8.697977e-03 3 1  ON 61
ci_063                -8.655082e-03 3 1  ON 62
ci_064                -7.485515e-03 3 1  ON 63
ci_065                -7.818171e-03 3 1  ON 64
ci_066                 8.209632e-03 3 1  ON 65
ci_067                 8.325101e-03 3 1  ON 66
ci_068                -8.135744e-03 3 1  ON 67
ci_069                -8.099779e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9379e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2402
    reference variance = 0.31365
====================================================
  Execution time = 1.3888e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 3.3530e-01
  Total weights = 1.955253487e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4940e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316773723229
                                         uncertainty =       0.002084768149

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316773723229
                                         uncertainty =       0.002084768149

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397989672
  error estimate for blocks of size 2^( 2) =       0.000409318203
  error estimate for blocks of size 2^( 3) =       0.000419436865
  error estimate for blocks of size 2^( 4) =       0.000426106670
  error estimate for blocks of size 2^( 5) =       0.000431390915
  error estimate for blocks of size 2^( 6) =       0.000434060410
  error estimate for blocks of size 2^( 7) =       0.000437461871

      target function =      -0.858184315563
              le_mean =     -17.209994264243
             les_mean =     296.519206713744
             stat err =       0.000432254966
             autocorr =       1.179604388293
   target nu stat err =       0.000432254966
   target dn stat err =       0.003482588141
      target stat err =       0.004006105110
              std dev =       0.562842391807
             le_variance =       0.316791558015


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.720999426424e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.858201961515       residual = 9.66e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.883443683570       residual = 1.49e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.888243317686       residual = 3.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.889658393969       residual = 4.82e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.889834821620       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.889881013782       residual = 2.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.889886534259       residual = 6.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.889887734259       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.889887389947       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.889887518700       residual = 7.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.889887521005       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.889887486563       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.889887465319       residual = 7.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 8.318269e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.858201961515       residual = 9.66e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.868774416167       residual = 1.36e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.870635995626       residual = 3.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.871129207678       residual = 3.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.871185240002       residual = 8.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.871198882380       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.871200155441       residual = 4.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.871200424945       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.871200321773       residual = 1.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.871200348500       residual = 2.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.871200357290       residual = 6.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.871200344835       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.871200339067       residual = 2.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 3.286500e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.858201961515       residual = 9.66e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.861366831405       residual = 1.29e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.861898883053       residual = 2.76e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.862031974465       residual = 3.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.862046411854       residual = 7.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.862049832023       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.862050123059       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.862050172085       residual = 7.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.862050147133       residual = 9.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.862050153618       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.862050156375       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.862050153160       residual = 6.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 9.758202e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.020746 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6393e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_001                -5.400561e-02 3 1  ON 0
ci_002                -4.196591e-02 3 1  ON 1
ci_003                -3.188017e-02 3 1  ON 2
ci_004                 3.040437e-02 3 1  ON 3
ci_005                 3.071313e-02 3 1  ON 4
ci_006                -2.828078e-02 3 1  ON 5
ci_007                -2.812210e-02 3 1  ON 6
ci_008                -1.826851e-02 3 1  ON 7
ci_009                -2.122769e-02 3 1  ON 8
ci_010                -1.878343e-02 3 1  ON 9
ci_011                -1.863372e-02 3 1  ON 10
ci_012                -1.885914e-02 3 1  ON 11
ci_013                -2.347089e-02 3 1  ON 12
ci_014                 1.908231e-02 3 1  ON 13
ci_015                 1.910287e-02 3 1  ON 14
ci_016                 2.076270e-02 3 1  ON 15
ci_017                 2.086499e-02 3 1  ON 16
ci_018                 1.705316e-02 3 1  ON 17
ci_019                 1.688127e-02 3 1  ON 18
ci_020                 2.146707e-02 3 1  ON 19
ci_021                 2.123791e-02 3 1  ON 20
ci_022                 1.547498e-02 3 1  ON 21
ci_023                 1.504712e-02 3 1  ON 22
ci_024                 1.597881e-02 3 1  ON 23
ci_025                 1.566838e-02 3 1  ON 24
ci_026                 1.611915e-02 3 1  ON 25
ci_027                 1.612253e-02 3 1  ON 26
ci_028                -1.818094e-02 3 1  ON 27
ci_029                -1.825611e-02 3 1  ON 28
ci_030                -1.408824e-02 3 1  ON 29
ci_031                -1.425396e-02 3 1  ON 30
ci_032                -1.633619e-02 3 1  ON 31
ci_033                 1.135105e-02 3 1  ON 32
ci_034                 1.167662e-02 3 1  ON 33
ci_035                -1.096936e-02 3 1  ON 34
ci_036                -1.551059e-02 3 1  ON 35
ci_037                -1.570580e-02 3 1  ON 36
ci_038                 8.726988e-03 3 1  ON 37
ci_039                 9.021490e-03 3 1  ON 38
ci_040                -8.942961e-03 3 1  ON 39
ci_041                 1.195438e-02 3 1  ON 40
ci_042                 1.224737e-02 3 1  ON 41
ci_043                -9.508163e-03 3 1  ON 42
ci_044                -9.811373e-03 3 1  ON 43
ci_045                -8.707666e-03 3 1  ON 44
ci_046                 9.920645e-03 3 1  ON 45
ci_047                 1.019807e-02 3 1  ON 46
ci_048                -1.416475e-02 3 1  ON 47
ci_049                -1.337750e-02 3 1  ON 48
ci_050                 7.840279e-03 3 1  ON 49
ci_051                 7.503995e-03 3 1  ON 50
ci_052                -6.587748e-03 3 1  ON 51
ci_053                -6.740581e-03 3 1  ON 52
ci_054                -7.470949e-03 3 1  ON 53
ci_055                -7.498464e-03 3 1  ON 54
ci_056                 8.871617e-03 3 1  ON 55
ci_057                 8.664718e-03 3 1  ON 56
ci_058                -6.574442e-03 3 1  ON 57
ci_059                -6.769711e-03 3 1  ON 58
ci_060                 8.166653e-03 3 1  ON 59
ci_061                 8.240829e-03 3 1  ON 60
ci_062                -7.482448e-03 3 1  ON 61
ci_063                -7.506746e-03 3 1  ON 62
ci_064                -6.411757e-03 3 1  ON 63
ci_065                -6.863642e-03 3 1  ON 64
ci_066                 7.077317e-03 3 1  ON 65
ci_067                 7.352895e-03 3 1  ON 66
ci_068                -7.353803e-03 3 1  ON 67
ci_069                -7.037430e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1995
    reference variance = 0.290768
====================================================
  Execution time = 1.3765e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.2074e-01
  Total weights = 1.9558e+06
  Execution time = 1.8298e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340816445386
                                         uncertainty =       0.009960069219

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.340816445386
                                         uncertainty =       0.009960069219

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000412777173
  error estimate for blocks of size 2^( 2) =       0.000423862837
  error estimate for blocks of size 2^( 3) =       0.000433113203
  error estimate for blocks of size 2^( 4) =       0.000439675544
  error estimate for blocks of size 2^( 5) =       0.000443635906
  error estimate for blocks of size 2^( 6) =       0.000447291304
  error estimate for blocks of size 2^( 7) =       0.000450060181

      target function =      -0.593421418661
              le_mean =     -17.212651876494
             les_mean =     296.904118276692
             stat err =       0.000445165734
             autocorr =       1.163086753926
   target nu stat err =       0.000445165734
   target dn stat err =       0.209183098988
      target stat err =       0.118925864825
              std dev =       0.583755076498
             le_variance =       0.340769989337

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.640610985951
                                         uncertainty =       0.268302226632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.640610985951
                                         uncertainty =       0.268302226632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000565662885
  error estimate for blocks of size 2^( 2) =       0.000573781817
  error estimate for blocks of size 2^( 3) =       0.000580839287
  error estimate for blocks of size 2^( 4) =       0.000585564213
  error estimate for blocks of size 2^( 5) =       0.000588829853
  error estimate for blocks of size 2^( 6) =       0.000590626071
  error estimate for blocks of size 2^( 7) =       0.000591427448

      target function =      -0.044828798353
              le_mean =     -17.213020274564
             les_mean =     305.203212758743
             stat err =       0.000589111896
             autocorr =       1.084626516096
   target nu stat err =       0.000589111896
   target dn stat err =       6.857902539880
      target stat err =       0.032951823358
              std dev =       0.799968123080
             le_variance =       0.639948997944

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288051449098
                                         uncertainty =       0.001825034180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288051449098
                                         uncertainty =       0.001825034180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379508944
  error estimate for blocks of size 2^( 2) =       0.000391427562
  error estimate for blocks of size 2^( 3) =       0.000401590346
  error estimate for blocks of size 2^( 4) =       0.000408646849
  error estimate for blocks of size 2^( 5) =       0.000413195275
  error estimate for blocks of size 2^( 6) =       0.000416978143
  error estimate for blocks of size 2^( 7) =       0.000419306932

      target function =      -0.865958531236
              le_mean =     -17.212636536635
             les_mean =     296.603622305592
             stat err =       0.000414531800
             autocorr =       1.193085789010
   target nu stat err =       0.000414531800
   target dn stat err =       0.010459825475
      target stat err =       0.012189641553
              std dev =       0.536706695781
             le_variance =       0.288054077296

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319966349501
                                         uncertainty =       0.003561284242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319966349501
                                         uncertainty =       0.003561284242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399966951
  error estimate for blocks of size 2^( 2) =       0.000411190645
  error estimate for blocks of size 2^( 3) =       0.000420646948
  error estimate for blocks of size 2^( 4) =       0.000427300520
  error estimate for blocks of size 2^( 5) =       0.000431408743
  error estimate for blocks of size 2^( 6) =       0.000435216909
  error estimate for blocks of size 2^( 7) =       0.000437804390

      target function =      -0.822025146092
              le_mean =     -17.212387771901
             les_mean =     296.634385923655
             stat err =       0.000432932641
             autocorr =       1.171635295973
   target nu stat err =       0.000432932641
   target dn stat err =       0.021052035237
      target stat err =       0.022094164186
              std dev =       0.565638686166
             le_variance =       0.319947123288


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.593421418661        initial
     6.2500e-02     6.2500e-01             8.3183e-03        -0.044828798353
     2.5000e-01     2.5000e+00             3.2865e-03        -0.865958531236  <--
     1.0000e+00     1.0000e+01             9.7582e-04        -0.822025146092

*****************************************************************************
Applying the update for shift_i =   2.5000e-01     and shift_s =   2.5000e+00
*****************************************************************************

  Execution time = 2.3150e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_001                -5.400561e-02 3 1  ON 0
ci_002                -4.196591e-02 3 1  ON 1
ci_003                -3.188017e-02 3 1  ON 2
ci_004                 3.040437e-02 3 1  ON 3
ci_005                 3.071313e-02 3 1  ON 4
ci_006                -2.828078e-02 3 1  ON 5
ci_007                -2.812210e-02 3 1  ON 6
ci_008                -1.826851e-02 3 1  ON 7
ci_009                -2.122769e-02 3 1  ON 8
ci_010                -1.878343e-02 3 1  ON 9
ci_011                -1.863372e-02 3 1  ON 10
ci_012                -1.885914e-02 3 1  ON 11
ci_013                -2.347089e-02 3 1  ON 12
ci_014                 1.908231e-02 3 1  ON 13
ci_015                 1.910287e-02 3 1  ON 14
ci_016                 2.076270e-02 3 1  ON 15
ci_017                 2.086499e-02 3 1  ON 16
ci_018                 1.705316e-02 3 1  ON 17
ci_019                 1.688127e-02 3 1  ON 18
ci_020                 2.146707e-02 3 1  ON 19
ci_021                 2.123791e-02 3 1  ON 20
ci_022                 1.547498e-02 3 1  ON 21
ci_023                 1.504712e-02 3 1  ON 22
ci_024                 1.597881e-02 3 1  ON 23
ci_025                 1.566838e-02 3 1  ON 24
ci_026                 1.611915e-02 3 1  ON 25
ci_027                 1.612253e-02 3 1  ON 26
ci_028                -1.818094e-02 3 1  ON 27
ci_029                -1.825611e-02 3 1  ON 28
ci_030                -1.408824e-02 3 1  ON 29
ci_031                -1.425396e-02 3 1  ON 30
ci_032                -1.633619e-02 3 1  ON 31
ci_033                 1.135105e-02 3 1  ON 32
ci_034                 1.167662e-02 3 1  ON 33
ci_035                -1.096936e-02 3 1  ON 34
ci_036                -1.551059e-02 3 1  ON 35
ci_037                -1.570580e-02 3 1  ON 36
ci_038                 8.726988e-03 3 1  ON 37
ci_039                 9.021490e-03 3 1  ON 38
ci_040                -8.942961e-03 3 1  ON 39
ci_041                 1.195438e-02 3 1  ON 40
ci_042                 1.224737e-02 3 1  ON 41
ci_043                -9.508163e-03 3 1  ON 42
ci_044                -9.811373e-03 3 1  ON 43
ci_045                -8.707666e-03 3 1  ON 44
ci_046                 9.920645e-03 3 1  ON 45
ci_047                 1.019807e-02 3 1  ON 46
ci_048                -1.416475e-02 3 1  ON 47
ci_049                -1.337750e-02 3 1  ON 48
ci_050                 7.840279e-03 3 1  ON 49
ci_051                 7.503995e-03 3 1  ON 50
ci_052                -6.587748e-03 3 1  ON 51
ci_053                -6.740581e-03 3 1  ON 52
ci_054                -7.470949e-03 3 1  ON 53
ci_055                -7.498464e-03 3 1  ON 54
ci_056                 8.871617e-03 3 1  ON 55
ci_057                 8.664718e-03 3 1  ON 56
ci_058                -6.574442e-03 3 1  ON 57
ci_059                -6.769711e-03 3 1  ON 58
ci_060                 8.166653e-03 3 1  ON 59
ci_061                 8.240829e-03 3 1  ON 60
ci_062                -7.482448e-03 3 1  ON 61
ci_063                -7.506746e-03 3 1  ON 62
ci_064                -6.411757e-03 3 1  ON 63
ci_065                -6.863642e-03 3 1  ON 64
ci_066                 7.077317e-03 3 1  ON 65
ci_067                 7.352895e-03 3 1  ON 66
ci_068                -7.353803e-03 3 1  ON 67
ci_069                -7.037430e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9550e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.1591
    reference variance = 0.517061
====================================================
  Execution time = 1.3912e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.1653e-01
  Total weights = 1.955424305e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4972e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302303518891
                                         uncertainty =       0.002169833598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302303518891
                                         uncertainty =       0.002169833598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388771172
  error estimate for blocks of size 2^( 2) =       0.000400129765
  error estimate for blocks of size 2^( 3) =       0.000409730629
  error estimate for blocks of size 2^( 4) =       0.000416105957
  error estimate for blocks of size 2^( 5) =       0.000420708939
  error estimate for blocks of size 2^( 6) =       0.000422541428
  error estimate for blocks of size 2^( 7) =       0.000423484224

      target function =      -0.880433076156
              le_mean =     -17.211756427787
             les_mean =     296.561092699307
             stat err =       0.000420710137
             autocorr =       1.171056491576
   target nu stat err =       0.000420710137
   target dn stat err =       0.003069109270
      target stat err =       0.003732097104
              std dev =       0.549805463796
             le_variance =       0.302286048020


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721175642779e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-02, overlap shift 6.2500e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.880448146901       residual = 5.49e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.894751642074       residual = 7.91e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.897307043308       residual = 2.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898054935159       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898151547571       residual = 9.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898188900968       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898194828016       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898196591329       residual = 1.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898197023799       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898197036738       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.898196953240       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.898197049863       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.898197062729       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-02 is 6.302408e-03

solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.880448146901       residual = 5.49e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.886496462633       residual = 7.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.887497834467       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.887763004074       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.887795511483       residual = 6.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.887807316088       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.887808783157       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.887809222346       residual = 6.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.887809325427       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.887809319322       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.887809302488       residual = 4.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.887809328844       residual = 7.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 2.505757e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.880448146901       residual = 5.49e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.882271330510       residual = 7.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.882560378467       residual = 1.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.882633007147       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.882641710518       residual = 5.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.882644755829       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.882645085229       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.882645186461       residual = 4.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.882645209737       residual = 5.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.882645207193       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.882645204109       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.882645210336       residual = 4.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 7.328422e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.025833 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6420e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_001                -5.149985e-02 3 1  ON 0
ci_002                -4.013110e-02 3 1  ON 1
ci_003                -3.079382e-02 3 1  ON 2
ci_004                 2.931577e-02 3 1  ON 3
ci_005                 2.924822e-02 3 1  ON 4
ci_006                -2.685788e-02 3 1  ON 5
ci_007                -2.686794e-02 3 1  ON 6
ci_008                -1.614721e-02 3 1  ON 7
ci_009                -1.995950e-02 3 1  ON 8
ci_010                -1.663131e-02 3 1  ON 9
ci_011                -1.708246e-02 3 1  ON 10
ci_012                -1.699975e-02 3 1  ON 11
ci_013                -2.258028e-02 3 1  ON 12
ci_014                 1.767988e-02 3 1  ON 13
ci_015                 1.757731e-02 3 1  ON 14
ci_016                 1.974459e-02 3 1  ON 15
ci_017                 2.009498e-02 3 1  ON 16
ci_018                 1.536197e-02 3 1  ON 17
ci_019                 1.537345e-02 3 1  ON 18
ci_020                 2.075723e-02 3 1  ON 19
ci_021                 2.068340e-02 3 1  ON 20
ci_022                 1.412932e-02 3 1  ON 21
ci_023                 1.391531e-02 3 1  ON 22
ci_024                 1.463951e-02 3 1  ON 23
ci_025                 1.428567e-02 3 1  ON 24
ci_026                 1.501228e-02 3 1  ON 25
ci_027                 1.512412e-02 3 1  ON 26
ci_028                -1.754039e-02 3 1  ON 27
ci_029                -1.746030e-02 3 1  ON 28
ci_030                -1.280823e-02 3 1  ON 29
ci_031                -1.310277e-02 3 1  ON 30
ci_032                -1.553128e-02 3 1  ON 31
ci_033                 1.014603e-02 3 1  ON 32
ci_034                 1.043503e-02 3 1  ON 33
ci_035                -9.643681e-03 3 1  ON 34
ci_036                -1.505328e-02 3 1  ON 35
ci_037                -1.525106e-02 3 1  ON 36
ci_038                 7.220698e-03 3 1  ON 37
ci_039                 7.481904e-03 3 1  ON 38
ci_040                -7.649482e-03 3 1  ON 39
ci_041                 1.109864e-02 3 1  ON 40
ci_042                 1.144021e-02 3 1  ON 41
ci_043                -8.225240e-03 3 1  ON 42
ci_044                -8.507339e-03 3 1  ON 43
ci_045                -7.427815e-03 3 1  ON 44
ci_046                 9.022904e-03 3 1  ON 45
ci_047                 9.341207e-03 3 1  ON 46
ci_048                -1.374912e-02 3 1  ON 47
ci_049                -1.338263e-02 3 1  ON 48
ci_050                 6.580135e-03 3 1  ON 49
ci_051                 6.251116e-03 3 1  ON 50
ci_052                -5.738026e-03 3 1  ON 51
ci_053                -5.401729e-03 3 1  ON 52
ci_054                -6.370354e-03 3 1  ON 53
ci_055                -6.470906e-03 3 1  ON 54
ci_056                 8.057988e-03 3 1  ON 55
ci_057                 7.974416e-03 3 1  ON 56
ci_058                -5.439507e-03 3 1  ON 57
ci_059                -5.595473e-03 3 1  ON 58
ci_060                 7.716026e-03 3 1  ON 59
ci_061                 7.608128e-03 3 1  ON 60
ci_062                -6.820398e-03 3 1  ON 61
ci_063                -6.789940e-03 3 1  ON 62
ci_064                -5.683937e-03 3 1  ON 63
ci_065                -6.183632e-03 3 1  ON 64
ci_066                 6.453757e-03 3 1  ON 65
ci_067                 6.694171e-03 3 1  ON 66
ci_068                -6.686793e-03 3 1  ON 67
ci_069                -6.727673e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2022
    reference variance = 0.216514
====================================================
  Execution time = 1.3918e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.0368e-01
  Total weights = 1.9559e+06
  Execution time = 1.8334e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305156443807
                                         uncertainty =       0.003040741526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305156443807
                                         uncertainty =       0.003040741526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390569523
  error estimate for blocks of size 2^( 2) =       0.000402005328
  error estimate for blocks of size 2^( 3) =       0.000411641396
  error estimate for blocks of size 2^( 4) =       0.000419064330
  error estimate for blocks of size 2^( 5) =       0.000422648598
  error estimate for blocks of size 2^( 6) =       0.000425123537
  error estimate for blocks of size 2^( 7) =       0.000426199950

      target function =      -0.658651972354
              le_mean =     -17.213170933360
             les_mean =     296.830515432405
             stat err =       0.000423259104
             autocorr =       1.174399651884
   target nu stat err =       0.000423259104
   target dn stat err =       0.156463513955
      target stat err =       0.108290965990
              std dev =       0.552348716205
             le_variance =       0.305089104293

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282116863251
                                         uncertainty =       0.001956963746

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282116863251
                                         uncertainty =       0.001956963746

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375542849
  error estimate for blocks of size 2^( 2) =       0.000387912082
  error estimate for blocks of size 2^( 3) =       0.000398406778
  error estimate for blocks of size 2^( 4) =       0.000406701102
  error estimate for blocks of size 2^( 5) =       0.000410918013
  error estimate for blocks of size 2^( 6) =       0.000413712491
  error estimate for blocks of size 2^( 7) =       0.000414959210

      target function =      -0.778735625224
              le_mean =     -17.213437121331
             les_mean =     296.709613130423
             stat err =       0.000411572704
             autocorr =       1.201086084356
   target nu stat err =       0.000411572704
   target dn stat err =       0.064436584723
      target stat err =       0.061103030187
              std dev =       0.531097790515
             le_variance =       0.282064863090

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283167831646
                                         uncertainty =       0.002037036944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283167831646
                                         uncertainty =       0.002037036944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376240499
  error estimate for blocks of size 2^( 2) =       0.000388437013
  error estimate for blocks of size 2^( 3) =       0.000398734141
  error estimate for blocks of size 2^( 4) =       0.000406863719
  error estimate for blocks of size 2^( 5) =       0.000411089896
  error estimate for blocks of size 2^( 6) =       0.000413686512
  error estimate for blocks of size 2^( 7) =       0.000414735037

      target function =      -0.652074220011
              le_mean =     -17.213226077025
             les_mean =     296.818414178896
             stat err =       0.000411593791
             autocorr =       1.196758570463
   target nu stat err =       0.000411593791
   target dn stat err =       0.215598623805
      target stat err =       0.149945536422
              std dev =       0.532084416096
             le_variance =       0.283113825852

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298249459293
                                         uncertainty =       0.002074594045

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298249459293
                                         uncertainty =       0.002074594045

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386124185
  error estimate for blocks of size 2^( 2) =       0.000397642525
  error estimate for blocks of size 2^( 3) =       0.000407392179
  error estimate for blocks of size 2^( 4) =       0.000414920323
  error estimate for blocks of size 2^( 5) =       0.000418642277
  error estimate for blocks of size 2^( 6) =       0.000421046857
  error estimate for blocks of size 2^( 7) =       0.000422154635

      target function =      -0.834575359907
              le_mean =     -17.213076324438
             les_mean =     296.645868228955
             stat err =       0.000419191023
             autocorr =       1.178609498910
   target nu stat err =       0.000419191023
   target dn stat err =       0.028562959355
      target stat err =       0.030947530419
              std dev =       0.546062059769
             le_variance =       0.298183773119


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.658651972354        initial
     6.2500e-02     6.2500e-01             6.3024e-03        -0.778735625224
     2.5000e-01     2.5000e+00             2.5058e-03        -0.652074220011
     1.0000e+00     1.0000e+01             7.3284e-04        -0.834575359907  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.3301e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_001                -5.327277e-02 3 1  ON 0
ci_002                -4.142400e-02 3 1  ON 1
ci_003                -3.156362e-02 3 1  ON 2
ci_004                 3.008829e-02 3 1  ON 3
ci_005                 3.028583e-02 3 1  ON 4
ci_006                -2.786094e-02 3 1  ON 5
ci_007                -2.775100e-02 3 1  ON 6
ci_008                -1.762313e-02 3 1  ON 7
ci_009                -2.084848e-02 3 1  ON 8
ci_010                -1.814151e-02 3 1  ON 9
ci_011                -1.816966e-02 3 1  ON 10
ci_012                -1.830418e-02 3 1  ON 11
ci_013                -2.321214e-02 3 1  ON 12
ci_014                 1.866238e-02 3 1  ON 13
ci_015                 1.864692e-02 3 1  ON 14
ci_016                 2.045817e-02 3 1  ON 15
ci_017                 2.063271e-02 3 1  ON 16
ci_018                 1.654317e-02 3 1  ON 17
ci_019                 1.642725e-02 3 1  ON 18
ci_020                 2.126144e-02 3 1  ON 19
ci_021                 2.107964e-02 3 1  ON 20
ci_022                 1.507007e-02 3 1  ON 21
ci_023                 1.470808e-02 3 1  ON 22
ci_024                 1.558723e-02 3 1  ON 23
ci_025                 1.526517e-02 3 1  ON 24
ci_026                 1.578830e-02 3 1  ON 25
ci_027                 1.582556e-02 3 1  ON 26
ci_028                -1.799038e-02 3 1  ON 27
ci_029                -1.802006e-02 3 1  ON 28
ci_030                -1.370410e-02 3 1  ON 29
ci_031                -1.390642e-02 3 1  ON 30
ci_032                -1.609756e-02 3 1  ON 31
ci_033                 1.099496e-02 3 1  ON 32
ci_034                 1.130921e-02 3 1  ON 33
ci_035                -1.056978e-02 3 1  ON 34
ci_036                -1.537922e-02 3 1  ON 35
ci_037                -1.557484e-02 3 1  ON 36
ci_038                 8.272412e-03 3 1  ON 37
ci_039                 8.556566e-03 3 1  ON 38
ci_040                -8.551002e-03 3 1  ON 39
ci_041                 1.169567e-02 3 1  ON 40
ci_042                 1.200469e-02 3 1  ON 41
ci_043                -9.122075e-03 3 1  ON 42
ci_044                -9.422262e-03 3 1  ON 43
ci_045                -8.320125e-03 3 1  ON 44
ci_046                 9.653913e-03 3 1  ON 45
ci_047                 9.943643e-03 3 1  ON 46
ci_048                -1.404189e-02 3 1  ON 47
ci_049                -1.337562e-02 3 1  ON 48
ci_050                 7.455458e-03 3 1  ON 49
ci_051                 7.121163e-03 3 1  ON 50
ci_052                -6.327937e-03 3 1  ON 51
ci_053                -6.331818e-03 3 1  ON 52
ci_054                -7.144047e-03 3 1  ON 53
ci_055                -7.193177e-03 3 1  ON 54
ci_056                 8.627824e-03 3 1  ON 55
ci_057                 8.457555e-03 3 1  ON 56
ci_058                -6.226988e-03 3 1  ON 57
ci_059                -6.410558e-03 3 1  ON 58
ci_060                 8.033472e-03 3 1  ON 59
ci_061                 8.053183e-03 3 1  ON 60
ci_062                -7.287538e-03 3 1  ON 61
ci_063                -7.295171e-03 3 1  ON 62
ci_064                -6.190431e-03 3 1  ON 63
ci_065                -6.657867e-03 3 1  ON 64
ci_066                 6.888194e-03 3 1  ON 65
ci_067                 7.153293e-03 3 1  ON 66
ci_068                -7.153331e-03 3 1  ON 67
ci_069                -6.943018e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9754e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7205e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2116
    reference variance = 0.189327
====================================================
  Execution time = 1.3868e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5320e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.1671e-01
  Total weights = 1.955663872e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4871e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300271832151
                                         uncertainty =       0.002209815436

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.300271832151
                                         uncertainty =       0.002209815436

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000387478106
  error estimate for blocks of size 2^( 2) =       0.000398951336
  error estimate for blocks of size 2^( 3) =       0.000408866115
  error estimate for blocks of size 2^( 4) =       0.000416817664
  error estimate for blocks of size 2^( 5) =       0.000420934723
  error estimate for blocks of size 2^( 6) =       0.000423261116
  error estimate for blocks of size 2^( 7) =       0.000424248642

      target function =      -0.880304503664
              le_mean =     -17.212212588078
             les_mean =     296.576973047770
             stat err =       0.000421315536
             autocorr =       1.182280732013
   target nu stat err =       0.000421315536
   target dn stat err =       0.003020637794
      target stat err =       0.003676227803
              std dev =       0.547976792605
             le_variance =       0.300278565234


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721221258808e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.880319234723       residual = 5.10e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.885863325961       residual = 6.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.886754695137       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.886977073307       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.887000896639       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.887007946159       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.887009514590       residual = 2.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.887009579818       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.887009443574       residual = 9.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.887009348084       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.887009350003       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.887009349689       residual = 7.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 2.271002e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.880319234723       residual = 5.10e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.881990807082       residual = 6.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.882248609403       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.882309412054       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.882315711613       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.882317524841       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.882317918058       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.882317925196       residual = 4.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.882317888429       residual = 6.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.882317864134       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.882317865096       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.882317865133       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 6.636555e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.880319234723       residual = 5.10e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.880759666566       residual = 6.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.880826662469       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.880842180750       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.880843772879       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.880844226906       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.880844324475       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.880844325586       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.880844316250       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.880844310195       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.880844310476       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.880844310492       residual = 3.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 1.731708e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.030815 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6365e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_001                -5.260911e-02 3 1  ON 0
ci_002                -4.092106e-02 3 1  ON 1
ci_003                -3.123835e-02 3 1  ON 2
ci_004                 2.980597e-02 3 1  ON 3
ci_005                 3.007710e-02 3 1  ON 4
ci_006                -2.749038e-02 3 1  ON 5
ci_007                -2.731851e-02 3 1  ON 6
ci_008                -1.697251e-02 3 1  ON 7
ci_009                -2.042845e-02 3 1  ON 8
ci_010                -1.753092e-02 3 1  ON 9
ci_011                -1.767774e-02 3 1  ON 10
ci_012                -1.771629e-02 3 1  ON 11
ci_013                -2.302093e-02 3 1  ON 12
ci_014                 1.828512e-02 3 1  ON 13
ci_015                 1.820415e-02 3 1  ON 14
ci_016                 2.024870e-02 3 1  ON 15
ci_017                 2.034190e-02 3 1  ON 16
ci_018                 1.611053e-02 3 1  ON 17
ci_019                 1.607256e-02 3 1  ON 18
ci_020                 2.104793e-02 3 1  ON 19
ci_021                 2.096730e-02 3 1  ON 20
ci_022                 1.478617e-02 3 1  ON 21
ci_023                 1.431664e-02 3 1  ON 22
ci_024                 1.530449e-02 3 1  ON 23
ci_025                 1.501047e-02 3 1  ON 24
ci_026                 1.548973e-02 3 1  ON 25
ci_027                 1.543590e-02 3 1  ON 26
ci_028                -1.772346e-02 3 1  ON 27
ci_029                -1.782894e-02 3 1  ON 28
ci_030                -1.340293e-02 3 1  ON 29
ci_031                -1.357070e-02 3 1  ON 30
ci_032                -1.602794e-02 3 1  ON 31
ci_033                 1.070245e-02 3 1  ON 32
ci_034                 1.088591e-02 3 1  ON 33
ci_035                -1.023894e-02 3 1  ON 34
ci_036                -1.525840e-02 3 1  ON 35
ci_037                -1.541153e-02 3 1  ON 36
ci_038                 7.782037e-03 3 1  ON 37
ci_039                 8.102345e-03 3 1  ON 38
ci_040                -8.159660e-03 3 1  ON 39
ci_041                 1.155157e-02 3 1  ON 40
ci_042                 1.176762e-02 3 1  ON 41
ci_043                -8.778943e-03 3 1  ON 42
ci_044                -9.045387e-03 3 1  ON 43
ci_045                -7.942247e-03 3 1  ON 44
ci_046                 9.443111e-03 3 1  ON 45
ci_047                 9.674818e-03 3 1  ON 46
ci_048                -1.396150e-02 3 1  ON 47
ci_049                -1.333462e-02 3 1  ON 48
ci_050                 7.141793e-03 3 1  ON 49
ci_051                 6.914818e-03 3 1  ON 50
ci_052                -5.999505e-03 3 1  ON 51
ci_053                -6.191414e-03 3 1  ON 52
ci_054                -6.846240e-03 3 1  ON 53
ci_055                -6.931957e-03 3 1  ON 54
ci_056                 8.364847e-03 3 1  ON 55
ci_057                 8.241596e-03 3 1  ON 56
ci_058                -5.893262e-03 3 1  ON 57
ci_059                -6.051445e-03 3 1  ON 58
ci_060                 7.956152e-03 3 1  ON 59
ci_061                 7.816511e-03 3 1  ON 60
ci_062                -7.064578e-03 3 1  ON 61
ci_063                -7.078729e-03 3 1  ON 62
ci_064                -5.926061e-03 3 1  ON 63
ci_065                -6.482536e-03 3 1  ON 64
ci_066                 6.713426e-03 3 1  ON 65
ci_067                 6.958300e-03 3 1  ON 66
ci_068                -7.013037e-03 3 1  ON 67
ci_069                -6.824447e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2308
    reference variance = 0.189801
====================================================
  Execution time = 1.3681e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.1176e-01
  Total weights = 1.9558e+06
  Execution time = 1.8355e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299372390818
                                         uncertainty =       0.002522493360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299372390818
                                         uncertainty =       0.002522493360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386905785
  error estimate for blocks of size 2^( 2) =       0.000398794783
  error estimate for blocks of size 2^( 3) =       0.000408892583
  error estimate for blocks of size 2^( 4) =       0.000415792087
  error estimate for blocks of size 2^( 5) =       0.000419888274
  error estimate for blocks of size 2^( 6) =       0.000421041856
  error estimate for blocks of size 2^( 7) =       0.000422881896

      target function =      -0.862099294392
              le_mean =     -17.213245882730
             les_mean =     296.627802698644
             stat err =       0.000419901028
             autocorr =       1.177832216379
   target nu stat err =       0.000419901028
   target dn stat err =       0.016229128220
      target stat err =       0.018756569289
              std dev =       0.547167408890
             le_variance =       0.299392173351

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289726238512
                                         uncertainty =       0.002311137723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289726238512
                                         uncertainty =       0.002311137723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380619818
  error estimate for blocks of size 2^( 2) =       0.000392763473
  error estimate for blocks of size 2^( 3) =       0.000403167101
  error estimate for blocks of size 2^( 4) =       0.000410376093
  error estimate for blocks of size 2^( 5) =       0.000414635412
  error estimate for blocks of size 2^( 6) =       0.000415977299
  error estimate for blocks of size 2^( 7) =       0.000417674667

      target function =      -0.866144161583
              le_mean =     -17.213357191317
             les_mean =     296.628014100937
             stat err =       0.000414665868
             autocorr =       1.186899053156
   target nu stat err =       0.000414665868
   target dn stat err =       0.019303899859
      target stat err =       0.022525276170
              std dev =       0.538277708780
             le_variance =       0.289742891770

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293089337040
                                         uncertainty =       0.002385214301

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293089337040
                                         uncertainty =       0.002385214301

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382823407
  error estimate for blocks of size 2^( 2) =       0.000394852154
  error estimate for blocks of size 2^( 3) =       0.000405122025
  error estimate for blocks of size 2^( 4) =       0.000412182186
  error estimate for blocks of size 2^( 5) =       0.000416359599
  error estimate for blocks of size 2^( 6) =       0.000417608166
  error estimate for blocks of size 2^( 7) =       0.000419367088

      target function =      -0.878422078571
              le_mean =     -17.213261707961
             les_mean =     296.614642258944
             stat err =       0.000416379260
             autocorr =       1.182990372160
   target nu stat err =       0.000416379260
   target dn stat err =       0.011693940557
      target stat err =       0.014034214643
              std dev =       0.541394053932
             le_variance =       0.293107521633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298354541134
                                         uncertainty =       0.002497637893

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298354541134
                                         uncertainty =       0.002497637893

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386247796
  error estimate for blocks of size 2^( 2) =       0.000398151512
  error estimate for blocks of size 2^( 3) =       0.000408267905
  error estimate for blocks of size 2^( 4) =       0.000415187255
  error estimate for blocks of size 2^( 5) =       0.000419292335
  error estimate for blocks of size 2^( 6) =       0.000420480900
  error estimate for blocks of size 2^( 7) =       0.000422309354

      target function =      -0.882695174524
              le_mean =     -17.213246353331
             les_mean =     296.610732580752
             stat err =       0.000419317461
             autocorr =       1.178565888226
   target nu stat err =       0.000419317461
   target dn stat err =       0.003632142013
      target stat err =       0.004434263232
              std dev =       0.546236871246
             le_variance =       0.298374719509


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.862099294392        initial
     2.5000e-01     2.5000e+00             2.2710e-03        -0.866144161583
     1.0000e+00     1.0000e+01             6.6366e-04        -0.878422078571
     4.0000e+00     4.0000e+01             1.7317e-04        -0.882695174524  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 2.3044e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_001                -5.309959e-02 3 1  ON 0
ci_002                -4.129240e-02 3 1  ON 1
ci_003                -3.147896e-02 3 1  ON 2
ci_004                 3.001479e-02 3 1  ON 3
ci_005                 3.023166e-02 3 1  ON 4
ci_006                -2.776393e-02 3 1  ON 5
ci_007                -2.763788e-02 3 1  ON 6
ci_008                -1.745122e-02 3 1  ON 7
ci_009                -2.073804e-02 3 1  ON 8
ci_010                -1.798126e-02 3 1  ON 9
ci_011                -1.804043e-02 3 1  ON 10
ci_012                -1.814971e-02 3 1  ON 11
ci_013                -2.316227e-02 3 1  ON 12
ci_014                 1.856310e-02 3 1  ON 13
ci_015                 1.853068e-02 3 1  ON 14
ci_016                 2.040293e-02 3 1  ON 15
ci_017                 2.055638e-02 3 1  ON 16
ci_018                 1.642903e-02 3 1  ON 17
ci_019                 1.633392e-02 3 1  ON 18
ci_020                 2.120575e-02 3 1  ON 19
ci_021                 2.105058e-02 3 1  ON 20
ci_022                 1.499554e-02 3 1  ON 21
ci_023                 1.460501e-02 3 1  ON 22
ci_024                 1.551356e-02 3 1  ON 23
ci_025                 1.519896e-02 3 1  ON 24
ci_026                 1.570983e-02 3 1  ON 25
ci_027                 1.572293e-02 3 1  ON 26
ci_028                -1.792037e-02 3 1  ON 27
ci_029                -1.796999e-02 3 1  ON 28
ci_030                -1.362478e-02 3 1  ON 29
ci_031                -1.381803e-02 3 1  ON 30
ci_032                -1.607929e-02 3 1  ON 31
ci_033                 1.091828e-02 3 1  ON 32
ci_034                 1.119813e-02 3 1  ON 33
ci_035                -1.048265e-02 3 1  ON 34
ci_036                -1.534798e-02 3 1  ON 35
ci_037                -1.553241e-02 3 1  ON 36
ci_038                 8.143168e-03 3 1  ON 37
ci_039                 8.436849e-03 3 1  ON 38
ci_040                -8.447719e-03 3 1  ON 39
ci_041                 1.165778e-02 3 1  ON 40
ci_042                 1.194222e-02 3 1  ON 41
ci_043                -9.031735e-03 3 1  ON 42
ci_044                -9.323330e-03 3 1  ON 43
ci_045                -8.220453e-03 3 1  ON 44
ci_046                 9.598653e-03 3 1  ON 45
ci_047                 9.873161e-03 3 1  ON 46
ci_048                -1.402074e-02 3 1  ON 47
ci_049                -1.336470e-02 3 1  ON 48
ci_050                 7.372475e-03 3 1  ON 49
ci_051                 7.066647e-03 3 1  ON 50
ci_052                -6.240938e-03 3 1  ON 51
ci_053                -6.294649e-03 3 1  ON 52
ci_054                -7.065993e-03 3 1  ON 53
ci_055                -7.124629e-03 3 1  ON 54
ci_056                 8.558615e-03 3 1  ON 55
ci_057                 8.400760e-03 3 1  ON 56
ci_058                -6.138568e-03 3 1  ON 57
ci_059                -6.315583e-03 3 1  ON 58
ci_060                 8.013236e-03 3 1  ON 59
ci_061                 7.991173e-03 3 1  ON 60
ci_062                -7.229108e-03 3 1  ON 61
ci_063                -7.238461e-03 3 1  ON 62
ci_064                -6.120599e-03 3 1  ON 63
ci_065                -6.611616e-03 3 1  ON 64
ci_066                 6.842094e-03 3 1  ON 65
ci_067                 7.101787e-03 3 1  ON 66
ci_068                -7.116329e-03 3 1  ON 67
ci_069                -6.911753e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9432e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.221
    reference variance = 0.229469
====================================================
  Execution time = 1.4023e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.1461e-01
  Total weights = 1.955427343e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4849e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299247497411
                                         uncertainty =       0.002132415618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299247497411
                                         uncertainty =       0.002132415618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386801412
  error estimate for blocks of size 2^( 2) =       0.000398530330
  error estimate for blocks of size 2^( 3) =       0.000408771083
  error estimate for blocks of size 2^( 4) =       0.000416069091
  error estimate for blocks of size 2^( 5) =       0.000419735169
  error estimate for blocks of size 2^( 6) =       0.000421032165
  error estimate for blocks of size 2^( 7) =       0.000422256841

      target function =      -0.882970805460
              le_mean =     -17.212920146032
             les_mean =     296.599230229310
             stat err =       0.000419773317
             autocorr =       1.177751201824
   target nu stat err =       0.000419773317
   target dn stat err =       0.002978173453
      target stat err =       0.003651213914
              std dev =       0.547019802678
             le_variance =       0.299230664522


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721292014603e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.882985147608       residual = 4.54e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.884515386164       residual = 6.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.884768191772       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.884839719345       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.884848475410       residual = 4.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.884850532900       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.884850774593       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.884850912193       residual = 4.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.884850927219       residual = 7.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.884850912493       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.884850921403       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.884850922113       residual = 8.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 6.853851e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.882985147608       residual = 4.54e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.883388363392       residual = 6.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.883454084626       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.883472361184       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.883474587554       residual = 4.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.883475104430       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.883475161621       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.883475195498       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.883475198907       residual = 6.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.883475195274       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.883475197461       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.883475197619       residual = 6.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 1.787810e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.882985147608       residual = 4.54e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.883087328225       residual = 6.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.883103922276       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.883108515670       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.883109074522       residual = 4.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.883109203844       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.883109217917       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.883109226348       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.883109227177       residual = 6.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.883109226272       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.883109226816       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.883109226855       residual = 6.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 4.518421e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.035628 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6518e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_001                -5.292081e-02 3 1  ON 0
ci_002                -4.116680e-02 3 1  ON 1
ci_003                -3.141090e-02 3 1  ON 2
ci_004                 2.991659e-02 3 1  ON 3
ci_005                 3.013685e-02 3 1  ON 4
ci_006                -2.765268e-02 3 1  ON 5
ci_007                -2.754047e-02 3 1  ON 6
ci_008                -1.729475e-02 3 1  ON 7
ci_009                -2.062740e-02 3 1  ON 8
ci_010                -1.782261e-02 3 1  ON 9
ci_011                -1.791299e-02 3 1  ON 10
ci_012                -1.803567e-02 3 1  ON 11
ci_013                -2.310045e-02 3 1  ON 12
ci_014                 1.843721e-02 3 1  ON 13
ci_015                 1.842967e-02 3 1  ON 14
ci_016                 2.033533e-02 3 1  ON 15
ci_017                 2.050171e-02 3 1  ON 16
ci_018                 1.631806e-02 3 1  ON 17
ci_019                 1.623711e-02 3 1  ON 18
ci_020                 2.115419e-02 3 1  ON 19
ci_021                 2.100071e-02 3 1  ON 20
ci_022                 1.488084e-02 3 1  ON 21
ci_023                 1.453597e-02 3 1  ON 22
ci_024                 1.540824e-02 3 1  ON 23
ci_025                 1.511503e-02 3 1  ON 24
ci_026                 1.564234e-02 3 1  ON 25
ci_027                 1.565065e-02 3 1  ON 26
ci_028                -1.784871e-02 3 1  ON 27
ci_029                -1.792616e-02 3 1  ON 28
ci_030                -1.354806e-02 3 1  ON 29
ci_031                -1.372701e-02 3 1  ON 30
ci_032                -1.604426e-02 3 1  ON 31
ci_033                 1.082735e-02 3 1  ON 32
ci_034                 1.110178e-02 3 1  ON 33
ci_035                -1.038893e-02 3 1  ON 34
ci_036                -1.532568e-02 3 1  ON 35
ci_037                -1.548889e-02 3 1  ON 36
ci_038                 8.029489e-03 3 1  ON 37
ci_039                 8.314560e-03 3 1  ON 38
ci_040                -8.347696e-03 3 1  ON 39
ci_041                 1.159672e-02 3 1  ON 40
ci_042                 1.189256e-02 3 1  ON 41
ci_043                -8.953779e-03 3 1  ON 42
ci_044                -9.228442e-03 3 1  ON 43
ci_045                -8.132056e-03 3 1  ON 44
ci_046                 9.531497e-03 3 1  ON 45
ci_047                 9.796299e-03 3 1  ON 46
ci_048                -1.397537e-02 3 1  ON 47
ci_049                -1.336300e-02 3 1  ON 48
ci_050                 7.293694e-03 3 1  ON 49
ci_051                 7.007274e-03 3 1  ON 50
ci_052                -6.158400e-03 3 1  ON 51
ci_053                -6.218266e-03 3 1  ON 52
ci_054                -6.999631e-03 3 1  ON 53
ci_055                -7.065273e-03 3 1  ON 54
ci_056                 8.505872e-03 3 1  ON 55
ci_057                 8.352363e-03 3 1  ON 56
ci_058                -6.063241e-03 3 1  ON 57
ci_059                -6.229221e-03 3 1  ON 58
ci_060                 7.973363e-03 3 1  ON 59
ci_061                 7.947824e-03 3 1  ON 60
ci_062                -7.186512e-03 3 1  ON 61
ci_063                -7.180710e-03 3 1  ON 62
ci_064                -6.052661e-03 3 1  ON 63
ci_065                -6.566985e-03 3 1  ON 64
ci_066                 6.795225e-03 3 1  ON 65
ci_067                 7.061570e-03 3 1  ON 66
ci_068                -7.062595e-03 3 1  ON 67
ci_069                -6.879883e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.3064
    reference variance = 0.6279
====================================================
  Execution time = 1.3600e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.0456e-01
  Total weights = 1.9557e+06
  Execution time = 1.8455e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293924168137
                                         uncertainty =       0.001516614907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293924168137
                                         uncertainty =       0.001516614907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383327219
  error estimate for blocks of size 2^( 2) =       0.000395496657
  error estimate for blocks of size 2^( 3) =       0.000405157844
  error estimate for blocks of size 2^( 4) =       0.000411898522
  error estimate for blocks of size 2^( 5) =       0.000415642783
  error estimate for blocks of size 2^( 6) =       0.000418452888
  error estimate for blocks of size 2^( 7) =       0.000419345279

      target function =      -0.894230665662
              le_mean =     -17.212526916551
             les_mean =     296.576448508982
             stat err =       0.000416334868
             autocorr =       1.179631204505
   target nu stat err =       0.000416334868
   target dn stat err =       0.002125717468
      target stat err =       0.002700481459
              std dev =       0.542106551967
             le_variance =       0.293879513686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290830602565
                                         uncertainty =       0.001474317105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290830602565
                                         uncertainty =       0.001474317105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381305346
  error estimate for blocks of size 2^( 2) =       0.000393545233
  error estimate for blocks of size 2^( 3) =       0.000403300213
  error estimate for blocks of size 2^( 4) =       0.000410113612
  error estimate for blocks of size 2^( 5) =       0.000413909871
  error estimate for blocks of size 2^( 6) =       0.000416730038
  error estimate for blocks of size 2^( 7) =       0.000417634115

      target function =      -0.893860145002
              le_mean =     -17.212545738575
             les_mean =     296.577394296832
             stat err =       0.000414596909
             autocorr =       1.182241854721
   target nu stat err =       0.000414596909
   target dn stat err =       0.002730541014
      target stat err =       0.003434329599
              std dev =       0.539247192264
             le_variance =       0.290787534365

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292245584440
                                         uncertainty =       0.001490554932

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292245584440
                                         uncertainty =       0.001490554932

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382231476
  error estimate for blocks of size 2^( 2) =       0.000394437245
  error estimate for blocks of size 2^( 3) =       0.000404145827
  error estimate for blocks of size 2^( 4) =       0.000410923374
  error estimate for blocks of size 2^( 5) =       0.000414691221
  error estimate for blocks of size 2^( 6) =       0.000417507417
  error estimate for blocks of size 2^( 7) =       0.000418405434

      target function =      -0.884681671902
              le_mean =     -17.212532672074
             les_mean =     296.584353038536
             stat err =       0.000415381862
             autocorr =       1.180978964044
   target nu stat err =       0.000415381862
   target dn stat err =       0.007575033003
      target stat err =       0.009219349000
              std dev =       0.540556937221
             le_variance =       0.292201802377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293704261077
                                         uncertainty =       0.001512622409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293704261077
                                         uncertainty =       0.001512622409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383183849
  error estimate for blocks of size 2^( 2) =       0.000395357709
  error estimate for blocks of size 2^( 3) =       0.000405024856
  error estimate for blocks of size 2^( 4) =       0.000411770171
  error estimate for blocks of size 2^( 5) =       0.000415517712
  error estimate for blocks of size 2^( 6) =       0.000418328261
  error estimate for blocks of size 2^( 7) =       0.000419221211

      target function =      -0.894560033224
              le_mean =     -17.212526978925
             les_mean =     296.576185399648
             stat err =       0.000416209339
             autocorr =       1.179802332868
   target nu stat err =       0.000416209339
   target dn stat err =       0.002117298288
      target stat err =       0.002692175497
              std dev =       0.541903795714
             le_variance =       0.293659723809


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.894230665662        initial
     1.0000e+00     1.0000e+01             6.8539e-04        -0.893860145002
     4.0000e+00     4.0000e+01             1.7878e-04        -0.884681671902
     1.6000e+01     1.6000e+02             4.5184e-05        -0.894560033224  <--

*****************************************************************************
Applying the update for shift_i =   1.6000e+01     and shift_s =   1.6000e+02
*****************************************************************************

  Execution time = 2.2896e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_001                -5.305441e-02 3 1  ON 0
ci_002                -4.126062e-02 3 1  ON 1
ci_003                -3.146177e-02 3 1  ON 2
ci_004                 2.998998e-02 3 1  ON 3
ci_005                 3.020770e-02 3 1  ON 4
ci_006                -2.773579e-02 3 1  ON 5
ci_007                -2.761324e-02 3 1  ON 6
ci_008                -1.741154e-02 3 1  ON 7
ci_009                -2.071001e-02 3 1  ON 8
ci_010                -1.794110e-02 3 1  ON 9
ci_011                -1.800816e-02 3 1  ON 10
ci_012                -1.812084e-02 3 1  ON 11
ci_013                -2.314665e-02 3 1  ON 12
ci_014                 1.853122e-02 3 1  ON 13
ci_015                 1.850510e-02 3 1  ON 14
ci_016                 2.038581e-02 3 1  ON 15
ci_017                 2.054252e-02 3 1  ON 16
ci_018                 1.640091e-02 3 1  ON 17
ci_019                 1.630939e-02 3 1  ON 18
ci_020                 2.119272e-02 3 1  ON 19
ci_021                 2.103799e-02 3 1  ON 20
ci_022                 1.496649e-02 3 1  ON 21
ci_023                 1.458751e-02 3 1  ON 22
ci_024                 1.548694e-02 3 1  ON 23
ci_025                 1.517775e-02 3 1  ON 24
ci_026                 1.569275e-02 3 1  ON 25
ci_027                 1.570463e-02 3 1  ON 26
ci_028                -1.790224e-02 3 1  ON 27
ci_029                -1.795890e-02 3 1  ON 28
ci_030                -1.360534e-02 3 1  ON 29
ci_031                -1.379496e-02 3 1  ON 30
ci_032                -1.607042e-02 3 1  ON 31
ci_033                 1.089528e-02 3 1  ON 32
ci_034                 1.117376e-02 3 1  ON 33
ci_035                -1.045890e-02 3 1  ON 34
ci_036                -1.534236e-02 3 1  ON 35
ci_037                -1.552141e-02 3 1  ON 36
ci_038                 8.114356e-03 3 1  ON 37
ci_039                 8.405857e-03 3 1  ON 38
ci_040                -8.422360e-03 3 1  ON 39
ci_041                 1.164231e-02 3 1  ON 40
ci_042                 1.192963e-02 3 1  ON 41
ci_043                -9.011983e-03 3 1  ON 42
ci_044                -9.299309e-03 3 1  ON 43
ci_045                -8.198044e-03 3 1  ON 44
ci_046                 9.581654e-03 3 1  ON 45
ci_047                 9.853707e-03 3 1  ON 46
ci_048                -1.400927e-02 3 1  ON 47
ci_049                -1.336426e-02 3 1  ON 48
ci_050                 7.352490e-03 3 1  ON 49
ci_051                 7.051589e-03 3 1  ON 50
ci_052                -6.220004e-03 3 1  ON 51
ci_053                -6.275264e-03 3 1  ON 52
ci_054                -7.049200e-03 3 1  ON 53
ci_055                -7.109602e-03 3 1  ON 54
ci_056                 8.545254e-03 3 1  ON 55
ci_057                 8.388500e-03 3 1  ON 56
ci_058                -6.119456e-03 3 1  ON 57
ci_059                -6.293665e-03 3 1  ON 58
ci_060                 8.003146e-03 3 1  ON 59
ci_061                 7.980205e-03 3 1  ON 60
ci_062                -7.218338e-03 3 1  ON 61
ci_063                -7.223849e-03 3 1  ON 62
ci_064                -6.103370e-03 3 1  ON 63
ci_065                -6.600302e-03 3 1  ON 64
ci_066                 6.830211e-03 3 1  ON 65
ci_067                 7.091592e-03 3 1  ON 66
ci_068                -7.102713e-03 3 1  ON 67
ci_069                -6.903675e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9419e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2807
    reference variance = 0.280359
====================================================
  Execution time = 1.3968e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5270e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.1261e-01
  Total weights = 1.955360419e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4699e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299108024729
                                         uncertainty =       0.002943126763

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299108024729
                                         uncertainty =       0.002943126763

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386671421
  error estimate for blocks of size 2^( 2) =       0.000398545886
  error estimate for blocks of size 2^( 3) =       0.000408703481
  error estimate for blocks of size 2^( 4) =       0.000416071827
  error estimate for blocks of size 2^( 5) =       0.000420024956
  error estimate for blocks of size 2^( 6) =       0.000421357698
  error estimate for blocks of size 2^( 7) =       0.000422452047

      target function =      -0.885292679827
              le_mean =     -17.212415262976
             les_mean =     296.579853287066
             stat err =       0.000419976632
             autocorr =       1.179685130091
   target nu stat err =       0.000419976632
   target dn stat err =       0.003343360597
      target stat err =       0.004106552892
              std dev =       0.546835967137
             le_variance =       0.299029574954


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721241526298e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.885310845439       residual = 4.82e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.885734476461       residual = 5.72e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.885795809555       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.885813521720       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.885815248276       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.885815527729       residual = 7.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.885815600421       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.885815581697       residual = 3.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.885815575898       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.885815573824       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.885815574004       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.885815573426       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 1.631146e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.885310845439       residual = 4.82e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.885418209122       residual = 5.70e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.885433697762       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.885438147728       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.885438580062       residual = 2.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.885438649430       residual = 6.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.885438667692       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.885438662987       residual = 3.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.885438661498       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.885438660995       residual = 8.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.885438661040       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.885438660895       residual = 2.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 4.136669e-05

solving harmonic davidson linear method for identity shift 6.4000e+01, overlap shift 6.4000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.885310845439       residual = 4.82e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.885337778875       residual = 5.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.885341660842       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.885342774691       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.885342882815       residual = 2.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.885342900125       residual = 6.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.885342904696       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.885342903519       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.885342903144       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.885342903019       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.885342903030       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.885342902994       residual = 2.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.4000e+01 is 1.037907e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.040360 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6448e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_001                -5.301768e-02 3 1  ON 0
ci_002                -4.122129e-02 3 1  ON 1
ci_003                -3.144664e-02 3 1  ON 2
ci_004                 2.996804e-02 3 1  ON 3
ci_005                 3.018275e-02 3 1  ON 4
ci_006                -2.771140e-02 3 1  ON 5
ci_007                -2.758579e-02 3 1  ON 6
ci_008                -1.737017e-02 3 1  ON 7
ci_009                -2.068766e-02 3 1  ON 8
ci_010                -1.790003e-02 3 1  ON 9
ci_011                -1.797134e-02 3 1  ON 10
ci_012                -1.808578e-02 3 1  ON 11
ci_013                -2.313912e-02 3 1  ON 12
ci_014                 1.850173e-02 3 1  ON 13
ci_015                 1.848075e-02 3 1  ON 14
ci_016                 2.037139e-02 3 1  ON 15
ci_017                 2.052634e-02 3 1  ON 16
ci_018                 1.637905e-02 3 1  ON 17
ci_019                 1.628545e-02 3 1  ON 18
ci_020                 2.117974e-02 3 1  ON 19
ci_021                 2.102352e-02 3 1  ON 20
ci_022                 1.493881e-02 3 1  ON 21
ci_023                 1.456705e-02 3 1  ON 22
ci_024                 1.547036e-02 3 1  ON 23
ci_025                 1.514992e-02 3 1  ON 24
ci_026                 1.567746e-02 3 1  ON 25
ci_027                 1.569279e-02 3 1  ON 26
ci_028                -1.789095e-02 3 1  ON 27
ci_029                -1.794602e-02 3 1  ON 28
ci_030                -1.358905e-02 3 1  ON 29
ci_031                -1.377057e-02 3 1  ON 30
ci_032                -1.606384e-02 3 1  ON 31
ci_033                 1.087231e-02 3 1  ON 32
ci_034                 1.114529e-02 3 1  ON 33
ci_035                -1.043523e-02 3 1  ON 34
ci_036                -1.532713e-02 3 1  ON 35
ci_037                -1.551491e-02 3 1  ON 36
ci_038                 8.085424e-03 3 1  ON 37
ci_039                 8.377684e-03 3 1  ON 38
ci_040                -8.398179e-03 3 1  ON 39
ci_041                 1.162665e-02 3 1  ON 40
ci_042                 1.191439e-02 3 1  ON 41
ci_043                -8.988686e-03 3 1  ON 42
ci_044                -9.274232e-03 3 1  ON 43
ci_045                -8.173661e-03 3 1  ON 44
ci_046                 9.567912e-03 3 1  ON 45
ci_047                 9.836799e-03 3 1  ON 46
ci_048                -1.400282e-02 3 1  ON 47
ci_049                -1.336479e-02 3 1  ON 48
ci_050                 7.332441e-03 3 1  ON 49
ci_051                 7.034785e-03 3 1  ON 50
ci_052                -6.197184e-03 3 1  ON 51
ci_053                -6.247178e-03 3 1  ON 52
ci_054                -7.034962e-03 3 1  ON 53
ci_055                -7.094774e-03 3 1  ON 54
ci_056                 8.534820e-03 3 1  ON 55
ci_057                 8.377401e-03 3 1  ON 56
ci_058                -6.100646e-03 3 1  ON 57
ci_059                -6.268994e-03 3 1  ON 58
ci_060                 7.992273e-03 3 1  ON 59
ci_061                 7.971987e-03 3 1  ON 60
ci_062                -7.201784e-03 3 1  ON 61
ci_063                -7.213573e-03 3 1  ON 62
ci_064                -6.091148e-03 3 1  ON 63
ci_065                -6.588792e-03 3 1  ON 64
ci_066                 6.820707e-03 3 1  ON 65
ci_067                 7.075900e-03 3 1  ON 66
ci_068                -7.094111e-03 3 1  ON 67
ci_069                -6.896727e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2486
    reference variance = 0.21107
====================================================
  Execution time = 1.3592e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.0705e-01
  Total weights = 1.9559e+06
  Execution time = 1.8503e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293580929257
                                         uncertainty =       0.001901778928

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293580929257
                                         uncertainty =       0.001901778928

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383072119
  error estimate for blocks of size 2^( 2) =       0.000394692886
  error estimate for blocks of size 2^( 3) =       0.000405457243
  error estimate for blocks of size 2^( 4) =       0.000413456179
  error estimate for blocks of size 2^( 5) =       0.000418161053
  error estimate for blocks of size 2^( 6) =       0.000419186908
  error estimate for blocks of size 2^( 7) =       0.000420248985

      target function =      -0.885829361143
              le_mean =     -17.212045885441
             les_mean =     296.566612832056
             stat err =       0.000417763281
             autocorr =       1.189321973496
   target nu stat err =       0.000417763281
   target dn stat err =       0.005381354607
      target stat err =       0.006573716225
              std dev =       0.541745786334
             le_variance =       0.293488497011

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292810702906
                                         uncertainty =       0.001895215225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292810702906
                                         uncertainty =       0.001895215225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382569517
  error estimate for blocks of size 2^( 2) =       0.000394209958
  error estimate for blocks of size 2^( 3) =       0.000404997983
  error estimate for blocks of size 2^( 4) =       0.000413012873
  error estimate for blocks of size 2^( 5) =       0.000417730829
  error estimate for blocks of size 2^( 6) =       0.000418766202
  error estimate for blocks of size 2^( 7) =       0.000419829200

      target function =      -0.892900383337
              le_mean =     -17.212050582424
             les_mean =     296.561042287863
             stat err =       0.000417334776
             autocorr =       1.190004011611
   target nu stat err =       0.000417334776
   target dn stat err =       0.002382412086
      target stat err =       0.003001689127
              std dev =       0.541034999644
             le_variance =       0.292718870840

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293188054522
                                         uncertainty =       0.001898423476

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293188054522
                                         uncertainty =       0.001898423476

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382815836
  error estimate for blocks of size 2^( 2) =       0.000394446497
  error estimate for blocks of size 2^( 3) =       0.000405222799
  error estimate for blocks of size 2^( 4) =       0.000413229821
  error estimate for blocks of size 2^( 5) =       0.000417941289
  error estimate for blocks of size 2^( 6) =       0.000418971940
  error estimate for blocks of size 2^( 7) =       0.000420034442

      target function =      -0.892365308649
              le_mean =     -17.212047975692
             les_mean =     296.561385113332
             stat err =       0.000417544373
             autocorr =       1.189667180824
   target nu stat err =       0.000417544373
   target dn stat err =       0.002389443275
      target stat err =       0.003006723610
              std dev =       0.541383346912
             le_variance =       0.293095928314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293531356861
                                         uncertainty =       0.001901354851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293531356861
                                         uncertainty =       0.001901354851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383039791
  error estimate for blocks of size 2^( 2) =       0.000394661789
  error estimate for blocks of size 2^( 3) =       0.000405427672
  error estimate for blocks of size 2^( 4) =       0.000413427617
  error estimate for blocks of size 2^( 5) =       0.000418133250
  error estimate for blocks of size 2^( 6) =       0.000419159695
  error estimate for blocks of size 2^( 7) =       0.000420221790

      target function =      -0.891128687186
              le_mean =     -17.212046179503
             les_mean =     296.562325277733
             stat err =       0.000417735588
             autocorr =       1.189365037301
   target nu stat err =       0.000417735588
   target dn stat err =       0.002466899204
      target stat err =       0.003092248548
              std dev =       0.541700067567
             le_variance =       0.293438963202


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.885829361143        initial
     4.0000e+00     4.0000e+01             1.6311e-04        -0.892900383337  <--
     1.6000e+01     1.6000e+02             4.1367e-05        -0.892365308649
     6.4000e+01     6.4000e+02             1.0379e-05        -0.891128687186

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 2.2886e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_001                -5.290912e-02 3 1  ON 0
ci_002                -4.110511e-02 3 1  ON 1
ci_003                -3.140183e-02 3 1  ON 2
ci_004                 2.990319e-02 3 1  ON 3
ci_005                 3.010904e-02 3 1  ON 4
ci_006                -2.763937e-02 3 1  ON 5
ci_007                -2.750472e-02 3 1  ON 6
ci_008                -1.724843e-02 3 1  ON 7
ci_009                -2.062174e-02 3 1  ON 8
ci_010                -1.777891e-02 3 1  ON 9
ci_011                -1.786275e-02 3 1  ON 10
ci_012                -1.798238e-02 3 1  ON 11
ci_013                -2.311687e-02 3 1  ON 12
ci_014                 1.841478e-02 3 1  ON 13
ci_015                 1.840892e-02 3 1  ON 14
ci_016                 2.032889e-02 3 1  ON 15
ci_017                 2.047863e-02 3 1  ON 16
ci_018                 1.631462e-02 3 1  ON 17
ci_019                 1.621493e-02 3 1  ON 18
ci_020                 2.114131e-02 3 1  ON 19
ci_021                 2.098073e-02 3 1  ON 20
ci_022                 1.485723e-02 3 1  ON 21
ci_023                 1.450676e-02 3 1  ON 22
ci_024                 1.542130e-02 3 1  ON 23
ci_025                 1.506763e-02 3 1  ON 24
ci_026                 1.563235e-02 3 1  ON 25
ci_027                 1.565782e-02 3 1  ON 26
ci_028                -1.785760e-02 3 1  ON 27
ci_029                -1.790804e-02 3 1  ON 28
ci_030                -1.354103e-02 3 1  ON 29
ci_031                -1.369875e-02 3 1  ON 30
ci_032                -1.604440e-02 3 1  ON 31
ci_033                 1.080450e-02 3 1  ON 32
ci_034                 1.106130e-02 3 1  ON 33
ci_035                -1.036550e-02 3 1  ON 34
ci_036                -1.528213e-02 3 1  ON 35
ci_037                -1.549564e-02 3 1  ON 36
ci_038                 8.000202e-03 3 1  ON 37
ci_039                 8.294699e-03 3 1  ON 38
ci_040                -8.326981e-03 3 1  ON 39
ci_041                 1.158054e-02 3 1  ON 40
ci_042                 1.186948e-02 3 1  ON 41
ci_043                -8.920036e-03 3 1  ON 42
ci_044                -9.200289e-03 3 1  ON 43
ci_045                -8.101865e-03 3 1  ON 44
ci_046                 9.527362e-03 3 1  ON 45
ci_047                 9.786898e-03 3 1  ON 46
ci_048                -1.398381e-02 3 1  ON 47
ci_049                -1.336635e-02 3 1  ON 48
ci_050                 7.273454e-03 3 1  ON 49
ci_051                 6.985345e-03 3 1  ON 50
ci_052                -6.130046e-03 3 1  ON 51
ci_053                -6.164581e-03 3 1  ON 52
ci_054                -6.992914e-03 3 1  ON 53
ci_055                -7.051031e-03 3 1  ON 54
ci_056                 8.504061e-03 3 1  ON 55
ci_057                 8.344686e-03 3 1  ON 56
ci_058                -6.045329e-03 3 1  ON 57
ci_059                -6.196450e-03 3 1  ON 58
ci_060                 7.960176e-03 3 1  ON 59
ci_061                 7.947696e-03 3 1  ON 60
ci_062                -7.152940e-03 3 1  ON 61
ci_063                -7.183205e-03 3 1  ON 62
ci_064                -6.055166e-03 3 1  ON 63
ci_065                -6.554902e-03 3 1  ON 64
ci_066                 6.792738e-03 3 1  ON 65
ci_067                 7.029706e-03 3 1  ON 66
ci_068                -7.068785e-03 3 1  ON 67
ci_069                -6.876266e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9340e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7224e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2118
    reference variance = 0.298542
====================================================
  Execution time = 1.6089e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.0768e-01
  Total weights = 1.955467345e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4926e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294140023939
                                         uncertainty =       0.002093700266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294140023939
                                         uncertainty =       0.002093700266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383506095
  error estimate for blocks of size 2^( 2) =       0.000394702254
  error estimate for blocks of size 2^( 3) =       0.000404711657
  error estimate for blocks of size 2^( 4) =       0.000412485354
  error estimate for blocks of size 2^( 5) =       0.000417585389
  error estimate for blocks of size 2^( 6) =       0.000421436343
  error estimate for blocks of size 2^( 7) =       0.000425171046

      target function =      -0.891265145348
              le_mean =     -17.212055703552
             les_mean =     296.562542554725
             stat err =       0.000419169533
             autocorr =       1.194634017035
   target nu stat err =       0.000419169533
   target dn stat err =       0.002649866106
      target stat err =       0.003315271440
              std dev =       0.542359520302
             le_variance =       0.294153849263


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721205570355e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.891276808460       residual = 4.05e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.892679844909       residual = 5.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.892897653589       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.892948683429       residual = 1.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.892954531287       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.892956402118       residual = 7.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.892956796626       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.892956820401       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.892956838166       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.892956833307       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.892956833047       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.892956832809       residual = 2.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 6.126644e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.891276808460       residual = 4.05e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.891646715788       residual = 5.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.891703366571       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.891716381475       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.891717858281       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.891718326531       residual = 7.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.891718425728       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.891718430752       residual = 2.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.891718434952       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.891718433715       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.891718433639       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.891718433571       residual = 1.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 1.599369e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.891276808460       residual = 4.05e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.891370562610       residual = 5.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.891384868354       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.891388137686       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.891388507695       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.891388624738       residual = 7.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.891388649562       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.891388650757       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.891388651791       residual = 2.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.891388651481       residual = 6.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.891388651461       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.891388651443       residual = 1.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 4.043009e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.045156 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8592e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_001                -5.274918e-02 3 1  ON 0
ci_002                -4.099614e-02 3 1  ON 1
ci_003                -3.132578e-02 3 1  ON 2
ci_004                 2.982980e-02 3 1  ON 3
ci_005                 3.000122e-02 3 1  ON 4
ci_006                -2.755703e-02 3 1  ON 5
ci_007                -2.740827e-02 3 1  ON 6
ci_008                -1.709440e-02 3 1  ON 7
ci_009                -2.051596e-02 3 1  ON 8
ci_010                -1.764036e-02 3 1  ON 9
ci_011                -1.771037e-02 3 1  ON 10
ci_012                -1.786438e-02 3 1  ON 11
ci_013                -2.307889e-02 3 1  ON 12
ci_014                 1.831860e-02 3 1  ON 13
ci_015                 1.831078e-02 3 1  ON 14
ci_016                 2.025513e-02 3 1  ON 15
ci_017                 2.042532e-02 3 1  ON 16
ci_018                 1.622527e-02 3 1  ON 17
ci_019                 1.612756e-02 3 1  ON 18
ci_020                 2.108172e-02 3 1  ON 19
ci_021                 2.092747e-02 3 1  ON 20
ci_022                 1.476088e-02 3 1  ON 21
ci_023                 1.443406e-02 3 1  ON 22
ci_024                 1.533854e-02 3 1  ON 23
ci_025                 1.498494e-02 3 1  ON 24
ci_026                 1.555370e-02 3 1  ON 25
ci_027                 1.559862e-02 3 1  ON 26
ci_028                -1.781935e-02 3 1  ON 27
ci_029                -1.786005e-02 3 1  ON 28
ci_030                -1.345488e-02 3 1  ON 29
ci_031                -1.360818e-02 3 1  ON 30
ci_032                -1.602045e-02 3 1  ON 31
ci_033                 1.071519e-02 3 1  ON 32
ci_034                 1.096835e-02 3 1  ON 33
ci_035                -1.027734e-02 3 1  ON 34
ci_036                -1.523849e-02 3 1  ON 35
ci_037                -1.546915e-02 3 1  ON 36
ci_038                 7.891056e-03 3 1  ON 37
ci_039                 8.185798e-03 3 1  ON 38
ci_040                -8.234812e-03 3 1  ON 39
ci_041                 1.149442e-02 3 1  ON 40
ci_042                 1.181172e-02 3 1  ON 41
ci_043                -8.828365e-03 3 1  ON 42
ci_044                -9.101836e-03 3 1  ON 43
ci_045                -8.004310e-03 3 1  ON 44
ci_046                 9.467060e-03 3 1  ON 45
ci_047                 9.725570e-03 3 1  ON 46
ci_048                -1.395301e-02 3 1  ON 47
ci_049                -1.336259e-02 3 1  ON 48
ci_050                 7.198489e-03 3 1  ON 49
ci_051                 6.921575e-03 3 1  ON 50
ci_052                -6.060252e-03 3 1  ON 51
ci_053                -6.087993e-03 3 1  ON 52
ci_054                -6.919768e-03 3 1  ON 53
ci_055                -6.986571e-03 3 1  ON 54
ci_056                 8.466276e-03 3 1  ON 55
ci_057                 8.299451e-03 3 1  ON 56
ci_058                -5.969534e-03 3 1  ON 57
ci_059                -6.123809e-03 3 1  ON 58
ci_060                 7.919626e-03 3 1  ON 59
ci_061                 7.909199e-03 3 1  ON 60
ci_062                -7.097508e-03 3 1  ON 61
ci_063                -7.130073e-03 3 1  ON 62
ci_064                -6.008443e-03 3 1  ON 63
ci_065                -6.510668e-03 3 1  ON 64
ci_066                 6.745832e-03 3 1  ON 65
ci_067                 6.978155e-03 3 1  ON 66
ci_068                -7.054135e-03 3 1  ON 67
ci_069                -6.833079e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2654
    reference variance = 0.190598
====================================================
  Execution time = 1.3587e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 3.0907e-01
  Total weights = 1.9556e+06
  Execution time = 1.8468e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295184918404
                                         uncertainty =       0.001637019162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295184918404
                                         uncertainty =       0.001637019162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384200828
  error estimate for blocks of size 2^( 2) =       0.000395617830
  error estimate for blocks of size 2^( 3) =       0.000405721542
  error estimate for blocks of size 2^( 4) =       0.000412809949
  error estimate for blocks of size 2^( 5) =       0.000417225238
  error estimate for blocks of size 2^( 6) =       0.000419593313
  error estimate for blocks of size 2^( 7) =       0.000421114825

      target function =      -0.887455526253
              le_mean =     -17.211410353160
             les_mean =     296.543327955354
             stat err =       0.000417685831
             autocorr =       1.181905877677
   target nu stat err =       0.000417685831
   target dn stat err =       0.002630240914
      target stat err =       0.003260203406
              std dev =       0.543342022255
             le_variance =       0.295220553148

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292176841176
                                         uncertainty =       0.001578439775

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292176841176
                                         uncertainty =       0.001578439775

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382238273
  error estimate for blocks of size 2^( 2) =       0.000393728653
  error estimate for blocks of size 2^( 3) =       0.000403932586
  error estimate for blocks of size 2^( 4) =       0.000411087042
  error estimate for blocks of size 2^( 5) =       0.000415538258
  error estimate for blocks of size 2^( 6) =       0.000417936538
  error estimate for blocks of size 2^( 7) =       0.000419477298

      target function =      -0.883535312592
              le_mean =     -17.211427226270
             les_mean =     296.547074632738
             stat err =       0.000416009784
             autocorr =       1.184510052576
   target nu stat err =       0.000416009784
   target dn stat err =       0.007339041503
      target stat err =       0.008894889267
              std dev =       0.540566549076
             le_variance =       0.292212193980

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293543547528
                                         uncertainty =       0.001600221639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293543547528
                                         uncertainty =       0.001600221639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383131245
  error estimate for blocks of size 2^( 2) =       0.000394585915
  error estimate for blocks of size 2^( 3) =       0.000404740709
  error estimate for blocks of size 2^( 4) =       0.000411862469
  error estimate for blocks of size 2^( 5) =       0.000416297007
  error estimate for blocks of size 2^( 6) =       0.000418681667
  error estimate for blocks of size 2^( 7) =       0.000420214070

      target function =      -0.890530386901
              le_mean =     -17.211414591078
             les_mean =     296.540963804117
             stat err =       0.000416763803
             autocorr =       1.183272697584
   target nu stat err =       0.000416763803
   target dn stat err =       0.002528827772
      target stat err =       0.003159684293
              std dev =       0.541829402373
             le_variance =       0.293579101276

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294969244157
                                         uncertainty =       0.001631289989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294969244157
                                         uncertainty =       0.001631289989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384060464
  error estimate for blocks of size 2^( 2) =       0.000395482075
  error estimate for blocks of size 2^( 3) =       0.000405592317
  error estimate for blocks of size 2^( 4) =       0.000412684731
  error estimate for blocks of size 2^( 5) =       0.000417102535
  error estimate for blocks of size 2^( 6) =       0.000419472441
  error estimate for blocks of size 2^( 7) =       0.000420994514

      target function =      -0.888269276076
              le_mean =     -17.211410482858
             les_mean =     296.542666363421
             stat err =       0.000417563555
             autocorr =       1.182077551721
   target nu stat err =       0.000417563555
   target dn stat err =       0.002593452849
      target stat err =       0.003221804825
              std dev =       0.543143516287
             le_variance =       0.295004879284


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.887455526253        initial
     1.0000e+00     1.0000e+01             6.1266e-04        -0.883535312592
     4.0000e+00     4.0000e+01             1.5994e-04        -0.890530386901  <--
     1.6000e+01     1.6000e+02             4.0430e-05        -0.888269276076

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 2.2885e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_001                -5.274918e-02 3 1  ON 0
ci_002                -4.099614e-02 3 1  ON 1
ci_003                -3.132578e-02 3 1  ON 2
ci_004                 2.982980e-02 3 1  ON 3
ci_005                 3.000122e-02 3 1  ON 4
ci_006                -2.755703e-02 3 1  ON 5
ci_007                -2.740827e-02 3 1  ON 6
ci_008                -1.709440e-02 3 1  ON 7
ci_009                -2.051596e-02 3 1  ON 8
ci_010                -1.764036e-02 3 1  ON 9
ci_011                -1.771037e-02 3 1  ON 10
ci_012                -1.786438e-02 3 1  ON 11
ci_013                -2.307889e-02 3 1  ON 12
ci_014                 1.831860e-02 3 1  ON 13
ci_015                 1.831078e-02 3 1  ON 14
ci_016                 2.025513e-02 3 1  ON 15
ci_017                 2.042532e-02 3 1  ON 16
ci_018                 1.622527e-02 3 1  ON 17
ci_019                 1.612756e-02 3 1  ON 18
ci_020                 2.108172e-02 3 1  ON 19
ci_021                 2.092747e-02 3 1  ON 20
ci_022                 1.476088e-02 3 1  ON 21
ci_023                 1.443406e-02 3 1  ON 22
ci_024                 1.533854e-02 3 1  ON 23
ci_025                 1.498494e-02 3 1  ON 24
ci_026                 1.555370e-02 3 1  ON 25
ci_027                 1.559862e-02 3 1  ON 26
ci_028                -1.781935e-02 3 1  ON 27
ci_029                -1.786005e-02 3 1  ON 28
ci_030                -1.345488e-02 3 1  ON 29
ci_031                -1.360818e-02 3 1  ON 30
ci_032                -1.602045e-02 3 1  ON 31
ci_033                 1.071519e-02 3 1  ON 32
ci_034                 1.096835e-02 3 1  ON 33
ci_035                -1.027734e-02 3 1  ON 34
ci_036                -1.523849e-02 3 1  ON 35
ci_037                -1.546915e-02 3 1  ON 36
ci_038                 7.891056e-03 3 1  ON 37
ci_039                 8.185798e-03 3 1  ON 38
ci_040                -8.234812e-03 3 1  ON 39
ci_041                 1.149442e-02 3 1  ON 40
ci_042                 1.181172e-02 3 1  ON 41
ci_043                -8.828365e-03 3 1  ON 42
ci_044                -9.101836e-03 3 1  ON 43
ci_045                -8.004310e-03 3 1  ON 44
ci_046                 9.467060e-03 3 1  ON 45
ci_047                 9.725570e-03 3 1  ON 46
ci_048                -1.395301e-02 3 1  ON 47
ci_049                -1.336259e-02 3 1  ON 48
ci_050                 7.198489e-03 3 1  ON 49
ci_051                 6.921575e-03 3 1  ON 50
ci_052                -6.060252e-03 3 1  ON 51
ci_053                -6.087993e-03 3 1  ON 52
ci_054                -6.919768e-03 3 1  ON 53
ci_055                -6.986571e-03 3 1  ON 54
ci_056                 8.466276e-03 3 1  ON 55
ci_057                 8.299451e-03 3 1  ON 56
ci_058                -5.969534e-03 3 1  ON 57
ci_059                -6.123809e-03 3 1  ON 58
ci_060                 7.919626e-03 3 1  ON 59
ci_061                 7.909199e-03 3 1  ON 60
ci_062                -7.097508e-03 3 1  ON 61
ci_063                -7.130073e-03 3 1  ON 62
ci_064                -6.008443e-03 3 1  ON 63
ci_065                -6.510668e-03 3 1  ON 64
ci_066                 6.745832e-03 3 1  ON 65
ci_067                 6.978155e-03 3 1  ON 66
ci_068                -7.054135e-03 3 1  ON 67
ci_069                -6.833079e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1483e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2809
    reference variance = 0.805043
====================================================
  Execution time = 1.3917e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.0837e-01
  Total weights = 1.955950001e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4840e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294081975396
                                         uncertainty =       0.002572303945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294081975396
                                         uncertainty =       0.002572303945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383490480
  error estimate for blocks of size 2^( 2) =       0.000395168878
  error estimate for blocks of size 2^( 3) =       0.000405126477
  error estimate for blocks of size 2^( 4) =       0.000412517157
  error estimate for blocks of size 2^( 5) =       0.000416311611
  error estimate for blocks of size 2^( 6) =       0.000418792105
  error estimate for blocks of size 2^( 7) =       0.000419755011

      target function =      -0.890571604016
              le_mean =     -17.212946790508
             les_mean =     296.593911399090
             stat err =       0.000416843971
             autocorr =       1.181511283977
   target nu stat err =       0.000416843971
   target dn stat err =       0.004472650729
      target stat err =       0.005538930203
              std dev =       0.542337438374
             le_variance =       0.294129897062


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721294679051e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.890605606539       residual = 4.90e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.892195568520       residual = 5.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.892434462211       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.892490633016       residual = 1.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.892496932688       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.892498429182       residual = 8.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.892498498866       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.892498563731       residual = 3.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.892498538101       residual = 4.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.892498526774       residual = 6.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.892498523774       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.892498523215       residual = 2.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 7.409192e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.890605606539       residual = 4.90e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.891024974039       residual = 5.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.891087096000       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.891101447509       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.891103034044       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.891103409249       residual = 7.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.891103425253       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.891103440984       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.891103434559       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.891103431700       residual = 5.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.891103430964       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.891103430824       residual = 1.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 1.950952e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.890605606539       residual = 4.90e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.890711908227       residual = 5.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.890727594588       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.890731201384       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.890731598584       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.890731692418       residual = 7.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.890731696324       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.890731700222       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.890731698616       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.890731697900       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.890731697717       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.890731697682       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 4.943052e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.049960 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6414e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_001                -5.258866e-02 3 1  ON 0
ci_002                -4.087143e-02 3 1  ON 1
ci_003                -3.124125e-02 3 1  ON 2
ci_004                 2.979828e-02 3 1  ON 3
ci_005                 2.992025e-02 3 1  ON 4
ci_006                -2.747009e-02 3 1  ON 5
ci_007                -2.731135e-02 3 1  ON 6
ci_008                -1.693127e-02 3 1  ON 7
ci_009                -2.045246e-02 3 1  ON 8
ci_010                -1.753190e-02 3 1  ON 9
ci_011                -1.758155e-02 3 1  ON 10
ci_012                -1.766928e-02 3 1  ON 11
ci_013                -2.303700e-02 3 1  ON 12
ci_014                 1.821398e-02 3 1  ON 13
ci_015                 1.821686e-02 3 1  ON 14
ci_016                 2.019672e-02 3 1  ON 15
ci_017                 2.034706e-02 3 1  ON 16
ci_018                 1.614175e-02 3 1  ON 17
ci_019                 1.602688e-02 3 1  ON 18
ci_020                 2.103208e-02 3 1  ON 19
ci_021                 2.086903e-02 3 1  ON 20
ci_022                 1.467595e-02 3 1  ON 21
ci_023                 1.436421e-02 3 1  ON 22
ci_024                 1.525880e-02 3 1  ON 23
ci_025                 1.489997e-02 3 1  ON 24
ci_026                 1.543332e-02 3 1  ON 25
ci_027                 1.554260e-02 3 1  ON 26
ci_028                -1.776664e-02 3 1  ON 27
ci_029                -1.781290e-02 3 1  ON 28
ci_030                -1.339556e-02 3 1  ON 29
ci_031                -1.350353e-02 3 1  ON 30
ci_032                -1.598711e-02 3 1  ON 31
ci_033                 1.065251e-02 3 1  ON 32
ci_034                 1.086878e-02 3 1  ON 33
ci_035                -1.018902e-02 3 1  ON 34
ci_036                -1.521371e-02 3 1  ON 35
ci_037                -1.540990e-02 3 1  ON 36
ci_038                 7.779153e-03 3 1  ON 37
ci_039                 8.070765e-03 3 1  ON 38
ci_040                -8.135676e-03 3 1  ON 39
ci_041                 1.142491e-02 3 1  ON 40
ci_042                 1.175232e-02 3 1  ON 41
ci_043                -8.747644e-03 3 1  ON 42
ci_044                -9.011835e-03 3 1  ON 43
ci_045                -7.911775e-03 3 1  ON 44
ci_046                 9.411282e-03 3 1  ON 45
ci_047                 9.658133e-03 3 1  ON 46
ci_048                -1.394451e-02 3 1  ON 47
ci_049                -1.336035e-02 3 1  ON 48
ci_050                 7.121446e-03 3 1  ON 49
ci_051                 6.833289e-03 3 1  ON 50
ci_052                -5.995903e-03 3 1  ON 51
ci_053                -6.025983e-03 3 1  ON 52
ci_054                -6.855595e-03 3 1  ON 53
ci_055                -6.920763e-03 3 1  ON 54
ci_056                 8.416545e-03 3 1  ON 55
ci_057                 8.247636e-03 3 1  ON 56
ci_058                -5.902724e-03 3 1  ON 57
ci_059                -6.018804e-03 3 1  ON 58
ci_060                 7.871388e-03 3 1  ON 59
ci_061                 7.858733e-03 3 1  ON 60
ci_062                -7.045346e-03 3 1  ON 61
ci_063                -7.067252e-03 3 1  ON 62
ci_064                -5.950191e-03 3 1  ON 63
ci_065                -6.463090e-03 3 1  ON 64
ci_066                 6.707760e-03 3 1  ON 65
ci_067                 6.919393e-03 3 1  ON 66
ci_068                -7.022633e-03 3 1  ON 67
ci_069                -6.786764e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.3125
    reference variance = 0.614443
====================================================
  Execution time = 1.3673e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.1426e-01
  Total weights = 1.9557e+06
  Execution time = 1.8392e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299061036822
                                         uncertainty =       0.002310075253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.299061036822
                                         uncertainty =       0.002310075253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386667833
  error estimate for blocks of size 2^( 2) =       0.000398330700
  error estimate for blocks of size 2^( 3) =       0.000408588836
  error estimate for blocks of size 2^( 4) =       0.000415110421
  error estimate for blocks of size 2^( 5) =       0.000419257510
  error estimate for blocks of size 2^( 6) =       0.000422237913
  error estimate for blocks of size 2^( 7) =       0.000424372994

      target function =      -0.882674174657
              le_mean =     -17.213348030618
             les_mean =     296.614262912467
             stat err =       0.000420244709
             autocorr =       1.181213546894
   target nu stat err =       0.000420244709
   target dn stat err =       0.003922692253
      target stat err =       0.004783933594
              std dev =       0.546830894263
             le_variance =       0.299024026921

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296259778618
                                         uncertainty =       0.002280234440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296259778618
                                         uncertainty =       0.002280234440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384852564
  error estimate for blocks of size 2^( 2) =       0.000396595126
  error estimate for blocks of size 2^( 3) =       0.000406929330
  error estimate for blocks of size 2^( 4) =       0.000413513421
  error estimate for blocks of size 2^( 5) =       0.000417702604
  error estimate for blocks of size 2^( 6) =       0.000420688640
  error estimate for blocks of size 2^( 7) =       0.000422836613

      target function =      -0.882751715507
              le_mean =     -17.213346041109
             les_mean =     296.614121489473
             stat err =       0.000418685319
             autocorr =       1.183550239046
   target nu stat err =       0.000418685319
   target dn stat err =       0.004654593397
      target stat err =       0.005665396567
              std dev =       0.544263715586
             le_variance =       0.296222992103

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297540639626
                                         uncertainty =       0.002292223270

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.297540639626
                                         uncertainty =       0.002292223270

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000385683645
  error estimate for blocks of size 2^( 2) =       0.000397387606
  error estimate for blocks of size 2^( 3) =       0.000407684883
  error estimate for blocks of size 2^( 4) =       0.000414238370
  error estimate for blocks of size 2^( 5) =       0.000418406564
  error estimate for blocks of size 2^( 6) =       0.000421389917
  error estimate for blocks of size 2^( 7) =       0.000423534422

      target function =      -0.883511142260
              le_mean =     -17.213342588604
             les_mean =     296.613381148019
             stat err =       0.000419392318
             autocorr =       1.182438327246
   target nu stat err =       0.000419392318
   target dn stat err =       0.004180980896
      target stat err =       0.005103945982
              std dev =       0.545439041022
             le_variance =       0.297503747471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298863064881
                                         uncertainty =       0.002307604807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298863064881
                                         uncertainty =       0.002307604807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386539823
  error estimate for blocks of size 2^( 2) =       0.000398207758
  error estimate for blocks of size 2^( 3) =       0.000408470747
  error estimate for blocks of size 2^( 4) =       0.000414996303
  error estimate for blocks of size 2^( 5) =       0.000419146012
  error estimate for blocks of size 2^( 6) =       0.000422126885
  error estimate for blocks of size 2^( 7) =       0.000424262989

      target function =      -0.882895701032
              le_mean =     -17.213346773860
             les_mean =     296.614036253780
             stat err =       0.000420133047
             autocorr =       1.181367994173
   target nu stat err =       0.000420133047
   target dn stat err =       0.003946526286
      target stat err =       0.004814952393
              std dev =       0.546649860529
             le_variance =       0.298826070016


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.882674174657        initial
     1.0000e+00     1.0000e+01             7.4092e-04        -0.882751715507
     4.0000e+00     4.0000e+01             1.9510e-04        -0.883511142260  <--
     1.6000e+01     1.6000e+02             4.9431e-05        -0.882895701032

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 2.2986e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_001                -5.258866e-02 3 1  ON 0
ci_002                -4.087143e-02 3 1  ON 1
ci_003                -3.124125e-02 3 1  ON 2
ci_004                 2.979828e-02 3 1  ON 3
ci_005                 2.992025e-02 3 1  ON 4
ci_006                -2.747009e-02 3 1  ON 5
ci_007                -2.731135e-02 3 1  ON 6
ci_008                -1.693127e-02 3 1  ON 7
ci_009                -2.045246e-02 3 1  ON 8
ci_010                -1.753190e-02 3 1  ON 9
ci_011                -1.758155e-02 3 1  ON 10
ci_012                -1.766928e-02 3 1  ON 11
ci_013                -2.303700e-02 3 1  ON 12
ci_014                 1.821398e-02 3 1  ON 13
ci_015                 1.821686e-02 3 1  ON 14
ci_016                 2.019672e-02 3 1  ON 15
ci_017                 2.034706e-02 3 1  ON 16
ci_018                 1.614175e-02 3 1  ON 17
ci_019                 1.602688e-02 3 1  ON 18
ci_020                 2.103208e-02 3 1  ON 19
ci_021                 2.086903e-02 3 1  ON 20
ci_022                 1.467595e-02 3 1  ON 21
ci_023                 1.436421e-02 3 1  ON 22
ci_024                 1.525880e-02 3 1  ON 23
ci_025                 1.489997e-02 3 1  ON 24
ci_026                 1.543332e-02 3 1  ON 25
ci_027                 1.554260e-02 3 1  ON 26
ci_028                -1.776664e-02 3 1  ON 27
ci_029                -1.781290e-02 3 1  ON 28
ci_030                -1.339556e-02 3 1  ON 29
ci_031                -1.350353e-02 3 1  ON 30
ci_032                -1.598711e-02 3 1  ON 31
ci_033                 1.065251e-02 3 1  ON 32
ci_034                 1.086878e-02 3 1  ON 33
ci_035                -1.018902e-02 3 1  ON 34
ci_036                -1.521371e-02 3 1  ON 35
ci_037                -1.540990e-02 3 1  ON 36
ci_038                 7.779153e-03 3 1  ON 37
ci_039                 8.070765e-03 3 1  ON 38
ci_040                -8.135676e-03 3 1  ON 39
ci_041                 1.142491e-02 3 1  ON 40
ci_042                 1.175232e-02 3 1  ON 41
ci_043                -8.747644e-03 3 1  ON 42
ci_044                -9.011835e-03 3 1  ON 43
ci_045                -7.911775e-03 3 1  ON 44
ci_046                 9.411282e-03 3 1  ON 45
ci_047                 9.658133e-03 3 1  ON 46
ci_048                -1.394451e-02 3 1  ON 47
ci_049                -1.336035e-02 3 1  ON 48
ci_050                 7.121446e-03 3 1  ON 49
ci_051                 6.833289e-03 3 1  ON 50
ci_052                -5.995903e-03 3 1  ON 51
ci_053                -6.025983e-03 3 1  ON 52
ci_054                -6.855595e-03 3 1  ON 53
ci_055                -6.920763e-03 3 1  ON 54
ci_056                 8.416545e-03 3 1  ON 55
ci_057                 8.247636e-03 3 1  ON 56
ci_058                -5.902724e-03 3 1  ON 57
ci_059                -6.018804e-03 3 1  ON 58
ci_060                 7.871388e-03 3 1  ON 59
ci_061                 7.858733e-03 3 1  ON 60
ci_062                -7.045346e-03 3 1  ON 61
ci_063                -7.067252e-03 3 1  ON 62
ci_064                -5.950191e-03 3 1  ON 63
ci_065                -6.463090e-03 3 1  ON 64
ci_066                 6.707760e-03 3 1  ON 65
ci_067                 6.919393e-03 3 1  ON 66
ci_068                -7.022633e-03 3 1  ON 67
ci_069                -6.786764e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9406e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7234e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2627
    reference variance = 0.214826
====================================================
  Execution time = 1.3947e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.1203e-01
  Total weights = 1.955808713e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5004e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296285895482
                                         uncertainty =       0.003123730211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296285895482
                                         uncertainty =       0.003123730211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384880466
  error estimate for blocks of size 2^( 2) =       0.000396028924
  error estimate for blocks of size 2^( 3) =       0.000405792548
  error estimate for blocks of size 2^( 4) =       0.000412947977
  error estimate for blocks of size 2^( 5) =       0.000417655630
  error estimate for blocks of size 2^( 6) =       0.000419029736
  error estimate for blocks of size 2^( 7) =       0.000421117875

      target function =      -0.885898647355
              le_mean =     -17.211936868600
             les_mean =     296.562800692660
             stat err =       0.000417687805
             autocorr =       1.177746578683
   target nu stat err =       0.000417687805
   target dn stat err =       0.004235890964
      target stat err =       0.005186351997
              std dev =       0.544303174585
             le_variance =       0.296265945863


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721193686860e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.885928209628       residual = 4.62e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.887321288003       residual = 5.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.887539784662       residual = 1.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.887596082085       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.887601865339       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.887604095265       residual = 6.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.887604537227       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.887604648988       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.887604590781       residual = 4.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.887604566499       residual = 7.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.887604559848       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.887604559265       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 6.206565e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.885928209628       residual = 4.62e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.886295757381       residual = 5.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.886352584263       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.886366972319       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.886368428220       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.886368987521       residual = 5.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.886369096192       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.886369124185       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.886369109374       residual = 4.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.886369103321       residual = 6.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.886369101725       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.886369101573       residual = 2.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 1.641360e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.885928209628       residual = 4.62e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.886021383779       residual = 5.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.886035733759       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.886039350026       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.886039714475       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.886039854354       residual = 5.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.886039881397       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.886039888392       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.886039884675       residual = 4.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.886039883164       residual = 6.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.886039882770       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.886039882731       residual = 2.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 4.163493e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.054705 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6457e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_001                -5.244350e-02 3 1  ON 0
ci_002                -4.074790e-02 3 1  ON 1
ci_003                -3.116557e-02 3 1  ON 2
ci_004                 2.972428e-02 3 1  ON 3
ci_005                 2.985039e-02 3 1  ON 4
ci_006                -2.739075e-02 3 1  ON 5
ci_007                -2.722317e-02 3 1  ON 6
ci_008                -1.676713e-02 3 1  ON 7
ci_009                -2.037435e-02 3 1  ON 8
ci_010                -1.745466e-02 3 1  ON 9
ci_011                -1.745588e-02 3 1  ON 10
ci_012                -1.751155e-02 3 1  ON 11
ci_013                -2.298396e-02 3 1  ON 12
ci_014                 1.812728e-02 3 1  ON 13
ci_015                 1.812456e-02 3 1  ON 14
ci_016                 2.013960e-02 3 1  ON 15
ci_017                 2.026639e-02 3 1  ON 16
ci_018                 1.602580e-02 3 1  ON 17
ci_019                 1.591119e-02 3 1  ON 18
ci_020                 2.100143e-02 3 1  ON 19
ci_021                 2.081619e-02 3 1  ON 20
ci_022                 1.459273e-02 3 1  ON 21
ci_023                 1.427663e-02 3 1  ON 22
ci_024                 1.518227e-02 3 1  ON 23
ci_025                 1.488969e-02 3 1  ON 24
ci_026                 1.536508e-02 3 1  ON 25
ci_027                 1.547300e-02 3 1  ON 26
ci_028                -1.773571e-02 3 1  ON 27
ci_029                -1.778501e-02 3 1  ON 28
ci_030                -1.332819e-02 3 1  ON 29
ci_031                -1.344846e-02 3 1  ON 30
ci_032                -1.597287e-02 3 1  ON 31
ci_033                 1.057607e-02 3 1  ON 32
ci_034                 1.077287e-02 3 1  ON 33
ci_035                -1.010957e-02 3 1  ON 34
ci_036                -1.519029e-02 3 1  ON 35
ci_037                -1.537259e-02 3 1  ON 36
ci_038                 7.672732e-03 3 1  ON 37
ci_039                 7.959837e-03 3 1  ON 38
ci_040                -8.035176e-03 3 1  ON 39
ci_041                 1.137185e-02 3 1  ON 40
ci_042                 1.170888e-02 3 1  ON 41
ci_043                -8.667022e-03 3 1  ON 42
ci_044                -8.948576e-03 3 1  ON 43
ci_045                -7.826122e-03 3 1  ON 44
ci_046                 9.356113e-03 3 1  ON 45
ci_047                 9.598335e-03 3 1  ON 46
ci_048                -1.391683e-02 3 1  ON 47
ci_049                -1.336272e-02 3 1  ON 48
ci_050                 7.045905e-03 3 1  ON 49
ci_051                 6.745825e-03 3 1  ON 50
ci_052                -5.913477e-03 3 1  ON 51
ci_053                -5.950218e-03 3 1  ON 52
ci_054                -6.780989e-03 3 1  ON 53
ci_055                -6.844662e-03 3 1  ON 54
ci_056                 8.375772e-03 3 1  ON 55
ci_057                 8.213625e-03 3 1  ON 56
ci_058                -5.844954e-03 3 1  ON 57
ci_059                -5.942911e-03 3 1  ON 58
ci_060                 7.812255e-03 3 1  ON 59
ci_061                 7.807107e-03 3 1  ON 60
ci_062                -7.001694e-03 3 1  ON 61
ci_063                -6.987328e-03 3 1  ON 62
ci_064                -5.913448e-03 3 1  ON 63
ci_065                -6.415559e-03 3 1  ON 64
ci_066                 6.656653e-03 3 1  ON 65
ci_067                 6.872632e-03 3 1  ON 66
ci_068                -6.982970e-03 3 1  ON 67
ci_069                -6.753024e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1935
    reference variance = 0.299294
====================================================
  Execution time = 1.3758e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.0499e-01
  Total weights = 1.9559e+06
  Execution time = 1.8471e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291986013824
                                         uncertainty =       0.001729547854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291986013824
                                         uncertainty =       0.001729547854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382058618
  error estimate for blocks of size 2^( 2) =       0.000393828421
  error estimate for blocks of size 2^( 3) =       0.000403929630
  error estimate for blocks of size 2^( 4) =       0.000410846005
  error estimate for blocks of size 2^( 5) =       0.000415594271
  error estimate for blocks of size 2^( 6) =       0.000415843161
  error estimate for blocks of size 2^( 7) =       0.000415591867

      target function =      -0.867770903461
              le_mean =     -17.213201059085
             les_mean =     296.621136080694
             stat err =       0.000414468826
             autocorr =       1.176857121961
   target nu stat err =       0.000414468826
   target dn stat err =       0.020922689752
      target stat err =       0.024501872643
              std dev =       0.540312479638
             le_variance =       0.291937575653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289475674126
                                         uncertainty =       0.001705047911

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289475674126
                                         uncertainty =       0.001705047911

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380414058
  error estimate for blocks of size 2^( 2) =       0.000392251386
  error estimate for blocks of size 2^( 3) =       0.000402430243
  error estimate for blocks of size 2^( 4) =       0.000409396816
  error estimate for blocks of size 2^( 5) =       0.000414218682
  error estimate for blocks of size 2^( 6) =       0.000414501083
  error estimate for blocks of size 2^( 7) =       0.000414251898

      target function =      -0.750917481382
              le_mean =     -17.213222398349
             les_mean =     296.721359871115
             stat err =       0.000413092120
             autocorr =       1.179181634648
   target nu stat err =       0.000413092120
   target dn stat err =       0.117951092242
      target stat err =       0.105360230467
              std dev =       0.537986719528
             le_variance =       0.289429710389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290624415416
                                         uncertainty =       0.001715708198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290624415416
                                         uncertainty =       0.001715708198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381167505
  error estimate for blocks of size 2^( 2) =       0.000392974329
  error estimate for blocks of size 2^( 3) =       0.000403117013
  error estimate for blocks of size 2^( 4) =       0.000410056474
  error estimate for blocks of size 2^( 5) =       0.000414841046
  error estimate for blocks of size 2^( 6) =       0.000415105150
  error estimate for blocks of size 2^( 7) =       0.000414847124

      target function =      -0.895692036795
              le_mean =     -17.213209557381
             les_mean =     296.598888947499
             stat err =       0.000413712449
             autocorr =       1.178054653584
   target nu stat err =       0.000413712449
   target dn stat err =       0.002363387076
      target stat err =       0.003001338673
              std dev =       0.539052255258
             le_variance =       0.290577333899

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291808651737
                                         uncertainty =       0.001727680446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291808651737
                                         uncertainty =       0.001727680446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381942661
  error estimate for blocks of size 2^( 2) =       0.000393716721
  error estimate for blocks of size 2^( 3) =       0.000403822708
  error estimate for blocks of size 2^( 4) =       0.000410741218
  error estimate for blocks of size 2^( 5) =       0.000415494309
  error estimate for blocks of size 2^( 6) =       0.000415745517
  error estimate for blocks of size 2^( 7) =       0.000415493222

      target function =      -0.892842229215
              le_mean =     -17.213201185262
             les_mean =     296.600891836712
             stat err =       0.000414368566
             autocorr =       1.177002179808
   target nu stat err =       0.000414368566
   target dn stat err =       0.002560207891
      target stat err =       0.003222284111
              std dev =       0.540148490986
             le_variance =       0.291760392314


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.867770903461        initial
     1.0000e+00     1.0000e+01             6.2066e-04        -0.750917481382
     4.0000e+00     4.0000e+01             1.6414e-04        -0.895692036795  <--
     1.6000e+01     1.6000e+02             4.1635e-05        -0.892842229215

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 2.3070e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_001                -5.244350e-02 3 1  ON 0
ci_002                -4.074790e-02 3 1  ON 1
ci_003                -3.116557e-02 3 1  ON 2
ci_004                 2.972428e-02 3 1  ON 3
ci_005                 2.985039e-02 3 1  ON 4
ci_006                -2.739075e-02 3 1  ON 5
ci_007                -2.722317e-02 3 1  ON 6
ci_008                -1.676713e-02 3 1  ON 7
ci_009                -2.037435e-02 3 1  ON 8
ci_010                -1.745466e-02 3 1  ON 9
ci_011                -1.745588e-02 3 1  ON 10
ci_012                -1.751155e-02 3 1  ON 11
ci_013                -2.298396e-02 3 1  ON 12
ci_014                 1.812728e-02 3 1  ON 13
ci_015                 1.812456e-02 3 1  ON 14
ci_016                 2.013960e-02 3 1  ON 15
ci_017                 2.026639e-02 3 1  ON 16
ci_018                 1.602580e-02 3 1  ON 17
ci_019                 1.591119e-02 3 1  ON 18
ci_020                 2.100143e-02 3 1  ON 19
ci_021                 2.081619e-02 3 1  ON 20
ci_022                 1.459273e-02 3 1  ON 21
ci_023                 1.427663e-02 3 1  ON 22
ci_024                 1.518227e-02 3 1  ON 23
ci_025                 1.488969e-02 3 1  ON 24
ci_026                 1.536508e-02 3 1  ON 25
ci_027                 1.547300e-02 3 1  ON 26
ci_028                -1.773571e-02 3 1  ON 27
ci_029                -1.778501e-02 3 1  ON 28
ci_030                -1.332819e-02 3 1  ON 29
ci_031                -1.344846e-02 3 1  ON 30
ci_032                -1.597287e-02 3 1  ON 31
ci_033                 1.057607e-02 3 1  ON 32
ci_034                 1.077287e-02 3 1  ON 33
ci_035                -1.010957e-02 3 1  ON 34
ci_036                -1.519029e-02 3 1  ON 35
ci_037                -1.537259e-02 3 1  ON 36
ci_038                 7.672732e-03 3 1  ON 37
ci_039                 7.959837e-03 3 1  ON 38
ci_040                -8.035176e-03 3 1  ON 39
ci_041                 1.137185e-02 3 1  ON 40
ci_042                 1.170888e-02 3 1  ON 41
ci_043                -8.667022e-03 3 1  ON 42
ci_044                -8.948576e-03 3 1  ON 43
ci_045                -7.826122e-03 3 1  ON 44
ci_046                 9.356113e-03 3 1  ON 45
ci_047                 9.598335e-03 3 1  ON 46
ci_048                -1.391683e-02 3 1  ON 47
ci_049                -1.336272e-02 3 1  ON 48
ci_050                 7.045905e-03 3 1  ON 49
ci_051                 6.745825e-03 3 1  ON 50
ci_052                -5.913477e-03 3 1  ON 51
ci_053                -5.950218e-03 3 1  ON 52
ci_054                -6.780989e-03 3 1  ON 53
ci_055                -6.844662e-03 3 1  ON 54
ci_056                 8.375772e-03 3 1  ON 55
ci_057                 8.213625e-03 3 1  ON 56
ci_058                -5.844954e-03 3 1  ON 57
ci_059                -5.942911e-03 3 1  ON 58
ci_060                 7.812255e-03 3 1  ON 59
ci_061                 7.807107e-03 3 1  ON 60
ci_062                -7.001694e-03 3 1  ON 61
ci_063                -6.987328e-03 3 1  ON 62
ci_064                -5.913448e-03 3 1  ON 63
ci_065                -6.415559e-03 3 1  ON 64
ci_066                 6.656653e-03 3 1  ON 65
ci_067                 6.872632e-03 3 1  ON 66
ci_068                -6.982970e-03 3 1  ON 67
ci_069                -6.753024e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9535e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7233e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2799
    reference variance = 0.255266
====================================================
  Execution time = 1.3903e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.0443e-01
  Total weights = 1.956094265e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4983e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292213858778
                                         uncertainty =       0.001650994443

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292213858778
                                         uncertainty =       0.001650994443

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382201690
  error estimate for blocks of size 2^( 2) =       0.000394028825
  error estimate for blocks of size 2^( 3) =       0.000404241817
  error estimate for blocks of size 2^( 4) =       0.000411649434
  error estimate for blocks of size 2^( 5) =       0.000415053020
  error estimate for blocks of size 2^( 6) =       0.000416224045
  error estimate for blocks of size 2^( 7) =       0.000417385434

      target function =      -0.895507212049
              le_mean =     -17.213053810137
             les_mean =     296.593649587981
             stat err =       0.000415077983
             autocorr =       1.179435483207
   target nu stat err =       0.000415077983
   target dn stat err =       0.002244374313
      target stat err =       0.002854438296
              std dev =       0.540514813939
             le_variance =       0.292156264088


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721305381014e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.895515544304       residual = 3.95e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.896842201653       residual = 5.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.897066390134       residual = 1.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.897135325157       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.897141378335       residual = 3.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.897143002350       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.897143381239       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.897143456036       residual = 2.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.897143479479       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.897143488381       residual = 8.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.897143486097       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.897143480284       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 6.202973e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.895515544304       residual = 3.95e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.895865540385       residual = 5.86e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.895923924491       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.895941560278       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.895943081109       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.895943483700       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.895943577927       residual = 9.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.895943595028       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.895943600770       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.895943602832       residual = 6.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.895943602141       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.895943600763       residual = 2.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 1.619199e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.895515544304       residual = 3.95e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.895604267321       residual = 5.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.895619015781       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.895623449521       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.895623830017       residual = 3.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.895623930378       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.895623953891       residual = 9.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.895623958065       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.895623959495       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.895623960001       residual = 6.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.895623959816       residual = 1.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.895623959478       residual = 2.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 4.093073e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.059483 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6411e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_001                -5.228158e-02 3 1  ON 0
ci_002                -4.061208e-02 3 1  ON 1
ci_003                -3.108693e-02 3 1  ON 2
ci_004                 2.964136e-02 3 1  ON 3
ci_005                 2.978341e-02 3 1  ON 4
ci_006                -2.729013e-02 3 1  ON 5
ci_007                -2.712772e-02 3 1  ON 6
ci_008                -1.661453e-02 3 1  ON 7
ci_009                -2.027040e-02 3 1  ON 8
ci_010                -1.731389e-02 3 1  ON 9
ci_011                -1.733280e-02 3 1  ON 10
ci_012                -1.738666e-02 3 1  ON 11
ci_013                -2.293380e-02 3 1  ON 12
ci_014                 1.803788e-02 3 1  ON 13
ci_015                 1.802627e-02 3 1  ON 14
ci_016                 2.007244e-02 3 1  ON 15
ci_017                 2.020033e-02 3 1  ON 16
ci_018                 1.591413e-02 3 1  ON 17
ci_019                 1.582769e-02 3 1  ON 18
ci_020                 2.096421e-02 3 1  ON 19
ci_021                 2.078379e-02 3 1  ON 20
ci_022                 1.452171e-02 3 1  ON 21
ci_023                 1.420214e-02 3 1  ON 22
ci_024                 1.511964e-02 3 1  ON 23
ci_025                 1.476998e-02 3 1  ON 24
ci_026                 1.530084e-02 3 1  ON 25
ci_027                 1.540538e-02 3 1  ON 26
ci_028                -1.770426e-02 3 1  ON 27
ci_029                -1.774313e-02 3 1  ON 28
ci_030                -1.325404e-02 3 1  ON 29
ci_031                -1.336915e-02 3 1  ON 30
ci_032                -1.593807e-02 3 1  ON 31
ci_033                 1.049811e-02 3 1  ON 32
ci_034                 1.067592e-02 3 1  ON 33
ci_035                -1.001349e-02 3 1  ON 34
ci_036                -1.513950e-02 3 1  ON 35
ci_037                -1.533078e-02 3 1  ON 36
ci_038                 7.563403e-03 3 1  ON 37
ci_039                 7.854399e-03 3 1  ON 38
ci_040                -7.946840e-03 3 1  ON 39
ci_041                 1.133513e-02 3 1  ON 40
ci_042                 1.166019e-02 3 1  ON 41
ci_043                -8.591221e-03 3 1  ON 42
ci_044                -8.875604e-03 3 1  ON 43
ci_045                -7.742064e-03 3 1  ON 44
ci_046                 9.275923e-03 3 1  ON 45
ci_047                 9.526088e-03 3 1  ON 46
ci_048                -1.388796e-02 3 1  ON 47
ci_049                -1.333947e-02 3 1  ON 48
ci_050                 6.980021e-03 3 1  ON 49
ci_051                 6.679905e-03 3 1  ON 50
ci_052                -5.842153e-03 3 1  ON 51
ci_053                -5.884625e-03 3 1  ON 52
ci_054                -6.708002e-03 3 1  ON 53
ci_055                -6.773582e-03 3 1  ON 54
ci_056                 8.332881e-03 3 1  ON 55
ci_057                 8.184086e-03 3 1  ON 56
ci_058                -5.784725e-03 3 1  ON 57
ci_059                -5.859810e-03 3 1  ON 58
ci_060                 7.768924e-03 3 1  ON 59
ci_061                 7.759067e-03 3 1  ON 60
ci_062                -6.964507e-03 3 1  ON 61
ci_063                -6.946245e-03 3 1  ON 62
ci_064                -5.860217e-03 3 1  ON 63
ci_065                -6.380121e-03 3 1  ON 64
ci_066                 6.623368e-03 3 1  ON 65
ci_067                 6.823186e-03 3 1  ON 66
ci_068                -6.938721e-03 3 1  ON 67
ci_069                -6.707679e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2134
    reference variance = 0.236561
====================================================
  Execution time = 1.3571e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.1083e-01
  Total weights = 1.9556e+06
  Execution time = 1.8435e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295639996078
                                         uncertainty =       0.001944545469

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295639996078
                                         uncertainty =       0.001944545469

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384568365
  error estimate for blocks of size 2^( 2) =       0.000396033679
  error estimate for blocks of size 2^( 3) =       0.000406066723
  error estimate for blocks of size 2^( 4) =       0.000413319247
  error estimate for blocks of size 2^( 5) =       0.000418473545
  error estimate for blocks of size 2^( 6) =       0.000420550625
  error estimate for blocks of size 2^( 7) =       0.000422645632

      target function =      -0.885915902316
              le_mean =     -17.212898544354
             les_mean =     296.596058213056
             stat err =       0.000418747262
             autocorr =       1.185650936157
   target nu stat err =       0.000418747262
   target dn stat err =       0.003017602285
      target stat err =       0.003722431346
              std dev =       0.543861797985
             le_variance =       0.295785655307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293185207576
                                         uncertainty =       0.001926550724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293185207576
                                         uncertainty =       0.001926550724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382964252
  error estimate for blocks of size 2^( 2) =       0.000394495998
  error estimate for blocks of size 2^( 3) =       0.000404612408
  error estimate for blocks of size 2^( 4) =       0.000411920173
  error estimate for blocks of size 2^( 5) =       0.000417098598
  error estimate for blocks of size 2^( 6) =       0.000419201683
  error estimate for blocks of size 2^( 7) =       0.000421322121

      target function =      -0.887997768591
              le_mean =     -17.212926722691
             les_mean =     296.595327745118
             stat err =       0.000417385644
             autocorr =       1.187841628728
   target nu stat err =       0.000417385644
   target dn stat err =       0.003111727400
      target stat err =       0.003853539831
              std dev =       0.541593239020
             le_variance =       0.293323236553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294313304820
                                         uncertainty =       0.001934358741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294313304820
                                         uncertainty =       0.001934358741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383702288
  error estimate for blocks of size 2^( 2) =       0.000395201624
  error estimate for blocks of size 2^( 3) =       0.000405278136
  error estimate for blocks of size 2^( 4) =       0.000412559458
  error estimate for blocks of size 2^( 5) =       0.000417726794
  error estimate for blocks of size 2^( 6) =       0.000419818223
  error estimate for blocks of size 2^( 7) =       0.000421925921

      target function =      -0.888544176037
              le_mean =     -17.212909046121
             les_mean =     296.594271769448
             stat err =       0.000418007599
             autocorr =       1.186805567581
   target nu stat err =       0.000418007599
   target dn stat err =       0.002944435055
      target stat err =       0.003655582736
              std dev =       0.542636979938
             le_variance =       0.294454891996

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295467758394
                                         uncertainty =       0.001943171858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295467758394
                                         uncertainty =       0.001943171858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384456041
  error estimate for blocks of size 2^( 2) =       0.000395925528
  error estimate for blocks of size 2^( 3) =       0.000405963978
  error estimate for blocks of size 2^( 4) =       0.000413220080
  error estimate for blocks of size 2^( 5) =       0.000418376110
  error estimate for blocks of size 2^( 6) =       0.000420454878
  error estimate for blocks of size 2^( 7) =       0.000422551681

      target function =      -0.886533126988
              le_mean =     -17.212899314186
             les_mean =     296.595578953942
             stat err =       0.000418650687
             autocorr =       1.185796700597
   target nu stat err =       0.000418650687
   target dn stat err =       0.002989149961
      target stat err =       0.003693238571
              std dev =       0.543702947517
             le_variance =       0.295612895139


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.885915902316        initial
     1.0000e+00     1.0000e+01             6.2030e-04        -0.887997768591
     4.0000e+00     4.0000e+01             1.6192e-04        -0.888544176037  <--
     1.6000e+01     1.6000e+02             4.0931e-05        -0.886533126988

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 2.2853e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_001                -5.228158e-02 3 1  ON 0
ci_002                -4.061208e-02 3 1  ON 1
ci_003                -3.108693e-02 3 1  ON 2
ci_004                 2.964136e-02 3 1  ON 3
ci_005                 2.978341e-02 3 1  ON 4
ci_006                -2.729013e-02 3 1  ON 5
ci_007                -2.712772e-02 3 1  ON 6
ci_008                -1.661453e-02 3 1  ON 7
ci_009                -2.027040e-02 3 1  ON 8
ci_010                -1.731389e-02 3 1  ON 9
ci_011                -1.733280e-02 3 1  ON 10
ci_012                -1.738666e-02 3 1  ON 11
ci_013                -2.293380e-02 3 1  ON 12
ci_014                 1.803788e-02 3 1  ON 13
ci_015                 1.802627e-02 3 1  ON 14
ci_016                 2.007244e-02 3 1  ON 15
ci_017                 2.020033e-02 3 1  ON 16
ci_018                 1.591413e-02 3 1  ON 17
ci_019                 1.582769e-02 3 1  ON 18
ci_020                 2.096421e-02 3 1  ON 19
ci_021                 2.078379e-02 3 1  ON 20
ci_022                 1.452171e-02 3 1  ON 21
ci_023                 1.420214e-02 3 1  ON 22
ci_024                 1.511964e-02 3 1  ON 23
ci_025                 1.476998e-02 3 1  ON 24
ci_026                 1.530084e-02 3 1  ON 25
ci_027                 1.540538e-02 3 1  ON 26
ci_028                -1.770426e-02 3 1  ON 27
ci_029                -1.774313e-02 3 1  ON 28
ci_030                -1.325404e-02 3 1  ON 29
ci_031                -1.336915e-02 3 1  ON 30
ci_032                -1.593807e-02 3 1  ON 31
ci_033                 1.049811e-02 3 1  ON 32
ci_034                 1.067592e-02 3 1  ON 33
ci_035                -1.001349e-02 3 1  ON 34
ci_036                -1.513950e-02 3 1  ON 35
ci_037                -1.533078e-02 3 1  ON 36
ci_038                 7.563403e-03 3 1  ON 37
ci_039                 7.854399e-03 3 1  ON 38
ci_040                -7.946840e-03 3 1  ON 39
ci_041                 1.133513e-02 3 1  ON 40
ci_042                 1.166019e-02 3 1  ON 41
ci_043                -8.591221e-03 3 1  ON 42
ci_044                -8.875604e-03 3 1  ON 43
ci_045                -7.742064e-03 3 1  ON 44
ci_046                 9.275923e-03 3 1  ON 45
ci_047                 9.526088e-03 3 1  ON 46
ci_048                -1.388796e-02 3 1  ON 47
ci_049                -1.333947e-02 3 1  ON 48
ci_050                 6.980021e-03 3 1  ON 49
ci_051                 6.679905e-03 3 1  ON 50
ci_052                -5.842153e-03 3 1  ON 51
ci_053                -5.884625e-03 3 1  ON 52
ci_054                -6.708002e-03 3 1  ON 53
ci_055                -6.773582e-03 3 1  ON 54
ci_056                 8.332881e-03 3 1  ON 55
ci_057                 8.184086e-03 3 1  ON 56
ci_058                -5.784725e-03 3 1  ON 57
ci_059                -5.859810e-03 3 1  ON 58
ci_060                 7.768924e-03 3 1  ON 59
ci_061                 7.759067e-03 3 1  ON 60
ci_062                -6.964507e-03 3 1  ON 61
ci_063                -6.946245e-03 3 1  ON 62
ci_064                -5.860217e-03 3 1  ON 63
ci_065                -6.380121e-03 3 1  ON 64
ci_066                 6.623368e-03 3 1  ON 65
ci_067                 6.823186e-03 3 1  ON 66
ci_068                -6.938721e-03 3 1  ON 67
ci_069                -6.707679e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9269e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7235e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2279
    reference variance = 0.22692
====================================================
  Execution time = 1.3913e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.1404e-01
  Total weights = 1.955439919e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4966e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296310806449
                                         uncertainty =       0.003220045512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.296310806449
                                         uncertainty =       0.003220045512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384902727
  error estimate for blocks of size 2^( 2) =       0.000396554220
  error estimate for blocks of size 2^( 3) =       0.000406769138
  error estimate for blocks of size 2^( 4) =       0.000414550932
  error estimate for blocks of size 2^( 5) =       0.000418806580
  error estimate for blocks of size 2^( 6) =       0.000420304594
  error estimate for blocks of size 2^( 7) =       0.000422187650

      target function =      -0.883625598592
              le_mean =     -17.212837411989
             les_mean =     296.595810761065
             stat err =       0.000418962439
             autocorr =       1.184808610889
   target nu stat err =       0.000418962439
   target dn stat err =       0.004693708055
      target stat err =       0.005719297048
              std dev =       0.544334657019
             le_variance =       0.296300218832


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721283741199e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883661644792       residual = 4.89e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.885101816654       residual = 6.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.885340058121       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.885410968061       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.885418539477       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.885420279048       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.885420793799       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.885420899005       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.885420930973       residual = 2.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.885420922152       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.885420921155       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.885420920200       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 6.101487e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883661644792       residual = 4.89e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.884041577499       residual = 6.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.884103573619       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.884121727475       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.884123640979       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.884124071247       residual = 4.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.884124199891       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.884124227221       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.884124235182       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.884124232969       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.884124232691       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.884124232477       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 1.591264e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.883661644792       residual = 4.89e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.883757955757       residual = 6.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.883773613377       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.883778178255       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.883778657770       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.883778764971       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.883778797113       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.883778804028       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.883778806010       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.883778805456       residual = 5.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.883778805385       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.883778805333       residual = 2.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 4.021491e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.064265 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6420e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_001                -5.212245e-02 3 1  ON 0
ci_002                -4.048734e-02 3 1  ON 1
ci_003                -3.100669e-02 3 1  ON 2
ci_004                 2.957727e-02 3 1  ON 3
ci_005                 2.971167e-02 3 1  ON 4
ci_006                -2.720542e-02 3 1  ON 5
ci_007                -2.704267e-02 3 1  ON 6
ci_008                -1.646206e-02 3 1  ON 7
ci_009                -2.016653e-02 3 1  ON 8
ci_010                -1.718415e-02 3 1  ON 9
ci_011                -1.722565e-02 3 1  ON 10
ci_012                -1.724466e-02 3 1  ON 11
ci_013                -2.288943e-02 3 1  ON 12
ci_014                 1.795331e-02 3 1  ON 13
ci_015                 1.792689e-02 3 1  ON 14
ci_016                 1.999132e-02 3 1  ON 15
ci_017                 2.015304e-02 3 1  ON 16
ci_018                 1.582114e-02 3 1  ON 17
ci_019                 1.573971e-02 3 1  ON 18
ci_020                 2.093178e-02 3 1  ON 19
ci_021                 2.073436e-02 3 1  ON 20
ci_022                 1.442402e-02 3 1  ON 21
ci_023                 1.411034e-02 3 1  ON 22
ci_024                 1.503948e-02 3 1  ON 23
ci_025                 1.469528e-02 3 1  ON 24
ci_026                 1.523778e-02 3 1  ON 25
ci_027                 1.533620e-02 3 1  ON 26
ci_028                -1.766213e-02 3 1  ON 27
ci_029                -1.772483e-02 3 1  ON 28
ci_030                -1.319646e-02 3 1  ON 29
ci_031                -1.329545e-02 3 1  ON 30
ci_032                -1.591493e-02 3 1  ON 31
ci_033                 1.042232e-02 3 1  ON 32
ci_034                 1.061251e-02 3 1  ON 33
ci_035                -9.923185e-03 3 1  ON 34
ci_036                -1.513627e-02 3 1  ON 35
ci_037                -1.529493e-02 3 1  ON 36
ci_038                 7.452517e-03 3 1  ON 37
ci_039                 7.749939e-03 3 1  ON 38
ci_040                -7.860071e-03 3 1  ON 39
ci_041                 1.129714e-02 3 1  ON 40
ci_042                 1.162042e-02 3 1  ON 41
ci_043                -8.514464e-03 3 1  ON 42
ci_044                -8.787491e-03 3 1  ON 43
ci_045                -7.643803e-03 3 1  ON 44
ci_046                 9.214045e-03 3 1  ON 45
ci_047                 9.461752e-03 3 1  ON 46
ci_048                -1.386092e-02 3 1  ON 47
ci_049                -1.335481e-02 3 1  ON 48
ci_050                 6.919214e-03 3 1  ON 49
ci_051                 6.589093e-03 3 1  ON 50
ci_052                -5.758867e-03 3 1  ON 51
ci_053                -5.826027e-03 3 1  ON 52
ci_054                -6.641036e-03 3 1  ON 53
ci_055                -6.702314e-03 3 1  ON 54
ci_056                 8.281376e-03 3 1  ON 55
ci_057                 8.122232e-03 3 1  ON 56
ci_058                -5.671463e-03 3 1  ON 57
ci_059                -5.782865e-03 3 1  ON 58
ci_060                 7.722476e-03 3 1  ON 59
ci_061                 7.717209e-03 3 1  ON 60
ci_062                -6.915460e-03 3 1  ON 61
ci_063                -6.892859e-03 3 1  ON 62
ci_064                -5.809650e-03 3 1  ON 63
ci_065                -6.333551e-03 3 1  ON 64
ci_066                 6.581503e-03 3 1  ON 65
ci_067                 6.781510e-03 3 1  ON 66
ci_068                -6.861652e-03 3 1  ON 67
ci_069                -6.673704e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2206
    reference variance = 0.247445
====================================================
  Execution time = 1.3587e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.0077e-01
  Total weights = 1.9559e+06
  Execution time = 1.8477e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289210816571
                                         uncertainty =       0.001729240525

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289210816571
                                         uncertainty =       0.001729240525

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380264469
  error estimate for blocks of size 2^( 2) =       0.000392038039
  error estimate for blocks of size 2^( 3) =       0.000403627386
  error estimate for blocks of size 2^( 4) =       0.000411074934
  error estimate for blocks of size 2^( 5) =       0.000415677039
  error estimate for blocks of size 2^( 6) =       0.000418738672
  error estimate for blocks of size 2^( 7) =       0.000420862644

      target function =      -0.898925481916
              le_mean =     -17.212235114692
             les_mean =     296.562587745119
             stat err =       0.000416588322
             autocorr =       1.200169779754
   target nu stat err =       0.000416588322
   target dn stat err =       0.002210246926
      target stat err =       0.002830716704
              std dev =       0.537775169498
             le_variance =       0.289202132929

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286753456224
                                         uncertainty =       0.001707041381

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286753456224
                                         uncertainty =       0.001707041381

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378644441
  error estimate for blocks of size 2^( 2) =       0.000390511795
  error estimate for blocks of size 2^( 3) =       0.000402183297
  error estimate for blocks of size 2^( 4) =       0.000409684103
  error estimate for blocks of size 2^( 5) =       0.000414308795
  error estimate for blocks of size 2^( 6) =       0.000417418551
  error estimate for blocks of size 2^( 7) =       0.000419573819

      target function =      -0.897191566222
              le_mean =     -17.212263080515
             les_mean =     296.564934223430
             stat err =       0.000415246317
             autocorr =       1.202675341516
   target nu stat err =       0.000415246317
   target dn stat err =       0.003160361733
      target stat err =       0.003988447930
              std dev =       0.535484104414
             le_variance =       0.286743226080

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287883565413
                                         uncertainty =       0.001717214112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287883565413
                                         uncertainty =       0.001717214112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379390338
  error estimate for blocks of size 2^( 2) =       0.000391212406
  error estimate for blocks of size 2^( 3) =       0.000402844245
  error estimate for blocks of size 2^( 4) =       0.000410319377
  error estimate for blocks of size 2^( 5) =       0.000414932622
  error estimate for blocks of size 2^( 6) =       0.000418018249
  error estimate for blocks of size 2^( 7) =       0.000420159144

      target function =      -0.900558164226
              le_mean =     -17.212245699231
             les_mean =     296.561653882025
             stat err =       0.000415857348
             autocorr =       1.201479119468
   target nu stat err =       0.000415857348
   target dn stat err =       0.002198836499
      target stat err =       0.002826579501
              std dev =       0.536538960989
             le_variance =       0.287874056659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289038709440
                                         uncertainty =       0.001727671167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289038709440
                                         uncertainty =       0.001727671167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380151233
  error estimate for blocks of size 2^( 2) =       0.000391930893
  error estimate for blocks of size 2^( 3) =       0.000403525643
  error estimate for blocks of size 2^( 4) =       0.000410976540
  error estimate for blocks of size 2^( 5) =       0.000415579945
  error estimate for blocks of size 2^( 6) =       0.000418644675
  error estimate for blocks of size 2^( 7) =       0.000420770492

      target function =      -0.898835488779
              le_mean =     -17.212235906859
             les_mean =     296.562686854784
             stat err =       0.000416492913
             autocorr =       1.200334874699
   target nu stat err =       0.000416492913
   target dn stat err =       0.002226811577
      target stat err =       0.002850459091
              std dev =       0.537615029871
             le_variance =       0.289029920343


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.898925481916        initial
     1.0000e+00     1.0000e+01             6.1015e-04        -0.897191566222
     4.0000e+00     4.0000e+01             1.5913e-04        -0.900558164226  <--
     1.6000e+01     1.6000e+02             4.0215e-05        -0.898835488779

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 2.2900e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_001                -5.212245e-02 3 1  ON 0
ci_002                -4.048734e-02 3 1  ON 1
ci_003                -3.100669e-02 3 1  ON 2
ci_004                 2.957727e-02 3 1  ON 3
ci_005                 2.971167e-02 3 1  ON 4
ci_006                -2.720542e-02 3 1  ON 5
ci_007                -2.704267e-02 3 1  ON 6
ci_008                -1.646206e-02 3 1  ON 7
ci_009                -2.016653e-02 3 1  ON 8
ci_010                -1.718415e-02 3 1  ON 9
ci_011                -1.722565e-02 3 1  ON 10
ci_012                -1.724466e-02 3 1  ON 11
ci_013                -2.288943e-02 3 1  ON 12
ci_014                 1.795331e-02 3 1  ON 13
ci_015                 1.792689e-02 3 1  ON 14
ci_016                 1.999132e-02 3 1  ON 15
ci_017                 2.015304e-02 3 1  ON 16
ci_018                 1.582114e-02 3 1  ON 17
ci_019                 1.573971e-02 3 1  ON 18
ci_020                 2.093178e-02 3 1  ON 19
ci_021                 2.073436e-02 3 1  ON 20
ci_022                 1.442402e-02 3 1  ON 21
ci_023                 1.411034e-02 3 1  ON 22
ci_024                 1.503948e-02 3 1  ON 23
ci_025                 1.469528e-02 3 1  ON 24
ci_026                 1.523778e-02 3 1  ON 25
ci_027                 1.533620e-02 3 1  ON 26
ci_028                -1.766213e-02 3 1  ON 27
ci_029                -1.772483e-02 3 1  ON 28
ci_030                -1.319646e-02 3 1  ON 29
ci_031                -1.329545e-02 3 1  ON 30
ci_032                -1.591493e-02 3 1  ON 31
ci_033                 1.042232e-02 3 1  ON 32
ci_034                 1.061251e-02 3 1  ON 33
ci_035                -9.923185e-03 3 1  ON 34
ci_036                -1.513627e-02 3 1  ON 35
ci_037                -1.529493e-02 3 1  ON 36
ci_038                 7.452517e-03 3 1  ON 37
ci_039                 7.749939e-03 3 1  ON 38
ci_040                -7.860071e-03 3 1  ON 39
ci_041                 1.129714e-02 3 1  ON 40
ci_042                 1.162042e-02 3 1  ON 41
ci_043                -8.514464e-03 3 1  ON 42
ci_044                -8.787491e-03 3 1  ON 43
ci_045                -7.643803e-03 3 1  ON 44
ci_046                 9.214045e-03 3 1  ON 45
ci_047                 9.461752e-03 3 1  ON 46
ci_048                -1.386092e-02 3 1  ON 47
ci_049                -1.335481e-02 3 1  ON 48
ci_050                 6.919214e-03 3 1  ON 49
ci_051                 6.589093e-03 3 1  ON 50
ci_052                -5.758867e-03 3 1  ON 51
ci_053                -5.826027e-03 3 1  ON 52
ci_054                -6.641036e-03 3 1  ON 53
ci_055                -6.702314e-03 3 1  ON 54
ci_056                 8.281376e-03 3 1  ON 55
ci_057                 8.122232e-03 3 1  ON 56
ci_058                -5.671463e-03 3 1  ON 57
ci_059                -5.782865e-03 3 1  ON 58
ci_060                 7.722476e-03 3 1  ON 59
ci_061                 7.717209e-03 3 1  ON 60
ci_062                -6.915460e-03 3 1  ON 61
ci_063                -6.892859e-03 3 1  ON 62
ci_064                -5.809650e-03 3 1  ON 63
ci_065                -6.333551e-03 3 1  ON 64
ci_066                 6.581503e-03 3 1  ON 65
ci_067                 6.781510e-03 3 1  ON 66
ci_068                -6.861652e-03 3 1  ON 67
ci_069                -6.673704e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9326e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7234e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2599
    reference variance = 0.26593
====================================================
  Execution time = 1.3940e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.0871e-01
  Total weights = 1.955886640e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5369e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294266403034
                                         uncertainty =       0.003373149362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294266403034
                                         uncertainty =       0.003373149362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383570536
  error estimate for blocks of size 2^( 2) =       0.000395284260
  error estimate for blocks of size 2^( 3) =       0.000405535209
  error estimate for blocks of size 2^( 4) =       0.000412916484
  error estimate for blocks of size 2^( 5) =       0.000418851715
  error estimate for blocks of size 2^( 6) =       0.000422036726
  error estimate for blocks of size 2^( 7) =       0.000424912004

      target function =      -0.890122298866
              le_mean =     -17.212740558272
             les_mean =     296.587143893104
             stat err =       0.000419679232
             autocorr =       1.197138723345
   target nu stat err =       0.000419679232
   target dn stat err =       0.004380672777
      target stat err =       0.005419502017
              std dev =       0.542450654152
             le_variance =       0.294252712189


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721274055827e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.890154837403       residual = 3.76e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.891431680342       residual = 4.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.891618538014       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.891660401837       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.891665966262       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.891667236425       residual = 6.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.891667464797       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.891667497858       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.891667475178       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.891667481182       residual = 5.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.891667479989       residual = 1.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.891667479353       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 6.050950e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.890154837403       residual = 3.76e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.890491513448       residual = 4.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.890540121498       residual = 9.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.890550790774       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.890552194777       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.890552512981       residual = 6.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.890552569246       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.890552577033       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.890552571241       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.890552572745       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.890552572457       residual = 1.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.890552572299       residual = 2.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 1.578706e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.890154837403       residual = 3.76e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.890240171831       residual = 4.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.890252447141       residual = 9.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.890255126737       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.890255478421       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.890255557983       residual = 6.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.890255571986       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.890255573901       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.890255572445       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.890255572822       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.890255572750       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.890255572711       residual = 2.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 3.990183e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.068995 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6487e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_001                -5.196458e-02 3 1  ON 0
ci_002                -4.037599e-02 3 1  ON 1
ci_003                -3.096587e-02 3 1  ON 2
ci_004                 2.951034e-02 3 1  ON 3
ci_005                 2.964295e-02 3 1  ON 4
ci_006                -2.711328e-02 3 1  ON 5
ci_007                -2.695469e-02 3 1  ON 6
ci_008                -1.632785e-02 3 1  ON 7
ci_009                -2.007155e-02 3 1  ON 8
ci_010                -1.707862e-02 3 1  ON 9
ci_011                -1.710149e-02 3 1  ON 10
ci_012                -1.710221e-02 3 1  ON 11
ci_013                -2.286096e-02 3 1  ON 12
ci_014                 1.784953e-02 3 1  ON 13
ci_015                 1.783429e-02 3 1  ON 14
ci_016                 1.993249e-02 3 1  ON 15
ci_017                 2.012506e-02 3 1  ON 16
ci_018                 1.573332e-02 3 1  ON 17
ci_019                 1.566721e-02 3 1  ON 18
ci_020                 2.088680e-02 3 1  ON 19
ci_021                 2.068877e-02 3 1  ON 20
ci_022                 1.434124e-02 3 1  ON 21
ci_023                 1.404282e-02 3 1  ON 22
ci_024                 1.499202e-02 3 1  ON 23
ci_025                 1.464394e-02 3 1  ON 24
ci_026                 1.515620e-02 3 1  ON 25
ci_027                 1.523977e-02 3 1  ON 26
ci_028                -1.763167e-02 3 1  ON 27
ci_029                -1.770250e-02 3 1  ON 28
ci_030                -1.313298e-02 3 1  ON 29
ci_031                -1.322319e-02 3 1  ON 30
ci_032                -1.590236e-02 3 1  ON 31
ci_033                 1.031286e-02 3 1  ON 32
ci_034                 1.049299e-02 3 1  ON 33
ci_035                -9.835891e-03 3 1  ON 34
ci_036                -1.512497e-02 3 1  ON 35
ci_037                -1.525421e-02 3 1  ON 36
ci_038                 7.357348e-03 3 1  ON 37
ci_039                 7.642812e-03 3 1  ON 38
ci_040                -7.765457e-03 3 1  ON 39
ci_041                 1.123310e-02 3 1  ON 40
ci_042                 1.155404e-02 3 1  ON 41
ci_043                -8.436101e-03 3 1  ON 42
ci_044                -8.724227e-03 3 1  ON 43
ci_045                -7.556243e-03 3 1  ON 44
ci_046                 9.149400e-03 3 1  ON 45
ci_047                 9.383070e-03 3 1  ON 46
ci_048                -1.381966e-02 3 1  ON 47
ci_049                -1.333350e-02 3 1  ON 48
ci_050                 6.855391e-03 3 1  ON 49
ci_051                 6.565039e-03 3 1  ON 50
ci_052                -5.717303e-03 3 1  ON 51
ci_053                -5.772132e-03 3 1  ON 52
ci_054                -6.569911e-03 3 1  ON 53
ci_055                -6.643312e-03 3 1  ON 54
ci_056                 8.247570e-03 3 1  ON 55
ci_057                 8.065805e-03 3 1  ON 56
ci_058                -5.592856e-03 3 1  ON 57
ci_059                -5.705057e-03 3 1  ON 58
ci_060                 7.672328e-03 3 1  ON 59
ci_061                 7.673607e-03 3 1  ON 60
ci_062                -6.854651e-03 3 1  ON 61
ci_063                -6.833653e-03 3 1  ON 62
ci_064                -5.769419e-03 3 1  ON 63
ci_065                -6.290115e-03 3 1  ON 64
ci_066                 6.527790e-03 3 1  ON 65
ci_067                 6.729532e-03 3 1  ON 66
ci_068                -6.845175e-03 3 1  ON 67
ci_069                -6.647066e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2396
    reference variance = 0.506336
====================================================
  Execution time = 1.3578e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.0940e-01
  Total weights = 1.9556e+06
  Execution time = 1.8540e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294035630744
                                         uncertainty =       0.002212476518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294035630744
                                         uncertainty =       0.002212476518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383403900
  error estimate for blocks of size 2^( 2) =       0.000394868406
  error estimate for blocks of size 2^( 3) =       0.000405558712
  error estimate for blocks of size 2^( 4) =       0.000413121985
  error estimate for blocks of size 2^( 5) =       0.000417658930
  error estimate for blocks of size 2^( 6) =       0.000419377725
  error estimate for blocks of size 2^( 7) =       0.000421057505

      target function =      -0.888276497150
              le_mean =     -17.212779312973
             les_mean =     296.589999065623
             stat err =       0.000417804036
             autocorr =       1.187496152290
   target nu stat err =       0.000417804036
   target dn stat err =       0.003396827546
      target stat err =       0.004200797193
              std dev =       0.542214994662
             le_variance =       0.293997100437

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.102164
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291724092889
                                         uncertainty =       0.002171099834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291724092889
                                         uncertainty =       0.002171099834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381893439
  error estimate for blocks of size 2^( 2) =       0.000393452276
  error estimate for blocks of size 2^( 3) =       0.000404232357
  error estimate for blocks of size 2^( 4) =       0.000411875459
  error estimate for blocks of size 2^( 5) =       0.000416457653
  error estimate for blocks of size 2^( 6) =       0.000418172111
  error estimate for blocks of size 2^( 7) =       0.000419855789

      target function =      -0.877274141488
              le_mean =     -17.212783228268
             les_mean =     296.599106651564
             stat err =       0.000416590253
             autocorr =       1.189963979251
   target nu stat err =       0.000416590253
   target dn stat err =       0.010073058146
      target stat err =       0.012051098873
              std dev =       0.540078880638
             le_variance =       0.291685197311

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292781195860
                                         uncertainty =       0.002190094171

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292781195860
                                         uncertainty =       0.002190094171

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382584953
  error estimate for blocks of size 2^( 2) =       0.000394098050
  error estimate for blocks of size 2^( 3) =       0.000404835658
  error estimate for blocks of size 2^( 4) =       0.000412439598
  error estimate for blocks of size 2^( 5) =       0.000417001257
  error estimate for blocks of size 2^( 6) =       0.000418717774
  error estimate for blocks of size 2^( 7) =       0.000420399200

      target function =      -0.889728923675
              le_mean =     -17.212778330072
             les_mean =     296.588780904578
             stat err =       0.000417139457
             autocorr =       1.188794463113
   target nu stat err =       0.000417139457
   target dn stat err =       0.003440279238
      target stat err =       0.004267194098
              std dev =       0.541056828642
             le_variance =       0.292742491821

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293872643700
                                         uncertainty =       0.002209565997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.293872643700
                                         uncertainty =       0.002209565997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383297595
  error estimate for blocks of size 2^( 2) =       0.000394768221
  error estimate for blocks of size 2^( 3) =       0.000405464593
  error estimate for blocks of size 2^( 4) =       0.000413032975
  error estimate for blocks of size 2^( 5) =       0.000417572949
  error estimate for blocks of size 2^( 6) =       0.000419291445
  error estimate for blocks of size 2^( 7) =       0.000420971408

      target function =      -0.886112926083
              le_mean =     -17.212778873712
             les_mean =     296.591747935276
             stat err =       0.000417717194
             autocorr =       1.187661052991
   target nu stat err =       0.000417717194
   target dn stat err =       0.004033189844
      target stat err =       0.004950106909
              std dev =       0.542064657681
             le_variance =       0.293834093107


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.888276497150        initial
     1.0000e+00     1.0000e+01             6.0510e-04        -0.877274141488
     4.0000e+00     4.0000e+01             1.5787e-04        -0.889728923675  <--
     1.6000e+01     1.6000e+02             3.9902e-05        -0.886112926083

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 2.2894e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_001                -5.196458e-02 3 1  ON 0
ci_002                -4.037599e-02 3 1  ON 1
ci_003                -3.096587e-02 3 1  ON 2
ci_004                 2.951034e-02 3 1  ON 3
ci_005                 2.964295e-02 3 1  ON 4
ci_006                -2.711328e-02 3 1  ON 5
ci_007                -2.695469e-02 3 1  ON 6
ci_008                -1.632785e-02 3 1  ON 7
ci_009                -2.007155e-02 3 1  ON 8
ci_010                -1.707862e-02 3 1  ON 9
ci_011                -1.710149e-02 3 1  ON 10
ci_012                -1.710221e-02 3 1  ON 11
ci_013                -2.286096e-02 3 1  ON 12
ci_014                 1.784953e-02 3 1  ON 13
ci_015                 1.783429e-02 3 1  ON 14
ci_016                 1.993249e-02 3 1  ON 15
ci_017                 2.012506e-02 3 1  ON 16
ci_018                 1.573332e-02 3 1  ON 17
ci_019                 1.566721e-02 3 1  ON 18
ci_020                 2.088680e-02 3 1  ON 19
ci_021                 2.068877e-02 3 1  ON 20
ci_022                 1.434124e-02 3 1  ON 21
ci_023                 1.404282e-02 3 1  ON 22
ci_024                 1.499202e-02 3 1  ON 23
ci_025                 1.464394e-02 3 1  ON 24
ci_026                 1.515620e-02 3 1  ON 25
ci_027                 1.523977e-02 3 1  ON 26
ci_028                -1.763167e-02 3 1  ON 27
ci_029                -1.770250e-02 3 1  ON 28
ci_030                -1.313298e-02 3 1  ON 29
ci_031                -1.322319e-02 3 1  ON 30
ci_032                -1.590236e-02 3 1  ON 31
ci_033                 1.031286e-02 3 1  ON 32
ci_034                 1.049299e-02 3 1  ON 33
ci_035                -9.835891e-03 3 1  ON 34
ci_036                -1.512497e-02 3 1  ON 35
ci_037                -1.525421e-02 3 1  ON 36
ci_038                 7.357348e-03 3 1  ON 37
ci_039                 7.642812e-03 3 1  ON 38
ci_040                -7.765457e-03 3 1  ON 39
ci_041                 1.123310e-02 3 1  ON 40
ci_042                 1.155404e-02 3 1  ON 41
ci_043                -8.436101e-03 3 1  ON 42
ci_044                -8.724227e-03 3 1  ON 43
ci_045                -7.556243e-03 3 1  ON 44
ci_046                 9.149400e-03 3 1  ON 45
ci_047                 9.383070e-03 3 1  ON 46
ci_048                -1.381966e-02 3 1  ON 47
ci_049                -1.333350e-02 3 1  ON 48
ci_050                 6.855391e-03 3 1  ON 49
ci_051                 6.565039e-03 3 1  ON 50
ci_052                -5.717303e-03 3 1  ON 51
ci_053                -5.772132e-03 3 1  ON 52
ci_054                -6.569911e-03 3 1  ON 53
ci_055                -6.643312e-03 3 1  ON 54
ci_056                 8.247570e-03 3 1  ON 55
ci_057                 8.065805e-03 3 1  ON 56
ci_058                -5.592856e-03 3 1  ON 57
ci_059                -5.705057e-03 3 1  ON 58
ci_060                 7.672328e-03 3 1  ON 59
ci_061                 7.673607e-03 3 1  ON 60
ci_062                -6.854651e-03 3 1  ON 61
ci_063                -6.833653e-03 3 1  ON 62
ci_064                -5.769419e-03 3 1  ON 63
ci_065                -6.290115e-03 3 1  ON 64
ci_066                 6.527790e-03 3 1  ON 65
ci_067                 6.729532e-03 3 1  ON 66
ci_068                -6.845175e-03 3 1  ON 67
ci_069                -6.647066e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9390e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7235e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1696
    reference variance = 0.250636
====================================================
  Execution time = 1.3933e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5244e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.0503e-01
  Total weights = 1.955805407e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4893e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292130981075
                                         uncertainty =       0.002450255230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292130981075
                                         uncertainty =       0.002450255230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382144730
  error estimate for blocks of size 2^( 2) =       0.000394162462
  error estimate for blocks of size 2^( 3) =       0.000404627020
  error estimate for blocks of size 2^( 4) =       0.000412364433
  error estimate for blocks of size 2^( 5) =       0.000417311871
  error estimate for blocks of size 2^( 6) =       0.000419031882
  error estimate for blocks of size 2^( 7) =       0.000418925061

      target function =      -0.894525860343
              le_mean =     -17.211976297817
             les_mean =     296.557153983839
             stat err =       0.000416908312
             autocorr =       1.190214833136
   target nu stat err =       0.000416908312
   target dn stat err =       0.003152514573
      target stat err =       0.003953970810
              std dev =       0.540434259496
             le_variance =       0.292069188837


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721197629782e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.894542673406       residual = 3.42e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.895705645107       residual = 4.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.895881645232       residual = 9.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.895922660998       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.895927616573       residual = 3.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.895929303512       residual = 7.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.895929493012       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.895929473030       residual = 3.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.895929455280       residual = 4.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.895929462065       residual = 9.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.895929456050       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.895929458241       residual = 2.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 5.446735e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.894542673406       residual = 3.42e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.894849418852       residual = 4.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.894895216213       residual = 9.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.894905694398       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.894906949244       residual = 3.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.894907375944       residual = 6.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.894907422537       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.894907417044       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.894907412683       residual = 3.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.894907414295       residual = 8.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.894907412799       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.894907413348       residual = 2.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 1.440378e-04

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.894542673406       residual = 3.42e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.894620428156       residual = 4.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.894631994627       residual = 9.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.894634627946       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.894634942582       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.894635049544       residual = 6.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.894635061134       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.894635059728       residual = 3.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.894635058644       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.894635059041       residual = 8.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.894635058668       residual = 1.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.894635058805       residual = 2.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 3.653667e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.078898 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6441e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_001                -5.183587e-02 3 1  ON 0
ci_002                -4.026347e-02 3 1  ON 1
ci_003                -3.089537e-02 3 1  ON 2
ci_004                 2.943671e-02 3 1  ON 3
ci_005                 2.954626e-02 3 1  ON 4
ci_006                -2.703260e-02 3 1  ON 5
ci_007                -2.687986e-02 3 1  ON 6
ci_008                -1.618381e-02 3 1  ON 7
ci_009                -1.998044e-02 3 1  ON 8
ci_010                -1.694586e-02 3 1  ON 9
ci_011                -1.698616e-02 3 1  ON 10
ci_012                -1.701622e-02 3 1  ON 11
ci_013                -2.280906e-02 3 1  ON 12
ci_014                 1.777888e-02 3 1  ON 13
ci_015                 1.772546e-02 3 1  ON 14
ci_016                 1.989046e-02 3 1  ON 15
ci_017                 2.006805e-02 3 1  ON 16
ci_018                 1.563130e-02 3 1  ON 17
ci_019                 1.558141e-02 3 1  ON 18
ci_020                 2.084906e-02 3 1  ON 19
ci_021                 2.064272e-02 3 1  ON 20
ci_022                 1.427031e-02 3 1  ON 21
ci_023                 1.396683e-02 3 1  ON 22
ci_024                 1.488835e-02 3 1  ON 23
ci_025                 1.456857e-02 3 1  ON 24
ci_026                 1.509948e-02 3 1  ON 25
ci_027                 1.519051e-02 3 1  ON 26
ci_028                -1.758709e-02 3 1  ON 27
ci_029                -1.766229e-02 3 1  ON 28
ci_030                -1.306259e-02 3 1  ON 29
ci_031                -1.313512e-02 3 1  ON 30
ci_032                -1.587544e-02 3 1  ON 31
ci_033                 1.024514e-02 3 1  ON 32
ci_034                 1.039645e-02 3 1  ON 33
ci_035                -9.758070e-03 3 1  ON 34
ci_036                -1.508361e-02 3 1  ON 35
ci_037                -1.522368e-02 3 1  ON 36
ci_038                 7.251395e-03 3 1  ON 37
ci_039                 7.538212e-03 3 1  ON 38
ci_040                -7.680561e-03 3 1  ON 39
ci_041                 1.118440e-02 3 1  ON 40
ci_042                 1.151438e-02 3 1  ON 41
ci_043                -8.354028e-03 3 1  ON 42
ci_044                -8.647326e-03 3 1  ON 43
ci_045                -7.481910e-03 3 1  ON 44
ci_046                 9.091000e-03 3 1  ON 45
ci_047                 9.316792e-03 3 1  ON 46
ci_048                -1.378137e-02 3 1  ON 47
ci_049                -1.334753e-02 3 1  ON 48
ci_050                 6.794854e-03 3 1  ON 49
ci_051                 6.512277e-03 3 1  ON 50
ci_052                -5.667863e-03 3 1  ON 51
ci_053                -5.707081e-03 3 1  ON 52
ci_054                -6.505358e-03 3 1  ON 53
ci_055                -6.591131e-03 3 1  ON 54
ci_056                 8.194811e-03 3 1  ON 55
ci_057                 8.029169e-03 3 1  ON 56
ci_058                -5.514352e-03 3 1  ON 57
ci_059                -5.643190e-03 3 1  ON 58
ci_060                 7.617974e-03 3 1  ON 59
ci_061                 7.612201e-03 3 1  ON 60
ci_062                -6.824545e-03 3 1  ON 61
ci_063                -6.788706e-03 3 1  ON 62
ci_064                -5.718820e-03 3 1  ON 63
ci_065                -6.246487e-03 3 1  ON 64
ci_066                 6.492291e-03 3 1  ON 65
ci_067                 6.681247e-03 3 1  ON 66
ci_068                -6.796852e-03 3 1  ON 67
ci_069                -6.612127e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1202
    reference variance = 0.268144
====================================================
  Execution time = 1.3752e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.0370e-01
  Total weights = 1.9558e+06
  Execution time = 1.8462e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290628967032
                                         uncertainty =       0.001723632677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290628967032
                                         uncertainty =       0.001723632677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381161481
  error estimate for blocks of size 2^( 2) =       0.000392893683
  error estimate for blocks of size 2^( 3) =       0.000403558507
  error estimate for blocks of size 2^( 4) =       0.000411251988
  error estimate for blocks of size 2^( 5) =       0.000415763251
  error estimate for blocks of size 2^( 6) =       0.000417442025
  error estimate for blocks of size 2^( 7) =       0.000419325194

      target function =      -0.894971622628
              le_mean =     -17.212190551774
             les_mean =     296.564212303907
             stat err =       0.000415945615
             autocorr =       1.190844594439
   target nu stat err =       0.000415945615
   target dn stat err =       0.002523983590
      target stat err =       0.003188471696
              std dev =       0.539043735236
             le_variance =       0.290568148497

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288354124265
                                         uncertainty =       0.001690814472

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288354124265
                                         uncertainty =       0.001690814472

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379666178
  error estimate for blocks of size 2^( 2) =       0.000391479948
  error estimate for blocks of size 2^( 3) =       0.000402236247
  error estimate for blocks of size 2^( 4) =       0.000409990171
  error estimate for blocks of size 2^( 5) =       0.000414567445
  error estimate for blocks of size 2^( 6) =       0.000416262262
  error estimate for blocks of size 2^( 7) =       0.000418136807

      target function =      -0.897181917637
              le_mean =     -17.212197033859
             les_mean =     296.562661088479
             stat err =       0.000414739171
             autocorr =       1.193290797228
   target nu stat err =       0.000414739171
   target dn stat err =       0.002630153157
      target stat err =       0.003334188203
              std dev =       0.536929057584
             le_variance =       0.288292812878

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289403657105
                                         uncertainty =       0.001706037592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289403657105
                                         uncertainty =       0.001706037592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380356780
  error estimate for blocks of size 2^( 2) =       0.000392131304
  error estimate for blocks of size 2^( 3) =       0.000402841655
  error estimate for blocks of size 2^( 4) =       0.000410567911
  error estimate for blocks of size 2^( 5) =       0.000415114880
  error estimate for blocks of size 2^( 6) =       0.000416800992
  error estimate for blocks of size 2^( 7) =       0.000418678126

      target function =      -0.895448074177
              le_mean =     -17.212190205193
             les_mean =     296.563814984704
             stat err =       0.000415290477
             autocorr =       1.192124521111
   target nu stat err =       0.000415290477
   target dn stat err =       0.002798329233
      target stat err =       0.003527781246
              std dev =       0.537905716516
             le_variance =       0.289342559860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290470351293
                                         uncertainty =       0.001721360843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290470351293
                                         uncertainty =       0.001721360843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381057407
  error estimate for blocks of size 2^( 2) =       0.000392794930
  error estimate for blocks of size 2^( 3) =       0.000403465416
  error estimate for blocks of size 2^( 4) =       0.000411163007
  error estimate for blocks of size 2^( 5) =       0.000415678494
  error estimate for blocks of size 2^( 6) =       0.000417358075
  error estimate for blocks of size 2^( 7) =       0.000419240439

      target function =      -0.895330548837
              le_mean =     -17.212190091084
             les_mean =     296.563907626977
             stat err =       0.000415860004
             autocorr =       1.191004743564
   target nu stat err =       0.000415860004
   target dn stat err =       0.002516262964
      target stat err =       0.003181523062
              std dev =       0.538896552753
             le_variance =       0.290409494569


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.894971622628        initial
     1.0000e+00     1.0000e+01             5.4467e-04        -0.897181917637  <--
     4.0000e+00     4.0000e+01             1.4404e-04        -0.895448074177
     1.6000e+01     1.6000e+02             3.6537e-05        -0.895330548837

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.3055e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_001                -5.147162e-02 3 1  ON 0
ci_002                -3.994647e-02 3 1  ON 1
ci_003                -3.069479e-02 3 1  ON 2
ci_004                 2.922843e-02 3 1  ON 3
ci_005                 2.927300e-02 3 1  ON 4
ci_006                -2.680541e-02 3 1  ON 5
ci_007                -2.666926e-02 3 1  ON 6
ci_008                -1.578318e-02 3 1  ON 7
ci_009                -1.972543e-02 3 1  ON 8
ci_010                -1.657331e-02 3 1  ON 9
ci_011                -1.666321e-02 3 1  ON 10
ci_012                -1.677488e-02 3 1  ON 11
ci_013                -2.266201e-02 3 1  ON 12
ci_014                 1.758096e-02 3 1  ON 13
ci_015                 1.742030e-02 3 1  ON 14
ci_016                 1.977320e-02 3 1  ON 15
ci_017                 1.990815e-02 3 1  ON 16
ci_018                 1.534623e-02 3 1  ON 17
ci_019                 1.534179e-02 3 1  ON 18
ci_020                 2.074151e-02 3 1  ON 19
ci_021                 2.051165e-02 3 1  ON 20
ci_022                 1.407197e-02 3 1  ON 21
ci_023                 1.375416e-02 3 1  ON 22
ci_024                 1.459533e-02 3 1  ON 23
ci_025                 1.435498e-02 3 1  ON 24
ci_026                 1.494025e-02 3 1  ON 25
ci_027                 1.505161e-02 3 1  ON 26
ci_028                -1.746205e-02 3 1  ON 27
ci_029                -1.754943e-02 3 1  ON 28
ci_030                -1.286545e-02 3 1  ON 29
ci_031                -1.288940e-02 3 1  ON 30
ci_032                -1.579972e-02 3 1  ON 31
ci_033                 1.005443e-02 3 1  ON 32
ci_034                 1.012487e-02 3 1  ON 33
ci_035                -9.540700e-03 3 1  ON 34
ci_036                -1.496646e-02 3 1  ON 35
ci_037                -1.513651e-02 3 1  ON 36
ci_038                 6.955807e-03 3 1  ON 37
ci_039                 7.246300e-03 3 1  ON 38
ci_040                -7.444062e-03 3 1  ON 39
ci_041                 1.104839e-02 3 1  ON 40
ci_042                 1.140345e-02 3 1  ON 41
ci_043                -8.124603e-03 3 1  ON 42
ci_044                -8.431689e-03 3 1  ON 43
ci_045                -7.274672e-03 3 1  ON 44
ci_046                 8.926903e-03 3 1  ON 45
ci_047                 9.130608e-03 3 1  ON 46
ci_048                -1.367363e-02 3 1  ON 47
ci_049                -1.338731e-02 3 1  ON 48
ci_050                 6.626684e-03 3 1  ON 49
ci_051                 6.365547e-03 3 1  ON 50
ci_052                -5.530773e-03 3 1  ON 51
ci_053                -5.526437e-03 3 1  ON 52
ci_054                -6.323665e-03 3 1  ON 53
ci_055                -6.444611e-03 3 1  ON 54
ci_056                 8.047049e-03 3 1  ON 55
ci_057                 7.926605e-03 3 1  ON 56
ci_058                -5.296571e-03 3 1  ON 57
ci_059                -5.471191e-03 3 1  ON 58
ci_060                 7.465108e-03 3 1  ON 59
ci_061                 7.439715e-03 3 1  ON 60
ci_062                -6.739058e-03 3 1  ON 61
ci_063                -6.662014e-03 3 1  ON 62
ci_064                -5.577944e-03 3 1  ON 63
ci_065                -6.124903e-03 3 1  ON 64
ci_066                 6.393378e-03 3 1  ON 65
ci_067                 6.546808e-03 3 1  ON 66
ci_068                -6.661569e-03 3 1  ON 67
ci_069                -6.514344e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9511e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7229e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2023
    reference variance = 0.179605
====================================================
  Execution time = 1.4123e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.0311e-01
  Total weights = 1.955772013e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4899e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289740783400
                                         uncertainty =       0.001654049014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289740783400
                                         uncertainty =       0.001654049014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380569895
  error estimate for blocks of size 2^( 2) =       0.000391925099
  error estimate for blocks of size 2^( 3) =       0.000402260574
  error estimate for blocks of size 2^( 4) =       0.000409037741
  error estimate for blocks of size 2^( 5) =       0.000413924036
  error estimate for blocks of size 2^( 6) =       0.000415998065
  error estimate for blocks of size 2^( 7) =       0.000417230419

      target function =      -0.897179639892
              le_mean =     -17.213216254031
             les_mean =     296.597927528129
             stat err =       0.000414047565
             autocorr =       1.183672640067
   target nu stat err =       0.000414047565
   target dn stat err =       0.002580337049
      target stat err =       0.003277941810
              std dev =       0.538207107310
             le_variance =       0.289666890359


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721321625403e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.897190808548       residual = 3.10e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.900634689620       residual = 4.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901202036895       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901371611008       residual = 1.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901392956453       residual = 3.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901398355569       residual = 8.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901399436281       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901399474421       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901399408006       residual = 3.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901399418214       residual = 9.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.901399413890       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.901399404064       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 1.955796e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.897190808548       residual = 3.10e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.898233459175       residual = 3.92e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.898398642983       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898445202831       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898450884511       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898452268450       residual = 7.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898452541315       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898452541786       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898452523174       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898452526577       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.898452524928       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.898452522831       residual = 1.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 5.713832e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.897190808548       residual = 3.10e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.897465928720       residual = 3.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.897508957090       residual = 9.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.897520857844       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.897522296714       residual = 2.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.897522643348       residual = 6.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.897522711194       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.897522710580       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.897522705828       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.897522706735       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.897522706281       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.897522705791       residual = 1.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 1.491000e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.088845 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6632e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_001                -5.090024e-02 3 1  ON 0
ci_002                -3.953375e-02 3 1  ON 1
ci_003                -3.040071e-02 3 1  ON 2
ci_004                 2.891820e-02 3 1  ON 3
ci_005                 2.895797e-02 3 1  ON 4
ci_006                -2.653215e-02 3 1  ON 5
ci_007                -2.636578e-02 3 1  ON 6
ci_008                -1.524636e-02 3 1  ON 7
ci_009                -1.946770e-02 3 1  ON 8
ci_010                -1.606996e-02 3 1  ON 9
ci_011                -1.634438e-02 3 1  ON 10
ci_012                -1.634261e-02 3 1  ON 11
ci_013                -2.245768e-02 3 1  ON 12
ci_014                 1.723882e-02 3 1  ON 13
ci_015                 1.712213e-02 3 1  ON 14
ci_016                 1.959013e-02 3 1  ON 15
ci_017                 1.969790e-02 3 1  ON 16
ci_018                 1.512194e-02 3 1  ON 17
ci_019                 1.507521e-02 3 1  ON 18
ci_020                 2.050814e-02 3 1  ON 19
ci_021                 2.038529e-02 3 1  ON 20
ci_022                 1.377858e-02 3 1  ON 21
ci_023                 1.349583e-02 3 1  ON 22
ci_024                 1.425241e-02 3 1  ON 23
ci_025                 1.399607e-02 3 1  ON 24
ci_026                 1.473550e-02 3 1  ON 25
ci_027                 1.485099e-02 3 1  ON 26
ci_028                -1.725042e-02 3 1  ON 27
ci_029                -1.741422e-02 3 1  ON 28
ci_030                -1.258511e-02 3 1  ON 29
ci_031                -1.266982e-02 3 1  ON 30
ci_032                -1.569166e-02 3 1  ON 31
ci_033                 9.732213e-03 3 1  ON 32
ci_034                 9.837068e-03 3 1  ON 33
ci_035                -9.221743e-03 3 1  ON 34
ci_036                -1.486574e-02 3 1  ON 35
ci_037                -1.491448e-02 3 1  ON 36
ci_038                 6.594390e-03 3 1  ON 37
ci_039                 6.884932e-03 3 1  ON 38
ci_040                -7.121839e-03 3 1  ON 39
ci_041                 1.081348e-02 3 1  ON 40
ci_042                 1.125617e-02 3 1  ON 41
ci_043                -7.836067e-03 3 1  ON 42
ci_044                -8.167630e-03 3 1  ON 43
ci_045                -6.951522e-03 3 1  ON 44
ci_046                 8.751128e-03 3 1  ON 45
ci_047                 8.914722e-03 3 1  ON 46
ci_048                -1.373061e-02 3 1  ON 47
ci_049                -1.333923e-02 3 1  ON 48
ci_050                 6.433602e-03 3 1  ON 49
ci_051                 6.193131e-03 3 1  ON 50
ci_052                -5.335728e-03 3 1  ON 51
ci_053                -5.282182e-03 3 1  ON 52
ci_054                -6.113719e-03 3 1  ON 53
ci_055                -6.275039e-03 3 1  ON 54
ci_056                 7.862548e-03 3 1  ON 55
ci_057                 7.768361e-03 3 1  ON 56
ci_058                -5.045321e-03 3 1  ON 57
ci_059                -5.190130e-03 3 1  ON 58
ci_060                 7.326471e-03 3 1  ON 59
ci_061                 7.337457e-03 3 1  ON 60
ci_062                -6.645663e-03 3 1  ON 61
ci_063                -6.529985e-03 3 1  ON 62
ci_064                -5.396340e-03 3 1  ON 63
ci_065                -6.012216e-03 3 1  ON 64
ci_066                 6.258018e-03 3 1  ON 65
ci_067                 6.376596e-03 3 1  ON 66
ci_068                -6.576483e-03 3 1  ON 67
ci_069                -6.409769e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.2212
    reference variance = 0.408368
====================================================
  Execution time = 1.3770e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.9754e-01
  Total weights = 1.9561e+06
  Execution time = 2.2835e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288740493431
                                         uncertainty =       0.002240471397

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288740493431
                                         uncertainty =       0.002240471397

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380017791
  error estimate for blocks of size 2^( 2) =       0.000392209600
  error estimate for blocks of size 2^( 3) =       0.000402085374
  error estimate for blocks of size 2^( 4) =       0.000409301548
  error estimate for blocks of size 2^( 5) =       0.000413405848
  error estimate for blocks of size 2^( 6) =       0.000414510503
  error estimate for blocks of size 2^( 7) =       0.000415597530

      target function =      -0.884748026393
              le_mean =     -17.212723470481
             les_mean =     296.590751387723
             stat err =       0.000413203857
             autocorr =       1.182281454632
   target nu stat err =       0.000413203857
   target dn stat err =       0.012776991203
      target stat err =       0.015541114917
              std dev =       0.537426313302
             le_variance =       0.288827042230

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284281579298
                                         uncertainty =       0.002527615375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284281579298
                                         uncertainty =       0.002527615375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377070414
  error estimate for blocks of size 2^( 2) =       0.000389493439
  error estimate for blocks of size 2^( 3) =       0.000399683882
  error estimate for blocks of size 2^( 4) =       0.000407146769
  error estimate for blocks of size 2^( 5) =       0.000411449075
  error estimate for blocks of size 2^( 6) =       0.000412588152
  error estimate for blocks of size 2^( 7) =       0.000413436057

      target function =      -0.761070668465
              le_mean =     -17.212829159407
             les_mean =     296.698138530329
             stat err =       0.000411155013
             autocorr =       1.188957316763
   target nu stat err =       0.000411155013
   target dn stat err =       0.110929796510
      target stat err =       0.101536758990
              std dev =       0.533258093597
             le_variance =       0.284364194386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284919920153
                                         uncertainty =       0.002206109855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284919920153
                                         uncertainty =       0.002206109855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377497040
  error estimate for blocks of size 2^( 2) =       0.000389831258
  error estimate for blocks of size 2^( 3) =       0.000399909237
  error estimate for blocks of size 2^( 4) =       0.000407273785
  error estimate for blocks of size 2^( 5) =       0.000411461464
  error estimate for blocks of size 2^( 6) =       0.000412548667
  error estimate for blocks of size 2^( 7) =       0.000413552732

      target function =      -0.904207989755
              le_mean =     -17.212734894434
             les_mean =     296.575690825062
             stat err =       0.000411209162
             autocorr =       1.186583934469
   target nu stat err =       0.000411209162
   target dn stat err =       0.002715553659
      target stat err =       0.003494669076
              std dev =       0.533861433334
             le_variance =       0.285008030002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288180280125
                                         uncertainty =       0.002235439408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288180280125
                                         uncertainty =       0.002235439408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379649226
  error estimate for blocks of size 2^( 2) =       0.000391858919
  error estimate for blocks of size 2^( 3) =       0.000401759082
  error estimate for blocks of size 2^( 4) =       0.000408990562
  error estimate for blocks of size 2^( 5) =       0.000413100291
  error estimate for blocks of size 2^( 6) =       0.000414209649
  error estimate for blocks of size 2^( 7) =       0.000415291710

      target function =      -0.892723130654
              le_mean =     -17.212715629506
             les_mean =     296.584143846432
             stat err =       0.000412898053
             autocorr =       1.182825376347
   target nu stat err =       0.000412898053
   target dn stat err =       0.006365282832
      target stat err =       0.007896122985
              std dev =       0.536905083757
             le_variance =       0.288267068964


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.884748026393        initial
     2.5000e-01     2.5000e+00             1.9558e-03        -0.761070668465
     1.0000e+00     1.0000e+01             5.7138e-04        -0.904207989755  <--
     4.0000e+00     4.0000e+01             1.4910e-04        -0.892723130654

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.4197e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_001                -5.090024e-02 3 1  ON 0
ci_002                -3.953375e-02 3 1  ON 1
ci_003                -3.040071e-02 3 1  ON 2
ci_004                 2.891820e-02 3 1  ON 3
ci_005                 2.895797e-02 3 1  ON 4
ci_006                -2.653215e-02 3 1  ON 5
ci_007                -2.636578e-02 3 1  ON 6
ci_008                -1.524636e-02 3 1  ON 7
ci_009                -1.946770e-02 3 1  ON 8
ci_010                -1.606996e-02 3 1  ON 9
ci_011                -1.634438e-02 3 1  ON 10
ci_012                -1.634261e-02 3 1  ON 11
ci_013                -2.245768e-02 3 1  ON 12
ci_014                 1.723882e-02 3 1  ON 13
ci_015                 1.712213e-02 3 1  ON 14
ci_016                 1.959013e-02 3 1  ON 15
ci_017                 1.969790e-02 3 1  ON 16
ci_018                 1.512194e-02 3 1  ON 17
ci_019                 1.507521e-02 3 1  ON 18
ci_020                 2.050814e-02 3 1  ON 19
ci_021                 2.038529e-02 3 1  ON 20
ci_022                 1.377858e-02 3 1  ON 21
ci_023                 1.349583e-02 3 1  ON 22
ci_024                 1.425241e-02 3 1  ON 23
ci_025                 1.399607e-02 3 1  ON 24
ci_026                 1.473550e-02 3 1  ON 25
ci_027                 1.485099e-02 3 1  ON 26
ci_028                -1.725042e-02 3 1  ON 27
ci_029                -1.741422e-02 3 1  ON 28
ci_030                -1.258511e-02 3 1  ON 29
ci_031                -1.266982e-02 3 1  ON 30
ci_032                -1.569166e-02 3 1  ON 31
ci_033                 9.732213e-03 3 1  ON 32
ci_034                 9.837068e-03 3 1  ON 33
ci_035                -9.221743e-03 3 1  ON 34
ci_036                -1.486574e-02 3 1  ON 35
ci_037                -1.491448e-02 3 1  ON 36
ci_038                 6.594390e-03 3 1  ON 37
ci_039                 6.884932e-03 3 1  ON 38
ci_040                -7.121839e-03 3 1  ON 39
ci_041                 1.081348e-02 3 1  ON 40
ci_042                 1.125617e-02 3 1  ON 41
ci_043                -7.836067e-03 3 1  ON 42
ci_044                -8.167630e-03 3 1  ON 43
ci_045                -6.951522e-03 3 1  ON 44
ci_046                 8.751128e-03 3 1  ON 45
ci_047                 8.914722e-03 3 1  ON 46
ci_048                -1.373061e-02 3 1  ON 47
ci_049                -1.333923e-02 3 1  ON 48
ci_050                 6.433602e-03 3 1  ON 49
ci_051                 6.193131e-03 3 1  ON 50
ci_052                -5.335728e-03 3 1  ON 51
ci_053                -5.282182e-03 3 1  ON 52
ci_054                -6.113719e-03 3 1  ON 53
ci_055                -6.275039e-03 3 1  ON 54
ci_056                 7.862548e-03 3 1  ON 55
ci_057                 7.768361e-03 3 1  ON 56
ci_058                -5.045321e-03 3 1  ON 57
ci_059                -5.190130e-03 3 1  ON 58
ci_060                 7.326471e-03 3 1  ON 59
ci_061                 7.337457e-03 3 1  ON 60
ci_062                -6.645663e-03 3 1  ON 61
ci_063                -6.529985e-03 3 1  ON 62
ci_064                -5.396340e-03 3 1  ON 63
ci_065                -6.012216e-03 3 1  ON 64
ci_066                 6.258018e-03 3 1  ON 65
ci_067                 6.376596e-03 3 1  ON 66
ci_068                -6.576483e-03 3 1  ON 67
ci_069                -6.409769e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0840e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7227e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2909
    reference variance = 0.309408
====================================================
  Execution time = 1.3895e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.0359e-01
  Total weights = 1.955688647e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4934e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286401844056
                                         uncertainty =       0.001633303455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286401844056
                                         uncertainty =       0.001633303455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378438547
  error estimate for blocks of size 2^( 2) =       0.000390260150
  error estimate for blocks of size 2^( 3) =       0.000400593508
  error estimate for blocks of size 2^( 4) =       0.000408207773
  error estimate for blocks of size 2^( 5) =       0.000413184691
  error estimate for blocks of size 2^( 6) =       0.000414457902
  error estimate for blocks of size 2^( 7) =       0.000415991544

      target function =      -0.896479356177
              le_mean =     -17.212871647603
             les_mean =     296.586544968754
             stat err =       0.000412960477
             autocorr =       1.190765505480
   target nu stat err =       0.000412960477
   target dn stat err =       0.004591120771
      target stat err =       0.005758147325
              std dev =       0.535192926003
             le_variance =       0.286431468044


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721287164760e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.896515697863       residual = 2.78e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.899503093072       residual = 3.72e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.900038617073       residual = 8.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.900174705251       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.900188219221       residual = 2.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.900191817442       residual = 7.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.900193164024       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.900193303171       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.900193323054       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.900193302405       residual = 5.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.900193317094       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.900193321389       residual = 2.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 1.928216e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.896515697863       residual = 2.78e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.897420832753       residual = 3.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.897576537646       residual = 7.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.897613931640       residual = 9.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.897617520266       residual = 2.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.897618431263       residual = 5.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.897618777811       residual = 9.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.897618808978       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.897618813557       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.897618808236       residual = 3.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.897618811961       residual = 7.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 5.640124e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.896515697863       residual = 2.78e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.896754597188       residual = 3.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.896795140896       residual = 7.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.896804702151       residual = 9.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.896805610949       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.896805837877       residual = 5.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.896805924564       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.896805932033       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.896805933150       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.896805931823       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.896805932748       residual = 6.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 1.472397e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.093165 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6398e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_001                -5.033623e-02 3 1  ON 0
ci_002                -3.908079e-02 3 1  ON 1
ci_003                -3.015731e-02 3 1  ON 2
ci_004                 2.873108e-02 3 1  ON 3
ci_005                 2.879395e-02 3 1  ON 4
ci_006                -2.625640e-02 3 1  ON 5
ci_007                -2.599612e-02 3 1  ON 6
ci_008                -1.474333e-02 3 1  ON 7
ci_009                -1.915399e-02 3 1  ON 8
ci_010                -1.564041e-02 3 1  ON 9
ci_011                -1.594633e-02 3 1  ON 10
ci_012                -1.592889e-02 3 1  ON 11
ci_013                -2.227065e-02 3 1  ON 12
ci_014                 1.690516e-02 3 1  ON 13
ci_015                 1.686135e-02 3 1  ON 14
ci_016                 1.937196e-02 3 1  ON 15
ci_017                 1.947296e-02 3 1  ON 16
ci_018                 1.490758e-02 3 1  ON 17
ci_019                 1.485576e-02 3 1  ON 18
ci_020                 2.037163e-02 3 1  ON 19
ci_021                 2.026217e-02 3 1  ON 20
ci_022                 1.354471e-02 3 1  ON 21
ci_023                 1.329975e-02 3 1  ON 22
ci_024                 1.400116e-02 3 1  ON 23
ci_025                 1.378420e-02 3 1  ON 24
ci_026                 1.448257e-02 3 1  ON 25
ci_027                 1.474412e-02 3 1  ON 26
ci_028                -1.708020e-02 3 1  ON 27
ci_029                -1.726357e-02 3 1  ON 28
ci_030                -1.243485e-02 3 1  ON 29
ci_031                -1.249318e-02 3 1  ON 30
ci_032                -1.557145e-02 3 1  ON 31
ci_033                 9.505914e-03 3 1  ON 32
ci_034                 9.551924e-03 3 1  ON 33
ci_035                -8.983626e-03 3 1  ON 34
ci_036                -1.470523e-02 3 1  ON 35
ci_037                -1.479865e-02 3 1  ON 36
ci_038                 6.264844e-03 3 1  ON 37
ci_039                 6.542627e-03 3 1  ON 38
ci_040                -6.816750e-03 3 1  ON 39
ci_041                 1.066901e-02 3 1  ON 40
ci_042                 1.110193e-02 3 1  ON 41
ci_043                -7.604149e-03 3 1  ON 42
ci_044                -7.910238e-03 3 1  ON 43
ci_045                -6.697402e-03 3 1  ON 44
ci_046                 8.542391e-03 3 1  ON 45
ci_047                 8.720333e-03 3 1  ON 46
ci_048                -1.360382e-02 3 1  ON 47
ci_049                -1.326745e-02 3 1  ON 48
ci_050                 6.187826e-03 3 1  ON 49
ci_051                 5.979813e-03 3 1  ON 50
ci_052                -5.089063e-03 3 1  ON 51
ci_053                -5.078748e-03 3 1  ON 52
ci_054                -5.925155e-03 3 1  ON 53
ci_055                -6.046286e-03 3 1  ON 54
ci_056                 7.747185e-03 3 1  ON 55
ci_057                 7.607612e-03 3 1  ON 56
ci_058                -4.833659e-03 3 1  ON 57
ci_059                -5.009515e-03 3 1  ON 58
ci_060                 7.183927e-03 3 1  ON 59
ci_061                 7.149240e-03 3 1  ON 60
ci_062                -6.486749e-03 3 1  ON 61
ci_063                -6.355851e-03 3 1  ON 62
ci_064                -5.191129e-03 3 1  ON 63
ci_065                -5.881090e-03 3 1  ON 64
ci_066                 6.185361e-03 3 1  ON 65
ci_067                 6.291506e-03 3 1  ON 66
ci_068                -6.447681e-03 3 1  ON 67
ci_069                -6.332363e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1725
    reference variance = 0.249369
====================================================
  Execution time = 1.3581e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.1006e-01
  Total weights = 1.9561e+06
  Execution time = 1.8605e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292960805136
                                         uncertainty =       0.004729860335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292960805136
                                         uncertainty =       0.004729860335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382745722
  error estimate for blocks of size 2^( 2) =       0.000394427300
  error estimate for blocks of size 2^( 3) =       0.000404835869
  error estimate for blocks of size 2^( 4) =       0.000412333168
  error estimate for blocks of size 2^( 5) =       0.000417655782
  error estimate for blocks of size 2^( 6) =       0.000420022245
  error estimate for blocks of size 2^( 7) =       0.000421168183

      target function =      -0.884700258254
              le_mean =     -17.213198284295
             les_mean =     296.607302157596
             stat err =       0.000417794844
             autocorr =       1.191531317747
   target nu stat err =       0.000417794844
   target dn stat err =       0.009883168504
      target stat err =       0.012033010904
              std dev =       0.541284191487
             le_variance =       0.292988575954

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288755357836
                                         uncertainty =       0.005356581652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288755357836
                                         uncertainty =       0.005356581652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379990080
  error estimate for blocks of size 2^( 2) =       0.000391950855
  error estimate for blocks of size 2^( 3) =       0.000402642117
  error estimate for blocks of size 2^( 4) =       0.000410403034
  error estimate for blocks of size 2^( 5) =       0.000415876239
  error estimate for blocks of size 2^( 6) =       0.000418300414
  error estimate for blocks of size 2^( 7) =       0.000419364047

      target function =      -0.877490246955
              le_mean =     -17.213259316778
             les_mean =     296.615279366466
             stat err =       0.000415985934
             autocorr =       1.198430278129
   target nu stat err =       0.000415985934
   target dn stat err =       0.013424192146
      target stat err =       0.016074610444
              std dev =       0.537387124467
             le_variance =       0.288784921543

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290123828073
                                         uncertainty =       0.005085628375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290123828073
                                         uncertainty =       0.005085628375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380888961
  error estimate for blocks of size 2^( 2) =       0.000392729926
  error estimate for blocks of size 2^( 3) =       0.000403309119
  error estimate for blocks of size 2^( 4) =       0.000410960516
  error estimate for blocks of size 2^( 5) =       0.000416378197
  error estimate for blocks of size 2^( 6) =       0.000418744479
  error estimate for blocks of size 2^( 7) =       0.000419846704

      target function =      -0.883326922979
              le_mean =     -17.213201351053
             les_mean =     296.608494994832
             stat err =       0.000416482474
             autocorr =       1.195629682998
   target nu stat err =       0.000416482474
   target dn stat err =       0.011413920765
      target stat err =       0.013850550279
              std dev =       0.538658334577
             le_variance =       0.290152801410

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292544798673
                                         uncertainty =       0.004772673003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292544798673
                                         uncertainty =       0.004772673003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382474001
  error estimate for blocks of size 2^( 2) =       0.000394175341
  error estimate for blocks of size 2^( 3) =       0.000404605479
  error estimate for blocks of size 2^( 4) =       0.000412121777
  error estimate for blocks of size 2^( 5) =       0.000417456475
  error estimate for blocks of size 2^( 6) =       0.000419823732
  error estimate for blocks of size 2^( 7) =       0.000420962736

      target function =      -0.880388035940
              le_mean =     -17.213194409434
             les_mean =     296.610713076733
             stat err =       0.000417591180
             autocorr =       1.192061870073
   target nu stat err =       0.000417591180
   target dn stat err =       0.010583172496
      target stat err =       0.012758473809
              std dev =       0.540899919393
             le_variance =       0.292572722799


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.884700258254        initial  <--
     2.5000e-01     2.5000e+00             1.9282e-03        -0.877490246955
     1.0000e+00     1.0000e+01             5.6401e-04        -0.883326922979
     4.0000e+00     4.0000e+01             1.4724e-04        -0.880388035940

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8551
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_001                -5.090024e-02 3 1  ON 0
ci_002                -3.953375e-02 3 1  ON 1
ci_003                -3.040071e-02 3 1  ON 2
ci_004                 2.891820e-02 3 1  ON 3
ci_005                 2.895797e-02 3 1  ON 4
ci_006                -2.653215e-02 3 1  ON 5
ci_007                -2.636578e-02 3 1  ON 6
ci_008                -1.524636e-02 3 1  ON 7
ci_009                -1.946770e-02 3 1  ON 8
ci_010                -1.606996e-02 3 1  ON 9
ci_011                -1.634438e-02 3 1  ON 10
ci_012                -1.634261e-02 3 1  ON 11
ci_013                -2.245768e-02 3 1  ON 12
ci_014                 1.723882e-02 3 1  ON 13
ci_015                 1.712213e-02 3 1  ON 14
ci_016                 1.959013e-02 3 1  ON 15
ci_017                 1.969790e-02 3 1  ON 16
ci_018                 1.512194e-02 3 1  ON 17
ci_019                 1.507521e-02 3 1  ON 18
ci_020                 2.050814e-02 3 1  ON 19
ci_021                 2.038529e-02 3 1  ON 20
ci_022                 1.377858e-02 3 1  ON 21
ci_023                 1.349583e-02 3 1  ON 22
ci_024                 1.425241e-02 3 1  ON 23
ci_025                 1.399607e-02 3 1  ON 24
ci_026                 1.473550e-02 3 1  ON 25
ci_027                 1.485099e-02 3 1  ON 26
ci_028                -1.725042e-02 3 1  ON 27
ci_029                -1.741422e-02 3 1  ON 28
ci_030                -1.258511e-02 3 1  ON 29
ci_031                -1.266982e-02 3 1  ON 30
ci_032                -1.569166e-02 3 1  ON 31
ci_033                 9.732213e-03 3 1  ON 32
ci_034                 9.837068e-03 3 1  ON 33
ci_035                -9.221743e-03 3 1  ON 34
ci_036                -1.486574e-02 3 1  ON 35
ci_037                -1.491448e-02 3 1  ON 36
ci_038                 6.594390e-03 3 1  ON 37
ci_039                 6.884932e-03 3 1  ON 38
ci_040                -7.121839e-03 3 1  ON 39
ci_041                 1.081348e-02 3 1  ON 40
ci_042                 1.125617e-02 3 1  ON 41
ci_043                -7.836067e-03 3 1  ON 42
ci_044                -8.167630e-03 3 1  ON 43
ci_045                -6.951522e-03 3 1  ON 44
ci_046                 8.751128e-03 3 1  ON 45
ci_047                 8.914722e-03 3 1  ON 46
ci_048                -1.373061e-02 3 1  ON 47
ci_049                -1.333923e-02 3 1  ON 48
ci_050                 6.433602e-03 3 1  ON 49
ci_051                 6.193131e-03 3 1  ON 50
ci_052                -5.335728e-03 3 1  ON 51
ci_053                -5.282182e-03 3 1  ON 52
ci_054                -6.113719e-03 3 1  ON 53
ci_055                -6.275039e-03 3 1  ON 54
ci_056                 7.862548e-03 3 1  ON 55
ci_057                 7.768361e-03 3 1  ON 56
ci_058                -5.045321e-03 3 1  ON 57
ci_059                -5.190130e-03 3 1  ON 58
ci_060                 7.326471e-03 3 1  ON 59
ci_061                 7.337457e-03 3 1  ON 60
ci_062                -6.645663e-03 3 1  ON 61
ci_063                -6.529985e-03 3 1  ON 62
ci_064                -5.396340e-03 3 1  ON 63
ci_065                -6.012216e-03 3 1  ON 64
ci_066                 6.258018e-03 3 1  ON 65
ci_067                 6.376596e-03 3 1  ON 66
ci_068                -6.576483e-03 3 1  ON 67
ci_069                -6.409769e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9258e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7228e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.1748
    reference variance = 0.178601
====================================================
  Execution time = 1.4059e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.9569e-01
  Total weights = 1.956189908e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4793e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285652551558
                                         uncertainty =       0.001603920492

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285652551558
                                         uncertainty =       0.001603920492

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377919195
  error estimate for blocks of size 2^( 2) =       0.000390035658
  error estimate for blocks of size 2^( 3) =       0.000401027906
  error estimate for blocks of size 2^( 4) =       0.000408894332
  error estimate for blocks of size 2^( 5) =       0.000413520184
  error estimate for blocks of size 2^( 6) =       0.000417741303
  error estimate for blocks of size 2^( 7) =       0.000420070334

      target function =      -0.906537021024
              le_mean =     -17.213111610713
             les_mean =     296.586904000744
             stat err =       0.000415056538
             autocorr =       1.206192482283
   target nu stat err =       0.000415056538
   target dn stat err =       0.001938335256
      target stat err =       0.002542407802
              std dev =       0.534458450696
             le_variance =       0.285645835520


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721311161071e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906543381876       residual = 2.74e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906907322586       residual = 3.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906974133043       residual = 8.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906990422573       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906992630183       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906992991395       residual = 5.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906993094823       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906993129292       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906993143050       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906993133615       residual = 3.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.906993136190       residual = 8.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 2.384417e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906543381876       residual = 2.74e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906636450175       residual = 3.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906653440850       residual = 8.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906657549159       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906658103955       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906658193685       residual = 5.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906658219581       residual = 9.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906658228348       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906658231744       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906658229375       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.906658230018       residual = 8.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 6.067105e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906543381876       residual = 2.74e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906566782834       residual = 3.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906571048843       residual = 8.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906572078148       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906572217022       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906572239417       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906572245893       residual = 9.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906572248094       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906572248940       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906572248348       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.906572248508       residual = 7.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 1.523549e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.097216 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6547e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_001                -5.083957e-02 3 1  ON 0
ci_002                -3.949437e-02 3 1  ON 1
ci_003                -3.037119e-02 3 1  ON 2
ci_004                 2.888133e-02 3 1  ON 3
ci_005                 2.893498e-02 3 1  ON 4
ci_006                -2.650052e-02 3 1  ON 5
ci_007                -2.633937e-02 3 1  ON 6
ci_008                -1.519544e-02 3 1  ON 7
ci_009                -1.943574e-02 3 1  ON 8
ci_010                -1.602888e-02 3 1  ON 9
ci_011                -1.630179e-02 3 1  ON 10
ci_012                -1.630306e-02 3 1  ON 11
ci_013                -2.244363e-02 3 1  ON 12
ci_014                 1.721067e-02 3 1  ON 13
ci_015                 1.708645e-02 3 1  ON 14
ci_016                 1.957327e-02 3 1  ON 15
ci_017                 1.968199e-02 3 1  ON 16
ci_018                 1.508760e-02 3 1  ON 17
ci_019                 1.503892e-02 3 1  ON 18
ci_020                 2.048978e-02 3 1  ON 19
ci_021                 2.037021e-02 3 1  ON 20
ci_022                 1.375059e-02 3 1  ON 21
ci_023                 1.346997e-02 3 1  ON 22
ci_024                 1.421961e-02 3 1  ON 23
ci_025                 1.396466e-02 3 1  ON 24
ci_026                 1.471366e-02 3 1  ON 25
ci_027                 1.483132e-02 3 1  ON 26
ci_028                -1.723804e-02 3 1  ON 27
ci_029                -1.740223e-02 3 1  ON 28
ci_030                -1.257057e-02 3 1  ON 29
ci_031                -1.264931e-02 3 1  ON 30
ci_032                -1.568568e-02 3 1  ON 31
ci_033                 9.706581e-03 3 1  ON 32
ci_034                 9.806626e-03 3 1  ON 33
ci_035                -9.193516e-03 3 1  ON 34
ci_036                -1.485323e-02 3 1  ON 35
ci_037                -1.490262e-02 3 1  ON 36
ci_038                 6.559744e-03 3 1  ON 37
ci_039                 6.849428e-03 3 1  ON 38
ci_040                -7.091723e-03 3 1  ON 39
ci_041                 1.079501e-02 3 1  ON 40
ci_042                 1.123722e-02 3 1  ON 41
ci_043                -7.812460e-03 3 1  ON 42
ci_044                -8.149227e-03 3 1  ON 43
ci_045                -6.924767e-03 3 1  ON 44
ci_046                 8.728813e-03 3 1  ON 45
ci_047                 8.895940e-03 3 1  ON 46
ci_048                -1.371973e-02 3 1  ON 47
ci_049                -1.333240e-02 3 1  ON 48
ci_050                 6.410915e-03 3 1  ON 49
ci_051                 6.171044e-03 3 1  ON 50
ci_052                -5.323083e-03 3 1  ON 51
ci_053                -5.259787e-03 3 1  ON 52
ci_054                -6.090075e-03 3 1  ON 53
ci_055                -6.250738e-03 3 1  ON 54
ci_056                 7.848343e-03 3 1  ON 55
ci_057                 7.750727e-03 3 1  ON 56
ci_058                -5.014019e-03 3 1  ON 57
ci_059                -5.166659e-03 3 1  ON 58
ci_060                 7.313116e-03 3 1  ON 59
ci_061                 7.320499e-03 3 1  ON 60
ci_062                -6.627541e-03 3 1  ON 61
ci_063                -6.513039e-03 3 1  ON 62
ci_064                -5.376620e-03 3 1  ON 63
ci_065                -6.000327e-03 3 1  ON 64
ci_066                 6.245086e-03 3 1  ON 65
ci_067                 6.359583e-03 3 1  ON 66
ci_068                -6.570902e-03 3 1  ON 67
ci_069                -6.397556e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2182
    reference variance = 0.256544
====================================================
  Execution time = 1.3597e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.0189e-01
  Total weights = 1.9561e+06
  Execution time = 1.8408e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288233704593
                                         uncertainty =       0.001826814790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288233704593
                                         uncertainty =       0.001826814790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379596581
  error estimate for blocks of size 2^( 2) =       0.000391864515
  error estimate for blocks of size 2^( 3) =       0.000402302877
  error estimate for blocks of size 2^( 4) =       0.000409443137
  error estimate for blocks of size 2^( 5) =       0.000413937849
  error estimate for blocks of size 2^( 6) =       0.000416943141
  error estimate for blocks of size 2^( 7) =       0.000416049196

      target function =      -0.898450333741
              le_mean =     -17.213192424656
             les_mean =     296.596085656665
             stat err =       0.000414093331
             autocorr =       1.190013502005
   target nu stat err =       0.000414093331
   target dn stat err =       0.002925686477
      target stat err =       0.003714097477
              std dev =       0.536830632446
             le_variance =       0.288187127932

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287518299092
                                         uncertainty =       0.001819510459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287518299092
                                         uncertainty =       0.001819510459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379125302
  error estimate for blocks of size 2^( 2) =       0.000391423420
  error estimate for blocks of size 2^( 3) =       0.000401896690
  error estimate for blocks of size 2^( 4) =       0.000409064891
  error estimate for blocks of size 2^( 5) =       0.000413568058
  error estimate for blocks of size 2^( 6) =       0.000416584306
  error estimate for blocks of size 2^( 7) =       0.000415679288

      target function =      -0.899325095663
              le_mean =     -17.213194389992
             les_mean =     296.595456863422
             stat err =       0.000413724135
             autocorr =       1.190847569184
   target nu stat err =       0.000413724135
   target dn stat err =       0.002911530758
      target stat err =       0.003703607263
              std dev =       0.536164144625
             le_variance =       0.287471989982

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287864604341
                                         uncertainty =       0.001823048108

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287864604341
                                         uncertainty =       0.001823048108

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379353507
  error estimate for blocks of size 2^( 2) =       0.000391636761
  error estimate for blocks of size 2^( 3) =       0.000402092872
  error estimate for blocks of size 2^( 4) =       0.000409247356
  error estimate for blocks of size 2^( 5) =       0.000413746383
  error estimate for blocks of size 2^( 6) =       0.000416757236
  error estimate for blocks of size 2^( 7) =       0.000415857607

      target function =      -0.898933023337
              le_mean =     -17.213193001084
             les_mean =     296.595720943780
             stat err =       0.000413902145
             autocorr =       1.190439008546
   target nu stat err =       0.000413902145
   target dn stat err =       0.002917969230
      target stat err =       0.003708432692
              std dev =       0.536486873906
             le_variance =       0.287818165873

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288186899726
                                         uncertainty =       0.001826337137

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288186899726
                                         uncertainty =       0.001826337137

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379565765
  error estimate for blocks of size 2^( 2) =       0.000391835613
  error estimate for blocks of size 2^( 3) =       0.000402276195
  error estimate for blocks of size 2^( 4) =       0.000409418238
  error estimate for blocks of size 2^( 5) =       0.000413913490
  error estimate for blocks of size 2^( 6) =       0.000416919480
  error estimate for blocks of size 2^( 7) =       0.000416024817

      target function =      -0.898514146701
              le_mean =     -17.213192446394
             les_mean =     296.596035532101
             stat err =       0.000414069006
             autocorr =       1.190066906410
   target nu stat err =       0.000414069006
   target dn stat err =       0.002924678100
      target stat err =       0.003713364217
              std dev =       0.536787053314
             le_variance =       0.288140340606


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.898450333741        initial
     2.5000e+00     2.5000e+01             2.3844e-04        -0.899325095663  <--
     1.0000e+01     1.0000e+02             6.0671e-05        -0.898933023337
     4.0000e+01     4.0000e+02             1.5235e-05        -0.898514146701

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.2868e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_001                -5.066180e-02 3 1  ON 0
ci_002                -3.937923e-02 3 1  ON 1
ci_003                -3.028466e-02 3 1  ON 2
ci_004                 2.877332e-02 3 1  ON 3
ci_005                 2.886769e-02 3 1  ON 4
ci_006                -2.640804e-02 3 1  ON 5
ci_007                -2.626222e-02 3 1  ON 6
ci_008                -1.504741e-02 3 1  ON 7
ci_009                -1.934254e-02 3 1  ON 8
ci_010                -1.590905e-02 3 1  ON 9
ci_011                -1.617753e-02 3 1  ON 10
ci_012                -1.618764e-02 3 1  ON 11
ci_013                -2.240251e-02 3 1  ON 12
ci_014                 1.712860e-02 3 1  ON 13
ci_015                 1.698240e-02 3 1  ON 14
ci_016                 1.952415e-02 3 1  ON 15
ci_017                 1.963567e-02 3 1  ON 16
ci_018                 1.498757e-02 3 1  ON 17
ci_019                 1.493322e-02 3 1  ON 18
ci_020                 2.043590e-02 3 1  ON 19
ci_021                 2.032597e-02 3 1  ON 20
ci_022                 1.366900e-02 3 1  ON 21
ci_023                 1.339455e-02 3 1  ON 22
ci_024                 1.412349e-02 3 1  ON 23
ci_025                 1.387261e-02 3 1  ON 24
ci_026                 1.464982e-02 3 1  ON 25
ci_027                 1.477395e-02 3 1  ON 26
ci_028                -1.720192e-02 3 1  ON 27
ci_029                -1.736726e-02 3 1  ON 28
ci_030                -1.252814e-02 3 1  ON 29
ci_031                -1.258953e-02 3 1  ON 30
ci_032                -1.566822e-02 3 1  ON 31
ci_033                 9.631651e-03 3 1  ON 32
ci_034                 9.717682e-03 3 1  ON 33
ci_035                -9.111298e-03 3 1  ON 34
ci_036                -1.481649e-02 3 1  ON 35
ci_037                -1.486776e-02 3 1  ON 36
ci_038                 6.458880e-03 3 1  ON 37
ci_039                 6.746059e-03 3 1  ON 38
ci_040                -7.004088e-03 3 1  ON 39
ci_041                 1.074122e-02 3 1  ON 40
ci_042                 1.118207e-02 3 1  ON 41
ci_043                -7.743679e-03 3 1  ON 42
ci_044                -8.095525e-03 3 1  ON 43
ci_045                -6.846906e-03 3 1  ON 44
ci_046                 8.663656e-03 3 1  ON 45
ci_047                 8.841110e-03 3 1  ON 46
ci_048                -1.368809e-02 3 1  ON 47
ci_049                -1.331255e-02 3 1  ON 48
ci_050                 6.344996e-03 3 1  ON 49
ci_051                 6.106855e-03 3 1  ON 50
ci_052                -5.286384e-03 3 1  ON 51
ci_053                -5.194744e-03 3 1  ON 52
ci_054                -6.021070e-03 3 1  ON 53
ci_055                -6.179852e-03 3 1  ON 54
ci_056                 7.806938e-03 3 1  ON 55
ci_057                 7.699337e-03 3 1  ON 56
ci_058                -4.923085e-03 3 1  ON 57
ci_059                -5.098478e-03 3 1  ON 58
ci_060                 7.274133e-03 3 1  ON 59
ci_061                 7.270980e-03 3 1  ON 60
ci_062                -6.574547e-03 3 1  ON 61
ci_063                -6.463487e-03 3 1  ON 62
ci_064                -5.319266e-03 3 1  ON 63
ci_065                -5.965722e-03 3 1  ON 64
ci_066                 6.207450e-03 3 1  ON 65
ci_067                 6.310077e-03 3 1  ON 66
ci_068                -6.554729e-03 3 1  ON 67
ci_069                -6.362001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9420e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.1725
    reference variance = 0.351699
====================================================
  Execution time = 1.3928e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.0465e-01
  Total weights = 1.955936163e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4740e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291158082002
                                         uncertainty =       0.002991004514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291158082002
                                         uncertainty =       0.002991004514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381510218
  error estimate for blocks of size 2^( 2) =       0.000393306056
  error estimate for blocks of size 2^( 3) =       0.000403899271
  error estimate for blocks of size 2^( 4) =       0.000411975393
  error estimate for blocks of size 2^( 5) =       0.000416721970
  error estimate for blocks of size 2^( 6) =       0.000419546309
  error estimate for blocks of size 2^( 7) =       0.000420088400

      target function =      -0.895304346603
              le_mean =     -17.213472522775
             les_mean =     296.608282953533
             stat err =       0.000417083018
             autocorr =       1.195178210746
   target nu stat err =       0.000417083018
   target dn stat err =       0.004065174292
      target stat err =       0.005097571780
              std dev =       0.539536924372
             le_variance =       0.291100092761


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721347252278e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.895332233023       residual = 2.86e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.896763431002       residual = 3.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.896991068866       residual = 8.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.897055488848       residual = 9.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.897064366050       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.897066141699       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.897066435686       residual = 9.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.897066477707       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.897066506647       residual = 2.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.897066509709       residual = 7.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.897066508079       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.897066501566       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 8.931489e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.895332233023       residual = 2.86e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.895721618621       residual = 3.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.895782273141       residual = 8.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.895798990069       residual = 9.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.895801257921       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.895801697781       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.895801769844       residual = 8.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.895801779014       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.895801786145       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.895801787019       residual = 5.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.895801786618       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.895801785048       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 2.389355e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.895332233023       residual = 2.86e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.895431772495       residual = 3.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.895447186876       residual = 8.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.895451403962       residual = 9.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.895451973612       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.895452083172       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.895452101072       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.895452103276       residual = 1.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.895452105047       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.895452105274       residual = 5.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.895452105174       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.895452104786       residual = 2.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 6.079709e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.102002 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6412e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_001                -5.042286e-02 3 1  ON 0
ci_002                -3.921110e-02 3 1  ON 1
ci_003                -3.021837e-02 3 1  ON 2
ci_004                 2.866960e-02 3 1  ON 3
ci_005                 2.874235e-02 3 1  ON 4
ci_006                -2.626186e-02 3 1  ON 5
ci_007                -2.613819e-02 3 1  ON 6
ci_008                -1.484734e-02 3 1  ON 7
ci_009                -1.919860e-02 3 1  ON 8
ci_010                -1.574094e-02 3 1  ON 9
ci_011                -1.600165e-02 3 1  ON 10
ci_012                -1.606078e-02 3 1  ON 11
ci_013                -2.234857e-02 3 1  ON 12
ci_014                 1.700524e-02 3 1  ON 13
ci_015                 1.686124e-02 3 1  ON 14
ci_016                 1.946470e-02 3 1  ON 15
ci_017                 1.953729e-02 3 1  ON 16
ci_018                 1.486384e-02 3 1  ON 17
ci_019                 1.478472e-02 3 1  ON 18
ci_020                 2.035291e-02 3 1  ON 19
ci_021                 2.028591e-02 3 1  ON 20
ci_022                 1.355307e-02 3 1  ON 21
ci_023                 1.330574e-02 3 1  ON 22
ci_024                 1.395793e-02 3 1  ON 23
ci_025                 1.380637e-02 3 1  ON 24
ci_026                 1.455467e-02 3 1  ON 25
ci_027                 1.468650e-02 3 1  ON 26
ci_028                -1.716700e-02 3 1  ON 27
ci_029                -1.729548e-02 3 1  ON 28
ci_030                -1.243073e-02 3 1  ON 29
ci_031                -1.248350e-02 3 1  ON 30
ci_032                -1.562521e-02 3 1  ON 31
ci_033                 9.493852e-03 3 1  ON 32
ci_034                 9.596431e-03 3 1  ON 33
ci_035                -9.008478e-03 3 1  ON 34
ci_036                -1.477859e-02 3 1  ON 35
ci_037                -1.483341e-02 3 1  ON 36
ci_038                 6.328419e-03 3 1  ON 37
ci_039                 6.604532e-03 3 1  ON 38
ci_040                -6.901887e-03 3 1  ON 39
ci_041                 1.067412e-02 3 1  ON 40
ci_042                 1.113996e-02 3 1  ON 41
ci_043                -7.636980e-03 3 1  ON 42
ci_044                -8.025274e-03 3 1  ON 43
ci_045                -6.735734e-03 3 1  ON 44
ci_046                 8.576578e-03 3 1  ON 45
ci_047                 8.754171e-03 3 1  ON 46
ci_048                -1.366309e-02 3 1  ON 47
ci_049                -1.329191e-02 3 1  ON 48
ci_050                 6.258291e-03 3 1  ON 49
ci_051                 6.006386e-03 3 1  ON 50
ci_052                -5.172719e-03 3 1  ON 51
ci_053                -5.126146e-03 3 1  ON 52
ci_054                -5.943629e-03 3 1  ON 53
ci_055                -6.112619e-03 3 1  ON 54
ci_056                 7.748269e-03 3 1  ON 55
ci_057                 7.637305e-03 3 1  ON 56
ci_058                -4.821742e-03 3 1  ON 57
ci_059                -4.981370e-03 3 1  ON 58
ci_060                 7.216257e-03 3 1  ON 59
ci_061                 7.221881e-03 3 1  ON 60
ci_062                -6.512345e-03 3 1  ON 61
ci_063                -6.368659e-03 3 1  ON 62
ci_064                -5.254381e-03 3 1  ON 63
ci_065                -5.909119e-03 3 1  ON 64
ci_066                 6.141161e-03 3 1  ON 65
ci_067                 6.283223e-03 3 1  ON 66
ci_068                -6.515265e-03 3 1  ON 67
ci_069                -6.336583e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2345
    reference variance = 0.322884
====================================================
  Execution time = 1.3788e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.0454e-01
  Total weights = 1.9556e+06
  Execution time = 1.8339e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290977798244
                                         uncertainty =       0.001812777588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290977798244
                                         uncertainty =       0.001812777588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381404321
  error estimate for blocks of size 2^( 2) =       0.000393574920
  error estimate for blocks of size 2^( 3) =       0.000404034913
  error estimate for blocks of size 2^( 4) =       0.000411628952
  error estimate for blocks of size 2^( 5) =       0.000416115278
  error estimate for blocks of size 2^( 6) =       0.000419224800
  error estimate for blocks of size 2^( 7) =       0.000421043154

      target function =      -0.894168754632
              le_mean =     -17.212912217795
             les_mean =     296.589825290836
             stat err =       0.000417003046
             autocorr =       1.195383445428
   target nu stat err =       0.000417003046
   target dn stat err =       0.002564238123
      target stat err =       0.003235840066
              std dev =       0.539387163291
             le_variance =       0.290938511924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288393078179
                                         uncertainty =       0.001781703247

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288393078179
                                         uncertainty =       0.001781703247

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379705401
  error estimate for blocks of size 2^( 2) =       0.000392011219
  error estimate for blocks of size 2^( 3) =       0.000402620518
  error estimate for blocks of size 2^( 4) =       0.000410337635
  error estimate for blocks of size 2^( 5) =       0.000414885447
  error estimate for blocks of size 2^( 6) =       0.000418042521
  error estimate for blocks of size 2^( 7) =       0.000419770282

      target function =      -0.896885939492
              le_mean =     -17.212942259768
             les_mean =     296.588682890550
             stat err =       0.000415758971
             autocorr =       1.198918634108
   target nu stat err =       0.000415758971
   target dn stat err =       0.002535026689
      target stat err =       0.003219162187
              std dev =       0.536984527201
             le_variance =       0.288352382453

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289521968637
                                         uncertainty =       0.001794454927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289521968637
                                         uncertainty =       0.001794454927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380448375
  error estimate for blocks of size 2^( 2) =       0.000392690585
  error estimate for blocks of size 2^( 3) =       0.000403230430
  error estimate for blocks of size 2^( 4) =       0.000410890649
  error estimate for blocks of size 2^( 5) =       0.000415408967
  error estimate for blocks of size 2^( 6) =       0.000418544225
  error estimate for blocks of size 2^( 7) =       0.000420311064

      target function =      -0.893261676253
              le_mean =     -17.212922494860
             les_mean =     296.590905297628
             stat err =       0.000416288726
             autocorr =       1.197285804725
   target nu stat err =       0.000416288726
   target dn stat err =       0.003392468962
      target stat err =       0.004242945179
              std dev =       0.538035251290
             le_variance =       0.289481931631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290784685845
                                         uncertainty =       0.001810204610

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290784685845
                                         uncertainty =       0.001810204610

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381277659
  error estimate for blocks of size 2^( 2) =       0.000393457194
  error estimate for blocks of size 2^( 3) =       0.000403927238
  error estimate for blocks of size 2^( 4) =       0.000411529657
  error estimate for blocks of size 2^( 5) =       0.000416019903
  error estimate for blocks of size 2^( 6) =       0.000419132725
  error estimate for blocks of size 2^( 7) =       0.000420944041

      target function =      -0.894506940786
              le_mean =     -17.212912692280
             les_mean =     296.589569494054
             stat err =       0.000416906582
             autocorr =       1.195624446666
   target nu stat err =       0.000416906582
   target dn stat err =       0.002551268774
      target stat err =       0.003222373915
              std dev =       0.539208035956
             le_variance =       0.290745306039


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.894168754632        initial
     6.2500e-01     6.2500e+00             8.9315e-04        -0.896885939492  <--
     2.5000e+00     2.5000e+01             2.3894e-04        -0.893261676253
     1.0000e+01     1.0000e+02             6.0797e-05        -0.894506940786

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.3051e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_001                -4.976865e-02 3 1  ON 0
ci_002                -3.875410e-02 3 1  ON 1
ci_003                -3.003553e-02 3 1  ON 2
ci_004                 2.838543e-02 3 1  ON 3
ci_005                 2.839919e-02 3 1  ON 4
ci_006                -2.586390e-02 3 1  ON 5
ci_007                -2.580142e-02 3 1  ON 6
ci_008                -1.431451e-02 3 1  ON 7
ci_009                -1.881108e-02 3 1  ON 8
ci_010                -1.528674e-02 3 1  ON 9
ci_011                -1.552710e-02 3 1  ON 10
ci_012                -1.571882e-02 3 1  ON 11
ci_013                -2.220050e-02 3 1  ON 12
ci_014                 1.667356e-02 3 1  ON 13
ci_015                 1.653473e-02 3 1  ON 14
ci_016                 1.930614e-02 3 1  ON 15
ci_017                 1.927161e-02 3 1  ON 16
ci_018                 1.453227e-02 3 1  ON 17
ci_019                 1.438594e-02 3 1  ON 18
ci_020                 2.012445e-02 3 1  ON 19
ci_021                 2.017520e-02 3 1  ON 20
ci_022                 1.324081e-02 3 1  ON 21
ci_023                 1.306794e-02 3 1  ON 22
ci_024                 1.350404e-02 3 1  ON 23
ci_025                 1.362348e-02 3 1  ON 24
ci_026                 1.429825e-02 3 1  ON 25
ci_027                 1.444988e-02 3 1  ON 26
ci_028                -1.707334e-02 3 1  ON 27
ci_029                -1.710166e-02 3 1  ON 28
ci_030                -1.216950e-02 3 1  ON 29
ci_031                -1.219952e-02 3 1  ON 30
ci_032                -1.550900e-02 3 1  ON 31
ci_033                 9.120121e-03 3 1  ON 32
ci_034                 9.266548e-03 3 1  ON 33
ci_035                -8.732696e-03 3 1  ON 34
ci_036                -1.467375e-02 3 1  ON 35
ci_037                -1.473849e-02 3 1  ON 36
ci_038                 5.978897e-03 3 1  ON 37
ci_039                 6.225453e-03 3 1  ON 38
ci_040                -6.628881e-03 3 1  ON 39
ci_041                 1.049510e-02 3 1  ON 40
ci_042                 1.102700e-02 3 1  ON 41
ci_043                -7.350551e-03 3 1  ON 42
ci_044                -7.836113e-03 3 1  ON 43
ci_045                -6.438459e-03 3 1  ON 44
ci_046                 8.340912e-03 3 1  ON 45
ci_047                 8.518868e-03 3 1  ON 46
ci_048                -1.359636e-02 3 1  ON 47
ci_049                -1.323659e-02 3 1  ON 48
ci_050                 6.027795e-03 3 1  ON 49
ci_051                 5.739649e-03 3 1  ON 50
ci_052                -4.870169e-03 3 1  ON 51
ci_053                -4.944477e-03 3 1  ON 52
ci_054                -5.733968e-03 3 1  ON 53
ci_055                -5.930462e-03 3 1  ON 54
ci_056                 7.590598e-03 3 1  ON 55
ci_057                 7.470496e-03 3 1  ON 56
ci_058                -4.552551e-03 3 1  ON 57
ci_059                -4.670226e-03 3 1  ON 58
ci_060                 7.059425e-03 3 1  ON 59
ci_061                 7.088875e-03 3 1  ON 60
ci_062                -6.342556e-03 3 1  ON 61
ci_063                -6.112200e-03 3 1  ON 62
ci_064                -5.081365e-03 3 1  ON 63
ci_065                -5.757817e-03 3 1  ON 64
ci_066                 5.964382e-03 3 1  ON 65
ci_067                 6.212068e-03 3 1  ON 66
ci_068                -6.409603e-03 3 1  ON 67
ci_069                -6.269219e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9469e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2615
    reference variance = 0.204614
====================================================
  Execution time = 1.4250e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5303e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.0204e-01
  Total weights = 1.956278965e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4988e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283953718676
                                         uncertainty =       0.001799666141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283953718676
                                         uncertainty =       0.001799666141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376817599
  error estimate for blocks of size 2^( 2) =       0.000389087114
  error estimate for blocks of size 2^( 3) =       0.000399692166
  error estimate for blocks of size 2^( 4) =       0.000407425622
  error estimate for blocks of size 2^( 5) =       0.000411814457
  error estimate for blocks of size 2^( 6) =       0.000415145089
  error estimate for blocks of size 2^( 7) =       0.000416758119

      target function =      -0.898378103338
              le_mean =     -17.212699068943
             les_mean =     296.579051211969
             stat err =       0.000412785822
             autocorr =       1.200016421088
   target nu stat err =       0.000412785822
   target dn stat err =       0.004903101716
      target stat err =       0.006169960330
              std dev =       0.532900558362
             le_variance =       0.283983005103


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721269906894e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.898419661138       residual = 2.19e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901769686695       residual = 3.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902365548406       residual = 7.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902513702044       residual = 9.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902535457090       residual = 2.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902540686485       residual = 5.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902541959798       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902542901184       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902542765214       residual = 3.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902542725434       residual = 7.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.902542753304       residual = 2.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.902542757041       residual = 5.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 2.389408e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.898419661138       residual = 2.19e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.899530842674       residual = 2.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.899718802549       residual = 6.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.899761973872       residual = 8.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.899768008241       residual = 2.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.899769437990       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.899769757762       residual = 9.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.899770013808       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.899769973057       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.899769963847       residual = 4.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.899769970443       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.899769971637       residual = 2.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 7.535306e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.898419661138       residual = 2.19e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.898722074144       residual = 2.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.898772275891       residual = 6.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898783477946       residual = 7.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898785016770       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898785381241       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898785460109       residual = 8.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898785524677       residual = 1.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898785514063       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898785511868       residual = 3.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.898785513470       residual = 9.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 2.014923e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.106513 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6759e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_001                -4.901512e-02 3 1  ON 0
ci_002                -3.824252e-02 3 1  ON 1
ci_003                -2.977477e-02 3 1  ON 2
ci_004                 2.808904e-02 3 1  ON 3
ci_005                 2.802723e-02 3 1  ON 4
ci_006                -2.551187e-02 3 1  ON 5
ci_007                -2.543474e-02 3 1  ON 6
ci_008                -1.368519e-02 3 1  ON 7
ci_009                -1.838184e-02 3 1  ON 8
ci_010                -1.463029e-02 3 1  ON 9
ci_011                -1.494776e-02 3 1  ON 10
ci_012                -1.519982e-02 3 1  ON 11
ci_013                -2.206970e-02 3 1  ON 12
ci_014                 1.623394e-02 3 1  ON 13
ci_015                 1.607490e-02 3 1  ON 14
ci_016                 1.907873e-02 3 1  ON 15
ci_017                 1.891409e-02 3 1  ON 16
ci_018                 1.422733e-02 3 1  ON 17
ci_019                 1.403827e-02 3 1  ON 18
ci_020                 1.993803e-02 3 1  ON 19
ci_021                 1.979758e-02 3 1  ON 20
ci_022                 1.290824e-02 3 1  ON 21
ci_023                 1.277217e-02 3 1  ON 22
ci_024                 1.310895e-02 3 1  ON 23
ci_025                 1.331013e-02 3 1  ON 24
ci_026                 1.418134e-02 3 1  ON 25
ci_027                 1.413279e-02 3 1  ON 26
ci_028                -1.686762e-02 3 1  ON 27
ci_029                -1.698096e-02 3 1  ON 28
ci_030                -1.180038e-02 3 1  ON 29
ci_031                -1.178308e-02 3 1  ON 30
ci_032                -1.546762e-02 3 1  ON 31
ci_033                 8.748194e-03 3 1  ON 32
ci_034                 8.931177e-03 3 1  ON 33
ci_035                -8.495184e-03 3 1  ON 34
ci_036                -1.455080e-02 3 1  ON 35
ci_037                -1.464908e-02 3 1  ON 36
ci_038                 5.616118e-03 3 1  ON 37
ci_039                 5.794546e-03 3 1  ON 38
ci_040                -6.178433e-03 3 1  ON 39
ci_041                 1.020055e-02 3 1  ON 40
ci_042                 1.081855e-02 3 1  ON 41
ci_043                -7.039557e-03 3 1  ON 42
ci_044                -7.343094e-03 3 1  ON 43
ci_045                -6.050889e-03 3 1  ON 44
ci_046                 8.122018e-03 3 1  ON 45
ci_047                 8.188023e-03 3 1  ON 46
ci_048                -1.361106e-02 3 1  ON 47
ci_049                -1.327124e-02 3 1  ON 48
ci_050                 5.781278e-03 3 1  ON 49
ci_051                 5.537954e-03 3 1  ON 50
ci_052                -4.610935e-03 3 1  ON 51
ci_053                -4.621264e-03 3 1  ON 52
ci_054                -5.468151e-03 3 1  ON 53
ci_055                -5.630394e-03 3 1  ON 54
ci_056                 7.319085e-03 3 1  ON 55
ci_057                 7.319830e-03 3 1  ON 56
ci_058                -4.240685e-03 3 1  ON 57
ci_059                -4.297281e-03 3 1  ON 58
ci_060                 6.883381e-03 3 1  ON 59
ci_061                 6.932417e-03 3 1  ON 60
ci_062                -6.135569e-03 3 1  ON 61
ci_063                -5.864569e-03 3 1  ON 62
ci_064                -4.870699e-03 3 1  ON 63
ci_065                -5.534023e-03 3 1  ON 64
ci_066                 5.790090e-03 3 1  ON 65
ci_067                 6.084432e-03 3 1  ON 66
ci_068                -6.198511e-03 3 1  ON 67
ci_069                -6.064661e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.218
    reference variance = 0.333114
====================================================
  Execution time = 1.3753e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.9574e-01
  Total weights = 1.9561e+06
  Execution time = 1.8390e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284287701644
                                         uncertainty =       0.001719529678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284287701644
                                         uncertainty =       0.001719529678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376966883
  error estimate for blocks of size 2^( 2) =       0.000389121365
  error estimate for blocks of size 2^( 3) =       0.000400172406
  error estimate for blocks of size 2^( 4) =       0.000407879407
  error estimate for blocks of size 2^( 5) =       0.000413219395
  error estimate for blocks of size 2^( 6) =       0.000416262295
  error estimate for blocks of size 2^( 7) =       0.000416525352

      target function =      -0.902090735616
              le_mean =     -17.213070185636
             les_mean =     296.588965118391
             stat err =       0.000413471612
             autocorr =       1.203053659056
   target nu stat err =       0.000413471612
   target dn stat err =       0.002801614167
      target stat err =       0.003588191102
              std dev =       0.533111677886
             le_variance =       0.284208061099

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279047458241
                                         uncertainty =       0.001675291748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279047458241
                                         uncertainty =       0.001675291748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373477375
  error estimate for blocks of size 2^( 2) =       0.000386037440
  error estimate for blocks of size 2^( 3) =       0.000397441663
  error estimate for blocks of size 2^( 4) =       0.000405456854
  error estimate for blocks of size 2^( 5) =       0.000411005021
  error estimate for blocks of size 2^( 6) =       0.000414177237
  error estimate for blocks of size 2^( 7) =       0.000414576734

      target function =      -0.898593516030
              le_mean =     -17.213159910560
             les_mean =     296.594800765142
             stat err =       0.000411303961
             autocorr =       1.212822341893
   target nu stat err =       0.000411303961
   target dn stat err =       0.006429564178
      target stat err =       0.008085851334
              std dev =       0.528176769462
             le_variance =       0.278970699799

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280566899082
                                         uncertainty =       0.001662541827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280566899082
                                         uncertainty =       0.001662541827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374492704
  error estimate for blocks of size 2^( 2) =       0.000386919892
  error estimate for blocks of size 2^( 3) =       0.000398197314
  error estimate for blocks of size 2^( 4) =       0.000406096948
  error estimate for blocks of size 2^( 5) =       0.000411569214
  error estimate for blocks of size 2^( 6) =       0.000414667412
  error estimate for blocks of size 2^( 7) =       0.000415052468

      target function =      -0.640837239914
              le_mean =     -17.213096261975
             les_mean =     296.837144425703
             stat err =       0.000411846511
             autocorr =       1.209439249719
   target nu stat err =       0.000411846511
   target dn stat err =       0.204978366396
      target stat err =       0.136695995541
              std dev =       0.529612661704
             le_variance =       0.280489571437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283691504869
                                         uncertainty =       0.001710078591

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283691504869
                                         uncertainty =       0.001710078591

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376571542
  error estimate for blocks of size 2^( 2) =       0.000388759463
  error estimate for blocks of size 2^( 3) =       0.000399838398
  error estimate for blocks of size 2^( 4) =       0.000407573008
  error estimate for blocks of size 2^( 5) =       0.000412930694
  error estimate for blocks of size 2^( 6) =       0.000415983466
  error estimate for blocks of size 2^( 7) =       0.000416261077

      target function =      -0.904218416886
              le_mean =     -17.213062746638
             les_mean =     296.587030122049
             stat err =       0.000413187062
             autocorr =       1.203922228473
   target nu stat err =       0.000413187062
   target dn stat err =       0.002550562538
      target stat err =       0.003290547219
              std dev =       0.532552582447
             le_variance =       0.283612253071


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.902090735616        initial
     1.5625e-01     1.5625e+00             2.3894e-03        -0.898593516030
     6.2500e-01     6.2500e+00             7.5353e-04        -0.640837239914
     2.5000e+00     2.5000e+01             2.0149e-04        -0.904218416886  <--

*****************************************************************************
Applying the update for shift_i =   2.5000e+00     and shift_s =   2.5000e+01
*****************************************************************************

  Execution time = 2.3022e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_001                -4.956715e-02 3 1  ON 0
ci_002                -3.861641e-02 3 1  ON 1
ci_003                -2.996602e-02 3 1  ON 2
ci_004                 2.830567e-02 3 1  ON 3
ci_005                 2.829983e-02 3 1  ON 4
ci_006                -2.576910e-02 3 1  ON 5
ci_007                -2.570272e-02 3 1  ON 6
ci_008                -1.414266e-02 3 1  ON 7
ci_009                -1.869471e-02 3 1  ON 8
ci_010                -1.510940e-02 3 1  ON 9
ci_011                -1.537020e-02 3 1  ON 10
ci_012                -1.557832e-02 3 1  ON 11
ci_013                -2.216555e-02 3 1  ON 12
ci_014                 1.655455e-02 3 1  ON 13
ci_015                 1.641037e-02 3 1  ON 14
ci_016                 1.924448e-02 3 1  ON 15
ci_017                 1.917510e-02 3 1  ON 16
ci_018                 1.444990e-02 3 1  ON 17
ci_019                 1.429153e-02 3 1  ON 18
ci_020                 2.007464e-02 3 1  ON 19
ci_021                 2.007405e-02 3 1  ON 20
ci_022                 1.315048e-02 3 1  ON 21
ci_023                 1.298768e-02 3 1  ON 22
ci_024                 1.339818e-02 3 1  ON 23
ci_025                 1.353974e-02 3 1  ON 24
ci_026                 1.426683e-02 3 1  ON 25
ci_027                 1.436419e-02 3 1  ON 26
ci_028                -1.701807e-02 3 1  ON 27
ci_029                -1.706904e-02 3 1  ON 28
ci_030                -1.206906e-02 3 1  ON 29
ci_031                -1.208617e-02 3 1  ON 30
ci_032                -1.549776e-02 3 1  ON 31
ci_033                 9.020010e-03 3 1  ON 32
ci_034                 9.176328e-03 3 1  ON 33
ci_035                -8.668111e-03 3 1  ON 34
ci_036                -1.464112e-02 3 1  ON 35
ci_037                -1.471490e-02 3 1  ON 36
ci_038                 5.880257e-03 3 1  ON 37
ci_039                 6.108313e-03 3 1  ON 38
ci_040                -6.506106e-03 3 1  ON 39
ci_041                 1.041497e-02 3 1  ON 40
ci_042                 1.097029e-02 3 1  ON 41
ci_043                -7.266102e-03 3 1  ON 42
ci_044                -7.702827e-03 3 1  ON 43
ci_045                -6.332933e-03 3 1  ON 44
ci_046                 8.281842e-03 3 1  ON 45
ci_047                 8.429685e-03 3 1  ON 46
ci_048                -1.359992e-02 3 1  ON 47
ci_049                -1.324577e-02 3 1  ON 48
ci_050                 5.960398e-03 3 1  ON 49
ci_051                 5.684582e-03 3 1  ON 50
ci_052                -4.799298e-03 3 1  ON 51
ci_053                -4.856090e-03 3 1  ON 52
ci_054                -5.662441e-03 3 1  ON 53
ci_055                -5.849559e-03 3 1  ON 54
ci_056                 7.516872e-03 3 1  ON 55
ci_057                 7.429641e-03 3 1  ON 56
ci_058                -4.467027e-03 3 1  ON 57
ci_059                -4.568147e-03 3 1  ON 58
ci_060                 7.011946e-03 3 1  ON 59
ci_061                 7.046726e-03 3 1  ON 60
ci_062                -6.286925e-03 3 1  ON 61
ci_063                -6.045439e-03 3 1  ON 62
ci_064                -5.023906e-03 3 1  ON 63
ci_065                -5.696878e-03 3 1  ON 64
ci_066                 5.916893e-03 3 1  ON 65
ci_067                 6.177246e-03 3 1  ON 66
ci_068                -6.352302e-03 3 1  ON 67
ci_069                -6.213741e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9806e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2175
    reference variance = 0.244551
====================================================
  Execution time = 1.4231e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.0301e-01
  Total weights = 1.956179747e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4758e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287014856394
                                         uncertainty =       0.001918814857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287014856394
                                         uncertainty =       0.001918814857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378808188
  error estimate for blocks of size 2^( 2) =       0.000390585944
  error estimate for blocks of size 2^( 3) =       0.000400918309
  error estimate for blocks of size 2^( 4) =       0.000408636469
  error estimate for blocks of size 2^( 5) =       0.000412357109
  error estimate for blocks of size 2^( 6) =       0.000413924263
  error estimate for blocks of size 2^( 7) =       0.000414293386

      target function =      -0.897150898431
              le_mean =     -17.212586258651
             les_mean =     296.576135613668
             stat err =       0.000412302807
             autocorr =       1.184660386525
   target nu stat err =       0.000412302807
   target dn stat err =       0.004400894963
      target stat err =       0.005527662799
              std dev =       0.535715677340
             le_variance =       0.286991286948


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721258625865e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.897184016421       residual = 2.43e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.898339501172       residual = 2.99e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.898522958144       residual = 7.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.898566128012       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.898570485234       residual = 2.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.898571710033       residual = 6.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.898572078320       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.898572250753       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.898572209154       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.898572201509       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.898572205176       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.898572209484       residual = 5.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 7.786705e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.897184016421       residual = 2.43e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.897498688091       residual = 2.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.897547638917       residual = 6.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.897558813589       residual = 9.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.897559915383       residual = 2.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.897560217405       residual = 5.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.897560305489       residual = 9.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.897560348161       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.897560337374       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.897560335272       residual = 8.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.897560336196       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.897560337209       residual = 3.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 2.083042e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.897184016421       residual = 2.43e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.897264478519       residual = 2.91e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.897276923558       residual = 6.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.897279740499       residual = 9.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.897280016452       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.897280091559       residual = 5.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.897280113278       residual = 9.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.897280123903       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.897280121184       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.897280120646       residual = 7.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.897280120878       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.897280121126       residual = 3.51e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 5.300293e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.111324 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6717e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_001                -4.935885e-02 3 1  ON 0
ci_002                -3.849349e-02 3 1  ON 1
ci_003                -2.991203e-02 3 1  ON 2
ci_004                 2.820625e-02 3 1  ON 3
ci_005                 2.819165e-02 3 1  ON 4
ci_006                -2.564275e-02 3 1  ON 5
ci_007                -2.563095e-02 3 1  ON 6
ci_008                -1.396464e-02 3 1  ON 7
ci_009                -1.854663e-02 3 1  ON 8
ci_010                -1.495642e-02 3 1  ON 9
ci_011                -1.523480e-02 3 1  ON 10
ci_012                -1.545539e-02 3 1  ON 11
ci_013                -2.210939e-02 3 1  ON 12
ci_014                 1.641728e-02 3 1  ON 13
ci_015                 1.630068e-02 3 1  ON 14
ci_016                 1.916692e-02 3 1  ON 15
ci_017                 1.913102e-02 3 1  ON 16
ci_018                 1.432938e-02 3 1  ON 17
ci_019                 1.424137e-02 3 1  ON 18
ci_020                 2.003530e-02 3 1  ON 19
ci_021                 2.002204e-02 3 1  ON 20
ci_022                 1.302841e-02 3 1  ON 21
ci_023                 1.291852e-02 3 1  ON 22
ci_024                 1.330550e-02 3 1  ON 23
ci_025                 1.344123e-02 3 1  ON 24
ci_026                 1.419858e-02 3 1  ON 25
ci_027                 1.425791e-02 3 1  ON 26
ci_028                -1.697160e-02 3 1  ON 27
ci_029                -1.702935e-02 3 1  ON 28
ci_030                -1.200326e-02 3 1  ON 29
ci_031                -1.202213e-02 3 1  ON 30
ci_032                -1.543716e-02 3 1  ON 31
ci_033                 8.919753e-03 3 1  ON 32
ci_034                 9.068967e-03 3 1  ON 33
ci_035                -8.578735e-03 3 1  ON 34
ci_036                -1.459592e-02 3 1  ON 35
ci_037                -1.468719e-02 3 1  ON 36
ci_038                 5.773858e-03 3 1  ON 37
ci_039                 5.983611e-03 3 1  ON 38
ci_040                -6.410302e-03 3 1  ON 39
ci_041                 1.032090e-02 3 1  ON 40
ci_042                 1.090485e-02 3 1  ON 41
ci_043                -7.174693e-03 3 1  ON 42
ci_044                -7.622291e-03 3 1  ON 43
ci_045                -6.238501e-03 3 1  ON 44
ci_046                 8.224435e-03 3 1  ON 45
ci_047                 8.337830e-03 3 1  ON 46
ci_048                -1.357723e-02 3 1  ON 47
ci_049                -1.323884e-02 3 1  ON 48
ci_050                 5.838156e-03 3 1  ON 49
ci_051                 5.644344e-03 3 1  ON 50
ci_052                -4.704084e-03 3 1  ON 51
ci_053                -4.774960e-03 3 1  ON 52
ci_054                -5.561162e-03 3 1  ON 53
ci_055                -5.800676e-03 3 1  ON 54
ci_056                 7.445346e-03 3 1  ON 55
ci_057                 7.394693e-03 3 1  ON 56
ci_058                -4.411647e-03 3 1  ON 57
ci_059                -4.454756e-03 3 1  ON 58
ci_060                 6.973446e-03 3 1  ON 59
ci_061                 7.092037e-03 3 1  ON 60
ci_062                -6.225500e-03 3 1  ON 61
ci_063                -6.010201e-03 3 1  ON 62
ci_064                -4.980972e-03 3 1  ON 63
ci_065                -5.648596e-03 3 1  ON 64
ci_066                 5.867155e-03 3 1  ON 65
ci_067                 6.123313e-03 3 1  ON 66
ci_068                -6.353030e-03 3 1  ON 67
ci_069                -6.170619e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.266
    reference variance = 0.289527
====================================================
  Execution time = 1.3549e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9877e-01
  Total weights = 1.9560e+06
  Execution time = 1.8321e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285157429860
                                         uncertainty =       0.001740795339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285157429860
                                         uncertainty =       0.001740795339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377620877
  error estimate for blocks of size 2^( 2) =       0.000389406139
  error estimate for blocks of size 2^( 3) =       0.000400197447
  error estimate for blocks of size 2^( 4) =       0.000408021315
  error estimate for blocks of size 2^( 5) =       0.000412676259
  error estimate for blocks of size 2^( 6) =       0.000416633736
  error estimate for blocks of size 2^( 7) =       0.000418759009

      target function =      -0.901427478053
              le_mean =     -17.212362491528
             les_mean =     296.564999004839
             stat err =       0.000414022580
             autocorr =       1.202087444433
   target nu stat err =       0.000414022580
   target dn stat err =       0.003034811429
      target stat err =       0.003869599895
              std dev =       0.534036565550
             le_variance =       0.285195053344

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283200053593
                                         uncertainty =       0.001707933121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283200053593
                                         uncertainty =       0.001707933121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376322273
  error estimate for blocks of size 2^( 2) =       0.000388240213
  error estimate for blocks of size 2^( 3) =       0.000399169594
  error estimate for blocks of size 2^( 4) =       0.000407108623
  error estimate for blocks of size 2^( 5) =       0.000411813098
  error estimate for blocks of size 2^( 6) =       0.000415758618
  error estimate for blocks of size 2^( 7) =       0.000417889419

      target function =      -0.904072441216
              le_mean =     -17.212372967065
             les_mean =     296.563270312419
             stat err =       0.000413142439
             autocorr =       1.205257302389
   target nu stat err =       0.000413142439
   target dn stat err =       0.002951721183
      target stat err =       0.003787799561
              std dev =       0.532200062805
             le_variance =       0.283236906849

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284056606393
                                         uncertainty =       0.001722122135

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284056606393
                                         uncertainty =       0.001722122135

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376891109
  error estimate for blocks of size 2^( 2) =       0.000388747277
  error estimate for blocks of size 2^( 3) =       0.000399612477
  error estimate for blocks of size 2^( 4) =       0.000407498331
  error estimate for blocks of size 2^( 5) =       0.000412179561
  error estimate for blocks of size 2^( 6) =       0.000416130455
  error estimate for blocks of size 2^( 7) =       0.000418258684

      target function =      -0.903219060806
              le_mean =     -17.212363443887
             les_mean =     296.563614109230
             stat err =       0.000413516758
             autocorr =       1.203800290366
   target nu stat err =       0.000413516758
   target dn stat err =       0.002978964268
      target stat err =       0.003814840033
              std dev =       0.533004517511
             le_variance =       0.284093815688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285011681620
                                         uncertainty =       0.001738308979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285011681620
                                         uncertainty =       0.001738308979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377524339
  error estimate for blocks of size 2^( 2) =       0.000389318501
  error estimate for blocks of size 2^( 3) =       0.000400119095
  error estimate for blocks of size 2^( 4) =       0.000407950898
  error estimate for blocks of size 2^( 5) =       0.000412609123
  error estimate for blocks of size 2^( 6) =       0.000416565706
  error estimate for blocks of size 2^( 7) =       0.000418691394

      target function =      -0.901793640926
              le_mean =     -17.212362001301
             les_mean =     296.564691791583
             stat err =       0.000413954280
             autocorr =       1.202305525563
   target nu stat err =       0.000413954280
   target dn stat err =       0.003024385755
      target stat err =       0.003859685358
              std dev =       0.533900040544
             le_variance =       0.285049253293


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.901427478053        initial
     6.2500e-01     6.2500e+00             7.7867e-04        -0.904072441216  <--
     2.5000e+00     2.5000e+01             2.0830e-04        -0.903219060806
     1.0000e+01     1.0000e+02             5.3003e-05        -0.901793640926

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.2818e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_001                -4.878848e-02 3 1  ON 0
ci_002                -3.815911e-02 3 1  ON 1
ci_003                -2.976263e-02 3 1  ON 2
ci_004                 2.793388e-02 3 1  ON 3
ci_005                 2.789494e-02 3 1  ON 4
ci_006                -2.529899e-02 3 1  ON 5
ci_007                -2.543624e-02 3 1  ON 6
ci_008                -1.349110e-02 3 1  ON 7
ci_009                -1.814872e-02 3 1  ON 8
ci_010                -1.454324e-02 3 1  ON 9
ci_011                -1.486946e-02 3 1  ON 10
ci_012                -1.512359e-02 3 1  ON 11
ci_013                -2.195543e-02 3 1  ON 12
ci_014                 1.604773e-02 3 1  ON 13
ci_015                 1.600433e-02 3 1  ON 14
ci_016                 1.895768e-02 3 1  ON 15
ci_017                 1.901355e-02 3 1  ON 16
ci_018                 1.400620e-02 3 1  ON 17
ci_019                 1.410685e-02 3 1  ON 18
ci_020                 1.992829e-02 3 1  ON 19
ci_021                 1.987788e-02 3 1  ON 20
ci_022                 1.269989e-02 3 1  ON 21
ci_023                 1.273299e-02 3 1  ON 22
ci_024                 1.305170e-02 3 1  ON 23
ci_025                 1.317169e-02 3 1  ON 24
ci_026                 1.401408e-02 3 1  ON 25
ci_027                 1.397115e-02 3 1  ON 26
ci_028                -1.684482e-02 3 1  ON 27
ci_029                -1.692135e-02 3 1  ON 28
ci_030                -1.182670e-02 3 1  ON 29
ci_031                -1.185006e-02 3 1  ON 30
ci_032                -1.527299e-02 3 1  ON 31
ci_033                 8.647739e-03 3 1  ON 32
ci_034                 8.777469e-03 3 1  ON 33
ci_035                -8.338990e-03 3 1  ON 34
ci_036                -1.447238e-02 3 1  ON 35
ci_037                -1.461020e-02 3 1  ON 36
ci_038                 5.488863e-03 3 1  ON 37
ci_039                 5.649884e-03 3 1  ON 38
ci_040                -6.154431e-03 3 1  ON 39
ci_041                 1.006908e-02 3 1  ON 40
ci_042                 1.072968e-02 3 1  ON 41
ci_043                -6.929412e-03 3 1  ON 42
ci_044                -7.405187e-03 3 1  ON 43
ci_045                -5.986108e-03 3 1  ON 44
ci_046                 8.068938e-03 3 1  ON 45
ci_047                 8.088919e-03 3 1  ON 46
ci_048                -1.351626e-02 3 1  ON 47
ci_049                -1.322214e-02 3 1  ON 48
ci_050                 5.513936e-03 3 1  ON 49
ci_051                 5.536904e-03 3 1  ON 50
ci_052                -4.450492e-03 3 1  ON 51
ci_053                -4.560029e-03 3 1  ON 52
ci_054                -5.287533e-03 3 1  ON 53
ci_055                -5.668526e-03 3 1  ON 54
ci_056                 7.253341e-03 3 1  ON 55
ci_057                 7.301019e-03 3 1  ON 56
ci_058                -4.265463e-03 3 1  ON 57
ci_059                -4.153945e-03 3 1  ON 58
ci_060                 6.868730e-03 3 1  ON 59
ci_061                 7.213866e-03 3 1  ON 60
ci_062                -6.058670e-03 3 1  ON 61
ci_063                -5.914019e-03 3 1  ON 62
ci_064                -4.866235e-03 3 1  ON 63
ci_065                -5.519428e-03 3 1  ON 64
ci_066                 5.734244e-03 3 1  ON 65
ci_067                 5.979151e-03 3 1  ON 66
ci_068                -6.356239e-03 3 1  ON 67
ci_069                -6.055132e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9540e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7226e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1774
    reference variance = 0.801513
====================================================
  Execution time = 1.3945e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9679e-01
  Total weights = 1.956247919e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4914e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282682046374
                                         uncertainty =       0.001767373352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282682046374
                                         uncertainty =       0.001767373352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375983412
  error estimate for blocks of size 2^( 2) =       0.000388318418
  error estimate for blocks of size 2^( 3) =       0.000398454915
  error estimate for blocks of size 2^( 4) =       0.000406457500
  error estimate for blocks of size 2^( 5) =       0.000411687113
  error estimate for blocks of size 2^( 6) =       0.000413352836
  error estimate for blocks of size 2^( 7) =       0.000415901120

      target function =      -0.905391318797
              le_mean =     -17.214263592341
             les_mean =     296.627665318401
             stat err =       0.000411849642
             autocorr =       1.199886082753
   target nu stat err =       0.000411849642
   target dn stat err =       0.002901380477
      target stat err =       0.003746174311
              std dev =       0.531720840766
             le_variance =       0.282727052505


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721426359234e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905406146792       residual = 1.98e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908074431765       residual = 3.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908545495656       residual = 9.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908707437311       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908745341319       residual = 3.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908752228126       residual = 9.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908752190445       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908752355023       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908752368797       residual = 1.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908752277043       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908752281626       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.908752298553       residual = 9.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 1.947150e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905406146792       residual = 1.98e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906296583769       residual = 2.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906446147860       residual = 8.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906494535054       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906505250363       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906507013286       residual = 6.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906506936258       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906506962416       residual = 2.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906506967983       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906506944251       residual = 8.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.906506945716       residual = 1.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.906506949609       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 6.159741e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905406146792       residual = 1.98e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905649032709       residual = 2.89e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905689074794       residual = 7.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905701741896       residual = 1.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905704491574       residual = 2.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905704927013       residual = 6.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905704901841       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905704906918       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905704908462       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905704902591       residual = 6.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.905704903003       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.905704903915       residual = 3.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 1.649081e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.116157 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6446e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_001                -4.817251e-02 3 1  ON 0
ci_002                -3.773339e-02 3 1  ON 1
ci_003                -2.943240e-02 3 1  ON 2
ci_004                 2.758335e-02 3 1  ON 3
ci_005                 2.745799e-02 3 1  ON 4
ci_006                -2.489495e-02 3 1  ON 5
ci_007                -2.501899e-02 3 1  ON 6
ci_008                -1.298876e-02 3 1  ON 7
ci_009                -1.775952e-02 3 1  ON 8
ci_010                -1.422729e-02 3 1  ON 9
ci_011                -1.438312e-02 3 1  ON 10
ci_012                -1.461002e-02 3 1  ON 11
ci_013                -2.196841e-02 3 1  ON 12
ci_014                 1.573761e-02 3 1  ON 13
ci_015                 1.558475e-02 3 1  ON 14
ci_016                 1.876843e-02 3 1  ON 15
ci_017                 1.875062e-02 3 1  ON 16
ci_018                 1.369946e-02 3 1  ON 17
ci_019                 1.374774e-02 3 1  ON 18
ci_020                 1.965525e-02 3 1  ON 19
ci_021                 1.962122e-02 3 1  ON 20
ci_022                 1.247820e-02 3 1  ON 21
ci_023                 1.238419e-02 3 1  ON 22
ci_024                 1.272827e-02 3 1  ON 23
ci_025                 1.297948e-02 3 1  ON 24
ci_026                 1.385420e-02 3 1  ON 25
ci_027                 1.377451e-02 3 1  ON 26
ci_028                -1.664433e-02 3 1  ON 27
ci_029                -1.682521e-02 3 1  ON 28
ci_030                -1.151340e-02 3 1  ON 29
ci_031                -1.157359e-02 3 1  ON 30
ci_032                -1.523944e-02 3 1  ON 31
ci_033                 8.426721e-03 3 1  ON 32
ci_034                 8.482413e-03 3 1  ON 33
ci_035                -7.961364e-03 3 1  ON 34
ci_036                -1.442126e-02 3 1  ON 35
ci_037                -1.453745e-02 3 1  ON 36
ci_038                 5.122928e-03 3 1  ON 37
ci_039                 5.342070e-03 3 1  ON 38
ci_040                -5.701007e-03 3 1  ON 39
ci_041                 1.006196e-02 3 1  ON 40
ci_042                 1.052982e-02 3 1  ON 41
ci_043                -6.587489e-03 3 1  ON 42
ci_044                -7.137847e-03 3 1  ON 43
ci_045                -5.650816e-03 3 1  ON 44
ci_046                 7.869264e-03 3 1  ON 45
ci_047                 7.880281e-03 3 1  ON 46
ci_048                -1.350998e-02 3 1  ON 47
ci_049                -1.321211e-02 3 1  ON 48
ci_050                 5.190463e-03 3 1  ON 49
ci_051                 5.363504e-03 3 1  ON 50
ci_052                -4.183631e-03 3 1  ON 51
ci_053                -4.273993e-03 3 1  ON 52
ci_054                -5.119783e-03 3 1  ON 53
ci_055                -5.373973e-03 3 1  ON 54
ci_056                 7.158134e-03 3 1  ON 55
ci_057                 7.099347e-03 3 1  ON 56
ci_058                -3.891729e-03 3 1  ON 57
ci_059                -3.943134e-03 3 1  ON 58
ci_060                 6.677859e-03 3 1  ON 59
ci_061                 7.116127e-03 3 1  ON 60
ci_062                -5.879264e-03 3 1  ON 61
ci_063                -5.718986e-03 3 1  ON 62
ci_064                -4.657346e-03 3 1  ON 63
ci_065                -5.377931e-03 3 1  ON 64
ci_066                 5.624307e-03 3 1  ON 65
ci_067                 5.851051e-03 3 1  ON 66
ci_068                -6.004518e-03 3 1  ON 67
ci_069                -5.929918e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1314
    reference variance = 0.211939
====================================================
  Execution time = 1.3621e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.9534e-01
  Total weights = 1.9565e+06
  Execution time = 1.8330e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284056474606
                                         uncertainty =       0.001995705383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284056474606
                                         uncertainty =       0.001995705383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376831568
  error estimate for blocks of size 2^( 2) =       0.000389241022
  error estimate for blocks of size 2^( 3) =       0.000399700188
  error estimate for blocks of size 2^( 4) =       0.000407535679
  error estimate for blocks of size 2^( 5) =       0.000412105738
  error estimate for blocks of size 2^( 6) =       0.000414622835
  error estimate for blocks of size 2^( 7) =       0.000415810498

      target function =      -0.901917208107
              le_mean =     -17.213149088235
             les_mean =     296.591830558376
             stat err =       0.000412518688
             autocorr =       1.198374891483
   target nu stat err =       0.000412518688
   target dn stat err =       0.003073297048
      target stat err =       0.003926274785
              std dev =       0.532920313579
             le_variance =       0.284004060625

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280596589585
                                         uncertainty =       0.001930037830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280596589585
                                         uncertainty =       0.001930037830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374529776
  error estimate for blocks of size 2^( 2) =       0.000387303750
  error estimate for blocks of size 2^( 3) =       0.000398169034
  error estimate for blocks of size 2^( 4) =       0.000406231863
  error estimate for blocks of size 2^( 5) =       0.000410958483
  error estimate for blocks of size 2^( 6) =       0.000413605460
  error estimate for blocks of size 2^( 7) =       0.000414732433

      target function =      -0.568910313652
              le_mean =     -17.213262428582
             les_mean =     296.923501180356
             stat err =       0.000411382060
             autocorr =       1.206474078781
   target nu stat err =       0.000411382060
   target dn stat err =       0.306251777219
      target stat err =       0.167307871255
              std dev =       0.529665088690
             le_variance =       0.280545106177

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281179649005
                                         uncertainty =       0.001925152842

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281179649005
                                         uncertainty =       0.001925152842

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374919023
  error estimate for blocks of size 2^( 2) =       0.000387551085
  error estimate for blocks of size 2^( 3) =       0.000398266435
  error estimate for blocks of size 2^( 4) =       0.000406253318
  error estimate for blocks of size 2^( 5) =       0.000410928935
  error estimate for blocks of size 2^( 6) =       0.000413542763
  error estimate for blocks of size 2^( 7) =       0.000414757309

      target function =      -0.907206143006
              le_mean =     -17.213177322591
             les_mean =     296.588648943580
             stat err =       0.000411370581
             autocorr =       1.203903031013
   target nu stat err =       0.000411370581
   target dn stat err =       0.002782044733
      target stat err =       0.003603902062
              std dev =       0.530215566655
             le_variance =       0.281128547123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283608646217
                                         uncertainty =       0.001985777478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283608646217
                                         uncertainty =       0.001985777478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376534487
  error estimate for blocks of size 2^( 2) =       0.000388972307
  error estimate for blocks of size 2^( 3) =       0.000399464533
  error estimate for blocks of size 2^( 4) =       0.000407319632
  error estimate for blocks of size 2^( 5) =       0.000411903083
  error estimate for blocks of size 2^( 6) =       0.000414434104
  error estimate for blocks of size 2^( 7) =       0.000415629419

      target function =      -0.903343209515
              le_mean =     -17.213144660571
             les_mean =     296.590551376092
             stat err =       0.000412321559
             autocorr =       1.199119782876
   target nu stat err =       0.000412321559
   target dn stat err =       0.002980675345
      target stat err =       0.003822397482
              std dev =       0.532500178299
             le_variance =       0.283556439889


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.901917208107        initial
     1.5625e-01     1.5625e+00             1.9472e-03        -0.568910313652
     6.2500e-01     6.2500e+00             6.1597e-04        -0.907206143006  <--
     2.5000e+00     2.5000e+01             1.6491e-04        -0.903343209515

*****************************************************************************
Applying the update for shift_i =   6.2500e-01     and shift_s =   6.2500e+00
*****************************************************************************

  Execution time = 2.2909e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_001                -4.817251e-02 3 1  ON 0
ci_002                -3.773339e-02 3 1  ON 1
ci_003                -2.943240e-02 3 1  ON 2
ci_004                 2.758335e-02 3 1  ON 3
ci_005                 2.745799e-02 3 1  ON 4
ci_006                -2.489495e-02 3 1  ON 5
ci_007                -2.501899e-02 3 1  ON 6
ci_008                -1.298876e-02 3 1  ON 7
ci_009                -1.775952e-02 3 1  ON 8
ci_010                -1.422729e-02 3 1  ON 9
ci_011                -1.438312e-02 3 1  ON 10
ci_012                -1.461002e-02 3 1  ON 11
ci_013                -2.196841e-02 3 1  ON 12
ci_014                 1.573761e-02 3 1  ON 13
ci_015                 1.558475e-02 3 1  ON 14
ci_016                 1.876843e-02 3 1  ON 15
ci_017                 1.875062e-02 3 1  ON 16
ci_018                 1.369946e-02 3 1  ON 17
ci_019                 1.374774e-02 3 1  ON 18
ci_020                 1.965525e-02 3 1  ON 19
ci_021                 1.962122e-02 3 1  ON 20
ci_022                 1.247820e-02 3 1  ON 21
ci_023                 1.238419e-02 3 1  ON 22
ci_024                 1.272827e-02 3 1  ON 23
ci_025                 1.297948e-02 3 1  ON 24
ci_026                 1.385420e-02 3 1  ON 25
ci_027                 1.377451e-02 3 1  ON 26
ci_028                -1.664433e-02 3 1  ON 27
ci_029                -1.682521e-02 3 1  ON 28
ci_030                -1.151340e-02 3 1  ON 29
ci_031                -1.157359e-02 3 1  ON 30
ci_032                -1.523944e-02 3 1  ON 31
ci_033                 8.426721e-03 3 1  ON 32
ci_034                 8.482413e-03 3 1  ON 33
ci_035                -7.961364e-03 3 1  ON 34
ci_036                -1.442126e-02 3 1  ON 35
ci_037                -1.453745e-02 3 1  ON 36
ci_038                 5.122928e-03 3 1  ON 37
ci_039                 5.342070e-03 3 1  ON 38
ci_040                -5.701007e-03 3 1  ON 39
ci_041                 1.006196e-02 3 1  ON 40
ci_042                 1.052982e-02 3 1  ON 41
ci_043                -6.587489e-03 3 1  ON 42
ci_044                -7.137847e-03 3 1  ON 43
ci_045                -5.650816e-03 3 1  ON 44
ci_046                 7.869264e-03 3 1  ON 45
ci_047                 7.880281e-03 3 1  ON 46
ci_048                -1.350998e-02 3 1  ON 47
ci_049                -1.321211e-02 3 1  ON 48
ci_050                 5.190463e-03 3 1  ON 49
ci_051                 5.363504e-03 3 1  ON 50
ci_052                -4.183631e-03 3 1  ON 51
ci_053                -4.273993e-03 3 1  ON 52
ci_054                -5.119783e-03 3 1  ON 53
ci_055                -5.373973e-03 3 1  ON 54
ci_056                 7.158134e-03 3 1  ON 55
ci_057                 7.099347e-03 3 1  ON 56
ci_058                -3.891729e-03 3 1  ON 57
ci_059                -3.943134e-03 3 1  ON 58
ci_060                 6.677859e-03 3 1  ON 59
ci_061                 7.116127e-03 3 1  ON 60
ci_062                -5.879264e-03 3 1  ON 61
ci_063                -5.718986e-03 3 1  ON 62
ci_064                -4.657346e-03 3 1  ON 63
ci_065                -5.377931e-03 3 1  ON 64
ci_066                 5.624307e-03 3 1  ON 65
ci_067                 5.851051e-03 3 1  ON 66
ci_068                -6.004518e-03 3 1  ON 67
ci_069                -5.929918e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9379e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7223e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2269
    reference variance = 0.161789
====================================================
  Execution time = 1.3880e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.9695e-01
  Total weights = 1.956449005e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4960e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282057147608
                                         uncertainty =       0.002052444851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282057147608
                                         uncertainty =       0.002052444851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375525913
  error estimate for blocks of size 2^( 2) =       0.000388399522
  error estimate for blocks of size 2^( 3) =       0.000399320521
  error estimate for blocks of size 2^( 4) =       0.000407058709
  error estimate for blocks of size 2^( 5) =       0.000412362848
  error estimate for blocks of size 2^( 6) =       0.000415148391
  error estimate for blocks of size 2^( 7) =       0.000416001035

      target function =      -0.904947283362
              le_mean =     -17.213229014381
             les_mean =     296.592204625275
             stat err =       0.000412642746
             autocorr =       1.207448474683
   target nu stat err =       0.000412642746
   target dn stat err =       0.003315889581
      target stat err =       0.004258490604
              std dev =       0.531073839524
             le_variance =       0.282039423026


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721322901438e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e-01, overlap shift 1.5625e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904966520557       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906968646859       residual = 1.79e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907314173433       residual = 4.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907401452121       residual = 7.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907413280842       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907417579757       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907419259224       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907419586982       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907419410682       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907419368750       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.907419421731       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.907419417118       residual = 2.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e-01 is 1.995518e-03

solving harmonic davidson linear method for identity shift 6.2500e-01, overlap shift 6.2500e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904966520557       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905630877049       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905739643567       residual = 4.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905765179718       residual = 6.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905768555792       residual = 1.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905769646273       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905770125522       residual = 4.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905770180160       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905770157454       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905770134061       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.905770147611       residual = 6.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e-01 is 6.289550e-04

solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.904966520557       residual = 1.24e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905147377086       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905176415496       residual = 4.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905183054146       residual = 5.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905183925503       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905184194643       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905184318166       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905184329722       residual = 1.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905184325006       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905184318894       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.905184322175       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+00 is 1.681905e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.120460 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6385e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_001                -4.754355e-02 3 1  ON 0
ci_002                -3.729618e-02 3 1  ON 1
ci_003                -2.912236e-02 3 1  ON 2
ci_004                 2.740756e-02 3 1  ON 3
ci_005                 2.717586e-02 3 1  ON 4
ci_006                -2.445515e-02 3 1  ON 5
ci_007                -2.466704e-02 3 1  ON 6
ci_008                -1.271565e-02 3 1  ON 7
ci_009                -1.746833e-02 3 1  ON 8
ci_010                -1.370654e-02 3 1  ON 9
ci_011                -1.395035e-02 3 1  ON 10
ci_012                -1.411458e-02 3 1  ON 11
ci_013                -2.182049e-02 3 1  ON 12
ci_014                 1.547356e-02 3 1  ON 13
ci_015                 1.536991e-02 3 1  ON 14
ci_016                 1.874306e-02 3 1  ON 15
ci_017                 1.865501e-02 3 1  ON 16
ci_018                 1.323815e-02 3 1  ON 17
ci_019                 1.345250e-02 3 1  ON 18
ci_020                 1.959352e-02 3 1  ON 19
ci_021                 1.956232e-02 3 1  ON 20
ci_022                 1.219027e-02 3 1  ON 21
ci_023                 1.219182e-02 3 1  ON 22
ci_024                 1.246288e-02 3 1  ON 23
ci_025                 1.250759e-02 3 1  ON 24
ci_026                 1.363552e-02 3 1  ON 25
ci_027                 1.357860e-02 3 1  ON 26
ci_028                -1.649460e-02 3 1  ON 27
ci_029                -1.667911e-02 3 1  ON 28
ci_030                -1.132439e-02 3 1  ON 29
ci_031                -1.139452e-02 3 1  ON 30
ci_032                -1.518539e-02 3 1  ON 31
ci_033                 8.014332e-03 3 1  ON 32
ci_034                 8.103427e-03 3 1  ON 33
ci_035                -7.721415e-03 3 1  ON 34
ci_036                -1.432589e-02 3 1  ON 35
ci_037                -1.426041e-02 3 1  ON 36
ci_038                 4.817618e-03 3 1  ON 37
ci_039                 4.961218e-03 3 1  ON 38
ci_040                -5.399100e-03 3 1  ON 39
ci_041                 9.948138e-03 3 1  ON 40
ci_042                 1.035390e-02 3 1  ON 41
ci_043                -6.406782e-03 3 1  ON 42
ci_044                -6.858651e-03 3 1  ON 43
ci_045                -5.452087e-03 3 1  ON 44
ci_046                 7.657967e-03 3 1  ON 45
ci_047                 7.760148e-03 3 1  ON 46
ci_048                -1.345540e-02 3 1  ON 47
ci_049                -1.312286e-02 3 1  ON 48
ci_050                 5.031220e-03 3 1  ON 49
ci_051                 5.014769e-03 3 1  ON 50
ci_052                -3.988170e-03 3 1  ON 51
ci_053                -4.053222e-03 3 1  ON 52
ci_054                -4.852001e-03 3 1  ON 53
ci_055                -5.146155e-03 3 1  ON 54
ci_056                 7.104740e-03 3 1  ON 55
ci_057                 6.990680e-03 3 1  ON 56
ci_058                -3.865578e-03 3 1  ON 57
ci_059                -3.671200e-03 3 1  ON 58
ci_060                 6.564399e-03 3 1  ON 59
ci_061                 6.879055e-03 3 1  ON 60
ci_062                -5.716823e-03 3 1  ON 61
ci_063                -5.637010e-03 3 1  ON 62
ci_064                -4.426853e-03 3 1  ON 63
ci_065                -5.264339e-03 3 1  ON 64
ci_066                 5.462957e-03 3 1  ON 65
ci_067                 5.676260e-03 3 1  ON 66
ci_068                -5.803320e-03 3 1  ON 67
ci_069                -5.872549e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1471
    reference variance = 0.326906
====================================================
  Execution time = 1.3474e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.9349e-01
  Total weights = 1.9565e+06
  Execution time = 1.8495e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282367959497
                                         uncertainty =       0.002015196241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282367959497
                                         uncertainty =       0.002015196241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375715564
  error estimate for blocks of size 2^( 2) =       0.000388247966
  error estimate for blocks of size 2^( 3) =       0.000399201501
  error estimate for blocks of size 2^( 4) =       0.000406852529
  error estimate for blocks of size 2^( 5) =       0.000411595117
  error estimate for blocks of size 2^( 6) =       0.000413573944
  error estimate for blocks of size 2^( 7) =       0.000414414233

      target function =      -0.900876247799
              le_mean =     -17.212816502341
             les_mean =     296.581130471363
             stat err =       0.000411608956
             autocorr =       1.200193470522
   target nu stat err =       0.000411608956
   target dn stat err =       0.004578650330
      target stat err =       0.005798165802
              std dev =       0.531342045686
             le_variance =       0.282324369514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279076796901
                                         uncertainty =       0.001929682776

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279076796901
                                         uncertainty =       0.001929682776

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373519027
  error estimate for blocks of size 2^( 2) =       0.000386419504
  error estimate for blocks of size 2^( 3) =       0.000397778240
  error estimate for blocks of size 2^( 4) =       0.000405670096
  error estimate for blocks of size 2^( 5) =       0.000410584007
  error estimate for blocks of size 2^( 6) =       0.000412545607
  error estimate for blocks of size 2^( 7) =       0.000413461827

      target function =      -0.620606295429
              le_mean =     -17.212877498731
             les_mean =     296.838685705004
             stat err =       0.000410565384
             autocorr =       1.208201024930
   target nu stat err =       0.000410565384
   target dn stat err =       0.255913367247
      target stat err =       0.163682180097
              std dev =       0.528235674422
             le_variance =       0.279032927733

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279957327323
                                         uncertainty =       0.001953666376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279957327323
                                         uncertainty =       0.001953666376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374107978
  error estimate for blocks of size 2^( 2) =       0.000386880506
  error estimate for blocks of size 2^( 3) =       0.000398100176
  error estimate for blocks of size 2^( 4) =       0.000405915907
  error estimate for blocks of size 2^( 5) =       0.000410769628
  error estimate for blocks of size 2^( 6) =       0.000412747056
  error estimate for blocks of size 2^( 7) =       0.000413649470

      target function =      -0.899965901076
              le_mean =     -17.212834809470
             les_mean =     296.582449984245
             stat err =       0.000410770515
             autocorr =       1.205603739503
   target nu stat err =       0.000410770515
   target dn stat err =       0.006900807413
      target stat err =       0.008697732332
              std dev =       0.529068576255
             le_variance =       0.279913558380

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281995346098
                                         uncertainty =       0.002006218016

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281995346098
                                         uncertainty =       0.002006218016

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375467526
  error estimate for blocks of size 2^( 2) =       0.000388032099
  error estimate for blocks of size 2^( 3) =       0.000399022533
  error estimate for blocks of size 2^( 4) =       0.000406694594
  error estimate for blocks of size 2^( 5) =       0.000411452878
  error estimate for blocks of size 2^( 6) =       0.000413430495
  error estimate for blocks of size 2^( 7) =       0.000414280874

      target function =      -0.897521539504
              le_mean =     -17.212815348416
             les_mean =     296.583707590508
             stat err =       0.000411464710
             autocorr =       1.200937548871
   target nu stat err =       0.000411464710
   target dn stat err =       0.007794490603
      target stat err =       0.009766327353
              std dev =       0.530991267742
             le_variance =       0.281951726418


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.900876247799        initial  <--
     1.5625e-01     1.5625e+00             1.9955e-03        -0.620606295429
     6.2500e-01     6.2500e+00             6.2896e-04        -0.899965901076
     2.5000e+00     2.5000e+01             1.6819e-04        -0.897521539504

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8347
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_001                -4.817251e-02 3 1  ON 0
ci_002                -3.773339e-02 3 1  ON 1
ci_003                -2.943240e-02 3 1  ON 2
ci_004                 2.758335e-02 3 1  ON 3
ci_005                 2.745799e-02 3 1  ON 4
ci_006                -2.489495e-02 3 1  ON 5
ci_007                -2.501899e-02 3 1  ON 6
ci_008                -1.298876e-02 3 1  ON 7
ci_009                -1.775952e-02 3 1  ON 8
ci_010                -1.422729e-02 3 1  ON 9
ci_011                -1.438312e-02 3 1  ON 10
ci_012                -1.461002e-02 3 1  ON 11
ci_013                -2.196841e-02 3 1  ON 12
ci_014                 1.573761e-02 3 1  ON 13
ci_015                 1.558475e-02 3 1  ON 14
ci_016                 1.876843e-02 3 1  ON 15
ci_017                 1.875062e-02 3 1  ON 16
ci_018                 1.369946e-02 3 1  ON 17
ci_019                 1.374774e-02 3 1  ON 18
ci_020                 1.965525e-02 3 1  ON 19
ci_021                 1.962122e-02 3 1  ON 20
ci_022                 1.247820e-02 3 1  ON 21
ci_023                 1.238419e-02 3 1  ON 22
ci_024                 1.272827e-02 3 1  ON 23
ci_025                 1.297948e-02 3 1  ON 24
ci_026                 1.385420e-02 3 1  ON 25
ci_027                 1.377451e-02 3 1  ON 26
ci_028                -1.664433e-02 3 1  ON 27
ci_029                -1.682521e-02 3 1  ON 28
ci_030                -1.151340e-02 3 1  ON 29
ci_031                -1.157359e-02 3 1  ON 30
ci_032                -1.523944e-02 3 1  ON 31
ci_033                 8.426721e-03 3 1  ON 32
ci_034                 8.482413e-03 3 1  ON 33
ci_035                -7.961364e-03 3 1  ON 34
ci_036                -1.442126e-02 3 1  ON 35
ci_037                -1.453745e-02 3 1  ON 36
ci_038                 5.122928e-03 3 1  ON 37
ci_039                 5.342070e-03 3 1  ON 38
ci_040                -5.701007e-03 3 1  ON 39
ci_041                 1.006196e-02 3 1  ON 40
ci_042                 1.052982e-02 3 1  ON 41
ci_043                -6.587489e-03 3 1  ON 42
ci_044                -7.137847e-03 3 1  ON 43
ci_045                -5.650816e-03 3 1  ON 44
ci_046                 7.869264e-03 3 1  ON 45
ci_047                 7.880281e-03 3 1  ON 46
ci_048                -1.350998e-02 3 1  ON 47
ci_049                -1.321211e-02 3 1  ON 48
ci_050                 5.190463e-03 3 1  ON 49
ci_051                 5.363504e-03 3 1  ON 50
ci_052                -4.183631e-03 3 1  ON 51
ci_053                -4.273993e-03 3 1  ON 52
ci_054                -5.119783e-03 3 1  ON 53
ci_055                -5.373973e-03 3 1  ON 54
ci_056                 7.158134e-03 3 1  ON 55
ci_057                 7.099347e-03 3 1  ON 56
ci_058                -3.891729e-03 3 1  ON 57
ci_059                -3.943134e-03 3 1  ON 58
ci_060                 6.677859e-03 3 1  ON 59
ci_061                 7.116127e-03 3 1  ON 60
ci_062                -5.879264e-03 3 1  ON 61
ci_063                -5.718986e-03 3 1  ON 62
ci_064                -4.657346e-03 3 1  ON 63
ci_065                -5.377931e-03 3 1  ON 64
ci_066                 5.624307e-03 3 1  ON 65
ci_067                 5.851051e-03 3 1  ON 66
ci_068                -6.004518e-03 3 1  ON 67
ci_069                -5.929918e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9225e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2305
    reference variance = 0.404661
====================================================
  Execution time = 1.4144e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9601e-01
  Total weights = 1.956073672e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.9619e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282664886915
                                         uncertainty =       0.001678795267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282664886915
                                         uncertainty =       0.001678795267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375908133
  error estimate for blocks of size 2^( 2) =       0.000388179141
  error estimate for blocks of size 2^( 3) =       0.000398820232
  error estimate for blocks of size 2^( 4) =       0.000407098204
  error estimate for blocks of size 2^( 5) =       0.000410679118
  error estimate for blocks of size 2^( 6) =       0.000412447255
  error estimate for blocks of size 2^( 7) =       0.000413091361

      target function =      -0.905922528702
              le_mean =     -17.212235095541
             les_mean =     296.557045460366
             stat err =       0.000410828985
             autocorr =       1.194424513737
   target nu stat err =       0.000410828985
   target dn stat err =       0.002585216845
      target stat err =       0.003341392912
              std dev =       0.531614380089
             le_variance =       0.282613849118


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721223509554e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905934080294       residual = 1.57e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906257689684       residual = 2.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906310213911       residual = 4.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906322598297       residual = 5.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906324139945       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906324487750       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906324555148       residual = 6.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906324586247       residual = 1.56e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906324582806       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906324580481       residual = 3.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.906324579274       residual = 8.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 2.355189e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905934080294       residual = 1.57e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906017960871       residual = 2.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906031453854       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906034596653       residual = 5.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906034984355       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906035071485       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906035088185       residual = 6.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906035095928       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906035095005       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906035094453       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.906035094151       residual = 7.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 6.057999e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905934080294       residual = 1.57e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.905955245147       residual = 2.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.905958641712       residual = 4.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.905959430314       residual = 5.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.905959527368       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.905959549160       residual = 3.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.905959553325       residual = 6.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.905959555258       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905959555023       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.905959554887       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.905959554811       residual = 7.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 1.525510e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.129429 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8025e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_001                -4.811193e-02 3 1  ON 0
ci_002                -3.768832e-02 3 1  ON 1
ci_003                -2.939612e-02 3 1  ON 2
ci_004                 2.754236e-02 3 1  ON 3
ci_005                 2.742436e-02 3 1  ON 4
ci_006                -2.485541e-02 3 1  ON 5
ci_007                -2.498115e-02 3 1  ON 6
ci_008                -1.293431e-02 3 1  ON 7
ci_009                -1.771935e-02 3 1  ON 8
ci_010                -1.417558e-02 3 1  ON 9
ci_011                -1.433169e-02 3 1  ON 10
ci_012                -1.455719e-02 3 1  ON 11
ci_013                -2.193949e-02 3 1  ON 12
ci_014                 1.568309e-02 3 1  ON 13
ci_015                 1.554502e-02 3 1  ON 14
ci_016                 1.874944e-02 3 1  ON 15
ci_017                 1.872277e-02 3 1  ON 16
ci_018                 1.367048e-02 3 1  ON 17
ci_019                 1.369902e-02 3 1  ON 18
ci_020                 1.964414e-02 3 1  ON 19
ci_021                 1.960255e-02 3 1  ON 20
ci_022                 1.243848e-02 3 1  ON 21
ci_023                 1.235575e-02 3 1  ON 22
ci_024                 1.270663e-02 3 1  ON 23
ci_025                 1.296874e-02 3 1  ON 24
ci_026                 1.384168e-02 3 1  ON 25
ci_027                 1.375769e-02 3 1  ON 26
ci_028                -1.662881e-02 3 1  ON 27
ci_029                -1.681596e-02 3 1  ON 28
ci_030                -1.148869e-02 3 1  ON 29
ci_031                -1.154665e-02 3 1  ON 30
ci_032                -1.523397e-02 3 1  ON 31
ci_033                 8.403218e-03 3 1  ON 32
ci_034                 8.445995e-03 3 1  ON 33
ci_035                -7.928155e-03 3 1  ON 34
ci_036                -1.441095e-02 3 1  ON 35
ci_037                -1.452326e-02 3 1  ON 36
ci_038                 5.085207e-03 3 1  ON 37
ci_039                 5.302931e-03 3 1  ON 38
ci_040                -5.680080e-03 3 1  ON 39
ci_041                 1.004897e-02 3 1  ON 40
ci_042                 1.050544e-02 3 1  ON 41
ci_043                -6.561545e-03 3 1  ON 42
ci_044                -7.111494e-03 3 1  ON 43
ci_045                -5.624610e-03 3 1  ON 44
ci_046                 7.841918e-03 3 1  ON 45
ci_047                 7.858449e-03 3 1  ON 46
ci_048                -1.351449e-02 3 1  ON 47
ci_049                -1.321051e-02 3 1  ON 48
ci_050                 5.157851e-03 3 1  ON 49
ci_051                 5.333967e-03 3 1  ON 50
ci_052                -4.166425e-03 3 1  ON 51
ci_053                -4.250277e-03 3 1  ON 52
ci_054                -5.098573e-03 3 1  ON 53
ci_055                -5.347113e-03 3 1  ON 54
ci_056                 7.129041e-03 3 1  ON 55
ci_057                 7.078376e-03 3 1  ON 56
ci_058                -3.880636e-03 3 1  ON 57
ci_059                -3.895954e-03 3 1  ON 58
ci_060                 6.666257e-03 3 1  ON 59
ci_061                 7.086292e-03 3 1  ON 60
ci_062                -5.858051e-03 3 1  ON 61
ci_063                -5.692705e-03 3 1  ON 62
ci_064                -4.641888e-03 3 1  ON 63
ci_065                -5.361640e-03 3 1  ON 64
ci_066                 5.614264e-03 3 1  ON 65
ci_067                 5.846814e-03 3 1  ON 66
ci_068                -5.996265e-03 3 1  ON 67
ci_069                -5.922172e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2041
    reference variance = 0.205117
====================================================
  Execution time = 1.3730e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.9901e-01
  Total weights = 1.9563e+06
  Execution time = 1.8424e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284301513101
                                         uncertainty =       0.001689805883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284301513101
                                         uncertainty =       0.001689805883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377208907
  error estimate for blocks of size 2^( 2) =       0.000389564259
  error estimate for blocks of size 2^( 3) =       0.000400548085
  error estimate for blocks of size 2^( 4) =       0.000408623639
  error estimate for blocks of size 2^( 5) =       0.000413804718
  error estimate for blocks of size 2^( 6) =       0.000416742256
  error estimate for blocks of size 2^( 7) =       0.000418825360

      target function =      -0.902292100213
              le_mean =     -17.213262988023
             les_mean =     296.595475580622
             stat err =       0.000414498993
             autocorr =       1.207488719208
   target nu stat err =       0.000414498993
   target dn stat err =       0.003068410988
      target stat err =       0.003924496445
              std dev =       0.533453951703
             le_variance =       0.284573118588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283743181957
                                         uncertainty =       0.001683165185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283743181957
                                         uncertainty =       0.001683165185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376836989
  error estimate for blocks of size 2^( 2) =       0.000389240900
  error estimate for blocks of size 2^( 3) =       0.000400277143
  error estimate for blocks of size 2^( 4) =       0.000408392809
  error estimate for blocks of size 2^( 5) =       0.000413599159
  error estimate for blocks of size 2^( 6) =       0.000416549091
  error estimate for blocks of size 2^( 7) =       0.000418640818

      target function =      -0.900629288687
              le_mean =     -17.213266651955
             les_mean =     296.596915484641
             stat err =       0.000414295469
             autocorr =       1.208685512868
   target nu stat err =       0.000414295469
   target dn stat err =       0.003495582204
      target stat err =       0.004443318183
              std dev =       0.532927981001
             le_variance =       0.284012232934

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284008164318
                                         uncertainty =       0.001686328751

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284008164318
                                         uncertainty =       0.001686328751

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377013561
  error estimate for blocks of size 2^( 2) =       0.000389394069
  error estimate for blocks of size 2^( 3) =       0.000400404642
  error estimate for blocks of size 2^( 4) =       0.000408500684
  error estimate for blocks of size 2^( 5) =       0.000413693861
  error estimate for blocks of size 2^( 6) =       0.000416636372
  error estimate for blocks of size 2^( 7) =       0.000418723753

      target function =      -0.894720208636
              le_mean =     -17.213264538816
             les_mean =     296.601515066032
             stat err =       0.000414388668
             autocorr =       1.208096975854
   target nu stat err =       0.000414388668
   target dn stat err =       0.006809632857
      target stat err =       0.008489748483
              std dev =       0.533177690671
             le_variance =       0.284278449829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284263968919
                                         uncertainty =       0.001689360773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284263968919
                                         uncertainty =       0.001689360773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377183913
  error estimate for blocks of size 2^( 2) =       0.000389542405
  error estimate for blocks of size 2^( 3) =       0.000400529623
  error estimate for blocks of size 2^( 4) =       0.000408607771
  error estimate for blocks of size 2^( 5) =       0.000413790498
  error estimate for blocks of size 2^( 6) =       0.000416728859
  error estimate for blocks of size 2^( 7) =       0.000418812541

      target function =      -0.902311685219
              le_mean =     -17.213263087137
             les_mean =     296.595463462560
             stat err =       0.000414484917
             autocorr =       1.207566732894
   target nu stat err =       0.000414484917
   target dn stat err =       0.003075853336
      target stat err =       0.003933973734
              std dev =       0.533418604685
             le_variance =       0.284535407824


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.902292100213        initial
     1.5625e+00     1.5625e+01             2.3552e-04        -0.900629288687
     6.2500e+00     6.2500e+01             6.0580e-05        -0.894720208636
     2.5000e+01     2.5000e+02             1.5255e-05        -0.902311685219  <--

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 2.3069e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_001                -4.815725e-02 3 1  ON 0
ci_002                -3.772203e-02 3 1  ON 1
ci_003                -2.942327e-02 3 1  ON 2
ci_004                 2.757303e-02 3 1  ON 3
ci_005                 2.744952e-02 3 1  ON 4
ci_006                -2.488499e-02 3 1  ON 5
ci_007                -2.500946e-02 3 1  ON 6
ci_008                -1.297502e-02 3 1  ON 7
ci_009                -1.774939e-02 3 1  ON 8
ci_010                -1.421425e-02 3 1  ON 9
ci_011                -1.437015e-02 3 1  ON 10
ci_012                -1.459669e-02 3 1  ON 11
ci_013                -2.196113e-02 3 1  ON 12
ci_014                 1.572386e-02 3 1  ON 13
ci_015                 1.557474e-02 3 1  ON 14
ci_016                 1.876364e-02 3 1  ON 15
ci_017                 1.874360e-02 3 1  ON 16
ci_018                 1.369215e-02 3 1  ON 17
ci_019                 1.373545e-02 3 1  ON 18
ci_020                 1.965246e-02 3 1  ON 19
ci_021                 1.961652e-02 3 1  ON 20
ci_022                 1.246818e-02 3 1  ON 21
ci_023                 1.237702e-02 3 1  ON 22
ci_024                 1.272282e-02 3 1  ON 23
ci_025                 1.297678e-02 3 1  ON 24
ci_026                 1.385105e-02 3 1  ON 25
ci_027                 1.377027e-02 3 1  ON 26
ci_028                -1.664041e-02 3 1  ON 27
ci_029                -1.682288e-02 3 1  ON 28
ci_030                -1.150717e-02 3 1  ON 29
ci_031                -1.156679e-02 3 1  ON 30
ci_032                -1.523806e-02 3 1  ON 31
ci_033                 8.420797e-03 3 1  ON 32
ci_034                 8.473238e-03 3 1  ON 33
ci_035                -7.952988e-03 3 1  ON 34
ci_036                -1.441867e-02 3 1  ON 35
ci_037                -1.453388e-02 3 1  ON 36
ci_038                 5.113413e-03 3 1  ON 37
ci_039                 5.332196e-03 3 1  ON 38
ci_040                -5.695727e-03 3 1  ON 39
ci_041                 1.005869e-02 3 1  ON 40
ci_042                 1.052367e-02 3 1  ON 41
ci_043                -6.580945e-03 3 1  ON 42
ci_044                -7.131202e-03 3 1  ON 43
ci_045                -5.644204e-03 3 1  ON 44
ci_046                 7.862372e-03 3 1  ON 45
ci_047                 7.874779e-03 3 1  ON 46
ci_048                -1.351111e-02 3 1  ON 47
ci_049                -1.321170e-02 3 1  ON 48
ci_050                 5.182231e-03 3 1  ON 49
ci_051                 5.356047e-03 3 1  ON 50
ci_052                -4.179286e-03 3 1  ON 51
ci_053                -4.268004e-03 3 1  ON 52
ci_054                -5.114437e-03 3 1  ON 53
ci_055                -5.367203e-03 3 1  ON 54
ci_056                 7.150797e-03 3 1  ON 55
ci_057                 7.094059e-03 3 1  ON 56
ci_058                -3.888924e-03 3 1  ON 57
ci_059                -3.931223e-03 3 1  ON 58
ci_060                 6.674935e-03 3 1  ON 59
ci_061                 7.108608e-03 3 1  ON 60
ci_062                -5.873918e-03 3 1  ON 61
ci_063                -5.712361e-03 3 1  ON 62
ci_064                -4.653446e-03 3 1  ON 63
ci_065                -5.373821e-03 3 1  ON 64
ci_066                 5.621773e-03 3 1  ON 65
ci_067                 5.849980e-03 3 1  ON 66
ci_068                -6.002435e-03 3 1  ON 67
ci_069                -5.927963e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1108e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1834
    reference variance = 0.569217
====================================================
  Execution time = 1.3991e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.9909e-01
  Total weights = 1.956279043e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4858e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282741639955
                                         uncertainty =       0.002144517385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282741639955
                                         uncertainty =       0.002144517385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375979081
  error estimate for blocks of size 2^( 2) =       0.000388702692
  error estimate for blocks of size 2^( 3) =       0.000399525185
  error estimate for blocks of size 2^( 4) =       0.000407309018
  error estimate for blocks of size 2^( 5) =       0.000412195526
  error estimate for blocks of size 2^( 6) =       0.000415419829
  error estimate for blocks of size 2^( 7) =       0.000415590977

      target function =      -0.902142405000
              le_mean =     -17.212880553755
             les_mean =     296.582347252788
             stat err =       0.000412628837
             autocorr =       1.204458354980
   target nu stat err =       0.000412628837
   target dn stat err =       0.004286318489
      target stat err =       0.005447603457
              std dev =       0.531714715364
             le_variance =       0.282720538535


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721288055375e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902174474984       residual = 1.27e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902246996526       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902257877821       residual = 4.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902260894043       residual = 5.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902261116615       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902261188725       residual = 2.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902261211178       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902261226442       residual = 8.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902261226432       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902261225277       residual = 2.59e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.902261225206       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 5.899945e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902174474984       residual = 1.27e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902192771347       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902195510412       residual = 4.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902196267356       residual = 5.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902196323004       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902196341010       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902196346620       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902196350430       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902196350425       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902196350136       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.902196350119       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 1.487227e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902174474984       residual = 1.27e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902179059566       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902179745513       residual = 4.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902179934929       residual = 5.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902179948841       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902179953342       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902179954744       residual = 4.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902179955696       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902179955695       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902179955622       residual = 2.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.902179955618       residual = 4.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+02 is 3.725797e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.138483 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6494e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_001                -4.814254e-02 3 1  ON 0
ci_002                -3.770768e-02 3 1  ON 1
ci_003                -2.941733e-02 3 1  ON 2
ci_004                 2.756582e-02 3 1  ON 3
ci_005                 2.744429e-02 3 1  ON 4
ci_006                -2.487700e-02 3 1  ON 5
ci_007                -2.500238e-02 3 1  ON 6
ci_008                -1.296281e-02 3 1  ON 7
ci_009                -1.774088e-02 3 1  ON 8
ci_010                -1.419938e-02 3 1  ON 9
ci_011                -1.436498e-02 3 1  ON 10
ci_012                -1.458621e-02 3 1  ON 11
ci_013                -2.195783e-02 3 1  ON 12
ci_014                 1.571457e-02 3 1  ON 13
ci_015                 1.556794e-02 3 1  ON 14
ci_016                 1.875838e-02 3 1  ON 15
ci_017                 1.873740e-02 3 1  ON 16
ci_018                 1.368653e-02 3 1  ON 17
ci_019                 1.372647e-02 3 1  ON 18
ci_020                 1.964973e-02 3 1  ON 19
ci_021                 1.961334e-02 3 1  ON 20
ci_022                 1.246089e-02 3 1  ON 21
ci_023                 1.237031e-02 3 1  ON 22
ci_024                 1.271493e-02 3 1  ON 23
ci_025                 1.296778e-02 3 1  ON 24
ci_026                 1.384477e-02 3 1  ON 25
ci_027                 1.376292e-02 3 1  ON 26
ci_028                -1.663567e-02 3 1  ON 27
ci_029                -1.681614e-02 3 1  ON 28
ci_030                -1.149841e-02 3 1  ON 29
ci_031                -1.156253e-02 3 1  ON 30
ci_032                -1.523664e-02 3 1  ON 31
ci_033                 8.410796e-03 3 1  ON 32
ci_034                 8.464567e-03 3 1  ON 33
ci_035                -7.945574e-03 3 1  ON 34
ci_036                -1.441442e-02 3 1  ON 35
ci_037                -1.452907e-02 3 1  ON 36
ci_038                 5.104734e-03 3 1  ON 37
ci_039                 5.324512e-03 3 1  ON 38
ci_040                -5.686776e-03 3 1  ON 39
ci_041                 1.005619e-02 3 1  ON 40
ci_042                 1.051461e-02 3 1  ON 41
ci_043                -6.575401e-03 3 1  ON 42
ci_044                -7.126716e-03 3 1  ON 43
ci_045                -5.637183e-03 3 1  ON 44
ci_046                 7.859296e-03 3 1  ON 45
ci_047                 7.870273e-03 3 1  ON 46
ci_048                -1.351073e-02 3 1  ON 47
ci_049                -1.320898e-02 3 1  ON 48
ci_050                 5.176759e-03 3 1  ON 49
ci_051                 5.348209e-03 3 1  ON 50
ci_052                -4.173894e-03 3 1  ON 51
ci_053                -4.261099e-03 3 1  ON 52
ci_054                -5.106436e-03 3 1  ON 53
ci_055                -5.361749e-03 3 1  ON 54
ci_056                 7.151116e-03 3 1  ON 55
ci_057                 7.090726e-03 3 1  ON 56
ci_058                -3.881330e-03 3 1  ON 57
ci_059                -3.922897e-03 3 1  ON 58
ci_060                 6.671382e-03 3 1  ON 59
ci_061                 7.101220e-03 3 1  ON 60
ci_062                -5.868662e-03 3 1  ON 61
ci_063                -5.706123e-03 3 1  ON 62
ci_064                -4.649731e-03 3 1  ON 63
ci_065                -5.370273e-03 3 1  ON 64
ci_066                 5.617013e-03 3 1  ON 65
ci_067                 5.846026e-03 3 1  ON 66
ci_068                -5.999507e-03 3 1  ON 67
ci_069                -5.928554e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2321
    reference variance = 0.18866
====================================================
  Execution time = 1.3462e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.9169e-01
  Total weights = 1.9562e+06
  Execution time = 1.8405e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279151065488
                                         uncertainty =       0.001711848788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279151065488
                                         uncertainty =       0.001711848788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373624830
  error estimate for blocks of size 2^( 2) =       0.000386021047
  error estimate for blocks of size 2^( 3) =       0.000396921869
  error estimate for blocks of size 2^( 4) =       0.000404377427
  error estimate for blocks of size 2^( 5) =       0.000409022665
  error estimate for blocks of size 2^( 6) =       0.000411183773
  error estimate for blocks of size 2^( 7) =       0.000412757979

      target function =      -0.911584585514
              le_mean =     -17.212996292667
             les_mean =     296.578978377626
             stat err =       0.000409335461
             autocorr =       1.200293012786
   target nu stat err =       0.000409335461
   target dn stat err =       0.002162195434
      target stat err =       0.002849946957
              std dev =       0.528385301654
             le_variance =       0.279191027004

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279018653021
                                         uncertainty =       0.001709788549

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279018653021
                                         uncertainty =       0.001709788549

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373535930
  error estimate for blocks of size 2^( 2) =       0.000385944013
  error estimate for blocks of size 2^( 3) =       0.000396856684
  error estimate for blocks of size 2^( 4) =       0.000404322207
  error estimate for blocks of size 2^( 5) =       0.000408970046
  error estimate for blocks of size 2^( 6) =       0.000411133137
  error estimate for blocks of size 2^( 7) =       0.000412709891

      target function =      -0.911821994994
              le_mean =     -17.212996900386
             les_mean =     296.578815528929
             stat err =       0.000409283820
             autocorr =       1.200561432312
   target nu stat err =       0.000409283820
   target dn stat err =       0.002157296939
      target stat err =       0.002845195943
              std dev =       0.528259578384
             le_variance =       0.279058182154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279084031835
                                         uncertainty =       0.001710806836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279084031835
                                         uncertainty =       0.001710806836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373579827
  error estimate for blocks of size 2^( 2) =       0.000385982021
  error estimate for blocks of size 2^( 3) =       0.000396888811
  error estimate for blocks of size 2^( 4) =       0.000404349391
  error estimate for blocks of size 2^( 5) =       0.000408995941
  error estimate for blocks of size 2^( 6) =       0.000411158047
  error estimate for blocks of size 2^( 7) =       0.000412733535

      target function =      -0.911714735677
              le_mean =     -17.212996565879
             les_mean =     296.578887015977
             stat err =       0.000409309229
             autocorr =       1.200428340521
   target nu stat err =       0.000409309229
   target dn stat err =       0.002159415749
      target stat err =       0.002847224279
              std dev =       0.528321658061
             le_variance =       0.279123774377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279142639629
                                         uncertainty =       0.001711717965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279142639629
                                         uncertainty =       0.001711717965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373619173
  error estimate for blocks of size 2^( 2) =       0.000386016138
  error estimate for blocks of size 2^( 3) =       0.000396917707
  error estimate for blocks of size 2^( 4) =       0.000404373894
  error estimate for blocks of size 2^( 5) =       0.000409019296
  error estimate for blocks of size 2^( 6) =       0.000411180529
  error estimate for blocks of size 2^( 7) =       0.000412754895

      target function =      -0.911601664368
              le_mean =     -17.212996323102
             les_mean =     296.578966199747
             stat err =       0.000409332153
             autocorr =       1.200309959844
   target nu stat err =       0.000409332153
   target dn stat err =       0.002161811006
      target stat err =       0.002849564940
              std dev =       0.528377302320
             le_variance =       0.279182573607


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911584585514        initial
     6.2500e+00     6.2500e+01             5.8999e-05        -0.911821994994  <--
     2.5000e+01     2.5000e+02             1.4872e-05        -0.911714735677
     1.0000e+02     1.0000e+03             3.7258e-06        -0.911601664368

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.2769e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_001                -4.809881e-02 3 1  ON 0
ci_002                -3.766507e-02 3 1  ON 1
ci_003                -2.939969e-02 3 1  ON 2
ci_004                 2.754442e-02 3 1  ON 3
ci_005                 2.742874e-02 3 1  ON 4
ci_006                -2.485330e-02 3 1  ON 5
ci_007                -2.498138e-02 3 1  ON 6
ci_008                -1.292662e-02 3 1  ON 7
ci_009                -1.771563e-02 3 1  ON 8
ci_010                -1.415525e-02 3 1  ON 9
ci_011                -1.434961e-02 3 1  ON 10
ci_012                -1.455511e-02 3 1  ON 11
ci_013                -2.194800e-02 3 1  ON 12
ci_014                 1.568701e-02 3 1  ON 13
ci_015                 1.554779e-02 3 1  ON 14
ci_016                 1.874277e-02 3 1  ON 15
ci_017                 1.871899e-02 3 1  ON 16
ci_018                 1.366986e-02 3 1  ON 17
ci_019                 1.369988e-02 3 1  ON 18
ci_020                 1.964161e-02 3 1  ON 19
ci_021                 1.960390e-02 3 1  ON 20
ci_022                 1.243927e-02 3 1  ON 21
ci_023                 1.235042e-02 3 1  ON 22
ci_024                 1.269149e-02 3 1  ON 23
ci_025                 1.294103e-02 3 1  ON 24
ci_026                 1.382616e-02 3 1  ON 25
ci_027                 1.374114e-02 3 1  ON 26
ci_028                -1.662160e-02 3 1  ON 27
ci_029                -1.679613e-02 3 1  ON 28
ci_030                -1.147246e-02 3 1  ON 29
ci_031                -1.154987e-02 3 1  ON 30
ci_032                -1.523243e-02 3 1  ON 31
ci_033                 8.381110e-03 3 1  ON 32
ci_034                 8.438826e-03 3 1  ON 33
ci_035                -7.923595e-03 3 1  ON 34
ci_036                -1.440180e-02 3 1  ON 35
ci_037                -1.451478e-02 3 1  ON 36
ci_038                 5.079008e-03 3 1  ON 37
ci_039                 5.301736e-03 3 1  ON 38
ci_040                -5.660252e-03 3 1  ON 39
ci_041                 1.004878e-02 3 1  ON 40
ci_042                 1.048776e-02 3 1  ON 41
ci_043                -6.558961e-03 3 1  ON 42
ci_044                -7.113407e-03 3 1  ON 43
ci_045                -5.616375e-03 3 1  ON 44
ci_046                 7.850168e-03 3 1  ON 45
ci_047                 7.856904e-03 3 1  ON 46
ci_048                -1.350961e-02 3 1  ON 47
ci_049                -1.320090e-02 3 1  ON 48
ci_050                 5.160551e-03 3 1  ON 49
ci_051                 5.324993e-03 3 1  ON 50
ci_052                -4.157924e-03 3 1  ON 51
ci_053                -4.240647e-03 3 1  ON 52
ci_054                -5.082697e-03 3 1  ON 53
ci_055                -5.345559e-03 3 1  ON 54
ci_056                 7.152062e-03 3 1  ON 55
ci_057                 7.080843e-03 3 1  ON 56
ci_058                -3.858836e-03 3 1  ON 57
ci_059                -3.898238e-03 3 1  ON 58
ci_060                 6.660835e-03 3 1  ON 59
ci_061                 7.079291e-03 3 1  ON 60
ci_062                -5.853056e-03 3 1  ON 61
ci_063                -5.687602e-03 3 1  ON 62
ci_064                -4.638725e-03 3 1  ON 63
ci_065                -5.359759e-03 3 1  ON 64
ci_066                 5.602912e-03 3 1  ON 65
ci_067                 5.834312e-03 3 1  ON 66
ci_068                -5.990829e-03 3 1  ON 67
ci_069                -5.930320e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9278e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1145
    reference variance = 0.474709
====================================================
  Execution time = 1.3974e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.9454e-01
  Total weights = 1.956457918e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5043e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282981561595
                                         uncertainty =       0.002080604844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282981561595
                                         uncertainty =       0.002080604844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376255386
  error estimate for blocks of size 2^( 2) =       0.000388741655
  error estimate for blocks of size 2^( 3) =       0.000399457702
  error estimate for blocks of size 2^( 4) =       0.000406627572
  error estimate for blocks of size 2^( 5) =       0.000412291552
  error estimate for blocks of size 2^( 6) =       0.000416108256
  error estimate for blocks of size 2^( 7) =       0.000416560887

      target function =      -0.907877789225
              le_mean =     -17.212563045638
             les_mean =     296.566863522100
             stat err =       0.000412897067
             autocorr =       1.204254129284
   target nu stat err =       0.000412897067
   target dn stat err =       0.002634313234
      target stat err =       0.003419702613
              std dev =       0.532105469982
             le_variance =       0.283136231185


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721256304564e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907890006018       residual = 1.21e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908156395416       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908202185175       residual = 4.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908212639066       residual = 4.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908214091832       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908214701396       residual = 2.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908214790489       residual = 5.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908214822997       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908214812097       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908214805202       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908214803127       residual = 8.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 2.262838e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907890006018       residual = 1.21e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907959036617       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907970801981       residual = 4.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907973455073       residual = 4.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907973822110       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907973975877       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907973997733       residual = 5.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907974005825       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907974003113       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907974001356       residual = 3.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.907974000850       residual = 7.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 5.845305e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.907890006018       residual = 1.21e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.907907422704       residual = 1.59e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.907910384543       residual = 4.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.907911050284       residual = 4.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.907911142277       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.907911180802       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.907911186238       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.907911188258       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.907911187581       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.907911187140       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.907911187014       residual = 7.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 1.473577e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.147426 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6496e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_001                -4.804256e-02 3 1  ON 0
ci_002                -3.761867e-02 3 1  ON 1
ci_003                -2.936840e-02 3 1  ON 2
ci_004                 2.752366e-02 3 1  ON 3
ci_005                 2.739269e-02 3 1  ON 4
ci_006                -2.481740e-02 3 1  ON 5
ci_007                -2.494973e-02 3 1  ON 6
ci_008                -1.288440e-02 3 1  ON 7
ci_009                -1.768565e-02 3 1  ON 8
ci_010                -1.409680e-02 3 1  ON 9
ci_011                -1.430904e-02 3 1  ON 10
ci_012                -1.451706e-02 3 1  ON 11
ci_013                -2.192429e-02 3 1  ON 12
ci_014                 1.564973e-02 3 1  ON 13
ci_015                 1.551015e-02 3 1  ON 14
ci_016                 1.871112e-02 3 1  ON 15
ci_017                 1.869148e-02 3 1  ON 16
ci_018                 1.362626e-02 3 1  ON 17
ci_019                 1.366345e-02 3 1  ON 18
ci_020                 1.962214e-02 3 1  ON 19
ci_021                 1.957394e-02 3 1  ON 20
ci_022                 1.240747e-02 3 1  ON 21
ci_023                 1.231974e-02 3 1  ON 22
ci_024                 1.265131e-02 3 1  ON 23
ci_025                 1.291070e-02 3 1  ON 24
ci_026                 1.381854e-02 3 1  ON 25
ci_027                 1.372156e-02 3 1  ON 26
ci_028                -1.660372e-02 3 1  ON 27
ci_029                -1.678390e-02 3 1  ON 28
ci_030                -1.145742e-02 3 1  ON 29
ci_031                -1.153202e-02 3 1  ON 30
ci_032                -1.522810e-02 3 1  ON 31
ci_033                 8.357605e-03 3 1  ON 32
ci_034                 8.405429e-03 3 1  ON 33
ci_035                -7.895027e-03 3 1  ON 34
ci_036                -1.440432e-02 3 1  ON 35
ci_037                -1.449625e-02 3 1  ON 36
ci_038                 5.041169e-03 3 1  ON 37
ci_039                 5.270922e-03 3 1  ON 38
ci_040                -5.627564e-03 3 1  ON 39
ci_041                 1.002328e-02 3 1  ON 40
ci_042                 1.045903e-02 3 1  ON 41
ci_043                -6.536621e-03 3 1  ON 42
ci_044                -7.083194e-03 3 1  ON 43
ci_045                -5.588727e-03 3 1  ON 44
ci_046                 7.829719e-03 3 1  ON 45
ci_047                 7.832896e-03 3 1  ON 46
ci_048                -1.350447e-02 3 1  ON 47
ci_049                -1.320417e-02 3 1  ON 48
ci_050                 5.134811e-03 3 1  ON 49
ci_051                 5.299908e-03 3 1  ON 50
ci_052                -4.146549e-03 3 1  ON 51
ci_053                -4.219883e-03 3 1  ON 52
ci_054                -5.058519e-03 3 1  ON 53
ci_055                -5.317586e-03 3 1  ON 54
ci_056                 7.138508e-03 3 1  ON 55
ci_057                 7.063981e-03 3 1  ON 56
ci_058                -3.830017e-03 3 1  ON 57
ci_059                -3.871557e-03 3 1  ON 58
ci_060                 6.661159e-03 3 1  ON 59
ci_061                 7.067215e-03 3 1  ON 60
ci_062                -5.838531e-03 3 1  ON 61
ci_063                -5.672269e-03 3 1  ON 62
ci_064                -4.619384e-03 3 1  ON 63
ci_065                -5.343656e-03 3 1  ON 64
ci_066                 5.592548e-03 3 1  ON 65
ci_067                 5.816350e-03 3 1  ON 66
ci_068                -5.983855e-03 3 1  ON 67
ci_069                -5.907473e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2212
    reference variance = 0.285546
====================================================
  Execution time = 1.3487e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9005e-01
  Total weights = 1.9561e+06
  Execution time = 1.8355e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279112313613
                                         uncertainty =       0.001499833962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279112313613
                                         uncertainty =       0.001499833962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373517628
  error estimate for blocks of size 2^( 2) =       0.000385478734
  error estimate for blocks of size 2^( 3) =       0.000396563829
  error estimate for blocks of size 2^( 4) =       0.000404732492
  error estimate for blocks of size 2^( 5) =       0.000409108925
  error estimate for blocks of size 2^( 6) =       0.000412331517
  error estimate for blocks of size 2^( 7) =       0.000413638959

      target function =      -0.913882062866
              le_mean =     -17.214313177815
             les_mean =     296.622793921912
             stat err =       0.000409952973
             autocorr =       1.204608363434
   target nu stat err =       0.000409952973
   target dn stat err =       0.001933940813
      target stat err =       0.002580299650
              std dev =       0.528233695658
             le_variance =       0.279030837229

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278583684252
                                         uncertainty =       0.001489506659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278583684252
                                         uncertainty =       0.001489506659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373163909
  error estimate for blocks of size 2^( 2) =       0.000385174383
  error estimate for blocks of size 2^( 3) =       0.000396307707
  error estimate for blocks of size 2^( 4) =       0.000404507913
  error estimate for blocks of size 2^( 5) =       0.000408908633
  error estimate for blocks of size 2^( 6) =       0.000412142639
  error estimate for blocks of size 2^( 7) =       0.000413448248

      target function =      -0.913329278075
              le_mean =     -17.214313763390
             les_mean =     296.623238205588
             stat err =       0.000409751858
             autocorr =       1.205709259549
   target nu stat err =       0.000409751858
   target dn stat err =       0.002200872895
      target stat err =       0.002915806713
              std dev =       0.527733460610
             le_variance =       0.278502605447

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278834966805
                                         uncertainty =       0.001494443274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278834966805
                                         uncertainty =       0.001494443274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373332088
  error estimate for blocks of size 2^( 2) =       0.000385318613
  error estimate for blocks of size 2^( 3) =       0.000396428541
  error estimate for blocks of size 2^( 4) =       0.000404613469
  error estimate for blocks of size 2^( 5) =       0.000409002372
  error estimate for blocks of size 2^( 6) =       0.000412230877
  error estimate for blocks of size 2^( 7) =       0.000413537562

      target function =      -0.914272370762
              le_mean =     -17.214312943829
             les_mean =     296.622485678687
             stat err =       0.000409846070
             autocorr =       1.205177212872
   target nu stat err =       0.000409846070
   target dn stat err =       0.001927362590
      target stat err =       0.002574077102
              std dev =       0.527971301926
             le_variance =       0.278753695657

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279076881704
                                         uncertainty =       0.001499148652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279076881704
                                         uncertainty =       0.001499148652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373493930
  error estimate for blocks of size 2^( 2) =       0.000385458228
  error estimate for blocks of size 2^( 3) =       0.000396546438
  error estimate for blocks of size 2^( 4) =       0.000404717144
  error estimate for blocks of size 2^( 5) =       0.000409095149
  error estimate for blocks of size 2^( 6) =       0.000412318487
  error estimate for blocks of size 2^( 7) =       0.000413625833

      target function =      -0.913939934739
              le_mean =     -17.214313088391
             les_mean =     296.622746307273
             stat err =       0.000409939153
             autocorr =       1.204680009537
   target nu stat err =       0.000409939153
   target dn stat err =       0.001932925164
      target stat err =       0.002579327232
              std dev =       0.528200180947
             le_variance =       0.278995431153


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.913882062866        initial
     1.5625e+00     1.5625e+01             2.2628e-04        -0.913329278075
     6.2500e+00     6.2500e+01             5.8453e-05        -0.914272370762  <--
     2.5000e+01     2.5000e+02             1.4736e-05        -0.913939934739

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.2803e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_001                -4.804256e-02 3 1  ON 0
ci_002                -3.761867e-02 3 1  ON 1
ci_003                -2.936840e-02 3 1  ON 2
ci_004                 2.752366e-02 3 1  ON 3
ci_005                 2.739269e-02 3 1  ON 4
ci_006                -2.481740e-02 3 1  ON 5
ci_007                -2.494973e-02 3 1  ON 6
ci_008                -1.288440e-02 3 1  ON 7
ci_009                -1.768565e-02 3 1  ON 8
ci_010                -1.409680e-02 3 1  ON 9
ci_011                -1.430904e-02 3 1  ON 10
ci_012                -1.451706e-02 3 1  ON 11
ci_013                -2.192429e-02 3 1  ON 12
ci_014                 1.564973e-02 3 1  ON 13
ci_015                 1.551015e-02 3 1  ON 14
ci_016                 1.871112e-02 3 1  ON 15
ci_017                 1.869148e-02 3 1  ON 16
ci_018                 1.362626e-02 3 1  ON 17
ci_019                 1.366345e-02 3 1  ON 18
ci_020                 1.962214e-02 3 1  ON 19
ci_021                 1.957394e-02 3 1  ON 20
ci_022                 1.240747e-02 3 1  ON 21
ci_023                 1.231974e-02 3 1  ON 22
ci_024                 1.265131e-02 3 1  ON 23
ci_025                 1.291070e-02 3 1  ON 24
ci_026                 1.381854e-02 3 1  ON 25
ci_027                 1.372156e-02 3 1  ON 26
ci_028                -1.660372e-02 3 1  ON 27
ci_029                -1.678390e-02 3 1  ON 28
ci_030                -1.145742e-02 3 1  ON 29
ci_031                -1.153202e-02 3 1  ON 30
ci_032                -1.522810e-02 3 1  ON 31
ci_033                 8.357605e-03 3 1  ON 32
ci_034                 8.405429e-03 3 1  ON 33
ci_035                -7.895027e-03 3 1  ON 34
ci_036                -1.440432e-02 3 1  ON 35
ci_037                -1.449625e-02 3 1  ON 36
ci_038                 5.041169e-03 3 1  ON 37
ci_039                 5.270922e-03 3 1  ON 38
ci_040                -5.627564e-03 3 1  ON 39
ci_041                 1.002328e-02 3 1  ON 40
ci_042                 1.045903e-02 3 1  ON 41
ci_043                -6.536621e-03 3 1  ON 42
ci_044                -7.083194e-03 3 1  ON 43
ci_045                -5.588727e-03 3 1  ON 44
ci_046                 7.829719e-03 3 1  ON 45
ci_047                 7.832896e-03 3 1  ON 46
ci_048                -1.350447e-02 3 1  ON 47
ci_049                -1.320417e-02 3 1  ON 48
ci_050                 5.134811e-03 3 1  ON 49
ci_051                 5.299908e-03 3 1  ON 50
ci_052                -4.146549e-03 3 1  ON 51
ci_053                -4.219883e-03 3 1  ON 52
ci_054                -5.058519e-03 3 1  ON 53
ci_055                -5.317586e-03 3 1  ON 54
ci_056                 7.138508e-03 3 1  ON 55
ci_057                 7.063981e-03 3 1  ON 56
ci_058                -3.830017e-03 3 1  ON 57
ci_059                -3.871557e-03 3 1  ON 58
ci_060                 6.661159e-03 3 1  ON 59
ci_061                 7.067215e-03 3 1  ON 60
ci_062                -5.838531e-03 3 1  ON 61
ci_063                -5.672269e-03 3 1  ON 62
ci_064                -4.619384e-03 3 1  ON 63
ci_065                -5.343656e-03 3 1  ON 64
ci_066                 5.592548e-03 3 1  ON 65
ci_067                 5.816350e-03 3 1  ON 66
ci_068                -5.983855e-03 3 1  ON 67
ci_069                -5.907473e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9314e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2348
    reference variance = 0.252405
====================================================
  Execution time = 1.3942e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.9107e-01
  Total weights = 1.956240857e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4931e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278768279296
                                         uncertainty =       0.001605176230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278768279296
                                         uncertainty =       0.001605176230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373392574
  error estimate for blocks of size 2^( 2) =       0.000385325615
  error estimate for blocks of size 2^( 3) =       0.000396102331
  error estimate for blocks of size 2^( 4) =       0.000403588661
  error estimate for blocks of size 2^( 5) =       0.000408812578
  error estimate for blocks of size 2^( 6) =       0.000411195752
  error estimate for blocks of size 2^( 7) =       0.000412649821

      target function =      -0.912373231259
              le_mean =     -17.212710529463
             les_mean =     296.568473476388
             stat err =       0.000409061703
             autocorr =       1.200179739986
   target nu stat err =       0.000409061703
   target dn stat err =       0.002443082637
      target stat err =       0.003209691012
              std dev =       0.528056841959
             le_variance =       0.278844028340


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721271052946e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912383834213       residual = 1.27e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912654356604       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912696767499       residual = 4.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912709102654       residual = 5.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912710860148       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912711184407       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912711289547       residual = 4.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912711301148       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912711289315       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912711284095       residual = 2.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912711284605       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 2.347212e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912383834213       residual = 1.27e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912453962737       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912464868536       residual = 4.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912468001644       residual = 5.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912468444521       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912468525098       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912468551223       residual = 4.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912468553955       residual = 9.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912468550956       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912468549695       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912468549815       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 6.089512e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912383834213       residual = 1.27e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912401529687       residual = 1.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912404275701       residual = 4.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912405062056       residual = 5.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912405172979       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912405193088       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912405199607       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912405200279       residual = 9.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912405199527       residual = 9.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912405199214       residual = 2.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912405199244       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 1.536879e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.156446 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6453e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_001                -4.798254e-02 3 1  ON 0
ci_002                -3.757352e-02 3 1  ON 1
ci_003                -2.934295e-02 3 1  ON 2
ci_004                 2.750267e-02 3 1  ON 3
ci_005                 2.737427e-02 3 1  ON 4
ci_006                -2.478724e-02 3 1  ON 5
ci_007                -2.492468e-02 3 1  ON 6
ci_008                -1.282350e-02 3 1  ON 7
ci_009                -1.765534e-02 3 1  ON 8
ci_010                -1.404867e-02 3 1  ON 9
ci_011                -1.426236e-02 3 1  ON 10
ci_012                -1.447694e-02 3 1  ON 11
ci_013                -2.188876e-02 3 1  ON 12
ci_014                 1.561989e-02 3 1  ON 13
ci_015                 1.547741e-02 3 1  ON 14
ci_016                 1.869003e-02 3 1  ON 15
ci_017                 1.867031e-02 3 1  ON 16
ci_018                 1.360626e-02 3 1  ON 17
ci_019                 1.363025e-02 3 1  ON 18
ci_020                 1.961481e-02 3 1  ON 19
ci_021                 1.954779e-02 3 1  ON 20
ci_022                 1.238040e-02 3 1  ON 21
ci_023                 1.229747e-02 3 1  ON 22
ci_024                 1.262490e-02 3 1  ON 23
ci_025                 1.287295e-02 3 1  ON 24
ci_026                 1.379519e-02 3 1  ON 25
ci_027                 1.370132e-02 3 1  ON 26
ci_028                -1.659978e-02 3 1  ON 27
ci_029                -1.677322e-02 3 1  ON 28
ci_030                -1.143721e-02 3 1  ON 29
ci_031                -1.150570e-02 3 1  ON 30
ci_032                -1.521539e-02 3 1  ON 31
ci_033                 8.331175e-03 3 1  ON 32
ci_034                 8.388995e-03 3 1  ON 33
ci_035                -7.866585e-03 3 1  ON 34
ci_036                -1.438081e-02 3 1  ON 35
ci_037                -1.447261e-02 3 1  ON 36
ci_038                 5.008624e-03 3 1  ON 37
ci_039                 5.231654e-03 3 1  ON 38
ci_040                -5.591562e-03 3 1  ON 39
ci_041                 1.000799e-02 3 1  ON 40
ci_042                 1.043161e-02 3 1  ON 41
ci_043                -6.504601e-03 3 1  ON 42
ci_044                -7.057633e-03 3 1  ON 43
ci_045                -5.550738e-03 3 1  ON 44
ci_046                 7.807455e-03 3 1  ON 45
ci_047                 7.808152e-03 3 1  ON 46
ci_048                -1.349060e-02 3 1  ON 47
ci_049                -1.319864e-02 3 1  ON 48
ci_050                 5.111303e-03 3 1  ON 49
ci_051                 5.287029e-03 3 1  ON 50
ci_052                -4.121889e-03 3 1  ON 51
ci_053                -4.204686e-03 3 1  ON 52
ci_054                -5.034833e-03 3 1  ON 53
ci_055                -5.280671e-03 3 1  ON 54
ci_056                 7.120094e-03 3 1  ON 55
ci_057                 7.045644e-03 3 1  ON 56
ci_058                -3.816868e-03 3 1  ON 57
ci_059                -3.845448e-03 3 1  ON 58
ci_060                 6.653215e-03 3 1  ON 59
ci_061                 7.046868e-03 3 1  ON 60
ci_062                -5.816858e-03 3 1  ON 61
ci_063                -5.654286e-03 3 1  ON 62
ci_064                -4.605972e-03 3 1  ON 63
ci_065                -5.333106e-03 3 1  ON 64
ci_066                 5.586965e-03 3 1  ON 65
ci_067                 5.803749e-03 3 1  ON 66
ci_068                -5.974476e-03 3 1  ON 67
ci_069                -5.887478e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2792
    reference variance = 0.31997
====================================================
  Execution time = 1.3689e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.9443e-01
  Total weights = 1.9566e+06
  Execution time = 1.8430e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280753858038
                                         uncertainty =       0.001764851923

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280753858038
                                         uncertainty =       0.001764851923

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374670961
  error estimate for blocks of size 2^( 2) =       0.000387108598
  error estimate for blocks of size 2^( 3) =       0.000398295393
  error estimate for blocks of size 2^( 4) =       0.000406381334
  error estimate for blocks of size 2^( 5) =       0.000411321749
  error estimate for blocks of size 2^( 6) =       0.000413459461
  error estimate for blocks of size 2^( 7) =       0.000415250911

      target function =      -0.907939403419
              le_mean =     -17.212982246534
             les_mean =     296.581322897395
             stat err =       0.000411603364
             autocorr =       1.206862413982
   target nu stat err =       0.000411603364
   target dn stat err =       0.002890738713
      target stat err =       0.003746026893
              std dev =       0.529864754575
             le_variance =       0.280756658141

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280246136280
                                         uncertainty =       0.001760429128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280246136280
                                         uncertainty =       0.001760429128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374332345
  error estimate for blocks of size 2^( 2) =       0.000386815079
  error estimate for blocks of size 2^( 3) =       0.000398044952
  error estimate for blocks of size 2^( 4) =       0.000406150389
  error estimate for blocks of size 2^( 5) =       0.000411118698
  error estimate for blocks of size 2^( 6) =       0.000413264651
  error estimate for blocks of size 2^( 7) =       0.000415060973

      target function =      -0.908382665935
              le_mean =     -17.212986206218
             les_mean =     296.581113838952
             stat err =       0.000411398678
             autocorr =       1.207844634181
   target nu stat err =       0.000411398678
   target dn stat err =       0.002895053099
      target stat err =       0.003755082427
              std dev =       0.529385878663
             le_variance =       0.280249408528

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280487267159
                                         uncertainty =       0.001762512430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280487267159
                                         uncertainty =       0.001762512430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374493199
  error estimate for blocks of size 2^( 2) =       0.000386954070
  error estimate for blocks of size 2^( 3) =       0.000398163077
  error estimate for blocks of size 2^( 4) =       0.000406259092
  error estimate for blocks of size 2^( 5) =       0.000411213886
  error estimate for blocks of size 2^( 6) =       0.000413355903
  error estimate for blocks of size 2^( 7) =       0.000415150063

      target function =      -0.908226689699
              le_mean =     -17.212983802378
             les_mean =     296.581152535663
             stat err =       0.000411494736
             autocorr =       1.207370879738
   target nu stat err =       0.000411494736
   target dn stat err =       0.002875382594
      target stat err =       0.003728920855
              std dev =       0.529613361478
             le_variance =       0.280490312656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280719784602
                                         uncertainty =       0.001764549952

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280719784602
                                         uncertainty =       0.001764549952

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374648246
  error estimate for blocks of size 2^( 2) =       0.000387088798
  error estimate for blocks of size 2^( 3) =       0.000398278383
  error estimate for blocks of size 2^( 4) =       0.000406365589
  error estimate for blocks of size 2^( 5) =       0.000411307807
  error estimate for blocks of size 2^( 6) =       0.000413446058
  error estimate for blocks of size 2^( 7) =       0.000415237866

      target function =      -0.907990021253
              le_mean =     -17.212982387719
             les_mean =     296.581288272527
             stat err =       0.000411589330
             autocorr =       1.206926460317
   target nu stat err =       0.000411589330
   target dn stat err =       0.002887601399
      target stat err =       0.003742468833
              std dev =       0.529832630006
             le_variance =       0.280722615819


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.907939403419        initial
     1.5625e+00     1.5625e+01             2.3472e-04        -0.908382665935  <--
     6.2500e+00     6.2500e+01             6.0895e-05        -0.908226689699
     2.5000e+01     2.5000e+02             1.5369e-05        -0.907990021253

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.3025e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_001                -4.780928e-02 3 1  ON 0
ci_002                -3.744351e-02 3 1  ON 1
ci_003                -2.926893e-02 3 1  ON 2
ci_004                 2.744202e-02 3 1  ON 3
ci_005                 2.732106e-02 3 1  ON 4
ci_006                -2.470043e-02 3 1  ON 5
ci_007                -2.485272e-02 3 1  ON 6
ci_008                -1.264968e-02 3 1  ON 7
ci_009                -1.756851e-02 3 1  ON 8
ci_010                -1.391061e-02 3 1  ON 9
ci_011                -1.412851e-02 3 1  ON 10
ci_012                -1.436186e-02 3 1  ON 11
ci_013                -2.178609e-02 3 1  ON 12
ci_014                 1.553438e-02 3 1  ON 13
ci_015                 1.538337e-02 3 1  ON 14
ci_016                 1.862955e-02 3 1  ON 15
ci_017                 1.860965e-02 3 1  ON 16
ci_018                 1.354884e-02 3 1  ON 17
ci_019                 1.353535e-02 3 1  ON 18
ci_020                 1.959350e-02 3 1  ON 19
ci_021                 1.947240e-02 3 1  ON 20
ci_022                 1.230278e-02 3 1  ON 21
ci_023                 1.223376e-02 3 1  ON 22
ci_024                 1.254856e-02 3 1  ON 23
ci_025                 1.276390e-02 3 1  ON 24
ci_026                 1.372829e-02 3 1  ON 25
ci_027                 1.364341e-02 3 1  ON 26
ci_028                -1.658864e-02 3 1  ON 27
ci_029                -1.674239e-02 3 1  ON 28
ci_030                -1.137910e-02 3 1  ON 29
ci_031                -1.143034e-02 3 1  ON 30
ci_032                -1.517892e-02 3 1  ON 31
ci_033                 8.255149e-03 3 1  ON 32
ci_034                 8.341694e-03 3 1  ON 33
ci_035                -7.785211e-03 3 1  ON 34
ci_036                -1.431305e-02 3 1  ON 35
ci_037                -1.440447e-02 3 1  ON 36
ci_038                 4.915551e-03 3 1  ON 37
ci_039                 5.119423e-03 3 1  ON 38
ci_040                -5.488721e-03 3 1  ON 39
ci_041                 9.964413e-03 3 1  ON 40
ci_042                 1.035330e-02 3 1  ON 41
ci_043                -6.412938e-03 3 1  ON 42
ci_044                -6.984242e-03 3 1  ON 43
ci_045                -5.442205e-03 3 1  ON 44
ci_046                 7.743474e-03 3 1  ON 45
ci_047                 7.737014e-03 3 1  ON 46
ci_048                -1.345079e-02 3 1  ON 47
ci_049                -1.318284e-02 3 1  ON 48
ci_050                 5.044249e-03 3 1  ON 49
ci_051                 5.250295e-03 3 1  ON 50
ci_052                -4.051572e-03 3 1  ON 51
ci_053                -4.161417e-03 3 1  ON 52
ci_054                -4.966816e-03 3 1  ON 53
ci_055                -5.174756e-03 3 1  ON 54
ci_056                 7.067322e-03 3 1  ON 55
ci_057                 6.993115e-03 3 1  ON 56
ci_058                -3.779543e-03 3 1  ON 57
ci_059                -3.771002e-03 3 1  ON 58
ci_060                 6.630359e-03 3 1  ON 59
ci_061                 6.988359e-03 3 1  ON 60
ci_062                -5.754595e-03 3 1  ON 61
ci_063                -5.602504e-03 3 1  ON 62
ci_064                -4.567688e-03 3 1  ON 63
ci_065                -5.302947e-03 3 1  ON 64
ci_066                 5.571121e-03 3 1  ON 65
ci_067                 5.767698e-03 3 1  ON 66
ci_068                -5.947695e-03 3 1  ON 67
ci_069                -5.830199e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9492e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1732
    reference variance = 0.37273
====================================================
  Execution time = 1.4031e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5256e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9195e-01
  Total weights = 1.956069626e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4769e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279899328184
                                         uncertainty =       0.001707538228

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279899328184
                                         uncertainty =       0.001707538228

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374094866
  error estimate for blocks of size 2^( 2) =       0.000386589925
  error estimate for blocks of size 2^( 3) =       0.000397449599
  error estimate for blocks of size 2^( 4) =       0.000404854949
  error estimate for blocks of size 2^( 5) =       0.000410239635
  error estimate for blocks of size 2^( 6) =       0.000412077349
  error estimate for blocks of size 2^( 7) =       0.000411867127

      target function =      -0.911072812168
              le_mean =     -17.212033464627
             les_mean =     296.546044203883
             stat err =       0.000409759765
             autocorr =       1.199762072667
   target nu stat err =       0.000409759765
   target dn stat err =       0.002417874709
      target stat err =       0.003165607876
              std dev =       0.529050032628
             le_variance =       0.279893937023


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721203346463e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911082935997       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911955189100       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912100419398       residual = 3.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912144041673       residual = 5.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912148883419       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912149287804       residual = 2.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912149593696       residual = 4.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912149793656       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912149718645       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912149710856       residual = 3.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912149703656       residual = 7.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 7.211112e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911082935997       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911332091851       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911372439730       residual = 3.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911384106113       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911385347262       residual = 9.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911385445820       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911385515530       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911385570590       residual = 9.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911385551279       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911385549191       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911385547602       residual = 5.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 2.012786e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911082935997       residual = 1.22e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911147525056       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911157897786       residual = 3.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911160863261       residual = 4.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911161174767       residual = 9.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911161199205       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911161216082       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911161230164       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911161225311       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911161224785       residual = 2.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911161224403       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 5.221731e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.165513 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6525e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_001                -4.760826e-02 3 1  ON 0
ci_002                -3.730783e-02 3 1  ON 1
ci_003                -2.915342e-02 3 1  ON 2
ci_004                 2.736845e-02 3 1  ON 3
ci_005                 2.721665e-02 3 1  ON 4
ci_006                -2.457433e-02 3 1  ON 5
ci_007                -2.471211e-02 3 1  ON 6
ci_008                -1.244840e-02 3 1  ON 7
ci_009                -1.745325e-02 3 1  ON 8
ci_010                -1.373023e-02 3 1  ON 9
ci_011                -1.403117e-02 3 1  ON 10
ci_012                -1.421984e-02 3 1  ON 11
ci_013                -2.167213e-02 3 1  ON 12
ci_014                 1.542515e-02 3 1  ON 13
ci_015                 1.530561e-02 3 1  ON 14
ci_016                 1.854059e-02 3 1  ON 15
ci_017                 1.852065e-02 3 1  ON 16
ci_018                 1.346613e-02 3 1  ON 17
ci_019                 1.341661e-02 3 1  ON 18
ci_020                 1.953017e-02 3 1  ON 19
ci_021                 1.942969e-02 3 1  ON 20
ci_022                 1.220673e-02 3 1  ON 21
ci_023                 1.213653e-02 3 1  ON 22
ci_024                 1.241573e-02 3 1  ON 23
ci_025                 1.264997e-02 3 1  ON 24
ci_026                 1.357306e-02 3 1  ON 25
ci_027                 1.354536e-02 3 1  ON 26
ci_028                -1.654259e-02 3 1  ON 27
ci_029                -1.667411e-02 3 1  ON 28
ci_030                -1.127248e-02 3 1  ON 29
ci_031                -1.132815e-02 3 1  ON 30
ci_032                -1.510330e-02 3 1  ON 31
ci_033                 8.147388e-03 3 1  ON 32
ci_034                 8.240032e-03 3 1  ON 33
ci_035                -7.659480e-03 3 1  ON 34
ci_036                -1.429066e-02 3 1  ON 35
ci_037                -1.427815e-02 3 1  ON 36
ci_038                 4.760949e-03 3 1  ON 37
ci_039                 4.980566e-03 3 1  ON 38
ci_040                -5.394613e-03 3 1  ON 39
ci_041                 9.933968e-03 3 1  ON 40
ci_042                 1.030544e-02 3 1  ON 41
ci_043                -6.305306e-03 3 1  ON 42
ci_044                -6.849055e-03 3 1  ON 43
ci_045                -5.335773e-03 3 1  ON 44
ci_046                 7.639340e-03 3 1  ON 45
ci_047                 7.672600e-03 3 1  ON 46
ci_048                -1.339406e-02 3 1  ON 47
ci_049                -1.315796e-02 3 1  ON 48
ci_050                 4.924036e-03 3 1  ON 49
ci_051                 5.150685e-03 3 1  ON 50
ci_052                -3.993679e-03 3 1  ON 51
ci_053                -4.074675e-03 3 1  ON 52
ci_054                -4.870248e-03 3 1  ON 53
ci_055                -5.071238e-03 3 1  ON 54
ci_056                 7.044654e-03 3 1  ON 55
ci_057                 6.929348e-03 3 1  ON 56
ci_058                -3.710510e-03 3 1  ON 57
ci_059                -3.682101e-03 3 1  ON 58
ci_060                 6.549252e-03 3 1  ON 59
ci_061                 6.903857e-03 3 1  ON 60
ci_062                -5.701370e-03 3 1  ON 61
ci_063                -5.576101e-03 3 1  ON 62
ci_064                -4.506386e-03 3 1  ON 63
ci_065                -5.225682e-03 3 1  ON 64
ci_066                 5.538250e-03 3 1  ON 65
ci_067                 5.703915e-03 3 1  ON 66
ci_068                -5.925600e-03 3 1  ON 67
ci_069                -5.791424e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2871
    reference variance = 0.146775
====================================================
  Execution time = 1.3614e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.9148e-01
  Total weights = 1.9565e+06
  Execution time = 1.8404e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279012147884
                                         uncertainty =       0.001582628782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279012147884
                                         uncertainty =       0.001582628782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373473470
  error estimate for blocks of size 2^( 2) =       0.000386108156
  error estimate for blocks of size 2^( 3) =       0.000397016594
  error estimate for blocks of size 2^( 4) =       0.000404475928
  error estimate for blocks of size 2^( 5) =       0.000409619985
  error estimate for blocks of size 2^( 6) =       0.000411000729
  error estimate for blocks of size 2^( 7) =       0.000412386231

      target function =      -0.911326009521
              le_mean =     -17.212910769262
             les_mean =     296.576217521180
             stat err =       0.000409370718
             autocorr =       1.201473058981
   target nu stat err =       0.000409370718
   target dn stat err =       0.002288857350
      target stat err =       0.003008115694
              std dev =       0.528171246346
             le_variance =       0.278964865467

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277672589396
                                         uncertainty =       0.001584290486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277672589396
                                         uncertainty =       0.001584290486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372575895
  error estimate for blocks of size 2^( 2) =       0.000385371008
  error estimate for blocks of size 2^( 3) =       0.000396423901
  error estimate for blocks of size 2^( 4) =       0.000404001292
  error estimate for blocks of size 2^( 5) =       0.000409243433
  error estimate for blocks of size 2^( 6) =       0.000410622569
  error estimate for blocks of size 2^( 7) =       0.000412020585

      target function =      -0.908169177893
              le_mean =     -17.212931585696
             les_mean =     296.579384048283
             stat err =       0.000408971970
             autocorr =       1.204918240675
   target nu stat err =       0.000408971970
   target dn stat err =       0.003550510218
      target stat err =       0.004583862803
              std dev =       0.526901883842
             le_variance =       0.277625595196

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278208544459
                                         uncertainty =       0.001582486264

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278208544459
                                         uncertainty =       0.001582486264

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372935286
  error estimate for blocks of size 2^( 2) =       0.000385659775
  error estimate for blocks of size 2^( 3) =       0.000396648710
  error estimate for blocks of size 2^( 4) =       0.000404175135
  error estimate for blocks of size 2^( 5) =       0.000409373414
  error estimate for blocks of size 2^( 6) =       0.000410749238
  error estimate for blocks of size 2^( 7) =       0.000412143335

      target function =      -0.907607886630
              le_mean =     -17.212916538145
             les_mean =     296.579301894909
             stat err =       0.000409110280
             autocorr =       1.203410596873
   target nu stat err =       0.000409110280
   target dn stat err =       0.003535153397
      target stat err =       0.004558672945
              std dev =       0.527410139553
             le_variance =       0.278161455303

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278901664743
                                         uncertainty =       0.001582444622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278901664743
                                         uncertainty =       0.001582444622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373399526
  error estimate for blocks of size 2^( 2) =       0.000386045688
  error estimate for blocks of size 2^( 3) =       0.000396964421
  error estimate for blocks of size 2^( 4) =       0.000404432413
  error estimate for blocks of size 2^( 5) =       0.000409583671
  error estimate for blocks of size 2^( 6) =       0.000410963852
  error estimate for blocks of size 2^( 7) =       0.000412350316

      target function =      -0.911508167256
              le_mean =     -17.212910678640
             les_mean =     296.576073143558
             stat err =       0.000409332563
             autocorr =       1.201724913931
   target nu stat err =       0.000409332563
   target dn stat err =       0.002291784408
      target stat err =       0.003012991124
              std dev =       0.528066673971
             le_variance =       0.278854412159


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.911326009521        initial
     3.9062e-01     3.9062e+00             7.2111e-04        -0.908169177893
     1.5625e+00     1.5625e+01             2.0128e-04        -0.907607886630
     6.2500e+00     6.2500e+01             5.2217e-05        -0.911508167256  <--

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.2936e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_001                -4.775754e-02 3 1  ON 0
ci_002                -3.740849e-02 3 1  ON 1
ci_003                -2.923929e-02 3 1  ON 2
ci_004                 2.742318e-02 3 1  ON 3
ci_005                 2.729422e-02 3 1  ON 4
ci_006                -2.466792e-02 3 1  ON 5
ci_007                -2.481651e-02 3 1  ON 6
ci_008                -1.259746e-02 3 1  ON 7
ci_009                -1.753870e-02 3 1  ON 8
ci_010                -1.386402e-02 3 1  ON 9
ci_011                -1.410335e-02 3 1  ON 10
ci_012                -1.432517e-02 3 1  ON 11
ci_013                -2.175680e-02 3 1  ON 12
ci_014                 1.550612e-02 3 1  ON 13
ci_015                 1.536326e-02 3 1  ON 14
ci_016                 1.860657e-02 3 1  ON 15
ci_017                 1.858665e-02 3 1  ON 16
ci_018                 1.352744e-02 3 1  ON 17
ci_019                 1.350462e-02 3 1  ON 18
ci_020                 1.957721e-02 3 1  ON 19
ci_021                 1.946140e-02 3 1  ON 20
ci_022                 1.227793e-02 3 1  ON 21
ci_023                 1.220861e-02 3 1  ON 22
ci_024                 1.251439e-02 3 1  ON 23
ci_025                 1.273459e-02 3 1  ON 24
ci_026                 1.368808e-02 3 1  ON 25
ci_027                 1.361805e-02 3 1  ON 26
ci_028                -1.657671e-02 3 1  ON 27
ci_029                -1.672473e-02 3 1  ON 28
ci_030                -1.135152e-02 3 1  ON 29
ci_031                -1.140390e-02 3 1  ON 30
ci_032                -1.515940e-02 3 1  ON 31
ci_033                 8.227361e-03 3 1  ON 32
ci_034                 8.315452e-03 3 1  ON 33
ci_035                -7.752655e-03 3 1  ON 34
ci_036                -1.430741e-02 3 1  ON 35
ci_037                -1.437186e-02 3 1  ON 36
ci_038                 4.875500e-03 3 1  ON 37
ci_039                 5.083447e-03 3 1  ON 38
ci_040                -5.464328e-03 3 1  ON 39
ci_041                 9.956521e-03 3 1  ON 40
ci_042                 1.034090e-02 3 1  ON 41
ci_043                -6.385074e-03 3 1  ON 42
ci_044                -6.949304e-03 3 1  ON 43
ci_045                -5.414605e-03 3 1  ON 44
ci_046                 7.716595e-03 3 1  ON 45
ci_047                 7.720380e-03 3 1  ON 46
ci_048                -1.343615e-02 3 1  ON 47
ci_049                -1.317641e-02 3 1  ON 48
ci_050                 5.013020e-03 3 1  ON 49
ci_051                 5.224432e-03 3 1  ON 50
ci_052                -4.036519e-03 3 1  ON 51
ci_053                -4.138904e-03 3 1  ON 52
ci_054                -4.941874e-03 3 1  ON 53
ci_055                -5.148027e-03 3 1  ON 54
ci_056                 7.061478e-03 3 1  ON 55
ci_057                 6.976614e-03 3 1  ON 56
ci_058                -3.761626e-03 3 1  ON 57
ci_059                -3.747894e-03 3 1  ON 58
ci_060                 6.609463e-03 3 1  ON 59
ci_061                 6.966559e-03 3 1  ON 60
ci_062                -5.740889e-03 3 1  ON 61
ci_063                -5.595725e-03 3 1  ON 62
ci_064                -4.551784e-03 3 1  ON 63
ci_065                -5.282922e-03 3 1  ON 64
ci_066                 5.562586e-03 3 1  ON 65
ci_067                 5.751166e-03 3 1  ON 66
ci_068                -5.941958e-03 3 1  ON 67
ci_069                -5.820163e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9476e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1523
    reference variance = 0.250449
====================================================
  Execution time = 1.3855e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9369e-01
  Total weights = 1.956315093e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4836e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281545303067
                                         uncertainty =       0.001720351387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281545303067
                                         uncertainty =       0.001720351387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375258204
  error estimate for blocks of size 2^( 2) =       0.000388002259
  error estimate for blocks of size 2^( 3) =       0.000399092921
  error estimate for blocks of size 2^( 4) =       0.000407526205
  error estimate for blocks of size 2^( 5) =       0.000411490532
  error estimate for blocks of size 2^( 6) =       0.000413726614
  error estimate for blocks of size 2^( 7) =       0.000414624409

      target function =      -0.909203849707
              le_mean =     -17.213532806908
             les_mean =     296.599399138696
             stat err =       0.000411841940
             autocorr =       1.204483209723
   target nu stat err =       0.000411841940
   target dn stat err =       0.002140252436
      target stat err =       0.002810885913
              std dev =       0.530695241454
             le_variance =       0.281637439302


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721353280691e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909211658677       residual = 1.20e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909468324452       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909513138200       residual = 3.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909522617533       residual = 4.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909523663295       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909523820445       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909523849073       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909523896908       residual = 1.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909523873489       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909523867041       residual = 3.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.909523867013       residual = 6.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 2.070733e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909211658677       residual = 1.20e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909278188274       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909289698676       residual = 3.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909292105171       residual = 4.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909292367256       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909292406651       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909292413544       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909292425523       residual = 9.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909292419658       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909292418074       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.909292418078       residual = 6.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 5.369129e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909211658677       residual = 1.20e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909228445589       residual = 1.62e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909231342965       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909231946875       residual = 4.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909232012424       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909232022278       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909232023984       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909232026979       residual = 9.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909232025513       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909232025119       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.909232025120       residual = 5.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 1.355160e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.174513 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6356e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_001                -4.770544e-02 3 1  ON 0
ci_002                -3.735512e-02 3 1  ON 1
ci_003                -2.921485e-02 3 1  ON 2
ci_004                 2.739496e-02 3 1  ON 3
ci_005                 2.725952e-02 3 1  ON 4
ci_006                -2.462599e-02 3 1  ON 5
ci_007                -2.478443e-02 3 1  ON 6
ci_008                -1.254377e-02 3 1  ON 7
ci_009                -1.749573e-02 3 1  ON 8
ci_010                -1.381695e-02 3 1  ON 9
ci_011                -1.405249e-02 3 1  ON 10
ci_012                -1.428463e-02 3 1  ON 11
ci_013                -2.174307e-02 3 1  ON 12
ci_014                 1.547943e-02 3 1  ON 13
ci_015                 1.532899e-02 3 1  ON 14
ci_016                 1.858731e-02 3 1  ON 15
ci_017                 1.856179e-02 3 1  ON 16
ci_018                 1.350732e-02 3 1  ON 17
ci_019                 1.346904e-02 3 1  ON 18
ci_020                 1.956567e-02 3 1  ON 19
ci_021                 1.944321e-02 3 1  ON 20
ci_022                 1.225308e-02 3 1  ON 21
ci_023                 1.218666e-02 3 1  ON 22
ci_024                 1.248723e-02 3 1  ON 23
ci_025                 1.270692e-02 3 1  ON 24
ci_026                 1.367191e-02 3 1  ON 25
ci_027                 1.359629e-02 3 1  ON 26
ci_028                -1.656809e-02 3 1  ON 27
ci_029                -1.671272e-02 3 1  ON 28
ci_030                -1.131085e-02 3 1  ON 29
ci_031                -1.138437e-02 3 1  ON 30
ci_032                -1.514111e-02 3 1  ON 31
ci_033                 8.197967e-03 3 1  ON 32
ci_034                 8.283092e-03 3 1  ON 33
ci_035                -7.729153e-03 3 1  ON 34
ci_036                -1.428784e-02 3 1  ON 35
ci_037                -1.436777e-02 3 1  ON 36
ci_038                 4.844280e-03 3 1  ON 37
ci_039                 5.047355e-03 3 1  ON 38
ci_040                -5.434583e-03 3 1  ON 39
ci_041                 9.939034e-03 3 1  ON 40
ci_042                 1.032278e-02 3 1  ON 41
ci_043                -6.357648e-03 3 1  ON 42
ci_044                -6.908682e-03 3 1  ON 43
ci_045                -5.391726e-03 3 1  ON 44
ci_046                 7.692999e-03 3 1  ON 45
ci_047                 7.690402e-03 3 1  ON 46
ci_048                -1.343886e-02 3 1  ON 47
ci_049                -1.318521e-02 3 1  ON 48
ci_050                 4.986911e-03 3 1  ON 49
ci_051                 5.207979e-03 3 1  ON 50
ci_052                -4.033415e-03 3 1  ON 51
ci_053                -4.117140e-03 3 1  ON 52
ci_054                -4.909599e-03 3 1  ON 53
ci_055                -5.131703e-03 3 1  ON 54
ci_056                 7.048003e-03 3 1  ON 55
ci_057                 6.965421e-03 3 1  ON 56
ci_058                -3.728936e-03 3 1  ON 57
ci_059                -3.736120e-03 3 1  ON 58
ci_060                 6.597579e-03 3 1  ON 59
ci_061                 6.954053e-03 3 1  ON 60
ci_062                -5.719632e-03 3 1  ON 61
ci_063                -5.574319e-03 3 1  ON 62
ci_064                -4.531476e-03 3 1  ON 63
ci_065                -5.265503e-03 3 1  ON 64
ci_066                 5.547322e-03 3 1  ON 65
ci_067                 5.739086e-03 3 1  ON 66
ci_068                -5.933578e-03 3 1  ON 67
ci_069                -5.805394e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.2048
    reference variance = 0.259026
====================================================
  Execution time = 1.3651e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.9513e-01
  Total weights = 1.9563e+06
  Execution time = 1.8363e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282127035016
                                         uncertainty =       0.002107471699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282127035016
                                         uncertainty =       0.002107471699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375581665
  error estimate for blocks of size 2^( 2) =       0.000387907804
  error estimate for blocks of size 2^( 3) =       0.000398848765
  error estimate for blocks of size 2^( 4) =       0.000407337303
  error estimate for blocks of size 2^( 5) =       0.000412620882
  error estimate for blocks of size 2^( 6) =       0.000415490474
  error estimate for blocks of size 2^( 7) =       0.000418199265

      target function =      -0.907095549869
              le_mean =     -17.213146292953
             les_mean =     296.587662090568
             stat err =       0.000413411981
             autocorr =       1.211594666297
   target nu stat err =       0.000413411981
   target dn stat err =       0.002707758561
      target stat err =       0.003509654219
              std dev =       0.531152683991
             le_variance =       0.282123173711

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281657429295
                                         uncertainty =       0.002098755505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281657429295
                                         uncertainty =       0.002098755505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375269115
  error estimate for blocks of size 2^( 2) =       0.000387641423
  error estimate for blocks of size 2^( 3) =       0.000398630512
  error estimate for blocks of size 2^( 4) =       0.000407154118
  error estimate for blocks of size 2^( 5) =       0.000412462007
  error estimate for blocks of size 2^( 6) =       0.000415346450
  error estimate for blocks of size 2^( 7) =       0.000418071848

      target function =      -0.907285628280
              le_mean =     -17.213146472523
             les_mean =     296.587519544147
             stat err =       0.000413258606
             autocorr =       1.212713370500
   target nu stat err =       0.000413258606
   target dn stat err =       0.002717818581
      target stat err =       0.003523756714
              std dev =       0.530710672503
             le_variance =       0.281653817908

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281880533214
                                         uncertainty =       0.002102872929

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281880533214
                                         uncertainty =       0.002102872929

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375417636
  error estimate for blocks of size 2^( 2) =       0.000387767575
  error estimate for blocks of size 2^( 3) =       0.000398733372
  error estimate for blocks of size 2^( 4) =       0.000407239984
  error estimate for blocks of size 2^( 5) =       0.000412536126
  error estimate for blocks of size 2^( 6) =       0.000415413302
  error estimate for blocks of size 2^( 7) =       0.000418130760

      target function =      -0.907313922635
              le_mean =     -17.213145898600
             les_mean =     296.587477640438
             stat err =       0.000413330043
             autocorr =       1.212173001426
   target nu stat err =       0.000413330043
   target dn stat err =       0.002706370043
      target stat err =       0.003509548625
              std dev =       0.530920711961
             le_variance =       0.281876802389

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282095529016
                                         uncertainty =       0.002106881873

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282095529016
                                         uncertainty =       0.002106881873

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375560704
  error estimate for blocks of size 2^( 2) =       0.000387889847
  error estimate for blocks of size 2^( 3) =       0.000398833929
  error estimate for blocks of size 2^( 4) =       0.000407324741
  error estimate for blocks of size 2^( 5) =       0.000412609901
  error estimate for blocks of size 2^( 6) =       0.000415480453
  error estimate for blocks of size 2^( 7) =       0.000418190335

      target function =      -0.907161716418
              le_mean =     -17.213146190176
             les_mean =     296.587606772464
             stat err =       0.000413401358
             autocorr =       1.211667638962
   target nu stat err =       0.000413401358
   target dn stat err =       0.002707307442
      target stat err =       0.003509587450
              std dev =       0.531123040578
             le_variance =       0.282091684233


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.907095549869        initial
     1.5625e+00     1.5625e+01             2.0707e-04        -0.907285628280
     6.2500e+00     6.2500e+01             5.3691e-05        -0.907313922635  <--
     2.5000e+01     2.5000e+02             1.3552e-05        -0.907161716418

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.2975e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_001                -4.770544e-02 3 1  ON 0
ci_002                -3.735512e-02 3 1  ON 1
ci_003                -2.921485e-02 3 1  ON 2
ci_004                 2.739496e-02 3 1  ON 3
ci_005                 2.725952e-02 3 1  ON 4
ci_006                -2.462599e-02 3 1  ON 5
ci_007                -2.478443e-02 3 1  ON 6
ci_008                -1.254377e-02 3 1  ON 7
ci_009                -1.749573e-02 3 1  ON 8
ci_010                -1.381695e-02 3 1  ON 9
ci_011                -1.405249e-02 3 1  ON 10
ci_012                -1.428463e-02 3 1  ON 11
ci_013                -2.174307e-02 3 1  ON 12
ci_014                 1.547943e-02 3 1  ON 13
ci_015                 1.532899e-02 3 1  ON 14
ci_016                 1.858731e-02 3 1  ON 15
ci_017                 1.856179e-02 3 1  ON 16
ci_018                 1.350732e-02 3 1  ON 17
ci_019                 1.346904e-02 3 1  ON 18
ci_020                 1.956567e-02 3 1  ON 19
ci_021                 1.944321e-02 3 1  ON 20
ci_022                 1.225308e-02 3 1  ON 21
ci_023                 1.218666e-02 3 1  ON 22
ci_024                 1.248723e-02 3 1  ON 23
ci_025                 1.270692e-02 3 1  ON 24
ci_026                 1.367191e-02 3 1  ON 25
ci_027                 1.359629e-02 3 1  ON 26
ci_028                -1.656809e-02 3 1  ON 27
ci_029                -1.671272e-02 3 1  ON 28
ci_030                -1.131085e-02 3 1  ON 29
ci_031                -1.138437e-02 3 1  ON 30
ci_032                -1.514111e-02 3 1  ON 31
ci_033                 8.197967e-03 3 1  ON 32
ci_034                 8.283092e-03 3 1  ON 33
ci_035                -7.729153e-03 3 1  ON 34
ci_036                -1.428784e-02 3 1  ON 35
ci_037                -1.436777e-02 3 1  ON 36
ci_038                 4.844280e-03 3 1  ON 37
ci_039                 5.047355e-03 3 1  ON 38
ci_040                -5.434583e-03 3 1  ON 39
ci_041                 9.939034e-03 3 1  ON 40
ci_042                 1.032278e-02 3 1  ON 41
ci_043                -6.357648e-03 3 1  ON 42
ci_044                -6.908682e-03 3 1  ON 43
ci_045                -5.391726e-03 3 1  ON 44
ci_046                 7.692999e-03 3 1  ON 45
ci_047                 7.690402e-03 3 1  ON 46
ci_048                -1.343886e-02 3 1  ON 47
ci_049                -1.318521e-02 3 1  ON 48
ci_050                 4.986911e-03 3 1  ON 49
ci_051                 5.207979e-03 3 1  ON 50
ci_052                -4.033415e-03 3 1  ON 51
ci_053                -4.117140e-03 3 1  ON 52
ci_054                -4.909599e-03 3 1  ON 53
ci_055                -5.131703e-03 3 1  ON 54
ci_056                 7.048003e-03 3 1  ON 55
ci_057                 6.965421e-03 3 1  ON 56
ci_058                -3.728936e-03 3 1  ON 57
ci_059                -3.736120e-03 3 1  ON 58
ci_060                 6.597579e-03 3 1  ON 59
ci_061                 6.954053e-03 3 1  ON 60
ci_062                -5.719632e-03 3 1  ON 61
ci_063                -5.574319e-03 3 1  ON 62
ci_064                -4.531476e-03 3 1  ON 63
ci_065                -5.265503e-03 3 1  ON 64
ci_066                 5.547322e-03 3 1  ON 65
ci_067                 5.739086e-03 3 1  ON 66
ci_068                -5.933578e-03 3 1  ON 67
ci_069                -5.805394e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9345e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.175
    reference variance = 0.147566
====================================================
  Execution time = 1.3968e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.9997e-01
  Total weights = 1.956515228e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.7313e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283525555193
                                         uncertainty =       0.001706766409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283525555193
                                         uncertainty =       0.001706766409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376495406
  error estimate for blocks of size 2^( 2) =       0.000389060733
  error estimate for blocks of size 2^( 3) =       0.000399874498
  error estimate for blocks of size 2^( 4) =       0.000408148764
  error estimate for blocks of size 2^( 5) =       0.000412778509
  error estimate for blocks of size 2^( 6) =       0.000416151123
  error estimate for blocks of size 2^( 7) =       0.000417724079

      target function =      -0.901071273875
              le_mean =     -17.212997338546
             les_mean =     296.587246251250
             stat err =       0.000413700619
             autocorr =       1.207405025103
   target nu stat err =       0.000413700619
   target dn stat err =       0.003437204068
      target stat err =       0.004372695060
              std dev =       0.532444908844
             le_variance =       0.283497580954


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721299733855e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901091724478       residual = 1.71e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901418865210       residual = 2.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901477844411       residual = 4.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901490974203       residual = 5.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901492353444       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901492508532       residual = 2.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901492653833       residual = 6.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901492752510       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901492764456       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901492765556       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.901492760895       residual = 9.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 2.222238e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901091724478       residual = 1.71e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901176541784       residual = 2.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901191690699       residual = 4.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901195023218       residual = 5.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901195368551       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901195406739       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901195443262       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901195467699       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901195470666       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901195470882       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.901195469721       residual = 8.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 5.757562e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.901091724478       residual = 1.71e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901113127099       residual = 2.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901116940356       residual = 4.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901117776600       residual = 5.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901117862946       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901117872455       residual = 2.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901117881597       residual = 6.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901117887689       residual = 1.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901117888430       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901117888480       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.901117888190       residual = 8.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 1.452589e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.183504 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6717e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_001                -4.764994e-02 3 1  ON 0
ci_002                -3.730784e-02 3 1  ON 1
ci_003                -2.918788e-02 3 1  ON 2
ci_004                 2.735608e-02 3 1  ON 3
ci_005                 2.724918e-02 3 1  ON 4
ci_006                -2.460584e-02 3 1  ON 5
ci_007                -2.474202e-02 3 1  ON 6
ci_008                -1.248916e-02 3 1  ON 7
ci_009                -1.745095e-02 3 1  ON 8
ci_010                -1.376347e-02 3 1  ON 9
ci_011                -1.399809e-02 3 1  ON 10
ci_012                -1.425160e-02 3 1  ON 11
ci_013                -2.171723e-02 3 1  ON 12
ci_014                 1.545520e-02 3 1  ON 13
ci_015                 1.529982e-02 3 1  ON 14
ci_016                 1.856126e-02 3 1  ON 15
ci_017                 1.853437e-02 3 1  ON 16
ci_018                 1.344975e-02 3 1  ON 17
ci_019                 1.343713e-02 3 1  ON 18
ci_020                 1.954302e-02 3 1  ON 19
ci_021                 1.943986e-02 3 1  ON 20
ci_022                 1.219940e-02 3 1  ON 21
ci_023                 1.215804e-02 3 1  ON 22
ci_024                 1.245890e-02 3 1  ON 23
ci_025                 1.269716e-02 3 1  ON 24
ci_026                 1.364496e-02 3 1  ON 25
ci_027                 1.356891e-02 3 1  ON 26
ci_028                -1.656012e-02 3 1  ON 27
ci_029                -1.671489e-02 3 1  ON 28
ci_030                -1.128392e-02 3 1  ON 29
ci_031                -1.135862e-02 3 1  ON 30
ci_032                -1.513711e-02 3 1  ON 31
ci_033                 8.190111e-03 3 1  ON 32
ci_034                 8.257476e-03 3 1  ON 33
ci_035                -7.695654e-03 3 1  ON 34
ci_036                -1.428385e-02 3 1  ON 35
ci_037                -1.435438e-02 3 1  ON 36
ci_038                 4.811973e-03 3 1  ON 37
ci_039                 5.016388e-03 3 1  ON 38
ci_040                -5.409601e-03 3 1  ON 39
ci_041                 9.931143e-03 3 1  ON 40
ci_042                 1.030004e-02 3 1  ON 41
ci_043                -6.334557e-03 3 1  ON 42
ci_044                -6.868193e-03 3 1  ON 43
ci_045                -5.367109e-03 3 1  ON 44
ci_046                 7.668868e-03 3 1  ON 45
ci_047                 7.667042e-03 3 1  ON 46
ci_048                -1.344297e-02 3 1  ON 47
ci_049                -1.318280e-02 3 1  ON 48
ci_050                 4.958619e-03 3 1  ON 49
ci_051                 5.189447e-03 3 1  ON 50
ci_052                -4.001416e-03 3 1  ON 51
ci_053                -4.081314e-03 3 1  ON 52
ci_054                -4.882680e-03 3 1  ON 53
ci_055                -5.104677e-03 3 1  ON 54
ci_056                 7.035096e-03 3 1  ON 55
ci_057                 6.964216e-03 3 1  ON 56
ci_058                -3.710628e-03 3 1  ON 57
ci_059                -3.707138e-03 3 1  ON 58
ci_060                 6.586201e-03 3 1  ON 59
ci_061                 6.897218e-03 3 1  ON 60
ci_062                -5.696281e-03 3 1  ON 61
ci_063                -5.548295e-03 3 1  ON 62
ci_064                -4.515636e-03 3 1  ON 63
ci_065                -5.247511e-03 3 1  ON 64
ci_066                 5.540117e-03 3 1  ON 65
ci_067                 5.733315e-03 3 1  ON 66
ci_068                -5.927485e-03 3 1  ON 67
ci_069                -5.792656e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2032
    reference variance = 0.1831
====================================================
  Execution time = 1.3658e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9412e-01
  Total weights = 1.9566e+06
  Execution time = 1.8386e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280183888714
                                         uncertainty =       0.001758847269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280183888714
                                         uncertainty =       0.001758847269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374260216
  error estimate for blocks of size 2^( 2) =       0.000386925829
  error estimate for blocks of size 2^( 3) =       0.000397894301
  error estimate for blocks of size 2^( 4) =       0.000405550144
  error estimate for blocks of size 2^( 5) =       0.000411366809
  error estimate for blocks of size 2^( 6) =       0.000414930566
  error estimate for blocks of size 2^( 7) =       0.000415235407

      target function =      -0.908349305570
              le_mean =     -17.213611808443
             les_mean =     296.602793363747
             stat err =       0.000411770731
             autocorr =       1.210496727092
   target nu stat err =       0.000411770731
   target dn stat err =       0.002955788782
      target stat err =       0.003835527903
              std dev =       0.529283873428
             le_variance =       0.280141418671

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279694516490
                                         uncertainty =       0.001749828008

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279694516490
                                         uncertainty =       0.001749828008

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373933064
  error estimate for blocks of size 2^( 2) =       0.000386648020
  error estimate for blocks of size 2^( 3) =       0.000397665277
  error estimate for blocks of size 2^( 4) =       0.000405360469
  error estimate for blocks of size 2^( 5) =       0.000411196823
  error estimate for blocks of size 2^( 6) =       0.000414766326
  error estimate for blocks of size 2^( 7) =       0.000415081042

      target function =      -0.909037861112
              le_mean =     -17.213613947625
             les_mean =     296.602331259767
             stat err =       0.000411601165
             autocorr =       1.211617270900
   target nu stat err =       0.000411601165
   target dn stat err =       0.002921267670
      target stat err =       0.003797425124
              std dev =       0.528821209912
             le_variance =       0.279651872053

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279926487709
                                         uncertainty =       0.001754137401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279926487709
                                         uncertainty =       0.001754137401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374088176
  error estimate for blocks of size 2^( 2) =       0.000386779245
  error estimate for blocks of size 2^( 3) =       0.000397772876
  error estimate for blocks of size 2^( 4) =       0.000405449019
  error estimate for blocks of size 2^( 5) =       0.000411275880
  error estimate for blocks of size 2^( 6) =       0.000414842663
  error estimate for blocks of size 2^( 7) =       0.000415152707

      target function =      -0.908508323629
              le_mean =     -17.213612331636
             les_mean =     296.602687591382
             stat err =       0.000411680067
             autocorr =       1.211076887117
   target nu stat err =       0.000411680067
   target dn stat err =       0.002946700529
      target stat err =       0.003825312881
              std dev =       0.529040572541
             le_variance =       0.279883927395

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280151043654
                                         uncertainty =       0.001758245528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280151043654
                                         uncertainty =       0.001758245528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374238268
  error estimate for blocks of size 2^( 2) =       0.000386907009
  error estimate for blocks of size 2^( 3) =       0.000397878506
  error estimate for blocks of size 2^( 4) =       0.000405536911
  error estimate for blocks of size 2^( 5) =       0.000411354704
  error estimate for blocks of size 2^( 6) =       0.000414920131
  error estimate for blocks of size 2^( 7) =       0.000415225457

      target function =      -0.899718293998
              le_mean =     -17.213612076371
             les_mean =     296.609531074388
             stat err =       0.000411759301
             autocorr =       1.210571504769
   target nu stat err =       0.000411759301
   target dn stat err =       0.007452918301
      target stat err =       0.009397105033
              std dev =       0.529252833808
             le_variance =       0.280108562094


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.908349305570        initial
     1.5625e+00     1.5625e+01             2.2222e-04        -0.909037861112  <--
     6.2500e+00     6.2500e+01             5.7576e-05        -0.908508323629
     2.5000e+01     2.5000e+02             1.4526e-05        -0.899718293998

*****************************************************************************
Applying the update for shift_i =   1.5625e+00     and shift_s =   1.5625e+01
*****************************************************************************

  Execution time = 2.2988e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_001                -4.748962e-02 3 1  ON 0
ci_002                -3.717162e-02 3 1  ON 1
ci_003                -2.910987e-02 3 1  ON 2
ci_004                 2.724356e-02 3 1  ON 3
ci_005                 2.721924e-02 3 1  ON 4
ci_006                -2.454792e-02 3 1  ON 5
ci_007                -2.461979e-02 3 1  ON 6
ci_008                -1.233332e-02 3 1  ON 7
ci_009                -1.732254e-02 3 1  ON 8
ci_010                -1.360985e-02 3 1  ON 9
ci_011                -1.384189e-02 3 1  ON 10
ci_012                -1.415673e-02 3 1  ON 11
ci_013                -2.164246e-02 3 1  ON 12
ci_014                 1.538589e-02 3 1  ON 13
ci_015                 1.521602e-02 3 1  ON 14
ci_016                 1.848641e-02 3 1  ON 15
ci_017                 1.845565e-02 3 1  ON 16
ci_018                 1.328510e-02 3 1  ON 17
ci_019                 1.334561e-02 3 1  ON 18
ci_020                 1.947747e-02 3 1  ON 19
ci_021                 1.942963e-02 3 1  ON 20
ci_022                 1.204542e-02 3 1  ON 21
ci_023                 1.207614e-02 3 1  ON 22
ci_024                 1.237696e-02 3 1  ON 23
ci_025                 1.266865e-02 3 1  ON 24
ci_026                 1.356751e-02 3 1  ON 25
ci_027                 1.349061e-02 3 1  ON 26
ci_028                -1.653747e-02 3 1  ON 27
ci_029                -1.672127e-02 3 1  ON 28
ci_030                -1.120691e-02 3 1  ON 29
ci_031                -1.128483e-02 3 1  ON 30
ci_032                -1.512572e-02 3 1  ON 31
ci_033                 8.167474e-03 3 1  ON 32
ci_034                 8.183620e-03 3 1  ON 33
ci_035                -7.599702e-03 3 1  ON 34
ci_036                -1.427187e-02 3 1  ON 35
ci_037                -1.431558e-02 3 1  ON 36
ci_038                 4.719481e-03 3 1  ON 37
ci_039                 4.927755e-03 3 1  ON 38
ci_040                -5.338180e-03 3 1  ON 39
ci_041                 9.908617e-03 3 1  ON 40
ci_042                 1.023538e-02 3 1  ON 41
ci_043                -6.268421e-03 3 1  ON 42
ci_044                -6.752007e-03 3 1  ON 43
ci_045                -5.296725e-03 3 1  ON 44
ci_046                 7.599492e-03 3 1  ON 45
ci_047                 7.599893e-03 3 1  ON 46
ci_048                -1.345496e-02 3 1  ON 47
ci_049                -1.317602e-02 3 1  ON 48
ci_050                 4.877961e-03 3 1  ON 49
ci_051                 5.136560e-03 3 1  ON 50
ci_052                -3.910123e-03 3 1  ON 51
ci_053                -3.979337e-03 3 1  ON 52
ci_054                -4.805283e-03 3 1  ON 53
ci_055                -5.026962e-03 3 1  ON 54
ci_056                 6.998084e-03 3 1  ON 55
ci_057                 6.960715e-03 3 1  ON 56
ci_058                -3.658445e-03 3 1  ON 57
ci_059                -3.624478e-03 3 1  ON 58
ci_060                 6.553432e-03 3 1  ON 59
ci_061                 6.733787e-03 3 1  ON 60
ci_062                -5.629103e-03 3 1  ON 61
ci_063                -5.473526e-03 3 1  ON 62
ci_064                -4.470389e-03 3 1  ON 63
ci_065                -5.196042e-03 3 1  ON 64
ci_066                 5.519419e-03 3 1  ON 65
ci_067                 5.716872e-03 3 1  ON 66
ci_068                -5.910061e-03 3 1  ON 67
ci_069                -5.756247e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9719e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2577
    reference variance = 0.504809
====================================================
  Execution time = 1.4085e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.9078e-01
  Total weights = 1.956398573e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4949e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278244248418
                                         uncertainty =       0.002206200891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278244248418
                                         uncertainty =       0.002206200891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372969465
  error estimate for blocks of size 2^( 2) =       0.000385827889
  error estimate for blocks of size 2^( 3) =       0.000396888491
  error estimate for blocks of size 2^( 4) =       0.000404829957
  error estimate for blocks of size 2^( 5) =       0.000409379646
  error estimate for blocks of size 2^( 6) =       0.000411461226
  error estimate for blocks of size 2^( 7) =       0.000411305360

      target function =      -0.912899295940
              le_mean =     -17.213315032467
             les_mean =     296.588992717169
             stat err =       0.000409244047
             autocorr =       1.203976989873
   target nu stat err =       0.000409244047
   target dn stat err =       0.002552462889
      target stat err =       0.003355811263
              std dev =       0.527458475853
             le_variance =       0.278212443749


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721331503247e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912910971391       residual = 9.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913636176529       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913762232867       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913791888899       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913795010652       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913795295900       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913795264099       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913795451428       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913795419172       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913795426850       residual = 4.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913795415984       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913795418300       residual = 1.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 7.504292e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912910971391       residual = 9.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913117933272       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913152925680       residual = 3.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913160822677       residual = 3.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913161619596       residual = 9.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913161693034       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913161678229       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913161726230       residual = 9.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913161717439       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913161719410       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913161716885       residual = 7.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 2.118040e-04

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912910971391       residual = 9.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912964608177       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912973602165       residual = 3.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912975606995       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912975806802       residual = 9.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912975825273       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912975821085       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912975833127       residual = 8.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912975830884       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912975831380       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912975830764       residual = 7.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 5.471714e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.192807 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6598e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_001                -4.731948e-02 3 1  ON 0
ci_002                -3.700360e-02 3 1  ON 1
ci_003                -2.905434e-02 3 1  ON 2
ci_004                 2.714613e-02 3 1  ON 3
ci_005                 2.708977e-02 3 1  ON 4
ci_006                -2.443574e-02 3 1  ON 5
ci_007                -2.448572e-02 3 1  ON 6
ci_008                -1.222062e-02 3 1  ON 7
ci_009                -1.723524e-02 3 1  ON 8
ci_010                -1.339805e-02 3 1  ON 9
ci_011                -1.368374e-02 3 1  ON 10
ci_012                -1.400360e-02 3 1  ON 11
ci_013                -2.155943e-02 3 1  ON 12
ci_014                 1.530850e-02 3 1  ON 13
ci_015                 1.506221e-02 3 1  ON 14
ci_016                 1.842083e-02 3 1  ON 15
ci_017                 1.832932e-02 3 1  ON 16
ci_018                 1.324269e-02 3 1  ON 17
ci_019                 1.325440e-02 3 1  ON 18
ci_020                 1.936405e-02 3 1  ON 19
ci_021                 1.934906e-02 3 1  ON 20
ci_022                 1.198011e-02 3 1  ON 21
ci_023                 1.196287e-02 3 1  ON 22
ci_024                 1.226350e-02 3 1  ON 23
ci_025                 1.250046e-02 3 1  ON 24
ci_026                 1.343107e-02 3 1  ON 25
ci_027                 1.345853e-02 3 1  ON 26
ci_028                -1.654873e-02 3 1  ON 27
ci_029                -1.668023e-02 3 1  ON 28
ci_030                -1.113799e-02 3 1  ON 29
ci_031                -1.122939e-02 3 1  ON 30
ci_032                -1.509753e-02 3 1  ON 31
ci_033                 8.054466e-03 3 1  ON 32
ci_034                 8.088682e-03 3 1  ON 33
ci_035                -7.474506e-03 3 1  ON 34
ci_036                -1.420076e-02 3 1  ON 35
ci_037                -1.428249e-02 3 1  ON 36
ci_038                 4.608460e-03 3 1  ON 37
ci_039                 4.798328e-03 3 1  ON 38
ci_040                -5.236555e-03 3 1  ON 39
ci_041                 9.831741e-03 3 1  ON 40
ci_042                 1.020395e-02 3 1  ON 41
ci_043                -6.177547e-03 3 1  ON 42
ci_044                -6.663619e-03 3 1  ON 43
ci_045                -5.175504e-03 3 1  ON 44
ci_046                 7.521812e-03 3 1  ON 45
ci_047                 7.502440e-03 3 1  ON 46
ci_048                -1.339395e-02 3 1  ON 47
ci_049                -1.317363e-02 3 1  ON 48
ci_050                 4.769104e-03 3 1  ON 49
ci_051                 5.094790e-03 3 1  ON 50
ci_052                -3.820724e-03 3 1  ON 51
ci_053                -3.925500e-03 3 1  ON 52
ci_054                -4.700914e-03 3 1  ON 53
ci_055                -4.937195e-03 3 1  ON 54
ci_056                 6.955788e-03 3 1  ON 55
ci_057                 6.895882e-03 3 1  ON 56
ci_058                -3.561426e-03 3 1  ON 57
ci_059                -3.528378e-03 3 1  ON 58
ci_060                 6.487039e-03 3 1  ON 59
ci_061                 6.684687e-03 3 1  ON 60
ci_062                -5.591275e-03 3 1  ON 61
ci_063                -5.402299e-03 3 1  ON 62
ci_064                -4.398529e-03 3 1  ON 63
ci_065                -5.156606e-03 3 1  ON 64
ci_066                 5.484532e-03 3 1  ON 65
ci_067                 5.682559e-03 3 1  ON 66
ci_068                -5.865249e-03 3 1  ON 67
ci_069                -5.701294e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2675
    reference variance = 0.239808
====================================================
  Execution time = 1.3575e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.9175e-01
  Total weights = 1.9564e+06
  Execution time = 1.8409e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280890969762
                                         uncertainty =       0.001586683310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280890969762
                                         uncertainty =       0.001586683310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374829089
  error estimate for blocks of size 2^( 2) =       0.000386947020
  error estimate for blocks of size 2^( 3) =       0.000398464630
  error estimate for blocks of size 2^( 4) =       0.000406282556
  error estimate for blocks of size 2^( 5) =       0.000411753841
  error estimate for blocks of size 2^( 6) =       0.000415428192
  error estimate for blocks of size 2^( 7) =       0.000413915384

      target function =      -0.907674977163
              le_mean =     -17.213355137847
             les_mean =     296.594431038848
             stat err =       0.000411844994
             autocorr =       1.207260547250
   target nu stat err =       0.000411844994
   target dn stat err =       0.003455224100
      target stat err =       0.004461457391
              std dev =       0.530088380532
             le_variance =       0.280993691175

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279558522057
                                         uncertainty =       0.001559519168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279558522057
                                         uncertainty =       0.001559519168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373939291
  error estimate for blocks of size 2^( 2) =       0.000386216995
  error estimate for blocks of size 2^( 3) =       0.000397881379
  error estimate for blocks of size 2^( 4) =       0.000405809257
  error estimate for blocks of size 2^( 5) =       0.000411324683
  error estimate for blocks of size 2^( 6) =       0.000414979778
  error estimate for blocks of size 2^( 7) =       0.000413485353

      target function =      -0.911968936328
              le_mean =     -17.213360873342
             les_mean =     296.591300846012
             stat err =       0.000411399768
             autocorr =       1.210391549443
   target nu stat err =       0.000411399768
   target dn stat err =       0.002261899234
      target stat err =       0.002980769276
              std dev =       0.528830017258
             le_variance =       0.279661187153

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280101856375
                                         uncertainty =       0.001570938716

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280101856375
                                         uncertainty =       0.001570938716

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374302388
  error estimate for blocks of size 2^( 2) =       0.000386509999
  error estimate for blocks of size 2^( 3) =       0.000398110539
  error estimate for blocks of size 2^( 4) =       0.000405990546
  error estimate for blocks of size 2^( 5) =       0.000411486514
  error estimate for blocks of size 2^( 6) =       0.000415149008
  error estimate for blocks of size 2^( 7) =       0.000413645788

      target function =      -0.910842199447
              le_mean =     -17.213352755544
             les_mean =     296.591892201706
             stat err =       0.000411567964
             autocorr =       1.209032370775
   target nu stat err =       0.000411567964
   target dn stat err =       0.002350594500
      target stat err =       0.003085768701
              std dev =       0.529343513696
             le_variance =       0.280204555492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280783495968
                                         uncertainty =       0.001584599822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280783495968
                                         uncertainty =       0.001584599822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374757399
  error estimate for blocks of size 2^( 2) =       0.000386886356
  error estimate for blocks of size 2^( 3) =       0.000398415010
  error estimate for blocks of size 2^( 4) =       0.000406240957
  error estimate for blocks of size 2^( 5) =       0.000411714965
  error estimate for blocks of size 2^( 6) =       0.000415387624
  error estimate for blocks of size 2^( 7) =       0.000413877261

      target function =      -0.910977930617
              le_mean =     -17.213353554290
             les_mean =     296.591815650245
             stat err =       0.000411805202
             autocorr =       1.207489118964
   target nu stat err =       0.000411805202
   target dn stat err =       0.002182284170
      target stat err =       0.002873889201
              std dev =       0.529986995698
             le_variance =       0.280886215609


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.907674977163        initial
     3.9062e-01     3.9062e+00             7.5043e-04        -0.911968936328  <--
     1.5625e+00     1.5625e+01             2.1180e-04        -0.910842199447
     6.2500e+00     6.2500e+01             5.4717e-05        -0.910977930617

*****************************************************************************
Applying the update for shift_i =   3.9062e-01     and shift_s =   3.9062e+00
*****************************************************************************

  Execution time = 2.5824e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_001                -4.687927e-02 3 1  ON 0
ci_002                -3.657217e-02 3 1  ON 1
ci_003                -2.890783e-02 3 1  ON 2
ci_004                 2.689045e-02 3 1  ON 3
ci_005                 2.675595e-02 3 1  ON 4
ci_006                -2.414749e-02 3 1  ON 5
ci_007                -2.414143e-02 3 1  ON 6
ci_008                -1.193927e-02 3 1  ON 7
ci_009                -1.701434e-02 3 1  ON 8
ci_010                -1.285942e-02 3 1  ON 9
ci_011                -1.328328e-02 3 1  ON 10
ci_012                -1.361559e-02 3 1  ON 11
ci_013                -2.134233e-02 3 1  ON 12
ci_014                 1.511439e-02 3 1  ON 13
ci_015                 1.467162e-02 3 1  ON 14
ci_016                 1.825573e-02 3 1  ON 15
ci_017                 1.800632e-02 3 1  ON 16
ci_018                 1.313476e-02 3 1  ON 17
ci_019                 1.302240e-02 3 1  ON 18
ci_020                 1.907051e-02 3 1  ON 19
ci_021                 1.914249e-02 3 1  ON 20
ci_022                 1.181594e-02 3 1  ON 21
ci_023                 1.167738e-02 3 1  ON 22
ci_024                 1.197080e-02 3 1  ON 23
ci_025                 1.206510e-02 3 1  ON 24
ci_026                 1.308565e-02 3 1  ON 25
ci_027                 1.337424e-02 3 1  ON 26
ci_028                -1.657934e-02 3 1  ON 27
ci_029                -1.657754e-02 3 1  ON 28
ci_030                -1.096269e-02 3 1  ON 29
ci_031                -1.108993e-02 3 1  ON 30
ci_032                -1.502562e-02 3 1  ON 31
ci_033                 7.765112e-03 3 1  ON 32
ci_034                 7.845822e-03 3 1  ON 33
ci_035                -7.159832e-03 3 1  ON 34
ci_036                -1.402043e-02 3 1  ON 35
ci_037                -1.419581e-02 3 1  ON 36
ci_038                 4.329996e-03 3 1  ON 37
ci_039                 4.473689e-03 3 1  ON 38
ci_040                -4.982946e-03 3 1  ON 39
ci_041                 9.641758e-03 3 1  ON 40
ci_042                 1.012557e-02 3 1  ON 41
ci_043                -5.948805e-03 3 1  ON 42
ci_044                -6.439352e-03 3 1  ON 43
ci_045                -4.872389e-03 3 1  ON 44
ci_046                 7.323647e-03 3 1  ON 45
ci_047                 7.254097e-03 3 1  ON 46
ci_048                -1.323909e-02 3 1  ON 47
ci_049                -1.317054e-02 3 1  ON 48
ci_050                 4.499533e-03 3 1  ON 49
ci_051                 4.990852e-03 3 1  ON 50
ci_052                -3.599859e-03 3 1  ON 51
ci_053                -3.792391e-03 3 1  ON 52
ci_054                -4.436031e-03 3 1  ON 53
ci_055                -4.709486e-03 3 1  ON 54
ci_056                 6.848714e-03 3 1  ON 55
ci_057                 6.732084e-03 3 1  ON 56
ci_058                -3.322785e-03 3 1  ON 57
ci_059                -3.289412e-03 3 1  ON 58
ci_060                 6.317193e-03 3 1  ON 59
ci_061                 6.559880e-03 3 1  ON 60
ci_062                -5.493210e-03 3 1  ON 61
ci_063                -5.218782e-03 3 1  ON 62
ci_064                -4.219278e-03 3 1  ON 63
ci_065                -5.058113e-03 3 1  ON 64
ci_066                 5.398033e-03 3 1  ON 65
ci_067                 5.597407e-03 3 1  ON 66
ci_068                -5.753222e-03 3 1  ON 67
ci_069                -5.562897e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2437e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2053
    reference variance = 0.246789
====================================================
  Execution time = 1.3929e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5305e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8940e-01
  Total weights = 1.956765796e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5222e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276273349357
                                         uncertainty =       0.001422223479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276273349357
                                         uncertainty =       0.001422223479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371665380
  error estimate for blocks of size 2^( 2) =       0.000384842636
  error estimate for blocks of size 2^( 3) =       0.000396415158
  error estimate for blocks of size 2^( 4) =       0.000404188412
  error estimate for blocks of size 2^( 5) =       0.000408942701
  error estimate for blocks of size 2^( 6) =       0.000412422433
  error estimate for blocks of size 2^( 7) =       0.000413837834

      target function =      -0.914679811266
              le_mean =     -17.213255554541
             les_mean =     296.585562979184
             stat err =       0.000409847845
             autocorr =       1.216021053196
   target nu stat err =       0.000409847845
   target dn stat err =       0.002305952695
      target stat err =       0.003053449912
              std dev =       0.525614220426
             le_variance =       0.276270308714


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721325555454e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914689235544       residual = 6.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916070400273       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916341178846       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916408315634       residual = 3.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916417357005       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916417379180       residual = 2.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916417974798       residual = 6.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916418374066       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916418344125       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916418368170       residual = 5.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916418343831       residual = 1.24e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916418349802       residual = 1.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 1.596873e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914689235544       residual = 6.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915206782270       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915301873373       residual = 2.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915323078874       residual = 2.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915325865650       residual = 8.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915325741110       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915325918608       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915326012859       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915326004415       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915326007411       residual = 2.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915326002942       residual = 5.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 5.716806e-04

solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914689235544       residual = 6.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914837030631       residual = 9.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914863423813       residual = 2.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914869042747       residual = 2.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914869776190       residual = 7.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914869730607       residual = 1.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914869776192       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914869798328       residual = 6.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914869796290       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914869796580       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914869795812       residual = 3.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 1.602201e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.202083 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6468e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_001                -4.636035e-02 3 1  ON 0
ci_002                -3.600049e-02 3 1  ON 1
ci_003                -2.865317e-02 3 1  ON 2
ci_004                 2.646745e-02 3 1  ON 3
ci_005                 2.633933e-02 3 1  ON 4
ci_006                -2.368633e-02 3 1  ON 5
ci_007                -2.387423e-02 3 1  ON 6
ci_008                -1.142024e-02 3 1  ON 7
ci_009                -1.662077e-02 3 1  ON 8
ci_010                -1.230892e-02 3 1  ON 9
ci_011                -1.301746e-02 3 1  ON 10
ci_012                -1.323329e-02 3 1  ON 11
ci_013                -2.117045e-02 3 1  ON 12
ci_014                 1.478318e-02 3 1  ON 13
ci_015                 1.435661e-02 3 1  ON 14
ci_016                 1.798909e-02 3 1  ON 15
ci_017                 1.776137e-02 3 1  ON 16
ci_018                 1.281814e-02 3 1  ON 17
ci_019                 1.264903e-02 3 1  ON 18
ci_020                 1.887039e-02 3 1  ON 19
ci_021                 1.897369e-02 3 1  ON 20
ci_022                 1.158216e-02 3 1  ON 21
ci_023                 1.142785e-02 3 1  ON 22
ci_024                 1.160343e-02 3 1  ON 23
ci_025                 1.184202e-02 3 1  ON 24
ci_026                 1.279764e-02 3 1  ON 25
ci_027                 1.302340e-02 3 1  ON 26
ci_028                -1.643532e-02 3 1  ON 27
ci_029                -1.650708e-02 3 1  ON 28
ci_030                -1.080227e-02 3 1  ON 29
ci_031                -1.080584e-02 3 1  ON 30
ci_032                -1.495148e-02 3 1  ON 31
ci_033                 7.517968e-03 3 1  ON 32
ci_034                 7.569618e-03 3 1  ON 33
ci_035                -6.842909e-03 3 1  ON 34
ci_036                -1.384278e-02 3 1  ON 35
ci_037                -1.403263e-02 3 1  ON 36
ci_038                 3.981126e-03 3 1  ON 37
ci_039                 4.038769e-03 3 1  ON 38
ci_040                -4.684339e-03 3 1  ON 39
ci_041                 9.384443e-03 3 1  ON 40
ci_042                 9.801495e-03 3 1  ON 41
ci_043                -5.702773e-03 3 1  ON 42
ci_044                -5.988212e-03 3 1  ON 43
ci_045                -4.525610e-03 3 1  ON 44
ci_046                 7.052155e-03 3 1  ON 45
ci_047                 7.011072e-03 3 1  ON 46
ci_048                -1.329380e-02 3 1  ON 47
ci_049                -1.335099e-02 3 1  ON 48
ci_050                 4.460952e-03 3 1  ON 49
ci_051                 4.720676e-03 3 1  ON 50
ci_052                -3.372037e-03 3 1  ON 51
ci_053                -3.728806e-03 3 1  ON 52
ci_054                -4.267207e-03 3 1  ON 53
ci_055                -4.290595e-03 3 1  ON 54
ci_056                 6.597760e-03 3 1  ON 55
ci_057                 6.687947e-03 3 1  ON 56
ci_058                -3.288263e-03 3 1  ON 57
ci_059                -3.153719e-03 3 1  ON 58
ci_060                 5.768340e-03 3 1  ON 59
ci_061                 6.584442e-03 3 1  ON 60
ci_062                -5.340202e-03 3 1  ON 61
ci_063                -5.073342e-03 3 1  ON 62
ci_064                -4.045817e-03 3 1  ON 63
ci_065                -4.924043e-03 3 1  ON 64
ci_066                 5.341290e-03 3 1  ON 65
ci_067                 5.530110e-03 3 1  ON 66
ci_068                -5.510032e-03 3 1  ON 67
ci_069                -5.314133e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1986
    reference variance = 0.182322
====================================================
  Execution time = 1.3471e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7214e+01
  VMC Evar = 2.9107e-01
  Total weights = 1.9566e+06
  Execution time = 1.8386e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280540435449
                                         uncertainty =       0.001785866607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280540435449
                                         uncertainty =       0.001785866607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374837961
  error estimate for blocks of size 2^( 2) =       0.000387480461
  error estimate for blocks of size 2^( 3) =       0.000398408610
  error estimate for blocks of size 2^( 4) =       0.000406272237
  error estimate for blocks of size 2^( 5) =       0.000410807818
  error estimate for blocks of size 2^( 6) =       0.000413225431
  error estimate for blocks of size 2^( 7) =       0.000414637269

      target function =      -0.904897268839
              le_mean =     -17.213522611228
             les_mean =     296.602384381239
             stat err =       0.000411235689
             autocorr =       1.203634038040
   target nu stat err =       0.000411235689
   target dn stat err =       0.005060164817
      target stat err =       0.006466353597
              std dev =       0.530100928412
             le_variance =       0.281006994304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278335780430
                                         uncertainty =       0.001752704462

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278335780430
                                         uncertainty =       0.001752704462

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373352345
  error estimate for blocks of size 2^( 2) =       0.000386403880
  error estimate for blocks of size 2^( 3) =       0.000397713608
  error estimate for blocks of size 2^( 4) =       0.000405834231
  error estimate for blocks of size 2^( 5) =       0.000410462880
  error estimate for blocks of size 2^( 6) =       0.000412954980
  error estimate for blocks of size 2^( 7) =       0.000414481681

      target function =      -0.911509958129
              le_mean =     -17.213584030005
             les_mean =     296.599380557988
             stat err =       0.000410933443
             autocorr =       1.211449199795
   target nu stat err =       0.000410933443
   target dn stat err =       0.002362396793
      target stat err =       0.003106127032
              std dev =       0.527999949534
             le_variance =       0.278783946708

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278756305400
                                         uncertainty =       0.001758810707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278756305400
                                         uncertainty =       0.001758810707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373636585
  error estimate for blocks of size 2^( 2) =       0.000386577922
  error estimate for blocks of size 2^( 3) =       0.000397782589
  error estimate for blocks of size 2^( 4) =       0.000405831758
  error estimate for blocks of size 2^( 5) =       0.000410434886
  error estimate for blocks of size 2^( 6) =       0.000412909152
  error estimate for blocks of size 2^( 7) =       0.000414400417

      target function =      -0.909796174399
              le_mean =     -17.213545561972
             les_mean =     296.599376669324
             stat err =       0.000410894053
             autocorr =       1.209374823416
   target nu stat err =       0.000410894053
   target dn stat err =       0.002619854578
      target stat err =       0.003420390808
              std dev =       0.528401926181
             le_variance =       0.279208595591

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280740823899
                                         uncertainty =       0.001825043089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280740823899
                                         uncertainty =       0.001825043089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374970001
  error estimate for blocks of size 2^( 2) =       0.000387646905
  error estimate for blocks of size 2^( 3) =       0.000398599002
  error estimate for blocks of size 2^( 4) =       0.000406488750
  error estimate for blocks of size 2^( 5) =       0.000411016957
  error estimate for blocks of size 2^( 6) =       0.000413490686
  error estimate for blocks of size 2^( 7) =       0.000414882691

      target function =      -0.536893868447
              le_mean =     -17.213535051884
             les_mean =     296.979657561491
             stat err =       0.000411469771
             autocorr =       1.204156187740
   target nu stat err =       0.000411469771
   target dn stat err =       0.346881435100
      target stat err =       0.171207741644
              std dev =       0.530287661102
             le_variance =       0.281205003518


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.904897268839        initial
     9.7656e-02     9.7656e-01             1.5969e-03        -0.911509958129  <--
     3.9062e-01     3.9062e+00             5.7168e-04        -0.909796174399
     1.5625e+00     1.5625e+01             1.6022e-04        -0.536893868447

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 2.2754e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_001                -4.540955e-02 3 1  ON 0
ci_002                -3.497530e-02 3 1  ON 1
ci_003                -2.816815e-02 3 1  ON 2
ci_004                 2.567642e-02 3 1  ON 3
ci_005                 2.555536e-02 3 1  ON 4
ci_006                -2.285654e-02 3 1  ON 5
ci_007                -2.340497e-02 3 1  ON 6
ci_008                -1.056521e-02 3 1  ON 7
ci_009                -1.594942e-02 3 1  ON 8
ci_010                -1.135207e-02 3 1  ON 9
ci_011                -1.255649e-02 3 1  ON 10
ci_012                -1.257215e-02 3 1  ON 11
ci_013                -2.085223e-02 3 1  ON 12
ci_014                 1.420250e-02 3 1  ON 13
ci_015                 1.380047e-02 3 1  ON 14
ci_016                 1.752884e-02 3 1  ON 15
ci_017                 1.733896e-02 3 1  ON 16
ci_018                 1.228409e-02 3 1  ON 17
ci_019                 1.201839e-02 3 1  ON 18
ci_020                 1.849413e-02 3 1  ON 19
ci_021                 1.865992e-02 3 1  ON 20
ci_022                 1.118279e-02 3 1  ON 21
ci_023                 1.100799e-02 3 1  ON 22
ci_024                 1.093275e-02 3 1  ON 23
ci_025                 1.143551e-02 3 1  ON 24
ci_026                 1.228623e-02 3 1  ON 25
ci_027                 1.241021e-02 3 1  ON 26
ci_028                -1.617723e-02 3 1  ON 27
ci_029                -1.637814e-02 3 1  ON 28
ci_030                -1.053587e-02 3 1  ON 29
ci_031                -1.034789e-02 3 1  ON 30
ci_032                -1.482264e-02 3 1  ON 31
ci_033                 7.075915e-03 3 1  ON 32
ci_034                 7.076324e-03 3 1  ON 33
ci_035                -6.308558e-03 3 1  ON 34
ci_036                -1.351847e-02 3 1  ON 35
ci_037                -1.373311e-02 3 1  ON 36
ci_038                 3.395275e-03 3 1  ON 37
ci_039                 3.308270e-03 3 1  ON 38
ci_040                -4.188958e-03 3 1  ON 39
ci_041                 8.957155e-03 3 1  ON 40
ci_042                 9.265119e-03 3 1  ON 41
ci_043                -5.287197e-03 3 1  ON 42
ci_044                -5.211269e-03 3 1  ON 43
ci_045                -3.946923e-03 3 1  ON 44
ci_046                 6.575820e-03 3 1  ON 45
ci_047                 6.587266e-03 3 1  ON 46
ci_048                -1.342478e-02 3 1  ON 47
ci_049                -1.370095e-02 3 1  ON 48
ci_050                 4.394949e-03 3 1  ON 49
ci_051                 4.277468e-03 3 1  ON 50
ci_052                -2.999878e-03 3 1  ON 51
ci_053                -3.633589e-03 3 1  ON 52
ci_054                -3.965183e-03 3 1  ON 53
ci_055                -3.563541e-03 3 1  ON 54
ci_056                 6.168885e-03 3 1  ON 55
ci_057                 6.609562e-03 3 1  ON 56
ci_058                -3.247191e-03 3 1  ON 57
ci_059                -2.941823e-03 3 1  ON 58
ci_060                 4.805385e-03 3 1  ON 59
ci_061                 6.624674e-03 3 1  ON 60
ci_062                -5.062951e-03 3 1  ON 61
ci_063                -4.814613e-03 3 1  ON 62
ci_064                -3.760013e-03 3 1  ON 63
ci_065                -4.700880e-03 3 1  ON 64
ci_066                 5.249922e-03 3 1  ON 65
ci_067                 5.423795e-03 3 1  ON 66
ci_068                -5.094976e-03 3 1  ON 67
ci_069                -4.889163e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9237e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1594
    reference variance = 0.183506
====================================================
  Execution time = 1.3994e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8917e-01
  Total weights = 1.956650745e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4836e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275863378469
                                         uncertainty =       0.001421696226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275863378469
                                         uncertainty =       0.001421696226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371398960
  error estimate for blocks of size 2^( 2) =       0.000384573846
  error estimate for blocks of size 2^( 3) =       0.000396329720
  error estimate for blocks of size 2^( 4) =       0.000404514958
  error estimate for blocks of size 2^( 5) =       0.000408995410
  error estimate for blocks of size 2^( 6) =       0.000412915632
  error estimate for blocks of size 2^( 7) =       0.000413093243

      target function =      -0.914791475415
              le_mean =     -17.212524669293
             les_mean =     296.560172705943
             stat err =       0.000409879811
             autocorr =       1.217956246301
   target nu stat err =       0.000409879811
   target dn stat err =       0.002406053286
      target stat err =       0.003178438976
              std dev =       0.525237446264
             le_variance =       0.275874374958


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721252466929e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914801725876       residual = 3.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916208117560       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916455328991       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916545618461       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916565641628       residual = 8.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916572384445       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916573202518       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916573439904       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916573865165       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916574049150       residual = 5.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916574150105       residual = 1.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916574148645       residual = 3.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-02 is 2.700470e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914801725876       residual = 3.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915622283084       residual = 4.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915753786626       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915797957103       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915806917667       residual = 5.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915809540634       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915809812249       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915809856911       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915810046385       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915810123240       residual = 2.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915810155114       residual = 5.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 1.455223e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914801725876       residual = 3.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915109368243       residual = 4.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915154736213       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915168932637       residual = 1.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915171598761       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915172290719       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915172352948       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915172353085       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915172409204       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915172430603       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915172437215       residual = 2.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 5.336019e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.211413 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6496e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_001                -4.395934e-02 3 1  ON 0
ci_002                -3.428295e-02 3 1  ON 1
ci_003                -2.776336e-02 3 1  ON 2
ci_004                 2.571325e-02 3 1  ON 3
ci_005                 2.494521e-02 3 1  ON 4
ci_006                -2.226491e-02 3 1  ON 5
ci_007                -2.225633e-02 3 1  ON 6
ci_008                -9.923205e-03 3 1  ON 7
ci_009                -1.555043e-02 3 1  ON 8
ci_010                -1.025877e-02 3 1  ON 9
ci_011                -1.110127e-02 3 1  ON 10
ci_012                -1.209821e-02 3 1  ON 11
ci_013                -2.002459e-02 3 1  ON 12
ci_014                 1.355307e-02 3 1  ON 13
ci_015                 1.296088e-02 3 1  ON 14
ci_016                 1.712655e-02 3 1  ON 15
ci_017                 1.756154e-02 3 1  ON 16
ci_018                 1.116960e-02 3 1  ON 17
ci_019                 1.153572e-02 3 1  ON 18
ci_020                 1.850060e-02 3 1  ON 19
ci_021                 1.849662e-02 3 1  ON 20
ci_022                 1.028212e-02 3 1  ON 21
ci_023                 1.070640e-02 3 1  ON 22
ci_024                 1.039276e-02 3 1  ON 23
ci_025                 1.039077e-02 3 1  ON 24
ci_026                 1.249194e-02 3 1  ON 25
ci_027                 1.231778e-02 3 1  ON 26
ci_028                -1.641084e-02 3 1  ON 27
ci_029                -1.647340e-02 3 1  ON 28
ci_030                -1.001732e-02 3 1  ON 29
ci_031                -9.919005e-03 3 1  ON 30
ci_032                -1.436106e-02 3 1  ON 31
ci_033                 6.911150e-03 3 1  ON 32
ci_034                 6.388824e-03 3 1  ON 33
ci_035                -6.127589e-03 3 1  ON 34
ci_036                -1.339753e-02 3 1  ON 35
ci_037                -1.318811e-02 3 1  ON 36
ci_038                 2.811646e-03 3 1  ON 37
ci_039                 2.720564e-03 3 1  ON 38
ci_040                -3.859491e-03 3 1  ON 39
ci_041                 8.846721e-03 3 1  ON 40
ci_042                 8.616075e-03 3 1  ON 41
ci_043                -4.826967e-03 3 1  ON 42
ci_044                -5.074212e-03 3 1  ON 43
ci_045                -3.571273e-03 3 1  ON 44
ci_046                 6.102564e-03 3 1  ON 45
ci_047                 6.357175e-03 3 1  ON 46
ci_048                -1.276445e-02 3 1  ON 47
ci_049                -1.348053e-02 3 1  ON 48
ci_050                 3.778045e-03 3 1  ON 49
ci_051                 3.892159e-03 3 1  ON 50
ci_052                -3.146074e-03 3 1  ON 51
ci_053                -3.026391e-03 3 1  ON 52
ci_054                -3.477603e-03 3 1  ON 53
ci_055                -3.471759e-03 3 1  ON 54
ci_056                 6.097557e-03 3 1  ON 55
ci_057                 6.378395e-03 3 1  ON 56
ci_058                -2.979361e-03 3 1  ON 57
ci_059                -2.319490e-03 3 1  ON 58
ci_060                 5.161242e-03 3 1  ON 59
ci_061                 6.318674e-03 3 1  ON 60
ci_062                -4.777117e-03 3 1  ON 61
ci_063                -3.848380e-03 3 1  ON 62
ci_064                -3.519598e-03 3 1  ON 63
ci_065                -4.521499e-03 3 1  ON 64
ci_066                 5.585803e-03 3 1  ON 65
ci_067                 4.763366e-03 3 1  ON 66
ci_068                -4.840506e-03 3 1  ON 67
ci_069                -5.029838e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1569
    reference variance = 0.385288
====================================================
  Execution time = 1.3621e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8988e-01
  Total weights = 1.9570e+06
  Execution time = 1.8360e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279609319791
                                         uncertainty =       0.001718609080

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279609319791
                                         uncertainty =       0.001718609080

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373942769
  error estimate for blocks of size 2^( 2) =       0.000387400368
  error estimate for blocks of size 2^( 3) =       0.000398926403
  error estimate for blocks of size 2^( 4) =       0.000407757767
  error estimate for blocks of size 2^( 5) =       0.000412286237
  error estimate for blocks of size 2^( 6) =       0.000414845634
  error estimate for blocks of size 2^( 7) =       0.000417624220

      target function =      -0.877834139481
              le_mean =     -17.212807801955
             les_mean =     296.598772935677
             stat err =       0.000413128465
             autocorr =       1.220562320000
   target nu stat err =       0.000413128465
   target dn stat err =       0.025015244324
      target stat err =       0.029968100240
              std dev =       0.528834935457
             le_variance =       0.279666388960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278147303735
                                         uncertainty =       0.001654263064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278147303735
                                         uncertainty =       0.001654263064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372962109
  error estimate for blocks of size 2^( 2) =       0.000386939063
  error estimate for blocks of size 2^( 3) =       0.000398977796
  error estimate for blocks of size 2^( 4) =       0.000408232399
  error estimate for blocks of size 2^( 5) =       0.000412998290
  error estimate for blocks of size 2^( 6) =       0.000415593794
  error estimate for blocks of size 2^( 7) =       0.000418385305

      target function =      -0.910684173665
              le_mean =     -17.212792213963
             les_mean =     296.572607243715
             stat err =       0.000413802447
             autocorr =       1.230996125813
   target nu stat err =       0.000413802447
   target dn stat err =       0.002902770852
      target stat err =       0.003783113182
              std dev =       0.527448072250
             le_variance =       0.278201468920

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278134601759
                                         uncertainty =       0.001640869809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278134601759
                                         uncertainty =       0.001640869809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372953074
  error estimate for blocks of size 2^( 2) =       0.000387009561
  error estimate for blocks of size 2^( 3) =       0.000399115538
  error estimate for blocks of size 2^( 4) =       0.000408417929
  error estimate for blocks of size 2^( 5) =       0.000413210304
  error estimate for blocks of size 2^( 6) =       0.000415808121
  error estimate for blocks of size 2^( 7) =       0.000418573009

      target function =      -0.910851572533
              le_mean =     -17.212810013734
             les_mean =     296.573095875397
             stat err =       0.000414002341
             autocorr =       1.232245416334
   target nu stat err =       0.000414002341
   target dn stat err =       0.002584802668
      target stat err =       0.003380571698
              std dev =       0.527435295035
             le_variance =       0.278187990449

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279104792004
                                         uncertainty =       0.001700836999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279104792004
                                         uncertainty =       0.001700836999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373604923
  error estimate for blocks of size 2^( 2) =       0.000387166446
  error estimate for blocks of size 2^( 3) =       0.000398792362
  error estimate for blocks of size 2^( 4) =       0.000407709408
  error estimate for blocks of size 2^( 5) =       0.000412283598
  error estimate for blocks of size 2^( 6) =       0.000414842188
  error estimate for blocks of size 2^( 7) =       0.000417619121

      target function =      -0.890388058928
              le_mean =     -17.212777407861
             les_mean =     296.588008793973
             stat err =       0.000413113579
             autocorr =       1.222682680391
   target nu stat err =       0.000413113579
   target dn stat err =       0.012633028753
      target stat err =       0.015563894802
              std dev =       0.528357148851
             le_variance =       0.279161276741


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.877834139481        initial
     2.4414e-02     2.4414e-01             2.7005e-03        -0.910684173665
     9.7656e-02     9.7656e-01             1.4552e-03        -0.910851572533  <--
     3.9062e-01     3.9062e+00             5.3360e-04        -0.890388058928

*****************************************************************************
Applying the update for shift_i =   9.7656e-02     and shift_s =   9.7656e-01
*****************************************************************************

  Execution time = 2.2928e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_001                -4.395934e-02 3 1  ON 0
ci_002                -3.428295e-02 3 1  ON 1
ci_003                -2.776336e-02 3 1  ON 2
ci_004                 2.571325e-02 3 1  ON 3
ci_005                 2.494521e-02 3 1  ON 4
ci_006                -2.226491e-02 3 1  ON 5
ci_007                -2.225633e-02 3 1  ON 6
ci_008                -9.923205e-03 3 1  ON 7
ci_009                -1.555043e-02 3 1  ON 8
ci_010                -1.025877e-02 3 1  ON 9
ci_011                -1.110127e-02 3 1  ON 10
ci_012                -1.209821e-02 3 1  ON 11
ci_013                -2.002459e-02 3 1  ON 12
ci_014                 1.355307e-02 3 1  ON 13
ci_015                 1.296088e-02 3 1  ON 14
ci_016                 1.712655e-02 3 1  ON 15
ci_017                 1.756154e-02 3 1  ON 16
ci_018                 1.116960e-02 3 1  ON 17
ci_019                 1.153572e-02 3 1  ON 18
ci_020                 1.850060e-02 3 1  ON 19
ci_021                 1.849662e-02 3 1  ON 20
ci_022                 1.028212e-02 3 1  ON 21
ci_023                 1.070640e-02 3 1  ON 22
ci_024                 1.039276e-02 3 1  ON 23
ci_025                 1.039077e-02 3 1  ON 24
ci_026                 1.249194e-02 3 1  ON 25
ci_027                 1.231778e-02 3 1  ON 26
ci_028                -1.641084e-02 3 1  ON 27
ci_029                -1.647340e-02 3 1  ON 28
ci_030                -1.001732e-02 3 1  ON 29
ci_031                -9.919005e-03 3 1  ON 30
ci_032                -1.436106e-02 3 1  ON 31
ci_033                 6.911150e-03 3 1  ON 32
ci_034                 6.388824e-03 3 1  ON 33
ci_035                -6.127589e-03 3 1  ON 34
ci_036                -1.339753e-02 3 1  ON 35
ci_037                -1.318811e-02 3 1  ON 36
ci_038                 2.811646e-03 3 1  ON 37
ci_039                 2.720564e-03 3 1  ON 38
ci_040                -3.859491e-03 3 1  ON 39
ci_041                 8.846721e-03 3 1  ON 40
ci_042                 8.616075e-03 3 1  ON 41
ci_043                -4.826967e-03 3 1  ON 42
ci_044                -5.074212e-03 3 1  ON 43
ci_045                -3.571273e-03 3 1  ON 44
ci_046                 6.102564e-03 3 1  ON 45
ci_047                 6.357175e-03 3 1  ON 46
ci_048                -1.276445e-02 3 1  ON 47
ci_049                -1.348053e-02 3 1  ON 48
ci_050                 3.778045e-03 3 1  ON 49
ci_051                 3.892159e-03 3 1  ON 50
ci_052                -3.146074e-03 3 1  ON 51
ci_053                -3.026391e-03 3 1  ON 52
ci_054                -3.477603e-03 3 1  ON 53
ci_055                -3.471759e-03 3 1  ON 54
ci_056                 6.097557e-03 3 1  ON 55
ci_057                 6.378395e-03 3 1  ON 56
ci_058                -2.979361e-03 3 1  ON 57
ci_059                -2.319490e-03 3 1  ON 58
ci_060                 5.161242e-03 3 1  ON 59
ci_061                 6.318674e-03 3 1  ON 60
ci_062                -4.777117e-03 3 1  ON 61
ci_063                -3.848380e-03 3 1  ON 62
ci_064                -3.519598e-03 3 1  ON 63
ci_065                -4.521499e-03 3 1  ON 64
ci_066                 5.585803e-03 3 1  ON 65
ci_067                 4.763366e-03 3 1  ON 66
ci_068                -4.840506e-03 3 1  ON 67
ci_069                -5.029838e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9438e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2269
    reference variance = 0.143245
====================================================
  Execution time = 1.4008e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8732e-01
  Total weights = 1.956963333e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4891e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275048214915
                                         uncertainty =       0.001758361931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275048214915
                                         uncertainty =       0.001758361931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370819904
  error estimate for blocks of size 2^( 2) =       0.000384485780
  error estimate for blocks of size 2^( 3) =       0.000396267256
  error estimate for blocks of size 2^( 4) =       0.000404988112
  error estimate for blocks of size 2^( 5) =       0.000410657437
  error estimate for blocks of size 2^( 6) =       0.000412632889
  error estimate for blocks of size 2^( 7) =       0.000415522155

      target function =      -0.917078155434
              le_mean =     -17.212083317271
             les_mean =     296.543136489419
             stat err =       0.000410950148
             autocorr =       1.228152247777
   target nu stat err =       0.000410950148
   target dn stat err =       0.002207365667
      target stat err =       0.002937785188
              std dev =       0.524418537963
             le_variance =       0.275014802960


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721208331727e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917086789775       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917585943145       residual = 2.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917724783883       residual = 8.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917765122425       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917771328982       residual = 4.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917772958291       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917773951632       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917773840634       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917773608389       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917773671698       residual = 3.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917773700094       residual = 8.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-02 is 2.158739e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917086789775       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917377306862       residual = 2.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917452444706       residual = 7.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917471878868       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917474619343       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917475221226       residual = 7.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917475611390       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917475582222       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917475474919       residual = 5.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917475505823       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917475514400       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 1.153103e-03

solving harmonic davidson linear method for identity shift 3.9062e-01, overlap shift 3.9062e+00 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917086789775       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917195504331       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917221863384       residual = 6.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917228017076       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917228828356       residual = 2.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917228981392       residual = 5.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917229086419       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917229079416       residual = 1.66e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917229048790       residual = 2.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917229058241       residual = 5.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e-01 is 4.029684e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.220170 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6514e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_001                -4.280623e-02 3 1  ON 0
ci_002                -3.365961e-02 3 1  ON 1
ci_003                -2.703729e-02 3 1  ON 2
ci_004                 2.497846e-02 3 1  ON 3
ci_005                 2.487254e-02 3 1  ON 4
ci_006                -2.188674e-02 3 1  ON 5
ci_007                -2.166113e-02 3 1  ON 6
ci_008                -9.856239e-03 3 1  ON 7
ci_009                -1.485113e-02 3 1  ON 8
ci_010                -1.010266e-02 3 1  ON 9
ci_011                -1.112452e-02 3 1  ON 10
ci_012                -1.163022e-02 3 1  ON 11
ci_013                -1.960045e-02 3 1  ON 12
ci_014                 1.321096e-02 3 1  ON 13
ci_015                 1.265698e-02 3 1  ON 14
ci_016                 1.729474e-02 3 1  ON 15
ci_017                 1.740421e-02 3 1  ON 16
ci_018                 1.134156e-02 3 1  ON 17
ci_019                 1.134323e-02 3 1  ON 18
ci_020                 1.804603e-02 3 1  ON 19
ci_021                 1.782405e-02 3 1  ON 20
ci_022                 1.034760e-02 3 1  ON 21
ci_023                 9.979822e-03 3 1  ON 22
ci_024                 9.272748e-03 3 1  ON 23
ci_025                 1.024795e-02 3 1  ON 24
ci_026                 1.218323e-02 3 1  ON 25
ci_027                 1.199076e-02 3 1  ON 26
ci_028                -1.599617e-02 3 1  ON 27
ci_029                -1.613666e-02 3 1  ON 28
ci_030                -9.715507e-03 3 1  ON 29
ci_031                -9.947116e-03 3 1  ON 30
ci_032                -1.458238e-02 3 1  ON 31
ci_033                 6.197851e-03 3 1  ON 32
ci_034                 7.217127e-03 3 1  ON 33
ci_035                -5.665801e-03 3 1  ON 34
ci_036                -1.332003e-02 3 1  ON 35
ci_037                -1.316332e-02 3 1  ON 36
ci_038                 2.514382e-03 3 1  ON 37
ci_039                 2.624485e-03 3 1  ON 38
ci_040                -3.475841e-03 3 1  ON 39
ci_041                 8.632691e-03 3 1  ON 40
ci_042                 8.442144e-03 3 1  ON 41
ci_043                -4.373100e-03 3 1  ON 42
ci_044                -5.405460e-03 3 1  ON 43
ci_045                -3.401787e-03 3 1  ON 44
ci_046                 5.786170e-03 3 1  ON 45
ci_047                 6.328378e-03 3 1  ON 46
ci_048                -1.287798e-02 3 1  ON 47
ci_049                -1.361028e-02 3 1  ON 48
ci_050                 3.410267e-03 3 1  ON 49
ci_051                 3.814257e-03 3 1  ON 50
ci_052                -2.921533e-03 3 1  ON 51
ci_053                -2.798974e-03 3 1  ON 52
ci_054                -3.298858e-03 3 1  ON 53
ci_055                -3.307941e-03 3 1  ON 54
ci_056                 6.181817e-03 3 1  ON 55
ci_057                 6.100928e-03 3 1  ON 56
ci_058                -2.742980e-03 3 1  ON 57
ci_059                -2.467757e-03 3 1  ON 58
ci_060                 5.029135e-03 3 1  ON 59
ci_061                 6.047420e-03 3 1  ON 60
ci_062                -4.558604e-03 3 1  ON 61
ci_063                -3.755236e-03 3 1  ON 62
ci_064                -3.146262e-03 3 1  ON 63
ci_065                -4.319405e-03 3 1  ON 64
ci_066                 5.261671e-03 3 1  ON 65
ci_067                 5.173742e-03 3 1  ON 66
ci_068                -5.489037e-03 3 1  ON 67
ci_069                -4.699127e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2501
    reference variance = 0.213626
====================================================
  Execution time = 1.3505e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8631e-01
  Total weights = 1.9570e+06
  Execution time = 1.8376e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275647823043
                                         uncertainty =       0.001499536822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275647823043
                                         uncertainty =       0.001499536822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371239416
  error estimate for blocks of size 2^( 2) =       0.000385003411
  error estimate for blocks of size 2^( 3) =       0.000396981961
  error estimate for blocks of size 2^( 4) =       0.000405248062
  error estimate for blocks of size 2^( 5) =       0.000410496132
  error estimate for blocks of size 2^( 6) =       0.000413926057
  error estimate for blocks of size 2^( 7) =       0.000416536139

      target function =      -0.907274039263
              le_mean =     -17.212602817932
             les_mean =     296.568652234540
             stat err =       0.000411551597
             autocorr =       1.228967565705
   target nu stat err =       0.000411551597
   target dn stat err =       0.007019320473
      target stat err =       0.008987298496
              std dev =       0.525011817010
             le_variance =       0.275637408000

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275184585539
                                         uncertainty =       0.001499604478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275184585539
                                         uncertainty =       0.001499604478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370928396
  error estimate for blocks of size 2^( 2) =       0.000384949723
  error estimate for blocks of size 2^( 3) =       0.000397181086
  error estimate for blocks of size 2^( 4) =       0.000405660448
  error estimate for blocks of size 2^( 5) =       0.000411054405
  error estimate for blocks of size 2^( 6) =       0.000414639447
  error estimate for blocks of size 2^( 7) =       0.000417293716

      target function =      -0.916372323203
              le_mean =     -17.212617941899
             les_mean =     296.562183989583
             stat err =       0.000412162004
             autocorr =       1.234683782934
   target nu stat err =       0.000412162004
   target dn stat err =       0.002698922696
      target stat err =       0.003566228721
              std dev =       0.524571967710
             le_variance =       0.275175749308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275263232329
                                         uncertainty =       0.001502764246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275263232329
                                         uncertainty =       0.001502764246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370981332
  error estimate for blocks of size 2^( 2) =       0.000385035966
  error estimate for blocks of size 2^( 3) =       0.000397295590
  error estimate for blocks of size 2^( 4) =       0.000405794686
  error estimate for blocks of size 2^( 5) =       0.000411203598
  error estimate for blocks of size 2^( 6) =       0.000414791947
  error estimate for blocks of size 2^( 7) =       0.000417461176

      target function =      -0.870226017642
              le_mean =     -17.212632842842
             les_mean =     296.598558465958
             stat err =       0.000412312852
             autocorr =       1.235235120381
   target nu stat err =       0.000412312852
   target dn stat err =       0.032566914086
      target stat err =       0.038358249386
              std dev =       0.524646831180
             le_variance =       0.275254297467

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275404420894
                                         uncertainty =       0.001499261261

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275404420894
                                         uncertainty =       0.001499261261

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371075702
  error estimate for blocks of size 2^( 2) =       0.000384887369
  error estimate for blocks of size 2^( 3) =       0.000396910883
  error estimate for blocks of size 2^( 4) =       0.000405230414
  error estimate for blocks of size 2^( 5) =       0.000410501847
  error estimate for blocks of size 2^( 6) =       0.000413981145
  error estimate for blocks of size 2^( 7) =       0.000416599185

      target function =      -0.914024232419
              le_mean =     -17.212596990392
             les_mean =     296.563256307836
             stat err =       0.000411578148
             autocorr =       1.230210926521
   target nu stat err =       0.000411578148
   target dn stat err =       0.003652362378
      target stat err =       0.004771803710
              std dev =       0.524780290897
             le_variance =       0.275394353714


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.907274039263        initial
     2.4414e-02     2.4414e-01             2.1587e-03        -0.916372323203  <--
     9.7656e-02     9.7656e-01             1.1531e-03        -0.870226017642
     3.9062e-01     3.9062e+00             4.0297e-04        -0.914024232419

*****************************************************************************
Applying the update for shift_i =   2.4414e-02     and shift_s =   2.4414e-01
*****************************************************************************

  Execution time = 2.2809e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_001                -4.180060e-02 3 1  ON 0
ci_002                -3.315080e-02 3 1  ON 1
ci_003                -2.645052e-02 3 1  ON 2
ci_004                 2.434490e-02 3 1  ON 3
ci_005                 2.480602e-02 3 1  ON 4
ci_006                -2.157100e-02 3 1  ON 5
ci_007                -2.116990e-02 3 1  ON 6
ci_008                -9.805254e-03 3 1  ON 7
ci_009                -1.433464e-02 3 1  ON 8
ci_010                -9.990063e-03 3 1  ON 9
ci_011                -1.114149e-02 3 1  ON 10
ci_012                -1.127059e-02 3 1  ON 11
ci_013                -1.921744e-02 3 1  ON 12
ci_014                 1.293006e-02 3 1  ON 13
ci_015                 1.242142e-02 3 1  ON 14
ci_016                 1.747827e-02 3 1  ON 15
ci_017                 1.731045e-02 3 1  ON 16
ci_018                 1.143778e-02 3 1  ON 17
ci_019                 1.118746e-02 3 1  ON 18
ci_020                 1.767460e-02 3 1  ON 19
ci_021                 1.729405e-02 3 1  ON 20
ci_022                 1.041180e-02 3 1  ON 21
ci_023                 9.412970e-03 3 1  ON 22
ci_024                 8.337004e-03 3 1  ON 23
ci_025                 1.012242e-02 3 1  ON 24
ci_026                 1.192486e-02 3 1  ON 25
ci_027                 1.175744e-02 3 1  ON 26
ci_028                -1.565732e-02 3 1  ON 27
ci_029                -1.587555e-02 3 1  ON 28
ci_030                -9.510602e-03 3 1  ON 29
ci_031                -9.984633e-03 3 1  ON 30
ci_032                -1.476934e-02 3 1  ON 31
ci_033                 5.632190e-03 3 1  ON 32
ci_034                 7.855754e-03 3 1  ON 33
ci_035                -5.328143e-03 3 1  ON 34
ci_036                -1.323313e-02 3 1  ON 35
ci_037                -1.311199e-02 3 1  ON 36
ci_038                 2.300980e-03 3 1  ON 37
ci_039                 2.556455e-03 3 1  ON 38
ci_040                -3.204448e-03 3 1  ON 39
ci_041                 8.466197e-03 3 1  ON 40
ci_042                 8.316723e-03 3 1  ON 41
ci_043                -4.037865e-03 3 1  ON 42
ci_044                -5.658923e-03 3 1  ON 43
ci_045                -3.282482e-03 3 1  ON 44
ci_046                 5.537198e-03 3 1  ON 45
ci_047                 6.306723e-03 3 1  ON 46
ci_048                -1.299443e-02 3 1  ON 47
ci_049                -1.375729e-02 3 1  ON 48
ci_050                 3.159261e-03 3 1  ON 49
ci_051                 3.761396e-03 3 1  ON 50
ci_052                -2.788923e-03 3 1  ON 51
ci_053                -2.631380e-03 3 1  ON 52
ci_054                -3.162025e-03 3 1  ON 53
ci_055                -3.178292e-03 3 1  ON 54
ci_056                 6.243952e-03 3 1  ON 55
ci_057                 5.895419e-03 3 1  ON 56
ci_058                -2.579669e-03 3 1  ON 57
ci_059                -2.589237e-03 3 1  ON 58
ci_060                 4.930431e-03 3 1  ON 59
ci_061                 5.831398e-03 3 1  ON 60
ci_062                -4.360524e-03 3 1  ON 61
ci_063                -3.680599e-03 3 1  ON 62
ci_064                -2.884013e-03 3 1  ON 63
ci_065                -4.175563e-03 3 1  ON 64
ci_066                 5.034835e-03 3 1  ON 65
ci_067                 5.461991e-03 3 1  ON 66
ci_068                -6.007096e-03 3 1  ON 67
ci_069                -4.451588e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9337e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7217e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1292
    reference variance = 0.357222
====================================================
  Execution time = 1.4064e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8869e-01
  Total weights = 1.957063718e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4855e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277694314069
                                         uncertainty =       0.001427629920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277694314069
                                         uncertainty =       0.001427629920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372651492
  error estimate for blocks of size 2^( 2) =       0.000386190144
  error estimate for blocks of size 2^( 3) =       0.000398406284
  error estimate for blocks of size 2^( 4) =       0.000407451496
  error estimate for blocks of size 2^( 5) =       0.000412866012
  error estimate for blocks of size 2^( 6) =       0.000416046629
  error estimate for blocks of size 2^( 7) =       0.000417954156

      target function =      -0.915498065715
              le_mean =     -17.212866663259
             les_mean =     296.571470972089
             stat err =       0.000413579573
             autocorr =       1.231721241695
   target nu stat err =       0.000413579573
   target dn stat err =       0.002164430738
      target stat err =       0.002877459210
              std dev =       0.527008794713
             le_variance =       0.277738269705


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721286666326e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-03, overlap shift 6.1035e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915506278739       residual = 9.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915976622824       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916056067917       residual = 3.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916073346272       residual = 6.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916078718790       residual = 3.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916080340388       residual = 6.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916081126001       residual = 1.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916081610974       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916081793829       residual = 8.88e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916081711794       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916081705669       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916081725843       residual = 1.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-03 is 2.412138e-03

solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915506278739       residual = 9.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915892457753       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915954707298       residual = 3.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915967459889       residual = 6.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915971341028       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915972506589       residual = 5.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915973044072       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915973349495       residual = 2.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915973475425       residual = 6.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915973420046       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915973412901       residual = 6.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-02 is 1.926844e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915506278739       residual = 9.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915731331948       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915764456187       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915770489489       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915772281353       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915772814025       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915773038447       residual = 6.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915773144194       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915773196785       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915773174466       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915773170117       residual = 2.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 1.069927e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.229533 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6567e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_001                -4.230774e-02 3 1  ON 0
ci_002                -3.352926e-02 3 1  ON 1
ci_003                -2.635550e-02 3 1  ON 2
ci_004                 2.457322e-02 3 1  ON 3
ci_005                 2.601742e-02 3 1  ON 4
ci_006                -2.176724e-02 3 1  ON 5
ci_007                -2.142460e-02 3 1  ON 6
ci_008                -9.453780e-03 3 1  ON 7
ci_009                -1.528526e-02 3 1  ON 8
ci_010                -9.367046e-03 3 1  ON 9
ci_011                -1.050865e-02 3 1  ON 10
ci_012                -9.421586e-03 3 1  ON 11
ci_013                -1.977087e-02 3 1  ON 12
ci_014                 1.290281e-02 3 1  ON 13
ci_015                 1.266978e-02 3 1  ON 14
ci_016                 1.694628e-02 3 1  ON 15
ci_017                 1.651914e-02 3 1  ON 16
ci_018                 1.129954e-02 3 1  ON 17
ci_019                 1.119060e-02 3 1  ON 18
ci_020                 1.747230e-02 3 1  ON 19
ci_021                 1.779856e-02 3 1  ON 20
ci_022                 1.043390e-02 3 1  ON 21
ci_023                 9.502928e-03 3 1  ON 22
ci_024                 8.993700e-03 3 1  ON 23
ci_025                 9.168300e-03 3 1  ON 24
ci_026                 1.110473e-02 3 1  ON 25
ci_027                 1.117882e-02 3 1  ON 26
ci_028                -1.561213e-02 3 1  ON 27
ci_029                -1.553876e-02 3 1  ON 28
ci_030                -9.250445e-03 3 1  ON 29
ci_031                -9.621816e-03 3 1  ON 30
ci_032                -1.428993e-02 3 1  ON 31
ci_033                 6.040735e-03 3 1  ON 32
ci_034                 5.928910e-03 3 1  ON 33
ci_035                -5.390132e-03 3 1  ON 34
ci_036                -1.244300e-02 3 1  ON 35
ci_037                -1.329391e-02 3 1  ON 36
ci_038                 2.033135e-03 3 1  ON 37
ci_039                 2.453554e-03 3 1  ON 38
ci_040                -3.144551e-03 3 1  ON 39
ci_041                 8.660162e-03 3 1  ON 40
ci_042                 8.045192e-03 3 1  ON 41
ci_043                -4.159462e-03 3 1  ON 42
ci_044                -5.934825e-03 3 1  ON 43
ci_045                -3.590465e-03 3 1  ON 44
ci_046                 5.835317e-03 3 1  ON 45
ci_047                 5.794025e-03 3 1  ON 46
ci_048                -1.335526e-02 3 1  ON 47
ci_049                -1.393666e-02 3 1  ON 48
ci_050                 3.795624e-03 3 1  ON 49
ci_051                 3.618462e-03 3 1  ON 50
ci_052                -2.499697e-03 3 1  ON 51
ci_053                -3.173421e-03 3 1  ON 52
ci_054                -3.088812e-03 3 1  ON 53
ci_055                -3.235490e-03 3 1  ON 54
ci_056                 6.544779e-03 3 1  ON 55
ci_057                 5.904121e-03 3 1  ON 56
ci_058                -2.197369e-03 3 1  ON 57
ci_059                -2.964831e-03 3 1  ON 58
ci_060                 4.713842e-03 3 1  ON 59
ci_061                 5.364583e-03 3 1  ON 60
ci_062                -3.674969e-03 3 1  ON 61
ci_063                -4.141951e-03 3 1  ON 62
ci_064                -3.182784e-03 3 1  ON 63
ci_065                -3.974361e-03 3 1  ON 64
ci_066                 4.995445e-03 3 1  ON 65
ci_067                 5.294073e-03 3 1  ON 66
ci_068                -5.183491e-03 3 1  ON 67
ci_069                -4.414851e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2198
    reference variance = 0.185779
====================================================
  Execution time = 1.3491e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8803e-01
  Total weights = 1.9570e+06
  Execution time = 1.8356e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000396307
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276044331998
                                         uncertainty =       0.001506517920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276044331998
                                         uncertainty =       0.001506517920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371532724
  error estimate for blocks of size 2^( 2) =       0.000385184906
  error estimate for blocks of size 2^( 3) =       0.000397426781
  error estimate for blocks of size 2^( 4) =       0.000405957075
  error estimate for blocks of size 2^( 5) =       0.000411887030
  error estimate for blocks of size 2^( 6) =       0.000414447672
  error estimate for blocks of size 2^( 7) =       0.000417136470

      target function =      -0.852834852868
              le_mean =     -17.211628594316
             les_mean =     296.578549200205
             stat err =       0.000412357062
             autocorr =       1.231835539622
   target nu stat err =       0.000412357062
   target dn stat err =       0.037425330267
      target stat err =       0.042291210583
              std dev =       0.525426617254
             le_variance =       0.276073130119

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0350981
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275402769250
                                         uncertainty =       0.001336607707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275402769250
                                         uncertainty =       0.001336607707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371102246
  error estimate for blocks of size 2^( 2) =       0.000384844597
  error estimate for blocks of size 2^( 3) =       0.000397150533
  error estimate for blocks of size 2^( 4) =       0.000405706521
  error estimate for blocks of size 2^( 5) =       0.000411618310
  error estimate for blocks of size 2^( 6) =       0.000414189540
  error estimate for blocks of size 2^( 7) =       0.000417003226

      target function =      -0.913396176782
              le_mean =     -17.211626835560
             les_mean =     296.530165079832
             stat err =       0.000412129399
             autocorr =       1.233332073758
   target nu stat err =       0.000412129399
   target dn stat err =       0.002630726761
      target stat err =       0.003451022293
              std dev =       0.524817829675
             le_variance =       0.275433754345

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000394722
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276375354242
                                         uncertainty =       0.001356565009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276375354242
                                         uncertainty =       0.001356565009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371756450
  error estimate for blocks of size 2^( 2) =       0.000385523660
  error estimate for blocks of size 2^( 3) =       0.000397836683
  error estimate for blocks of size 2^( 4) =       0.000406413323
  error estimate for blocks of size 2^( 5) =       0.000412301890
  error estimate for blocks of size 2^( 6) =       0.000414885865
  error estimate for blocks of size 2^( 7) =       0.000417747480

      target function =      -0.787911161244
              le_mean =     -17.211688742557
             les_mean =     296.636356782713
             stat err =       0.000412837140
             autocorr =       1.233219822077
   target nu stat err =       0.000412837140
   target dn stat err =       0.082853871408
      target stat err =       0.080552973396
              std dev =       0.525743013036
             le_variance =       0.276405715756

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0045571
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275386049962
                                         uncertainty =       0.001342303907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275386049962
                                         uncertainty =       0.001342303907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371090857
  error estimate for blocks of size 2^( 2) =       0.000384796770
  error estimate for blocks of size 2^( 3) =       0.000397064160
  error estimate for blocks of size 2^( 4) =       0.000405611842
  error estimate for blocks of size 2^( 5) =       0.000411562181
  error estimate for blocks of size 2^( 6) =       0.000414117515
  error estimate for blocks of size 2^( 7) =       0.000416883576

      target function =      -0.879740550145
              le_mean =     -17.211626195570
             les_mean =     296.556368131709
             stat err =       0.000412043779
             autocorr =       1.232895347378
   target nu stat err =       0.000412043779
   target dn stat err =       0.024388735163
      target stat err =       0.029289414471
              std dev =       0.524801722901
             le_variance =       0.275416848360


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.852834852868        initial
     6.1035e-03     6.1035e-02             2.4121e-03        -0.913396176782  <--
     2.4414e-02     2.4414e-01             1.9268e-03        -0.787911161244
     9.7656e-02     9.7656e-01             1.0699e-03        -0.879740550145

*****************************************************************************
Applying the update for shift_i =   6.1035e-03     and shift_s =   6.1035e-02
*****************************************************************************

  Execution time = 2.2794e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_001                -4.244906e-02 3 1  ON 0
ci_002                -3.363516e-02 3 1  ON 1
ci_003                -2.630296e-02 3 1  ON 2
ci_004                 2.461887e-02 3 1  ON 3
ci_005                 2.633314e-02 3 1  ON 4
ci_006                -2.182502e-02 3 1  ON 5
ci_007                -2.150219e-02 3 1  ON 6
ci_008                -9.375022e-03 3 1  ON 7
ci_009                -1.550644e-02 3 1  ON 8
ci_010                -9.218141e-03 3 1  ON 9
ci_011                -1.036287e-02 3 1  ON 10
ci_012                -8.991146e-03 3 1  ON 11
ci_013                -1.994405e-02 3 1  ON 12
ci_014                 1.289346e-02 3 1  ON 13
ci_015                 1.274347e-02 3 1  ON 14
ci_016                 1.679413e-02 3 1  ON 15
ci_017                 1.629212e-02 3 1  ON 16
ci_018                 1.128198e-02 3 1  ON 17
ci_019                 1.118761e-02 3 1  ON 18
ci_020                 1.742063e-02 3 1  ON 19
ci_021                 1.793480e-02 3 1  ON 20
ci_022                 1.043393e-02 3 1  ON 21
ci_023                 9.535144e-03 3 1  ON 22
ci_024                 9.149122e-03 3 1  ON 23
ci_025                 8.920234e-03 3 1  ON 24
ci_026                 1.093006e-02 3 1  ON 25
ci_027                 1.107838e-02 3 1  ON 26
ci_028                -1.560153e-02 3 1  ON 27
ci_029                -1.544317e-02 3 1  ON 28
ci_030                -9.198242e-03 3 1  ON 29
ci_031                -9.540657e-03 3 1  ON 30
ci_032                -1.416314e-02 3 1  ON 31
ci_033                 6.142362e-03 3 1  ON 32
ci_034                 5.443616e-03 3 1  ON 33
ci_035                -5.403771e-03 3 1  ON 34
ci_036                -1.226336e-02 3 1  ON 35
ci_037                -1.332109e-02 3 1  ON 36
ci_038                 1.972937e-03 3 1  ON 37
ci_039                 2.430520e-03 3 1  ON 38
ci_040                -3.132101e-03 3 1  ON 39
ci_041                 8.701281e-03 3 1  ON 40
ci_042                 7.977217e-03 3 1  ON 41
ci_043                -4.187171e-03 3 1  ON 42
ci_044                -5.992701e-03 3 1  ON 43
ci_045                -3.657887e-03 3 1  ON 44
ci_046                 5.909529e-03 3 1  ON 45
ci_047                 5.668206e-03 3 1  ON 46
ci_048                -1.344183e-02 3 1  ON 47
ci_049                -1.397610e-02 3 1  ON 48
ci_050                 3.926493e-03 3 1  ON 49
ci_051                 3.588320e-03 3 1  ON 50
ci_052                -2.432891e-03 3 1  ON 51
ci_053                -3.291390e-03 3 1  ON 52
ci_054                -3.067059e-03 3 1  ON 53
ci_055                -3.245477e-03 3 1  ON 54
ci_056                 6.613837e-03 3 1  ON 55
ci_057                 5.906625e-03 3 1  ON 56
ci_058                -2.108386e-03 3 1  ON 57
ci_059                -3.043851e-03 3 1  ON 58
ci_060                 4.660550e-03 3 1  ON 59
ci_061                 5.252808e-03 3 1  ON 60
ci_062                -3.516133e-03 3 1  ON 61
ci_063                -4.241842e-03 3 1  ON 62
ci_064                -3.247064e-03 3 1  ON 63
ci_065                -3.930946e-03 3 1  ON 64
ci_066                 4.983644e-03 3 1  ON 65
ci_067                 5.270050e-03 3 1  ON 66
ci_068                -4.980502e-03 3 1  ON 67
ci_069                -4.404805e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9376e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1422
    reference variance = 0.866805
====================================================
  Execution time = 1.3923e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5278e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.9108e-01
  Total weights = 1.956955822e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5363e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278026784569
                                         uncertainty =       0.001820935367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278026784569
                                         uncertainty =       0.001820935367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372917092
  error estimate for blocks of size 2^( 2) =       0.000386293230
  error estimate for blocks of size 2^( 3) =       0.000399011310
  error estimate for blocks of size 2^( 4) =       0.000407878124
  error estimate for blocks of size 2^( 5) =       0.000413125751
  error estimate for blocks of size 2^( 6) =       0.000416352124
  error estimate for blocks of size 2^( 7) =       0.000415778064

      target function =      -0.912314720351
              le_mean =     -17.212562840853
             les_mean =     296.563402448982
             stat err =       0.000413283516
             autocorr =       1.228207062037
   target nu stat err =       0.000413283516
   target dn stat err =       0.002951029755
      target stat err =       0.003856652190
              std dev =       0.527384408746
             le_variance =       0.278134314589


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721256284085e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-03, overlap shift 1.5259e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912330060921       residual = 2.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913137932635       residual = 3.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913293184281       residual = 9.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913345180248       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913362677236       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913368105604       residual = 2.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913366950118       residual = 6.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913367671060       residual = 1.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913367305122       residual = 4.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913367191360       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913367300066       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913367310772       residual = 7.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-03 is 2.526508e-03

solving harmonic davidson linear method for identity shift 6.1035e-03, overlap shift 6.1035e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912330060921       residual = 2.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913095110773       residual = 3.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913240628942       residual = 9.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913288595382       residual = 2.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913304571804       residual = 6.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913309441320       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913308319511       residual = 5.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913308965712       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913308630555       residual = 3.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913308534315       residual = 6.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913308628455       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913308638136       residual = 6.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-03 is 2.379575e-03

solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912330060921       residual = 2.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912961255632       residual = 3.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913077487725       residual = 8.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913113944712       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913125723059       residual = 5.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913129116828       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913128152427       residual = 4.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913128604313       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913128356065       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913128302288       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913128360750       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913128367471       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-02 is 1.930322e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.239433 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6480e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_001                -4.218953e-02 3 1  ON 0
ci_002                -3.287333e-02 3 1  ON 1
ci_003                -2.526316e-02 3 1  ON 2
ci_004                 2.435004e-02 3 1  ON 3
ci_005                 2.400077e-02 3 1  ON 4
ci_006                -2.042998e-02 3 1  ON 5
ci_007                -2.201902e-02 3 1  ON 6
ci_008                -9.467779e-03 3 1  ON 7
ci_009                -1.511562e-02 3 1  ON 8
ci_010                -1.022850e-02 3 1  ON 9
ci_011                -1.003758e-02 3 1  ON 10
ci_012                -1.001566e-02 3 1  ON 11
ci_013                -1.974569e-02 3 1  ON 12
ci_014                 1.317546e-02 3 1  ON 13
ci_015                 1.373526e-02 3 1  ON 14
ci_016                 1.823590e-02 3 1  ON 15
ci_017                 1.711864e-02 3 1  ON 16
ci_018                 1.146781e-02 3 1  ON 17
ci_019                 1.221184e-02 3 1  ON 18
ci_020                 1.770906e-02 3 1  ON 19
ci_021                 1.694306e-02 3 1  ON 20
ci_022                 9.304534e-03 3 1  ON 21
ci_023                 1.013292e-02 3 1  ON 22
ci_024                 8.393411e-03 3 1  ON 23
ci_025                 8.773696e-03 3 1  ON 24
ci_026                 1.205124e-02 3 1  ON 25
ci_027                 1.191352e-02 3 1  ON 26
ci_028                -1.595824e-02 3 1  ON 27
ci_029                -1.543723e-02 3 1  ON 28
ci_030                -9.220493e-03 3 1  ON 29
ci_031                -9.814376e-03 3 1  ON 30
ci_032                -1.456982e-02 3 1  ON 31
ci_033                 4.859662e-03 3 1  ON 32
ci_034                 4.875324e-03 3 1  ON 33
ci_035                -5.093740e-03 3 1  ON 34
ci_036                -1.344740e-02 3 1  ON 35
ci_037                -1.473037e-02 3 1  ON 36
ci_038                 2.542520e-03 3 1  ON 37
ci_039                 2.222233e-03 3 1  ON 38
ci_040                -2.533667e-03 3 1  ON 39
ci_041                 8.795754e-03 3 1  ON 40
ci_042                 8.500340e-03 3 1  ON 41
ci_043                -4.072948e-03 3 1  ON 42
ci_044                -3.613125e-03 3 1  ON 43
ci_045                -3.424821e-03 3 1  ON 44
ci_046                 5.753020e-03 3 1  ON 45
ci_047                 5.912887e-03 3 1  ON 46
ci_048                -1.413670e-02 3 1  ON 47
ci_049                -1.429079e-02 3 1  ON 48
ci_050                 3.590611e-03 3 1  ON 49
ci_051                 2.074241e-03 3 1  ON 50
ci_052                -2.879389e-03 3 1  ON 51
ci_053                -1.784976e-03 3 1  ON 52
ci_054                -2.090379e-03 3 1  ON 53
ci_055                -2.778383e-03 3 1  ON 54
ci_056                 6.180973e-03 3 1  ON 55
ci_057                 6.193234e-03 3 1  ON 56
ci_058                -1.669964e-03 3 1  ON 57
ci_059                -2.281834e-03 3 1  ON 58
ci_060                 5.764220e-03 3 1  ON 59
ci_061                 5.885363e-03 3 1  ON 60
ci_062                -3.888975e-03 3 1  ON 61
ci_063                -4.513560e-03 3 1  ON 62
ci_064                -3.675636e-03 3 1  ON 63
ci_065                -4.338615e-03 3 1  ON 64
ci_066                 4.841603e-03 3 1  ON 65
ci_067                 4.368741e-03 3 1  ON 66
ci_068                -6.617037e-03 3 1  ON 67
ci_069                -5.012812e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2458
    reference variance = 0.19258
====================================================
  Execution time = 1.3583e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8961e-01
  Total weights = 1.9571e+06
  Execution time = 1.8387e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277996230052
                                         uncertainty =       0.001750457993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277996230052
                                         uncertainty =       0.001750457993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372791317
  error estimate for blocks of size 2^( 2) =       0.000386893986
  error estimate for blocks of size 2^( 3) =       0.000399253532
  error estimate for blocks of size 2^( 4) =       0.000408449315
  error estimate for blocks of size 2^( 5) =       0.000414661233
  error estimate for blocks of size 2^( 6) =       0.000418011458
  error estimate for blocks of size 2^( 7) =       0.000420864356

      target function =      -0.904790864801
              le_mean =     -17.211871420215
             les_mean =     296.545327472957
             stat err =       0.000415496591
             autocorr =       1.242233827284
   target nu stat err =       0.000415496591
   target dn stat err =       0.004713479334
      target stat err =       0.006010699852
              std dev =       0.527206537103
             le_variance =       0.277946732764

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277363215819
                                         uncertainty =       0.001757096828

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277363215819
                                         uncertainty =       0.001757096828

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372369087
  error estimate for blocks of size 2^( 2) =       0.000386499527
  error estimate for blocks of size 2^( 3) =       0.000398911131
  error estimate for blocks of size 2^( 4) =       0.000408143954
  error estimate for blocks of size 2^( 5) =       0.000414354821
  error estimate for blocks of size 2^( 6) =       0.000417769266
  error estimate for blocks of size 2^( 7) =       0.000420667212

      target function =      -0.909937983798
              le_mean =     -17.211745795839
             les_mean =     296.536964001570
             stat err =       0.000415233813
             autocorr =       1.243478223941
   target nu stat err =       0.000415233813
   target dn stat err =       0.003090254399
      target stat err =       0.004009058121
              std dev =       0.526609412647
             le_variance =       0.277317473488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279072217286
                                         uncertainty =       0.001777472207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279072217286
                                         uncertainty =       0.001777472207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373515444
  error estimate for blocks of size 2^( 2) =       0.000387673556
  error estimate for blocks of size 2^( 3) =       0.000400136073
  error estimate for blocks of size 2^( 4) =       0.000409408263
  error estimate for blocks of size 2^( 5) =       0.000415621980
  error estimate for blocks of size 2^( 6) =       0.000419128809
  error estimate for blocks of size 2^( 7) =       0.000422047528

      target function =      -0.850272828825
              le_mean =     -17.211866170626
             les_mean =     296.589715574646
             stat err =       0.000416551645
             autocorr =       1.243714167838
   target nu stat err =       0.000416551645
   target dn stat err =       0.029802369495
      target stat err =       0.033458833382
              std dev =       0.528230606200
             le_variance =       0.279027573326

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277292063282
                                         uncertainty =       0.001756992949

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277292063282
                                         uncertainty =       0.001756992949

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372320815
  error estimate for blocks of size 2^( 2) =       0.000386445591
  error estimate for blocks of size 2^( 3) =       0.000398843242
  error estimate for blocks of size 2^( 4) =       0.000408060913
  error estimate for blocks of size 2^( 5) =       0.000414276567
  error estimate for blocks of size 2^( 6) =       0.000417670058
  error estimate for blocks of size 2^( 7) =       0.000420550519

      target function =      -0.908132000329
              le_mean =     -17.211753280955
             les_mean =     296.538615516191
             stat err =       0.000415139514
             autocorr =       1.243235810944
   target nu stat err =       0.000415139514
   target dn stat err =       0.004701465256
      target stat err =       0.006038521118
              std dev =       0.526541146736
             le_variance =       0.277245579206


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.904790864801        initial
     1.5259e-03     1.5259e-02             2.5265e-03        -0.909937983798  <--
     6.1035e-03     6.1035e-02             2.3796e-03        -0.850272828825
     2.4414e-02     2.4414e-01             1.9303e-03        -0.908132000329

*****************************************************************************
Applying the update for shift_i =   1.5259e-03     and shift_s =   1.5259e-02
*****************************************************************************

  Execution time = 2.2880e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_001                -4.216585e-02 3 1  ON 0
ci_002                -3.281621e-02 3 1  ON 1
ci_003                -2.520760e-02 3 1  ON 2
ci_004                 2.433773e-02 3 1  ON 3
ci_005                 2.383331e-02 3 1  ON 4
ci_006                -2.032302e-02 3 1  ON 5
ci_007                -2.205124e-02 3 1  ON 6
ci_008                -9.476799e-03 3 1  ON 7
ci_009                -1.509155e-02 3 1  ON 8
ci_010                -1.029360e-02 3 1  ON 9
ci_011                -1.001597e-02 3 1  ON 10
ci_012                -1.008003e-02 3 1  ON 11
ci_013                -1.973017e-02 3 1  ON 12
ci_014                 1.319859e-02 3 1  ON 13
ci_015                 1.380446e-02 3 1  ON 14
ci_016                 1.834553e-02 3 1  ON 15
ci_017                 1.718421e-02 3 1  ON 16
ci_018                 1.147143e-02 3 1  ON 17
ci_019                 1.227307e-02 3 1  ON 18
ci_020                 1.773541e-02 3 1  ON 19
ci_021                 1.687179e-02 3 1  ON 20
ci_022                 9.234295e-03 3 1  ON 21
ci_023                 1.016749e-02 3 1  ON 22
ci_024                 8.342739e-03 3 1  ON 23
ci_025                 8.766280e-03 3 1  ON 24
ci_026                 1.211605e-02 3 1  ON 25
ci_027                 1.194736e-02 3 1  ON 26
ci_028                -1.598748e-02 3 1  ON 27
ci_029                -1.543847e-02 3 1  ON 28
ci_030                -9.225018e-03 3 1  ON 29
ci_031                -9.831535e-03 3 1  ON 30
ci_032                -1.459804e-02 3 1  ON 31
ci_033                 4.773185e-03 3 1  ON 32
ci_034                 4.839078e-03 3 1  ON 33
ci_035                -5.075265e-03 3 1  ON 34
ci_036                -1.351476e-02 3 1  ON 35
ci_037                -1.481029e-02 3 1  ON 36
ci_038                 2.575666e-03 3 1  ON 37
ci_039                 2.210217e-03 3 1  ON 38
ci_040                -2.499452e-03 3 1  ON 39
ci_041                 8.805324e-03 3 1  ON 40
ci_042                 8.530786e-03 3 1  ON 41
ci_043                -4.065900e-03 3 1  ON 42
ci_044                -3.466192e-03 3 1  ON 43
ci_045                -3.411254e-03 3 1  ON 44
ci_046                 5.742901e-03 3 1  ON 45
ci_047                 5.929198e-03 3 1  ON 46
ci_048                -1.418928e-02 3 1  ON 47
ci_049                -1.432085e-02 3 1  ON 48
ci_050                 3.571378e-03 3 1  ON 49
ci_051                 1.991962e-03 3 1  ON 50
ci_052                -2.904613e-03 3 1  ON 51
ci_053                -1.703210e-03 3 1  ON 52
ci_054                -2.029125e-03 3 1  ON 53
ci_055                -2.747131e-03 3 1  ON 54
ci_056                 6.154782e-03 3 1  ON 55
ci_057                 6.210541e-03 3 1  ON 56
ci_058                -1.639078e-03 3 1  ON 57
ci_059                -2.235752e-03 3 1  ON 58
ci_060                 5.836966e-03 3 1  ON 59
ci_061                 5.927885e-03 3 1  ON 60
ci_062                -3.910093e-03 3 1  ON 61
ci_063                -4.530479e-03 3 1  ON 62
ci_064                -3.699969e-03 3 1  ON 63
ci_065                -4.362512e-03 3 1  ON 64
ci_066                 4.835761e-03 3 1  ON 65
ci_067                 4.314768e-03 3 1  ON 66
ci_068                -6.725468e-03 3 1  ON 67
ci_069                -5.052923e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9375e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.1308
    reference variance = 0.496492
====================================================
  Execution time = 1.3805e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8838e-01
  Total weights = 1.957257574e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4894e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275391596687
                                         uncertainty =       0.001423464360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275391596687
                                         uncertainty =       0.001423464360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371049147
  error estimate for blocks of size 2^( 2) =       0.000384856062
  error estimate for blocks of size 2^( 3) =       0.000396977168
  error estimate for blocks of size 2^( 4) =       0.000405496063
  error estimate for blocks of size 2^( 5) =       0.000410674129
  error estimate for blocks of size 2^( 6) =       0.000414686014
  error estimate for blocks of size 2^( 7) =       0.000417059432

      target function =      -0.915611828606
              le_mean =     -17.211714731536
             les_mean =     296.531501500232
             stat err =       0.000411978910
             autocorr =       1.232784296681
   target nu stat err =       0.000411978910
   target dn stat err =       0.002207308994
      target stat err =       0.002927129863
              std dev =       0.524742735303
             le_variance =       0.275354938253


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721171473154e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-04, overlap shift 3.8147e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915620408049       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916187181997       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916280311610       residual = 6.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916330977899       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916334970286       residual = 3.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916340431559       residual = 7.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916340196862       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916340486818       residual = 4.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916340546580       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916340657776       residual = 3.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916340729625       residual = 9.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-04 is 2.130308e-03

solving harmonic davidson linear method for identity shift 1.5259e-03, overlap shift 1.5259e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915620408049       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916179068451       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916270595573       residual = 6.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916320153813       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916324034202       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916329333853       residual = 7.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916329106268       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916329387028       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916329442228       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916329550230       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916329618247       residual = 9.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-03 is 2.096560e-03

solving harmonic davidson linear method for identity shift 6.1035e-03, overlap shift 6.1035e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915620408049       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916148810045       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916234435220       residual = 6.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916279982854       residual = 9.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916283466858       residual = 3.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916288194112       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916287995928       residual = 1.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916288240129       residual = 3.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916288283853       residual = 8.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916288379693       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916288434792       residual = 7.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-03 is 1.971632e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.248382 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6312e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_001                -4.142915e-02 3 1  ON 0
ci_002                -3.315555e-02 3 1  ON 1
ci_003                -2.506037e-02 3 1  ON 2
ci_004                 2.285669e-02 3 1  ON 3
ci_005                 2.453476e-02 3 1  ON 4
ci_006                -2.187622e-02 3 1  ON 5
ci_007                -2.222914e-02 3 1  ON 6
ci_008                -9.336193e-03 3 1  ON 7
ci_009                -1.524488e-02 3 1  ON 8
ci_010                -8.197035e-03 3 1  ON 9
ci_011                -1.050597e-02 3 1  ON 10
ci_012                -1.074670e-02 3 1  ON 11
ci_013                -1.985118e-02 3 1  ON 12
ci_014                 1.329922e-02 3 1  ON 13
ci_015                 1.312553e-02 3 1  ON 14
ci_016                 1.695774e-02 3 1  ON 15
ci_017                 1.700732e-02 3 1  ON 16
ci_018                 1.029754e-02 3 1  ON 17
ci_019                 1.083336e-02 3 1  ON 18
ci_020                 1.864647e-02 3 1  ON 19
ci_021                 1.788458e-02 3 1  ON 20
ci_022                 1.045629e-02 3 1  ON 21
ci_023                 1.024392e-02 3 1  ON 22
ci_024                 8.920301e-03 3 1  ON 23
ci_025                 7.802050e-03 3 1  ON 24
ci_026                 1.142466e-02 3 1  ON 25
ci_027                 1.119428e-02 3 1  ON 26
ci_028                -1.567453e-02 3 1  ON 27
ci_029                -1.562250e-02 3 1  ON 28
ci_030                -8.728122e-03 3 1  ON 29
ci_031                -8.706767e-03 3 1  ON 30
ci_032                -1.490117e-02 3 1  ON 31
ci_033                 4.740001e-03 3 1  ON 32
ci_034                 6.278725e-03 3 1  ON 33
ci_035                -5.904825e-03 3 1  ON 34
ci_036                -1.325655e-02 3 1  ON 35
ci_037                -1.342332e-02 3 1  ON 36
ci_038                 2.374304e-03 3 1  ON 37
ci_039                 2.918745e-03 3 1  ON 38
ci_040                -3.012288e-03 3 1  ON 39
ci_041                 8.886351e-03 3 1  ON 40
ci_042                 9.060808e-03 3 1  ON 41
ci_043                -3.956699e-03 3 1  ON 42
ci_044                -4.466892e-03 3 1  ON 43
ci_045                -3.636019e-03 3 1  ON 44
ci_046                 5.338261e-03 3 1  ON 45
ci_047                 6.459636e-03 3 1  ON 46
ci_048                -1.310234e-02 3 1  ON 47
ci_049                -1.307824e-02 3 1  ON 48
ci_050                 3.483533e-03 3 1  ON 49
ci_051                 2.819884e-03 3 1  ON 50
ci_052                -2.862062e-03 3 1  ON 51
ci_053                -2.668183e-03 3 1  ON 52
ci_054                -3.342900e-03 3 1  ON 53
ci_055                -3.215703e-03 3 1  ON 54
ci_056                 5.360551e-03 3 1  ON 55
ci_057                 6.200380e-03 3 1  ON 56
ci_058                -1.547649e-03 3 1  ON 57
ci_059                -2.709821e-03 3 1  ON 58
ci_060                 6.858020e-03 3 1  ON 59
ci_061                 5.139949e-03 3 1  ON 60
ci_062                -3.853286e-03 3 1  ON 61
ci_063                -4.169988e-03 3 1  ON 62
ci_064                -3.400373e-03 3 1  ON 63
ci_065                -3.909451e-03 3 1  ON 64
ci_066                 4.631587e-03 3 1  ON 65
ci_067                 4.459188e-03 3 1  ON 66
ci_068                -5.719113e-03 3 1  ON 67
ci_069                -6.061021e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.3107
    reference variance = 1.5789
====================================================
  Execution time = 1.3494e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8630e-01
  Total weights = 1.9574e+06
  Execution time = 1.8795e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0165178
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274975688621
                                         uncertainty =       0.001584830846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274975688621
                                         uncertainty =       0.001584830846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370776958
  error estimate for blocks of size 2^( 2) =       0.000384677297
  error estimate for blocks of size 2^( 3) =       0.000396760709
  error estimate for blocks of size 2^( 4) =       0.000405699044
  error estimate for blocks of size 2^( 5) =       0.000411042842
  error estimate for blocks of size 2^( 6) =       0.000415065264
  error estimate for blocks of size 2^( 7) =       0.000415601300

      target function =      -0.881837359907
              le_mean =     -17.212291938999
             les_mean =     296.577843638622
             stat err =       0.000411852112
             autocorr =       1.233835101574
   target nu stat err =       0.000411852112
   target dn stat err =       0.021155498923
      target stat err =       0.025548782183
              std dev =       0.524357802589
             le_variance =       0.274951105136

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274079237076
                                         uncertainty =       0.001488803878

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274079237076
                                         uncertainty =       0.001488803878

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370174374
  error estimate for blocks of size 2^( 2) =       0.000384170652
  error estimate for blocks of size 2^( 3) =       0.000396358879
  error estimate for blocks of size 2^( 4) =       0.000405390144
  error estimate for blocks of size 2^( 5) =       0.000410790342
  error estimate for blocks of size 2^( 6) =       0.000414819660
  error estimate for blocks of size 2^( 7) =       0.000415443999

      target function =      -0.918538608101
              le_mean =     -17.212220339390
             les_mean =     296.546763051256
             stat err =       0.000411611036
             autocorr =       1.236406615149
   target nu stat err =       0.000411611036
   target dn stat err =       0.002179729810
      target stat err =       0.002912341302
              std dev =       0.523505620067
             le_variance =       0.274058134242

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0168462
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275419943944
                                         uncertainty =       0.001481980373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275419943944
                                         uncertainty =       0.001481980373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371080185
  error estimate for blocks of size 2^( 2) =       0.000385148886
  error estimate for blocks of size 2^( 3) =       0.000397426819
  error estimate for blocks of size 2^( 4) =       0.000406518448
  error estimate for blocks of size 2^( 5) =       0.000411965084
  error estimate for blocks of size 2^( 6) =       0.000415996099
  error estimate for blocks of size 2^( 7) =       0.000416609516

      target function =      -0.831148870626
              le_mean =     -17.212348781597
             les_mean =     296.622505732794
             stat err =       0.000412772287
             autocorr =       1.237329970671
   target nu stat err =       0.000412772287
   target dn stat err =       0.043916169329
      target stat err =       0.047222197901
              std dev =       0.524786631041
             le_variance =       0.275401008120

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274054555274
                                         uncertainty =       0.001491677915

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274054555274
                                         uncertainty =       0.001491677915

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370157552
  error estimate for blocks of size 2^( 2) =       0.000384147942
  error estimate for blocks of size 2^( 3) =       0.000396329494
  error estimate for blocks of size 2^( 4) =       0.000405356137
  error estimate for blocks of size 2^( 5) =       0.000410752030
  error estimate for blocks of size 2^( 6) =       0.000414783421
  error estimate for blocks of size 2^( 7) =       0.000415406564

      target function =      -0.915976868787
              le_mean =     -17.212218395301
             les_mean =     296.548655279280
             stat err =       0.000411574538
             autocorr =       1.236299718230
   target nu stat err =       0.000411574538
   target dn stat err =       0.002670403118
      target stat err =       0.003524235663
              std dev =       0.523481829975
             le_variance =       0.274033226314


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.881837359907        initial
     3.8147e-04     3.8147e-03             2.1303e-03        -0.918538608101  <--
     1.5259e-03     1.5259e-02             2.0966e-03        -0.831148870626
     6.1035e-03     6.1035e-02             1.9716e-03        -0.915976868787

*****************************************************************************
Applying the update for shift_i =   3.8147e-04     and shift_s =   3.8147e-03
*****************************************************************************

  Execution time = 2.2840e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_001                -4.141629e-02 3 1  ON 0
ci_002                -3.316150e-02 3 1  ON 1
ci_003                -2.505571e-02 3 1  ON 2
ci_004                 2.282862e-02 3 1  ON 3
ci_005                 2.454780e-02 3 1  ON 4
ci_006                -2.190669e-02 3 1  ON 5
ci_007                -2.223355e-02 3 1  ON 6
ci_008                -9.333529e-03 3 1  ON 7
ci_009                -1.524764e-02 3 1  ON 8
ci_010                -8.163288e-03 3 1  ON 9
ci_011                -1.051395e-02 3 1  ON 10
ci_012                -1.075745e-02 3 1  ON 11
ci_013                -1.985350e-02 3 1  ON 12
ci_014                 1.330004e-02 3 1  ON 13
ci_015                 1.311409e-02 3 1  ON 14
ci_016                 1.693103e-02 3 1  ON 15
ci_017                 1.700361e-02 3 1  ON 16
ci_018                 1.028159e-02 3 1  ON 17
ci_019                 1.081319e-02 3 1  ON 18
ci_020                 1.866100e-02 3 1  ON 19
ci_021                 1.790174e-02 3 1  ON 20
ci_022                 1.047618e-02 3 1  ON 21
ci_023                 1.024558e-02 3 1  ON 22
ci_024                 8.930465e-03 3 1  ON 23
ci_025                 7.784207e-03 3 1  ON 24
ci_026                 1.141202e-02 3 1  ON 25
ci_027                 1.118482e-02 3 1  ON 26
ci_028                -1.566853e-02 3 1  ON 27
ci_029                -1.562759e-02 3 1  ON 28
ci_030                -8.719497e-03 3 1  ON 29
ci_031                -8.688746e-03 3 1  ON 30
ci_032                -1.490650e-02 3 1  ON 31
ci_033                 4.739586e-03 3 1  ON 32
ci_034                 6.303415e-03 3 1  ON 33
ci_035                -5.917484e-03 3 1  ON 34
ci_036                -1.325209e-02 3 1  ON 35
ci_037                -1.340259e-02 3 1  ON 36
ci_038                 2.371294e-03 3 1  ON 37
ci_039                 2.929282e-03 3 1  ON 38
ci_040                -3.019889e-03 3 1  ON 39
ci_041                 8.886920e-03 3 1  ON 40
ci_042                 9.069326e-03 3 1  ON 41
ci_043                -3.955063e-03 3 1  ON 42
ci_044                -4.483180e-03 3 1  ON 43
ci_045                -3.639242e-03 3 1  ON 44
ci_046                 5.331427e-03 3 1  ON 45
ci_047                 6.468386e-03 3 1  ON 46
ci_048                -1.308115e-02 3 1  ON 47
ci_049                -1.305222e-02 3 1  ON 48
ci_050                 3.482386e-03 3 1  ON 49
ci_051                 2.831342e-03 3 1  ON 50
ci_052                -2.861412e-03 3 1  ON 51
ci_053                -2.681299e-03 3 1  ON 52
ci_054                -3.363814e-03 3 1  ON 53
ci_055                -3.223389e-03 3 1  ON 54
ci_056                 5.348228e-03 3 1  ON 55
ci_057                 6.200156e-03 3 1  ON 56
ci_058                -1.547085e-03 3 1  ON 57
ci_059                -2.717245e-03 3 1  ON 58
ci_060                 6.875079e-03 3 1  ON 59
ci_061                 5.126659e-03 3 1  ON 60
ci_062                -3.852792e-03 3 1  ON 61
ci_063                -4.163307e-03 3 1  ON 62
ci_064                -3.396052e-03 3 1  ON 63
ci_065                -3.902673e-03 3 1  ON 64
ci_066                 4.628475e-03 3 1  ON 65
ci_067                 4.460680e-03 3 1  ON 66
ci_068                -5.701966e-03 3 1  ON 67
ci_069                -6.077418e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9167e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1655
    reference variance = 0.233683
====================================================
  Execution time = 1.3828e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8972e-01
  Total weights = 1.957105878e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4791e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277741884444
                                         uncertainty =       0.001666818117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277741884444
                                         uncertainty =       0.001666818117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372639207
  error estimate for blocks of size 2^( 2) =       0.000386776363
  error estimate for blocks of size 2^( 3) =       0.000398832056
  error estimate for blocks of size 2^( 4) =       0.000407675036
  error estimate for blocks of size 2^( 5) =       0.000413423865
  error estimate for blocks of size 2^( 6) =       0.000416139734
  error estimate for blocks of size 2^( 7) =       0.000417176015

      target function =      -0.913962813111
              le_mean =     -17.212069159679
             les_mean =     296.545042595783
             stat err =       0.000413603662
             autocorr =       1.231945956265
   target nu stat err =       0.000413603662
   target dn stat err =       0.002287396185
      target stat err =       0.003020577327
              std dev =       0.526991421084
             le_variance =       0.277719957896


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721206915968e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-05, overlap shift 9.5367e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913971970389       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914654500033       residual = 3.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914826504458       residual = 6.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914872614721       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914878551946       residual = 4.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914883481894       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914884191798       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914884030060       residual = 4.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914884010736       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914884028114       residual = 4.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914883960052       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914883944242       residual = 2.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-05 is 3.198750e-03

solving harmonic davidson linear method for identity shift 3.8147e-04, overlap shift 3.8147e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913971970389       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914651977296       residual = 3.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914823192270       residual = 6.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914869051883       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914874947366       residual = 4.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914879844778       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914880547142       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914880386341       residual = 4.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914880366736       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914880384231       residual = 4.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914880316885       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914880300900       residual = 2.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-04 is 3.185857e-03

solving harmonic davidson linear method for identity shift 1.5259e-03, overlap shift 1.5259e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913971970389       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914642069965       residual = 3.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914810196534       residual = 6.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914855078810       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914860812319       residual = 4.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914865583374       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914866256835       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914866099671       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914866079052       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914866096885       residual = 4.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914866032367       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914866015730       residual = 2.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-03 is 3.135310e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.258360 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6326e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_001                -4.197689e-02 3 1  ON 0
ci_002                -3.215235e-02 3 1  ON 1
ci_003                -2.635292e-02 3 1  ON 2
ci_004                 2.447175e-02 3 1  ON 3
ci_005                 2.352005e-02 3 1  ON 4
ci_006                -2.207361e-02 3 1  ON 5
ci_007                -2.176436e-02 3 1  ON 6
ci_008                -9.321418e-03 3 1  ON 7
ci_009                -1.408462e-02 3 1  ON 8
ci_010                -1.134914e-02 3 1  ON 9
ci_011                -1.226277e-02 3 1  ON 10
ci_012                -9.293582e-03 3 1  ON 11
ci_013                -2.032195e-02 3 1  ON 12
ci_014                 1.254059e-02 3 1  ON 13
ci_015                 1.403192e-02 3 1  ON 14
ci_016                 1.691058e-02 3 1  ON 15
ci_017                 1.629362e-02 3 1  ON 16
ci_018                 1.094020e-02 3 1  ON 17
ci_019                 1.129428e-02 3 1  ON 18
ci_020                 1.715417e-02 3 1  ON 19
ci_021                 1.812966e-02 3 1  ON 20
ci_022                 9.427573e-03 3 1  ON 21
ci_023                 9.876310e-03 3 1  ON 22
ci_024                 6.515215e-03 3 1  ON 23
ci_025                 8.209138e-03 3 1  ON 24
ci_026                 1.181610e-02 3 1  ON 25
ci_027                 1.169343e-02 3 1  ON 26
ci_028                -1.549443e-02 3 1  ON 27
ci_029                -1.579373e-02 3 1  ON 28
ci_030                -9.414220e-03 3 1  ON 29
ci_031                -9.042457e-03 3 1  ON 30
ci_032                -1.410773e-02 3 1  ON 31
ci_033                 5.098337e-03 3 1  ON 32
ci_034                 5.714587e-03 3 1  ON 33
ci_035                -5.386846e-03 3 1  ON 34
ci_036                -1.281979e-02 3 1  ON 35
ci_037                -1.433865e-02 3 1  ON 36
ci_038                 2.107994e-03 3 1  ON 37
ci_039                 2.874029e-03 3 1  ON 38
ci_040                -3.005341e-03 3 1  ON 39
ci_041                 8.379346e-03 3 1  ON 40
ci_042                 9.653573e-03 3 1  ON 41
ci_043                -4.287805e-03 3 1  ON 42
ci_044                -5.228971e-03 3 1  ON 43
ci_045                -2.988758e-03 3 1  ON 44
ci_046                 6.920446e-03 3 1  ON 45
ci_047                 5.702007e-03 3 1  ON 46
ci_048                -1.379790e-02 3 1  ON 47
ci_049                -1.432464e-02 3 1  ON 48
ci_050                 3.902821e-03 3 1  ON 49
ci_051                 3.689674e-03 3 1  ON 50
ci_052                -3.295911e-03 3 1  ON 51
ci_053                -2.710980e-03 3 1  ON 52
ci_054                -1.921506e-03 3 1  ON 53
ci_055                -3.714646e-03 3 1  ON 54
ci_056                 5.999934e-03 3 1  ON 55
ci_057                 6.850576e-03 3 1  ON 56
ci_058                -2.469474e-03 3 1  ON 57
ci_059                -2.197532e-03 3 1  ON 58
ci_060                 5.327218e-03 3 1  ON 59
ci_061                 5.812067e-03 3 1  ON 60
ci_062                -4.293508e-03 3 1  ON 61
ci_063                -4.329089e-03 3 1  ON 62
ci_064                -3.038643e-03 3 1  ON 63
ci_065                -4.326289e-03 3 1  ON 64
ci_066                 4.747176e-03 3 1  ON 65
ci_067                 4.309080e-03 3 1  ON 66
ci_068                -5.950566e-03 3 1  ON 67
ci_069                -3.897412e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1093
    reference variance = 0.16127
====================================================
  Execution time = 1.3553e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8513e-01
  Total weights = 1.9572e+06
  Execution time = 1.8403e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282614209990
                                         uncertainty =       0.005375438017

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282614209990
                                         uncertainty =       0.005375438017

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375865601
  error estimate for blocks of size 2^( 2) =       0.000389471124
  error estimate for blocks of size 2^( 3) =       0.000402535952
  error estimate for blocks of size 2^( 4) =       0.000411186903
  error estimate for blocks of size 2^( 5) =       0.000416912470
  error estimate for blocks of size 2^( 6) =       0.000420192079
  error estimate for blocks of size 2^( 7) =       0.000422031586

      target function =      -0.842981389852
              le_mean =     -17.212212559112
             les_mean =     296.607319054959
             stat err =       0.000417580759
             autocorr =       1.234285984911
   target nu stat err =       0.000417580759
   target dn stat err =       0.036188008946
      target stat err =       0.040001519010
              std dev =       0.531554230138
             le_variance =       0.282549899578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275284502507
                                         uncertainty =       0.001446507203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275284502507
                                         uncertainty =       0.001446507203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370976678
  error estimate for blocks of size 2^( 2) =       0.000384690206
  error estimate for blocks of size 2^( 3) =       0.000397828133
  error estimate for blocks of size 2^( 4) =       0.000406511602
  error estimate for blocks of size 2^( 5) =       0.000412300617
  error estimate for blocks of size 2^( 6) =       0.000416271364
  error estimate for blocks of size 2^( 7) =       0.000417812792

      target function =      -0.919941183334
              le_mean =     -17.212144911476
             les_mean =     296.543083262113
             stat err =       0.000413224094
             autocorr =       1.240732205466
   target nu stat err =       0.000413224094
   target dn stat err =       0.001819077243
      target stat err =       0.002459390468
              std dev =       0.524640249856
             le_variance =       0.275247391769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281893080756
                                         uncertainty =       0.003981852548

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281893080756
                                         uncertainty =       0.003981852548

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375389081
  error estimate for blocks of size 2^( 2) =       0.000388887726
  error estimate for blocks of size 2^( 3) =       0.000401856112
  error estimate for blocks of size 2^( 4) =       0.000410489309
  error estimate for blocks of size 2^( 5) =       0.000416146258
  error estimate for blocks of size 2^( 6) =       0.000420240200
  error estimate for blocks of size 2^( 7) =       0.000421525526

      target function =      -0.651750289569
              le_mean =     -17.212248718551
             les_mean =     296.799571057422
             stat err =       0.000417100323
             autocorr =       1.234575857160
   target nu stat err =       0.000417100323
   target dn stat err =       0.184026587832
      target stat err =       0.125769714073
              std dev =       0.530880330050
             le_variance =       0.281833924834

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275271559778
                                         uncertainty =       0.001446146675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275271559778
                                         uncertainty =       0.001446146675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370967974
  error estimate for blocks of size 2^( 2) =       0.000384682458
  error estimate for blocks of size 2^( 3) =       0.000397822030
  error estimate for blocks of size 2^( 4) =       0.000406506858
  error estimate for blocks of size 2^( 5) =       0.000412297806
  error estimate for blocks of size 2^( 6) =       0.000416267761
  error estimate for blocks of size 2^( 7) =       0.000417810150

      target function =      -0.919978799838
              le_mean =     -17.212144252493
             les_mean =     296.543031805851
             stat err =       0.000413220644
             autocorr =       1.240769711060
   target nu stat err =       0.000413220644
   target dn stat err =       0.001815268311
      target stat err =       0.002454728228
              std dev =       0.524627940515
             le_variance =       0.275234475969


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.842981389852        initial
     9.5367e-05     9.5367e-04             3.1988e-03        -0.919941183334
     3.8147e-04     3.8147e-03             3.1859e-03        -0.651750289569
     1.5259e-03     1.5259e-02             3.1353e-03        -0.919978799838  <--

*****************************************************************************
Applying the update for shift_i =   1.5259e-03     and shift_s =   1.5259e-02
*****************************************************************************

  Execution time = 2.2872e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_001                -4.196745e-02 3 1  ON 0
ci_002                -3.216994e-02 3 1  ON 1
ci_003                -2.633022e-02 3 1  ON 2
ci_004                 2.444154e-02 3 1  ON 3
ci_005                 2.353767e-02 3 1  ON 4
ci_006                -2.207057e-02 3 1  ON 5
ci_007                -2.177262e-02 3 1  ON 6
ci_008                -9.320963e-03 3 1  ON 7
ci_009                -1.410244e-02 3 1  ON 8
ci_010                -1.129860e-02 3 1  ON 9
ci_011                -1.223510e-02 3 1  ON 10
ci_012                -9.316690e-03 3 1  ON 11
ci_013                -2.031237e-02 3 1  ON 12
ci_014                 1.255254e-02 3 1  ON 13
ci_015                 1.401767e-02 3 1  ON 14
ci_016                 1.691049e-02 3 1  ON 15
ci_017                 1.630668e-02 3 1  ON 16
ci_018                 1.093026e-02 3 1  ON 17
ci_019                 1.128915e-02 3 1  ON 18
ci_020                 1.718040e-02 3 1  ON 19
ci_021                 1.812490e-02 3 1  ON 20
ci_022                 9.444309e-03 3 1  ON 21
ci_023                 9.882673e-03 3 1  ON 22
ci_024                 6.554844e-03 3 1  ON 23
ci_025                 8.201018e-03 3 1  ON 24
ci_026                 1.180755e-02 3 1  ON 25
ci_027                 1.168743e-02 3 1  ON 26
ci_028                -1.549823e-02 3 1  ON 27
ci_029                -1.578993e-02 3 1  ON 28
ci_030                -9.402110e-03 3 1  ON 29
ci_031                -9.036365e-03 3 1  ON 30
ci_032                -1.412138e-02 3 1  ON 31
ci_033                 5.092044e-03 3 1  ON 32
ci_034                 5.724333e-03 3 1  ON 33
ci_035                -5.394860e-03 3 1  ON 34
ci_036                -1.282455e-02 3 1  ON 35
ci_037                -1.432368e-02 3 1  ON 36
ci_038                 2.111832e-03 3 1  ON 37
ci_039                 2.875016e-03 3 1  ON 38
ci_040                -3.005496e-03 3 1  ON 39
ci_041                 8.387143e-03 3 1  ON 40
ci_042                 9.644397e-03 3 1  ON 41
ci_043                -4.282810e-03 3 1  ON 42
ci_044                -5.217324e-03 3 1  ON 43
ci_045                -2.998071e-03 3 1  ON 44
ci_046                 6.894286e-03 3 1  ON 45
ci_047                 5.714509e-03 3 1  ON 46
ci_048                -1.378367e-02 3 1  ON 47
ci_049                -1.430109e-02 3 1  ON 48
ci_050                 3.897158e-03 3 1  ON 49
ci_051                 3.677858e-03 3 1  ON 50
ci_052                -3.289415e-03 3 1  ON 51
ci_053                -2.709302e-03 3 1  ON 52
ci_054                -1.944880e-03 3 1  ON 53
ci_055                -3.706675e-03 3 1  ON 54
ci_056                 5.989863e-03 3 1  ON 55
ci_057                 6.840855e-03 3 1  ON 56
ci_058                -2.456981e-03 3 1  ON 57
ci_059                -2.204499e-03 3 1  ON 58
ci_060                 5.352529e-03 3 1  ON 59
ci_061                 5.800715e-03 3 1  ON 60
ci_062                -4.288883e-03 3 1  ON 61
ci_063                -4.326063e-03 3 1  ON 62
ci_064                -3.043626e-03 3 1  ON 63
ci_065                -4.320081e-03 3 1  ON 64
ci_066                 4.745481e-03 3 1  ON 65
ci_067                 4.310850e-03 3 1  ON 66
ci_068                -5.946408e-03 3 1  ON 67
ci_069                -3.932277e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9212e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2135
    reference variance = 0.205513
====================================================
  Execution time = 1.3879e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5311e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8578e-01
  Total weights = 1.957505459e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4815e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274769325044
                                         uncertainty =       0.001438519096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274769325044
                                         uncertainty =       0.001438519096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370617849
  error estimate for blocks of size 2^( 2) =       0.000384335503
  error estimate for blocks of size 2^( 3) =       0.000396690399
  error estimate for blocks of size 2^( 4) =       0.000406161106
  error estimate for blocks of size 2^( 5) =       0.000411437365
  error estimate for blocks of size 2^( 6) =       0.000414116631
  error estimate for blocks of size 2^( 7) =       0.000414966587

      target function =      -0.919253232209
              le_mean =     -17.212674934999
             les_mean =     296.561959019144
             stat err =       0.000411670422
             autocorr =       1.233805401962
   target nu stat err =       0.000411670422
   target dn stat err =       0.002056984700
      target stat err =       0.002761335226
              std dev =       0.524132788454
             le_variance =       0.274715179932


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721267493500e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-04, overlap shift 3.8147e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919260756417       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920164444979       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920368447726       residual = 8.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920422788061       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920440497254       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920440718606       residual = 9.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920441038668       residual = 1.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920441203125       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920441279678       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920441146114       residual = 6.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920441170969       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920441192538       residual = 3.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-04 is 5.122041e-03

solving harmonic davidson linear method for identity shift 1.5259e-03, overlap shift 1.5259e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919260756417       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920151327978       residual = 2.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920351558936       residual = 8.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920404707302       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920421974734       residual = 5.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920422170984       residual = 9.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920422476574       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920422636251       residual = 5.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920422710716       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920422581151       residual = 5.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920422605062       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920422625832       residual = 3.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-03 is 5.033445e-03

solving harmonic davidson linear method for identity shift 6.1035e-03, overlap shift 6.1035e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919260756417       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920102455261       residual = 2.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920288863269       residual = 8.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920337699722       residual = 1.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920353387366       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920353499786       residual = 9.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920353755907       residual = 1.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920353898751       residual = 4.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920353965834       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920353850388       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920353871055       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920353889061       residual = 3.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-03 is 4.707810e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.268311 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6379e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_001                -4.230062e-02 3 1  ON 0
ci_002                -3.265166e-02 3 1  ON 1
ci_003                -2.617180e-02 3 1  ON 2
ci_004                 2.436720e-02 3 1  ON 3
ci_005                 2.337849e-02 3 1  ON 4
ci_006                -2.104001e-02 3 1  ON 5
ci_007                -2.247511e-02 3 1  ON 6
ci_008                -9.057018e-03 3 1  ON 7
ci_009                -1.486530e-02 3 1  ON 8
ci_010                -9.509758e-03 3 1  ON 9
ci_011                -1.047276e-02 3 1  ON 10
ci_012                -1.149990e-02 3 1  ON 11
ci_013                -1.968263e-02 3 1  ON 12
ci_014                 1.206515e-02 3 1  ON 13
ci_015                 1.290817e-02 3 1  ON 14
ci_016                 1.700449e-02 3 1  ON 15
ci_017                 1.681760e-02 3 1  ON 16
ci_018                 1.053443e-02 3 1  ON 17
ci_019                 1.128896e-02 3 1  ON 18
ci_020                 1.846310e-02 3 1  ON 19
ci_021                 1.746673e-02 3 1  ON 20
ci_022                 1.150712e-02 3 1  ON 21
ci_023                 9.848935e-03 3 1  ON 22
ci_024                 1.158829e-02 3 1  ON 23
ci_025                 9.114888e-03 3 1  ON 24
ci_026                 1.170912e-02 3 1  ON 25
ci_027                 1.212761e-02 3 1  ON 26
ci_028                -1.514841e-02 3 1  ON 27
ci_029                -1.538983e-02 3 1  ON 28
ci_030                -1.006809e-02 3 1  ON 29
ci_031                -9.501225e-03 3 1  ON 30
ci_032                -1.488480e-02 3 1  ON 31
ci_033                 6.589752e-03 3 1  ON 32
ci_034                 5.074788e-03 3 1  ON 33
ci_035                -5.056096e-03 3 1  ON 34
ci_036                -1.292678e-02 3 1  ON 35
ci_037                -1.247377e-02 3 1  ON 36
ci_038                 1.954839e-03 3 1  ON 37
ci_039                 2.033864e-03 3 1  ON 38
ci_040                -3.539090e-03 3 1  ON 39
ci_041                 9.587174e-03 3 1  ON 40
ci_042                 7.939027e-03 3 1  ON 41
ci_043                -4.467552e-03 3 1  ON 42
ci_044                -4.123725e-03 3 1  ON 43
ci_045                -2.916801e-03 3 1  ON 44
ci_046                 5.672253e-03 3 1  ON 45
ci_047                 5.734120e-03 3 1  ON 46
ci_048                -1.330497e-02 3 1  ON 47
ci_049                -1.223340e-02 3 1  ON 48
ci_050                 3.185642e-03 3 1  ON 49
ci_051                 3.632337e-03 3 1  ON 50
ci_052                -3.067887e-03 3 1  ON 51
ci_053                -2.559677e-03 3 1  ON 52
ci_054                -2.880570e-03 3 1  ON 53
ci_055                -2.868193e-03 3 1  ON 54
ci_056                 6.181947e-03 3 1  ON 55
ci_057                 5.761786e-03 3 1  ON 56
ci_058                -2.644430e-03 3 1  ON 57
ci_059                -3.001505e-03 3 1  ON 58
ci_060                 5.238820e-03 3 1  ON 59
ci_061                 6.083514e-03 3 1  ON 60
ci_062                -3.774179e-03 3 1  ON 61
ci_063                -3.819900e-03 3 1  ON 62
ci_064                -3.379420e-03 3 1  ON 63
ci_065                -3.950899e-03 3 1  ON 64
ci_066                 5.182793e-03 3 1  ON 65
ci_067                 4.358078e-03 3 1  ON 66
ci_068                -5.381455e-03 3 1  ON 67
ci_069                -5.658192e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2735
    reference variance = 0.288187
====================================================
  Execution time = 1.5693e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8813e-01
  Total weights = 1.9566e+06
  Execution time = 1.8401e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00252677
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294403852024
                                         uncertainty =       0.015851278440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294403852024
                                         uncertainty =       0.015851278440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383654613
  error estimate for blocks of size 2^( 2) =       0.000397042685
  error estimate for blocks of size 2^( 3) =       0.000409013697
  error estimate for blocks of size 2^( 4) =       0.000417277389
  error estimate for blocks of size 2^( 5) =       0.000422161797
  error estimate for blocks of size 2^( 6) =       0.000424641183
  error estimate for blocks of size 2^( 7) =       0.000426388478

      target function =      -0.471638309766
              le_mean =     -17.212536652408
             les_mean =     297.081758332039
             stat err =       0.000422617211
             autocorr =       1.213426603480
   target nu stat err =       0.000422617211
   target dn stat err =       0.415498177108
      target stat err =       0.159899531038
              std dev =       0.542569556363
             le_variance =       0.294381723492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277462807904
                                         uncertainty =       0.001602125560

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277462807904
                                         uncertainty =       0.001602125560

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372458111
  error estimate for blocks of size 2^( 2) =       0.000386223497
  error estimate for blocks of size 2^( 3) =       0.000398498846
  error estimate for blocks of size 2^( 4) =       0.000406942669
  error estimate for blocks of size 2^( 5) =       0.000412147758
  error estimate for blocks of size 2^( 6) =       0.000414828219
  error estimate for blocks of size 2^( 7) =       0.000416834260

      target function =      -0.916121918476
              le_mean =     -17.212530555550
             les_mean =     296.559354994752
             stat err =       0.000412688226
             autocorr =       1.227691601246
   target nu stat err =       0.000412688226
   target dn stat err =       0.002180539531
      target stat err =       0.002900083759
              std dev =       0.526735312273
             le_variance =       0.277450089195

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00250109
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281136412733
                                         uncertainty =       0.002021055271

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281136412733
                                         uncertainty =       0.002021055271

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374914055
  error estimate for blocks of size 2^( 2) =       0.000388640984
  error estimate for blocks of size 2^( 3) =       0.000400914239
  error estimate for blocks of size 2^( 4) =       0.000409323265
  error estimate for blocks of size 2^( 5) =       0.000414600289
  error estimate for blocks of size 2^( 6) =       0.000417158882
  error estimate for blocks of size 2^( 7) =       0.000419358642

      target function =      -0.833361274864
              le_mean =     -17.212769578075
             les_mean =     296.635111956889
             stat err =       0.000415110270
             autocorr =       1.225923900314
   target nu stat err =       0.000415110270
   target dn stat err =       0.042565401605
      target stat err =       0.046036026065
              std dev =       0.530208541098
             le_variance =       0.281121097053

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277404233242
                                         uncertainty =       0.001599609629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277404233242
                                         uncertainty =       0.001599609629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372418736
  error estimate for blocks of size 2^( 2) =       0.000386183790
  error estimate for blocks of size 2^( 3) =       0.000398458141
  error estimate for blocks of size 2^( 4) =       0.000406904494
  error estimate for blocks of size 2^( 5) =       0.000412108476
  error estimate for blocks of size 2^( 6) =       0.000414787329
  error estimate for blocks of size 2^( 7) =       0.000416788405

      target function =      -0.916205350892
              le_mean =     -17.212528264312
             les_mean =     296.559211635848
             stat err =       0.000412647176
             autocorr =       1.227706943000
   target nu stat err =       0.000412647176
   target dn stat err =       0.002177378483
      target stat err =       0.002896546305
              std dev =       0.526679626869
             le_variance =       0.277391429359


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.471638309766        initial
     3.8147e-04     3.8147e-03             5.1220e-03        -0.916121918476
     1.5259e-03     1.5259e-02             5.0334e-03        -0.833361274864
     6.1035e-03     6.1035e-02             4.7078e-03        -0.916205350892  <--

*****************************************************************************
Applying the update for shift_i =   6.1035e-03     and shift_s =   6.1035e-02
*****************************************************************************

  Execution time = 2.4990e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_001                -4.227232e-02 3 1  ON 0
ci_002                -3.262062e-02 3 1  ON 1
ci_003                -2.618974e-02 3 1  ON 2
ci_004                 2.437096e-02 3 1  ON 3
ci_005                 2.338904e-02 3 1  ON 4
ci_006                -2.110940e-02 3 1  ON 5
ci_007                -2.242924e-02 3 1  ON 6
ci_008                -9.073232e-03 3 1  ON 7
ci_009                -1.482161e-02 3 1  ON 8
ci_010                -9.617370e-03 3 1  ON 9
ci_011                -1.057497e-02 3 1  ON 10
ci_012                -1.137153e-02 3 1  ON 11
ci_013                -1.973077e-02 3 1  ON 12
ci_014                 1.210175e-02 3 1  ON 13
ci_015                 1.297899e-02 3 1  ON 14
ci_016                 1.699639e-02 3 1  ON 15
ci_017                 1.678314e-02 3 1  ON 16
ci_018                 1.055918e-02 3 1  ON 17
ci_019                 1.128257e-02 3 1  ON 18
ci_020                 1.837771e-02 3 1  ON 19
ci_021                 1.750962e-02 3 1  ON 20
ci_022                 1.137826e-02 3 1  ON 21
ci_023                 9.850016e-03 3 1  ON 22
ci_024                 1.126265e-02 3 1  ON 23
ci_025                 9.055777e-03 3 1  ON 24
ci_026                 1.171550e-02 3 1  ON 25
ci_027                 1.210450e-02 3 1  ON 26
ci_028                -1.516448e-02 3 1  ON 27
ci_029                -1.542681e-02 3 1  ON 28
ci_030                -1.003570e-02 3 1  ON 29
ci_031                -9.482717e-03 3 1  ON 30
ci_032                -1.483770e-02 3 1  ON 31
ci_033                 6.495284e-03 3 1  ON 32
ci_034                 5.111268e-03 3 1  ON 33
ci_035                -5.074824e-03 3 1  ON 34
ci_036                -1.292405e-02 3 1  ON 35
ci_037                -1.257496e-02 3 1  ON 36
ci_038                 1.963643e-03 3 1  ON 37
ci_039                 2.079955e-03 3 1  ON 38
ci_040                -3.510500e-03 3 1  ON 39
ci_041                 9.522322e-03 3 1  ON 40
ci_042                 8.035476e-03 3 1  ON 41
ci_043                -4.456672e-03 3 1  ON 42
ci_044                -4.186873e-03 3 1  ON 43
ci_045                -2.920932e-03 3 1  ON 44
ci_046                 5.747501e-03 3 1  ON 45
ci_047                 5.732918e-03 3 1  ON 46
ci_048                -1.333075e-02 3 1  ON 47
ci_049                -1.236996e-02 3 1  ON 48
ci_050                 3.222344e-03 3 1  ON 49
ci_051                 3.634593e-03 3 1  ON 50
ci_052                -3.079790e-03 3 1  ON 51
ci_053                -2.573878e-03 3 1  ON 52
ci_054                -2.821255e-03 3 1  ON 53
ci_055                -2.916381e-03 3 1  ON 54
ci_056                 6.171450e-03 3 1  ON 55
ci_057                 5.823291e-03 3 1  ON 56
ci_058                -2.628526e-03 3 1  ON 57
ci_059                -2.954479e-03 3 1  ON 58
ci_060                 5.245880e-03 3 1  ON 59
ci_061                 6.066610e-03 3 1  ON 60
ci_062                -3.790162e-03 3 1  ON 61
ci_063                -3.846806e-03 3 1  ON 62
ci_064                -3.361478e-03 3 1  ON 63
ci_065                -3.971268e-03 3 1  ON 64
ci_066                 5.160467e-03 3 1  ON 65
ci_067                 4.353680e-03 3 1  ON 66
ci_068                -5.416814e-03 3 1  ON 67
ci_069                -5.554846e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1384e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1882
    reference variance = 0.428332
====================================================
  Execution time = 1.3901e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8989e-01
  Total weights = 1.956991617e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5164e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278827590108
                                         uncertainty =       0.001703829287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278827590108
                                         uncertainty =       0.001703829287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373365382
  error estimate for blocks of size 2^( 2) =       0.000386978269
  error estimate for blocks of size 2^( 3) =       0.000399597349
  error estimate for blocks of size 2^( 4) =       0.000408351662
  error estimate for blocks of size 2^( 5) =       0.000413600227
  error estimate for blocks of size 2^( 6) =       0.000416528980
  error estimate for blocks of size 2^( 7) =       0.000417311576

      target function =      -0.913689475701
              le_mean =     -17.211855759557
             les_mean =     296.537866025834
             stat err =       0.000413948111
             autocorr =       1.229203287580
   target nu stat err =       0.000413948111
   target dn stat err =       0.002263928052
      target stat err =       0.002988112058
              std dev =       0.528018387581
             le_variance =       0.278803417624


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721185575956e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-03, overlap shift 1.5259e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913698449694       residual = 9.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914163325945       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914254176771       residual = 3.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914272929126       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914279349619       residual = 2.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914282205987       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914283495799       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914283593151       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914283837869       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914283821229       residual = 3.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914283952186       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914283958526       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-03 is 2.583882e-03

solving harmonic davidson linear method for identity shift 6.1035e-03, overlap shift 6.1035e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913698449694       residual = 9.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914137816010       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914222273950       residual = 3.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914239424460       residual = 7.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914245231583       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914247816860       residual = 6.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914248946758       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914249023882       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914249237104       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914249223546       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914249338144       residual = 9.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-03 is 2.420192e-03

solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913698449694       residual = 9.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914058725955       residual = 9.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914124502229       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914137209032       residual = 6.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914141366899       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914143227464       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914143953489       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914143990896       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914144125471       residual = 6.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914144120666       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914144193937       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-02 is 1.935430e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.277594 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6436e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_001                -4.264542e-02 3 1  ON 0
ci_002                -3.275715e-02 3 1  ON 1
ci_003                -2.599358e-02 3 1  ON 2
ci_004                 2.550728e-02 3 1  ON 3
ci_005                 2.406900e-02 3 1  ON 4
ci_006                -2.224852e-02 3 1  ON 5
ci_007                -2.195473e-02 3 1  ON 6
ci_008                -8.801756e-03 3 1  ON 7
ci_009                -1.547240e-02 3 1  ON 8
ci_010                -1.006875e-02 3 1  ON 9
ci_011                -1.092772e-02 3 1  ON 10
ci_012                -1.010958e-02 3 1  ON 11
ci_013                -1.988606e-02 3 1  ON 12
ci_014                 1.301760e-02 3 1  ON 13
ci_015                 1.323471e-02 3 1  ON 14
ci_016                 1.637055e-02 3 1  ON 15
ci_017                 1.671342e-02 3 1  ON 16
ci_018                 1.150901e-02 3 1  ON 17
ci_019                 1.108212e-02 3 1  ON 18
ci_020                 1.867210e-02 3 1  ON 19
ci_021                 1.762613e-02 3 1  ON 20
ci_022                 8.958066e-03 3 1  ON 21
ci_023                 1.024398e-02 3 1  ON 22
ci_024                 9.816055e-03 3 1  ON 23
ci_025                 9.695779e-03 3 1  ON 24
ci_026                 1.078820e-02 3 1  ON 25
ci_027                 1.152743e-02 3 1  ON 26
ci_028                -1.508561e-02 3 1  ON 27
ci_029                -1.587800e-02 3 1  ON 28
ci_030                -9.183340e-03 3 1  ON 29
ci_031                -8.922094e-03 3 1  ON 30
ci_032                -1.386721e-02 3 1  ON 31
ci_033                 5.205207e-03 3 1  ON 32
ci_034                 4.959170e-03 3 1  ON 33
ci_035                -5.404363e-03 3 1  ON 34
ci_036                -1.318333e-02 3 1  ON 35
ci_037                -1.154780e-02 3 1  ON 36
ci_038                 1.937413e-03 3 1  ON 37
ci_039                 2.031377e-03 3 1  ON 38
ci_040                -3.336953e-03 3 1  ON 39
ci_041                 8.614259e-03 3 1  ON 40
ci_042                 9.227947e-03 3 1  ON 41
ci_043                -4.133263e-03 3 1  ON 42
ci_044                -4.968710e-03 3 1  ON 43
ci_045                -3.477352e-03 3 1  ON 44
ci_046                 5.929908e-03 3 1  ON 45
ci_047                 5.704440e-03 3 1  ON 46
ci_048                -1.229006e-02 3 1  ON 47
ci_049                -1.269923e-02 3 1  ON 48
ci_050                 3.225003e-03 3 1  ON 49
ci_051                 3.706422e-03 3 1  ON 50
ci_052                -3.090639e-03 3 1  ON 51
ci_053                -2.476834e-03 3 1  ON 52
ci_054                -2.807644e-03 3 1  ON 53
ci_055                -2.770013e-03 3 1  ON 54
ci_056                 5.345496e-03 3 1  ON 55
ci_057                 6.057839e-03 3 1  ON 56
ci_058                -2.011651e-03 3 1  ON 57
ci_059                -2.401728e-03 3 1  ON 58
ci_060                 4.772045e-03 3 1  ON 59
ci_061                 5.158519e-03 3 1  ON 60
ci_062                -3.898941e-03 3 1  ON 61
ci_063                -3.888052e-03 3 1  ON 62
ci_064                -3.298993e-03 3 1  ON 63
ci_065                -4.145335e-03 3 1  ON 64
ci_066                 4.564936e-03 3 1  ON 65
ci_067                 4.838664e-03 3 1  ON 66
ci_068                -5.420048e-03 3 1  ON 67
ci_069                -6.025756e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1749
    reference variance = 0.745969
====================================================
  Execution time = 1.3568e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9043e-01
  Total weights = 1.9569e+06
  Execution time = 1.8420e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00105287
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295642273739
                                         uncertainty =       0.017969666437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295642273739
                                         uncertainty =       0.017969666437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384460173
  error estimate for blocks of size 2^( 2) =       0.000397414743
  error estimate for blocks of size 2^( 3) =       0.000409464713
  error estimate for blocks of size 2^( 4) =       0.000417483112
  error estimate for blocks of size 2^( 5) =       0.000422758888
  error estimate for blocks of size 2^( 6) =       0.000424906802
  error estimate for blocks of size 2^( 7) =       0.000426511593

      target function =      -0.248333626097
              le_mean =     -17.212124715027
             les_mean =     297.717986884760
             stat err =       0.000422915099
             autocorr =       1.210050979051
   target nu stat err =       0.000422915099
   target dn stat err =       1.162700919649
      target stat err =       0.153871053709
              std dev =       0.543708790679
             le_variance =       0.295619249061

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276874064574
                                         uncertainty =       0.001597318210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276874064574
                                         uncertainty =       0.001597318210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372093544
  error estimate for blocks of size 2^( 2) =       0.000385576546
  error estimate for blocks of size 2^( 3) =       0.000397971888
  error estimate for blocks of size 2^( 4) =       0.000406380368
  error estimate for blocks of size 2^( 5) =       0.000412358174
  error estimate for blocks of size 2^( 6) =       0.000414684446
  error estimate for blocks of size 2^( 7) =       0.000415769132

      target function =      -0.912617940399
              le_mean =     -17.211921891729
             les_mean =     296.540977706491
             stat err =       0.000412298030
             autocorr =       1.227773486089
   target nu stat err =       0.000412298030
   target dn stat err =       0.003131909578
      target stat err =       0.004086187861
              std dev =       0.526219735927
             le_variance =       0.276907210479

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00104529
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277597658994
                                         uncertainty =       0.001572871558

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277597658994
                                         uncertainty =       0.001572871558

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372586519
  error estimate for blocks of size 2^( 2) =       0.000386107507
  error estimate for blocks of size 2^( 3) =       0.000398534181
  error estimate for blocks of size 2^( 4) =       0.000406963669
  error estimate for blocks of size 2^( 5) =       0.000412873061
  error estimate for blocks of size 2^( 6) =       0.000415216641
  error estimate for blocks of size 2^( 7) =       0.000416214223

      target function =      -0.897036545478
              le_mean =     -17.211962101211
             les_mean =     296.554615274734
             stat err =       0.000412816899
             autocorr =       1.227610686707
   target nu stat err =       0.000412816899
   target dn stat err =       0.005514424567
      target stat err =       0.006904488448
              std dev =       0.526916907649
             le_variance =       0.277641427567

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277088663041
                                         uncertainty =       0.001624284921

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277088663041
                                         uncertainty =       0.001624284921

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372237545
  error estimate for blocks of size 2^( 2) =       0.000385705276
  error estimate for blocks of size 2^( 3) =       0.000398086136
  error estimate for blocks of size 2^( 4) =       0.000406478640
  error estimate for blocks of size 2^( 5) =       0.000412467081
  error estimate for blocks of size 2^( 6) =       0.000414788514
  error estimate for blocks of size 2^( 7) =       0.000415920315

      target function =      -0.617519201163
              le_mean =     -17.211921719390
             les_mean =     296.806210746215
             stat err =       0.000412413638
             autocorr =       1.227511830245
   target nu stat err =       0.000412413638
   target dn stat err =       0.265600884481
      target stat err =       0.168744643075
              std dev =       0.526423384126
             le_variance =       0.277121579355


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.248333626097        initial
     1.5259e-03     1.5259e-02             2.5839e-03        -0.912617940399  <--
     6.1035e-03     6.1035e-02             2.4202e-03        -0.897036545478
     2.4414e-02     2.4414e-01             1.9354e-03        -0.617519201163

*****************************************************************************
Applying the update for shift_i =   1.5259e-03     and shift_s =   1.5259e-02
*****************************************************************************

  Execution time = 2.2898e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_001                -4.267515e-02 3 1  ON 0
ci_002                -3.276600e-02 3 1  ON 1
ci_003                -2.597475e-02 3 1  ON 2
ci_004                 2.558595e-02 3 1  ON 3
ci_005                 2.411976e-02 3 1  ON 4
ci_006                -2.233133e-02 3 1  ON 5
ci_007                -2.192129e-02 3 1  ON 6
ci_008                -8.785647e-03 3 1  ON 7
ci_009                -1.551324e-02 3 1  ON 8
ci_010                -1.009689e-02 3 1  ON 9
ci_011                -1.094890e-02 3 1  ON 10
ci_012                -1.003201e-02 3 1  ON 11
ci_013                -1.989948e-02 3 1  ON 12
ci_014                 1.308572e-02 3 1  ON 13
ci_015                 1.325627e-02 3 1  ON 14
ci_016                 1.632107e-02 3 1  ON 15
ci_017                 1.670812e-02 3 1  ON 16
ci_018                 1.156565e-02 3 1  ON 17
ci_019                 1.107184e-02 3 1  ON 18
ci_020                 1.869411e-02 3 1  ON 19
ci_021                 1.763893e-02 3 1  ON 20
ci_022                 8.794376e-03 3 1  ON 21
ci_023                 1.027069e-02 3 1  ON 22
ci_024                 9.715007e-03 3 1  ON 23
ci_025                 9.736921e-03 3 1  ON 24
ci_026                 1.074282e-02 3 1  ON 25
ci_027                 1.150021e-02 3 1  ON 26
ci_028                -1.507472e-02 3 1  ON 27
ci_029                -1.591766e-02 3 1  ON 28
ci_030                -9.123819e-03 3 1  ON 29
ci_031                -8.888054e-03 3 1  ON 30
ci_032                -1.380139e-02 3 1  ON 31
ci_033                 5.118726e-03 3 1  ON 32
ci_034                 4.947153e-03 3 1  ON 33
ci_035                -5.423866e-03 3 1  ON 34
ci_036                -1.319401e-02 3 1  ON 35
ci_037                -1.148636e-02 3 1  ON 36
ci_038                 1.935758e-03 3 1  ON 37
ci_039                 2.028767e-03 3 1  ON 38
ci_040                -3.326973e-03 3 1  ON 39
ci_041                 8.559736e-03 3 1  ON 40
ci_042                 9.300792e-03 3 1  ON 41
ci_043                -4.113682e-03 3 1  ON 42
ci_044                -5.018982e-03 3 1  ON 43
ci_045                -3.509152e-03 3 1  ON 44
ci_046                 5.941598e-03 3 1  ON 45
ci_047                 5.702572e-03 3 1  ON 46
ci_048                -1.220340e-02 3 1  ON 47
ci_049                -1.271468e-02 3 1  ON 48
ci_050                 3.224950e-03 3 1  ON 49
ci_051                 3.709122e-03 3 1  ON 50
ci_052                -3.089473e-03 3 1  ON 51
ci_053                -2.480544e-03 3 1  ON 52
ci_054                -2.805322e-03 3 1  ON 53
ci_055                -2.761519e-03 3 1  ON 54
ci_056                 5.293733e-03 3 1  ON 55
ci_057                 6.072458e-03 3 1  ON 56
ci_058                -1.973740e-03 3 1  ON 57
ci_059                -2.363998e-03 3 1  ON 58
ci_060                 4.742690e-03 3 1  ON 59
ci_061                 5.101515e-03 3 1  ON 60
ci_062                -3.901143e-03 3 1  ON 61
ci_063                -3.892331e-03 3 1  ON 62
ci_064                -3.296926e-03 3 1  ON 63
ci_065                -4.155223e-03 3 1  ON 64
ci_066                 4.531099e-03 3 1  ON 65
ci_067                 4.870199e-03 3 1  ON 66
ci_068                -5.420958e-03 3 1  ON 67
ci_069                -6.056464e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9348e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.1648
    reference variance = 0.179854
====================================================
  Execution time = 1.4262e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9151e-01
  Total weights = 1.957285349e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4934e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279826231749
                                         uncertainty =       0.001673446616

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279826231749
                                         uncertainty =       0.001673446616

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374012082
  error estimate for blocks of size 2^( 2) =       0.000387543996
  error estimate for blocks of size 2^( 3) =       0.000399624690
  error estimate for blocks of size 2^( 4) =       0.000408629397
  error estimate for blocks of size 2^( 5) =       0.000414273433
  error estimate for blocks of size 2^( 6) =       0.000415233827
  error estimate for blocks of size 2^( 7) =       0.000417547828

      target function =      -0.911559400681
              le_mean =     -17.211718234986
             les_mean =     296.534754436927
             stat err =       0.000413921121
             autocorr =       1.224796433660
   target nu stat err =       0.000413921121
   target dn stat err =       0.002356839053
      target stat err =       0.003091239601
              std dev =       0.528932958445
             le_variance =       0.279770074530


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721171823499e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-04, overlap shift 3.8147e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911569140874       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912106621380       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912198534121       residual = 5.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912249325433       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912256037610       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912257846450       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912258787548       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912258965362       residual = 5.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912258749374       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912258726111       residual = 4.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912258659658       residual = 9.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-04 is 2.346108e-03

solving harmonic davidson linear method for identity shift 1.5259e-03, overlap shift 1.5259e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911569140874       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912098945480       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912189235993       residual = 5.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912238883932       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912245399175       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912247145822       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912248053430       residual = 1.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912248225651       residual = 5.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912248014464       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912247991833       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912247928163       residual = 9.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-03 is 2.304190e-03

solving harmonic davidson linear method for identity shift 6.1035e-03, overlap shift 6.1035e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911569140874       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912070314615       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912154640057       residual = 5.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912200160637       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912205979353       residual = 3.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912207509989       residual = 9.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912208301413       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912208454375       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912208260626       residual = 1.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912208240310       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912208186162       residual = 7.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-03 is 2.150745e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.286570 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6772e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_001                -4.181337e-02 3 1  ON 0
ci_002                -3.414634e-02 3 1  ON 1
ci_003                -2.674066e-02 3 1  ON 2
ci_004                 2.328176e-02 3 1  ON 3
ci_005                 2.537678e-02 3 1  ON 4
ci_006                -2.134580e-02 3 1  ON 5
ci_007                -2.039933e-02 3 1  ON 6
ci_008                -8.696706e-03 3 1  ON 7
ci_009                -1.509831e-02 3 1  ON 8
ci_010                -8.977390e-03 3 1  ON 9
ci_011                -1.010793e-02 3 1  ON 10
ci_012                -1.040169e-02 3 1  ON 11
ci_013                -1.928905e-02 3 1  ON 12
ci_014                 1.308471e-02 3 1  ON 13
ci_015                 1.208141e-02 3 1  ON 14
ci_016                 1.790946e-02 3 1  ON 15
ci_017                 1.720522e-02 3 1  ON 16
ci_018                 1.037890e-02 3 1  ON 17
ci_019                 1.140050e-02 3 1  ON 18
ci_020                 1.885500e-02 3 1  ON 19
ci_021                 1.782522e-02 3 1  ON 20
ci_022                 9.552640e-03 3 1  ON 21
ci_023                 9.253420e-03 3 1  ON 22
ci_024                 9.664806e-03 3 1  ON 23
ci_025                 1.015944e-02 3 1  ON 24
ci_026                 1.189043e-02 3 1  ON 25
ci_027                 1.091274e-02 3 1  ON 26
ci_028                -1.546542e-02 3 1  ON 27
ci_029                -1.643320e-02 3 1  ON 28
ci_030                -9.281265e-03 3 1  ON 29
ci_031                -9.231174e-03 3 1  ON 30
ci_032                -1.503629e-02 3 1  ON 31
ci_033                 4.821282e-03 3 1  ON 32
ci_034                 5.125343e-03 3 1  ON 33
ci_035                -5.359408e-03 3 1  ON 34
ci_036                -1.325754e-02 3 1  ON 35
ci_037                -1.325734e-02 3 1  ON 36
ci_038                 1.970039e-03 3 1  ON 37
ci_039                 2.161021e-03 3 1  ON 38
ci_040                -3.216938e-03 3 1  ON 39
ci_041                 9.314190e-03 3 1  ON 40
ci_042                 8.879811e-03 3 1  ON 41
ci_043                -4.543799e-03 3 1  ON 42
ci_044                -4.344131e-03 3 1  ON 43
ci_045                -2.739040e-03 3 1  ON 44
ci_046                 5.600163e-03 3 1  ON 45
ci_047                 6.273309e-03 3 1  ON 46
ci_048                -1.342745e-02 3 1  ON 47
ci_049                -1.324129e-02 3 1  ON 48
ci_050                 3.082695e-03 3 1  ON 49
ci_051                 2.814934e-03 3 1  ON 50
ci_052                -2.598243e-03 3 1  ON 51
ci_053                -2.547879e-03 3 1  ON 52
ci_054                -2.595349e-03 3 1  ON 53
ci_055                -3.728721e-03 3 1  ON 54
ci_056                 5.800930e-03 3 1  ON 55
ci_057                 6.165111e-03 3 1  ON 56
ci_058                -1.770900e-03 3 1  ON 57
ci_059                -2.225539e-03 3 1  ON 58
ci_060                 6.000987e-03 3 1  ON 59
ci_061                 5.183960e-03 3 1  ON 60
ci_062                -4.017636e-03 3 1  ON 61
ci_063                -3.966826e-03 3 1  ON 62
ci_064                -3.225317e-03 3 1  ON 63
ci_065                -4.017662e-03 3 1  ON 64
ci_066                 4.964301e-03 3 1  ON 65
ci_067                 4.657410e-03 3 1  ON 66
ci_068                -5.711007e-03 3 1  ON 67
ci_069                -5.511539e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2168
    reference variance = 0.439614
====================================================
  Execution time = 1.3497e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8712e-01
  Total weights = 1.9574e+06
  Execution time = 1.8426e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000341997
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282710453017
                                         uncertainty =       0.006242942951

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282710453017
                                         uncertainty =       0.006242942951

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375931259
  error estimate for blocks of size 2^( 2) =       0.000389144050
  error estimate for blocks of size 2^( 3) =       0.000401232571
  error estimate for blocks of size 2^( 4) =       0.000409653271
  error estimate for blocks of size 2^( 5) =       0.000415339635
  error estimate for blocks of size 2^( 6) =       0.000419560981
  error estimate for blocks of size 2^( 7) =       0.000420741264

      target function =      -0.129641178756
              le_mean =     -17.212430104596
             les_mean =     298.970804651170
             stat err =       0.000416323788
             autocorr =       1.226437932823
   target nu stat err =       0.000416323788
   target dn stat err =       2.404665733920
      target stat err =       0.099969033276
              std dev =       0.531647084908
             le_variance =       0.282648622892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275856907288
                                         uncertainty =       0.001651656215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275856907288
                                         uncertainty =       0.001651656215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371355555
  error estimate for blocks of size 2^( 2) =       0.000384825702
  error estimate for blocks of size 2^( 3) =       0.000397171924
  error estimate for blocks of size 2^( 4) =       0.000405861784
  error estimate for blocks of size 2^( 5) =       0.000411464862
  error estimate for blocks of size 2^( 6) =       0.000415609679
  error estimate for blocks of size 2^( 7) =       0.000416629304

      target function =      -0.917104691609
              le_mean =     -17.212264966088
             les_mean =     296.549406616946
             stat err =       0.000412391407
             autocorr =       1.233216610626
   target nu stat err =       0.000412391407
   target dn stat err =       0.002008903753
      target stat err =       0.002685951344
              std dev =       0.525176062257
             le_variance =       0.275809896368

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0003432
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277658326025
                                         uncertainty =       0.001815947119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277658326025
                                         uncertainty =       0.001815947119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372565278
  error estimate for blocks of size 2^( 2) =       0.000386099446
  error estimate for blocks of size 2^( 3) =       0.000398487504
  error estimate for blocks of size 2^( 4) =       0.000407195190
  error estimate for blocks of size 2^( 5) =       0.000412787177
  error estimate for blocks of size 2^( 6) =       0.000416927759
  error estimate for blocks of size 2^( 7) =       0.000418063272

      target function =      -0.696473929970
              le_mean =     -17.212381916134
             les_mean =     296.746379703730
             stat err =       0.000413743349
             autocorr =       1.233267531050
   target nu stat err =       0.000413743349
   target dn stat err =       0.163187697471
      target stat err =       0.126891488842
              std dev =       0.526886868596
             le_variance =       0.277609772299

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275850586981
                                         uncertainty =       0.001653521200

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275850586981
                                         uncertainty =       0.001653521200

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371351222
  error estimate for blocks of size 2^( 2) =       0.000384815991
  error estimate for blocks of size 2^( 3) =       0.000397156821
  error estimate for blocks of size 2^( 4) =       0.000405842241
  error estimate for blocks of size 2^( 5) =       0.000411445493
  error estimate for blocks of size 2^( 6) =       0.000415592929
  error estimate for blocks of size 2^( 7) =       0.000416608110

      target function =      -0.917195070010
              le_mean =     -17.212265792009
             les_mean =     296.549365984652
             stat err =       0.000412372193
             autocorr =       1.233130475823
   target nu stat err =       0.000412372193
   target dn stat err =       0.002003043957
      target stat err =       0.002679003587
              std dev =       0.525169934133
             le_variance =       0.275803459718


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.129641178756        initial
     3.8147e-04     3.8147e-03             2.3461e-03        -0.917104691609
     1.5259e-03     1.5259e-02             2.3042e-03        -0.696473929970
     6.1035e-03     6.1035e-02             2.1507e-03        -0.917195070010  <--

*****************************************************************************
Applying the update for shift_i =   6.1035e-03     and shift_s =   6.1035e-02
*****************************************************************************

  Execution time = 2.2983e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_001                -4.187728e-02 3 1  ON 0
ci_002                -3.405392e-02 3 1  ON 1
ci_003                -2.668135e-02 3 1  ON 2
ci_004                 2.343521e-02 3 1  ON 3
ci_005                 2.529897e-02 3 1  ON 4
ci_006                -2.141876e-02 3 1  ON 5
ci_007                -2.050801e-02 3 1  ON 6
ci_008                -8.696741e-03 3 1  ON 7
ci_009                -1.512288e-02 3 1  ON 8
ci_010                -9.044561e-03 3 1  ON 9
ci_011                -1.015708e-02 3 1  ON 10
ci_012                -1.037904e-02 3 1  ON 11
ci_013                -1.933649e-02 3 1  ON 12
ci_014                 1.308426e-02 3 1  ON 13
ci_015                 1.215612e-02 3 1  ON 14
ci_016                 1.779642e-02 3 1  ON 15
ci_017                 1.716674e-02 3 1  ON 16
ci_018                 1.044604e-02 3 1  ON 17
ci_019                 1.138281e-02 3 1  ON 18
ci_020                 1.884682e-02 3 1  ON 19
ci_021                 1.782244e-02 3 1  ON 20
ci_022                 9.505828e-03 3 1  ON 21
ci_023                 9.316617e-03 3 1  ON 22
ci_024                 9.667678e-03 3 1  ON 23
ci_025                 1.012860e-02 3 1  ON 24
ci_026                 1.184010e-02 3 1  ON 25
ci_027                 1.094055e-02 3 1  ON 26
ci_028                -1.543757e-02 3 1  ON 27
ci_029                -1.640030e-02 3 1  ON 28
ci_030                -9.261833e-03 3 1  ON 29
ci_031                -9.208827e-03 3 1  ON 30
ci_032                -1.495745e-02 3 1  ON 31
ci_033                 4.840724e-03 3 1  ON 32
ci_034                 5.113906e-03 3 1  ON 33
ci_035                -5.363049e-03 3 1  ON 34
ci_036                -1.324641e-02 3 1  ON 35
ci_037                -1.315504e-02 3 1  ON 36
ci_038                 1.968023e-03 3 1  ON 37
ci_039                 2.153604e-03 3 1  ON 38
ci_040                -3.222816e-03 3 1  ON 39
ci_041                 9.271674e-03 3 1  ON 40
ci_042                 8.900867e-03 3 1  ON 41
ci_043                -4.519003e-03 3 1  ON 42
ci_044                -4.383989e-03 3 1  ON 43
ci_045                -2.781072e-03 3 1  ON 44
ci_046                 5.621337e-03 3 1  ON 45
ci_047                 6.237699e-03 3 1  ON 46
ci_048                -1.334365e-02 3 1  ON 47
ci_049                -1.320110e-02 3 1  ON 48
ci_050                 3.089701e-03 3 1  ON 49
ci_051                 2.861738e-03 3 1  ON 50
ci_052                -2.621800e-03 3 1  ON 51
ci_053                -2.546952e-03 3 1  ON 52
ci_054                -2.608065e-03 3 1  ON 53
ci_055                -3.672385e-03 3 1  ON 54
ci_056                 5.771989e-03 3 1  ON 55
ci_057                 6.159738e-03 3 1  ON 56
ci_058                -1.777777e-03 3 1  ON 57
ci_059                -2.233641e-03 3 1  ON 58
ci_060                 5.922175e-03 3 1  ON 59
ci_061                 5.178391e-03 3 1  ON 60
ci_062                -4.011155e-03 3 1  ON 61
ci_063                -3.960922e-03 3 1  ON 62
ci_064                -3.228866e-03 3 1  ON 63
ci_065                -4.025388e-03 3 1  ON 64
ci_066                 4.938806e-03 3 1  ON 65
ci_067                 4.670282e-03 3 1  ON 66
ci_068                -5.692637e-03 3 1  ON 67
ci_069                -5.543969e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9772e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.1958
    reference variance = 0.241452
====================================================
  Execution time = 1.3908e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5265e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8862e-01
  Total weights = 1.956845277e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5094e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276635103196
                                         uncertainty =       0.001656007142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276635103196
                                         uncertainty =       0.001656007142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371942179
  error estimate for blocks of size 2^( 2) =       0.000385870869
  error estimate for blocks of size 2^( 3) =       0.000398505736
  error estimate for blocks of size 2^( 4) =       0.000407793895
  error estimate for blocks of size 2^( 5) =       0.000413712702
  error estimate for blocks of size 2^( 6) =       0.000416239126
  error estimate for blocks of size 2^( 7) =       0.000415201589

      target function =      -0.915347242082
              le_mean =     -17.211934454641
             les_mean =     296.539311289126
             stat err =       0.000413236828
             autocorr =       1.234375166564
   target nu stat err =       0.000413236828
   target dn stat err =       0.002366092473
      target stat err =       0.003129191940
              std dev =       0.526005674218
             le_variance =       0.276681969310


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721193445464e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-03, overlap shift 1.5259e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915357122209       residual = 6.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915623407890       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915691825932       residual = 3.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915725191098       residual = 7.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915726920669       residual = 2.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915728566973       residual = 6.93e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915729588522       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915729661816       residual = 5.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915729929781       residual = 1.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915729924119       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915729919647       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915729901603       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-03 is 1.751255e-03

solving harmonic davidson linear method for identity shift 6.1035e-03, overlap shift 6.1035e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915357122209       residual = 6.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915609107201       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915673045589       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915703610864       residual = 7.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915705089999       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915706563381       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915707463568       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915707522483       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915707757253       residual = 8.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915707751243       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915707746477       residual = 9.13e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-03 is 1.636031e-03

solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915357122209       residual = 6.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915564545943       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915615156631       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915637898816       residual = 6.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915638763307       residual = 1.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915639789844       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915640383788       residual = 8.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915640411320       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915640563922       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915640558092       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915640553352       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-02 is 1.293384e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.295926 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6435e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_001                -4.161920e-02 3 1  ON 0
ci_002                -3.308810e-02 3 1  ON 1
ci_003                -2.638433e-02 3 1  ON 2
ci_004                 2.387008e-02 3 1  ON 3
ci_005                 2.418479e-02 3 1  ON 4
ci_006                -2.155193e-02 3 1  ON 5
ci_007                -2.163940e-02 3 1  ON 6
ci_008                -9.095786e-03 3 1  ON 7
ci_009                -1.536696e-02 3 1  ON 8
ci_010                -8.908315e-03 3 1  ON 9
ci_011                -1.015965e-02 3 1  ON 10
ci_012                -1.122675e-02 3 1  ON 11
ci_013                -2.051066e-02 3 1  ON 12
ci_014                 1.370557e-02 3 1  ON 13
ci_015                 1.189618e-02 3 1  ON 14
ci_016                 1.727659e-02 3 1  ON 15
ci_017                 1.684174e-02 3 1  ON 16
ci_018                 1.127810e-02 3 1  ON 17
ci_019                 1.076880e-02 3 1  ON 18
ci_020                 1.784186e-02 3 1  ON 19
ci_021                 1.797697e-02 3 1  ON 20
ci_022                 9.589549e-03 3 1  ON 21
ci_023                 9.774936e-03 3 1  ON 22
ci_024                 8.831629e-03 3 1  ON 23
ci_025                 8.492573e-03 3 1  ON 24
ci_026                 1.174436e-02 3 1  ON 25
ci_027                 1.196139e-02 3 1  ON 26
ci_028                -1.498198e-02 3 1  ON 27
ci_029                -1.477802e-02 3 1  ON 28
ci_030                -9.590904e-03 3 1  ON 29
ci_031                -9.347144e-03 3 1  ON 30
ci_032                -1.467507e-02 3 1  ON 31
ci_033                 5.298844e-03 3 1  ON 32
ci_034                 5.114341e-03 3 1  ON 33
ci_035                -5.394219e-03 3 1  ON 34
ci_036                -1.298084e-02 3 1  ON 35
ci_037                -1.302735e-02 3 1  ON 36
ci_038                 1.811809e-03 3 1  ON 37
ci_039                 2.444799e-03 3 1  ON 38
ci_040                -3.209302e-03 3 1  ON 39
ci_041                 8.823218e-03 3 1  ON 40
ci_042                 8.568416e-03 3 1  ON 41
ci_043                -4.196147e-03 3 1  ON 42
ci_044                -4.530936e-03 3 1  ON 43
ci_045                -3.034628e-03 3 1  ON 44
ci_046                 6.019533e-03 3 1  ON 45
ci_047                 5.335949e-03 3 1  ON 46
ci_048                -1.256570e-02 3 1  ON 47
ci_049                -1.248692e-02 3 1  ON 48
ci_050                 3.006121e-03 3 1  ON 49
ci_051                 3.681755e-03 3 1  ON 50
ci_052                -1.967432e-03 3 1  ON 51
ci_053                -2.388235e-03 3 1  ON 52
ci_054                -2.670703e-03 3 1  ON 53
ci_055                -2.826195e-03 3 1  ON 54
ci_056                 5.866047e-03 3 1  ON 55
ci_057                 5.827215e-03 3 1  ON 56
ci_058                -1.970838e-03 3 1  ON 57
ci_059                -2.359715e-03 3 1  ON 58
ci_060                 6.173616e-03 3 1  ON 59
ci_061                 5.215024e-03 3 1  ON 60
ci_062                -4.305619e-03 3 1  ON 61
ci_063                -3.711042e-03 3 1  ON 62
ci_064                -3.208983e-03 3 1  ON 63
ci_065                -4.024531e-03 3 1  ON 64
ci_066                 4.927625e-03 3 1  ON 65
ci_067                 5.298175e-03 3 1  ON 66
ci_068                -5.715952e-03 3 1  ON 67
ci_069                -5.767557e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.2026
    reference variance = 0.373325
====================================================
  Execution time = 1.3478e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8986e-01
  Total weights = 1.9569e+06
  Execution time = 1.8460e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276773738572
                                         uncertainty =       0.001660332650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276773738572
                                         uncertainty =       0.001660332650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372378462
  error estimate for blocks of size 2^( 2) =       0.000386272923
  error estimate for blocks of size 2^( 3) =       0.000398917029
  error estimate for blocks of size 2^( 4) =       0.000407975368
  error estimate for blocks of size 2^( 5) =       0.000412754569
  error estimate for blocks of size 2^( 6) =       0.000415735142
  error estimate for blocks of size 2^( 7) =       0.000417883504

      target function =      -0.861905048603
              le_mean =     -17.212001312060
             les_mean =     296.584282435976
             stat err =       0.000413587146
             autocorr =       1.233573291059
   target nu stat err =       0.000413587146
   target dn stat err =       0.027845674884
      target stat err =       0.032125307983
              std dev =       0.526622670969
             le_variance =       0.277331437579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276713553185
                                         uncertainty =       0.001675445210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276713553185
                                         uncertainty =       0.001675445210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372311604
  error estimate for blocks of size 2^( 2) =       0.000386204580
  error estimate for blocks of size 2^( 3) =       0.000398840747
  error estimate for blocks of size 2^( 4) =       0.000407900260
  error estimate for blocks of size 2^( 5) =       0.000412648398
  error estimate for blocks of size 2^( 6) =       0.000415635642
  error estimate for blocks of size 2^( 7) =       0.000417748969

      target function =      -0.913560721902
              le_mean =     -17.211954873118
             les_mean =     296.541395108564
             stat err =       0.000413483317
             autocorr =       1.233396864669
   target nu stat err =       0.000413483317
   target dn stat err =       0.002511212333
      target stat err =       0.003302009401
              std dev =       0.526528119231
             le_variance =       0.277231860341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278028459671
                                         uncertainty =       0.001714893613

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278028459671
                                         uncertainty =       0.001714893613

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373171908
  error estimate for blocks of size 2^( 2) =       0.000387073137
  error estimate for blocks of size 2^( 3) =       0.000399681778
  error estimate for blocks of size 2^( 4) =       0.000408737118
  error estimate for blocks of size 2^( 5) =       0.000413493027
  error estimate for blocks of size 2^( 6) =       0.000416474622
  error estimate for blocks of size 2^( 7) =       0.000418652565

      target function =      -0.857288253364
              le_mean =     -17.212024123394
             les_mean =     296.588433229240
             stat err =       0.000414339333
             autocorr =       1.232805150963
   target nu stat err =       0.000414339333
   target dn stat err =       0.035766477261
      target stat err =       0.040857670072
              std dev =       0.527744773049
             le_variance =       0.278514545481

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276612351662
                                         uncertainty =       0.001669489631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276612351662
                                         uncertainty =       0.001669489631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372251246
  error estimate for blocks of size 2^( 2) =       0.000386144696
  error estimate for blocks of size 2^( 3) =       0.000398783324
  error estimate for blocks of size 2^( 4) =       0.000407841503
  error estimate for blocks of size 2^( 5) =       0.000412594514
  error estimate for blocks of size 2^( 6) =       0.000415579970
  error estimate for blocks of size 2^( 7) =       0.000417695737

      target function =      -0.913869967627
              le_mean =     -17.211954553452
             les_mean =     296.541145400040
             stat err =       0.000413427931
             autocorr =       1.233466353894
   target nu stat err =       0.000413427931
   target dn stat err =       0.002473499464
      target stat err =       0.003256142981
              std dev =       0.526442760991
             le_variance =       0.277141980600


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.861905048603        initial
     1.5259e-03     1.5259e-02             1.7513e-03        -0.913560721902
     6.1035e-03     6.1035e-02             1.6360e-03        -0.857288253364
     2.4414e-02     2.4414e-01             1.2934e-03        -0.913869967627  <--

*****************************************************************************
Applying the update for shift_i =   2.4414e-02     and shift_s =   2.4414e-01
*****************************************************************************

  Execution time = 2.2803e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_001                -4.167615e-02 3 1  ON 0
ci_002                -3.328769e-02 3 1  ON 1
ci_003                -2.644483e-02 3 1  ON 2
ci_004                 2.376786e-02 3 1  ON 3
ci_005                 2.439388e-02 3 1  ON 4
ci_006                -2.151532e-02 3 1  ON 5
ci_007                -2.138489e-02 3 1  ON 6
ci_008                -9.028659e-03 3 1  ON 7
ci_009                -1.532143e-02 3 1  ON 8
ci_010                -8.935475e-03 3 1  ON 9
ci_011                -1.015837e-02 3 1  ON 10
ci_012                -1.106403e-02 3 1  ON 11
ci_013                -2.024059e-02 3 1  ON 12
ci_014                 1.358198e-02 3 1  ON 13
ci_015                 1.195165e-02 3 1  ON 14
ci_016                 1.738518e-02 3 1  ON 15
ci_017                 1.691718e-02 3 1  ON 16
ci_018                 1.111924e-02 3 1  ON 17
ci_019                 1.089112e-02 3 1  ON 18
ci_020                 1.805461e-02 3 1  ON 19
ci_021                 1.792438e-02 3 1  ON 20
ci_022                 9.570688e-03 3 1  ON 21
ci_023                 9.673228e-03 3 1  ON 22
ci_024                 8.999673e-03 3 1  ON 23
ci_025                 8.835220e-03 3 1  ON 24
ci_026                 1.175181e-02 3 1  ON 25
ci_027                 1.178522e-02 3 1  ON 26
ci_028                -1.507913e-02 3 1  ON 27
ci_029                -1.512468e-02 3 1  ON 28
ci_030                -9.547634e-03 3 1  ON 29
ci_031                -9.330379e-03 3 1  ON 30
ci_032                -1.473281e-02 3 1  ON 31
ci_033                 5.209497e-03 3 1  ON 32
ci_034                 5.120416e-03 3 1  ON 33
ci_035                -5.388335e-03 3 1  ON 34
ci_036                -1.302860e-02 3 1  ON 35
ci_037                -1.305144e-02 3 1  ON 36
ci_038                 1.840157e-03 3 1  ON 37
ci_039                 2.391650e-03 3 1  ON 38
ci_040                -3.211437e-03 3 1  ON 39
ci_041                 8.908445e-03 3 1  ON 40
ci_042                 8.650494e-03 3 1  ON 41
ci_043                -4.256264e-03 3 1  ON 42
ci_044                -4.501069e-03 3 1  ON 43
ci_045                -2.989721e-03 3 1  ON 44
ci_046                 5.940161e-03 3 1  ON 45
ci_047                 5.514298e-03 3 1  ON 46
ci_048                -1.272238e-02 3 1  ON 47
ci_049                -1.263906e-02 3 1  ON 48
ci_050                 3.020481e-03 3 1  ON 49
ci_051                 3.540492e-03 3 1  ON 50
ci_052                -2.088461e-03 3 1  ON 51
ci_053                -2.416877e-03 3 1  ON 52
ci_054                -2.655467e-03 3 1  ON 53
ci_055                -2.983664e-03 3 1  ON 54
ci_056                 5.848156e-03 3 1  ON 55
ci_057                 5.889350e-03 3 1  ON 56
ci_058                -1.931216e-03 3 1  ON 57
ci_059                -2.342272e-03 3 1  ON 58
ci_060                 6.124673e-03 3 1  ON 59
ci_061                 5.207396e-03 3 1  ON 60
ci_062                -4.256169e-03 3 1  ON 61
ci_063                -3.771609e-03 3 1  ON 62
ci_064                -3.212928e-03 3 1  ON 63
ci_065                -4.024795e-03 3 1  ON 64
ci_066                 4.931527e-03 3 1  ON 65
ci_067                 5.180405e-03 3 1  ON 66
ci_068                -5.711936e-03 3 1  ON 67
ci_069                -5.723724e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9266e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.161
    reference variance = 0.181826
====================================================
  Execution time = 1.3940e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5272e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9017e-01
  Total weights = 1.956955083e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4888e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278688295042
                                         uncertainty =       0.001881759624

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278688295042
                                         uncertainty =       0.001881759624

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373357454
  error estimate for blocks of size 2^( 2) =       0.000387178867
  error estimate for blocks of size 2^( 3) =       0.000399378329
  error estimate for blocks of size 2^( 4) =       0.000408124503
  error estimate for blocks of size 2^( 5) =       0.000413484686
  error estimate for blocks of size 2^( 6) =       0.000417247913
  error estimate for blocks of size 2^( 7) =       0.000418190302

      target function =      -0.913471875146
              le_mean =     -17.212441044990
             les_mean =     296.558293622125
             stat err =       0.000414261851
             autocorr =       1.231119555626
   target nu stat err =       0.000414261851
   target dn stat err =       0.002623752686
      target stat err =       0.003447561257
              std dev =       0.528007175024
             le_variance =       0.278791576877


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721244104499e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e-03, overlap shift 6.1035e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913484252587       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914143076985       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914269197490       residual = 4.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914298984183       residual = 8.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914303697490       residual = 2.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914305215057       residual = 6.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914305838623       residual = 9.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914305638135       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914305718899       residual = 7.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914305688238       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914305773404       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-03 is 2.121846e-03

solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913484252587       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914027957398       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914127955939       residual = 4.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914150119557       residual = 7.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914153484295       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914154435672       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914154840699       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914154695411       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914154755771       residual = 4.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914154736062       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914154791020       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-02 is 1.720581e-03

solving harmonic davidson linear method for identity shift 9.7656e-02, overlap shift 9.7656e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913484252587       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913804236158       residual = 2.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913858615343       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913869270435       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913870773545       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913871087315       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913871240038       residual = 3.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913871174046       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913871203485       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913871196700       residual = 7.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e-02 is 9.791619e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.304702 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6446e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_001                -4.167291e-02 3 1  ON 0
ci_002                -3.358365e-02 3 1  ON 1
ci_003                -2.616172e-02 3 1  ON 2
ci_004                 2.432939e-02 3 1  ON 3
ci_005                 2.537080e-02 3 1  ON 4
ci_006                -2.245142e-02 3 1  ON 5
ci_007                -2.158042e-02 3 1  ON 6
ci_008                -9.979573e-03 3 1  ON 7
ci_009                -1.427762e-02 3 1  ON 8
ci_010                -8.581977e-03 3 1  ON 9
ci_011                -1.032890e-02 3 1  ON 10
ci_012                -1.087645e-02 3 1  ON 11
ci_013                -1.955133e-02 3 1  ON 12
ci_014                 1.290576e-02 3 1  ON 13
ci_015                 1.203565e-02 3 1  ON 14
ci_016                 1.701798e-02 3 1  ON 15
ci_017                 1.635194e-02 3 1  ON 16
ci_018                 1.050613e-02 3 1  ON 17
ci_019                 1.095184e-02 3 1  ON 18
ci_020                 1.745972e-02 3 1  ON 19
ci_021                 1.755104e-02 3 1  ON 20
ci_022                 9.894348e-03 3 1  ON 21
ci_023                 9.309552e-03 3 1  ON 22
ci_024                 9.479082e-03 3 1  ON 23
ci_025                 9.935830e-03 3 1  ON 24
ci_026                 1.114715e-02 3 1  ON 25
ci_027                 1.092559e-02 3 1  ON 26
ci_028                -1.440937e-02 3 1  ON 27
ci_029                -1.491415e-02 3 1  ON 28
ci_030                -1.009064e-02 3 1  ON 29
ci_031                -8.897326e-03 3 1  ON 30
ci_032                -1.488781e-02 3 1  ON 31
ci_033                 6.245511e-03 3 1  ON 32
ci_034                 5.721419e-03 3 1  ON 33
ci_035                -5.499581e-03 3 1  ON 34
ci_036                -1.260345e-02 3 1  ON 35
ci_037                -1.249846e-02 3 1  ON 36
ci_038                 1.933427e-03 3 1  ON 37
ci_039                 2.082097e-03 3 1  ON 38
ci_040                -3.199551e-03 3 1  ON 39
ci_041                 8.779124e-03 3 1  ON 40
ci_042                 9.128494e-03 3 1  ON 41
ci_043                -4.024518e-03 3 1  ON 42
ci_044                -2.780487e-03 3 1  ON 43
ci_045                -3.161206e-03 3 1  ON 44
ci_046                 5.726668e-03 3 1  ON 45
ci_047                 5.871872e-03 3 1  ON 46
ci_048                -1.219718e-02 3 1  ON 47
ci_049                -1.346632e-02 3 1  ON 48
ci_050                 2.341142e-03 3 1  ON 49
ci_051                 2.722339e-03 3 1  ON 50
ci_052                -2.164348e-03 3 1  ON 51
ci_053                -3.487584e-03 3 1  ON 52
ci_054                -2.948621e-03 3 1  ON 53
ci_055                -2.859434e-03 3 1  ON 54
ci_056                 5.493396e-03 3 1  ON 55
ci_057                 5.600907e-03 3 1  ON 56
ci_058                -2.392338e-03 3 1  ON 57
ci_059                -1.489952e-03 3 1  ON 58
ci_060                 4.693946e-03 3 1  ON 59
ci_061                 5.895605e-03 3 1  ON 60
ci_062                -4.101140e-03 3 1  ON 61
ci_063                -4.171673e-03 3 1  ON 62
ci_064                -3.196024e-03 3 1  ON 63
ci_065                -3.878090e-03 3 1  ON 64
ci_066                 4.938030e-03 3 1  ON 65
ci_067                 4.677598e-03 3 1  ON 66
ci_068                -4.963417e-03 3 1  ON 67
ci_069                -5.345923e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.1968
    reference variance = 0.333486
====================================================
  Execution time = 1.3511e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8726e-01
  Total weights = 1.9573e+06
  Execution time = 1.8350e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277171364477
                                         uncertainty =       0.001550208333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277171364477
                                         uncertainty =       0.001550208333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372435349
  error estimate for blocks of size 2^( 2) =       0.000385889242
  error estimate for blocks of size 2^( 3) =       0.000398098868
  error estimate for blocks of size 2^( 4) =       0.000406946621
  error estimate for blocks of size 2^( 5) =       0.000412962724
  error estimate for blocks of size 2^( 6) =       0.000415544479
  error estimate for blocks of size 2^( 7) =       0.000418341337

      target function =      -0.855822057252
              le_mean =     -17.211478600182
             les_mean =     296.571187735908
             stat err =       0.000413448790
             autocorr =       1.232371545749
   target nu stat err =       0.000413448790
   target dn stat err =       0.032388494177
      target stat err =       0.036826530772
              std dev =       0.526703121706
             le_variance =       0.277416178415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277345666341
                                         uncertainty =       0.001528922183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277345666341
                                         uncertainty =       0.001528922183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372550072
  error estimate for blocks of size 2^( 2) =       0.000386027049
  error estimate for blocks of size 2^( 3) =       0.000398273001
  error estimate for blocks of size 2^( 4) =       0.000407145948
  error estimate for blocks of size 2^( 5) =       0.000413187064
  error estimate for blocks of size 2^( 6) =       0.000415707639
  error estimate for blocks of size 2^( 7) =       0.000418464655

      target function =      -0.916032532141
              le_mean =     -17.211425301622
             les_mean =     296.521158389609
             stat err =       0.000413626327
             autocorr =       1.232670611872
   target nu stat err =       0.000413626327
   target dn stat err =       0.002012565111
      target stat err =       0.002681366246
              std dev =       0.526865364951
             le_variance =       0.277587112785

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284367409788
                                         uncertainty =       0.006109380652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284367409788
                                         uncertainty =       0.006109380652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377251228
  error estimate for blocks of size 2^( 2) =       0.000390604465
  error estimate for blocks of size 2^( 3) =       0.000402719094
  error estimate for blocks of size 2^( 4) =       0.000411514512
  error estimate for blocks of size 2^( 5) =       0.000417676652
  error estimate for blocks of size 2^( 6) =       0.000420304390
  error estimate for blocks of size 2^( 7) =       0.000423197924

      target function =      -0.570083195207
              le_mean =     -17.211409932084
             les_mean =     296.854365081248
             stat err =       0.000418173369
             autocorr =       1.228715735846
   target nu stat err =       0.000418173369
   target dn stat err =       0.312419157389
      target stat err =       0.171519252070
              std dev =       0.533513802988
             le_variance =       0.284636977978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285389019457
                                         uncertainty =       0.008782729161

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285389019457
                                         uncertainty =       0.008782729161

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377911985
  error estimate for blocks of size 2^( 2) =       0.000391207944
  error estimate for blocks of size 2^( 3) =       0.000403243837
  error estimate for blocks of size 2^( 4) =       0.000412063794
  error estimate for blocks of size 2^( 5) =       0.000417911928
  error estimate for blocks of size 2^( 6) =       0.000420401790
  error estimate for blocks of size 2^( 7) =       0.000423073523

      target function =      -0.096098500663
              le_mean =     -17.211376997736
             les_mean =     299.826352827710
             stat err =       0.000418362759
             autocorr =       1.225532143943
   target nu stat err =       0.000418362759
   target dn stat err =       3.296291896665
      target stat err =       0.078963948677
              std dev =       0.534448254395
             le_variance =       0.285634936625


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.855822057252        initial
     6.1035e-03     6.1035e-02             2.1218e-03        -0.916032532141  <--
     2.4414e-02     2.4414e-01             1.7206e-03        -0.570083195207
     9.7656e-02     9.7656e-01             9.7916e-04        -0.096098500663

*****************************************************************************
Applying the update for shift_i =   6.1035e-03     and shift_s =   6.1035e-02
*****************************************************************************

  Execution time = 2.2823e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_001                -4.167399e-02 3 1  ON 0
ci_002                -3.366845e-02 3 1  ON 1
ci_003                -2.608131e-02 3 1  ON 2
ci_004                 2.446253e-02 3 1  ON 3
ci_005                 2.560635e-02 3 1  ON 4
ci_006                -2.272090e-02 3 1  ON 5
ci_007                -2.164146e-02 3 1  ON 6
ci_008                -1.016979e-02 3 1  ON 7
ci_009                -1.404131e-02 3 1  ON 8
ci_010                -8.498667e-03 3 1  ON 9
ci_011                -1.037250e-02 3 1  ON 10
ci_012                -1.083022e-02 3 1  ON 11
ci_013                -1.935326e-02 3 1  ON 12
ci_014                 1.274636e-02 3 1  ON 13
ci_015                 1.204512e-02 3 1  ON 14
ci_016                 1.690587e-02 3 1  ON 15
ci_017                 1.619132e-02 3 1  ON 16
ci_018                 1.035810e-02 3 1  ON 17
ci_019                 1.095614e-02 3 1  ON 18
ci_020                 1.730333e-02 3 1  ON 19
ci_021                 1.744036e-02 3 1  ON 20
ci_022                 9.963673e-03 3 1  ON 21
ci_023                 9.223216e-03 3 1  ON 22
ci_024                 9.601387e-03 3 1  ON 23
ci_025                 1.023593e-02 3 1  ON 24
ci_026                 1.102193e-02 3 1  ON 25
ci_027                 1.075783e-02 3 1  ON 26
ci_028                -1.423082e-02 3 1  ON 27
ci_029                -1.487245e-02 3 1  ON 28
ci_030                -1.020280e-02 3 1  ON 29
ci_031                -8.820161e-03 3 1  ON 30
ci_032                -1.492978e-02 3 1  ON 31
ci_033                 6.508042e-03 3 1  ON 32
ci_034                 5.879056e-03 3 1  ON 33
ci_035                -5.525191e-03 3 1  ON 34
ci_036                -1.250572e-02 3 1  ON 35
ci_037                -1.238088e-02 3 1  ON 36
ci_038                 1.954300e-03 3 1  ON 37
ci_039                 2.014179e-03 3 1  ON 38
ci_040                -3.197703e-03 3 1  ON 39
ci_041                 8.737236e-03 3 1  ON 40
ci_042                 9.233494e-03 3 1  ON 41
ci_043                -3.972164e-03 3 1  ON 42
ci_044                -2.379222e-03 3 1  ON 43
ci_045                -3.198611e-03 3 1  ON 44
ci_046                 5.673056e-03 3 1  ON 45
ci_047                 5.960017e-03 3 1  ON 46
ci_048                -1.207443e-02 3 1  ON 47
ci_049                -1.368144e-02 3 1  ON 48
ci_050                 2.202536e-03 3 1  ON 49
ci_051                 2.550631e-03 3 1  ON 50
ci_052                -2.185035e-03 3 1  ON 51
ci_053                -3.720631e-03 3 1  ON 52
ci_054                -3.008196e-03 3 1  ON 53
ci_055                -2.838413e-03 3 1  ON 54
ci_056                 5.412870e-03 3 1  ON 55
ci_057                 5.535881e-03 3 1  ON 56
ci_058                -2.496650e-03 3 1  ON 57
ci_059                -1.312966e-03 3 1  ON 58
ci_060                 4.346243e-03 3 1  ON 59
ci_061                 6.064810e-03 3 1  ON 60
ci_062                -4.071953e-03 3 1  ON 61
ci_063                -4.280560e-03 3 1  ON 62
ci_064                -3.191368e-03 3 1  ON 63
ci_065                -3.845678e-03 3 1  ON 64
ci_066                 4.930428e-03 3 1  ON 65
ci_067                 4.557333e-03 3 1  ON 66
ci_068                -4.778934e-03 3 1  ON 67
ci_069                -5.253272e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9279e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.193
    reference variance = 0.191717
====================================================
  Execution time = 1.3912e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5305e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9065e-01
  Total weights = 1.957117795e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4945e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277831923117
                                         uncertainty =       0.001391617568

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277831923117
                                         uncertainty =       0.001391617568

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372700058
  error estimate for blocks of size 2^( 2) =       0.000386679889
  error estimate for blocks of size 2^( 3) =       0.000398883499
  error estimate for blocks of size 2^( 4) =       0.000408036702
  error estimate for blocks of size 2^( 5) =       0.000412560188
  error estimate for blocks of size 2^( 6) =       0.000415599213
  error estimate for blocks of size 2^( 7) =       0.000415391089

      target function =      -0.912737835702
              le_mean =     -17.211969405371
             les_mean =     296.542536268294
             stat err =       0.000412896798
             autocorr =       1.227337797603
   target nu stat err =       0.000412896798
   target dn stat err =       0.002261774237
      target stat err =       0.002979516143
              std dev =       0.527077476420
             le_variance =       0.277810666150


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721196940537e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e-03, overlap shift 1.5259e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912746850912       residual = 2.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913527404140       residual = 3.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913667452380       residual = 7.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913717469126       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913732043801       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913732096851       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913733100400       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913733536216       residual = 4.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913733647083       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913733617948       residual = 2.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913733699256       residual = 8.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-03 is 2.548433e-03

solving harmonic davidson linear method for identity shift 6.1035e-03, overlap shift 6.1035e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912746850912       residual = 2.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913486901284       residual = 3.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913618185204       residual = 7.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913664517871       residual = 2.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913677824055       residual = 2.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913677786648       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913678686471       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913679083459       residual = 3.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913679185937       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913679159115       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913679230008       residual = 7.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-03 is 2.416217e-03

solving harmonic davidson linear method for identity shift 2.4414e-02, overlap shift 2.4414e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912746850912       residual = 2.47e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913359678771       residual = 3.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913464573662       residual = 6.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913500253765       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913510050422       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913509828013       residual = 8.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913510458441       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913510750300       residual = 2.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913510828043       residual = 9.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913510807945       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913510853229       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e-02 is 2.001119e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.308848 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6416e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_001                -4.114537e-02 3 1  ON 0
ci_002                -3.313122e-02 3 1  ON 1
ci_003                -2.646070e-02 3 1  ON 2
ci_004                 2.473223e-02 3 1  ON 3
ci_005                 2.477302e-02 3 1  ON 4
ci_006                -2.195091e-02 3 1  ON 5
ci_007                -2.235333e-02 3 1  ON 6
ci_008                -7.753571e-03 3 1  ON 7
ci_009                -1.435165e-02 3 1  ON 8
ci_010                -8.597533e-03 3 1  ON 9
ci_011                -1.052210e-02 3 1  ON 10
ci_012                -1.126227e-02 3 1  ON 11
ci_013                -1.945171e-02 3 1  ON 12
ci_014                 1.273534e-02 3 1  ON 13
ci_015                 1.244453e-02 3 1  ON 14
ci_016                 1.663685e-02 3 1  ON 15
ci_017                 1.568005e-02 3 1  ON 16
ci_018                 1.131863e-02 3 1  ON 17
ci_019                 1.071599e-02 3 1  ON 18
ci_020                 1.752055e-02 3 1  ON 19
ci_021                 1.686860e-02 3 1  ON 20
ci_022                 1.023159e-02 3 1  ON 21
ci_023                 1.036515e-02 3 1  ON 22
ci_024                 9.717594e-03 3 1  ON 23
ci_025                 8.667551e-03 3 1  ON 24
ci_026                 1.081234e-02 3 1  ON 25
ci_027                 1.136636e-02 3 1  ON 26
ci_028                -1.518053e-02 3 1  ON 27
ci_029                -1.545577e-02 3 1  ON 28
ci_030                -9.475209e-03 3 1  ON 29
ci_031                -9.796189e-03 3 1  ON 30
ci_032                -1.428856e-02 3 1  ON 31
ci_033                 5.543281e-03 3 1  ON 32
ci_034                 6.935087e-03 3 1  ON 33
ci_035                -5.360108e-03 3 1  ON 34
ci_036                -1.284318e-02 3 1  ON 35
ci_037                -1.191735e-02 3 1  ON 36
ci_038                 1.177516e-03 3 1  ON 37
ci_039                 2.561460e-03 3 1  ON 38
ci_040                -3.001610e-03 3 1  ON 39
ci_041                 9.160177e-03 3 1  ON 40
ci_042                 9.479965e-03 3 1  ON 41
ci_043                -3.820580e-03 3 1  ON 42
ci_044                -4.409280e-03 3 1  ON 43
ci_045                -2.966541e-03 3 1  ON 44
ci_046                 6.159552e-03 3 1  ON 45
ci_047                 5.950638e-03 3 1  ON 46
ci_048                -1.270033e-02 3 1  ON 47
ci_049                -1.285893e-02 3 1  ON 48
ci_050                 2.908919e-03 3 1  ON 49
ci_051                 2.797914e-03 3 1  ON 50
ci_052                -2.859857e-03 3 1  ON 51
ci_053                -2.923982e-03 3 1  ON 52
ci_054                -2.729689e-03 3 1  ON 53
ci_055                -3.205348e-03 3 1  ON 54
ci_056                 5.444712e-03 3 1  ON 55
ci_057                 5.614279e-03 3 1  ON 56
ci_058                -2.219292e-03 3 1  ON 57
ci_059                -2.530728e-03 3 1  ON 58
ci_060                 5.373561e-03 3 1  ON 59
ci_061                 5.141507e-03 3 1  ON 60
ci_062                -4.717171e-03 3 1  ON 61
ci_063                -4.379797e-03 3 1  ON 62
ci_064                -3.223214e-03 3 1  ON 63
ci_065                -4.195198e-03 3 1  ON 64
ci_066                 4.594280e-03 3 1  ON 65
ci_067                 5.010289e-03 3 1  ON 66
ci_068                -6.580013e-03 3 1  ON 67
ci_069                -4.484917e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2216
    reference variance = 0.243769
====================================================
  Execution time = 1.3565e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8942e-01
  Total weights = 1.9571e+06
  Execution time = 1.8402e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277828222574
                                         uncertainty =       0.001824297046

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277828222574
                                         uncertainty =       0.001824297046

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372750679
  error estimate for blocks of size 2^( 2) =       0.000386314921
  error estimate for blocks of size 2^( 3) =       0.000398013483
  error estimate for blocks of size 2^( 4) =       0.000407238790
  error estimate for blocks of size 2^( 5) =       0.000411488854
  error estimate for blocks of size 2^( 6) =       0.000414503987
  error estimate for blocks of size 2^( 7) =       0.000416658186

      target function =      -0.904780123037
              le_mean =     -17.212095150249
             les_mean =     296.553090547552
             stat err =       0.000412472454
             autocorr =       1.224483720964
   target nu stat err =       0.000412472454
   target dn stat err =       0.003725520680
      target stat err =       0.004765183756
              std dev =       0.527149065169
             le_variance =       0.277886136908

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276384622066
                                         uncertainty =       0.001545424213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276384622066
                                         uncertainty =       0.001545424213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371774079
  error estimate for blocks of size 2^( 2) =       0.000385391325
  error estimate for blocks of size 2^( 3) =       0.000397126115
  error estimate for blocks of size 2^( 4) =       0.000406347619
  error estimate for blocks of size 2^( 5) =       0.000410607922
  error estimate for blocks of size 2^( 6) =       0.000413596364
  error estimate for blocks of size 2^( 7) =       0.000415680325

      target function =      -0.914368109280
              le_mean =     -17.211997145143
             les_mean =     296.542235598310
             stat err =       0.000411558058
             autocorr =       1.225473727180
   target nu stat err =       0.000411558058
   target dn stat err =       0.002448036895
      target stat err =       0.003226903538
              std dev =       0.525767944739
             le_variance =       0.276431931715

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288710929449
                                         uncertainty =       0.010898179107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288710929449
                                         uncertainty =       0.010898179107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379960408
  error estimate for blocks of size 2^( 2) =       0.000393329960
  error estimate for blocks of size 2^( 3) =       0.000404806218
  error estimate for blocks of size 2^( 4) =       0.000413876549
  error estimate for blocks of size 2^( 5) =       0.000418092460
  error estimate for blocks of size 2^( 6) =       0.000421069859
  error estimate for blocks of size 2^( 7) =       0.000422785652

      target function =      -0.471521725404
              le_mean =     -17.212019064582
             les_mean =     297.030784780049
             stat err =       0.000418956130
             autocorr =       1.215795154163
   target nu stat err =       0.000418956130
   target dn stat err =       0.456691906819
      target stat err =       0.180493687176
              std dev =       0.537345162020
             le_variance =       0.288739823146

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276413290150
                                         uncertainty =       0.001550813826

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276413290150
                                         uncertainty =       0.001550813826

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371794776
  error estimate for blocks of size 2^( 2) =       0.000385406408
  error estimate for blocks of size 2^( 3) =       0.000397137017
  error estimate for blocks of size 2^( 4) =       0.000406362537
  error estimate for blocks of size 2^( 5) =       0.000410615908
  error estimate for blocks of size 2^( 6) =       0.000413606768
  error estimate for blocks of size 2^( 7) =       0.000415704979

      target function =      -0.913634071533
              le_mean =     -17.211999578905
             les_mean =     296.542886244763
             stat err =       0.000411572548
             autocorr =       1.225423580501
   target nu stat err =       0.000411572548
   target dn stat err =       0.002487280798
      target stat err =       0.003271795988
              std dev =       0.525797214230
             le_variance =       0.276462710492


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.904780123037        initial
     1.5259e-03     1.5259e-02             2.5484e-03        -0.914368109280  <--
     6.1035e-03     6.1035e-02             2.4162e-03        -0.471521725404
     2.4414e-02     2.4414e-01             2.0011e-03        -0.913634071533

*****************************************************************************
Applying the update for shift_i =   1.5259e-03     and shift_s =   1.5259e-02
*****************************************************************************

  Execution time = 2.2889e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_001                -4.110647e-02 3 1  ON 0
ci_002                -3.309113e-02 3 1  ON 1
ci_003                -2.647851e-02 3 1  ON 2
ci_004                 2.475017e-02 3 1  ON 3
ci_005                 2.471729e-02 3 1  ON 4
ci_006                -2.189439e-02 3 1  ON 5
ci_007                -2.240801e-02 3 1  ON 6
ci_008                -7.621355e-03 3 1  ON 7
ci_009                -1.437096e-02 3 1  ON 8
ci_010                -8.605349e-03 3 1  ON 9
ci_011                -1.053200e-02 3 1  ON 10
ci_012                -1.128665e-02 3 1  ON 11
ci_013                -1.945986e-02 3 1  ON 12
ci_014                 1.272826e-02 3 1  ON 13
ci_015                 1.247416e-02 3 1  ON 14
ci_016                 1.661749e-02 3 1  ON 15
ci_017                 1.564237e-02 3 1  ON 16
ci_018                 1.136942e-02 3 1  ON 17
ci_019                 1.070199e-02 3 1  ON 18
ci_020                 1.753366e-02 3 1  ON 19
ci_021                 1.683353e-02 3 1  ON 20
ci_022                 1.025211e-02 3 1  ON 21
ci_023                 1.043770e-02 3 1  ON 22
ci_024                 9.733359e-03 3 1  ON 23
ci_025                 8.556344e-03 3 1  ON 24
ci_026                 1.080388e-02 3 1  ON 25
ci_027                 1.139853e-02 3 1  ON 26
ci_028                -1.525419e-02 3 1  ON 27
ci_029                -1.549918e-02 3 1  ON 28
ci_030                -9.435323e-03 3 1  ON 29
ci_031                -9.848323e-03 3 1  ON 30
ci_032                -1.424574e-02 3 1  ON 31
ci_033                 5.478675e-03 3 1  ON 32
ci_034                 7.004001e-03 3 1  ON 33
ci_035                -5.350006e-03 3 1  ON 34
ci_036                -1.285734e-02 3 1  ON 35
ci_037                -1.188771e-02 3 1  ON 36
ci_038                 1.132486e-03 3 1  ON 37
ci_039                 2.593349e-03 3 1  ON 38
ci_040                -2.990480e-03 3 1  ON 39
ci_041                 9.191273e-03 3 1  ON 40
ci_042                 9.496981e-03 3 1  ON 41
ci_043                -3.810857e-03 3 1  ON 42
ci_044                -4.536597e-03 3 1  ON 43
ci_045                -2.953600e-03 3 1  ON 44
ci_046                 6.191325e-03 3 1  ON 45
ci_047                 5.949092e-03 3 1  ON 46
ci_048                -1.273969e-02 3 1  ON 47
ci_049                -1.280734e-02 3 1  ON 48
ci_050                 2.947989e-03 3 1  ON 49
ci_051                 2.814158e-03 3 1  ON 50
ci_052                -2.896135e-03 3 1  ON 51
ci_053                -2.876038e-03 3 1  ON 52
ci_054                -2.716759e-03 3 1  ON 53
ci_055                -3.225746e-03 3 1  ON 54
ci_056                 5.446942e-03 3 1  ON 55
ci_057                 5.618306e-03 3 1  ON 56
ci_058                -2.202509e-03 3 1  ON 57
ci_059                -2.603135e-03 3 1  ON 58
ci_060                 5.440951e-03 3 1  ON 59
ci_061                 5.081506e-03 3 1  ON 60
ci_062                -4.757328e-03 3 1  ON 61
ci_063                -4.380774e-03 3 1  ON 62
ci_064                -3.225354e-03 3 1  ON 63
ci_065                -4.215492e-03 3 1  ON 64
ci_066                 4.576243e-03 3 1  ON 65
ci_067                 5.035027e-03 3 1  ON 66
ci_068                -6.695833e-03 3 1  ON 67
ci_069                -4.433214e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9310e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.2247
    reference variance = 0.489524
====================================================
  Execution time = 1.3894e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9107e-01
  Total weights = 1.957092530e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5010e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276968524472
                                         uncertainty =       0.001549549061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276968524472
                                         uncertainty =       0.001549549061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372121226
  error estimate for blocks of size 2^( 2) =       0.000385883427
  error estimate for blocks of size 2^( 3) =       0.000398090559
  error estimate for blocks of size 2^( 4) =       0.000405914139
  error estimate for blocks of size 2^( 5) =       0.000411773824
  error estimate for blocks of size 2^( 6) =       0.000412812850
  error estimate for blocks of size 2^( 7) =       0.000414595403

      target function =      -0.912075455761
              le_mean =     -17.211572495906
             les_mean =     296.529295435765
             stat err =       0.000411274054
             autocorr =       1.221500751029
   target nu stat err =       0.000411274054
   target dn stat err =       0.003875717032
      target stat err =       0.005029927379
              std dev =       0.526258884168
             le_variance =       0.276948413166


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721157249591e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-04, overlap shift 3.8147e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912102509389       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912828170688       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912990488475       residual = 5.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913032283518       residual = 9.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913034960089       residual = 3.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913036515669       residual = 9.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913036799133       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913036537563       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913036565002       residual = 6.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913036668393       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913036651356       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-04 is 2.031464e-03

solving harmonic davidson linear method for identity shift 1.5259e-03, overlap shift 1.5259e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912102509389       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912817864789       residual = 2.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912977289006       residual = 5.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913018100060       residual = 9.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913020683617       residual = 3.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913022190472       residual = 9.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913022455161       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913022202455       residual = 3.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913022226835       residual = 6.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913022327273       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913022310722       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-03 is 1.995792e-03

solving harmonic davidson linear method for identity shift 6.1035e-03, overlap shift 6.1035e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912102509389       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912779408943       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912928199763       residual = 5.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912965467853       residual = 8.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912967726499       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912969062434       residual = 8.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912969264350       residual = 1.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912969042334       residual = 2.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912969057106       residual = 5.55e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912969146837       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912969132008       residual = 3.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-03 is 1.864741e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.313004 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6404e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_001                -4.153197e-02 3 1  ON 0
ci_002                -3.313449e-02 3 1  ON 1
ci_003                -2.657558e-02 3 1  ON 2
ci_004                 2.420827e-02 3 1  ON 3
ci_005                 2.517523e-02 3 1  ON 4
ci_006                -2.088115e-02 3 1  ON 5
ci_007                -2.137947e-02 3 1  ON 6
ci_008                -9.287438e-03 3 1  ON 7
ci_009                -1.464092e-02 3 1  ON 8
ci_010                -7.415991e-03 3 1  ON 9
ci_011                -1.065659e-02 3 1  ON 10
ci_012                -9.853771e-03 3 1  ON 11
ci_013                -1.969790e-02 3 1  ON 12
ci_014                 1.305090e-02 3 1  ON 13
ci_015                 1.142278e-02 3 1  ON 14
ci_016                 1.677420e-02 3 1  ON 15
ci_017                 1.761667e-02 3 1  ON 16
ci_018                 1.081798e-02 3 1  ON 17
ci_019                 1.053229e-02 3 1  ON 18
ci_020                 1.741550e-02 3 1  ON 19
ci_021                 1.714560e-02 3 1  ON 20
ci_022                 1.224790e-02 3 1  ON 21
ci_023                 1.008637e-02 3 1  ON 22
ci_024                 8.729076e-03 3 1  ON 23
ci_025                 8.921658e-03 3 1  ON 24
ci_026                 1.139355e-02 3 1  ON 25
ci_027                 1.138596e-02 3 1  ON 26
ci_028                -1.373220e-02 3 1  ON 27
ci_029                -1.627399e-02 3 1  ON 28
ci_030                -9.827035e-03 3 1  ON 29
ci_031                -9.916948e-03 3 1  ON 30
ci_032                -1.513615e-02 3 1  ON 31
ci_033                 4.128425e-03 3 1  ON 32
ci_034                 5.398360e-03 3 1  ON 33
ci_035                -6.498008e-03 3 1  ON 34
ci_036                -1.336006e-02 3 1  ON 35
ci_037                -1.246371e-02 3 1  ON 36
ci_038                 2.333047e-03 3 1  ON 37
ci_039                 1.763848e-03 3 1  ON 38
ci_040                -3.285802e-03 3 1  ON 39
ci_041                 8.622285e-03 3 1  ON 40
ci_042                 8.506224e-03 3 1  ON 41
ci_043                -4.123165e-03 3 1  ON 42
ci_044                -4.749831e-03 3 1  ON 43
ci_045                -2.775215e-03 3 1  ON 44
ci_046                 5.235545e-03 3 1  ON 45
ci_047                 5.398393e-03 3 1  ON 46
ci_048                -1.311618e-02 3 1  ON 47
ci_049                -1.251660e-02 3 1  ON 48
ci_050                 1.967939e-03 3 1  ON 49
ci_051                 4.205807e-03 3 1  ON 50
ci_052                -3.154663e-03 3 1  ON 51
ci_053                -1.540350e-03 3 1  ON 52
ci_054                -3.162062e-03 3 1  ON 53
ci_055                -3.364184e-03 3 1  ON 54
ci_056                 5.418594e-03 3 1  ON 55
ci_057                 6.414007e-03 3 1  ON 56
ci_058                -2.056007e-03 3 1  ON 57
ci_059                -2.093668e-03 3 1  ON 58
ci_060                 4.912015e-03 3 1  ON 59
ci_061                 4.482172e-03 3 1  ON 60
ci_062                -4.231143e-03 3 1  ON 61
ci_063                -4.009037e-03 3 1  ON 62
ci_064                -3.666197e-03 3 1  ON 63
ci_065                -4.046780e-03 3 1  ON 64
ci_066                 3.792441e-03 3 1  ON 65
ci_067                 4.489820e-03 3 1  ON 66
ci_068                -5.933248e-03 3 1  ON 67
ci_069                -3.995895e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.2246
    reference variance = 0.251726
====================================================
  Execution time = 1.3625e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8875e-01
  Total weights = 1.9572e+06
  Execution time = 1.8345e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278214245908
                                         uncertainty =       0.001629856743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278214245908
                                         uncertainty =       0.001629856743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373008007
  error estimate for blocks of size 2^( 2) =       0.000386761054
  error estimate for blocks of size 2^( 3) =       0.000399625099
  error estimate for blocks of size 2^( 4) =       0.000408735182
  error estimate for blocks of size 2^( 5) =       0.000414923996
  error estimate for blocks of size 2^( 6) =       0.000419290742
  error estimate for blocks of size 2^( 7) =       0.000420223594

      target function =      -0.849985144935
              le_mean =     -17.211756409656
             les_mean =     296.585722161724
             stat err =       0.000415793378
             autocorr =       1.242564173282
   target nu stat err =       0.000415793378
   target dn stat err =       0.035187372204
      target stat err =       0.039493467614
              std dev =       0.527512983058
             le_variance =       0.278269947295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277062788586
                                         uncertainty =       0.001421802718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277062788586
                                         uncertainty =       0.001421802718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372226479
  error estimate for blocks of size 2^( 2) =       0.000386027221
  error estimate for blocks of size 2^( 3) =       0.000399088243
  error estimate for blocks of size 2^( 4) =       0.000408245772
  error estimate for blocks of size 2^( 5) =       0.000414494338
  error estimate for blocks of size 2^( 6) =       0.000418867215
  error estimate for blocks of size 2^( 7) =       0.000419613138

      target function =      -0.915149169715
              le_mean =     -17.211670732052
             les_mean =     296.530335151970
             stat err =       0.000415305116
             autocorr =       1.244858627080
   target nu stat err =       0.000415305116
   target dn stat err =       0.002084477490
      target stat err =       0.002768994700
              std dev =       0.526407734817
             le_variance =       0.277105103275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281057281595
                                         uncertainty =       0.002253809679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281057281595
                                         uncertainty =       0.002253809679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374885102
  error estimate for blocks of size 2^( 2) =       0.000388660837
  error estimate for blocks of size 2^( 3) =       0.000401634428
  error estimate for blocks of size 2^( 4) =       0.000410793681
  error estimate for blocks of size 2^( 5) =       0.000417086272
  error estimate for blocks of size 2^( 6) =       0.000421447390
  error estimate for blocks of size 2^( 7) =       0.000422227455

      target function =      -0.605792712512
              le_mean =     -17.211805675677
             les_mean =     296.862715393413
             stat err =       0.000417888699
             autocorr =       1.242581520828
   target nu stat err =       0.000417888699
   target dn stat err =       0.182622628050
      target stat err =       0.107137871599
              std dev =       0.530167595476
             le_variance =       0.281077679292

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277021920826
                                         uncertainty =       0.001420359582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277021920826
                                         uncertainty =       0.001420359582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372199656
  error estimate for blocks of size 2^( 2) =       0.000385996801
  error estimate for blocks of size 2^( 3) =       0.000399053658
  error estimate for blocks of size 2^( 4) =       0.000408210654
  error estimate for blocks of size 2^( 5) =       0.000414454980
  error estimate for blocks of size 2^( 6) =       0.000418829688
  error estimate for blocks of size 2^( 7) =       0.000419586652

      target function =      -0.914625517766
              le_mean =     -17.211670729040
             les_mean =     296.530738400819
             stat err =       0.000415270494
             autocorr =       1.244830480841
   target nu stat err =       0.000415270494
   target dn stat err =       0.002138150542
      target stat err =       0.002833920708
              std dev =       0.526369801247
             le_variance =       0.277065167665


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.849985144935        initial
     3.8147e-04     3.8147e-03             2.0315e-03        -0.915149169715  <--
     1.5259e-03     1.5259e-02             1.9958e-03        -0.605792712512
     6.1035e-03     6.1035e-02             1.8647e-03        -0.914625517766

*****************************************************************************
Applying the update for shift_i =   3.8147e-04     and shift_s =   3.8147e-03
*****************************************************************************

  Execution time = 2.2929e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_001                -4.153855e-02 3 1  ON 0
ci_002                -3.313549e-02 3 1  ON 1
ci_003                -2.657992e-02 3 1  ON 2
ci_004                 2.419819e-02 3 1  ON 3
ci_005                 2.518435e-02 3 1  ON 4
ci_006                -2.086133e-02 3 1  ON 5
ci_007                -2.135927e-02 3 1  ON 6
ci_008                -9.311425e-03 3 1  ON 7
ci_009                -1.464476e-02 3 1  ON 8
ci_010                -7.396625e-03 3 1  ON 9
ci_011                -1.065904e-02 3 1  ON 10
ci_012                -9.831189e-03 3 1  ON 11
ci_013                -1.970183e-02 3 1  ON 12
ci_014                 1.305735e-02 3 1  ON 13
ci_015                 1.140535e-02 3 1  ON 14
ci_016                 1.677851e-02 3 1  ON 15
ci_017                 1.765489e-02 3 1  ON 16
ci_018                 1.081010e-02 3 1  ON 17
ci_019                 1.052957e-02 3 1  ON 18
ci_020                 1.741336e-02 3 1  ON 19
ci_021                 1.715035e-02 3 1  ON 20
ci_022                 1.228357e-02 3 1  ON 21
ci_023                 1.008051e-02 3 1  ON 22
ci_024                 8.710494e-03 3 1  ON 23
ci_025                 8.927549e-03 3 1  ON 24
ci_026                 1.140119e-02 3 1  ON 25
ci_027                 1.138693e-02 3 1  ON 26
ci_028                -1.370279e-02 3 1  ON 27
ci_029                -1.628696e-02 3 1  ON 28
ci_030                -9.833749e-03 3 1  ON 29
ci_031                -9.917581e-03 3 1  ON 30
ci_032                -1.515105e-02 3 1  ON 31
ci_033                 4.106279e-03 3 1  ON 32
ci_034                 5.371451e-03 3 1  ON 33
ci_035                -6.515469e-03 3 1  ON 34
ci_036                -1.336927e-02 3 1  ON 35
ci_037                -1.247363e-02 3 1  ON 36
ci_038                 2.350932e-03 3 1  ON 37
ci_039                 1.751447e-03 3 1  ON 38
ci_040                -3.290279e-03 3 1  ON 39
ci_041                 8.611090e-03 3 1  ON 40
ci_042                 8.492514e-03 3 1  ON 41
ci_043                -4.127997e-03 3 1  ON 42
ci_044                -4.753402e-03 3 1  ON 43
ci_045                -2.772550e-03 3 1  ON 44
ci_046                 5.219556e-03 3 1  ON 45
ci_047                 5.389319e-03 3 1  ON 46
ci_048                -1.312351e-02 3 1  ON 47
ci_049                -1.251066e-02 3 1  ON 48
ci_050                 1.954544e-03 3 1  ON 49
ci_051                 4.225267e-03 3 1  ON 50
ci_052                -3.158700e-03 3 1  ON 51
ci_053                -1.518561e-03 3 1  ON 52
ci_054                -3.169488e-03 3 1  ON 53
ci_055                -3.366648e-03 3 1  ON 54
ci_056                 5.418196e-03 3 1  ON 55
ci_057                 6.426272e-03 3 1  ON 56
ci_058                -2.054844e-03 3 1  ON 57
ci_059                -2.085662e-03 3 1  ON 58
ci_060                 4.903265e-03 3 1  ON 59
ci_061                 4.471888e-03 3 1  ON 60
ci_062                -4.221655e-03 3 1  ON 61
ci_063                -4.003129e-03 3 1  ON 62
ci_064                -3.672420e-03 3 1  ON 63
ci_065                -4.044171e-03 3 1  ON 64
ci_066                 3.780931e-03 3 1  ON 65
ci_067                 4.482235e-03 3 1  ON 66
ci_068                -5.920539e-03 3 1  ON 67
ci_069                -3.988199e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9339e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.2155
    reference variance = 0.260749
====================================================
  Execution time = 1.3835e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5304e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8826e-01
  Total weights = 1.957175495e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4870e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273237130232
                                         uncertainty =       0.001549453088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273237130232
                                         uncertainty =       0.001549453088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369668209
  error estimate for blocks of size 2^( 2) =       0.000383252721
  error estimate for blocks of size 2^( 3) =       0.000395711350
  error estimate for blocks of size 2^( 4) =       0.000404274449
  error estimate for blocks of size 2^( 5) =       0.000409929511
  error estimate for blocks of size 2^( 6) =       0.000413820458
  error estimate for blocks of size 2^( 7) =       0.000413894058

      target function =      -0.915685726477
              le_mean =     -17.211468133906
             les_mean =     296.522892826747
             stat err =       0.000410479619
             autocorr =       1.232988395235
   target nu stat err =       0.000410479619
   target dn stat err =       0.003856633640
      target stat err =       0.005043982676
              std dev =       0.522789795198
             le_variance =       0.273309169964


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721146813391e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-05, overlap shift 9.5367e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915712709685       residual = 2.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916570850682       residual = 2.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916748592041       residual = 8.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916799443234       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916807626508       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916808707293       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916808033618       residual = 2.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916807462014       residual = 8.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916807022672       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916807056336       residual = 4.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916807137065       residual = 1.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916807166574       residual = 2.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-05 is 2.528200e-03

solving harmonic davidson linear method for identity shift 3.8147e-04, overlap shift 3.8147e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915712709685       residual = 2.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916567773173       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916744716274       residual = 8.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916795273532       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916803397114       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916804473016       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916803798450       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916803231815       residual = 8.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916802795451       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916802829046       residual = 4.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916802909023       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916802938307       residual = 2.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-04 is 2.517906e-03

solving harmonic davidson linear method for identity shift 1.5259e-03, overlap shift 1.5259e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915712709685       residual = 2.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916555680526       residual = 2.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916729499340       residual = 8.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916778911860       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916786803965       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916787860853       residual = 1.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916787183402       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916786635850       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916786211109       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916786244407       residual = 3.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916786321496       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916786349901       residual = 2.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-03 is 2.477557e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.317750 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6332e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_001                -4.178924e-02 3 1  ON 0
ci_002                -3.330616e-02 3 1  ON 1
ci_003                -2.663725e-02 3 1  ON 2
ci_004                 2.294428e-02 3 1  ON 3
ci_005                 2.349892e-02 3 1  ON 4
ci_006                -2.159513e-02 3 1  ON 5
ci_007                -2.179050e-02 3 1  ON 6
ci_008                -8.574541e-03 3 1  ON 7
ci_009                -1.436012e-02 3 1  ON 8
ci_010                -9.914531e-03 3 1  ON 9
ci_011                -1.141799e-02 3 1  ON 10
ci_012                -1.008015e-02 3 1  ON 11
ci_013                -2.041529e-02 3 1  ON 12
ci_014                 1.254629e-02 3 1  ON 13
ci_015                 1.346790e-02 3 1  ON 14
ci_016                 1.765348e-02 3 1  ON 15
ci_017                 1.693776e-02 3 1  ON 16
ci_018                 1.067123e-02 3 1  ON 17
ci_019                 1.122578e-02 3 1  ON 18
ci_020                 1.705293e-02 3 1  ON 19
ci_021                 1.788908e-02 3 1  ON 20
ci_022                 9.870727e-03 3 1  ON 21
ci_023                 7.693854e-03 3 1  ON 22
ci_024                 9.014378e-03 3 1  ON 23
ci_025                 9.197925e-03 3 1  ON 24
ci_026                 1.239599e-02 3 1  ON 25
ci_027                 1.216002e-02 3 1  ON 26
ci_028                -1.539310e-02 3 1  ON 27
ci_029                -1.765063e-02 3 1  ON 28
ci_030                -8.658817e-03 3 1  ON 29
ci_031                -9.836727e-03 3 1  ON 30
ci_032                -1.524323e-02 3 1  ON 31
ci_033                 5.040308e-03 3 1  ON 32
ci_034                 5.934675e-03 3 1  ON 33
ci_035                -5.213648e-03 3 1  ON 34
ci_036                -1.320629e-02 3 1  ON 35
ci_037                -1.274599e-02 3 1  ON 36
ci_038                 2.069752e-03 3 1  ON 37
ci_039                 2.271283e-03 3 1  ON 38
ci_040                -2.441678e-03 3 1  ON 39
ci_041                 8.589397e-03 3 1  ON 40
ci_042                 9.750209e-03 3 1  ON 41
ci_043                -4.458559e-03 3 1  ON 42
ci_044                -4.379073e-03 3 1  ON 43
ci_045                -3.157444e-03 3 1  ON 44
ci_046                 5.723904e-03 3 1  ON 45
ci_047                 6.288170e-03 3 1  ON 46
ci_048                -1.461612e-02 3 1  ON 47
ci_049                -1.291966e-02 3 1  ON 48
ci_050                 3.042698e-03 3 1  ON 49
ci_051                 3.159650e-03 3 1  ON 50
ci_052                -2.352648e-03 3 1  ON 51
ci_053                -2.581179e-03 3 1  ON 52
ci_054                -2.764299e-03 3 1  ON 53
ci_055                -3.396539e-03 3 1  ON 54
ci_056                 5.786409e-03 3 1  ON 55
ci_057                 6.036978e-03 3 1  ON 56
ci_058                -2.585412e-03 3 1  ON 57
ci_059                -2.667409e-03 3 1  ON 58
ci_060                 4.183240e-03 3 1  ON 59
ci_061                 5.339288e-03 3 1  ON 60
ci_062                -4.087928e-03 3 1  ON 61
ci_063                -3.722928e-03 3 1  ON 62
ci_064                -2.849476e-03 3 1  ON 63
ci_065                -4.381928e-03 3 1  ON 64
ci_066                 4.578592e-03 3 1  ON 65
ci_067                 4.803052e-03 3 1  ON 66
ci_068                -5.998895e-03 3 1  ON 67
ci_069                -5.791514e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.2283
    reference variance = 0.399351
====================================================
  Execution time = 1.3634e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9122e-01
  Total weights = 1.9571e+06
  Execution time = 1.8387e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279627827344
                                         uncertainty =       0.001550600888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279627827344
                                         uncertainty =       0.001550600888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373884478
  error estimate for blocks of size 2^( 2) =       0.000387658501
  error estimate for blocks of size 2^( 3) =       0.000399813812
  error estimate for blocks of size 2^( 4) =       0.000409145137
  error estimate for blocks of size 2^( 5) =       0.000415914571
  error estimate for blocks of size 2^( 6) =       0.000419183385
  error estimate for blocks of size 2^( 7) =       0.000420916296

      target function =      -0.897610188404
              le_mean =     -17.212026710032
             les_mean =     296.556396454865
             stat err =       0.000416289847
             autocorr =       1.239700470715
   target nu stat err =       0.000416289847
   target dn stat err =       0.005245095473
      target stat err =       0.006579067952
              std dev =       0.528752500049
             le_variance =       0.279579206308

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278992899201
                                         uncertainty =       0.001499213499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278992899201
                                         uncertainty =       0.001499213499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373461050
  error estimate for blocks of size 2^( 2) =       0.000387176562
  error estimate for blocks of size 2^( 3) =       0.000399227900
  error estimate for blocks of size 2^( 4) =       0.000408540178
  error estimate for blocks of size 2^( 5) =       0.000415265012
  error estimate for blocks of size 2^( 6) =       0.000418537065
  error estimate for blocks of size 2^( 7) =       0.000420182637

      target function =      -0.911969403194
              le_mean =     -17.211916634215
             les_mean =     296.541305095016
             stat err =       0.000415631223
             autocorr =       1.238584674435
   target nu stat err =       0.000415631223
   target dn stat err =       0.002233541408
      target stat err =       0.002939435365
              std dev =       0.528153682549
             le_variance =       0.278946312390

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294172824915
                                         uncertainty =       0.012084904581

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294172824915
                                         uncertainty =       0.012084904581

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383475394
  error estimate for blocks of size 2^( 2) =       0.000396842880
  error estimate for blocks of size 2^( 3) =       0.000408521946
  error estimate for blocks of size 2^( 4) =       0.000417629249
  error estimate for blocks of size 2^( 5) =       0.000423915169
  error estimate for blocks of size 2^( 6) =       0.000427058431
  error estimate for blocks of size 2^( 7) =       0.000427829838

      target function =      -0.045890502323
              le_mean =     -17.211999274983
             les_mean =     303.579523337101
             stat err =       0.000424108172
             autocorr =       1.223145935920
   target nu stat err =       0.000424108172
   target dn stat err =       6.993616609897
      target stat err =       0.041451765003
              std dev =       0.542316102735
             le_variance =       0.294106755286

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278980978132
                                         uncertainty =       0.001499066694

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278980978132
                                         uncertainty =       0.001499066694

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373453069
  error estimate for blocks of size 2^( 2) =       0.000387170067
  error estimate for blocks of size 2^( 3) =       0.000399223147
  error estimate for blocks of size 2^( 4) =       0.000408536529
  error estimate for blocks of size 2^( 5) =       0.000415262737
  error estimate for blocks of size 2^( 6) =       0.000418535023
  error estimate for blocks of size 2^( 7) =       0.000420183059

      target function =      -0.911859095343
              le_mean =     -17.211915882127
             les_mean =     296.541364624157
             stat err =       0.000415629337
             autocorr =       1.238626377486
   target nu stat err =       0.000415629337
   target dn stat err =       0.002232299099
      target stat err =       0.002937165363
              std dev =       0.528142394493
             le_variance =       0.278934388861


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.897610188404        initial
     9.5367e-05     9.5367e-04             2.5282e-03        -0.911969403194  <--
     3.8147e-04     3.8147e-03             2.5179e-03        -0.045890502323
     1.5259e-03     1.5259e-02             2.4776e-03        -0.911859095343

*****************************************************************************
Applying the update for shift_i =   9.5367e-05     and shift_s =   9.5367e-04
*****************************************************************************

  Execution time = 2.2922e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_001                -4.179047e-02 3 1  ON 0
ci_002                -3.330665e-02 3 1  ON 1
ci_003                -2.663718e-02 3 1  ON 2
ci_004                 2.293866e-02 3 1  ON 3
ci_005                 2.349115e-02 3 1  ON 4
ci_006                -2.159845e-02 3 1  ON 5
ci_007                -2.179224e-02 3 1  ON 6
ci_008                -8.571965e-03 3 1  ON 7
ci_009                -1.435904e-02 3 1  ON 8
ci_010                -9.924824e-03 3 1  ON 9
ci_011                -1.142095e-02 3 1  ON 10
ci_012                -1.008109e-02 3 1  ON 11
ci_013                -2.041892e-02 3 1  ON 12
ci_014                 1.254386e-02 3 1  ON 13
ci_015                 1.347675e-02 3 1  ON 14
ci_016                 1.765754e-02 3 1  ON 15
ci_017                 1.693425e-02 3 1  ON 16
ci_018                 1.067085e-02 3 1  ON 17
ci_019                 1.122820e-02 3 1  ON 18
ci_020                 1.705124e-02 3 1  ON 19
ci_021                 1.789211e-02 3 1  ON 20
ci_022                 9.860038e-03 3 1  ON 21
ci_023                 7.683768e-03 3 1  ON 22
ci_024                 9.015953e-03 3 1  ON 23
ci_025                 9.199014e-03 3 1  ON 24
ci_026                 1.239921e-02 3 1  ON 25
ci_027                 1.216201e-02 3 1  ON 26
ci_028                -1.540085e-02 3 1  ON 27
ci_029                -1.765737e-02 3 1  ON 28
ci_030                -8.655075e-03 3 1  ON 29
ci_031                -9.836521e-03 3 1  ON 30
ci_032                -1.524367e-02 3 1  ON 31
ci_033                 5.044140e-03 3 1  ON 32
ci_034                 5.937075e-03 3 1  ON 33
ci_035                -5.208661e-03 3 1  ON 34
ci_036                -1.320552e-02 3 1  ON 35
ci_037                -1.274679e-02 3 1  ON 36
ci_038                 2.068688e-03 3 1  ON 37
ci_039                 2.273230e-03 3 1  ON 38
ci_040                -2.438596e-03 3 1  ON 39
ci_041                 8.589987e-03 3 1  ON 40
ci_042                 9.755445e-03 3 1  ON 41
ci_043                -4.459812e-03 3 1  ON 42
ci_044                -4.377538e-03 3 1  ON 43
ci_045                -3.158876e-03 3 1  ON 44
ci_046                 5.726031e-03 3 1  ON 45
ci_047                 6.291937e-03 3 1  ON 46
ci_048                -1.462272e-02 3 1  ON 47
ci_049                -1.292165e-02 3 1  ON 48
ci_050                 3.046459e-03 3 1  ON 49
ci_051                 3.155952e-03 3 1  ON 50
ci_052                -2.350260e-03 3 1  ON 51
ci_053                -2.585770e-03 3 1  ON 52
ci_054                -2.762635e-03 3 1  ON 53
ci_055                -3.396205e-03 3 1  ON 54
ci_056                 5.787833e-03 3 1  ON 55
ci_057                 6.035497e-03 3 1  ON 56
ci_058                -2.586813e-03 3 1  ON 57
ci_059                -2.669720e-03 3 1  ON 58
ci_060                 4.180386e-03 3 1  ON 59
ci_061                 5.343067e-03 3 1  ON 60
ci_062                -4.087519e-03 3 1  ON 61
ci_063                -3.721930e-03 3 1  ON 62
ci_064                -2.846500e-03 3 1  ON 63
ci_065                -4.383183e-03 3 1  ON 64
ci_066                 4.581544e-03 3 1  ON 65
ci_067                 4.804179e-03 3 1  ON 66
ci_068                -5.999282e-03 3 1  ON 67
ci_069                -5.799212e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9260e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.1477
    reference variance = 0.339533
====================================================
  Execution time = 1.6451e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8551e-01
  Total weights = 1.957265708e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4658e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275427482263
                                         uncertainty =       0.001917917896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275427482263
                                         uncertainty =       0.001917917896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371053875
  error estimate for blocks of size 2^( 2) =       0.000385158466
  error estimate for blocks of size 2^( 3) =       0.000397787220
  error estimate for blocks of size 2^( 4) =       0.000406599654
  error estimate for blocks of size 2^( 5) =       0.000411605637
  error estimate for blocks of size 2^( 6) =       0.000414028400
  error estimate for blocks of size 2^( 7) =       0.000416462517

      target function =      -0.919484102567
              le_mean =     -17.212209856090
             les_mean =     296.545677694431
             stat err =       0.000412174052
             autocorr =       1.233920991514
   target nu stat err =       0.000412174052
   target dn stat err =       0.002288022558
      target stat err =       0.003057573911
              std dev =       0.524749422493
             le_variance =       0.275361956407


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721220985609e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-05, overlap shift 2.3842e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919493489821       residual = 9.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920003594922       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920113902787       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920152502588       residual = 9.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920163330466       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920168471849       residual = 4.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920168108310       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920167711695       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920167655644       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920167602831       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920167576901       residual = 8.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-05 is 2.268140e-03

solving harmonic davidson linear method for identity shift 9.5367e-05, overlap shift 9.5367e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919493489821       residual = 9.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920003127986       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920113306029       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920151849734       residual = 9.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920162659972       residual = 3.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920167791344       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920167428218       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920167032251       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920166976091       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920166923491       residual = 2.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920166897568       residual = 8.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-05 is 2.265621e-03

solving harmonic davidson linear method for identity shift 3.8147e-04, overlap shift 3.8147e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919493489821       residual = 9.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920001268755       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920110930462       residual = 5.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920149251298       residual = 9.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920159991497       residual = 3.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920165083163       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920164721689       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920164328291       residual = 4.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920164271704       residual = 9.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920164219941       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920164194055       residual = 8.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-04 is 2.255604e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.321881 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8927e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_001                -4.234196e-02 3 1  ON 0
ci_002                -3.222573e-02 3 1  ON 1
ci_003                -2.653880e-02 3 1  ON 2
ci_004                 2.425160e-02 3 1  ON 3
ci_005                 2.397775e-02 3 1  ON 4
ci_006                -2.159475e-02 3 1  ON 5
ci_007                -2.147011e-02 3 1  ON 6
ci_008                -8.441801e-03 3 1  ON 7
ci_009                -1.536779e-02 3 1  ON 8
ci_010                -9.098314e-03 3 1  ON 9
ci_011                -1.068414e-02 3 1  ON 10
ci_012                -1.024289e-02 3 1  ON 11
ci_013                -2.052937e-02 3 1  ON 12
ci_014                 1.260879e-02 3 1  ON 13
ci_015                 1.225419e-02 3 1  ON 14
ci_016                 1.650604e-02 3 1  ON 15
ci_017                 1.601786e-02 3 1  ON 16
ci_018                 1.092623e-02 3 1  ON 17
ci_019                 1.002215e-02 3 1  ON 18
ci_020                 1.931686e-02 3 1  ON 19
ci_021                 1.835596e-02 3 1  ON 20
ci_022                 1.037160e-02 3 1  ON 21
ci_023                 9.672903e-03 3 1  ON 22
ci_024                 1.055200e-02 3 1  ON 23
ci_025                 8.505960e-03 3 1  ON 24
ci_026                 1.239307e-02 3 1  ON 25
ci_027                 1.117262e-02 3 1  ON 26
ci_028                -1.561079e-02 3 1  ON 27
ci_029                -1.549318e-02 3 1  ON 28
ci_030                -9.882345e-03 3 1  ON 29
ci_031                -9.370684e-03 3 1  ON 30
ci_032                -1.407015e-02 3 1  ON 31
ci_033                 6.153291e-03 3 1  ON 32
ci_034                 5.032528e-03 3 1  ON 33
ci_035                -5.509938e-03 3 1  ON 34
ci_036                -1.311266e-02 3 1  ON 35
ci_037                -1.354364e-02 3 1  ON 36
ci_038                 2.312862e-03 3 1  ON 37
ci_039                 2.164391e-03 3 1  ON 38
ci_040                -3.401344e-03 3 1  ON 39
ci_041                 8.701515e-03 3 1  ON 40
ci_042                 9.520913e-03 3 1  ON 41
ci_043                -4.257137e-03 3 1  ON 42
ci_044                -4.230348e-03 3 1  ON 43
ci_045                -3.088734e-03 3 1  ON 44
ci_046                 5.580209e-03 3 1  ON 45
ci_047                 5.495340e-03 3 1  ON 46
ci_048                -1.401920e-02 3 1  ON 47
ci_049                -1.227671e-02 3 1  ON 48
ci_050                 3.102594e-03 3 1  ON 49
ci_051                 3.013983e-03 3 1  ON 50
ci_052                -2.191995e-03 3 1  ON 51
ci_053                -2.708321e-03 3 1  ON 52
ci_054                -2.380901e-03 3 1  ON 53
ci_055                -3.392376e-03 3 1  ON 54
ci_056                 5.727199e-03 3 1  ON 55
ci_057                 6.102000e-03 3 1  ON 56
ci_058                -2.379232e-03 3 1  ON 57
ci_059                -2.512680e-03 3 1  ON 58
ci_060                 5.678001e-03 3 1  ON 59
ci_061                 5.279125e-03 3 1  ON 60
ci_062                -4.319602e-03 3 1  ON 61
ci_063                -3.455866e-03 3 1  ON 62
ci_064                -3.034084e-03 3 1  ON 63
ci_065                -4.116293e-03 3 1  ON 64
ci_066                 4.857005e-03 3 1  ON 65
ci_067                 5.072651e-03 3 1  ON 66
ci_068                -5.567819e-03 3 1  ON 67
ci_069                -4.721509e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.2516
    reference variance = 0.289645
====================================================
  Execution time = 1.3617e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8583e-01
  Total weights = 1.9572e+06
  Execution time = 1.8436e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366117057060
                                         uncertainty =       0.088880575672

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.366117057060
                                         uncertainty =       0.088880575672

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000427759050
  error estimate for blocks of size 2^( 2) =       0.000439713936
  error estimate for blocks of size 2^( 3) =       0.000450976854
  error estimate for blocks of size 2^( 4) =       0.000458567080
  error estimate for blocks of size 2^( 5) =       0.000462935920
  error estimate for blocks of size 2^( 6) =       0.000465999373
  error estimate for blocks of size 2^( 7) =       0.000468356830

      target function =      -0.072706743194
              le_mean =     -17.210927206619
             les_mean =     301.090464499571
             stat err =       0.000463964801
             autocorr =       1.176445068527
   target nu stat err =       0.000463964801
   target dn stat err =       4.363222952830
      target stat err =       0.059949275905
              std dev =       0.604942650190
             le_variance =       0.365955610019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274893852931
                                         uncertainty =       0.001653867234

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274893852931
                                         uncertainty =       0.001653867234

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370728535
  error estimate for blocks of size 2^( 2) =       0.000384488977
  error estimate for blocks of size 2^( 3) =       0.000397357031
  error estimate for blocks of size 2^( 4) =       0.000406046575
  error estimate for blocks of size 2^( 5) =       0.000411407655
  error estimate for blocks of size 2^( 6) =       0.000415079161
  error estimate for blocks of size 2^( 7) =       0.000416890706

      target function =      -0.918750464549
              le_mean =     -17.211031637919
             les_mean =     296.505441924066
             stat err =       0.000412356024
             autocorr =       1.237179333036
   target nu stat err =       0.000412356024
   target dn stat err =       0.002200129213
      target stat err =       0.002934626522
              std dev =       0.524289322713
             le_variance =       0.274879293911

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276079443057
                                         uncertainty =       0.001659028645

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276079443057
                                         uncertainty =       0.001659028645

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371526580
  error estimate for blocks of size 2^( 2) =       0.000385325098
  error estimate for blocks of size 2^( 3) =       0.000398193735
  error estimate for blocks of size 2^( 4) =       0.000406914610
  error estimate for blocks of size 2^( 5) =       0.000412252542
  error estimate for blocks of size 2^( 6) =       0.000415894722
  error estimate for blocks of size 2^( 7) =       0.000417620982

      target function =      -0.892296553700
              le_mean =     -17.211120057387
             les_mean =     296.529248689108
             stat err =       0.000413170714
             autocorr =       1.236742490943
   target nu stat err =       0.000413170714
   target dn stat err =       0.008528767320
      target stat err =       0.010532103377
              std dev =       0.525417928125
             le_variance =       0.276063999195

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274891893063
                                         uncertainty =       0.001653951850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274891893063
                                         uncertainty =       0.001653951850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370727214
  error estimate for blocks of size 2^( 2) =       0.000384487554
  error estimate for blocks of size 2^( 3) =       0.000397355611
  error estimate for blocks of size 2^( 4) =       0.000406044961
  error estimate for blocks of size 2^( 5) =       0.000411406198
  error estimate for blocks of size 2^( 6) =       0.000415077809
  error estimate for blocks of size 2^( 7) =       0.000416889520

      target function =      -0.918758617725
              le_mean =     -17.211031690538
             les_mean =     296.505437512125
             stat err =       0.000412354622
             autocorr =       1.237179739292
   target nu stat err =       0.000412354622
   target dn stat err =       0.002199389500
      target stat err =       0.002933730136
              std dev =       0.524287453737
             le_variance =       0.274877334146


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.072706743194        initial  <--
            N/A            N/A                    N/A                    N/A     bad update
            N/A            N/A                    N/A                    N/A     bad update
            N/A            N/A                    N/A                    N/A     bad update

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.5079
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_001                -4.179047e-02 3 1  ON 0
ci_002                -3.330665e-02 3 1  ON 1
ci_003                -2.663718e-02 3 1  ON 2
ci_004                 2.293866e-02 3 1  ON 3
ci_005                 2.349115e-02 3 1  ON 4
ci_006                -2.159845e-02 3 1  ON 5
ci_007                -2.179224e-02 3 1  ON 6
ci_008                -8.571965e-03 3 1  ON 7
ci_009                -1.435904e-02 3 1  ON 8
ci_010                -9.924824e-03 3 1  ON 9
ci_011                -1.142095e-02 3 1  ON 10
ci_012                -1.008109e-02 3 1  ON 11
ci_013                -2.041892e-02 3 1  ON 12
ci_014                 1.254386e-02 3 1  ON 13
ci_015                 1.347675e-02 3 1  ON 14
ci_016                 1.765754e-02 3 1  ON 15
ci_017                 1.693425e-02 3 1  ON 16
ci_018                 1.067085e-02 3 1  ON 17
ci_019                 1.122820e-02 3 1  ON 18
ci_020                 1.705124e-02 3 1  ON 19
ci_021                 1.789211e-02 3 1  ON 20
ci_022                 9.860038e-03 3 1  ON 21
ci_023                 7.683768e-03 3 1  ON 22
ci_024                 9.015953e-03 3 1  ON 23
ci_025                 9.199014e-03 3 1  ON 24
ci_026                 1.239921e-02 3 1  ON 25
ci_027                 1.216201e-02 3 1  ON 26
ci_028                -1.540085e-02 3 1  ON 27
ci_029                -1.765737e-02 3 1  ON 28
ci_030                -8.655075e-03 3 1  ON 29
ci_031                -9.836521e-03 3 1  ON 30
ci_032                -1.524367e-02 3 1  ON 31
ci_033                 5.044140e-03 3 1  ON 32
ci_034                 5.937075e-03 3 1  ON 33
ci_035                -5.208661e-03 3 1  ON 34
ci_036                -1.320552e-02 3 1  ON 35
ci_037                -1.274679e-02 3 1  ON 36
ci_038                 2.068688e-03 3 1  ON 37
ci_039                 2.273230e-03 3 1  ON 38
ci_040                -2.438596e-03 3 1  ON 39
ci_041                 8.589987e-03 3 1  ON 40
ci_042                 9.755445e-03 3 1  ON 41
ci_043                -4.459812e-03 3 1  ON 42
ci_044                -4.377538e-03 3 1  ON 43
ci_045                -3.158876e-03 3 1  ON 44
ci_046                 5.726031e-03 3 1  ON 45
ci_047                 6.291937e-03 3 1  ON 46
ci_048                -1.462272e-02 3 1  ON 47
ci_049                -1.292165e-02 3 1  ON 48
ci_050                 3.046459e-03 3 1  ON 49
ci_051                 3.155952e-03 3 1  ON 50
ci_052                -2.350260e-03 3 1  ON 51
ci_053                -2.585770e-03 3 1  ON 52
ci_054                -2.762635e-03 3 1  ON 53
ci_055                -3.396205e-03 3 1  ON 54
ci_056                 5.787833e-03 3 1  ON 55
ci_057                 6.035497e-03 3 1  ON 56
ci_058                -2.586813e-03 3 1  ON 57
ci_059                -2.669720e-03 3 1  ON 58
ci_060                 4.180386e-03 3 1  ON 59
ci_061                 5.343067e-03 3 1  ON 60
ci_062                -4.087519e-03 3 1  ON 61
ci_063                -3.721930e-03 3 1  ON 62
ci_064                -2.846500e-03 3 1  ON 63
ci_065                -4.383183e-03 3 1  ON 64
ci_066                 4.581544e-03 3 1  ON 65
ci_067                 4.804179e-03 3 1  ON 66
ci_068                -5.999282e-03 3 1  ON 67
ci_069                -5.799212e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2440e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.1807
    reference variance = 0.207611
====================================================
  Execution time = 1.4061e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.0124e-01
  Total weights = 1.957249226e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4708e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280459145890
                                         uncertainty =       0.002105358442

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280459145890
                                         uncertainty =       0.002105358442

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374475334
  error estimate for blocks of size 2^( 2) =       0.000388348413
  error estimate for blocks of size 2^( 3) =       0.000400988639
  error estimate for blocks of size 2^( 4) =       0.000409942783
  error estimate for blocks of size 2^( 5) =       0.000415748785
  error estimate for blocks of size 2^( 6) =       0.000418358602
  error estimate for blocks of size 2^( 7) =       0.000416768531

      target function =      -0.899250349801
              le_mean =     -17.212571401536
             les_mean =     296.573858190423
             stat err =       0.000415204675
             autocorr =       1.229357053952
   target nu stat err =       0.000415204675
   target dn stat err =       0.009011429472
      target stat err =       0.011326120379
              std dev =       0.529588095578
             le_variance =       0.280463550978


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721257140154e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-04, overlap shift 2.3842e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.899392348050       residual = 4.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901214504225       residual = 5.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901524068781       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901641324127       residual = 3.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901669246266       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901681693660       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901685386526       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901687094688       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901687386400       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901687391295       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.901687338658       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.901687289875       residual = 7.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-04 is 4.042927e-03

solving harmonic davidson linear method for identity shift 9.5367e-04, overlap shift 9.5367e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.899392348050       residual = 4.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901198174308       residual = 5.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901504322465       residual = 1.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901619991768       residual = 3.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901647488275       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901659722766       residual = 3.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901663331018       residual = 5.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901665003481       residual = 1.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901665286945       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901665290953       residual = 1.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.901665238853       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.901665191561       residual = 7.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-04 is 4.001283e-03

solving harmonic davidson linear method for identity shift 3.8147e-03, overlap shift 3.8147e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.899392348050       residual = 4.50e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901135674337       residual = 5.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901428863421       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901538573386       residual = 3.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901564481082       residual = 9.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901575925728       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901579224731       residual = 5.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901580766467       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901581020307       residual = 3.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901581021242       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.901580971289       residual = 3.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.901580929339       residual = 6.30e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-03 is 3.842949e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.326691 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6542e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_001                -4.199495e-02 3 1  ON 0
ci_002                -3.286200e-02 3 1  ON 1
ci_003                -2.633934e-02 3 1  ON 2
ci_004                 2.334906e-02 3 1  ON 3
ci_005                 2.308427e-02 3 1  ON 4
ci_006                -2.118554e-02 3 1  ON 5
ci_007                -2.234988e-02 3 1  ON 6
ci_008                -8.724491e-03 3 1  ON 7
ci_009                -1.521568e-02 3 1  ON 8
ci_010                -7.825637e-03 3 1  ON 9
ci_011                -9.662820e-03 3 1  ON 10
ci_012                -1.169215e-02 3 1  ON 11
ci_013                -2.093052e-02 3 1  ON 12
ci_014                 1.077006e-02 3 1  ON 13
ci_015                 1.205793e-02 3 1  ON 14
ci_016                 1.866936e-02 3 1  ON 15
ci_017                 1.703068e-02 3 1  ON 16
ci_018                 9.986833e-03 3 1  ON 17
ci_019                 1.093825e-02 3 1  ON 18
ci_020                 1.832013e-02 3 1  ON 19
ci_021                 1.712002e-02 3 1  ON 20
ci_022                 1.213060e-02 3 1  ON 21
ci_023                 9.755226e-03 3 1  ON 22
ci_024                 9.841016e-03 3 1  ON 23
ci_025                 1.110894e-02 3 1  ON 24
ci_026                 1.291143e-02 3 1  ON 25
ci_027                 1.211043e-02 3 1  ON 26
ci_028                -1.354387e-02 3 1  ON 27
ci_029                -1.572384e-02 3 1  ON 28
ci_030                -8.564884e-03 3 1  ON 29
ci_031                -1.287567e-02 3 1  ON 30
ci_032                -1.535497e-02 3 1  ON 31
ci_033                 6.119267e-03 3 1  ON 32
ci_034                 5.229784e-03 3 1  ON 33
ci_035                -5.030742e-03 3 1  ON 34
ci_036                -1.368904e-02 3 1  ON 35
ci_037                -1.355003e-02 3 1  ON 36
ci_038                 2.496911e-03 3 1  ON 37
ci_039                 1.946298e-03 3 1  ON 38
ci_040                -3.946915e-03 3 1  ON 39
ci_041                 7.982995e-03 3 1  ON 40
ci_042                 1.044391e-02 3 1  ON 41
ci_043                -4.280637e-03 3 1  ON 42
ci_044                -5.403609e-03 3 1  ON 43
ci_045                -3.010634e-03 3 1  ON 44
ci_046                 6.042262e-03 3 1  ON 45
ci_047                 5.783764e-03 3 1  ON 46
ci_048                -1.268899e-02 3 1  ON 47
ci_049                -9.504095e-03 3 1  ON 48
ci_050                 4.547067e-03 3 1  ON 49
ci_051                 2.670214e-03 3 1  ON 50
ci_052                -2.988576e-03 3 1  ON 51
ci_053                -3.267555e-03 3 1  ON 52
ci_054                -3.079425e-03 3 1  ON 53
ci_055                -2.794591e-03 3 1  ON 54
ci_056                 3.318253e-03 3 1  ON 55
ci_057                 5.974505e-03 3 1  ON 56
ci_058                -2.370599e-03 3 1  ON 57
ci_059                -1.035952e-03 3 1  ON 58
ci_060                 5.102766e-03 3 1  ON 59
ci_061                 2.571012e-03 3 1  ON 60
ci_062                -3.674626e-03 3 1  ON 61
ci_063                -3.877903e-03 3 1  ON 62
ci_064                -2.868195e-03 3 1  ON 63
ci_065                -4.335424e-03 3 1  ON 64
ci_066                 5.402195e-03 3 1  ON 65
ci_067                 5.068172e-03 3 1  ON 66
ci_068                -5.102315e-03 3 1  ON 67
ci_069                -1.797929e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.1667
    reference variance = 0.35918
====================================================
  Execution time = 1.3549e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.9039e-01
  Total weights = 1.9572e+06
  Execution time = 1.8351e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000503219
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.386743773510
                                         uncertainty =       0.097439193571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.386743773510
                                         uncertainty =       0.097439193571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000439708234
  error estimate for blocks of size 2^( 2) =       0.000451431491
  error estimate for blocks of size 2^( 3) =       0.000461940762
  error estimate for blocks of size 2^( 4) =       0.000470215822
  error estimate for blocks of size 2^( 5) =       0.000475655305
  error estimate for blocks of size 2^( 6) =       0.000478120624
  error estimate for blocks of size 2^( 7) =       0.000478054754

      target function =      -0.119693240255
              le_mean =     -17.211141111715
             les_mean =     299.301345668433
             stat err =       0.000475511626
             autocorr =       1.169480762322
   target nu stat err =       0.000475511626
   target dn stat err =       2.578777164648
      target stat err =       0.088315921993
              std dev =       0.621841348587
             le_variance =       0.386686662812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277144622260
                                         uncertainty =       0.002007309562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277144622260
                                         uncertainty =       0.002007309562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372325233
  error estimate for blocks of size 2^( 2) =       0.000386196925
  error estimate for blocks of size 2^( 3) =       0.000398712004
  error estimate for blocks of size 2^( 4) =       0.000408300346
  error estimate for blocks of size 2^( 5) =       0.000414404232
  error estimate for blocks of size 2^( 6) =       0.000416679688
  error estimate for blocks of size 2^( 7) =       0.000417206886

      target function =      -0.912783103895
              le_mean =     -17.211068466131
             les_mean =     296.511305699147
             stat err =       0.000414147788
             autocorr =       1.237273615579
   target nu stat err =       0.000414147788
   target dn stat err =       0.003128318648
      target stat err =       0.004078039702
              std dev =       0.526547394737
             le_variance =       0.277252158904

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000500569
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301066996762
                                         uncertainty =       0.013952571081

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.301066996762
                                         uncertainty =       0.013952571081

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388028389
  error estimate for blocks of size 2^( 2) =       0.000401424177
  error estimate for blocks of size 2^( 3) =       0.000413498293
  error estimate for blocks of size 2^( 4) =       0.000422831694
  error estimate for blocks of size 2^( 5) =       0.000428849364
  error estimate for blocks of size 2^( 6) =       0.000430906573
  error estimate for blocks of size 2^( 7) =       0.000431804102

      target function =      -0.468810071214
              le_mean =     -17.211404301240
             les_mean =     297.088155590421
             stat err =       0.000428597933
             autocorr =       1.220037396491
   target nu stat err =       0.000428597933
   target dn stat err =       0.364721525509
      target stat err =       0.134381420907
              std dev =       0.548755010444
             le_variance =       0.301132061487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277035353947
                                         uncertainty =       0.002012566152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277035353947
                                         uncertainty =       0.002012566152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372251889
  error estimate for blocks of size 2^( 2) =       0.000386120321
  error estimate for blocks of size 2^( 3) =       0.000398634717
  error estimate for blocks of size 2^( 4) =       0.000408224162
  error estimate for blocks of size 2^( 5) =       0.000414324906
  error estimate for blocks of size 2^( 6) =       0.000416596283
  error estimate for blocks of size 2^( 7) =       0.000417114852

      target function =      -0.912466322225
              le_mean =     -17.211069604735
             les_mean =     296.511590711399
             stat err =       0.000414065051
             autocorr =       1.237266712435
   target nu stat err =       0.000414065051
   target dn stat err =       0.003133059587
      target stat err =       0.004081278195
              std dev =       0.526443670593
             le_variance =       0.277142938307


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.119693240255        initial
     2.3842e-04     2.3842e-03             4.0429e-03        -0.912783103895  <--
     9.5367e-04     9.5367e-03             4.0013e-03        -0.468810071214
     3.8147e-03     3.8147e-02             3.8429e-03        -0.912466322225

*****************************************************************************
Applying the update for shift_i =   2.3842e-04     and shift_s =   2.3842e-03
*****************************************************************************

  Execution time = 2.2797e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_001                -4.199812e-02 3 1  ON 0
ci_002                -3.285732e-02 3 1  ON 1
ci_003                -2.633866e-02 3 1  ON 2
ci_004                 2.335500e-02 3 1  ON 3
ci_005                 2.307966e-02 3 1  ON 4
ci_006                -2.118136e-02 3 1  ON 5
ci_007                -2.235700e-02 3 1  ON 6
ci_008                -8.726564e-03 3 1  ON 7
ci_009                -1.522428e-02 3 1  ON 8
ci_010                -7.803865e-03 3 1  ON 9
ci_011                -9.645375e-03 3 1  ON 10
ci_012                -1.170890e-02 3 1  ON 11
ci_013                -2.093628e-02 3 1  ON 12
ci_014                 1.075232e-02 3 1  ON 13
ci_015                 1.204232e-02 3 1  ON 14
ci_016                 1.868109e-02 3 1  ON 15
ci_017                 1.703238e-02 3 1  ON 16
ci_018                 9.980083e-03 3 1  ON 17
ci_019                 1.093703e-02 3 1  ON 18
ci_020                 1.833570e-02 3 1  ON 19
ci_021                 1.711144e-02 3 1  ON 20
ci_022                 1.215539e-02 3 1  ON 21
ci_023                 9.777685e-03 3 1  ON 22
ci_024                 9.850130e-03 3 1  ON 23
ci_025                 1.113090e-02 3 1  ON 24
ci_026                 1.291681e-02 3 1  ON 25
ci_027                 1.210976e-02 3 1  ON 26
ci_028                -1.352180e-02 3 1  ON 27
ci_029                -1.570187e-02 3 1  ON 28
ci_030                -8.561503e-03 3 1  ON 29
ci_031                -1.290082e-02 3 1  ON 30
ci_032                -1.535592e-02 3 1  ON 31
ci_033                 6.131051e-03 3 1  ON 32
ci_034                 5.222611e-03 3 1  ON 33
ci_035                -5.029165e-03 3 1  ON 34
ci_036                -1.369436e-02 3 1  ON 35
ci_037                -1.355824e-02 3 1  ON 36
ci_038                 2.500959e-03 3 1  ON 37
ci_039                 1.943290e-03 3 1  ON 38
ci_040                -3.960771e-03 3 1  ON 39
ci_041                 7.975725e-03 3 1  ON 40
ci_042                 1.044841e-02 3 1  ON 41
ci_043                -4.278874e-03 3 1  ON 42
ci_044                -5.413985e-03 3 1  ON 43
ci_045                -3.009293e-03 3 1  ON 44
ci_046                 6.045552e-03 3 1  ON 45
ci_047                 5.778351e-03 3 1  ON 46
ci_048                -1.266579e-02 3 1  ON 47
ci_049                -9.467409e-03 3 1  ON 48
ci_050                 4.559692e-03 3 1  ON 49
ci_051                 2.666159e-03 3 1  ON 50
ci_052                -2.993321e-03 3 1  ON 51
ci_053                -3.271498e-03 3 1  ON 52
ci_054                -3.084878e-03 3 1  ON 53
ci_055                -2.788887e-03 3 1  ON 54
ci_056                 3.294529e-03 3 1  ON 55
ci_057                 5.973874e-03 3 1  ON 56
ci_058                -2.369866e-03 3 1  ON 57
ci_059                -1.022541e-03 3 1  ON 58
ci_060                 5.112493e-03 3 1  ON 59
ci_061                 2.541543e-03 3 1  ON 60
ci_062                -3.670777e-03 3 1  ON 61
ci_063                -3.880531e-03 3 1  ON 62
ci_064                -2.868318e-03 3 1  ON 63
ci_065                -4.335007e-03 3 1  ON 64
ci_066                 5.409709e-03 3 1  ON 65
ci_067                 5.070987e-03 3 1  ON 66
ci_068                -5.092503e-03 3 1  ON 67
ci_069                -1.756285e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9350e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2367
    reference variance = 0.221446
====================================================
  Execution time = 1.4059e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5308e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9291e-01
  Total weights = 1.956772323e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4722e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278222029899
                                         uncertainty =       0.001677136339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278222029899
                                         uncertainty =       0.001677136339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372945580
  error estimate for blocks of size 2^( 2) =       0.000387199345
  error estimate for blocks of size 2^( 3) =       0.000399861439
  error estimate for blocks of size 2^( 4) =       0.000408386277
  error estimate for blocks of size 2^( 5) =       0.000412521845
  error estimate for blocks of size 2^( 6) =       0.000416191082
  error estimate for blocks of size 2^( 7) =       0.000416827114

      target function =      -0.909746739371
              le_mean =     -17.211667748991
             les_mean =     296.534413688178
             stat err =       0.000413481579
             autocorr =       1.229196755771
   target nu stat err =       0.000413481579
   target dn stat err =       0.002823357223
      target stat err =       0.003668164826
              std dev =       0.527424696620
             le_variance =       0.278176810605


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721166774899e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-05, overlap shift 5.9605e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909760863453       residual = 4.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912137147140       residual = 4.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912501523582       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912573827614       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912596560649       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912607215821       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912612269139       residual = 7.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912612092104       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912612456000       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912612535896       residual = 9.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912612611346       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912612565553       residual = 3.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-05 is 4.467230e-03

solving harmonic davidson linear method for identity shift 2.3842e-04, overlap shift 2.3842e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909760863453       residual = 4.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912131684201       residual = 4.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912494983922       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912567025681       residual = 3.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912589663198       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912600271608       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912605299447       residual = 7.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912605122014       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912605483697       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912605563097       residual = 9.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912605638075       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912605592447       residual = 3.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-04 is 4.454928e-03

solving harmonic davidson linear method for identity shift 9.5367e-04, overlap shift 9.5367e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909760863453       residual = 4.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912110080597       residual = 4.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912469134282       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912540144327       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912562406842       residual = 1.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912572831843       residual = 3.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912577759934       residual = 7.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912577581026       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912577934074       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912578011541       residual = 9.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912578084675       residual = 2.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912578039700       residual = 3.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-04 is 4.406401e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.336608 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6549e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_001                -4.075882e-02 3 1  ON 0
ci_002                -3.304319e-02 3 1  ON 1
ci_003                -2.562467e-02 3 1  ON 2
ci_004                 2.379445e-02 3 1  ON 3
ci_005                 2.554398e-02 3 1  ON 4
ci_006                -2.224597e-02 3 1  ON 5
ci_007                -2.227769e-02 3 1  ON 6
ci_008                -8.913401e-03 3 1  ON 7
ci_009                -1.410392e-02 3 1  ON 8
ci_010                -1.172049e-02 3 1  ON 9
ci_011                -1.135175e-02 3 1  ON 10
ci_012                -1.057117e-02 3 1  ON 11
ci_013                -1.990718e-02 3 1  ON 12
ci_014                 1.314146e-02 3 1  ON 13
ci_015                 1.208485e-02 3 1  ON 14
ci_016                 1.694807e-02 3 1  ON 15
ci_017                 1.643237e-02 3 1  ON 16
ci_018                 1.229768e-02 3 1  ON 17
ci_019                 1.097743e-02 3 1  ON 18
ci_020                 1.808062e-02 3 1  ON 19
ci_021                 1.859616e-02 3 1  ON 20
ci_022                 9.178912e-03 3 1  ON 21
ci_023                 1.013846e-02 3 1  ON 22
ci_024                 1.005937e-02 3 1  ON 23
ci_025                 9.985386e-03 3 1  ON 24
ci_026                 1.134740e-02 3 1  ON 25
ci_027                 1.064292e-02 3 1  ON 26
ci_028                -1.514908e-02 3 1  ON 27
ci_029                -1.594577e-02 3 1  ON 28
ci_030                -8.479312e-03 3 1  ON 29
ci_031                -9.569249e-03 3 1  ON 30
ci_032                -1.434324e-02 3 1  ON 31
ci_033                 5.399352e-03 3 1  ON 32
ci_034                 6.148169e-03 3 1  ON 33
ci_035                -5.701890e-03 3 1  ON 34
ci_036                -1.361973e-02 3 1  ON 35
ci_037                -1.279805e-02 3 1  ON 36
ci_038                 2.031071e-03 3 1  ON 37
ci_039                 2.418673e-03 3 1  ON 38
ci_040                -3.252041e-03 3 1  ON 39
ci_041                 9.104035e-03 3 1  ON 40
ci_042                 7.565099e-03 3 1  ON 41
ci_043                -4.251594e-03 3 1  ON 42
ci_044                -2.319092e-03 3 1  ON 43
ci_045                -2.787758e-03 3 1  ON 44
ci_046                 6.265865e-03 3 1  ON 45
ci_047                 5.700846e-03 3 1  ON 46
ci_048                -1.201181e-02 3 1  ON 47
ci_049                -1.392234e-02 3 1  ON 48
ci_050                 4.280166e-03 3 1  ON 49
ci_051                 2.866923e-03 3 1  ON 50
ci_052                -3.713435e-03 3 1  ON 51
ci_053                -2.496512e-03 3 1  ON 52
ci_054                -2.740552e-03 3 1  ON 53
ci_055                -3.647670e-03 3 1  ON 54
ci_056                 6.142264e-03 3 1  ON 55
ci_057                 5.571448e-03 3 1  ON 56
ci_058                -3.266525e-04 3 1  ON 57
ci_059                -2.281545e-03 3 1  ON 58
ci_060                 5.269284e-03 3 1  ON 59
ci_061                 5.402603e-03 3 1  ON 60
ci_062                -4.099069e-03 3 1  ON 61
ci_063                -3.951540e-03 3 1  ON 62
ci_064                -2.707919e-03 3 1  ON 63
ci_065                -4.140027e-03 3 1  ON 64
ci_066                 4.906751e-03 3 1  ON 65
ci_067                 4.705996e-03 3 1  ON 66
ci_068                -6.379047e-03 3 1  ON 67
ci_069                -6.032935e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.2418
    reference variance = 0.386754
====================================================
  Execution time = 1.3641e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8629e-01
  Total weights = 1.9572e+06
  Execution time = 1.8335e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00316394
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279456753909
                                         uncertainty =       0.001698493846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279456753909
                                         uncertainty =       0.001698493846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373802442
  error estimate for blocks of size 2^( 2) =       0.000387592601
  error estimate for blocks of size 2^( 3) =       0.000399886132
  error estimate for blocks of size 2^( 4) =       0.000408561233
  error estimate for blocks of size 2^( 5) =       0.000414098187
  error estimate for blocks of size 2^( 6) =       0.000416966864
  error estimate for blocks of size 2^( 7) =       0.000418301414

      target function =      -0.899058426895
              le_mean =     -17.212204648283
             les_mean =     296.561404612261
             stat err =       0.000414481925
             autocorr =       1.229495444189
   target nu stat err =       0.000414481925
   target dn stat err =       0.004611476504
      target stat err =       0.005810779105
              std dev =       0.528636482719
             le_variance =       0.279456530862

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276905214569
                                         uncertainty =       0.001739996866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276905214569
                                         uncertainty =       0.001739996866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372094585
  error estimate for blocks of size 2^( 2) =       0.000385780043
  error estimate for blocks of size 2^( 3) =       0.000398023172
  error estimate for blocks of size 2^( 4) =       0.000406700214
  error estimate for blocks of size 2^( 5) =       0.000412197469
  error estimate for blocks of size 2^( 6) =       0.000415121347
  error estimate for blocks of size 2^( 7) =       0.000416498099

      target function =      -0.918352566145
              le_mean =     -17.211859530099
             les_mean =     296.534413335200
             stat err =       0.000412629282
             autocorr =       1.229740253872
   target nu stat err =       0.000412629282
   target dn stat err =       0.002003866094
      target stat err =       0.002685044914
              std dev =       0.526221208473
             le_variance =       0.276908760247

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00320568
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282134913008
                                         uncertainty =       0.001984048649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282134913008
                                         uncertainty =       0.001984048649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375588487
  error estimate for blocks of size 2^( 2) =       0.000389110727
  error estimate for blocks of size 2^( 3) =       0.000401267686
  error estimate for blocks of size 2^( 4) =       0.000409872006
  error estimate for blocks of size 2^( 5) =       0.000415356318
  error estimate for blocks of size 2^( 6) =       0.000418202794
  error estimate for blocks of size 2^( 7) =       0.000419509007

      target function =      -0.884882773789
              le_mean =     -17.212293001610
             les_mean =     296.575870480574
             stat err =       0.000415735031
             autocorr =       1.225204828638
   target nu stat err =       0.000415735031
   target dn stat err =       0.008821794488
      target stat err =       0.010732670862
              std dev =       0.531162332523
             le_variance =       0.282133423491

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276889590105
                                         uncertainty =       0.001738676159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276889590105
                                         uncertainty =       0.001738676159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372084089
  error estimate for blocks of size 2^( 2) =       0.000385771346
  error estimate for blocks of size 2^( 3) =       0.000398015528
  error estimate for blocks of size 2^( 4) =       0.000406693041
  error estimate for blocks of size 2^( 5) =       0.000412190862
  error estimate for blocks of size 2^( 6) =       0.000415113967
  error estimate for blocks of size 2^( 7) =       0.000416490324

      target function =      -0.918364548397
              le_mean =     -17.211859427405
             les_mean =     296.534400611297
             stat err =       0.000412622049
             autocorr =       1.229766516517
   target nu stat err =       0.000412622049
   target dn stat err =       0.002004493459
      target stat err =       0.002685911052
              std dev =       0.526206364944
             le_variance =       0.276893138508


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.899058426895        initial
     5.9605e-05     5.9605e-04             4.4672e-03        -0.918352566145
     2.3842e-04     2.3842e-03             4.4549e-03        -0.884882773789
     9.5367e-04     9.5367e-03             4.4064e-03        -0.918364548397  <--

*****************************************************************************
Applying the update for shift_i =   9.5367e-04     and shift_s =   9.5367e-03
*****************************************************************************

  Execution time = 2.2912e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_001                -4.077394e-02 3 1  ON 0
ci_002                -3.304139e-02 3 1  ON 1
ci_003                -2.563377e-02 3 1  ON 2
ci_004                 2.379145e-02 3 1  ON 3
ci_005                 2.551719e-02 3 1  ON 4
ci_006                -2.223440e-02 3 1  ON 5
ci_007                -2.227805e-02 3 1  ON 6
ci_008                -8.912398e-03 3 1  ON 7
ci_009                -1.411450e-02 3 1  ON 8
ci_010                -1.168068e-02 3 1  ON 9
ci_011                -1.133529e-02 3 1  ON 10
ci_012                -1.058271e-02 3 1  ON 11
ci_013                -1.991922e-02 3 1  ON 12
ci_014                 1.311664e-02 3 1  ON 13
ci_015                 1.208284e-02 3 1  ON 14
ci_016                 1.696865e-02 3 1  ON 15
ci_017                 1.643990e-02 3 1  ON 16
ci_018                 1.227473e-02 3 1  ON 17
ci_019                 1.097727e-02 3 1  ON 18
ci_020                 1.808351e-02 3 1  ON 19
ci_021                 1.857711e-02 3 1  ON 20
ci_022                 9.210754e-03 3 1  ON 21
ci_023                 1.013547e-02 3 1  ON 22
ci_024                 1.005699e-02 3 1  ON 23
ci_025                 9.998139e-03 3 1  ON 24
ci_026                 1.136195e-02 3 1  ON 25
ci_027                 1.065429e-02 3 1  ON 26
ci_028                -1.512984e-02 3 1  ON 27
ci_029                -1.594671e-02 3 1  ON 28
ci_030                -8.480445e-03 3 1  ON 29
ci_031                -9.596563e-03 3 1  ON 30
ci_032                -1.435342e-02 3 1  ON 31
ci_033                 5.407289e-03 3 1  ON 32
ci_034                 6.138678e-03 3 1  ON 33
ci_035                -5.695538e-03 3 1  ON 34
ci_036                -1.362144e-02 3 1  ON 35
ci_037                -1.280588e-02 3 1  ON 36
ci_038                 2.035408e-03 3 1  ON 37
ci_039                 2.414290e-03 3 1  ON 38
ci_040                -3.258453e-03 3 1  ON 39
ci_041                 9.092117e-03 3 1  ON 40
ci_042                 7.591901e-03 3 1  ON 41
ci_043                -4.251823e-03 3 1  ON 42
ci_044                -2.349411e-03 3 1  ON 43
ci_045                -2.789709e-03 3 1  ON 44
ci_046                 6.263523e-03 3 1  ON 45
ci_047                 5.701503e-03 3 1  ON 46
ci_048                -1.202004e-02 3 1  ON 47
ci_049                -1.387381e-02 3 1  ON 48
ci_050                 4.282487e-03 3 1  ON 49
ci_051                 2.865294e-03 3 1  ON 50
ci_052                -3.706812e-03 3 1  ON 51
ci_053                -2.501444e-03 3 1  ON 52
ci_054                -2.746369e-03 3 1  ON 53
ci_055                -3.638848e-03 3 1  ON 54
ci_056                 6.114952e-03 3 1  ON 55
ci_057                 5.575199e-03 3 1  ON 56
ci_058                -3.458199e-04 3 1  ON 57
ci_059                -2.271599e-03 3 1  ON 58
ci_060                 5.267645e-03 3 1  ON 59
ci_061                 5.372521e-03 3 1  ON 60
ci_062                -4.094501e-03 3 1  ON 61
ci_063                -3.951254e-03 3 1  ON 62
ci_064                -2.709232e-03 3 1  ON 63
ci_065                -4.141754e-03 3 1  ON 64
ci_066                 4.911451e-03 3 1  ON 65
ci_067                 4.709730e-03 3 1  ON 66
ci_068                -6.365911e-03 3 1  ON 67
ci_069                -5.988591e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9476e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.1779
    reference variance = 0.184636
====================================================
  Execution time = 1.3920e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8875e-01
  Total weights = 1.957215366e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4765e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276703753791
                                         uncertainty =       0.001546367778

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276703753791
                                         uncertainty =       0.001546367778

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372018198
  error estimate for blocks of size 2^( 2) =       0.000385520527
  error estimate for blocks of size 2^( 3) =       0.000398303036
  error estimate for blocks of size 2^( 4) =       0.000407728998
  error estimate for blocks of size 2^( 5) =       0.000412247046
  error estimate for blocks of size 2^( 6) =       0.000414491228
  error estimate for blocks of size 2^( 7) =       0.000417610626

      target function =      -0.915118284541
              le_mean =     -17.211655046291
             les_mean =     296.529814970766
             stat err =       0.000413019474
             autocorr =       1.232573111603
   target nu stat err =       0.000413019474
   target dn stat err =       0.002237674576
      target stat err =       0.002962685718
              std dev =       0.526113181322
             le_variance =       0.276795079561


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721165504629e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-04, overlap shift 2.3842e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915127114342       residual = 2.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916184117319       residual = 3.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916416818333       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916484563704       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916495058613       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916498489205       residual = 2.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916498289741       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916497882708       residual = 7.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916497677934       residual = 2.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916497715762       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916497766360       residual = 9.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-04 is 2.937632e-03

solving harmonic davidson linear method for identity shift 9.5367e-04, overlap shift 9.5367e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915127114342       residual = 2.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916174823474       residual = 3.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916405052924       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916471855393       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916482187578       residual = 4.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916485556067       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916485350043       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916484948535       residual = 7.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916484747245       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916484784960       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916484834211       residual = 9.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-04 is 2.908409e-03

solving harmonic davidson linear method for identity shift 3.8147e-03, overlap shift 3.8147e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915127114342       residual = 2.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916139225022       residual = 3.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916360062800       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916423325739       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916433051912       residual = 4.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916436190702       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916435962625       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916435581963       residual = 6.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916435393680       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916435430779       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916435475159       residual = 8.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-03 is 2.797099e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.345690 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6414e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_001                -4.185670e-02 3 1  ON 0
ci_002                -3.205043e-02 3 1  ON 1
ci_003                -2.539771e-02 3 1  ON 2
ci_004                 2.504735e-02 3 1  ON 3
ci_005                 2.498891e-02 3 1  ON 4
ci_006                -2.171058e-02 3 1  ON 5
ci_007                -2.144985e-02 3 1  ON 6
ci_008                -9.103605e-03 3 1  ON 7
ci_009                -1.455225e-02 3 1  ON 8
ci_010                -8.772268e-03 3 1  ON 9
ci_011                -1.115426e-02 3 1  ON 10
ci_012                -1.050314e-02 3 1  ON 11
ci_013                -2.023439e-02 3 1  ON 12
ci_014                 1.276667e-02 3 1  ON 13
ci_015                 1.348031e-02 3 1  ON 14
ci_016                 1.621387e-02 3 1  ON 15
ci_017                 1.773658e-02 3 1  ON 16
ci_018                 1.029155e-02 3 1  ON 17
ci_019                 1.036657e-02 3 1  ON 18
ci_020                 1.784993e-02 3 1  ON 19
ci_021                 1.740610e-02 3 1  ON 20
ci_022                 1.025341e-02 3 1  ON 21
ci_023                 1.024678e-02 3 1  ON 22
ci_024                 9.437975e-03 3 1  ON 23
ci_025                 9.952484e-03 3 1  ON 24
ci_026                 1.124169e-02 3 1  ON 25
ci_027                 1.213422e-02 3 1  ON 26
ci_028                -1.359631e-02 3 1  ON 27
ci_029                -1.543206e-02 3 1  ON 28
ci_030                -9.531167e-03 3 1  ON 29
ci_031                -8.975547e-03 3 1  ON 30
ci_032                -1.425847e-02 3 1  ON 31
ci_033                 7.293450e-03 3 1  ON 32
ci_034                 6.631828e-03 3 1  ON 33
ci_035                -5.418298e-03 3 1  ON 34
ci_036                -1.309078e-02 3 1  ON 35
ci_037                -1.416344e-02 3 1  ON 36
ci_038                 2.107913e-03 3 1  ON 37
ci_039                 1.961201e-03 3 1  ON 38
ci_040                -3.154018e-03 3 1  ON 39
ci_041                 9.747063e-03 3 1  ON 40
ci_042                 9.127398e-03 3 1  ON 41
ci_043                -3.891063e-03 3 1  ON 42
ci_044                -5.080258e-03 3 1  ON 43
ci_045                -3.797887e-03 3 1  ON 44
ci_046                 5.659806e-03 3 1  ON 45
ci_047                 5.933512e-03 3 1  ON 46
ci_048                -1.379705e-02 3 1  ON 47
ci_049                -1.353959e-02 3 1  ON 48
ci_050                 2.312242e-03 3 1  ON 49
ci_051                 4.300920e-03 3 1  ON 50
ci_052                -2.237231e-03 3 1  ON 51
ci_053                -2.703125e-03 3 1  ON 52
ci_054                -3.427548e-03 3 1  ON 53
ci_055                -3.512154e-03 3 1  ON 54
ci_056                 6.102843e-03 3 1  ON 55
ci_057                 5.779745e-03 3 1  ON 56
ci_058                -1.992682e-03 3 1  ON 57
ci_059                -1.706455e-03 3 1  ON 58
ci_060                 6.242439e-03 3 1  ON 59
ci_061                 4.105440e-03 3 1  ON 60
ci_062                -3.237441e-03 3 1  ON 61
ci_063                -3.669119e-03 3 1  ON 62
ci_064                -3.245842e-03 3 1  ON 63
ci_065                -4.008637e-03 3 1  ON 64
ci_066                 4.736737e-03 3 1  ON 65
ci_067                 4.390334e-03 3 1  ON 66
ci_068                -6.187768e-03 3 1  ON 67
ci_069                -4.503684e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.1504
    reference variance = 0.202413
====================================================
  Execution time = 1.3703e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9597e-01
  Total weights = 1.9568e+06
  Execution time = 1.8376e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00886547
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281728833210
                                         uncertainty =       0.001723642796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281728833210
                                         uncertainty =       0.001723642796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375309830
  error estimate for blocks of size 2^( 2) =       0.000389097469
  error estimate for blocks of size 2^( 3) =       0.000401810844
  error estimate for blocks of size 2^( 4) =       0.000410780056
  error estimate for blocks of size 2^( 5) =       0.000416200577
  error estimate for blocks of size 2^( 6) =       0.000418545326
  error estimate for blocks of size 2^( 7) =       0.000420109673

      target function =      -0.820869993822
              le_mean =     -17.212023193061
             les_mean =     296.622693127483
             stat err =       0.000416408908
             autocorr =       1.231005926104
   target nu stat err =       0.000416408908
   target dn stat err =       0.024818508718
      target stat err =       0.025963783108
              std dev =       0.530768251660
             le_variance =       0.281714936971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279212454250
                                         uncertainty =       0.001560465254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279212454250
                                         uncertainty =       0.001560465254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373634801
  error estimate for blocks of size 2^( 2) =       0.000387524642
  error estimate for blocks of size 2^( 3) =       0.000400312510
  error estimate for blocks of size 2^( 4) =       0.000409374005
  error estimate for blocks of size 2^( 5) =       0.000414872756
  error estimate for blocks of size 2^( 6) =       0.000417182472
  error estimate for blocks of size 2^( 7) =       0.000418645728

      target function =      -0.905734085560
              le_mean =     -17.211806567142
             les_mean =     296.542353608681
             stat err =       0.000415018741
             autocorr =       1.233788663019
   target nu stat err =       0.000415018741
   target dn stat err =       0.003593555755
      target stat err =       0.004606933107
              std dev =       0.528399402985
             le_variance =       0.279205929074

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00903004
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292479783899
                                         uncertainty =       0.011000947438

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292479783899
                                         uncertainty =       0.011000947438

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382395170
  error estimate for blocks of size 2^( 2) =       0.000396037167
  error estimate for blocks of size 2^( 3) =       0.000408561199
  error estimate for blocks of size 2^( 4) =       0.000417420399
  error estimate for blocks of size 2^( 5) =       0.000422835199
  error estimate for blocks of size 2^( 6) =       0.000425191327
  error estimate for blocks of size 2^( 7) =       0.000426593381

      target function =      -0.626167555249
              le_mean =     -17.211865131146
             les_mean =     296.800692277842
             stat err =       0.000423010077
             autocorr =       1.223704707022
   target nu stat err =       0.000423010077
   target dn stat err =       0.244556679430
      target stat err =       0.158119686422
              std dev =       0.540788435091
             le_variance =       0.292452131529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279181351772
                                         uncertainty =       0.001559081146

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279181351772
                                         uncertainty =       0.001559081146

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373613802
  error estimate for blocks of size 2^( 2) =       0.000387502189
  error estimate for blocks of size 2^( 3) =       0.000400290865
  error estimate for blocks of size 2^( 4) =       0.000409351191
  error estimate for blocks of size 2^( 5) =       0.000414850017
  error estimate for blocks of size 2^( 6) =       0.000417160430
  error estimate for blocks of size 2^( 7) =       0.000418623450

      target function =      -0.905926463821
              le_mean =     -17.211807455296
             les_mean =     296.542233433068
             stat err =       0.000414996272
             autocorr =       1.233793756181
   target nu stat err =       0.000414996272
   target dn stat err =       0.003559943274
      target stat err =       0.004566458125
              std dev =       0.528369705357
             le_variance =       0.279174545539


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.820869993822        initial
     2.3842e-04     2.3842e-03             2.9376e-03        -0.905734085560
     9.5367e-04     9.5367e-03             2.9084e-03        -0.626167555249
     3.8147e-03     3.8147e-02             2.7971e-03        -0.905926463821  <--

*****************************************************************************
Applying the update for shift_i =   3.8147e-03     and shift_s =   3.8147e-02
*****************************************************************************

  Execution time = 2.3101e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_001                -4.180617e-02 3 1  ON 0
ci_002                -3.209127e-02 3 1  ON 1
ci_003                -2.540654e-02 3 1  ON 2
ci_004                 2.499305e-02 3 1  ON 3
ci_005                 2.500667e-02 3 1  ON 4
ci_006                -2.173237e-02 3 1  ON 5
ci_007                -2.148633e-02 3 1  ON 6
ci_008                -9.095642e-03 3 1  ON 7
ci_009                -1.453597e-02 3 1  ON 8
ci_010                -8.883577e-03 3 1  ON 9
ci_011                -1.116040e-02 3 1  ON 10
ci_012                -1.050611e-02 3 1  ON 11
ci_013                -2.021949e-02 3 1  ON 12
ci_014                 1.278188e-02 3 1  ON 13
ci_015                 1.342923e-02 3 1  ON 14
ci_016                 1.624665e-02 3 1  ON 15
ci_017                 1.767847e-02 3 1  ON 16
ci_018                 1.036653e-02 3 1  ON 17
ci_019                 1.038970e-02 3 1  ON 18
ci_020                 1.786556e-02 3 1  ON 19
ci_021                 1.746395e-02 3 1  ON 20
ci_022                 1.021045e-02 3 1  ON 21
ci_023                 1.023844e-02 3 1  ON 22
ci_024                 9.466604e-03 3 1  ON 23
ci_025                 9.954532e-03 3 1  ON 24
ci_026                 1.124276e-02 3 1  ON 25
ci_027                 1.208285e-02 3 1  ON 26
ci_028                -1.365760e-02 3 1  ON 27
ci_029                -1.544572e-02 3 1  ON 28
ci_030                -9.487557e-03 3 1  ON 29
ci_031                -8.998336e-03 3 1  ON 30
ci_032                -1.426372e-02 3 1  ON 31
ci_033                 7.215766e-03 3 1  ON 32
ci_034                 6.611380e-03 3 1  ON 33
ci_035                -5.428180e-03 3 1  ON 34
ci_036                -1.310952e-02 3 1  ON 35
ci_037                -1.411579e-02 3 1  ON 36
ci_038                 2.105345e-03 3 1  ON 37
ci_039                 1.977314e-03 3 1  ON 38
ci_040                -3.157835e-03 3 1  ON 39
ci_041                 9.729052e-03 3 1  ON 40
ci_042                 9.072371e-03 3 1  ON 41
ci_043                -3.904453e-03 3 1  ON 42
ci_044                -4.974093e-03 3 1  ON 43
ci_045                -3.763155e-03 3 1  ON 44
ci_046                 5.683974e-03 3 1  ON 45
ci_047                 5.922585e-03 3 1  ON 46
ci_048                -1.371428e-02 3 1  ON 47
ci_049                -1.355906e-02 3 1  ON 48
ci_050                 2.377260e-03 3 1  ON 49
ci_051                 4.253171e-03 3 1  ON 50
ci_052                -2.289348e-03 3 1  ON 51
ci_053                -2.698294e-03 3 1  ON 52
ci_054                -3.402099e-03 3 1  ON 53
ci_055                -3.517303e-03 3 1  ON 54
ci_056                 6.103902e-03 3 1  ON 55
ci_057                 5.772379e-03 3 1  ON 56
ci_058                -1.936191e-03 3 1  ON 57
ci_059                -1.725115e-03 3 1  ON 58
ci_060                 6.204725e-03 3 1  ON 59
ci_061                 4.155970e-03 3 1  ON 60
ci_062                -3.270799e-03 3 1  ON 61
ci_063                -3.679352e-03 3 1  ON 62
ci_064                -3.227517e-03 3 1  ON 63
ci_065                -4.013280e-03 3 1  ON 64
ci_066                 4.744926e-03 3 1  ON 65
ci_067                 4.402133e-03 3 1  ON 66
ci_068                -6.194234e-03 3 1  ON 67
ci_069                -4.561860e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9530e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.258
    reference variance = 0.938913
====================================================
  Execution time = 1.3825e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9015e-01
  Total weights = 1.957170982e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4695e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277035913636
                                         uncertainty =       0.001599905259

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277035913636
                                         uncertainty =       0.001599905259

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372192518
  error estimate for blocks of size 2^( 2) =       0.000385643057
  error estimate for blocks of size 2^( 3) =       0.000397447138
  error estimate for blocks of size 2^( 4) =       0.000406025736
  error estimate for blocks of size 2^( 5) =       0.000411059835
  error estimate for blocks of size 2^( 6) =       0.000414567229
  error estimate for blocks of size 2^( 7) =       0.000418318140

      target function =      -0.913419240369
              le_mean =     -17.212135974188
             les_mean =     296.547772374788
             stat err =       0.000412492735
             autocorr =       1.228279858510
   target nu stat err =       0.000412492735
   target dn stat err =       0.002727524233
      target stat err =       0.003577525139
              std dev =       0.526359707185
             le_variance =       0.277054541348


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721213597419e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-04, overlap shift 9.5367e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913432448121       residual = 2.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914475949163       residual = 3.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914674339802       residual = 9.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914749963592       residual = 2.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914761451155       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914764908554       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914767952745       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914768504454       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914768312255       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914768080675       residual = 6.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914768093431       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914768104683       residual = 5.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-04 is 3.336956e-03

solving harmonic davidson linear method for identity shift 3.8147e-03, overlap shift 3.8147e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913432448121       residual = 2.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914440628946       residual = 3.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914630750846       residual = 9.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914702449575       residual = 2.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914713184714       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914716377322       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914719183120       residual = 3.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914719687655       residual = 6.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914719505972       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914719292217       residual = 5.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914719306313       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914719315745       residual = 4.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-03 is 3.204614e-03

solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913432448121       residual = 2.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914320387670       residual = 3.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914483244556       residual = 9.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914542471413       residual = 2.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914550918987       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914553327094       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914555437050       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914555807259       residual = 5.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914555660659       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914555500648       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914555513280       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914555520556       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-02 is 2.765919e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.355618 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6313e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_001                -4.027902e-02 3 1  ON 0
ci_002                -3.316944e-02 3 1  ON 1
ci_003                -2.681211e-02 3 1  ON 2
ci_004                 2.696168e-02 3 1  ON 3
ci_005                 2.322357e-02 3 1  ON 4
ci_006                -2.243856e-02 3 1  ON 5
ci_007                -2.124932e-02 3 1  ON 6
ci_008                -9.551376e-03 3 1  ON 7
ci_009                -1.527943e-02 3 1  ON 8
ci_010                -7.719698e-03 3 1  ON 9
ci_011                -1.027948e-02 3 1  ON 10
ci_012                -1.145033e-02 3 1  ON 11
ci_013                -1.888260e-02 3 1  ON 12
ci_014                 1.315748e-02 3 1  ON 13
ci_015                 1.255768e-02 3 1  ON 14
ci_016                 1.697843e-02 3 1  ON 15
ci_017                 1.682393e-02 3 1  ON 16
ci_018                 9.955763e-03 3 1  ON 17
ci_019                 1.008114e-02 3 1  ON 18
ci_020                 1.829136e-02 3 1  ON 19
ci_021                 1.841594e-02 3 1  ON 20
ci_022                 1.065669e-02 3 1  ON 21
ci_023                 9.568002e-03 3 1  ON 22
ci_024                 9.762428e-03 3 1  ON 23
ci_025                 1.055021e-02 3 1  ON 24
ci_026                 1.046395e-02 3 1  ON 25
ci_027                 1.140397e-02 3 1  ON 26
ci_028                -1.505204e-02 3 1  ON 27
ci_029                -1.593718e-02 3 1  ON 28
ci_030                -9.510579e-03 3 1  ON 29
ci_031                -8.966890e-03 3 1  ON 30
ci_032                -1.470596e-02 3 1  ON 31
ci_033                 4.011152e-03 3 1  ON 32
ci_034                 5.358215e-03 3 1  ON 33
ci_035                -5.248415e-03 3 1  ON 34
ci_036                -1.228509e-02 3 1  ON 35
ci_037                -1.263178e-02 3 1  ON 36
ci_038                 2.144655e-03 3 1  ON 37
ci_039                 2.067511e-03 3 1  ON 38
ci_040                -3.321495e-03 3 1  ON 39
ci_041                 9.390093e-03 3 1  ON 40
ci_042                 9.931050e-03 3 1  ON 41
ci_043                -3.967379e-03 3 1  ON 42
ci_044                -3.941020e-03 3 1  ON 43
ci_045                -2.336066e-03 3 1  ON 44
ci_046                 6.073801e-03 3 1  ON 45
ci_047                 5.989368e-03 3 1  ON 46
ci_048                -1.375114e-02 3 1  ON 47
ci_049                -1.307517e-02 3 1  ON 48
ci_050                 3.941150e-03 3 1  ON 49
ci_051                 3.128708e-03 3 1  ON 50
ci_052                -2.931023e-03 3 1  ON 51
ci_053                -1.693622e-03 3 1  ON 52
ci_054                -2.712692e-03 3 1  ON 53
ci_055                -3.417187e-03 3 1  ON 54
ci_056                 5.446679e-03 3 1  ON 55
ci_057                 5.738640e-03 3 1  ON 56
ci_058                -3.539570e-03 3 1  ON 57
ci_059                -8.064753e-04 3 1  ON 58
ci_060                 6.214479e-03 3 1  ON 59
ci_061                 4.658687e-03 3 1  ON 60
ci_062                -4.054795e-03 3 1  ON 61
ci_063                -3.107996e-03 3 1  ON 62
ci_064                -2.807302e-03 3 1  ON 63
ci_065                -4.077484e-03 3 1  ON 64
ci_066                 3.938750e-03 3 1  ON 65
ci_067                 4.599939e-03 3 1  ON 66
ci_068                -4.955363e-03 3 1  ON 67
ci_069                -5.298879e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.159
    reference variance = 0.175778
====================================================
  Execution time = 1.3507e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.9522e-01
  Total weights = 1.9572e+06
  Execution time = 1.8383e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0144565
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280985801803
                                         uncertainty =       0.002050729225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280985801803
                                         uncertainty =       0.002050729225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374767255
  error estimate for blocks of size 2^( 2) =       0.000388539915
  error estimate for blocks of size 2^( 3) =       0.000401278303
  error estimate for blocks of size 2^( 4) =       0.000410416346
  error estimate for blocks of size 2^( 5) =       0.000416067044
  error estimate for blocks of size 2^( 6) =       0.000419135772
  error estimate for blocks of size 2^( 7) =       0.000422799700

      target function =      -0.892157132502
              le_mean =     -17.211380798016
             les_mean =     296.538421818033
             stat err =       0.000417104716
             autocorr =       1.238702241001
   target nu stat err =       0.000417104716
   target dn stat err =       0.006602091105
      target stat err =       0.008161555831
              std dev =       0.530000935291
             le_variance =       0.280900991409

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280061094711
                                         uncertainty =       0.001981686175

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280061094711
                                         uncertainty =       0.001981686175

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374151007
  error estimate for blocks of size 2^( 2) =       0.000388056061
  error estimate for blocks of size 2^( 3) =       0.000400868370
  error estimate for blocks of size 2^( 4) =       0.000410044296
  error estimate for blocks of size 2^( 5) =       0.000415796006
  error estimate for blocks of size 2^( 6) =       0.000418891711
  error estimate for blocks of size 2^( 7) =       0.000422706386

      target function =      -0.906583995446
              le_mean =     -17.211255072261
             les_mean =     296.522587576450
             stat err =       0.000416859600
             autocorr =       1.241325788374
   target nu stat err =       0.000416859600
   target dn stat err =       0.004522440905
      target stat err =       0.005786841415
              std dev =       0.529129428026
             le_variance =       0.279977951603

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.014142
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288716108747
                                         uncertainty =       0.006558464707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.288716108747
                                         uncertainty =       0.006558464707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379876957
  error estimate for blocks of size 2^( 2) =       0.000393736909
  error estimate for blocks of size 2^( 3) =       0.000406409295
  error estimate for blocks of size 2^( 4) =       0.000415622606
  error estimate for blocks of size 2^( 5) =       0.000421220650
  error estimate for blocks of size 2^( 6) =       0.000424064710
  error estimate for blocks of size 2^( 7) =       0.000427807611

      target function =      -0.303677634736
              le_mean =     -17.211358116011
             les_mean =     297.466427396446
             stat err =       0.000422178894
             autocorr =       1.235114255972
   target nu stat err =       0.000422178894
   target dn stat err =       0.884940816546
      target stat err =       0.162643040133
              std dev =       0.537227145003
             le_variance =       0.288613005328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279997657204
                                         uncertainty =       0.001986090349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279997657204
                                         uncertainty =       0.001986090349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374108588
  error estimate for blocks of size 2^( 2) =       0.000387993710
  error estimate for blocks of size 2^( 3) =       0.000400793128
  error estimate for blocks of size 2^( 4) =       0.000409964920
  error estimate for blocks of size 2^( 5) =       0.000415708439
  error estimate for blocks of size 2^( 6) =       0.000418798372
  error estimate for blocks of size 2^( 7) =       0.000422594412

      target function =      -0.906561622991
              le_mean =     -17.211254813405
             les_mean =     296.522599522310
             stat err =       0.000416766536
             autocorr =       1.241052986899
   target nu stat err =       0.000416766536
   target dn stat err =       0.004252196997
      target stat err =       0.005444382232
              std dev =       0.529069438912
             le_variance =       0.279914471190


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.892157132502        initial
     9.5367e-04     9.5367e-03             3.3370e-03        -0.906583995446  <--
     3.8147e-03     3.8147e-02             3.2046e-03        -0.303677634736
     1.5259e-02     1.5259e-01             2.7659e-03        -0.906561622991

*****************************************************************************
Applying the update for shift_i =   9.5367e-04     and shift_s =   9.5367e-03
*****************************************************************************

  Execution time = 2.2782e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_001                -4.020549e-02 3 1  ON 0
ci_002                -3.321676e-02 3 1  ON 1
ci_003                -2.686449e-02 3 1  ON 2
ci_004                 2.704636e-02 3 1  ON 3
ci_005                 2.313628e-02 3 1  ON 4
ci_006                -2.247374e-02 3 1  ON 5
ci_007                -2.123688e-02 3 1  ON 6
ci_008                -9.565538e-03 3 1  ON 7
ci_009                -1.530827e-02 3 1  ON 8
ci_010                -7.675216e-03 3 1  ON 9
ci_011                -1.024542e-02 3 1  ON 10
ci_012                -1.148771e-02 3 1  ON 11
ci_013                -1.881371e-02 3 1  ON 12
ci_014                 1.317906e-02 3 1  ON 13
ci_015                 1.251836e-02 3 1  ON 14
ci_016                 1.701500e-02 3 1  ON 15
ci_017                 1.678182e-02 3 1  ON 16
ci_018                 9.944209e-03 3 1  ON 17
ci_019                 1.007050e-02 3 1  ON 18
ci_020                 1.830634e-02 3 1  ON 19
ci_021                 1.845277e-02 3 1  ON 20
ci_022                 1.067791e-02 3 1  ON 21
ci_023                 9.537662e-03 3 1  ON 22
ci_024                 9.778079e-03 3 1  ON 23
ci_025                 1.057118e-02 3 1  ON 24
ci_026                 1.044413e-02 3 1  ON 25
ci_027                 1.137006e-02 3 1  ON 26
ci_028                -1.511319e-02 3 1  ON 27
ci_029                -1.596224e-02 3 1  ON 28
ci_030                -9.512940e-03 3 1  ON 29
ci_031                -8.962901e-03 3 1  ON 30
ci_032                -1.472541e-02 3 1  ON 31
ci_033                 3.878809e-03 3 1  ON 32
ci_034                 5.305037e-03 3 1  ON 33
ci_035                -5.241959e-03 3 1  ON 34
ci_036                -1.225814e-02 3 1  ON 35
ci_037                -1.258156e-02 3 1  ON 36
ci_038                 2.146037e-03 3 1  ON 37
ci_039                 2.070678e-03 3 1  ON 38
ci_040                -3.327115e-03 3 1  ON 39
ci_041                 9.382808e-03 3 1  ON 40
ci_042                 9.963267e-03 3 1  ON 41
ci_043                -3.969808e-03 3 1  ON 42
ci_044                -3.900417e-03 3 1  ON 43
ci_045                -2.284116e-03 3 1  ON 44
ci_046                 6.090263e-03 3 1  ON 45
ci_047                 5.992445e-03 3 1  ON 46
ci_048                -1.375526e-02 3 1  ON 47
ci_049                -1.305380e-02 3 1  ON 48
ci_050                 3.995116e-03 3 1  ON 49
ci_051                 3.089450e-03 3 1  ON 50
ci_052                -2.956548e-03 3 1  ON 51
ci_053                -1.656289e-03 3 1  ON 52
ci_054                -2.686121e-03 3 1  ON 53
ci_055                -3.413399e-03 3 1  ON 54
ci_056                 5.421700e-03 3 1  ON 55
ci_057                 5.737806e-03 3 1  ON 56
ci_058                -3.600122e-03 3 1  ON 57
ci_059                -7.714870e-04 3 1  ON 58
ci_060                 6.215584e-03 3 1  ON 59
ci_061                 4.679863e-03 3 1  ON 60
ci_062                -4.086634e-03 3 1  ON 61
ci_063                -3.086264e-03 3 1  ON 62
ci_064                -2.793021e-03 3 1  ON 63
ci_065                -4.079962e-03 3 1  ON 64
ci_066                 3.912923e-03 3 1  ON 65
ci_067                 4.609207e-03 3 1  ON 66
ci_068                -4.903930e-03 3 1  ON 67
ci_069                -5.328124e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9110e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.213
    reference variance = 0.3661
====================================================
  Execution time = 1.3863e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8598e-01
  Total weights = 1.957187104e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4705e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274805071127
                                         uncertainty =       0.001711594098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274805071127
                                         uncertainty =       0.001711594098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370669832
  error estimate for blocks of size 2^( 2) =       0.000384484352
  error estimate for blocks of size 2^( 3) =       0.000397198995
  error estimate for blocks of size 2^( 4) =       0.000406455011
  error estimate for blocks of size 2^( 5) =       0.000410834991
  error estimate for blocks of size 2^( 6) =       0.000412817715
  error estimate for blocks of size 2^( 7) =       0.000413412172

      target function =      -0.918791041990
              le_mean =     -17.211911015845
             les_mean =     296.535860371465
             stat err =       0.000410879972
             autocorr =       1.228727176626
   target nu stat err =       0.000410879972
   target dn stat err =       0.002088091526
      target stat err =       0.002794913282
              std dev =       0.524206303097
             le_variance =       0.274792248207


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721191101584e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-04, overlap shift 2.3842e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918798763968       residual = 2.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919702334406       residual = 3.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919900807907       residual = 8.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919957812759       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919976608000       residual = 7.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919980777952       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919982562829       residual = 4.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919983131187       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919983381341       residual = 2.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919983465589       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919983539374       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919983523295       residual = 6.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-04 is 3.274327e-03

solving harmonic davidson linear method for identity shift 9.5367e-04, overlap shift 9.5367e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918798763968       residual = 2.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919694395521       residual = 3.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919890741650       residual = 8.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919946953482       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919965448311       residual = 7.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919969528046       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919971276184       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919971832859       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919972075698       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919972158794       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919972230583       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919972214825       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-04 is 3.237827e-03

solving harmonic davidson linear method for identity shift 3.8147e-03, overlap shift 3.8147e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918798763968       residual = 2.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919663986281       residual = 3.69e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919852251617       residual = 8.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919905487182       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919922862678       residual = 7.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919926612149       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919928225388       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919928739784       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919928956143       residual = 2.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919929034906       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919929099509       residual = 1.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919929084911       residual = 5.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-03 is 3.099729e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.365500 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6354e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_001                -4.180820e-02 3 1  ON 0
ci_002                -3.214861e-02 3 1  ON 1
ci_003                -2.521550e-02 3 1  ON 2
ci_004                 2.380853e-02 3 1  ON 3
ci_005                 2.383781e-02 3 1  ON 4
ci_006                -2.130663e-02 3 1  ON 5
ci_007                -2.128128e-02 3 1  ON 6
ci_008                -9.176878e-03 3 1  ON 7
ci_009                -1.464056e-02 3 1  ON 8
ci_010                -8.941329e-03 3 1  ON 9
ci_011                -1.020508e-02 3 1  ON 10
ci_012                -9.784655e-03 3 1  ON 11
ci_013                -2.112416e-02 3 1  ON 12
ci_014                 1.258624e-02 3 1  ON 13
ci_015                 1.273416e-02 3 1  ON 14
ci_016                 1.708663e-02 3 1  ON 15
ci_017                 1.658924e-02 3 1  ON 16
ci_018                 1.082370e-02 3 1  ON 17
ci_019                 1.087519e-02 3 1  ON 18
ci_020                 1.701819e-02 3 1  ON 19
ci_021                 1.803712e-02 3 1  ON 20
ci_022                 9.801452e-03 3 1  ON 21
ci_023                 1.022706e-02 3 1  ON 22
ci_024                 1.021509e-02 3 1  ON 23
ci_025                 9.055760e-03 3 1  ON 24
ci_026                 1.114179e-02 3 1  ON 25
ci_027                 1.244876e-02 3 1  ON 26
ci_028                -1.611601e-02 3 1  ON 27
ci_029                -1.632831e-02 3 1  ON 28
ci_030                -9.246162e-03 3 1  ON 29
ci_031                -9.534102e-03 3 1  ON 30
ci_032                -1.422588e-02 3 1  ON 31
ci_033                 5.700144e-03 3 1  ON 32
ci_034                 5.273388e-03 3 1  ON 33
ci_035                -5.565777e-03 3 1  ON 34
ci_036                -1.272538e-02 3 1  ON 35
ci_037                -1.321024e-02 3 1  ON 36
ci_038                 1.725338e-03 3 1  ON 37
ci_039                 1.918986e-03 3 1  ON 38
ci_040                -3.228003e-03 3 1  ON 39
ci_041                 8.397003e-03 3 1  ON 40
ci_042                 8.874711e-03 3 1  ON 41
ci_043                -4.292438e-03 3 1  ON 42
ci_044                -1.970036e-03 3 1  ON 43
ci_045                -3.346507e-03 3 1  ON 44
ci_046                 5.572213e-03 3 1  ON 45
ci_047                 5.920909e-03 3 1  ON 46
ci_048                -1.372926e-02 3 1  ON 47
ci_049                -1.405856e-02 3 1  ON 48
ci_050                 2.657621e-03 3 1  ON 49
ci_051                 4.288570e-03 3 1  ON 50
ci_052                -2.624925e-03 3 1  ON 51
ci_053                -1.777941e-03 3 1  ON 52
ci_054                -3.467456e-03 3 1  ON 53
ci_055                -2.800389e-03 3 1  ON 54
ci_056                 5.364375e-03 3 1  ON 55
ci_057                 5.576444e-03 3 1  ON 56
ci_058                -2.453545e-03 3 1  ON 57
ci_059                -1.720585e-03 3 1  ON 58
ci_060                 4.433673e-03 3 1  ON 59
ci_061                 4.702791e-03 3 1  ON 60
ci_062                -4.213357e-03 3 1  ON 61
ci_063                -3.219807e-03 3 1  ON 62
ci_064                -3.164637e-03 3 1  ON 63
ci_065                -3.902271e-03 3 1  ON 64
ci_066                 4.876794e-03 3 1  ON 65
ci_067                 4.841218e-03 3 1  ON 66
ci_068                -6.158159e-03 3 1  ON 67
ci_069                -6.427661e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2264
    reference variance = 0.221297
====================================================
  Execution time = 1.3619e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.9326e-01
  Total weights = 1.9571e+06
  Execution time = 1.8500e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0543306
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280212709982
                                         uncertainty =       0.002013104504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280212709982
                                         uncertainty =       0.002013104504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374447862
  error estimate for blocks of size 2^( 2) =       0.000388319481
  error estimate for blocks of size 2^( 3) =       0.000400987236
  error estimate for blocks of size 2^( 4) =       0.000409479956
  error estimate for blocks of size 2^( 5) =       0.000415551611
  error estimate for blocks of size 2^( 6) =       0.000417985363
  error estimate for blocks of size 2^( 7) =       0.000421536418

      target function =      -0.815608807114
              le_mean =     -17.211507426350
             les_mean =     296.607805149340
             stat err =       0.000416138337
             autocorr =       1.235073333954
   target nu stat err =       0.000416138337
   target dn stat err =       0.048261272002
      target stat err =       0.049932353924
              std dev =       0.529549244355
             le_variance =       0.280422402197

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278660574351
                                         uncertainty =       0.001986315384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278660574351
                                         uncertainty =       0.001986315384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373401851
  error estimate for blocks of size 2^( 2) =       0.000387301125
  error estimate for blocks of size 2^( 3) =       0.000400045562
  error estimate for blocks of size 2^( 4) =       0.000408612330
  error estimate for blocks of size 2^( 5) =       0.000414808766
  error estimate for blocks of size 2^( 6) =       0.000417311976
  error estimate for blocks of size 2^( 7) =       0.000420899983

      target function =      -0.909247817619
              le_mean =     -17.211366809314
             les_mean =     296.524381210331
             stat err =       0.000415408264
             autocorr =       1.237648529280
   target nu stat err =       0.000415408264
   target dn stat err =       0.003392637109
      target stat err =       0.004384211707
              std dev =       0.528069962469
             le_variance =       0.278857885262

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0525608
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =      18.399395843879
                                         uncertainty =      18.027938855058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =      18.399395843879
                                         uncertainty =      18.027938855058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.003031606813
  error estimate for blocks of size 2^( 2) =       0.003033557791
  error estimate for blocks of size 2^( 3) =       0.003035567791
  error estimate for blocks of size 2^( 4) =       0.003036825051
  error estimate for blocks of size 2^( 5) =       0.003040344930
  error estimate for blocks of size 2^( 6) =       0.003039995583
  error estimate for blocks of size 2^( 7) =       0.003040227307

      target function =      -0.000464612053
              le_mean =     -17.208509988496
             les_mean =     995.866402090370
             stat err =       0.003039348217
             autocorr =       1.005113650271
   target nu stat err =       0.003039348217
   target dn stat err =     699.718042441236
      target stat err =       0.000464327863
              std dev =       4.287339470823
             le_variance =      18.381279738074

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278651394779
                                         uncertainty =       0.001985166683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278651394779
                                         uncertainty =       0.001985166683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373396072
  error estimate for blocks of size 2^( 2) =       0.000387293812
  error estimate for blocks of size 2^( 3) =       0.000400036370
  error estimate for blocks of size 2^( 4) =       0.000408599957
  error estimate for blocks of size 2^( 5) =       0.000414792375
  error estimate for blocks of size 2^( 6) =       0.000417294326
  error estimate for blocks of size 2^( 7) =       0.000420878984

      target function =      -0.908967312466
              le_mean =     -17.211366320709
             les_mean =     296.524583372978
             stat err =       0.000415391410
             autocorr =       1.237586416595
   target nu stat err =       0.000415391410
   target dn stat err =       0.003395525261
      target stat err =       0.004385188290
              std dev =       0.528061788820
             le_variance =       0.278849252812


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.815608807114        initial
     2.3842e-04     2.3842e-03             3.2743e-03        -0.909247817619  <--
     9.5367e-04     9.5367e-03             3.2378e-03        -0.000464612053
     3.8147e-03     3.8147e-02             3.0997e-03        -0.908967312466

*****************************************************************************
Applying the update for shift_i =   2.3842e-04     and shift_s =   2.3842e-03
*****************************************************************************

  Execution time = 2.2949e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_001                -4.182763e-02 3 1  ON 0
ci_002                -3.213649e-02 3 1  ON 1
ci_003                -2.519789e-02 3 1  ON 2
ci_004                 2.377203e-02 3 1  ON 3
ci_005                 2.384722e-02 3 1  ON 4
ci_006                -2.129219e-02 3 1  ON 5
ci_007                -2.128205e-02 3 1  ON 6
ci_008                -9.173437e-03 3 1  ON 7
ci_009                -1.463420e-02 3 1  ON 8
ci_010                -8.953765e-03 3 1  ON 9
ci_011                -1.020467e-02 3 1  ON 10
ci_012                -9.767558e-03 3 1  ON 11
ci_013                -2.115339e-02 3 1  ON 12
ci_014                 1.257896e-02 3 1  ON 13
ci_015                 1.273695e-02 3 1  ON 14
ci_016                 1.708756e-02 3 1  ON 15
ci_017                 1.658769e-02 3 1  ON 16
ci_018                 1.083175e-02 3 1  ON 17
ci_019                 1.088169e-02 3 1  ON 18
ci_020                 1.700445e-02 3 1  ON 19
ci_021                 1.803393e-02 3 1  ON 20
ci_022                 9.792007e-03 3 1  ON 21
ci_023                 1.023458e-02 3 1  ON 22
ci_024                 1.022035e-02 3 1  ON 23
ci_025                 9.039573e-03 3 1  ON 24
ci_026                 1.114500e-02 3 1  ON 25
ci_027                 1.245961e-02 3 1  ON 26
ci_028                -1.612678e-02 3 1  ON 27
ci_029                -1.633187e-02 3 1  ON 28
ci_030                -9.243327e-03 3 1  ON 29
ci_031                -9.541171e-03 3 1  ON 30
ci_032                -1.422013e-02 3 1  ON 31
ci_033                 5.719040e-03 3 1  ON 32
ci_034                 5.273170e-03 3 1  ON 33
ci_035                -5.568845e-03 3 1  ON 34
ci_036                -1.272805e-02 3 1  ON 35
ci_037                -1.321434e-02 3 1  ON 36
ci_038                 1.721432e-03 3 1  ON 37
ci_039                 1.917541e-03 3 1  ON 38
ci_040                -3.226991e-03 3 1  ON 39
ci_041                 8.388771e-03 3 1  ON 40
ci_042                 8.865310e-03 3 1  ON 41
ci_043                -4.295520e-03 3 1  ON 42
ci_044                -1.951965e-03 3 1  ON 43
ci_045                -3.356167e-03 3 1  ON 44
ci_046                 5.566770e-03 3 1  ON 45
ci_047                 5.920192e-03 3 1  ON 46
ci_048                -1.372936e-02 3 1  ON 47
ci_049                -1.407141e-02 3 1  ON 48
ci_050                 2.646025e-03 3 1  ON 49
ci_051                 4.298742e-03 3 1  ON 50
ci_052                -2.621423e-03 3 1  ON 51
ci_053                -1.779709e-03 3 1  ON 52
ci_054                -3.475118e-03 3 1  ON 53
ci_055                -2.794108e-03 3 1  ON 54
ci_056                 5.363861e-03 3 1  ON 55
ci_057                 5.574843e-03 3 1  ON 56
ci_058                -2.442757e-03 3 1  ON 57
ci_059                -1.729938e-03 3 1  ON 58
ci_060                 4.415275e-03 3 1  ON 59
ci_061                 4.703078e-03 3 1  ON 60
ci_062                -4.214891e-03 3 1  ON 61
ci_063                -3.220251e-03 3 1  ON 62
ci_064                -3.167969e-03 3 1  ON 63
ci_065                -3.900618e-03 3 1  ON 64
ci_066                 4.885515e-03 3 1  ON 65
ci_067                 4.843538e-03 3 1  ON 66
ci_068                -6.171264e-03 3 1  ON 67
ci_069                -6.438902e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9318e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.2127
    reference variance = 0.151182
====================================================
  Execution time = 1.3985e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8791e-01
  Total weights = 1.957184115e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4839e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275072572998
                                         uncertainty =       0.001781769205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275072572998
                                         uncertainty =       0.001781769205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370870441
  error estimate for blocks of size 2^( 2) =       0.000384336357
  error estimate for blocks of size 2^( 3) =       0.000396803412
  error estimate for blocks of size 2^( 4) =       0.000405331886
  error estimate for blocks of size 2^( 5) =       0.000410281260
  error estimate for blocks of size 2^( 6) =       0.000413076906
  error estimate for blocks of size 2^( 7) =       0.000413452268

      target function =      -0.916235006683
              le_mean =     -17.211791365336
             les_mean =     296.533674213786
             stat err =       0.000410535580
             autocorr =       1.225341556230
   target nu stat err =       0.000410535580
   target dn stat err =       0.002395235779
      target stat err =       0.003171017843
              std dev =       0.524490008119
             le_variance =       0.275089768616


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721179136534e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-05, overlap shift 5.9605e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916245237704       residual = 2.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917052962861       residual = 4.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917294296631       residual = 9.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917365605272       residual = 3.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917381634651       residual = 8.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917390984926       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917394612553       residual = 8.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917394696642       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917394844514       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917394588527       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917394558941       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917394576430       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917394571657       residual = 1.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-05 is 2.653035e-03

solving harmonic davidson linear method for identity shift 2.3842e-04, overlap shift 2.3842e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916245237704       residual = 2.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917051190403       residual = 4.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917291876153       residual = 9.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917362951588       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917378912512       residual = 8.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917388221393       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917391829117       residual = 8.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917391911292       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917392058307       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917391803573       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917391774175       residual = 3.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917391791623       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917391786879       residual = 1.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-04 is 2.644478e-03

solving harmonic davidson linear method for identity shift 9.5367e-04, overlap shift 9.5367e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916245237704       residual = 2.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917044177609       residual = 4.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917282305056       residual = 9.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917352461996       residual = 3.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917368154173       residual = 7.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917377300730       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917380830611       residual = 8.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917380905402       residual = 1.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917381049075       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917380799256       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917380770588       residual = 3.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917380787874       residual = 1.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.917380783247       residual = 1.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-04 is 2.610797e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.376556 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6489e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_001                -4.259008e-02 3 1  ON 0
ci_002                -3.321713e-02 3 1  ON 1
ci_003                -2.656953e-02 3 1  ON 2
ci_004                 2.492797e-02 3 1  ON 3
ci_005                 2.445425e-02 3 1  ON 4
ci_006                -2.205153e-02 3 1  ON 5
ci_007                -2.160935e-02 3 1  ON 6
ci_008                -8.685957e-03 3 1  ON 7
ci_009                -1.403556e-02 3 1  ON 8
ci_010                -9.125906e-03 3 1  ON 9
ci_011                -1.098142e-02 3 1  ON 10
ci_012                -1.017968e-02 3 1  ON 11
ci_013                -1.850891e-02 3 1  ON 12
ci_014                 1.215449e-02 3 1  ON 13
ci_015                 1.252106e-02 3 1  ON 14
ci_016                 1.628949e-02 3 1  ON 15
ci_017                 1.511513e-02 3 1  ON 16
ci_018                 1.148470e-02 3 1  ON 17
ci_019                 1.074216e-02 3 1  ON 18
ci_020                 1.730223e-02 3 1  ON 19
ci_021                 1.748403e-02 3 1  ON 20
ci_022                 1.068045e-02 3 1  ON 21
ci_023                 1.031582e-02 3 1  ON 22
ci_024                 1.035391e-02 3 1  ON 23
ci_025                 1.126572e-02 3 1  ON 24
ci_026                 1.259055e-02 3 1  ON 25
ci_027                 1.108766e-02 3 1  ON 26
ci_028                -1.547558e-02 3 1  ON 27
ci_029                -1.593076e-02 3 1  ON 28
ci_030                -1.026937e-02 3 1  ON 29
ci_031                -8.995734e-03 3 1  ON 30
ci_032                -1.417069e-02 3 1  ON 31
ci_033                 6.676952e-03 3 1  ON 32
ci_034                 5.612638e-03 3 1  ON 33
ci_035                -5.402391e-03 3 1  ON 34
ci_036                -1.182964e-02 3 1  ON 35
ci_037                -1.339034e-02 3 1  ON 36
ci_038                 1.741363e-03 3 1  ON 37
ci_039                 1.813244e-03 3 1  ON 38
ci_040                -3.006794e-03 3 1  ON 39
ci_041                 8.658569e-03 3 1  ON 40
ci_042                 8.961735e-03 3 1  ON 41
ci_043                -4.292854e-03 3 1  ON 42
ci_044                -4.441858e-03 3 1  ON 43
ci_045                -3.238845e-03 3 1  ON 44
ci_046                 5.632632e-03 3 1  ON 45
ci_047                 5.426096e-03 3 1  ON 46
ci_048                -1.421874e-02 3 1  ON 47
ci_049                -1.374737e-02 3 1  ON 48
ci_050                 3.586042e-03 3 1  ON 49
ci_051                 3.405652e-03 3 1  ON 50
ci_052                -3.065450e-03 3 1  ON 51
ci_053                -3.557607e-03 3 1  ON 52
ci_054                -3.268629e-03 3 1  ON 53
ci_055                -2.523113e-03 3 1  ON 54
ci_056                 7.005888e-03 3 1  ON 55
ci_057                 5.885097e-03 3 1  ON 56
ci_058                -3.194314e-03 3 1  ON 57
ci_059                -1.478494e-03 3 1  ON 58
ci_060                 6.695030e-03 3 1  ON 59
ci_061                 5.283423e-03 3 1  ON 60
ci_062                -3.789136e-03 3 1  ON 61
ci_063                -2.297961e-03 3 1  ON 62
ci_064                -3.515063e-03 3 1  ON 63
ci_065                -3.951203e-03 3 1  ON 64
ci_066                 4.867812e-03 3 1  ON 65
ci_067                 4.366321e-03 3 1  ON 66
ci_068                -4.843761e-03 3 1  ON 67
ci_069                -4.596451e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.2177
    reference variance = 0.166102
====================================================
  Execution time = 1.3602e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9302e-01
  Total weights = 1.9573e+06
  Execution time = 1.8359e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282617631771
                                         uncertainty =       0.002983788657

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282617631771
                                         uncertainty =       0.002983788657

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375909657
  error estimate for blocks of size 2^( 2) =       0.000389716805
  error estimate for blocks of size 2^( 3) =       0.000401998667
  error estimate for blocks of size 2^( 4) =       0.000410625294
  error estimate for blocks of size 2^( 5) =       0.000416221936
  error estimate for blocks of size 2^( 6) =       0.000417721300
  error estimate for blocks of size 2^( 7) =       0.000418248430

      target function =      -0.732142270772
              le_mean =     -17.212364978460
             les_mean =     296.714010960567
             stat err =       0.000415704240
             autocorr =       1.222930965010
   target nu stat err =       0.000415704240
   target dn stat err =       0.119161433172
      target stat err =       0.100984423036
              std dev =       0.531616535632
             le_variance =       0.282616140957

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279020531528
                                         uncertainty =       0.001807947051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279020531528
                                         uncertainty =       0.001807947051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373516936
  error estimate for blocks of size 2^( 2) =       0.000387296745
  error estimate for blocks of size 2^( 3) =       0.000399537689
  error estimate for blocks of size 2^( 4) =       0.000407991654
  error estimate for blocks of size 2^( 5) =       0.000413562858
  error estimate for blocks of size 2^( 6) =       0.000415068484
  error estimate for blocks of size 2^( 7) =       0.000415401728

      target function =      -0.909762053260
              le_mean =     -17.212243142215
             les_mean =     296.554317511792
             stat err =       0.000413006181
             autocorr =       1.222622842788
   target nu stat err =       0.000413006181
   target dn stat err =       0.002994565373
      target stat err =       0.003888643595
              std dev =       0.528232716928
             le_variance =       0.279029803233

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281938354016
                                         uncertainty =       0.001957521333

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281938354016
                                         uncertainty =       0.001957521333

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375461961
  error estimate for blocks of size 2^( 2) =       0.000389086211
  error estimate for blocks of size 2^( 3) =       0.000401179123
  error estimate for blocks of size 2^( 4) =       0.000409508841
  error estimate for blocks of size 2^( 5) =       0.000415083741
  error estimate for blocks of size 2^( 6) =       0.000416405127
  error estimate for blocks of size 2^( 7) =       0.000416719899

      target function =      -0.659403581912
              le_mean =     -17.212328432459
             les_mean =     296.788054039735
             stat err =       0.000414429402
             autocorr =       1.218342040871
   target nu stat err =       0.000414429402
   target dn stat err =       0.189585848042
      target stat err =       0.133095195878
              std dev =       0.530983397273
             le_variance =       0.281943368180

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279006490141
                                         uncertainty =       0.001806898012

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279006490141
                                         uncertainty =       0.001806898012

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373507547
  error estimate for blocks of size 2^( 2) =       0.000387289085
  error estimate for blocks of size 2^( 3) =       0.000399531954
  error estimate for blocks of size 2^( 4) =       0.000407987592
  error estimate for blocks of size 2^( 5) =       0.000413559245
  error estimate for blocks of size 2^( 6) =       0.000415067007
  error estimate for blocks of size 2^( 7) =       0.000415400076

      target function =      -0.909552068693
              le_mean =     -17.212243680697
             les_mean =     296.554499591848
             stat err =       0.000413003480
             autocorr =       1.222668315266
   target nu stat err =       0.000413003480
   target dn stat err =       0.003012753086
      target stat err =       0.003909950544
              std dev =       0.528219439257
             le_variance =       0.279015776009


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.732142270772        initial
     5.9605e-05     5.9605e-04             2.6530e-03        -0.909762053260  <--
     2.3842e-04     2.3842e-03             2.6445e-03        -0.659403581912
     9.5367e-04     9.5367e-03             2.6108e-03        -0.909552068693

*****************************************************************************
Applying the update for shift_i =   5.9605e-05     and shift_s =   5.9605e-04
*****************************************************************************

  Execution time = 2.2924e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_001                -4.259293e-02 3 1  ON 0
ci_002                -3.322042e-02 3 1  ON 1
ci_003                -2.657318e-02 3 1  ON 2
ci_004                 2.493182e-02 3 1  ON 3
ci_005                 2.445548e-02 3 1  ON 4
ci_006                -2.205355e-02 3 1  ON 5
ci_007                -2.161034e-02 3 1  ON 6
ci_008                -8.684941e-03 3 1  ON 7
ci_009                -1.403413e-02 3 1  ON 8
ci_010                -9.126349e-03 3 1  ON 9
ci_011                -1.098341e-02 3 1  ON 10
ci_012                -1.018080e-02 3 1  ON 11
ci_013                -1.850035e-02 3 1  ON 12
ci_014                 1.215331e-02 3 1  ON 13
ci_015                 1.252035e-02 3 1  ON 14
ci_016                 1.628700e-02 3 1  ON 15
ci_017                 1.511052e-02 3 1  ON 16
ci_018                 1.148620e-02 3 1  ON 17
ci_019                 1.074192e-02 3 1  ON 18
ci_020                 1.730307e-02 3 1  ON 19
ci_021                 1.748274e-02 3 1  ON 20
ci_022                 1.068267e-02 3 1  ON 21
ci_023                 1.031602e-02 3 1  ON 22
ci_024                 1.035425e-02 3 1  ON 23
ci_025                 1.127175e-02 3 1  ON 24
ci_026                 1.259425e-02 3 1  ON 25
ci_027                 1.108453e-02 3 1  ON 26
ci_028                -1.547368e-02 3 1  ON 27
ci_029                -1.592947e-02 3 1  ON 28
ci_030                -1.027187e-02 3 1  ON 29
ci_031                -8.994294e-03 3 1  ON 30
ci_032                -1.417063e-02 3 1  ON 31
ci_033                 6.679640e-03 3 1  ON 32
ci_034                 5.613603e-03 3 1  ON 33
ci_035                -5.401988e-03 3 1  ON 34
ci_036                -1.182782e-02 3 1  ON 35
ci_037                -1.339098e-02 3 1  ON 36
ci_038                 1.741400e-03 3 1  ON 37
ci_039                 1.813019e-03 3 1  ON 38
ci_040                -3.006341e-03 3 1  ON 39
ci_041                 8.659017e-03 3 1  ON 40
ci_042                 8.961805e-03 3 1  ON 41
ci_043                -4.292862e-03 3 1  ON 42
ci_044                -4.448100e-03 3 1  ON 43
ci_045                -3.238575e-03 3 1  ON 44
ci_046                 5.632769e-03 3 1  ON 45
ci_047                 5.424858e-03 3 1  ON 46
ci_048                -1.422034e-02 3 1  ON 47
ci_049                -1.374610e-02 3 1  ON 48
ci_050                 3.588104e-03 3 1  ON 49
ci_051                 3.403731e-03 3 1  ON 50
ci_052                -3.066464e-03 3 1  ON 51
ci_053                -3.561231e-03 3 1  ON 52
ci_054                -3.268088e-03 3 1  ON 53
ci_055                -2.522553e-03 3 1  ON 54
ci_056                 7.009716e-03 3 1  ON 55
ci_057                 5.885869e-03 3 1  ON 56
ci_058                -3.196140e-03 3 1  ON 57
ci_059                -1.478356e-03 3 1  ON 58
ci_060                 6.701028e-03 3 1  ON 59
ci_061                 5.284928e-03 3 1  ON 60
ci_062                -3.788125e-03 3 1  ON 61
ci_063                -2.296059e-03 3 1  ON 62
ci_064                -3.515830e-03 3 1  ON 63
ci_065                -3.951334e-03 3 1  ON 64
ci_066                 4.867687e-03 3 1  ON 65
ci_067                 4.365109e-03 3 1  ON 66
ci_068                -4.840310e-03 3 1  ON 67
ci_069                -4.591653e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9427e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.1902
    reference variance = 0.182327
====================================================
  Execution time = 1.3877e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8846e-01
  Total weights = 1.957164752e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4776e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277197386414
                                         uncertainty =       0.001483423534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277197386414
                                         uncertainty =       0.001483423534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372300306
  error estimate for blocks of size 2^( 2) =       0.000386110184
  error estimate for blocks of size 2^( 3) =       0.000398653755
  error estimate for blocks of size 2^( 4) =       0.000408210838
  error estimate for blocks of size 2^( 5) =       0.000414299205
  error estimate for blocks of size 2^( 6) =       0.000416003164
  error estimate for blocks of size 2^( 7) =       0.000418587595

      target function =      -0.915739056046
              le_mean =     -17.212638542374
             les_mean =     296.563385971374
             stat err =       0.000414275201
             autocorr =       1.238200817869
   target nu stat err =       0.000414275201
   target dn stat err =       0.002449046516
      target stat err =       0.003241643052
              std dev =       0.526512141728
             le_variance =       0.277215035387


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721263854237e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-05, overlap shift 1.4901e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915749760250       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916186075075       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916321986658       residual = 7.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916384151040       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916397071542       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916403682091       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916405607686       residual = 4.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916405903850       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916405546962       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916405605926       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916405524791       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916405540557       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916405584480       residual = 1.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-05 is 2.164845e-03

solving harmonic davidson linear method for identity shift 5.9605e-05, overlap shift 5.9605e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915749760250       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916185829111       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916321648013       residual = 7.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916383759496       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916396664926       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916403267389       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916405190675       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916405486290       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916405129793       residual = 3.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916405188700       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916405107673       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916405123456       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916405167301       residual = 1.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-05 is 2.163384e-03

solving harmonic davidson linear method for identity shift 2.3842e-04, overlap shift 2.3842e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915749760250       residual = 1.02e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916184848022       residual = 2.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916320297434       residual = 7.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916382198166       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916395043612       residual = 8.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916401613898       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916403528001       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916403821433       residual = 1.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916403466493       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916403525170       residual = 9.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916403444577       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916403460427       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.916403503958       residual = 1.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         12 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-04 is 2.157557e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.387484 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6376e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_001                -4.329586e-02 3 1  ON 0
ci_002                -3.296605e-02 3 1  ON 1
ci_003                -2.730192e-02 3 1  ON 2
ci_004                 2.457133e-02 3 1  ON 3
ci_005                 2.301832e-02 3 1  ON 4
ci_006                -2.188477e-02 3 1  ON 5
ci_007                -2.182546e-02 3 1  ON 6
ci_008                -9.448466e-03 3 1  ON 7
ci_009                -1.465264e-02 3 1  ON 8
ci_010                -9.535744e-03 3 1  ON 9
ci_011                -9.635623e-03 3 1  ON 10
ci_012                -1.131636e-02 3 1  ON 11
ci_013                -2.051830e-02 3 1  ON 12
ci_014                 1.242895e-02 3 1  ON 13
ci_015                 1.287724e-02 3 1  ON 14
ci_016                 1.714383e-02 3 1  ON 15
ci_017                 1.710834e-02 3 1  ON 16
ci_018                 1.023384e-02 3 1  ON 17
ci_019                 1.051471e-02 3 1  ON 18
ci_020                 1.704629e-02 3 1  ON 19
ci_021                 1.757657e-02 3 1  ON 20
ci_022                 1.095408e-02 3 1  ON 21
ci_023                 1.024058e-02 3 1  ON 22
ci_024                 8.324649e-03 3 1  ON 23
ci_025                 9.108365e-03 3 1  ON 24
ci_026                 1.284784e-02 3 1  ON 25
ci_027                 1.074312e-02 3 1  ON 26
ci_028                -1.454254e-02 3 1  ON 27
ci_029                -1.501333e-02 3 1  ON 28
ci_030                -9.058597e-03 3 1  ON 29
ci_031                -9.514863e-03 3 1  ON 30
ci_032                -1.447702e-02 3 1  ON 31
ci_033                 5.855988e-03 3 1  ON 32
ci_034                 6.462718e-03 3 1  ON 33
ci_035                -5.294600e-03 3 1  ON 34
ci_036                -1.343079e-02 3 1  ON 35
ci_037                -1.341955e-02 3 1  ON 36
ci_038                 1.510077e-03 3 1  ON 37
ci_039                 1.971880e-03 3 1  ON 38
ci_040                -2.853976e-03 3 1  ON 39
ci_041                 8.329540e-03 3 1  ON 40
ci_042                 8.606242e-03 3 1  ON 41
ci_043                -3.970097e-03 3 1  ON 42
ci_044                -5.035956e-03 3 1  ON 43
ci_045                -3.326754e-03 3 1  ON 44
ci_046                 5.615247e-03 3 1  ON 45
ci_047                 5.195549e-03 3 1  ON 46
ci_048                -1.237725e-02 3 1  ON 47
ci_049                -1.337335e-02 3 1  ON 48
ci_050                 3.081112e-03 3 1  ON 49
ci_051                 4.260687e-03 3 1  ON 50
ci_052                -3.144701e-03 3 1  ON 51
ci_053                -3.037450e-03 3 1  ON 52
ci_054                -2.921196e-03 3 1  ON 53
ci_055                -2.664790e-03 3 1  ON 54
ci_056                 6.169293e-03 3 1  ON 55
ci_057                 6.166679e-03 3 1  ON 56
ci_058                -2.663909e-03 3 1  ON 57
ci_059                -2.346282e-03 3 1  ON 58
ci_060                 6.070078e-03 3 1  ON 59
ci_061                 5.129300e-03 3 1  ON 60
ci_062                -3.784755e-03 3 1  ON 61
ci_063                -3.422980e-03 3 1  ON 62
ci_064                -3.085830e-03 3 1  ON 63
ci_065                -4.362830e-03 3 1  ON 64
ci_066                 4.393047e-03 3 1  ON 65
ci_067                 4.757011e-03 3 1  ON 66
ci_068                -5.752157e-03 3 1  ON 67
ci_069                -5.020756e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.2221
    reference variance = 0.249325
====================================================
  Execution time = 1.5899e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8989e-01
  Total weights = 1.9566e+06
  Execution time = 1.8434e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295845533913
                                         uncertainty =       0.018386486460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.295845533913
                                         uncertainty =       0.018386486460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000384592546
  error estimate for blocks of size 2^( 2) =       0.000397978753
  error estimate for blocks of size 2^( 3) =       0.000409843025
  error estimate for blocks of size 2^( 4) =       0.000417973020
  error estimate for blocks of size 2^( 5) =       0.000422810329
  error estimate for blocks of size 2^( 6) =       0.000424773301
  error estimate for blocks of size 2^( 7) =       0.000426180954

      target function =      -0.212014384956
              le_mean =     -17.211801318176
             les_mean =     297.949789169691
             stat err =       0.000422934401
             autocorr =       1.209328527741
   target nu stat err =       0.000422934401
   target dn stat err =       1.399490514054
      target stat err =       0.139968873634
              std dev =       0.543895994655
             le_variance =       0.295822853001

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276679599532
                                         uncertainty =       0.001729435545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276679599532
                                         uncertainty =       0.001729435545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371929676
  error estimate for blocks of size 2^( 2) =       0.000385648909
  error estimate for blocks of size 2^( 3) =       0.000397719202
  error estimate for blocks of size 2^( 4) =       0.000406106592
  error estimate for blocks of size 2^( 5) =       0.000411111562
  error estimate for blocks of size 2^( 6) =       0.000413236619
  error estimate for blocks of size 2^( 7) =       0.000415027070

      target function =      -0.913667974391
              le_mean =     -17.211805538149
             les_mean =     296.536139856365
             stat err =       0.000411370461
             autocorr =       1.223332585416
   target nu stat err =       0.000411370461
   target dn stat err =       0.002851819135
      target stat err =       0.003736149419
              std dev =       0.525987991341
             le_variance =       0.276663367035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278512798165
                                         uncertainty =       0.001795792244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278512798165
                                         uncertainty =       0.001795792244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373158256
  error estimate for blocks of size 2^( 2) =       0.000386882344
  error estimate for blocks of size 2^( 3) =       0.000398948476
  error estimate for blocks of size 2^( 4) =       0.000407367994
  error estimate for blocks of size 2^( 5) =       0.000412350217
  error estimate for blocks of size 2^( 6) =       0.000414548549
  error estimate for blocks of size 2^( 7) =       0.000416408594

      target function =      -0.829985229761
              le_mean =     -17.211904340292
             les_mean =     296.609377693983
             stat err =       0.000412668839
             autocorr =       1.222974052005
   target nu stat err =       0.000412668839
   target dn stat err =       0.032614163470
      target stat err =       0.034898193666
              std dev =       0.527725466405
             le_variance =       0.278494167892

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276679002196
                                         uncertainty =       0.001729410877

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276679002196
                                         uncertainty =       0.001729410877

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371929275
  error estimate for blocks of size 2^( 2) =       0.000385648464
  error estimate for blocks of size 2^( 3) =       0.000397718647
  error estimate for blocks of size 2^( 4) =       0.000406105879
  error estimate for blocks of size 2^( 5) =       0.000411111021
  error estimate for blocks of size 2^( 6) =       0.000413235852
  error estimate for blocks of size 2^( 7) =       0.000415026024

      target function =      -0.913661908438
              le_mean =     -17.211805534373
             les_mean =     296.536144393602
             stat err =       0.000411369694
             autocorr =       1.223330659258
   target nu stat err =       0.000411369694
   target dn stat err =       0.002854295364
      target stat err =       0.003739265514
              std dev =       0.525987424789
             le_variance =       0.276662771037


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.212014384956        initial
     1.4901e-05     1.4901e-04             2.1648e-03        -0.913667974391  <--
     5.9605e-05     5.9605e-04             2.1634e-03        -0.829985229761
     2.3842e-04     2.3842e-03             2.1576e-03        -0.913661908438

*****************************************************************************
Applying the update for shift_i =   1.4901e-05     and shift_s =   1.4901e-04
*****************************************************************************

  Execution time = 2.5202e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_001                -4.329637e-02 3 1  ON 0
ci_002                -3.296585e-02 3 1  ON 1
ci_003                -2.730259e-02 3 1  ON 2
ci_004                 2.457112e-02 3 1  ON 3
ci_005                 2.301729e-02 3 1  ON 4
ci_006                -2.188462e-02 3 1  ON 5
ci_007                -2.182561e-02 3 1  ON 6
ci_008                -9.448935e-03 3 1  ON 7
ci_009                -1.465301e-02 3 1  ON 8
ci_010                -9.535993e-03 3 1  ON 9
ci_011                -9.634793e-03 3 1  ON 10
ci_012                -1.131707e-02 3 1  ON 11
ci_013                -2.051987e-02 3 1  ON 12
ci_014                 1.242909e-02 3 1  ON 13
ci_015                 1.287751e-02 3 1  ON 14
ci_016                 1.714448e-02 3 1  ON 15
ci_017                 1.710985e-02 3 1  ON 16
ci_018                 1.023312e-02 3 1  ON 17
ci_019                 1.051459e-02 3 1  ON 18
ci_020                 1.704612e-02 3 1  ON 19
ci_021                 1.757653e-02 3 1  ON 20
ci_022                 1.095428e-02 3 1  ON 21
ci_023                 1.024051e-02 3 1  ON 22
ci_024                 8.323229e-03 3 1  ON 23
ci_025                 9.106904e-03 3 1  ON 24
ci_026                 1.284798e-02 3 1  ON 25
ci_027                 1.074285e-02 3 1  ON 26
ci_028                -1.454188e-02 3 1  ON 27
ci_029                -1.501264e-02 3 1  ON 28
ci_030                -9.057747e-03 3 1  ON 29
ci_031                -9.515137e-03 3 1  ON 30
ci_032                -1.447721e-02 3 1  ON 31
ci_033                 5.855448e-03 3 1  ON 32
ci_034                 6.463269e-03 3 1  ON 33
ci_035                -5.294533e-03 3 1  ON 34
ci_036                -1.343180e-02 3 1  ON 35
ci_037                -1.341967e-02 3 1  ON 36
ci_038                 1.509943e-03 3 1  ON 37
ci_039                 1.971976e-03 3 1  ON 38
ci_040                -2.853889e-03 3 1  ON 39
ci_041                 8.329297e-03 3 1  ON 40
ci_042                 8.605970e-03 3 1  ON 41
ci_043                -3.969896e-03 3 1  ON 42
ci_044                -5.036328e-03 3 1  ON 43
ci_045                -3.326798e-03 3 1  ON 44
ci_046                 5.615236e-03 3 1  ON 45
ci_047                 5.195400e-03 3 1  ON 46
ci_048                -1.237578e-02 3 1  ON 47
ci_049                -1.337311e-02 3 1  ON 48
ci_050                 3.080841e-03 3 1  ON 49
ci_051                 4.261146e-03 3 1  ON 50
ci_052                -3.144751e-03 3 1  ON 51
ci_053                -3.037134e-03 3 1  ON 52
ci_054                -2.920996e-03 3 1  ON 53
ci_055                -2.664880e-03 3 1  ON 54
ci_056                 6.168780e-03 3 1  ON 55
ci_057                 6.166854e-03 3 1  ON 56
ci_058                -2.663578e-03 3 1  ON 57
ci_059                -2.346775e-03 3 1  ON 58
ci_060                 6.069674e-03 3 1  ON 59
ci_061                 5.129203e-03 3 1  ON 60
ci_062                -3.784683e-03 3 1  ON 61
ci_063                -3.423609e-03 3 1  ON 62
ci_064                -3.085591e-03 3 1  ON 63
ci_065                -4.363067e-03 3 1  ON 64
ci_066                 4.392776e-03 3 1  ON 65
ci_067                 4.757230e-03 3 1  ON 66
ci_068                -5.752742e-03 3 1  ON 67
ci_069                -5.021034e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1589e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.2989
    reference variance = 0.181066
====================================================
  Execution time = 1.3968e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9383e-01
  Total weights = 1.957099855e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4621e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279389685043
                                         uncertainty =       0.001609965712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279389685043
                                         uncertainty =       0.001609965712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373701154
  error estimate for blocks of size 2^( 2) =       0.000387279266
  error estimate for blocks of size 2^( 3) =       0.000399870495
  error estimate for blocks of size 2^( 4) =       0.000408437024
  error estimate for blocks of size 2^( 5) =       0.000413361154
  error estimate for blocks of size 2^( 6) =       0.000415123224
  error estimate for blocks of size 2^( 7) =       0.000414272880

      target function =      -0.908745365348
              le_mean =     -17.212430015706
             les_mean =     296.561574207540
             stat err =       0.000412798570
             autocorr =       1.220190085458
   target nu stat err =       0.000412798570
   target dn stat err =       0.003476001869
      target stat err =       0.004492052191
              std dev =       0.528493239894
             le_variance =       0.279305104613


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721243001571e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-06, overlap shift 3.7253e-05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908766732097       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909559623930       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909695007672       residual = 8.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909755089998       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909767410929       residual = 6.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909768382060       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909769225741       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909768216141       residual = 9.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909768050203       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909767850875       residual = 6.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.909767795735       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.909767704827       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-06 is 2.807111e-03

solving harmonic davidson linear method for identity shift 1.4901e-05, overlap shift 1.4901e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908766732097       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909559511292       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909694871094       residual = 8.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909754940011       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909767257500       residual = 6.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909768227959       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909769071324       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909768061996       residual = 9.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909767896106       residual = 2.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909767696858       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.909767641733       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.909767550860       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-05 is 2.806569e-03

solving harmonic davidson linear method for identity shift 5.9605e-05, overlap shift 5.9605e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908766732097       residual = 1.83e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909559061062       residual = 2.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909694325185       residual = 8.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909754340523       residual = 2.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909766644258       residual = 6.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909767612032       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909768454138       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909767445897       residual = 9.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909767280198       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909767081271       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.909767026204       residual = 1.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.909766935474       residual = 2.88e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-05 is 2.804405e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.392290 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6440e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_001                -4.133861e-02 3 1  ON 0
ci_002                -3.407956e-02 3 1  ON 1
ci_003                -2.571804e-02 3 1  ON 2
ci_004                 2.348525e-02 3 1  ON 3
ci_005                 2.475300e-02 3 1  ON 4
ci_006                -2.177104e-02 3 1  ON 5
ci_007                -2.087588e-02 3 1  ON 6
ci_008                -8.683584e-03 3 1  ON 7
ci_009                -1.507096e-02 3 1  ON 8
ci_010                -9.697710e-03 3 1  ON 9
ci_011                -1.071791e-02 3 1  ON 10
ci_012                -9.466286e-03 3 1  ON 11
ci_013                -1.972951e-02 3 1  ON 12
ci_014                 1.170377e-02 3 1  ON 13
ci_015                 1.164196e-02 3 1  ON 14
ci_016                 1.698513e-02 3 1  ON 15
ci_017                 1.766407e-02 3 1  ON 16
ci_018                 9.919187e-03 3 1  ON 17
ci_019                 1.152869e-02 3 1  ON 18
ci_020                 1.714019e-02 3 1  ON 19
ci_021                 1.792621e-02 3 1  ON 20
ci_022                 9.822915e-03 3 1  ON 21
ci_023                 1.056815e-02 3 1  ON 22
ci_024                 9.724454e-03 3 1  ON 23
ci_025                 1.007900e-02 3 1  ON 24
ci_026                 1.122752e-02 3 1  ON 25
ci_027                 1.081484e-02 3 1  ON 26
ci_028                -1.537334e-02 3 1  ON 27
ci_029                -1.543103e-02 3 1  ON 28
ci_030                -9.570675e-03 3 1  ON 29
ci_031                -9.485783e-03 3 1  ON 30
ci_032                -1.427349e-02 3 1  ON 31
ci_033                 5.826815e-03 3 1  ON 32
ci_034                 5.851797e-03 3 1  ON 33
ci_035                -4.870759e-03 3 1  ON 34
ci_036                -1.305179e-02 3 1  ON 35
ci_037                -1.348414e-02 3 1  ON 36
ci_038                 2.135328e-03 3 1  ON 37
ci_039                 2.257037e-03 3 1  ON 38
ci_040                -3.194085e-03 3 1  ON 39
ci_041                 7.982555e-03 3 1  ON 40
ci_042                 9.092016e-03 3 1  ON 41
ci_043                -4.116153e-03 3 1  ON 42
ci_044                -3.113398e-03 3 1  ON 43
ci_045                -3.370943e-03 3 1  ON 44
ci_046                 5.786431e-03 3 1  ON 45
ci_047                 6.036979e-03 3 1  ON 46
ci_048                -1.518235e-02 3 1  ON 47
ci_049                -1.356762e-02 3 1  ON 48
ci_050                 3.099372e-03 3 1  ON 49
ci_051                 2.538581e-03 3 1  ON 50
ci_052                -3.164044e-03 3 1  ON 51
ci_053                -2.435321e-03 3 1  ON 52
ci_054                -3.173730e-03 3 1  ON 53
ci_055                -3.423855e-03 3 1  ON 54
ci_056                 5.705854e-03 3 1  ON 55
ci_057                 4.426917e-03 3 1  ON 56
ci_058                -5.646030e-04 3 1  ON 57
ci_059                -2.660353e-03 3 1  ON 58
ci_060                 4.662267e-03 3 1  ON 59
ci_061                 5.414236e-03 3 1  ON 60
ci_062                -4.609708e-03 3 1  ON 61
ci_063                -4.559681e-03 3 1  ON 62
ci_064                -3.134233e-03 3 1  ON 63
ci_065                -3.870276e-03 3 1  ON 64
ci_066                 5.146752e-03 3 1  ON 65
ci_067                 4.824165e-03 3 1  ON 66
ci_068                -6.403908e-03 3 1  ON 67
ci_069                -4.314218e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.146
    reference variance = 0.300334
====================================================
  Execution time = 1.3562e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8677e-01
  Total weights = 1.9570e+06
  Execution time = 1.8445e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276765049933
                                         uncertainty =       0.001544857378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276765049933
                                         uncertainty =       0.001544857378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371948612
  error estimate for blocks of size 2^( 2) =       0.000385823891
  error estimate for blocks of size 2^( 3) =       0.000397895158
  error estimate for blocks of size 2^( 4) =       0.000406950236
  error estimate for blocks of size 2^( 5) =       0.000412447962
  error estimate for blocks of size 2^( 6) =       0.000416473608
  error estimate for blocks of size 2^( 7) =       0.000417825292

      target function =      -0.857269006368
              le_mean =     -17.212157407254
             les_mean =     296.593917361759
             stat err =       0.000413424274
             autocorr =       1.235452522538
   target nu stat err =       0.000413424274
   target dn stat err =       0.025144355472
      target stat err =       0.028697867793
              std dev =       0.526014771753
             le_variance =       0.276691540102

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275896560260
                                         uncertainty =       0.001447451576

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275896560260
                                         uncertainty =       0.001447451576

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371366269
  error estimate for blocks of size 2^( 2) =       0.000385423230
  error estimate for blocks of size 2^( 3) =       0.000397657944
  error estimate for blocks of size 2^( 4) =       0.000406837196
  error estimate for blocks of size 2^( 5) =       0.000412393078
  error estimate for blocks of size 2^( 6) =       0.000416444037
  error estimate for blocks of size 2^( 7) =       0.000417801987

      target function =      -0.917786752570
              le_mean =     -17.212013777785
             les_mean =     296.540187587620
             stat err =       0.000413369074
             autocorr =       1.238999283967
   target nu stat err =       0.000413369074
   target dn stat err =       0.001922049432
      target stat err =       0.002578528019
              std dev =       0.525191214624
             le_variance =       0.275825811919

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280764680450
                                         uncertainty =       0.003221291600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280764680450
                                         uncertainty =       0.003221291600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374627279
  error estimate for blocks of size 2^( 2) =       0.000388760741
  error estimate for blocks of size 2^( 3) =       0.000401057759
  error estimate for blocks of size 2^( 4) =       0.000410328121
  error estimate for blocks of size 2^( 5) =       0.000415929610
  error estimate for blocks of size 2^( 6) =       0.000419903984
  error estimate for blocks of size 2^( 7) =       0.000420998254

      target function =      -0.722134249755
              le_mean =     -17.212157320950
             les_mean =     296.709923145624
             stat err =       0.000416789992
             autocorr =       1.237758079409
   target nu stat err =       0.000416789992
   target dn stat err =       0.149014184668
      target stat err =       0.124078663599
              std dev =       0.529802978192
             le_variance =       0.280691195701

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275896124552
                                         uncertainty =       0.001447473216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275896124552
                                         uncertainty =       0.001447473216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371365975
  error estimate for blocks of size 2^( 2) =       0.000385422797
  error estimate for blocks of size 2^( 3) =       0.000397657391
  error estimate for blocks of size 2^( 4) =       0.000406836518
  error estimate for blocks of size 2^( 5) =       0.000412392353
  error estimate for blocks of size 2^( 6) =       0.000416443272
  error estimate for blocks of size 2^( 7) =       0.000417801184

      target function =      -0.917788342319
              le_mean =     -17.212013764405
             les_mean =     296.540185909086
             stat err =       0.000413368332
             autocorr =       1.238996793764
   target nu stat err =       0.000413368332
   target dn stat err =       0.001921707649
      target stat err =       0.002578101767
              std dev =       0.525190799066
             le_variance =       0.275825375424


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.857269006368        initial
     3.7253e-06     3.7253e-05             2.8071e-03        -0.917786752570
     1.4901e-05     1.4901e-04             2.8066e-03        -0.722134249755
     5.9605e-05     5.9605e-04             2.8044e-03        -0.917788342319  <--

*****************************************************************************
Applying the update for shift_i =   5.9605e-05     and shift_s =   5.9605e-04
*****************************************************************************

  Execution time = 2.2869e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_001                -4.134012e-02 3 1  ON 0
ci_002                -3.407876e-02 3 1  ON 1
ci_003                -2.571923e-02 3 1  ON 2
ci_004                 2.348623e-02 3 1  ON 3
ci_005                 2.475176e-02 3 1  ON 4
ci_006                -2.177115e-02 3 1  ON 5
ci_007                -2.087662e-02 3 1  ON 6
ci_008                -8.684049e-03 3 1  ON 7
ci_009                -1.507069e-02 3 1  ON 8
ci_010                -9.697598e-03 3 1  ON 9
ci_011                -1.071723e-02 3 1  ON 10
ci_012                -9.467458e-03 3 1  ON 11
ci_013                -1.973010e-02 3 1  ON 12
ci_014                 1.170427e-02 3 1  ON 13
ci_015                 1.164269e-02 3 1  ON 14
ci_016                 1.698524e-02 3 1  ON 15
ci_017                 1.766362e-02 3 1  ON 16
ci_018                 9.919350e-03 3 1  ON 17
ci_019                 1.152810e-02 3 1  ON 18
ci_020                 1.714009e-02 3 1  ON 19
ci_021                 1.792598e-02 3 1  ON 20
ci_022                 9.823648e-03 3 1  ON 21
ci_023                 1.056792e-02 3 1  ON 22
ci_024                 9.723425e-03 3 1  ON 23
ci_025                 1.007825e-02 3 1  ON 24
ci_026                 1.122859e-02 3 1  ON 25
ci_027                 1.081470e-02 3 1  ON 26
ci_028                -1.537281e-02 3 1  ON 27
ci_029                -1.543065e-02 3 1  ON 28
ci_030                -9.570135e-03 3 1  ON 29
ci_031                -9.485754e-03 3 1  ON 30
ci_032                -1.427362e-02 3 1  ON 31
ci_033                 5.826849e-03 3 1  ON 32
ci_034                 5.852193e-03 3 1  ON 33
ci_035                -4.871008e-03 3 1  ON 34
ci_036                -1.305215e-02 3 1  ON 35
ci_037                -1.348423e-02 3 1  ON 36
ci_038                 2.134961e-03 3 1  ON 37
ci_039                 2.256872e-03 3 1  ON 38
ci_040                -3.193885e-03 3 1  ON 39
ci_041                 7.982731e-03 3 1  ON 40
ci_042                 9.091688e-03 3 1  ON 41
ci_043                -4.116063e-03 3 1  ON 42
ci_044                -3.114623e-03 3 1  ON 43
ci_045                -3.370917e-03 3 1  ON 44
ci_046                 5.786323e-03 3 1  ON 45
ci_047                 6.036432e-03 3 1  ON 46
ci_048                -1.518019e-02 3 1  ON 47
ci_049                -1.356741e-02 3 1  ON 48
ci_050                 3.099359e-03 3 1  ON 49
ci_051                 2.539525e-03 3 1  ON 50
ci_052                -3.164051e-03 3 1  ON 51
ci_053                -2.435629e-03 3 1  ON 52
ci_054                -3.173582e-03 3 1  ON 53
ci_055                -3.423416e-03 3 1  ON 54
ci_056                 5.706136e-03 3 1  ON 55
ci_057                 4.427966e-03 3 1  ON 56
ci_058                -5.657622e-04 3 1  ON 57
ci_059                -2.660144e-03 3 1  ON 58
ci_060                 4.663184e-03 3 1  ON 59
ci_061                 5.414046e-03 3 1  ON 60
ci_062                -4.609142e-03 3 1  ON 61
ci_063                -4.558935e-03 3 1  ON 62
ci_064                -3.134205e-03 3 1  ON 63
ci_065                -3.870565e-03 3 1  ON 64
ci_066                 5.146294e-03 3 1  ON 65
ci_067                 4.824114e-03 3 1  ON 66
ci_068                -6.403503e-03 3 1  ON 67
ci_069                -4.314673e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9314e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.2987
    reference variance = 0.632162
====================================================
  Execution time = 1.4090e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5250e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.9088e-01
  Total weights = 1.957014409e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5139e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277991081001
                                         uncertainty =       0.001892338467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277991081001
                                         uncertainty =       0.001892338467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372804084
  error estimate for blocks of size 2^( 2) =       0.000386939485
  error estimate for blocks of size 2^( 3) =       0.000399590997
  error estimate for blocks of size 2^( 4) =       0.000408677960
  error estimate for blocks of size 2^( 5) =       0.000413864204
  error estimate for blocks of size 2^( 6) =       0.000418312456
  error estimate for blocks of size 2^( 7) =       0.000420514082

      target function =      -0.912307182578
              le_mean =     -17.211472555666
             les_mean =     296.525663664978
             stat err =       0.000415342176
             autocorr =       1.241225659543
   target nu stat err =       0.000415342176
   target dn stat err =       0.003118389213
      target stat err =       0.004063953527
              std dev =       0.527224591242
             le_variance =       0.277965769610


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721147255567e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-05, overlap shift 1.4901e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912324385962       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913066167984       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913172632860       residual = 8.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913226814386       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913236642201       residual = 4.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913240163131       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913240678714       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913240849506       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913240985264       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913241259389       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913241296776       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913241265553       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-05 is 2.797995e-03

solving harmonic davidson linear method for identity shift 5.9605e-05, overlap shift 5.9605e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912324385962       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913065739792       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913172129208       residual = 8.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913226261853       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913236078402       residual = 4.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913239594551       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913240109418       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913240279786       residual = 1.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913240415268       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913240688986       residual = 7.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913240726303       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913240695125       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-05 is 2.795969e-03

solving harmonic davidson linear method for identity shift 2.3842e-04, overlap shift 2.3842e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912324385962       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913064031954       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913170120570       residual = 8.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913224058514       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913233830220       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913237327348       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913237839376       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913238008057       residual = 1.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913238142444       residual = 3.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913238414546       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913238451583       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913238420586       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-04 is 2.787891e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.397098 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6614e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_001                -4.129998e-02 3 1  ON 0
ci_002                -3.221922e-02 3 1  ON 1
ci_003                -2.622705e-02 3 1  ON 2
ci_004                 2.407069e-02 3 1  ON 3
ci_005                 2.528093e-02 3 1  ON 4
ci_006                -2.108662e-02 3 1  ON 5
ci_007                -2.183658e-02 3 1  ON 6
ci_008                -8.209127e-03 3 1  ON 7
ci_009                -1.405747e-02 3 1  ON 8
ci_010                -9.413738e-03 3 1  ON 9
ci_011                -1.117209e-02 3 1  ON 10
ci_012                -1.004093e-02 3 1  ON 11
ci_013                -1.872152e-02 3 1  ON 12
ci_014                 1.294387e-02 3 1  ON 13
ci_015                 1.081609e-02 3 1  ON 14
ci_016                 1.661216e-02 3 1  ON 15
ci_017                 1.692478e-02 3 1  ON 16
ci_018                 1.235792e-02 3 1  ON 17
ci_019                 1.069811e-02 3 1  ON 18
ci_020                 1.791304e-02 3 1  ON 19
ci_021                 1.750904e-02 3 1  ON 20
ci_022                 1.034652e-02 3 1  ON 21
ci_023                 1.022650e-02 3 1  ON 22
ci_024                 9.434674e-03 3 1  ON 23
ci_025                 7.282281e-03 3 1  ON 24
ci_026                 1.231717e-02 3 1  ON 25
ci_027                 1.128158e-02 3 1  ON 26
ci_028                -1.479841e-02 3 1  ON 27
ci_029                -1.495096e-02 3 1  ON 28
ci_030                -9.260022e-03 3 1  ON 29
ci_031                -9.883160e-03 3 1  ON 30
ci_032                -1.432345e-02 3 1  ON 31
ci_033                 4.999765e-03 3 1  ON 32
ci_034                 6.313524e-03 3 1  ON 33
ci_035                -5.257259e-03 3 1  ON 34
ci_036                -1.367030e-02 3 1  ON 35
ci_037                -1.254302e-02 3 1  ON 36
ci_038                 2.108943e-03 3 1  ON 37
ci_039                 2.169375e-03 3 1  ON 38
ci_040                -4.031011e-03 3 1  ON 39
ci_041                 7.549934e-03 3 1  ON 40
ci_042                 9.312218e-03 3 1  ON 41
ci_043                -4.421081e-03 3 1  ON 42
ci_044                -4.908248e-03 3 1  ON 43
ci_045                -3.379120e-03 3 1  ON 44
ci_046                 5.707388e-03 3 1  ON 45
ci_047                 5.727739e-03 3 1  ON 46
ci_048                -1.245114e-02 3 1  ON 47
ci_049                -1.360102e-02 3 1  ON 48
ci_050                 3.061067e-03 3 1  ON 49
ci_051                 2.466465e-03 3 1  ON 50
ci_052                -1.987325e-03 3 1  ON 51
ci_053                -3.169734e-03 3 1  ON 52
ci_054                -2.854696e-03 3 1  ON 53
ci_055                -2.862161e-03 3 1  ON 54
ci_056                 4.767677e-03 3 1  ON 55
ci_057                 5.592806e-03 3 1  ON 56
ci_058                -2.299082e-03 3 1  ON 57
ci_059                -1.681656e-03 3 1  ON 58
ci_060                 4.811460e-03 3 1  ON 59
ci_061                 5.917911e-03 3 1  ON 60
ci_062                -3.677682e-03 3 1  ON 61
ci_063                -3.760037e-03 3 1  ON 62
ci_064                -2.820525e-03 3 1  ON 63
ci_065                -4.098998e-03 3 1  ON 64
ci_066                 4.490911e-03 3 1  ON 65
ci_067                 4.937767e-03 3 1  ON 66
ci_068                -4.972370e-03 3 1  ON 67
ci_069                -5.751866e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.2257
    reference variance = 0.215985
====================================================
  Execution time = 1.3570e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8726e-01
  Total weights = 1.9571e+06
  Execution time = 1.8608e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0912014
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292944408493
                                         uncertainty =       0.015307497205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.292944408493
                                         uncertainty =       0.015307497205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382674075
  error estimate for blocks of size 2^( 2) =       0.000396319830
  error estimate for blocks of size 2^( 3) =       0.000408505015
  error estimate for blocks of size 2^( 4) =       0.000417037645
  error estimate for blocks of size 2^( 5) =       0.000423104541
  error estimate for blocks of size 2^( 6) =       0.000428112141
  error estimate for blocks of size 2^( 7) =       0.000429166585

      target function =      -0.470434182436
              le_mean =     -17.211701499032
             les_mean =     297.049412463028
             stat err =       0.000424355228
             autocorr =       1.229705265382
   target nu stat err =       0.000424355228
   target dn stat err =       0.426407691975
      target stat err =       0.164016125630
              std dev =       0.541182866214
             le_variance =       0.292878894683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276770283974
                                         uncertainty =       0.001484417707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276770283974
                                         uncertainty =       0.001484417707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371982351
  error estimate for blocks of size 2^( 2) =       0.000386038865
  error estimate for blocks of size 2^( 3) =       0.000398617072
  error estimate for blocks of size 2^( 4) =       0.000407168594
  error estimate for blocks of size 2^( 5) =       0.000413277766
  error estimate for blocks of size 2^( 6) =       0.000418159537
  error estimate for blocks of size 2^( 7) =       0.000419936374

      target function =      -0.917035181524
              le_mean =     -17.211601371413
             les_mean =     296.526484325629
             stat err =       0.000414635568
             autocorr =       1.242477227368
   target nu stat err =       0.000414635568
   target dn stat err =       0.001965933907
      target stat err =       0.002628886795
              std dev =       0.526062485823
             le_variance =       0.276741738990

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0881381
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278705995371
                                         uncertainty =       0.001502251927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278705995371
                                         uncertainty =       0.001502251927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373280119
  error estimate for blocks of size 2^( 2) =       0.000387336558
  error estimate for blocks of size 2^( 3) =       0.000399931882
  error estimate for blocks of size 2^( 4) =       0.000408462607
  error estimate for blocks of size 2^( 5) =       0.000414625119
  error estimate for blocks of size 2^( 6) =       0.000419511925
  error estimate for blocks of size 2^( 7) =       0.000421485271

      target function =      -0.889582732385
              le_mean =     -17.211687390589
             les_mean =     296.551070703215
             stat err =       0.000416021230
             autocorr =       1.242113464666
   target nu stat err =       0.000416021230
   target dn stat err =       0.008945315133
      target stat err =       0.010988027085
              std dev =       0.527897806211
             le_variance =       0.278676093803

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276768153923
                                         uncertainty =       0.001484431533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276768153923
                                         uncertainty =       0.001484431533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371980920
  error estimate for blocks of size 2^( 2) =       0.000386037396
  error estimate for blocks of size 2^( 3) =       0.000398615559
  error estimate for blocks of size 2^( 4) =       0.000407167117
  error estimate for blocks of size 2^( 5) =       0.000413276074
  error estimate for blocks of size 2^( 6) =       0.000418157941
  error estimate for blocks of size 2^( 7) =       0.000419934425

      target function =      -0.917007932364
              le_mean =     -17.211601489541
             les_mean =     296.526509324588
             stat err =       0.000414633889
             autocorr =       1.242476723775
   target nu stat err =       0.000414633889
   target dn stat err =       0.001966188816
      target stat err =       0.002629058166
              std dev =       0.526060462358
             le_variance =       0.276739610057


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.470434182436        initial
     1.4901e-05     1.4901e-04             2.7980e-03        -0.917035181524  <--
     5.9605e-05     5.9605e-04             2.7960e-03        -0.889582732385
     2.3842e-04     2.3842e-03             2.7879e-03        -0.917007932364

*****************************************************************************
Applying the update for shift_i =   1.4901e-05     and shift_s =   1.4901e-04
*****************************************************************************

  Execution time = 2.2933e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_001                -4.129996e-02 3 1  ON 0
ci_002                -3.221791e-02 3 1  ON 1
ci_003                -2.622739e-02 3 1  ON 2
ci_004                 2.407125e-02 3 1  ON 3
ci_005                 2.528144e-02 3 1  ON 4
ci_006                -2.108614e-02 3 1  ON 5
ci_007                -2.183734e-02 3 1  ON 6
ci_008                -8.208878e-03 3 1  ON 7
ci_009                -1.405685e-02 3 1  ON 8
ci_010                -9.413576e-03 3 1  ON 9
ci_011                -1.117237e-02 3 1  ON 10
ci_012                -1.004130e-02 3 1  ON 11
ci_013                -1.872071e-02 3 1  ON 12
ci_014                 1.294478e-02 3 1  ON 13
ci_015                 1.081545e-02 3 1  ON 14
ci_016                 1.661188e-02 3 1  ON 15
ci_017                 1.692424e-02 3 1  ON 16
ci_018                 1.235935e-02 3 1  ON 17
ci_019                 1.069767e-02 3 1  ON 18
ci_020                 1.791358e-02 3 1  ON 19
ci_021                 1.750895e-02 3 1  ON 20
ci_022                 1.034684e-02 3 1  ON 21
ci_023                 1.022635e-02 3 1  ON 22
ci_024                 9.434411e-03 3 1  ON 23
ci_025                 7.280254e-03 3 1  ON 24
ci_026                 1.231787e-02 3 1  ON 25
ci_027                 1.128194e-02 3 1  ON 26
ci_028                -1.479799e-02 3 1  ON 27
ci_029                -1.495061e-02 3 1  ON 28
ci_030                -9.259615e-03 3 1  ON 29
ci_031                -9.883373e-03 3 1  ON 30
ci_032                -1.432350e-02 3 1  ON 31
ci_033                 4.999211e-03 3 1  ON 32
ci_034                 6.313823e-03 3 1  ON 33
ci_035                -5.257489e-03 3 1  ON 34
ci_036                -1.367067e-02 3 1  ON 35
ci_037                -1.254251e-02 3 1  ON 36
ci_038                 2.108929e-03 3 1  ON 37
ci_039                 2.169326e-03 3 1  ON 38
ci_040                -4.031497e-03 3 1  ON 39
ci_041                 7.549656e-03 3 1  ON 40
ci_042                 9.312306e-03 3 1  ON 41
ci_043                -4.421267e-03 3 1  ON 42
ci_044                -4.909415e-03 3 1  ON 43
ci_045                -3.379127e-03 3 1  ON 44
ci_046                 5.707338e-03 3 1  ON 45
ci_047                 5.727533e-03 3 1  ON 46
ci_048                -1.244903e-02 3 1  ON 47
ci_049                -1.360103e-02 3 1  ON 48
ci_050                 3.061050e-03 3 1  ON 49
ci_051                 2.466437e-03 3 1  ON 50
ci_052                -1.986643e-03 3 1  ON 51
ci_053                -3.170158e-03 3 1  ON 52
ci_054                -2.854512e-03 3 1  ON 53
ci_055                -2.861858e-03 3 1  ON 54
ci_056                 4.767107e-03 3 1  ON 55
ci_057                 5.593518e-03 3 1  ON 56
ci_058                -2.300143e-03 3 1  ON 57
ci_059                -1.681031e-03 3 1  ON 58
ci_060                 4.811550e-03 3 1  ON 59
ci_061                 5.918250e-03 3 1  ON 60
ci_062                -3.677087e-03 3 1  ON 61
ci_063                -3.759432e-03 3 1  ON 62
ci_064                -2.820344e-03 3 1  ON 63
ci_065                -4.099130e-03 3 1  ON 64
ci_066                 4.490532e-03 3 1  ON 65
ci_067                 4.937832e-03 3 1  ON 66
ci_068                -4.971449e-03 3 1  ON 67
ci_069                -5.752797e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9553e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.1749
    reference variance = 0.215782
====================================================
  Execution time = 1.4127e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5267e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8787e-01
  Total weights = 1.957069466e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4927e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276686409252
                                         uncertainty =       0.001544365497

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276686409252
                                         uncertainty =       0.001544365497

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371955726
  error estimate for blocks of size 2^( 2) =       0.000385770737
  error estimate for blocks of size 2^( 3) =       0.000398584878
  error estimate for blocks of size 2^( 4) =       0.000407231242
  error estimate for blocks of size 2^( 5) =       0.000413282338
  error estimate for blocks of size 2^( 6) =       0.000416288415
  error estimate for blocks of size 2^( 7) =       0.000417835000

      target function =      -0.916337297970
              le_mean =     -17.211990338497
             les_mean =     296.540486361234
             stat err =       0.000413659249
             autocorr =       1.236809980166
   target nu stat err =       0.000413659249
   target dn stat err =       0.002120595305
      target stat err =       0.002822884634
              std dev =       0.526024832166
             le_variance =       0.276702124055


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721199033850e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-06, overlap shift 3.7253e-05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916345197958       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916812713901       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916879340431       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916919507364       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916927283115       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916931471091       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916932936331       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916933329767       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916933234444       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916933212818       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916933153114       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916933135680       residual = 4.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-06 is 1.889987e-03

solving harmonic davidson linear method for identity shift 1.4901e-05, overlap shift 1.4901e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916345197958       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916812648308       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916879263242       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916919421752       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916927195461       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916931382232       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916932847027       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916933240295       residual = 7.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916933144992       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916933123376       residual = 4.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916933063691       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916933046268       residual = 4.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-05 is 1.889649e-03

solving harmonic davidson linear method for identity shift 5.9605e-05, overlap shift 5.9605e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916345197958       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916812386119       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916878954708       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916919079561       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916926845112       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916931027068       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916932490087       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916932882685       residual = 7.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916932787459       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916932765882       residual = 4.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916932706279       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916932688896       residual = 4.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-05 is 1.888295e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.401919 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6630e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_001                -4.170337e-02 3 1  ON 0
ci_002                -3.230008e-02 3 1  ON 1
ci_003                -2.741210e-02 3 1  ON 2
ci_004                 2.329703e-02 3 1  ON 3
ci_005                 2.463266e-02 3 1  ON 4
ci_006                -2.168809e-02 3 1  ON 5
ci_007                -2.105727e-02 3 1  ON 6
ci_008                -8.789784e-03 3 1  ON 7
ci_009                -1.500168e-02 3 1  ON 8
ci_010                -9.334520e-03 3 1  ON 9
ci_011                -1.074607e-02 3 1  ON 10
ci_012                -1.079663e-02 3 1  ON 11
ci_013                -1.955519e-02 3 1  ON 12
ci_014                 1.297135e-02 3 1  ON 13
ci_015                 1.216831e-02 3 1  ON 14
ci_016                 1.702709e-02 3 1  ON 15
ci_017                 1.632173e-02 3 1  ON 16
ci_018                 1.062232e-02 3 1  ON 17
ci_019                 1.120291e-02 3 1  ON 18
ci_020                 1.737125e-02 3 1  ON 19
ci_021                 1.820401e-02 3 1  ON 20
ci_022                 1.004996e-02 3 1  ON 21
ci_023                 1.024215e-02 3 1  ON 22
ci_024                 9.901808e-03 3 1  ON 23
ci_025                 9.169903e-03 3 1  ON 24
ci_026                 1.128212e-02 3 1  ON 25
ci_027                 1.103068e-02 3 1  ON 26
ci_028                -1.492909e-02 3 1  ON 27
ci_029                -1.579112e-02 3 1  ON 28
ci_030                -9.402806e-03 3 1  ON 29
ci_031                -9.147669e-03 3 1  ON 30
ci_032                -1.417592e-02 3 1  ON 31
ci_033                 5.044698e-03 3 1  ON 32
ci_034                 5.171144e-03 3 1  ON 33
ci_035                -5.433445e-03 3 1  ON 34
ci_036                -1.312695e-02 3 1  ON 35
ci_037                -1.363315e-02 3 1  ON 36
ci_038                 2.019920e-03 3 1  ON 37
ci_039                 1.811521e-03 3 1  ON 38
ci_040                -3.400001e-03 3 1  ON 39
ci_041                 8.293760e-03 3 1  ON 40
ci_042                 9.313843e-03 3 1  ON 41
ci_043                -4.484687e-03 3 1  ON 42
ci_044                -5.588981e-03 3 1  ON 43
ci_045                -3.447728e-03 3 1  ON 44
ci_046                 5.475920e-03 3 1  ON 45
ci_047                 5.557838e-03 3 1  ON 46
ci_048                -1.342614e-02 3 1  ON 47
ci_049                -1.369243e-02 3 1  ON 48
ci_050                 3.097265e-03 3 1  ON 49
ci_051                 3.685418e-03 3 1  ON 50
ci_052                -2.558648e-03 3 1  ON 51
ci_053                -2.739882e-03 3 1  ON 52
ci_054                -2.522648e-03 3 1  ON 53
ci_055                -2.792621e-03 3 1  ON 54
ci_056                 5.609793e-03 3 1  ON 55
ci_057                 6.206353e-03 3 1  ON 56
ci_058                -1.608473e-03 3 1  ON 57
ci_059                -2.129019e-03 3 1  ON 58
ci_060                 4.907681e-03 3 1  ON 59
ci_061                 5.084981e-03 3 1  ON 60
ci_062                -4.251215e-03 3 1  ON 61
ci_063                -3.868468e-03 3 1  ON 62
ci_064                -3.297027e-03 3 1  ON 63
ci_065                -3.949820e-03 3 1  ON 64
ci_066                 5.188589e-03 3 1  ON 65
ci_067                 4.704725e-03 3 1  ON 66
ci_068                -4.153641e-03 3 1  ON 67
ci_069                -5.187388e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.1977
    reference variance = 0.172022
====================================================
  Execution time = 1.3649e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8376e-01
  Total weights = 1.9570e+06
  Execution time = 1.8686e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274104430355
                                         uncertainty =       0.001358368586

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274104430355
                                         uncertainty =       0.001358368586

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370200440
  error estimate for blocks of size 2^( 2) =       0.000384224522
  error estimate for blocks of size 2^( 3) =       0.000396522523
  error estimate for blocks of size 2^( 4) =       0.000405336983
  error estimate for blocks of size 2^( 5) =       0.000411478535
  error estimate for blocks of size 2^( 6) =       0.000415742672
  error estimate for blocks of size 2^( 7) =       0.000418134702

      target function =      -0.915432694842
              le_mean =     -17.212371050464
             les_mean =     296.554360782886
             stat err =       0.000412673223
             autocorr =       1.242621082621
   target nu stat err =       0.000412673223
   target dn stat err =       0.002419923323
      target stat err =       0.003200518565
              std dev =       0.523542483583
             le_variance =       0.274096732117

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273584401257
                                         uncertainty =       0.001383564489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273584401257
                                         uncertainty =       0.001383564489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369848493
  error estimate for blocks of size 2^( 2) =       0.000383832130
  error estimate for blocks of size 2^( 3) =       0.000396090980
  error estimate for blocks of size 2^( 4) =       0.000404901099
  error estimate for blocks of size 2^( 5) =       0.000410972344
  error estimate for blocks of size 2^( 6) =       0.000415224464
  error estimate for blocks of size 2^( 7) =       0.000417497378

      target function =      -0.921798454351
              le_mean =     -17.212275038404
             les_mean =     296.546176270879
             stat err =       0.000412148821
             autocorr =       1.241825051959
   target nu stat err =       0.000412148821
   target dn stat err =       0.002017667636
      target stat err =       0.002724101865
              std dev =       0.523044755243
             le_variance =       0.273575815987

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276695313670
                                         uncertainty =       0.002567419355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276695313670
                                         uncertainty =       0.002567419355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371943055
  error estimate for blocks of size 2^( 2) =       0.000385831940
  error estimate for blocks of size 2^( 3) =       0.000398017502
  error estimate for blocks of size 2^( 4) =       0.000406746050
  error estimate for blocks of size 2^( 5) =       0.000412690421
  error estimate for blocks of size 2^( 6) =       0.000416967928
  error estimate for blocks of size 2^( 7) =       0.000419355137

      target function =      -0.792242530817
              le_mean =     -17.212293473836
             les_mean =     296.651515347457
             stat err =       0.000413939884
             autocorr =       1.238573091695
   target nu stat err =       0.000413939884
   target dn stat err =       0.088196239072
      target stat err =       0.086908612657
              std dev =       0.526006912202
             le_variance =       0.276683271684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273584301117
                                         uncertainty =       0.001383536702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273584301117
                                         uncertainty =       0.001383536702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369848426
  error estimate for blocks of size 2^( 2) =       0.000383832100
  error estimate for blocks of size 2^( 3) =       0.000396090977
  error estimate for blocks of size 2^( 4) =       0.000404901105
  error estimate for blocks of size 2^( 5) =       0.000410972402
  error estimate for blocks of size 2^( 6) =       0.000415224537
  error estimate for blocks of size 2^( 7) =       0.000417497550

      target function =      -0.921798479106
              le_mean =     -17.212275047618
             les_mean =     296.546176571850
             stat err =       0.000412148898
             autocorr =       1.241825966258
   target nu stat err =       0.000412148898
   target dn stat err =       0.002017549627
      target stat err =       0.002723950200
              std dev =       0.523044660584
             le_variance =       0.273575716965


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.915432694842        initial
     3.7253e-06     3.7253e-05             1.8900e-03        -0.921798454351
     1.4901e-05     1.4901e-04             1.8896e-03        -0.792242530817
     5.9605e-05     5.9605e-04             1.8883e-03        -0.921798479106  <--

*****************************************************************************
Applying the update for shift_i =   5.9605e-05     and shift_s =   5.9605e-04
*****************************************************************************

  Execution time = 2.3044e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_001                -4.170305e-02 3 1  ON 0
ci_002                -3.230003e-02 3 1  ON 1
ci_003                -2.741125e-02 3 1  ON 2
ci_004                 2.329771e-02 3 1  ON 3
ci_005                 2.463321e-02 3 1  ON 4
ci_006                -2.168763e-02 3 1  ON 5
ci_007                -2.105785e-02 3 1  ON 6
ci_008                -8.789433e-03 3 1  ON 7
ci_009                -1.500111e-02 3 1  ON 8
ci_010                -9.334564e-03 3 1  ON 9
ci_011                -1.074632e-02 3 1  ON 10
ci_012                -1.079616e-02 3 1  ON 11
ci_013                -1.955455e-02 3 1  ON 12
ci_014                 1.297134e-02 3 1  ON 13
ci_015                 1.216735e-02 3 1  ON 14
ci_016                 1.702679e-02 3 1  ON 15
ci_017                 1.632217e-02 3 1  ON 16
ci_018                 1.062331e-02 3 1  ON 17
ci_019                 1.120265e-02 3 1  ON 18
ci_020                 1.737163e-02 3 1  ON 19
ci_021                 1.820363e-02 3 1  ON 20
ci_022                 1.005011e-02 3 1  ON 21
ci_023                 1.024217e-02 3 1  ON 22
ci_024                 9.901440e-03 3 1  ON 23
ci_025                 9.168549e-03 3 1  ON 24
ci_026                 1.128280e-02 3 1  ON 25
ci_027                 1.103090e-02 3 1  ON 26
ci_028                -1.492896e-02 3 1  ON 27
ci_029                -1.579051e-02 3 1  ON 28
ci_030                -9.402639e-03 3 1  ON 29
ci_031                -9.148117e-03 3 1  ON 30
ci_032                -1.417603e-02 3 1  ON 31
ci_033                 5.044683e-03 3 1  ON 32
ci_034                 5.171891e-03 3 1  ON 33
ci_035                -5.433340e-03 3 1  ON 34
ci_036                -1.312716e-02 3 1  ON 35
ci_037                -1.363244e-02 3 1  ON 36
ci_038                 2.019972e-03 3 1  ON 37
ci_039                 1.811732e-03 3 1  ON 38
ci_040                -3.400363e-03 3 1  ON 39
ci_041                 8.293317e-03 3 1  ON 40
ci_042                 9.313792e-03 3 1  ON 41
ci_043                -4.484649e-03 3 1  ON 42
ci_044                -5.588563e-03 3 1  ON 43
ci_045                -3.447690e-03 3 1  ON 44
ci_046                 5.476068e-03 3 1  ON 45
ci_047                 5.557947e-03 3 1  ON 46
ci_048                -1.342536e-02 3 1  ON 47
ci_049                -1.369242e-02 3 1  ON 48
ci_050                 3.097248e-03 3 1  ON 49
ci_051                 3.684755e-03 3 1  ON 50
ci_052                -2.558314e-03 3 1  ON 51
ci_053                -2.740114e-03 3 1  ON 52
ci_054                -2.522878e-03 3 1  ON 53
ci_055                -2.792682e-03 3 1  ON 54
ci_056                 5.609282e-03 3 1  ON 55
ci_057                 6.205980e-03 3 1  ON 56
ci_058                -1.608942e-03 3 1  ON 57
ci_059                -2.128770e-03 3 1  ON 58
ci_060                 4.907623e-03 3 1  ON 59
ci_061                 5.085523e-03 3 1  ON 60
ci_062                -4.250838e-03 3 1  ON 61
ci_063                -3.868334e-03 3 1  ON 62
ci_064                -3.296760e-03 3 1  ON 63
ci_065                -3.949908e-03 3 1  ON 64
ci_066                 5.188165e-03 3 1  ON 65
ci_067                 4.704838e-03 3 1  ON 66
ci_068                -4.154188e-03 3 1  ON 67
ci_069                -5.187752e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9679e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.2518
    reference variance = 0.230226
====================================================
  Execution time = 1.4020e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5318e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8936e-01
  Total weights = 1.957004118e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4925e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277678266902
                                         uncertainty =       0.001704213405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277678266902
                                         uncertainty =       0.001704213405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372585249
  error estimate for blocks of size 2^( 2) =       0.000386514995
  error estimate for blocks of size 2^( 3) =       0.000398767086
  error estimate for blocks of size 2^( 4) =       0.000407625482
  error estimate for blocks of size 2^( 5) =       0.000412863580
  error estimate for blocks of size 2^( 6) =       0.000416284583
  error estimate for blocks of size 2^( 7) =       0.000416910605

      target function =      -0.914558021285
              le_mean =     -17.212576642722
             les_mean =     296.562153382798
             stat err =       0.000413421062
             autocorr =       1.231214959710
   target nu stat err =       0.000413421062
   target dn stat err =       0.002166485445
      target stat err =       0.002872948889
              std dev =       0.526915112437
             le_variance =       0.277639535714


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721257664272e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-05, overlap shift 1.4901e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914566285225       residual = 9.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915037762232       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915100148527       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915136070257       residual = 9.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915141366126       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915143868360       residual = 7.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915145073904       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915145594746       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915145397250       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915145233498       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915145331981       residual = 9.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-05 is 2.232857e-03

solving harmonic davidson linear method for identity shift 5.9605e-05, overlap shift 5.9605e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914566285225       residual = 9.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915037490921       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915099832686       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915135722797       residual = 9.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915141012940       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915143511871       residual = 7.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915144716146       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915145236353       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915145039043       residual = 1.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915144875528       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915144973852       residual = 9.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-05 is 2.231558e-03

solving harmonic davidson linear method for identity shift 2.3842e-04, overlap shift 2.3842e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914566285225       residual = 9.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915036408790       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915098573054       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915134337210       residual = 9.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915139604563       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915142090354       residual = 7.41e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915143289581       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915143807261       residual = 6.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915143610689       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915143448117       residual = 3.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915143545811       residual = 8.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-04 is 2.226379e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.406007 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6521e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_001                -4.175411e-02 3 1  ON 0
ci_002                -3.310554e-02 3 1  ON 1
ci_003                -2.663840e-02 3 1  ON 2
ci_004                 2.441104e-02 3 1  ON 3
ci_005                 2.389530e-02 3 1  ON 4
ci_006                -2.144101e-02 3 1  ON 5
ci_007                -2.224772e-02 3 1  ON 6
ci_008                -9.274187e-03 3 1  ON 7
ci_009                -1.459778e-02 3 1  ON 8
ci_010                -9.692740e-03 3 1  ON 9
ci_011                -1.044530e-02 3 1  ON 10
ci_012                -1.201035e-02 3 1  ON 11
ci_013                -2.069070e-02 3 1  ON 12
ci_014                 1.330937e-02 3 1  ON 13
ci_015                 1.214161e-02 3 1  ON 14
ci_016                 1.691671e-02 3 1  ON 15
ci_017                 1.725670e-02 3 1  ON 16
ci_018                 1.163200e-02 3 1  ON 17
ci_019                 1.147217e-02 3 1  ON 18
ci_020                 1.761068e-02 3 1  ON 19
ci_021                 1.668396e-02 3 1  ON 20
ci_022                 9.586741e-03 3 1  ON 21
ci_023                 9.671286e-03 3 1  ON 22
ci_024                 8.539474e-03 3 1  ON 23
ci_025                 1.060614e-02 3 1  ON 24
ci_026                 1.187811e-02 3 1  ON 25
ci_027                 1.326246e-02 3 1  ON 26
ci_028                -1.572285e-02 3 1  ON 27
ci_029                -1.578292e-02 3 1  ON 28
ci_030                -8.981003e-03 3 1  ON 29
ci_031                -9.514087e-03 3 1  ON 30
ci_032                -1.492617e-02 3 1  ON 31
ci_033                 5.696890e-03 3 1  ON 32
ci_034                 4.051798e-03 3 1  ON 33
ci_035                -5.296049e-03 3 1  ON 34
ci_036                -1.281627e-02 3 1  ON 35
ci_037                -1.309699e-02 3 1  ON 36
ci_038                 1.601808e-03 3 1  ON 37
ci_039                 2.867583e-03 3 1  ON 38
ci_040                -3.020863e-03 3 1  ON 39
ci_041                 8.150923e-03 3 1  ON 40
ci_042                 8.181700e-03 3 1  ON 41
ci_043                -4.622037e-03 3 1  ON 42
ci_044                -3.817607e-03 3 1  ON 43
ci_045                -3.474607e-03 3 1  ON 44
ci_046                 5.731721e-03 3 1  ON 45
ci_047                 5.166798e-03 3 1  ON 46
ci_048                -1.274898e-02 3 1  ON 47
ci_049                -1.326678e-02 3 1  ON 48
ci_050                 3.246583e-03 3 1  ON 49
ci_051                 3.356061e-03 3 1  ON 50
ci_052                -2.322567e-03 3 1  ON 51
ci_053                -3.111754e-03 3 1  ON 52
ci_054                -2.716737e-03 3 1  ON 53
ci_055                -3.154736e-03 3 1  ON 54
ci_056                 5.482825e-03 3 1  ON 55
ci_057                 5.321995e-03 3 1  ON 56
ci_058                -1.837653e-03 3 1  ON 57
ci_059                -2.114533e-03 3 1  ON 58
ci_060                 5.718294e-03 3 1  ON 59
ci_061                 4.713100e-03 3 1  ON 60
ci_062                -3.960636e-03 3 1  ON 61
ci_063                -4.346366e-03 3 1  ON 62
ci_064                -3.637076e-03 3 1  ON 63
ci_065                -3.794055e-03 3 1  ON 64
ci_066                 4.529683e-03 3 1  ON 65
ci_067                 4.968951e-03 3 1  ON 66
ci_068                -5.099544e-03 3 1  ON 67
ci_069                -5.659387e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.1889
    reference variance = 0.160318
====================================================
  Execution time = 1.3633e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8867e-01
  Total weights = 1.9570e+06
  Execution time = 1.8626e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275500823890
                                         uncertainty =       0.001687748310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275500823890
                                         uncertainty =       0.001687748310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371110263
  error estimate for blocks of size 2^( 2) =       0.000385254751
  error estimate for blocks of size 2^( 3) =       0.000397324061
  error estimate for blocks of size 2^( 4) =       0.000406218795
  error estimate for blocks of size 2^( 5) =       0.000411863132
  error estimate for blocks of size 2^( 6) =       0.000414738011
  error estimate for blocks of size 2^( 7) =       0.000415129726

      target function =      -0.902019442961
              le_mean =     -17.212137628197
             les_mean =     296.556719517724
             stat err =       0.000411987416
             autocorr =       1.232429176441
   target nu stat err =       0.000411987416
   target dn stat err =       0.005467079738
      target stat err =       0.006923388990
              std dev =       0.524829167644
             le_variance =       0.275445655210

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274931840660
                                         uncertainty =       0.001599132768

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274931840660
                                         uncertainty =       0.001599132768

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370727113
  error estimate for blocks of size 2^( 2) =       0.000384822467
  error estimate for blocks of size 2^( 3) =       0.000396790400
  error estimate for blocks of size 2^( 4) =       0.000405663522
  error estimate for blocks of size 2^( 5) =       0.000411317521
  error estimate for blocks of size 2^( 6) =       0.000414254525
  error estimate for blocks of size 2^( 7) =       0.000414543517

      target function =      -0.915323884186
              le_mean =     -17.212068060896
             les_mean =     296.543952716070
             stat err =       0.000411444771
             autocorr =       1.231726817670
   target nu stat err =       0.000411444771
   target dn stat err =       0.002675068481
      target stat err =       0.003524407946
              std dev =       0.524287311026
             le_variance =       0.274877184502

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277924030961
                                         uncertainty =       0.001799873130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277924030961
                                         uncertainty =       0.001799873130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372736754
  error estimate for blocks of size 2^( 2) =       0.000386727051
  error estimate for blocks of size 2^( 3) =       0.000398537655
  error estimate for blocks of size 2^( 4) =       0.000407298510
  error estimate for blocks of size 2^( 5) =       0.000412940637
  error estimate for blocks of size 2^( 6) =       0.000415958285
  error estimate for blocks of size 2^( 7) =       0.000416283492

      target function =      -0.732478433991
              le_mean =     -17.212173850164
             les_mean =     296.710256408125
             stat err =       0.000413120231
             autocorr =       1.228424556010
   target nu stat err =       0.000413120231
   target dn stat err =       0.107022428454
      target stat err =       0.090417546670
              std dev =       0.527129372882
             le_variance =       0.277865375755

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274930776467
                                         uncertainty =       0.001599136532

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274930776467
                                         uncertainty =       0.001599136532

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370726395
  error estimate for blocks of size 2^( 2) =       0.000384821934
  error estimate for blocks of size 2^( 3) =       0.000396790225
  error estimate for blocks of size 2^( 4) =       0.000405663466
  error estimate for blocks of size 2^( 5) =       0.000411317472
  error estimate for blocks of size 2^( 6) =       0.000414254243
  error estimate for blocks of size 2^( 7) =       0.000414543493

      target function =      -0.915323452387
              le_mean =     -17.212068027481
             les_mean =     296.543951883891
             stat err =       0.000411444669
             autocorr =       1.231730970556
   target nu stat err =       0.000411444669
   target dn stat err =       0.002676089559
      target stat err =       0.003525712835
              std dev =       0.524286296167
             le_variance =       0.274876120348


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.902019442961        initial
     1.4901e-05     1.4901e-04             2.2329e-03        -0.915323884186  <--
     5.9605e-05     5.9605e-04             2.2316e-03        -0.732478433991
     2.3842e-04     2.3842e-03             2.2264e-03        -0.915323452387

*****************************************************************************
Applying the update for shift_i =   1.4901e-05     and shift_s =   1.4901e-04
*****************************************************************************

  Execution time = 2.2962e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_001                -4.175410e-02 3 1  ON 0
ci_002                -3.310611e-02 3 1  ON 1
ci_003                -2.663782e-02 3 1  ON 2
ci_004                 2.441191e-02 3 1  ON 3
ci_005                 2.389497e-02 3 1  ON 4
ci_006                -2.144079e-02 3 1  ON 5
ci_007                -2.224857e-02 3 1  ON 6
ci_008                -9.274429e-03 3 1  ON 7
ci_009                -1.459754e-02 3 1  ON 8
ci_010                -9.692955e-03 3 1  ON 9
ci_011                -1.044511e-02 3 1  ON 10
ci_012                -1.201112e-02 3 1  ON 11
ci_013                -2.069162e-02 3 1  ON 12
ci_014                 1.330961e-02 3 1  ON 13
ci_015                 1.214157e-02 3 1  ON 14
ci_016                 1.691661e-02 3 1  ON 15
ci_017                 1.725738e-02 3 1  ON 16
ci_018                 1.163250e-02 3 1  ON 17
ci_019                 1.147235e-02 3 1  ON 18
ci_020                 1.761086e-02 3 1  ON 19
ci_021                 1.668293e-02 3 1  ON 20
ci_022                 9.586390e-03 3 1  ON 21
ci_023                 9.670901e-03 3 1  ON 22
ci_024                 8.538517e-03 3 1  ON 23
ci_025                 1.060717e-02 3 1  ON 24
ci_026                 1.187855e-02 3 1  ON 25
ci_027                 1.326375e-02 3 1  ON 26
ci_028                -1.572341e-02 3 1  ON 27
ci_029                -1.578282e-02 3 1  ON 28
ci_030                -8.980700e-03 3 1  ON 29
ci_031                -9.514289e-03 3 1  ON 30
ci_032                -1.492667e-02 3 1  ON 31
ci_033                 5.697359e-03 3 1  ON 32
ci_034                 4.051038e-03 3 1  ON 33
ci_035                -5.295966e-03 3 1  ON 34
ci_036                -1.281606e-02 3 1  ON 35
ci_037                -1.309663e-02 3 1  ON 36
ci_038                 1.601567e-03 3 1  ON 37
ci_039                 2.868202e-03 3 1  ON 38
ci_040                -3.020648e-03 3 1  ON 39
ci_041                 8.150885e-03 3 1  ON 40
ci_042                 8.181017e-03 3 1  ON 41
ci_043                -4.622119e-03 3 1  ON 42
ci_044                -3.816481e-03 3 1  ON 43
ci_045                -3.474621e-03 3 1  ON 44
ci_046                 5.731890e-03 3 1  ON 45
ci_047                 5.166543e-03 3 1  ON 46
ci_048                -1.274840e-02 3 1  ON 47
ci_049                -1.326649e-02 3 1  ON 48
ci_050                 3.246661e-03 3 1  ON 49
ci_051                 3.355880e-03 3 1  ON 50
ci_052                -2.322454e-03 3 1  ON 51
ci_053                -3.111984e-03 3 1  ON 52
ci_054                -2.716869e-03 3 1  ON 53
ci_055                -3.154958e-03 3 1  ON 54
ci_056                 5.482747e-03 3 1  ON 55
ci_057                 5.321463e-03 3 1  ON 56
ci_058                -1.837800e-03 3 1  ON 57
ci_059                -2.114506e-03 3 1  ON 58
ci_060                 5.718835e-03 3 1  ON 59
ci_061                 4.712863e-03 3 1  ON 60
ci_062                -3.960392e-03 3 1  ON 61
ci_063                -4.346710e-03 3 1  ON 62
ci_064                -3.637269e-03 3 1  ON 63
ci_065                -3.793964e-03 3 1  ON 64
ci_066                 4.529266e-03 3 1  ON 65
ci_067                 4.969140e-03 3 1  ON 66
ci_068                -5.100173e-03 3 1  ON 67
ci_069                -5.659697e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9489e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.2304
    reference variance = 0.585589
====================================================
  Execution time = 1.3978e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8894e-01
  Total weights = 1.957258978e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5073e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277083669428
                                         uncertainty =       0.001505674512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277083669428
                                         uncertainty =       0.001505674512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372223737
  error estimate for blocks of size 2^( 2) =       0.000385643955
  error estimate for blocks of size 2^( 3) =       0.000397933202
  error estimate for blocks of size 2^( 4) =       0.000407093276
  error estimate for blocks of size 2^( 5) =       0.000411806098
  error estimate for blocks of size 2^( 6) =       0.000414100636
  error estimate for blocks of size 2^( 7) =       0.000415994061

      target function =      -0.915023797871
              le_mean =     -17.212279540496
             les_mean =     296.551508827686
             stat err =       0.000412248518
             autocorr =       1.226620097508
   target nu stat err =       0.000412248518
   target dn stat err =       0.002164269635
      target stat err =       0.002871332356
              std dev =       0.526403856862
             le_variance =       0.277101020519


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721227954050e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-06, overlap shift 3.7253e-05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915032026516       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915628726458       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915704509195       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915729831400       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915738696025       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915741523480       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915740895898       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915740479365       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915740662305       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915740654250       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915740531663       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915740541994       residual = 2.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-06 is 2.050385e-03

solving harmonic davidson linear method for identity shift 1.4901e-05, overlap shift 1.4901e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915032026516       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915628640645       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915704409956       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915729726276       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915738588694       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915741415426       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915740787931       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915740371489       residual = 6.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915740554367       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915740546315       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915740423774       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915740434101       residual = 2.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-05 is 2.050057e-03

solving harmonic davidson linear method for identity shift 5.9605e-05, overlap shift 5.9605e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915032026516       residual = 1.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915628297639       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915704013292       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915729306097       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915738159699       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915740983544       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915740356396       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915739940317       residual = 6.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915740122943       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915740114908       residual = 4.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915739992551       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915740002864       residual = 2.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-05 is 2.048746e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.410802 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6496e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_001                -4.231007e-02 3 1  ON 0
ci_002                -3.293784e-02 3 1  ON 1
ci_003                -2.645375e-02 3 1  ON 2
ci_004                 2.389526e-02 3 1  ON 3
ci_005                 2.289931e-02 3 1  ON 4
ci_006                -2.158743e-02 3 1  ON 5
ci_007                -2.149115e-02 3 1  ON 6
ci_008                -9.534311e-03 3 1  ON 7
ci_009                -1.567205e-02 3 1  ON 8
ci_010                -9.750943e-03 3 1  ON 9
ci_011                -1.046453e-02 3 1  ON 10
ci_012                -1.047258e-02 3 1  ON 11
ci_013                -1.979526e-02 3 1  ON 12
ci_014                 1.231939e-02 3 1  ON 13
ci_015                 1.153070e-02 3 1  ON 14
ci_016                 1.666474e-02 3 1  ON 15
ci_017                 1.651457e-02 3 1  ON 16
ci_018                 1.021424e-02 3 1  ON 17
ci_019                 1.174785e-02 3 1  ON 18
ci_020                 1.868229e-02 3 1  ON 19
ci_021                 1.859713e-02 3 1  ON 20
ci_022                 1.063618e-02 3 1  ON 21
ci_023                 9.661325e-03 3 1  ON 22
ci_024                 1.017521e-02 3 1  ON 23
ci_025                 9.370642e-03 3 1  ON 24
ci_026                 1.198506e-02 3 1  ON 25
ci_027                 1.121370e-02 3 1  ON 26
ci_028                -1.550917e-02 3 1  ON 27
ci_029                -1.614634e-02 3 1  ON 28
ci_030                -9.631941e-03 3 1  ON 29
ci_031                -9.310681e-03 3 1  ON 30
ci_032                -1.430388e-02 3 1  ON 31
ci_033                 5.387965e-03 3 1  ON 32
ci_034                 5.770090e-03 3 1  ON 33
ci_035                -5.430702e-03 3 1  ON 34
ci_036                -1.379597e-02 3 1  ON 35
ci_037                -1.298764e-02 3 1  ON 36
ci_038                 1.949379e-03 3 1  ON 37
ci_039                 2.173307e-03 3 1  ON 38
ci_040                -4.002029e-03 3 1  ON 39
ci_041                 8.867512e-03 3 1  ON 40
ci_042                 9.059440e-03 3 1  ON 41
ci_043                -4.412654e-03 3 1  ON 42
ci_044                -4.084403e-03 3 1  ON 43
ci_045                -3.006120e-03 3 1  ON 44
ci_046                 5.890014e-03 3 1  ON 45
ci_047                 5.451118e-03 3 1  ON 46
ci_048                -1.241927e-02 3 1  ON 47
ci_049                -1.309240e-02 3 1  ON 48
ci_050                 4.011492e-03 3 1  ON 49
ci_051                 2.913097e-03 3 1  ON 50
ci_052                -3.134730e-03 3 1  ON 51
ci_053                -2.930500e-03 3 1  ON 52
ci_054                -2.425777e-03 3 1  ON 53
ci_055                -3.348837e-03 3 1  ON 54
ci_056                 5.717842e-03 3 1  ON 55
ci_057                 6.553706e-03 3 1  ON 56
ci_058                -2.453644e-03 3 1  ON 57
ci_059                -1.905874e-03 3 1  ON 58
ci_060                 4.112006e-03 3 1  ON 59
ci_061                 5.288069e-03 3 1  ON 60
ci_062                -3.979859e-03 3 1  ON 61
ci_063                -3.962164e-03 3 1  ON 62
ci_064                -3.074200e-03 3 1  ON 63
ci_065                -4.307848e-03 3 1  ON 64
ci_066                 4.276756e-03 3 1  ON 65
ci_067                 4.512058e-03 3 1  ON 66
ci_068                -5.296488e-03 3 1  ON 67
ci_069                -5.694627e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.2374
    reference variance = 0.456662
====================================================
  Execution time = 1.3663e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9044e-01
  Total weights = 1.9569e+06
  Execution time = 1.8594e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279645349953
                                         uncertainty =       0.002687687505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279645349953
                                         uncertainty =       0.002687687505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373914912
  error estimate for blocks of size 2^( 2) =       0.000387686702
  error estimate for blocks of size 2^( 3) =       0.000399463631
  error estimate for blocks of size 2^( 4) =       0.000408118720
  error estimate for blocks of size 2^( 5) =       0.000412804392
  error estimate for blocks of size 2^( 6) =       0.000417187280
  error estimate for blocks of size 2^( 7) =       0.000418922236

      target function =      -0.111628775223
              le_mean =     -17.212442626200
             les_mean =     299.401255878031
             stat err =       0.000414258157
             autocorr =       1.227429526241
   target nu stat err =       0.000414258157
   target dn stat err =       2.628767682868
      target stat err =       0.082697999797
              std dev =       0.528795539836
             le_variance =       0.279624722951

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276356611084
                                         uncertainty =       0.001711915936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276356611084
                                         uncertainty =       0.001711915936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371714151
  error estimate for blocks of size 2^( 2) =       0.000385529811
  error estimate for blocks of size 2^( 3) =       0.000397365182
  error estimate for blocks of size 2^( 4) =       0.000406059764
  error estimate for blocks of size 2^( 5) =       0.000411120558
  error estimate for blocks of size 2^( 6) =       0.000415201674
  error estimate for blocks of size 2^( 7) =       0.000416586700

      target function =      -0.913082610801
              le_mean =     -17.212357592172
             les_mean =     296.555691822794
             stat err =       0.000412242174
             autocorr =       1.229947715461
   target nu stat err =       0.000412242174
   target dn stat err =       0.004074241388
      target stat err =       0.005302438928
              std dev =       0.525683193547
             le_variance =       0.276342819978

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283804302070
                                         uncertainty =       0.004735878346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283804302070
                                         uncertainty =       0.004735878346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376679382
  error estimate for blocks of size 2^( 2) =       0.000390441998
  error estimate for blocks of size 2^( 3) =       0.000402491063
  error estimate for blocks of size 2^( 4) =       0.000411160590
  error estimate for blocks of size 2^( 5) =       0.000416133781
  error estimate for blocks of size 2^( 6) =       0.000420318113
  error estimate for blocks of size 2^( 7) =       0.000421957374

      target function =      -0.105831418851
              le_mean =     -17.212445548056
             les_mean =     299.929166833077
             stat err =       0.000417392465
             autocorr =       1.227850551473
   target nu stat err =       0.000417392465
   target dn stat err =       2.866091065546
      target stat err =       0.074412821028
              std dev =       0.532705090931
             le_variance =       0.283774713904

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276356186136
                                         uncertainty =       0.001711857733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276356186136
                                         uncertainty =       0.001711857733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371713864
  error estimate for blocks of size 2^( 2) =       0.000385529528
  error estimate for blocks of size 2^( 3) =       0.000397364896
  error estimate for blocks of size 2^( 4) =       0.000406059492
  error estimate for blocks of size 2^( 5) =       0.000411120315
  error estimate for blocks of size 2^( 6) =       0.000415201434
  error estimate for blocks of size 2^( 7) =       0.000416586518

      target function =      -0.913084206319
              le_mean =     -17.212357605089
             les_mean =     296.555691039698
             stat err =       0.000412241939
             autocorr =       1.229948212229
   target nu stat err =       0.000412241939
   target dn stat err =       0.004073958732
      target stat err =       0.005302093991
              std dev =       0.525682788259
             le_variance =       0.276342393872


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.111628775223        initial
     3.7253e-06     3.7253e-05             2.0504e-03        -0.913082610801
     1.4901e-05     1.4901e-04             2.0501e-03        -0.105831418851
     5.9605e-05     5.9605e-04             2.0487e-03        -0.913084206319  <--

*****************************************************************************
Applying the update for shift_i =   5.9605e-05     and shift_s =   5.9605e-04
*****************************************************************************

  Execution time = 2.3014e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_001                -4.230960e-02 3 1  ON 0
ci_002                -3.293798e-02 3 1  ON 1
ci_003                -2.645382e-02 3 1  ON 2
ci_004                 2.389563e-02 3 1  ON 3
ci_005                 2.290023e-02 3 1  ON 4
ci_006                -2.158728e-02 3 1  ON 5
ci_007                -2.149170e-02 3 1  ON 6
ci_008                -9.534148e-03 3 1  ON 7
ci_009                -1.567140e-02 3 1  ON 8
ci_010                -9.750903e-03 3 1  ON 9
ci_011                -1.046452e-02 3 1  ON 10
ci_012                -1.047354e-02 3 1  ON 11
ci_013                -1.979598e-02 3 1  ON 12
ci_014                 1.232006e-02 3 1  ON 13
ci_015                 1.153114e-02 3 1  ON 14
ci_016                 1.666491e-02 3 1  ON 15
ci_017                 1.651513e-02 3 1  ON 16
ci_018                 1.021498e-02 3 1  ON 17
ci_019                 1.174763e-02 3 1  ON 18
ci_020                 1.868150e-02 3 1  ON 19
ci_021                 1.859588e-02 3 1  ON 20
ci_022                 1.063547e-02 3 1  ON 21
ci_023                 9.661350e-03 3 1  ON 22
ci_024                 1.017404e-02 3 1  ON 23
ci_025                 9.371521e-03 3 1  ON 24
ci_026                 1.198504e-02 3 1  ON 25
ci_027                 1.121501e-02 3 1  ON 26
ci_028                -1.550928e-02 3 1  ON 27
ci_029                -1.614603e-02 3 1  ON 28
ci_030                -9.631551e-03 3 1  ON 29
ci_031                -9.310817e-03 3 1  ON 30
ci_032                -1.430431e-02 3 1  ON 31
ci_033                 5.388156e-03 3 1  ON 32
ci_034                 5.768903e-03 3 1  ON 33
ci_035                -5.430624e-03 3 1  ON 34
ci_036                -1.379540e-02 3 1  ON 35
ci_037                -1.298769e-02 3 1  ON 36
ci_038                 1.949174e-03 3 1  ON 37
ci_039                 2.173717e-03 3 1  ON 38
ci_040                -4.001466e-03 3 1  ON 39
ci_041                 8.867102e-03 3 1  ON 40
ci_042                 9.058899e-03 3 1  ON 41
ci_043                -4.412780e-03 3 1  ON 42
ci_044                -4.084231e-03 3 1  ON 43
ci_045                -3.006389e-03 3 1  ON 44
ci_046                 5.889912e-03 3 1  ON 45
ci_047                 5.450932e-03 3 1  ON 46
ci_048                -1.241942e-02 3 1  ON 47
ci_049                -1.309253e-02 3 1  ON 48
ci_050                 4.011071e-03 3 1  ON 49
ci_051                 2.913339e-03 3 1  ON 50
ci_052                -3.134263e-03 3 1  ON 51
ci_053                -2.930651e-03 3 1  ON 52
ci_054                -2.425958e-03 3 1  ON 53
ci_055                -3.348693e-03 3 1  ON 54
ci_056                 5.717699e-03 3 1  ON 55
ci_057                 6.552962e-03 3 1  ON 56
ci_058                -2.453259e-03 3 1  ON 57
ci_059                -1.905938e-03 3 1  ON 58
ci_060                 4.113063e-03 3 1  ON 59
ci_061                 5.287699e-03 3 1  ON 60
ci_062                -3.979785e-03 3 1  ON 61
ci_063                -3.962446e-03 3 1  ON 62
ci_064                -3.074517e-03 3 1  ON 63
ci_065                -4.307548e-03 3 1  ON 64
ci_066                 4.276901e-03 3 1  ON 65
ci_067                 4.512380e-03 3 1  ON 66
ci_068                -5.296367e-03 3 1  ON 67
ci_069                -5.694609e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9514e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2394
    reference variance = 0.256023
====================================================
  Execution time = 1.4046e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8984e-01
  Total weights = 1.957152541e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5207e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277432261122
                                         uncertainty =       0.001617365338

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277432261122
                                         uncertainty =       0.001617365338

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372401189
  error estimate for blocks of size 2^( 2) =       0.000385998070
  error estimate for blocks of size 2^( 3) =       0.000398547222
  error estimate for blocks of size 2^( 4) =       0.000407983192
  error estimate for blocks of size 2^( 5) =       0.000413314678
  error estimate for blocks of size 2^( 6) =       0.000415416778
  error estimate for blocks of size 2^( 7) =       0.000417081490

      target function =      -0.913819386248
              le_mean =     -17.212133247617
             les_mean =     296.547371085980
             stat err =       0.000413449035
             autocorr =       1.232599101755
   target nu stat err =       0.000413449035
   target dn stat err =       0.002421652801
      target stat err =       0.003190664388
              std dev =       0.526654811848
             le_variance =       0.277365290843


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721213324762e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-05, overlap shift 1.4901e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913829757551       residual = 8.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914282651496       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914364239008       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914389644994       residual = 7.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914393761693       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914394052368       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914394935619       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914395066503       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914394864310       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914395030791       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914395081274       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914395067591       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-05 is 1.707228e-03

solving harmonic davidson linear method for identity shift 5.9605e-05, overlap shift 5.9605e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913829757551       residual = 8.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914282390681       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914363919486       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914389301533       residual = 7.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914393413553       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914393703455       residual = 7.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914394585595       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914394716309       residual = 5.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914394514332       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914394680608       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914394731030       residual = 1.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914394717363       residual = 4.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-05 is 1.706187e-03

solving harmonic davidson linear method for identity shift 2.3842e-04, overlap shift 2.3842e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913829757551       residual = 8.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914281350413       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914362645214       residual = 3.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914387931917       residual = 7.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914392025315       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914392312145       residual = 7.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914393189868       residual = 1.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914393319906       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914393118794       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914393284253       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914393334431       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914393320826       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-04 is 1.702036e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.415601 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6576e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_001                -4.238360e-02 3 1  ON 0
ci_002                -3.331509e-02 3 1  ON 1
ci_003                -2.764972e-02 3 1  ON 2
ci_004                 2.352722e-02 3 1  ON 3
ci_005                 2.338803e-02 3 1  ON 4
ci_006                -2.157805e-02 3 1  ON 5
ci_007                -2.166135e-02 3 1  ON 6
ci_008                -9.144891e-03 3 1  ON 7
ci_009                -1.396521e-02 3 1  ON 8
ci_010                -1.008487e-02 3 1  ON 9
ci_011                -9.441451e-03 3 1  ON 10
ci_012                -1.053214e-02 3 1  ON 11
ci_013                -1.871927e-02 3 1  ON 12
ci_014                 1.311254e-02 3 1  ON 13
ci_015                 1.322924e-02 3 1  ON 14
ci_016                 1.678678e-02 3 1  ON 15
ci_017                 1.685212e-02 3 1  ON 16
ci_018                 1.068669e-02 3 1  ON 17
ci_019                 1.049450e-02 3 1  ON 18
ci_020                 1.804990e-02 3 1  ON 19
ci_021                 1.795415e-02 3 1  ON 20
ci_022                 9.435453e-03 3 1  ON 21
ci_023                 9.352798e-03 3 1  ON 22
ci_024                 9.133280e-03 3 1  ON 23
ci_025                 1.047307e-02 3 1  ON 24
ci_026                 1.101150e-02 3 1  ON 25
ci_027                 1.193419e-02 3 1  ON 26
ci_028                -1.514063e-02 3 1  ON 27
ci_029                -1.703267e-02 3 1  ON 28
ci_030                -9.305459e-03 3 1  ON 29
ci_031                -1.017016e-02 3 1  ON 30
ci_032                -1.511094e-02 3 1  ON 31
ci_033                 5.470960e-03 3 1  ON 32
ci_034                 5.113577e-03 3 1  ON 33
ci_035                -5.847914e-03 3 1  ON 34
ci_036                -1.263146e-02 3 1  ON 35
ci_037                -1.383930e-02 3 1  ON 36
ci_038                 2.040459e-03 3 1  ON 37
ci_039                 2.752410e-03 3 1  ON 38
ci_040                -3.391690e-03 3 1  ON 39
ci_041                 8.663419e-03 3 1  ON 40
ci_042                 9.567983e-03 3 1  ON 41
ci_043                -4.342642e-03 3 1  ON 42
ci_044                -5.099084e-03 3 1  ON 43
ci_045                -3.223889e-03 3 1  ON 44
ci_046                 5.374972e-03 3 1  ON 45
ci_047                 6.141071e-03 3 1  ON 46
ci_048                -1.257960e-02 3 1  ON 47
ci_049                -1.304158e-02 3 1  ON 48
ci_050                 3.414345e-03 3 1  ON 49
ci_051                 3.368608e-03 3 1  ON 50
ci_052                -2.568090e-03 3 1  ON 51
ci_053                -3.133551e-03 3 1  ON 52
ci_054                -2.512491e-03 3 1  ON 53
ci_055                -2.538975e-03 3 1  ON 54
ci_056                 5.865625e-03 3 1  ON 55
ci_057                 6.004563e-03 3 1  ON 56
ci_058                -2.446390e-03 3 1  ON 57
ci_059                -1.311496e-03 3 1  ON 58
ci_060                 5.491054e-03 3 1  ON 59
ci_061                 5.318920e-03 3 1  ON 60
ci_062                -3.915798e-03 3 1  ON 61
ci_063                -4.040242e-03 3 1  ON 62
ci_064                -3.041663e-03 3 1  ON 63
ci_065                -4.035844e-03 3 1  ON 64
ci_066                 5.003835e-03 3 1  ON 65
ci_067                 4.362973e-03 3 1  ON 66
ci_068                -4.987916e-03 3 1  ON 67
ci_069                -4.964079e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2431
    reference variance = 0.322242
====================================================
  Execution time = 1.3750e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8437e-01
  Total weights = 1.9572e+06
  Execution time = 1.8552e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.114372
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274371501644
                                         uncertainty =       0.001272887286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274371501644
                                         uncertainty =       0.001272887286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370385266
  error estimate for blocks of size 2^( 2) =       0.000384031554
  error estimate for blocks of size 2^( 3) =       0.000396683757
  error estimate for blocks of size 2^( 4) =       0.000405480033
  error estimate for blocks of size 2^( 5) =       0.000410962762
  error estimate for blocks of size 2^( 6) =       0.000414349920
  error estimate for blocks of size 2^( 7) =       0.000417380173

      target function =      -0.905237814430
              le_mean =     -17.212181953270
             les_mean =     296.555714323617
             stat err =       0.000412043222
             autocorr =       1.237593854985
   target nu stat err =       0.000412043222
   target dn stat err =       0.005316114587
      target stat err =       0.006781967807
              std dev =       0.523803867109
             le_variance =       0.274370491198

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273853400610
                                         uncertainty =       0.001254154428

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273853400610
                                         uncertainty =       0.001254154428

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370034160
  error estimate for blocks of size 2^( 2) =       0.000383716205
  error estimate for blocks of size 2^( 3) =       0.000396388427
  error estimate for blocks of size 2^( 4) =       0.000405203983
  error estimate for blocks of size 2^( 5) =       0.000410713127
  error estimate for blocks of size 2^( 6) =       0.000414119971
  error estimate for blocks of size 2^( 7) =       0.000417115635

      target function =      -0.920960412249
              le_mean =     -17.212100081084
             les_mean =     296.540755382367
             stat err =       0.000411788179
             autocorr =       1.238409039023
   target nu stat err =       0.000411788179
   target dn stat err =       0.001790646710
      target stat err =       0.002427724295
              std dev =       0.523307328226
             le_variance =       0.273850559776

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.11041
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274746972129
                                         uncertainty =       0.001247371441

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274746972129
                                         uncertainty =       0.001247371441

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370635353
  error estimate for blocks of size 2^( 2) =       0.000384353471
  error estimate for blocks of size 2^( 3) =       0.000397052860
  error estimate for blocks of size 2^( 4) =       0.000405884096
  error estimate for blocks of size 2^( 5) =       0.000411405191
  error estimate for blocks of size 2^( 6) =       0.000414824231
  error estimate for blocks of size 2^( 7) =       0.000417820372

      target function =      -0.906825359147
              le_mean =     -17.212177891557
             les_mean =     296.554334465402
             stat err =       0.000412483473
             autocorr =       1.238566754820
   target nu stat err =       0.000412483473
   target dn stat err =       0.004774910329
      target stat err =       0.006118102846
              std dev =       0.524157543608
             le_variance =       0.274741130522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273852655360
                                         uncertainty =       0.001254201792

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273852655360
                                         uncertainty =       0.001254201792

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370033661
  error estimate for blocks of size 2^( 2) =       0.000383715581
  error estimate for blocks of size 2^( 3) =       0.000396387725
  error estimate for blocks of size 2^( 4) =       0.000405203218
  error estimate for blocks of size 2^( 5) =       0.000410712392
  error estimate for blocks of size 2^( 6) =       0.000414119166
  error estimate for blocks of size 2^( 7) =       0.000417114845

      target function =      -0.920954108680
              le_mean =     -17.212100103460
             les_mean =     296.540760948825
             stat err =       0.000411787405
             autocorr =       1.238407728095
   target nu stat err =       0.000411787405
   target dn stat err =       0.001790772600
      target stat err =       0.002427852516
              std dev =       0.523306622064
             le_variance =       0.273849820696


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.905237814430        initial
     1.4901e-05     1.4901e-04             1.7072e-03        -0.920960412249  <--
     5.9605e-05     5.9605e-04             1.7062e-03        -0.906825359147
     2.3842e-04     2.3842e-03             1.7020e-03        -0.920954108680

*****************************************************************************
Applying the update for shift_i =   1.4901e-05     and shift_s =   1.4901e-04
*****************************************************************************

  Execution time = 2.3110e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_001                -4.238364e-02 3 1  ON 0
ci_002                -3.331537e-02 3 1  ON 1
ci_003                -2.765052e-02 3 1  ON 2
ci_004                 2.352684e-02 3 1  ON 3
ci_005                 2.338846e-02 3 1  ON 4
ci_006                -2.157802e-02 3 1  ON 5
ci_007                -2.166147e-02 3 1  ON 6
ci_008                -9.144695e-03 3 1  ON 7
ci_009                -1.396417e-02 3 1  ON 8
ci_010                -1.008509e-02 3 1  ON 9
ci_011                -9.440820e-03 3 1  ON 10
ci_012                -1.053216e-02 3 1  ON 11
ci_013                -1.871839e-02 3 1  ON 12
ci_014                 1.311313e-02 3 1  ON 13
ci_015                 1.323040e-02 3 1  ON 14
ci_016                 1.678685e-02 3 1  ON 15
ci_017                 1.685238e-02 3 1  ON 16
ci_018                 1.068693e-02 3 1  ON 17
ci_019                 1.049371e-02 3 1  ON 18
ci_020                 1.804934e-02 3 1  ON 19
ci_021                 1.795371e-02 3 1  ON 20
ci_022                 9.434639e-03 3 1  ON 21
ci_023                 9.352611e-03 3 1  ON 22
ci_024                 9.132523e-03 3 1  ON 23
ci_025                 1.047387e-02 3 1  ON 24
ci_026                 1.101088e-02 3 1  ON 25
ci_027                 1.193466e-02 3 1  ON 26
ci_028                -1.514036e-02 3 1  ON 27
ci_029                -1.703336e-02 3 1  ON 28
ci_030                -9.305248e-03 3 1  ON 29
ci_031                -1.017066e-02 3 1  ON 30
ci_032                -1.511151e-02 3 1  ON 31
ci_033                 5.470984e-03 3 1  ON 32
ci_034                 5.113101e-03 3 1  ON 33
ci_035                -5.848165e-03 3 1  ON 34
ci_036                -1.263086e-02 3 1  ON 35
ci_037                -1.383984e-02 3 1  ON 36
ci_038                 2.040513e-03 3 1  ON 37
ci_039                 2.752749e-03 3 1  ON 38
ci_040                -3.391337e-03 3 1  ON 39
ci_041                 8.663284e-03 3 1  ON 40
ci_042                 9.568347e-03 3 1  ON 41
ci_043                -4.342602e-03 3 1  ON 42
ci_044                -5.099727e-03 3 1  ON 43
ci_045                -3.224014e-03 3 1  ON 44
ci_046                 5.374631e-03 3 1  ON 45
ci_047                 6.141524e-03 3 1  ON 46
ci_048                -1.257971e-02 3 1  ON 47
ci_049                -1.304159e-02 3 1  ON 48
ci_050                 3.414019e-03 3 1  ON 49
ci_051                 3.368854e-03 3 1  ON 50
ci_052                -2.567774e-03 3 1  ON 51
ci_053                -3.133716e-03 3 1  ON 52
ci_054                -2.512575e-03 3 1  ON 53
ci_055                -2.538461e-03 3 1  ON 54
ci_056                 5.865715e-03 3 1  ON 55
ci_057                 6.004236e-03 3 1  ON 56
ci_058                -2.446313e-03 3 1  ON 57
ci_059                -1.311103e-03 3 1  ON 58
ci_060                 5.491964e-03 3 1  ON 59
ci_061                 5.318949e-03 3 1  ON 60
ci_062                -3.915726e-03 3 1  ON 61
ci_063                -4.040328e-03 3 1  ON 62
ci_064                -3.041647e-03 3 1  ON 63
ci_065                -4.035685e-03 3 1  ON 64
ci_066                 5.004278e-03 3 1  ON 65
ci_067                 4.362900e-03 3 1  ON 66
ci_068                -4.987720e-03 3 1  ON 67
ci_069                -4.963622e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9696e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.2497
    reference variance = 0.273608
====================================================
  Execution time = 1.3929e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5325e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9243e-01
  Total weights = 1.956983682e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4785e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280442275315
                                         uncertainty =       0.001811761582

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280442275315
                                         uncertainty =       0.001811761582

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374424832
  error estimate for blocks of size 2^( 2) =       0.000388161936
  error estimate for blocks of size 2^( 3) =       0.000400142700
  error estimate for blocks of size 2^( 4) =       0.000409171794
  error estimate for blocks of size 2^( 5) =       0.000413966916
  error estimate for blocks of size 2^( 6) =       0.000417297234
  error estimate for blocks of size 2^( 7) =       0.000419488699

      target function =      -0.910462502070
              le_mean =     -17.212089975716
             les_mean =     296.548473506491
             stat err =       0.000414981161
             autocorr =       1.228365118811
   target nu stat err =       0.000414981161
   target dn stat err =       0.002600113202
      target stat err =       0.003393581302
              std dev =       0.529516675190
             le_variance =       0.280387909304


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721208997572e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-06, overlap shift 3.7253e-05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910474317826       residual = 9.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911021505748       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911108515004       residual = 6.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911150999205       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911159601309       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911161579523       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911162040826       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911161901846       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911161969686       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911162080237       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911162129744       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911162107552       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-06 is 2.824690e-03

solving harmonic davidson linear method for identity shift 1.4901e-05, overlap shift 1.4901e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910474317826       residual = 9.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911021426165       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911108418862       residual = 6.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911150893583       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911159493383       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911161470894       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911161932013       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911161793057       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911161860863       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911161971368       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911162020859       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911161998673       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-05 is 2.824175e-03

solving harmonic davidson linear method for identity shift 5.9605e-05, overlap shift 5.9605e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.910474317826       residual = 9.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911021108062       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911108034583       residual = 6.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911150471427       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911159062023       residual = 3.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911161036728       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911161497112       residual = 1.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911161358248       residual = 7.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911161425919       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911161536244       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911161585666       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.911161563506       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-05 is 2.822118e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.425460 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6426e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_001                -4.192067e-02 3 1  ON 0
ci_002                -3.142932e-02 3 1  ON 1
ci_003                -2.722418e-02 3 1  ON 2
ci_004                 2.448428e-02 3 1  ON 3
ci_005                 2.292311e-02 3 1  ON 4
ci_006                -2.210171e-02 3 1  ON 5
ci_007                -2.262498e-02 3 1  ON 6
ci_008                -9.377643e-03 3 1  ON 7
ci_009                -1.470441e-02 3 1  ON 8
ci_010                -8.822305e-03 3 1  ON 9
ci_011                -1.044539e-02 3 1  ON 10
ci_012                -1.051378e-02 3 1  ON 11
ci_013                -2.003522e-02 3 1  ON 12
ci_014                 1.271970e-02 3 1  ON 13
ci_015                 1.304626e-02 3 1  ON 14
ci_016                 1.616859e-02 3 1  ON 15
ci_017                 1.652894e-02 3 1  ON 16
ci_018                 1.107938e-02 3 1  ON 17
ci_019                 1.185036e-02 3 1  ON 18
ci_020                 1.753211e-02 3 1  ON 19
ci_021                 1.772454e-02 3 1  ON 20
ci_022                 1.036110e-02 3 1  ON 21
ci_023                 1.020607e-02 3 1  ON 22
ci_024                 8.557797e-03 3 1  ON 23
ci_025                 1.041161e-02 3 1  ON 24
ci_026                 1.090205e-02 3 1  ON 25
ci_027                 1.159245e-02 3 1  ON 26
ci_028                -1.596022e-02 3 1  ON 27
ci_029                -1.420918e-02 3 1  ON 28
ci_030                -9.993180e-03 3 1  ON 29
ci_031                -9.797689e-03 3 1  ON 30
ci_032                -1.441803e-02 3 1  ON 31
ci_033                 5.473945e-03 3 1  ON 32
ci_034                 5.624420e-03 3 1  ON 33
ci_035                -5.023399e-03 3 1  ON 34
ci_036                -1.333279e-02 3 1  ON 35
ci_037                -1.317601e-02 3 1  ON 36
ci_038                 1.653516e-03 3 1  ON 37
ci_039                 2.007002e-03 3 1  ON 38
ci_040                -3.351952e-03 3 1  ON 39
ci_041                 8.956058e-03 3 1  ON 40
ci_042                 9.318825e-03 3 1  ON 41
ci_043                -4.393018e-03 3 1  ON 42
ci_044                -3.151081e-03 3 1  ON 43
ci_045                -3.303817e-03 3 1  ON 44
ci_046                 5.526588e-03 3 1  ON 45
ci_047                 5.513935e-03 3 1  ON 46
ci_048                -1.353282e-02 3 1  ON 47
ci_049                -1.505221e-02 3 1  ON 48
ci_050                 2.949799e-03 3 1  ON 49
ci_051                 3.457444e-03 3 1  ON 50
ci_052                -3.339231e-03 3 1  ON 51
ci_053                -1.802849e-03 3 1  ON 52
ci_054                -3.254066e-03 3 1  ON 53
ci_055                -2.655721e-03 3 1  ON 54
ci_056                 5.721887e-03 3 1  ON 55
ci_057                 5.250287e-03 3 1  ON 56
ci_058                -2.040274e-03 3 1  ON 57
ci_059                -2.294346e-03 3 1  ON 58
ci_060                 6.008749e-03 3 1  ON 59
ci_061                 4.396984e-03 3 1  ON 60
ci_062                -4.090291e-03 3 1  ON 61
ci_063                -4.042649e-03 3 1  ON 62
ci_064                -3.350325e-03 3 1  ON 63
ci_065                -4.026223e-03 3 1  ON 64
ci_066                 4.278675e-03 3 1  ON 65
ci_067                 5.023605e-03 3 1  ON 66
ci_068                -5.005814e-03 3 1  ON 67
ci_069                -5.053410e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.2556
    reference variance = 0.203009
====================================================
  Execution time = 1.3794e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8332e-01
  Total weights = 1.9573e+06
  Execution time = 1.8604e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0329639
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275971570191
                                         uncertainty =       0.002449299896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275971570191
                                         uncertainty =       0.002449299896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371456038
  error estimate for blocks of size 2^( 2) =       0.000385489647
  error estimate for blocks of size 2^( 3) =       0.000397359329
  error estimate for blocks of size 2^( 4) =       0.000406424831
  error estimate for blocks of size 2^( 5) =       0.000412092429
  error estimate for blocks of size 2^( 6) =       0.000414877713
  error estimate for blocks of size 2^( 7) =       0.000415919136

      target function =      -0.815840356995
              le_mean =     -17.212368166478
             les_mean =     296.633403018309
             stat err =       0.000412328527
             autocorr =       1.232173665121
   target nu stat err =       0.000412328527
   target dn stat err =       0.073113320592
      target stat err =       0.076160774312
              std dev =       0.525318166154
             le_variance =       0.275959175691

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273245088030
                                         uncertainty =       0.001255967579

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273245088030
                                         uncertainty =       0.001255967579

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369619788
  error estimate for blocks of size 2^( 2) =       0.000383753314
  error estimate for blocks of size 2^( 3) =       0.000395681843
  error estimate for blocks of size 2^( 4) =       0.000404785335
  error estimate for blocks of size 2^( 5) =       0.000410425665
  error estimate for blocks of size 2^( 6) =       0.000413271026
  error estimate for blocks of size 2^( 7) =       0.000414514801

      target function =      -0.922387357488
              le_mean =     -17.212288075892
             les_mean =     296.546181432461
             stat err =       0.000410749207
             autocorr =       1.234931985001
   target nu stat err =       0.000410749207
   target dn stat err =       0.001973108501
      target stat err =       0.002669724793
              std dev =       0.522721317558
             le_variance =       0.273237575829

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0321303
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274507124476
                                         uncertainty =       0.001276388316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274507124476
                                         uncertainty =       0.001276388316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370471488
  error estimate for blocks of size 2^( 2) =       0.000384643586
  error estimate for blocks of size 2^( 3) =       0.000396570353
  error estimate for blocks of size 2^( 4) =       0.000405690759
  error estimate for blocks of size 2^( 5) =       0.000411409078
  error estimate for blocks of size 2^( 6) =       0.000414234125
  error estimate for blocks of size 2^( 7) =       0.000415479074

      target function =      -0.770821039961
              le_mean =     -17.212370169824
             les_mean =     296.677090568524
             stat err =       0.000411703259
             autocorr =       1.234977460491
   target nu stat err =       0.000411703259
   target dn stat err =       0.087910426511
      target stat err =       0.081956888934
              std dev =       0.523925802172
             le_variance =       0.274498246182

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273244794071
                                         uncertainty =       0.001255981211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273244794071
                                         uncertainty =       0.001255981211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369619590
  error estimate for blocks of size 2^( 2) =       0.000383753086
  error estimate for blocks of size 2^( 3) =       0.000395681605
  error estimate for blocks of size 2^( 4) =       0.000404785086
  error estimate for blocks of size 2^( 5) =       0.000410425365
  error estimate for blocks of size 2^( 6) =       0.000413270759
  error estimate for blocks of size 2^( 7) =       0.000414514502

      target function =      -0.922385394820
              le_mean =     -17.212288079364
             les_mean =     296.546183038801
             stat err =       0.000410748928
             autocorr =       1.234931634367
   target nu stat err =       0.000410748928
   target dn stat err =       0.001973280949
      target stat err =       0.002669935659
              std dev =       0.522721036647
             le_variance =       0.273237282153


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.815840356995        initial
     3.7253e-06     3.7253e-05             2.8247e-03        -0.922387357488  <--
     1.4901e-05     1.4901e-04             2.8242e-03        -0.770821039961
     5.9605e-05     5.9605e-04             2.8221e-03        -0.922385394820

*****************************************************************************
Applying the update for shift_i =   3.7253e-06     and shift_s =   3.7253e-05
*****************************************************************************

  Execution time = 2.3189e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_001                -4.192058e-02 3 1  ON 0
ci_002                -3.142898e-02 3 1  ON 1
ci_003                -2.722409e-02 3 1  ON 2
ci_004                 2.448445e-02 3 1  ON 3
ci_005                 2.292301e-02 3 1  ON 4
ci_006                -2.210181e-02 3 1  ON 5
ci_007                -2.262518e-02 3 1  ON 6
ci_008                -9.377673e-03 3 1  ON 7
ci_009                -1.470452e-02 3 1  ON 8
ci_010                -8.822105e-03 3 1  ON 9
ci_011                -1.044555e-02 3 1  ON 10
ci_012                -1.051378e-02 3 1  ON 11
ci_013                -2.003550e-02 3 1  ON 12
ci_014                 1.271961e-02 3 1  ON 13
ci_015                 1.304622e-02 3 1  ON 14
ci_016                 1.616847e-02 3 1  ON 15
ci_017                 1.652887e-02 3 1  ON 16
ci_018                 1.107943e-02 3 1  ON 17
ci_019                 1.185055e-02 3 1  ON 18
ci_020                 1.753205e-02 3 1  ON 19
ci_021                 1.772451e-02 3 1  ON 20
ci_022                 1.036127e-02 3 1  ON 21
ci_023                 1.020621e-02 3 1  ON 22
ci_024                 8.557700e-03 3 1  ON 23
ci_025                 1.041160e-02 3 1  ON 24
ci_026                 1.090205e-02 3 1  ON 25
ci_027                 1.159239e-02 3 1  ON 26
ci_028                -1.596037e-02 3 1  ON 27
ci_029                -1.420867e-02 3 1  ON 28
ci_030                -9.993298e-03 3 1  ON 29
ci_031                -9.797675e-03 3 1  ON 30
ci_032                -1.441791e-02 3 1  ON 31
ci_033                 5.473951e-03 3 1  ON 32
ci_034                 5.624500e-03 3 1  ON 33
ci_035                -5.023275e-03 3 1  ON 34
ci_036                -1.333289e-02 3 1  ON 35
ci_037                -1.317591e-02 3 1  ON 36
ci_038                 1.653459e-03 3 1  ON 37
ci_039                 2.006892e-03 3 1  ON 38
ci_040                -3.351947e-03 3 1  ON 39
ci_041                 8.956116e-03 3 1  ON 40
ci_042                 9.318744e-03 3 1  ON 41
ci_043                -4.393026e-03 3 1  ON 42
ci_044                -3.150770e-03 3 1  ON 43
ci_045                -3.303828e-03 3 1  ON 44
ci_046                 5.526614e-03 3 1  ON 45
ci_047                 5.513832e-03 3 1  ON 46
ci_048                -1.353301e-02 3 1  ON 47
ci_049                -1.505258e-02 3 1  ON 48
ci_050                 2.949735e-03 3 1  ON 49
ci_051                 3.457456e-03 3 1  ON 50
ci_052                -3.339336e-03 3 1  ON 51
ci_053                -1.802645e-03 3 1  ON 52
ci_054                -3.254171e-03 3 1  ON 53
ci_055                -2.655739e-03 3 1  ON 54
ci_056                 5.721865e-03 3 1  ON 55
ci_057                 5.250171e-03 3 1  ON 56
ci_058                -2.040217e-03 3 1  ON 57
ci_059                -2.294497e-03 3 1  ON 58
ci_060                 6.008833e-03 3 1  ON 59
ci_061                 4.396829e-03 3 1  ON 60
ci_062                -4.090314e-03 3 1  ON 61
ci_063                -4.042650e-03 3 1  ON 62
ci_064                -3.350368e-03 3 1  ON 63
ci_065                -4.026222e-03 3 1  ON 64
ci_066                 4.278562e-03 3 1  ON 65
ci_067                 5.023703e-03 3 1  ON 66
ci_068                -5.005816e-03 3 1  ON 67
ci_069                -5.053422e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9629e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.2469
    reference variance = 0.174008
====================================================
  Execution time = 1.5987e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5308e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8589e-01
  Total weights = 1.957429353e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5112e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275774937097
                                         uncertainty =       0.001415499557

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275774937097
                                         uncertainty =       0.001415499557

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371295759
  error estimate for blocks of size 2^( 2) =       0.000385164928
  error estimate for blocks of size 2^( 3) =       0.000397535057
  error estimate for blocks of size 2^( 4) =       0.000406715893
  error estimate for blocks of size 2^( 5) =       0.000412152167
  error estimate for blocks of size 2^( 6) =       0.000415195568
  error estimate for blocks of size 2^( 7) =       0.000417027458

      target function =      -0.918698471828
              le_mean =     -17.211094074865
             les_mean =     296.507645637161
             stat err =       0.000412772771
             autocorr =       1.235896510018
   target nu stat err =       0.000412772771
   target dn stat err =       0.001854705174
      target stat err =       0.002494024972
              std dev =       0.525091497459
             le_variance =       0.275721080704


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721109407487e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-07, overlap shift 9.3132e-06 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918704393457       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919249948817       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919341064483       residual = 6.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919389799861       residual = 7.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919397478995       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919402610183       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919402891792       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919402922072       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919403190444       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919403219833       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919403226855       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919403228111       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-07 is 2.555967e-03

solving harmonic davidson linear method for identity shift 3.7253e-06, overlap shift 3.7253e-05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918704393457       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919249929702       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919341041429       residual = 6.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919389774183       residual = 7.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919397452794       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919402583620       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919402865198       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919402895469       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919403163818       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919403193205       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919403200224       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919403201480       residual = 2.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-06 is 2.555865e-03

solving harmonic davidson linear method for identity shift 1.4901e-05, overlap shift 1.4901e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.918704393457       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.919249853257       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.919340949232       residual = 6.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.919389671489       residual = 7.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.919397348011       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.919402477387       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.919402758839       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.919402789077       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.919403057336       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.919403086710       residual = 5.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.919403093723       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.919403094979       residual = 2.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-05 is 2.555459e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.435365 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8517e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
ci_001                -4.180688e-02 3 1  ON 0
ci_002                -3.288697e-02 3 1  ON 1
ci_003                -2.611740e-02 3 1  ON 2
ci_004                 2.390017e-02 3 1  ON 3
ci_005                 2.465531e-02 3 1  ON 4
ci_006                -2.144049e-02 3 1  ON 5
ci_007                -2.187556e-02 3 1  ON 6
ci_008                -8.179745e-03 3 1  ON 7
ci_009                -1.507447e-02 3 1  ON 8
ci_010                -9.312672e-03 3 1  ON 9
ci_011                -1.045668e-02 3 1  ON 10
ci_012                -8.994657e-03 3 1  ON 11
ci_013                -2.075296e-02 3 1  ON 12
ci_014                 1.350737e-02 3 1  ON 13
ci_015                 1.267180e-02 3 1  ON 14
ci_016                 1.692820e-02 3 1  ON 15
ci_017                 1.692980e-02 3 1  ON 16
ci_018                 1.123893e-02 3 1  ON 17
ci_019                 1.201726e-02 3 1  ON 18
ci_020                 1.850151e-02 3 1  ON 19
ci_021                 1.823890e-02 3 1  ON 20
ci_022                 1.113202e-02 3 1  ON 21
ci_023                 9.625364e-03 3 1  ON 22
ci_024                 8.945999e-03 3 1  ON 23
ci_025                 9.954090e-03 3 1  ON 24
ci_026                 1.159766e-02 3 1  ON 25
ci_027                 1.081840e-02 3 1  ON 26
ci_028                -1.580038e-02 3 1  ON 27
ci_029                -1.531378e-02 3 1  ON 28
ci_030                -9.128886e-03 3 1  ON 29
ci_031                -9.333662e-03 3 1  ON 30
ci_032                -1.380973e-02 3 1  ON 31
ci_033                 5.319332e-03 3 1  ON 32
ci_034                 7.571669e-03 3 1  ON 33
ci_035                -5.536919e-03 3 1  ON 34
ci_036                -1.284459e-02 3 1  ON 35
ci_037                -1.302626e-02 3 1  ON 36
ci_038                 2.281603e-03 3 1  ON 37
ci_039                 2.217148e-03 3 1  ON 38
ci_040                -3.550771e-03 3 1  ON 39
ci_041                 8.553744e-03 3 1  ON 40
ci_042                 8.848012e-03 3 1  ON 41
ci_043                -4.296856e-03 3 1  ON 42
ci_044                -5.706635e-03 3 1  ON 43
ci_045                -3.389009e-03 3 1  ON 44
ci_046                 6.284819e-03 3 1  ON 45
ci_047                 5.970890e-03 3 1  ON 46
ci_048                -1.358223e-02 3 1  ON 47
ci_049                -1.351223e-02 3 1  ON 48
ci_050                 2.763930e-03 3 1  ON 49
ci_051                 3.461881e-03 3 1  ON 50
ci_052                -2.251055e-03 3 1  ON 51
ci_053                -3.152293e-03 3 1  ON 52
ci_054                -2.985818e-03 3 1  ON 53
ci_055                -2.687883e-03 3 1  ON 54
ci_056                 5.517348e-03 3 1  ON 55
ci_057                 5.490448e-03 3 1  ON 56
ci_058                -1.794166e-03 3 1  ON 57
ci_059                -2.263699e-03 3 1  ON 58
ci_060                 5.404448e-03 3 1  ON 59
ci_061                 4.488615e-03 3 1  ON 60
ci_062                -4.257805e-03 3 1  ON 61
ci_063                -4.027033e-03 3 1  ON 62
ci_064                -3.351006e-03 3 1  ON 63
ci_065                -4.218929e-03 3 1  ON 64
ci_066                 5.182340e-03 3 1  ON 65
ci_067                 5.303614e-03 3 1  ON 66
ci_068                -5.935868e-03 3 1  ON 67
ci_069                -4.861952e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.1657
    reference variance = 0.206431
====================================================
  Execution time = 1.3561e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.9138e-01
  Total weights = 1.9571e+06
  Execution time = 1.8555e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0323897
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279388651674
                                         uncertainty =       0.001745033585

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279388651674
                                         uncertainty =       0.001745033585

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373707089
  error estimate for blocks of size 2^( 2) =       0.000387686513
  error estimate for blocks of size 2^( 3) =       0.000400359502
  error estimate for blocks of size 2^( 4) =       0.000409667585
  error estimate for blocks of size 2^( 5) =       0.000415435244
  error estimate for blocks of size 2^( 6) =       0.000418301945
  error estimate for blocks of size 2^( 7) =       0.000420458309

      target function =      -0.892140360518
              le_mean =     -17.212748886903
             les_mean =     296.585764305006
             stat err =       0.000415965771
             autocorr =       1.238946398345
   target nu stat err =       0.000415965771
   target dn stat err =       0.006445830612
      target stat err =       0.007985844579
              std dev =       0.528501633091
             le_variance =       0.279313976180

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278968340658
                                         uncertainty =       0.001740130816

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278968340658
                                         uncertainty =       0.001740130816

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373425370
  error estimate for blocks of size 2^( 2) =       0.000387406788
  error estimate for blocks of size 2^( 3) =       0.000400054450
  error estimate for blocks of size 2^( 4) =       0.000409333595
  error estimate for blocks of size 2^( 5) =       0.000415101427
  error estimate for blocks of size 2^( 6) =       0.000418020972
  error estimate for blocks of size 2^( 7) =       0.000420086466

      target function =      -0.911964535914
              le_mean =     -17.212682471229
             les_mean =     296.567819236508
             stat err =       0.000415635615
             autocorr =       1.238847552820
   target nu stat err =       0.000415635615
   target dn stat err =       0.002373100906
      target stat err =       0.003119644211
              std dev =       0.528103223432
             le_variance =       0.278893014599

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0316428
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311711063990
                                         uncertainty =       0.030764132924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311711063990
                                         uncertainty =       0.030764132924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394742029
  error estimate for blocks of size 2^( 2) =       0.000408052629
  error estimate for blocks of size 2^( 3) =       0.000420327778
  error estimate for blocks of size 2^( 4) =       0.000429132362
  error estimate for blocks of size 2^( 5) =       0.000434873012
  error estimate for blocks of size 2^( 6) =       0.000437928682
  error estimate for blocks of size 2^( 7) =       0.000440054446

      target function =      -0.038912732273
              le_mean =     -17.212938677877
             les_mean =     304.934647579136
             stat err =       0.000435497126
             autocorr =       1.217149283459
   target nu stat err =       0.000435497126
   target dn stat err =       8.239554326786
      target stat err =       0.035372981362
              std dev =       0.558249530972
             le_variance =       0.311642538830

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278968223615
                                         uncertainty =       0.001740129446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278968223615
                                         uncertainty =       0.001740129446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373425292
  error estimate for blocks of size 2^( 2) =       0.000387406715
  error estimate for blocks of size 2^( 3) =       0.000400054386
  error estimate for blocks of size 2^( 4) =       0.000409333541
  error estimate for blocks of size 2^( 5) =       0.000415101373
  error estimate for blocks of size 2^( 6) =       0.000418020918
  error estimate for blocks of size 2^( 7) =       0.000420086420

      target function =      -0.911964600133
              le_mean =     -17.212682467351
             les_mean =     296.567819052244
             stat err =       0.000415635563
             autocorr =       1.238847762509
   target nu stat err =       0.000415635563
   target dn stat err =       0.002373141564
      target stat err =       0.003119696158
              std dev =       0.528103112916
             le_variance =       0.278892897871


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.892140360518        initial
     9.3132e-07     9.3132e-06             2.5560e-03        -0.911964535914
     3.7253e-06     3.7253e-05             2.5559e-03        -0.038912732273
     1.4901e-05     1.4901e-04             2.5555e-03        -0.911964600133  <--

*****************************************************************************
Applying the update for shift_i =   1.4901e-05     and shift_s =   1.4901e-04
*****************************************************************************

  Execution time = 2.2902e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
ci_001                -4.180689e-02 3 1  ON 0
ci_002                -3.288671e-02 3 1  ON 1
ci_003                -2.611762e-02 3 1  ON 2
ci_004                 2.390025e-02 3 1  ON 3
ci_005                 2.465500e-02 3 1  ON 4
ci_006                -2.144062e-02 3 1  ON 5
ci_007                -2.187570e-02 3 1  ON 6
ci_008                -8.179916e-03 3 1  ON 7
ci_009                -1.507441e-02 3 1  ON 8
ci_010                -9.312592e-03 3 1  ON 9
ci_011                -1.045668e-02 3 1  ON 10
ci_012                -8.994891e-03 3 1  ON 11
ci_013                -2.075281e-02 3 1  ON 12
ci_014                 1.350725e-02 3 1  ON 13
ci_015                 1.267186e-02 3 1  ON 14
ci_016                 1.692805e-02 3 1  ON 15
ci_017                 1.692972e-02 3 1  ON 16
ci_018                 1.123890e-02 3 1  ON 17
ci_019                 1.201723e-02 3 1  ON 18
ci_020                 1.850134e-02 3 1  ON 19
ci_021                 1.823880e-02 3 1  ON 20
ci_022                 1.113191e-02 3 1  ON 21
ci_023                 9.625448e-03 3 1  ON 22
ci_024                 8.945932e-03 3 1  ON 23
ci_025                 9.954177e-03 3 1  ON 24
ci_026                 1.159756e-02 3 1  ON 25
ci_027                 1.081848e-02 3 1  ON 26
ci_028                -1.580042e-02 3 1  ON 27
ci_029                -1.531359e-02 3 1  ON 28
ci_030                -9.129013e-03 3 1  ON 29
ci_031                -9.333761e-03 3 1  ON 30
ci_032                -1.380983e-02 3 1  ON 31
ci_033                 5.319366e-03 3 1  ON 32
ci_034                 7.571346e-03 3 1  ON 33
ci_035                -5.536843e-03 3 1  ON 34
ci_036                -1.284469e-02 3 1  ON 35
ci_037                -1.302630e-02 3 1  ON 36
ci_038                 2.281513e-03 3 1  ON 37
ci_039                 2.217117e-03 3 1  ON 38
ci_040                -3.550742e-03 3 1  ON 39
ci_041                 8.553810e-03 3 1  ON 40
ci_042                 8.848063e-03 3 1  ON 41
ci_043                -4.296870e-03 3 1  ON 42
ci_044                -5.706229e-03 3 1  ON 43
ci_045                -3.388998e-03 3 1  ON 44
ci_046                 6.284696e-03 3 1  ON 45
ci_047                 5.970816e-03 3 1  ON 46
ci_048                -1.358224e-02 3 1  ON 47
ci_049                -1.351252e-02 3 1  ON 48
ci_050                 2.763954e-03 3 1  ON 49
ci_051                 3.461882e-03 3 1  ON 50
ci_052                -2.251207e-03 3 1  ON 51
ci_053                -3.152105e-03 3 1  ON 52
ci_054                -2.985858e-03 3 1  ON 53
ci_055                -2.687884e-03 3 1  ON 54
ci_056                 5.517379e-03 3 1  ON 55
ci_057                 5.490411e-03 3 1  ON 56
ci_058                -1.794197e-03 3 1  ON 57
ci_059                -2.263709e-03 3 1  ON 58
ci_060                 5.404544e-03 3 1  ON 59
ci_061                 4.488596e-03 3 1  ON 60
ci_062                -4.257776e-03 3 1  ON 61
ci_063                -4.027042e-03 3 1  ON 62
ci_064                -3.351006e-03 3 1  ON 63
ci_065                -4.218902e-03 3 1  ON 64
ci_066                 5.182203e-03 3 1  ON 65
ci_067                 5.303583e-03 3 1  ON 66
ci_068                -5.935717e-03 3 1  ON 67
ci_069                -4.861986e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1433e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.1855
    reference variance = 0.29203
====================================================
  Execution time = 1.3995e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8729e-01
  Total weights = 1.957208758e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5230e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276618955353
                                         uncertainty =       0.001401883115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276618955353
                                         uncertainty =       0.001401883115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371952798
  error estimate for blocks of size 2^( 2) =       0.000385892313
  error estimate for blocks of size 2^( 3) =       0.000398169317
  error estimate for blocks of size 2^( 4) =       0.000406689449
  error estimate for blocks of size 2^( 5) =       0.000412833254
  error estimate for blocks of size 2^( 6) =       0.000415556297
  error estimate for blocks of size 2^( 7) =       0.000416811003

      target function =      -0.917108943138
              le_mean =     -17.212021622328
             les_mean =     296.540977778176
             stat err =       0.000412972501
             autocorr =       1.232726142617
   target nu stat err =       0.000412972501
   target dn stat err =       0.002048500264
      target stat err =       0.002735560343
              std dev =       0.526020691833
             le_variance =       0.276697768236


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721202162233e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-06, overlap shift 3.7253e-05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917116295630       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917646019854       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917786177843       residual = 6.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917833017119       residual = 9.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917837632443       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917839278732       residual = 7.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917840740972       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917840512107       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917840328830       residual = 9.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917840346065       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917840266694       residual = 5.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-06 is 2.377279e-03

solving harmonic davidson linear method for identity shift 1.4901e-05, overlap shift 1.4901e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917116295630       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917645944446       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917786077666       residual = 6.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917832906852       residual = 9.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917837520912       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917839166696       residual = 7.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917840628513       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917840399677       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917840216463       residual = 9.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917840233695       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917840154351       residual = 5.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-05 is 2.376895e-03

solving harmonic davidson linear method for identity shift 5.9605e-05, overlap shift 5.9605e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917116295630       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917645643026       residual = 2.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917785677260       residual = 6.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917832466123       residual = 9.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917837075133       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917838718903       residual = 7.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917840179028       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917839950309       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917839767346       residual = 9.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917839784562       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917839705330       residual = 5.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-05 is 2.375358e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.444478 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6535e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
ci_001                -4.182252e-02 3 1  ON 0
ci_002                -3.267424e-02 3 1  ON 1
ci_003                -2.673439e-02 3 1  ON 2
ci_004                 2.418147e-02 3 1  ON 3
ci_005                 2.453520e-02 3 1  ON 4
ci_006                -2.193990e-02 3 1  ON 5
ci_007                -2.244588e-02 3 1  ON 6
ci_008                -8.728863e-03 3 1  ON 7
ci_009                -1.574228e-02 3 1  ON 8
ci_010                -8.751521e-03 3 1  ON 9
ci_011                -1.181240e-02 3 1  ON 10
ci_012                -9.965646e-03 3 1  ON 11
ci_013                -2.123033e-02 3 1  ON 12
ci_014                 1.145084e-02 3 1  ON 13
ci_015                 1.225482e-02 3 1  ON 14
ci_016                 1.733283e-02 3 1  ON 15
ci_017                 1.558294e-02 3 1  ON 16
ci_018                 1.134955e-02 3 1  ON 17
ci_019                 1.153755e-02 3 1  ON 18
ci_020                 1.794430e-02 3 1  ON 19
ci_021                 1.836519e-02 3 1  ON 20
ci_022                 8.755020e-03 3 1  ON 21
ci_023                 9.626216e-03 3 1  ON 22
ci_024                 1.083257e-02 3 1  ON 23
ci_025                 1.014280e-02 3 1  ON 24
ci_026                 1.235804e-02 3 1  ON 25
ci_027                 1.128466e-02 3 1  ON 26
ci_028                -1.552415e-02 3 1  ON 27
ci_029                -1.628712e-02 3 1  ON 28
ci_030                -9.361622e-03 3 1  ON 29
ci_031                -1.092390e-02 3 1  ON 30
ci_032                -1.514505e-02 3 1  ON 31
ci_033                 5.479150e-03 3 1  ON 32
ci_034                 5.413455e-03 3 1  ON 33
ci_035                -5.485925e-03 3 1  ON 34
ci_036                -1.316182e-02 3 1  ON 35
ci_037                -1.290897e-02 3 1  ON 36
ci_038                 2.085715e-03 3 1  ON 37
ci_039                 2.415143e-03 3 1  ON 38
ci_040                -3.244526e-03 3 1  ON 39
ci_041                 8.585221e-03 3 1  ON 40
ci_042                 9.073440e-03 3 1  ON 41
ci_043                -4.504643e-03 3 1  ON 42
ci_044                -4.422750e-03 3 1  ON 43
ci_045                -2.980764e-03 3 1  ON 44
ci_046                 6.110898e-03 3 1  ON 45
ci_047                 5.821862e-03 3 1  ON 46
ci_048                -1.356407e-02 3 1  ON 47
ci_049                -1.380133e-02 3 1  ON 48
ci_050                 3.668681e-03 3 1  ON 49
ci_051                 2.970303e-03 3 1  ON 50
ci_052                -2.246008e-03 3 1  ON 51
ci_053                -2.742240e-03 3 1  ON 52
ci_054                -2.970475e-03 3 1  ON 53
ci_055                -2.898880e-03 3 1  ON 54
ci_056                 4.875982e-03 3 1  ON 55
ci_057                 5.719417e-03 3 1  ON 56
ci_058                -3.137361e-03 3 1  ON 57
ci_059                -1.856660e-03 3 1  ON 58
ci_060                 5.642258e-03 3 1  ON 59
ci_061                 4.679271e-03 3 1  ON 60
ci_062                -3.671425e-03 3 1  ON 61
ci_063                -4.318107e-03 3 1  ON 62
ci_064                -3.243740e-03 3 1  ON 63
ci_065                -3.991847e-03 3 1  ON 64
ci_066                 4.704154e-03 3 1  ON 65
ci_067                 4.726314e-03 3 1  ON 66
ci_068                -4.509959e-03 3 1  ON 67
ci_069                -3.483564e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.253
    reference variance = 0.238856
====================================================
  Execution time = 1.3535e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8774e-01
  Total weights = 1.9571e+06
  Execution time = 1.8627e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00144254
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278682327737
                                         uncertainty =       0.002326875360

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278682327737
                                         uncertainty =       0.002326875360

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373266431
  error estimate for blocks of size 2^( 2) =       0.000387176326
  error estimate for blocks of size 2^( 3) =       0.000399442783
  error estimate for blocks of size 2^( 4) =       0.000408040147
  error estimate for blocks of size 2^( 5) =       0.000413482431
  error estimate for blocks of size 2^( 6) =       0.000414870663
  error estimate for blocks of size 2^( 7) =       0.000416580678

      target function =      -0.807364429223
              le_mean =     -17.212188394997
             les_mean =     296.638455359281
             stat err =       0.000413243480
             autocorr =       1.225671676751
   target nu stat err =       0.000413243480
   target dn stat err =       0.055391911350
      target stat err =       0.056277954119
              std dev =       0.527878449733
             le_variance =       0.278655657692

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276479569660
                                         uncertainty =       0.001582652315

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276479569660
                                         uncertainty =       0.001582652315

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371791140
  error estimate for blocks of size 2^( 2) =       0.000385756019
  error estimate for blocks of size 2^( 3) =       0.000398153261
  error estimate for blocks of size 2^( 4) =       0.000406762026
  error estimate for blocks of size 2^( 5) =       0.000412135310
  error estimate for blocks of size 2^( 6) =       0.000413716986
  error estimate for blocks of size 2^( 7) =       0.000415527016

      target function =      -0.916533902512
              le_mean =     -17.212064682110
             les_mean =     296.542909818276
             stat err =       0.000412035334
             autocorr =       1.228204966949
   target nu stat err =       0.000412035334
   target dn stat err =       0.002068038892
      target stat err =       0.002756973438
              std dev =       0.525792072580
             le_variance =       0.276457303588

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0014305
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278212463193
                                         uncertainty =       0.001659543758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278212463193
                                         uncertainty =       0.001659543758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372954245
  error estimate for blocks of size 2^( 2) =       0.000386918236
  error estimate for blocks of size 2^( 3) =       0.000399319499
  error estimate for blocks of size 2^( 4) =       0.000407948235
  error estimate for blocks of size 2^( 5) =       0.000413317144
  error estimate for blocks of size 2^( 6) =       0.000414965786
  error estimate for blocks of size 2^( 7) =       0.000416893281

      target function =      -0.893506871962
              le_mean =     -17.212164175452
             les_mean =     296.564405523076
             stat err =       0.000413281111
             autocorr =       1.227948082385
   target nu stat err =       0.000413281111
   target dn stat err =       0.007797978215
      target stat err =       0.009673972676
              std dev =       0.527436950732
             le_variance =       0.278189736997

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276479140490
                                         uncertainty =       0.001582613895

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276479140490
                                         uncertainty =       0.001582613895

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371790851
  error estimate for blocks of size 2^( 2) =       0.000385755728
  error estimate for blocks of size 2^( 3) =       0.000398152953
  error estimate for blocks of size 2^( 4) =       0.000406761706
  error estimate for blocks of size 2^( 5) =       0.000412134984
  error estimate for blocks of size 2^( 6) =       0.000413716596
  error estimate for blocks of size 2^( 7) =       0.000415526577

      target function =      -0.916542177774
              le_mean =     -17.212064680389
             les_mean =     296.542903407229
             stat err =       0.000412034966
             autocorr =       1.228204677622
   target nu stat err =       0.000412034966
   target dn stat err =       0.002067888389
      target stat err =       0.002756830388
              std dev =       0.525791664520
             le_variance =       0.276456874478


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.807364429223        initial
     3.7253e-06     3.7253e-05             2.3773e-03        -0.916533902512
     1.4901e-05     1.4901e-04             2.3769e-03        -0.893506871962
     5.9605e-05     5.9605e-04             2.3754e-03        -0.916542177774  <--

*****************************************************************************
Applying the update for shift_i =   5.9605e-05     and shift_s =   5.9605e-04
*****************************************************************************

  Execution time = 2.2927e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
ci_001                -4.182254e-02 3 1  ON 0
ci_002                -3.267437e-02 3 1  ON 1
ci_003                -2.673394e-02 3 1  ON 2
ci_004                 2.418122e-02 3 1  ON 3
ci_005                 2.453528e-02 3 1  ON 4
ci_006                -2.193952e-02 3 1  ON 5
ci_007                -2.244545e-02 3 1  ON 6
ci_008                -8.728553e-03 3 1  ON 7
ci_009                -1.574186e-02 3 1  ON 8
ci_010                -8.751891e-03 3 1  ON 9
ci_011                -1.181153e-02 3 1  ON 10
ci_012                -9.965037e-03 3 1  ON 11
ci_013                -2.122997e-02 3 1  ON 12
ci_014                 1.145218e-02 3 1  ON 13
ci_015                 1.225515e-02 3 1  ON 14
ci_016                 1.733255e-02 3 1  ON 15
ci_017                 1.558393e-02 3 1  ON 16
ci_018                 1.134947e-02 3 1  ON 17
ci_019                 1.153787e-02 3 1  ON 18
ci_020                 1.794474e-02 3 1  ON 19
ci_021                 1.836511e-02 3 1  ON 20
ci_022                 8.756557e-03 3 1  ON 21
ci_023                 9.626213e-03 3 1  ON 22
ci_024                 1.083126e-02 3 1  ON 23
ci_025                 1.014265e-02 3 1  ON 24
ci_026                 1.235757e-02 3 1  ON 25
ci_027                 1.128440e-02 3 1  ON 26
ci_028                -1.552434e-02 3 1  ON 27
ci_029                -1.628644e-02 3 1  ON 28
ci_030                -9.361475e-03 3 1  ON 29
ci_031                -1.092295e-02 3 1  ON 30
ci_032                -1.514418e-02 3 1  ON 31
ci_033                 5.479001e-03 3 1  ON 32
ci_034                 5.414847e-03 3 1  ON 33
ci_035                -5.485955e-03 3 1  ON 34
ci_036                -1.316160e-02 3 1  ON 35
ci_037                -1.290898e-02 3 1  ON 36
ci_038                 2.085832e-03 3 1  ON 37
ci_039                 2.415027e-03 3 1  ON 38
ci_040                -3.244699e-03 3 1  ON 39
ci_041                 8.585211e-03 3 1  ON 40
ci_042                 9.073259e-03 3 1  ON 41
ci_043                -4.504519e-03 3 1  ON 42
ci_044                -4.423567e-03 3 1  ON 43
ci_045                -2.980998e-03 3 1  ON 44
ci_046                 6.111010e-03 3 1  ON 45
ci_047                 5.821958e-03 3 1  ON 46
ci_048                -1.356406e-02 3 1  ON 47
ci_049                -1.380103e-02 3 1  ON 48
ci_050                 3.668185e-03 3 1  ON 49
ci_051                 2.970566e-03 3 1  ON 50
ci_052                -2.246019e-03 3 1  ON 51
ci_053                -2.742385e-03 3 1  ON 52
ci_054                -2.970448e-03 3 1  ON 53
ci_055                -2.898745e-03 3 1  ON 54
ci_056                 4.876368e-03 3 1  ON 55
ci_057                 5.719275e-03 3 1  ON 56
ci_058                -3.136556e-03 3 1  ON 57
ci_059                -1.856819e-03 3 1  ON 58
ci_060                 5.642101e-03 3 1  ON 59
ci_061                 4.679143e-03 3 1  ON 60
ci_062                -3.671729e-03 3 1  ON 61
ci_063                -4.317916e-03 3 1  ON 62
ci_064                -3.243799e-03 3 1  ON 63
ci_065                -3.991978e-03 3 1  ON 64
ci_066                 4.704451e-03 3 1  ON 65
ci_067                 4.726621e-03 3 1  ON 66
ci_068                -4.510873e-03 3 1  ON 67
ci_069                -3.484436e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9477e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.2175
    reference variance = 0.174689
====================================================
  Execution time = 1.3919e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8837e-01
  Total weights = 1.957037596e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5199e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275893360206
                                         uncertainty =       0.001443004027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275893360206
                                         uncertainty =       0.001443004027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371365292
  error estimate for blocks of size 2^( 2) =       0.000384733210
  error estimate for blocks of size 2^( 3) =       0.000397118954
  error estimate for blocks of size 2^( 4) =       0.000405665282
  error estimate for blocks of size 2^( 5) =       0.000412086132
  error estimate for blocks of size 2^( 6) =       0.000415574500
  error estimate for blocks of size 2^( 7) =       0.000416976783

      target function =      -0.915730411585
              le_mean =     -17.212151621128
             les_mean =     296.546531456985
             stat err =       0.000412575674
             autocorr =       1.234254192296
   target nu stat err =       0.000412575674
   target dn stat err =       0.002869775413
      target stat err =       0.003778182663
              std dev =       0.525189833107
             le_variance =       0.275824360799


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721215162113e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-05, overlap shift 1.4901e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915745102037       residual = 7.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916172012067       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916301100943       residual = 6.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916340194615       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916345442265       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916347050890       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916346810669       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916346777862       residual = 9.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916346852300       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916347030897       residual = 7.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916346994250       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916347005518       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-05 is 2.954160e-03

solving harmonic davidson linear method for identity shift 5.9605e-05, overlap shift 5.9605e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915745102037       residual = 7.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916171761499       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916300752307       residual = 6.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916339809480       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916345050625       residual = 4.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916346657019       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916346416710       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916346384060       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916346458343       residual = 2.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916346636718       residual = 7.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916346600106       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916346611346       residual = 4.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-05 is 2.951880e-03

solving harmonic davidson linear method for identity shift 2.3842e-04, overlap shift 2.3842e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915745102037       residual = 7.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916170762159       residual = 1.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916299362134       residual = 6.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916338273942       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916343489205       residual = 4.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916345086723       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916344846071       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916344814044       residual = 9.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916344887710       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916345065206       residual = 7.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916345028730       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916345039863       residual = 4.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-04 is 2.942794e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.454381 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6457e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
ci_001                -4.197376e-02 3 1  ON 0
ci_002                -3.290130e-02 3 1  ON 1
ci_003                -2.587511e-02 3 1  ON 2
ci_004                 2.304447e-02 3 1  ON 3
ci_005                 2.485081e-02 3 1  ON 4
ci_006                -2.199306e-02 3 1  ON 5
ci_007                -2.270198e-02 3 1  ON 6
ci_008                -8.832281e-03 3 1  ON 7
ci_009                -1.489037e-02 3 1  ON 8
ci_010                -9.936744e-03 3 1  ON 9
ci_011                -1.098397e-02 3 1  ON 10
ci_012                -1.069747e-02 3 1  ON 11
ci_013                -1.981690e-02 3 1  ON 12
ci_014                 1.369524e-02 3 1  ON 13
ci_015                 1.381906e-02 3 1  ON 14
ci_016                 1.618904e-02 3 1  ON 15
ci_017                 1.576845e-02 3 1  ON 16
ci_018                 1.084664e-02 3 1  ON 17
ci_019                 1.110580e-02 3 1  ON 18
ci_020                 1.781053e-02 3 1  ON 19
ci_021                 1.690496e-02 3 1  ON 20
ci_022                 1.054238e-02 3 1  ON 21
ci_023                 9.641941e-03 3 1  ON 22
ci_024                 9.795252e-03 3 1  ON 23
ci_025                 9.321233e-03 3 1  ON 24
ci_026                 1.105749e-02 3 1  ON 25
ci_027                 1.226755e-02 3 1  ON 26
ci_028                -1.654456e-02 3 1  ON 27
ci_029                -1.624312e-02 3 1  ON 28
ci_030                -9.243391e-03 3 1  ON 29
ci_031                -9.202927e-03 3 1  ON 30
ci_032                -1.481667e-02 3 1  ON 31
ci_033                 5.763496e-03 3 1  ON 32
ci_034                 4.244720e-03 3 1  ON 33
ci_035                -5.105156e-03 3 1  ON 34
ci_036                -1.350907e-02 3 1  ON 35
ci_037                -1.264978e-02 3 1  ON 36
ci_038                 2.059307e-03 3 1  ON 37
ci_039                 2.861479e-03 3 1  ON 38
ci_040                -3.652956e-03 3 1  ON 39
ci_041                 8.461270e-03 3 1  ON 40
ci_042                 8.506934e-03 3 1  ON 41
ci_043                -4.627336e-03 3 1  ON 42
ci_044                -5.966326e-03 3 1  ON 43
ci_045                -3.006123e-03 3 1  ON 44
ci_046                 5.068233e-03 3 1  ON 45
ci_047                 7.039265e-03 3 1  ON 46
ci_048                -1.382379e-02 3 1  ON 47
ci_049                -1.084915e-02 3 1  ON 48
ci_050                 3.088297e-03 3 1  ON 49
ci_051                 2.740961e-03 3 1  ON 50
ci_052                -3.034271e-03 3 1  ON 51
ci_053                -2.357410e-03 3 1  ON 52
ci_054                -2.813175e-03 3 1  ON 53
ci_055                -2.638874e-03 3 1  ON 54
ci_056                 5.513260e-03 3 1  ON 55
ci_057                 6.275125e-03 3 1  ON 56
ci_058                -1.929269e-03 3 1  ON 57
ci_059                -2.654875e-03 3 1  ON 58
ci_060                 5.279879e-03 3 1  ON 59
ci_061                 4.639643e-03 3 1  ON 60
ci_062                -4.025178e-03 3 1  ON 61
ci_063                -3.432074e-03 3 1  ON 62
ci_064                -3.070640e-03 3 1  ON 63
ci_065                -3.861790e-03 3 1  ON 64
ci_066                 4.268582e-03 3 1  ON 65
ci_067                 4.820062e-03 3 1  ON 66
ci_068                -4.620534e-03 3 1  ON 67
ci_069                -3.542872e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.101
    reference variance = 1.0788
====================================================
  Execution time = 1.3651e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8869e-01
  Total weights = 1.9571e+06
  Execution time = 1.8602e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000334515
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303747555592
                                         uncertainty =       0.025635940005

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.303747555592
                                         uncertainty =       0.025635940005

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389678763
  error estimate for blocks of size 2^( 2) =       0.000402834764
  error estimate for blocks of size 2^( 3) =       0.000414592901
  error estimate for blocks of size 2^( 4) =       0.000422387146
  error estimate for blocks of size 2^( 5) =       0.000427114152
  error estimate for blocks of size 2^( 6) =       0.000430110806
  error estimate for blocks of size 2^( 7) =       0.000432136808

      target function =      -0.358329749523
              le_mean =     -17.212426546830
             les_mean =     297.289832138433
             stat err =       0.000427937228
             autocorr =       1.205998208594
   target nu stat err =       0.000427937228
   target dn stat err =       0.720870651067
      target stat err =       0.179686364037
              std dev =       0.551088991355
             le_variance =       0.303699076393

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276837579463
                                         uncertainty =       0.001443170103

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276837579463
                                         uncertainty =       0.001443170103

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372053876
  error estimate for blocks of size 2^( 2) =       0.000385737719
  error estimate for blocks of size 2^( 3) =       0.000397924132
  error estimate for blocks of size 2^( 4) =       0.000407064259
  error estimate for blocks of size 2^( 5) =       0.000411997955
  error estimate for blocks of size 2^( 6) =       0.000415083305
  error estimate for blocks of size 2^( 7) =       0.000416564568

      target function =      -0.915315231719
              le_mean =     -17.212400744416
             les_mean =     296.555482093102
             stat err =       0.000412677522
             autocorr =       1.230296986641
   target nu stat err =       0.000412677522
   target dn stat err =       0.001932766138
      target stat err =       0.002579900741
              std dev =       0.526163637824
             le_variance =       0.276848173768

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000335461
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278428292358
                                         uncertainty =       0.001462590853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278428292358
                                         uncertainty =       0.001462590853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373123524
  error estimate for blocks of size 2^( 2) =       0.000386822345
  error estimate for blocks of size 2^( 3) =       0.000398998089
  error estimate for blocks of size 2^( 4) =       0.000408157199
  error estimate for blocks of size 2^( 5) =       0.000413010329
  error estimate for blocks of size 2^( 6) =       0.000416211431
  error estimate for blocks of size 2^( 7) =       0.000417653416

      target function =      -0.744934929343
              le_mean =     -17.212489636788
             les_mean =     296.702264942849
             stat err =       0.000413758094
             autocorr =       1.229667635201
   target nu stat err =       0.000413758094
   target dn stat err =       0.121264913876
      target stat err =       0.106560502242
              std dev =       0.527676348631
             le_variance =       0.278442328904

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276836763818
                                         uncertainty =       0.001443188471

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276836763818
                                         uncertainty =       0.001443188471

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372053318
  error estimate for blocks of size 2^( 2) =       0.000385737041
  error estimate for blocks of size 2^( 3) =       0.000397923431
  error estimate for blocks of size 2^( 4) =       0.000407063508
  error estimate for blocks of size 2^( 5) =       0.000411997257
  error estimate for blocks of size 2^( 6) =       0.000415082369
  error estimate for blocks of size 2^( 7) =       0.000416563335

      target function =      -0.915385997268
              le_mean =     -17.212400850575
             les_mean =     296.555431337498
             stat err =       0.000412676617
             autocorr =       1.230295283835
   target nu stat err =       0.000412676617
   target dn stat err =       0.001932052913
      target stat err =       0.002579386471
              std dev =       0.526162848791
             le_variance =       0.276847343448


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.358329749523        initial
     1.4901e-05     1.4901e-04             2.9542e-03        -0.915315231719
     5.9605e-05     5.9605e-04             2.9519e-03        -0.744934929343
     2.3842e-04     2.3842e-03             2.9428e-03        -0.915385997268  <--

*****************************************************************************
Applying the update for shift_i =   2.3842e-04     and shift_s =   2.3842e-03
*****************************************************************************

  Execution time = 2.3001e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
ci_001                -4.197312e-02 3 1  ON 0
ci_002                -3.290064e-02 3 1  ON 1
ci_003                -2.587721e-02 3 1  ON 2
ci_004                 2.304786e-02 3 1  ON 3
ci_005                 2.484940e-02 3 1  ON 4
ci_006                -2.199273e-02 3 1  ON 5
ci_007                -2.270112e-02 3 1  ON 6
ci_008                -8.832042e-03 3 1  ON 7
ci_009                -1.489247e-02 3 1  ON 8
ci_010                -9.933712e-03 3 1  ON 9
ci_011                -1.098613e-02 3 1  ON 10
ci_012                -1.069563e-02 3 1  ON 11
ci_013                -1.982140e-02 3 1  ON 12
ci_014                 1.368930e-02 3 1  ON 13
ci_015                 1.381449e-02 3 1  ON 14
ci_016                 1.619239e-02 3 1  ON 15
ci_017                 1.576795e-02 3 1  ON 16
ci_018                 1.084809e-02 3 1  ON 17
ci_019                 1.110689e-02 3 1  ON 18
ci_020                 1.781105e-02 3 1  ON 19
ci_021                 1.690906e-02 3 1  ON 20
ci_022                 1.053762e-02 3 1  ON 21
ci_023                 9.642040e-03 3 1  ON 22
ci_024                 9.798194e-03 3 1  ON 23
ci_025                 9.323660e-03 3 1  ON 24
ci_026                 1.106078e-02 3 1  ON 25
ci_027                 1.226505e-02 3 1  ON 26
ci_028                -1.654169e-02 3 1  ON 27
ci_029                -1.624315e-02 3 1  ON 28
ci_030                -9.243655e-03 3 1  ON 29
ci_031                -9.207787e-03 3 1  ON 30
ci_032                -1.481742e-02 3 1  ON 31
ci_033                 5.762832e-03 3 1  ON 32
ci_034                 4.247929e-03 3 1  ON 33
ci_035                -5.106066e-03 3 1  ON 34
ci_036                -1.350834e-02 3 1  ON 35
ci_037                -1.265047e-02 3 1  ON 36
ci_038                 2.059368e-03 3 1  ON 37
ci_039                 2.860433e-03 3 1  ON 38
ci_040                -3.652026e-03 3 1  ON 39
ci_041                 8.461293e-03 3 1  ON 40
ci_042                 8.508160e-03 3 1  ON 41
ci_043                -4.627038e-03 3 1  ON 42
ci_044                -5.962397e-03 3 1  ON 43
ci_045                -3.006056e-03 3 1  ON 44
ci_046                 5.070939e-03 3 1  ON 45
ci_047                 7.036105e-03 3 1  ON 46
ci_048                -1.382314e-02 3 1  ON 47
ci_049                -1.085824e-02 3 1  ON 48
ci_050                 3.089564e-03 3 1  ON 49
ci_051                 2.741417e-03 3 1  ON 50
ci_052                -3.032416e-03 3 1  ON 51
ci_053                -2.358599e-03 3 1  ON 52
ci_054                -2.813492e-03 3 1  ON 53
ci_055                -2.639530e-03 3 1  ON 54
ci_056                 5.511719e-03 3 1  ON 55
ci_057                 6.273761e-03 3 1  ON 56
ci_058                -1.932375e-03 3 1  ON 57
ci_059                -2.653421e-03 3 1  ON 58
ci_060                 5.280859e-03 3 1  ON 59
ci_061                 4.639820e-03 3 1  ON 60
ci_062                -4.024460e-03 3 1  ON 61
ci_063                -3.434358e-03 3 1  ON 62
ci_064                -3.071037e-03 3 1  ON 63
ci_065                -3.862090e-03 3 1  ON 64
ci_066                 4.269633e-03 3 1  ON 65
ci_067                 4.819690e-03 3 1  ON 66
ci_068                -4.620321e-03 3 1  ON 67
ci_069                -3.542769e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9473e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.1492
    reference variance = 0.176625
====================================================
  Execution time = 1.3965e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9553e-01
  Total weights = 1.957093225e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5273e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278300564820
                                         uncertainty =       0.001687846070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278300564820
                                         uncertainty =       0.001687846070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373052657
  error estimate for blocks of size 2^( 2) =       0.000386962493
  error estimate for blocks of size 2^( 3) =       0.000399233309
  error estimate for blocks of size 2^( 4) =       0.000407886548
  error estimate for blocks of size 2^( 5) =       0.000412972971
  error estimate for blocks of size 2^( 6) =       0.000415919166
  error estimate for blocks of size 2^( 7) =       0.000414461364

      target function =      -0.906401368118
              le_mean =     -17.211765730115
             les_mean =     296.540411271572
             stat err =       0.000412810012
             autocorr =       1.224503892374
   target nu stat err =       0.000412810012
   target dn stat err =       0.004012515422
      target stat err =       0.005142766457
              std dev =       0.527576126414
             le_variance =       0.278336569162


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721176573012e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-05, overlap shift 5.9605e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906429803060       residual = 4.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908262691030       residual = 3.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908487705564       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908561968249       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908580503923       residual = 8.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908587770834       residual = 2.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908587327759       residual = 5.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908587616479       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908588045965       residual = 4.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908587888637       residual = 7.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908588040286       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.908588004249       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-05 is 3.469268e-03

solving harmonic davidson linear method for identity shift 2.3842e-04, overlap shift 2.3842e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906429803060       residual = 4.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908258538265       residual = 3.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908482901870       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908556914138       residual = 2.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908575366028       residual = 8.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908582602019       residual = 2.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908582156122       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908582444460       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908582871035       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908582714623       residual = 7.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908582865368       residual = 1.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.908582829510       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-04 is 3.461091e-03

solving harmonic davidson linear method for identity shift 9.5367e-04, overlap shift 9.5367e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.906429803060       residual = 4.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.908242113269       residual = 3.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.908463909374       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.908536935899       residual = 2.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.908555059120       residual = 8.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.908562173852       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.908561717184       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908562004011       residual = 1.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.908562419204       residual = 4.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.908562266386       residual = 7.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.908562413602       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.908562378446       residual = 4.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-04 is 3.428771e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.464301 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6511e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
ci_001                -4.107473e-02 3 1  ON 0
ci_002                -3.236489e-02 3 1  ON 1
ci_003                -2.519289e-02 3 1  ON 2
ci_004                 2.433161e-02 3 1  ON 3
ci_005                 2.465316e-02 3 1  ON 4
ci_006                -2.335086e-02 3 1  ON 5
ci_007                -2.208527e-02 3 1  ON 6
ci_008                -9.853911e-03 3 1  ON 7
ci_009                -1.466872e-02 3 1  ON 8
ci_010                -8.547353e-03 3 1  ON 9
ci_011                -8.038578e-03 3 1  ON 10
ci_012                -8.652966e-03 3 1  ON 11
ci_013                -1.932790e-02 3 1  ON 12
ci_014                 1.117437e-02 3 1  ON 13
ci_015                 1.366959e-02 3 1  ON 14
ci_016                 1.699737e-02 3 1  ON 15
ci_017                 1.752555e-02 3 1  ON 16
ci_018                 1.080640e-02 3 1  ON 17
ci_019                 1.020230e-02 3 1  ON 18
ci_020                 1.870037e-02 3 1  ON 19
ci_021                 1.674695e-02 3 1  ON 20
ci_022                 9.500725e-03 3 1  ON 21
ci_023                 1.009995e-02 3 1  ON 22
ci_024                 9.562218e-03 3 1  ON 23
ci_025                 9.356216e-03 3 1  ON 24
ci_026                 1.199965e-02 3 1  ON 25
ci_027                 8.803955e-03 3 1  ON 26
ci_028                -1.415345e-02 3 1  ON 27
ci_029                -1.407174e-02 3 1  ON 28
ci_030                -8.114828e-03 3 1  ON 29
ci_031                -9.348853e-03 3 1  ON 30
ci_032                -1.502630e-02 3 1  ON 31
ci_033                 8.264030e-03 3 1  ON 32
ci_034                 6.499915e-03 3 1  ON 33
ci_035                -5.755134e-03 3 1  ON 34
ci_036                -1.537198e-02 3 1  ON 35
ci_037                -1.245148e-02 3 1  ON 36
ci_038                 2.026990e-03 3 1  ON 37
ci_039                 2.127382e-03 3 1  ON 38
ci_040                -2.202660e-03 3 1  ON 39
ci_041                 9.841083e-03 3 1  ON 40
ci_042                 8.551976e-03 3 1  ON 41
ci_043                -4.387865e-03 3 1  ON 42
ci_044                -2.862925e-03 3 1  ON 43
ci_045                -2.456827e-03 3 1  ON 44
ci_046                 6.131726e-03 3 1  ON 45
ci_047                 5.966086e-03 3 1  ON 46
ci_048                -1.298333e-02 3 1  ON 47
ci_049                -1.310836e-02 3 1  ON 48
ci_050                 3.280707e-03 3 1  ON 49
ci_051                 3.745798e-03 3 1  ON 50
ci_052                -2.680299e-03 3 1  ON 51
ci_053                -3.417811e-03 3 1  ON 52
ci_054                -2.953381e-03 3 1  ON 53
ci_055                -3.486448e-03 3 1  ON 54
ci_056                 5.747259e-03 3 1  ON 55
ci_057                 5.847193e-03 3 1  ON 56
ci_058                -3.188144e-03 3 1  ON 57
ci_059                -1.579191e-03 3 1  ON 58
ci_060                 5.154966e-03 3 1  ON 59
ci_061                 5.877152e-03 3 1  ON 60
ci_062                -3.411470e-03 3 1  ON 61
ci_063                -3.972140e-03 3 1  ON 62
ci_064                -3.494143e-03 3 1  ON 63
ci_065                -3.968063e-03 3 1  ON 64
ci_066                 5.754907e-03 3 1  ON 65
ci_067                 4.961219e-03 3 1  ON 66
ci_068                -5.466882e-03 3 1  ON 67
ci_069                -4.754972e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.1576
    reference variance = 0.290631
====================================================
  Execution time = 1.3588e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8863e-01
  Total weights = 1.9569e+06
  Execution time = 1.8635e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0397135
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312621328329
                                         uncertainty =       0.021855518782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.312621328329
                                         uncertainty =       0.021855518782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000395275299
  error estimate for blocks of size 2^( 2) =       0.000408512909
  error estimate for blocks of size 2^( 3) =       0.000420257934
  error estimate for blocks of size 2^( 4) =       0.000428993536
  error estimate for blocks of size 2^( 5) =       0.000434742772
  error estimate for blocks of size 2^( 6) =       0.000439033490
  error estimate for blocks of size 2^( 7) =       0.000440366104

      target function =      -0.085676730672
              le_mean =     -17.211890473470
             les_mean =     300.476267989988
             stat err =       0.000435783976
             autocorr =       1.215466969341
   target nu stat err =       0.000435783976
   target dn stat err =       3.661495189849
      target stat err =       0.067563134809
              std dev =       0.559003688719
             le_variance =       0.312485124002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277833122704
                                         uncertainty =       0.001506623589

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277833122704
                                         uncertainty =       0.001506623589

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372729417
  error estimate for blocks of size 2^( 2) =       0.000386742990
  error estimate for blocks of size 2^( 3) =       0.000399127784
  error estimate for blocks of size 2^( 4) =       0.000408605695
  error estimate for blocks of size 2^( 5) =       0.000414766487
  error estimate for blocks of size 2^( 6) =       0.000419707267
  error estimate for blocks of size 2^( 7) =       0.000420312729

      target function =      -0.915203468752
              le_mean =     -17.211421448961
             les_mean =     296.521663113253
             stat err =       0.000415848044
             autocorr =       1.244749578508
   target nu stat err =       0.000415848044
   target dn stat err =       0.002062670315
      target stat err =       0.002740767315
              std dev =       0.527118996083
             le_variance =       0.277854436031

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0407526
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283888369874
                                         uncertainty =       0.001807046218

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283888369874
                                         uncertainty =       0.001807046218

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376770468
  error estimate for blocks of size 2^( 2) =       0.000390734785
  error estimate for blocks of size 2^( 3) =       0.000403036500
  error estimate for blocks of size 2^( 4) =       0.000412558277
  error estimate for blocks of size 2^( 5) =       0.000418608333
  error estimate for blocks of size 2^( 6) =       0.000423569463
  error estimate for blocks of size 2^( 7) =       0.000424367185

      target function =      -0.850636918938
              le_mean =     -17.211728818851
             les_mean =     296.585401003414
             stat err =       0.000419775815
             autocorr =       1.241312467688
   target nu stat err =       0.000419775815
   target dn stat err =       0.017819447731
      target stat err =       0.020003655549
              std dev =       0.532833905562
             le_variance =       0.283911970916

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277813637736
                                         uncertainty =       0.001506794533

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277813637736
                                         uncertainty =       0.001506794533

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372716259
  error estimate for blocks of size 2^( 2) =       0.000386729365
  error estimate for blocks of size 2^( 3) =       0.000399113422
  error estimate for blocks of size 2^( 4) =       0.000408590052
  error estimate for blocks of size 2^( 5) =       0.000414750854
  error estimate for blocks of size 2^( 6) =       0.000419690879
  error estimate for blocks of size 2^( 7) =       0.000420294051

      target function =      -0.915220263270
              le_mean =     -17.211421158720
             les_mean =     296.521640104627
             stat err =       0.000415831459
             autocorr =       1.244738166886
   target nu stat err =       0.000415831459
   target dn stat err =       0.002065603879
      target stat err =       0.002744577189
              std dev =       0.527100388999
             le_variance =       0.277834820083


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.085676730672        initial
     5.9605e-05     5.9605e-04             3.4693e-03        -0.915203468752
     2.3842e-04     2.3842e-03             3.4611e-03        -0.850636918938
     9.5367e-04     9.5367e-03             3.4288e-03        -0.915220263270  <--

*****************************************************************************
Applying the update for shift_i =   9.5367e-04     and shift_s =   9.5367e-03
*****************************************************************************

  Execution time = 2.2947e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
ci_001                -4.108592e-02 3 1  ON 0
ci_002                -3.237079e-02 3 1  ON 1
ci_003                -2.519773e-02 3 1  ON 2
ci_004                 2.431543e-02 3 1  ON 3
ci_005                 2.466098e-02 3 1  ON 4
ci_006                -2.333518e-02 3 1  ON 5
ci_007                -2.209291e-02 3 1  ON 6
ci_008                -9.844505e-03 3 1  ON 7
ci_009                -1.467063e-02 3 1  ON 8
ci_010                -8.560847e-03 3 1  ON 9
ci_011                -8.066671e-03 3 1  ON 10
ci_012                -8.672823e-03 3 1  ON 11
ci_013                -1.933459e-02 3 1  ON 12
ci_014                 1.120120e-02 3 1  ON 13
ci_015                 1.367308e-02 3 1  ON 14
ci_016                 1.698762e-02 3 1  ON 15
ci_017                 1.750434e-02 3 1  ON 16
ci_018                 1.080708e-02 3 1  ON 17
ci_019                 1.020953e-02 3 1  ON 18
ci_020                 1.869055e-02 3 1  ON 19
ci_021                 1.674926e-02 3 1  ON 20
ci_022                 9.512478e-03 3 1  ON 21
ci_023                 1.009510e-02 3 1  ON 22
ci_024                 9.564763e-03 3 1  ON 23
ci_025                 9.356893e-03 3 1  ON 24
ci_026                 1.198951e-02 3 1  ON 25
ci_027                 8.836275e-03 3 1  ON 26
ci_028                -1.417816e-02 3 1  ON 27
ci_029                -1.409679e-02 3 1  ON 28
ci_030                -8.125878e-03 3 1  ON 29
ci_031                -9.345370e-03 3 1  ON 30
ci_032                -1.502419e-02 3 1  ON 31
ci_033                 8.238999e-03 3 1  ON 32
ci_034                 6.476060e-03 3 1  ON 33
ci_035                -5.748868e-03 3 1  ON 34
ci_036                -1.535566e-02 3 1  ON 35
ci_037                -1.245236e-02 3 1  ON 36
ci_038                 2.027285e-03 3 1  ON 37
ci_039                 2.134088e-03 3 1  ON 38
ci_040                -2.215683e-03 3 1  ON 39
ci_041                 9.830798e-03 3 1  ON 40
ci_042                 8.553875e-03 3 1  ON 41
ci_043                -4.390104e-03 3 1  ON 42
ci_044                -2.893272e-03 3 1  ON 43
ci_045                -2.461723e-03 3 1  ON 44
ci_046                 6.120659e-03 3 1  ON 45
ci_047                 5.977260e-03 3 1  ON 46
ci_048                -1.299430e-02 3 1  ON 47
ci_049                -1.308149e-02 3 1  ON 48
ci_050                 3.278910e-03 3 1  ON 49
ci_051                 3.737210e-03 3 1  ON 50
ci_052                -2.683908e-03 3 1  ON 51
ci_053                -3.407346e-03 3 1  ON 52
ci_054                -2.952747e-03 3 1  ON 53
ci_055                -3.478257e-03 3 1  ON 54
ci_056                 5.744808e-03 3 1  ON 55
ci_057                 5.851336e-03 3 1  ON 56
ci_058                -3.176147e-03 3 1  ON 57
ci_059                -1.587093e-03 3 1  ON 58
ci_060                 5.155906e-03 3 1  ON 59
ci_061                 5.864002e-03 3 1  ON 60
ci_062                -3.417666e-03 3 1  ON 61
ci_063                -3.966529e-03 3 1  ON 62
ci_064                -3.490263e-03 3 1  ON 63
ci_065                -3.967055e-03 3 1  ON 64
ci_066                 5.741691e-03 3 1  ON 65
ci_067                 4.960866e-03 3 1  ON 66
ci_068                -5.458490e-03 3 1  ON 67
ci_069                -4.741694e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9473e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.2986
    reference variance = 0.214134
====================================================
  Execution time = 1.3881e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8777e-01
  Total weights = 1.957251144e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5043e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275690306936
                                         uncertainty =       0.002349189088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275690306936
                                         uncertainty =       0.002349189088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371223891
  error estimate for blocks of size 2^( 2) =       0.000384991151
  error estimate for blocks of size 2^( 3) =       0.000397714444
  error estimate for blocks of size 2^( 4) =       0.000406378379
  error estimate for blocks of size 2^( 5) =       0.000411791792
  error estimate for blocks of size 2^( 6) =       0.000416401322
  error estimate for blocks of size 2^( 7) =       0.000418481253

      target function =      -0.916406114528
              le_mean =     -17.211781822545
             les_mean =     296.533204013813
             stat err =       0.000413263187
             autocorr =       1.239314705051
   target nu stat err =       0.000413263187
   target dn stat err =       0.003429159098
      target stat err =       0.004502496476
              std dev =       0.524989861595
             le_variance =       0.275614354778


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721178182255e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-04, overlap shift 2.3842e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916427204517       residual = 2.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917857870195       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918026852660       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918071784209       residual = 1.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918080026416       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918083733178       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918085963104       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918086943268       residual = 8.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918087116955       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918087182499       residual = 6.96e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918087240773       residual = 1.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918087232869       residual = 3.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-04 is 3.388352e-03

solving harmonic davidson linear method for identity shift 9.5367e-04, overlap shift 9.5367e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916427204517       residual = 2.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917844877037       residual = 3.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918011947470       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918056281140       residual = 1.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918064386948       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918068031494       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918070216860       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918071175456       residual = 8.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918071345987       residual = 1.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918071409728       residual = 6.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918071466474       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918071458812       residual = 3.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-04 is 3.355229e-03

solving harmonic davidson linear method for identity shift 3.8147e-03, overlap shift 3.8147e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916427204517       residual = 2.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.917795177922       residual = 3.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917955004722       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917997090302       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918004688837       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918008102591       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918010124013       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918011003650       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918011162565       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918011219833       residual = 6.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918011271043       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918011264248       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-03 is 3.228963e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.474259 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6404e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
ci_001                -4.258444e-02 3 1  ON 0
ci_002                -3.353521e-02 3 1  ON 1
ci_003                -2.668136e-02 3 1  ON 2
ci_004                 2.435949e-02 3 1  ON 3
ci_005                 2.372083e-02 3 1  ON 4
ci_006                -2.283143e-02 3 1  ON 5
ci_007                -2.121645e-02 3 1  ON 6
ci_008                -8.440993e-03 3 1  ON 7
ci_009                -1.510605e-02 3 1  ON 8
ci_010                -5.205619e-03 3 1  ON 9
ci_011                -1.065447e-02 3 1  ON 10
ci_012                -1.047906e-02 3 1  ON 11
ci_013                -1.904240e-02 3 1  ON 12
ci_014                 1.320716e-02 3 1  ON 13
ci_015                 1.277313e-02 3 1  ON 14
ci_016                 1.732358e-02 3 1  ON 15
ci_017                 1.677210e-02 3 1  ON 16
ci_018                 1.102595e-02 3 1  ON 17
ci_019                 1.065988e-02 3 1  ON 18
ci_020                 1.744946e-02 3 1  ON 19
ci_021                 1.731293e-02 3 1  ON 20
ci_022                 9.530770e-03 3 1  ON 21
ci_023                 1.061931e-02 3 1  ON 22
ci_024                 8.444992e-03 3 1  ON 23
ci_025                 7.748774e-03 3 1  ON 24
ci_026                 1.166031e-02 3 1  ON 25
ci_027                 1.089150e-02 3 1  ON 26
ci_028                -1.538839e-02 3 1  ON 27
ci_029                -1.499191e-02 3 1  ON 28
ci_030                -8.819570e-03 3 1  ON 29
ci_031                -1.073095e-02 3 1  ON 30
ci_032                -1.504353e-02 3 1  ON 31
ci_033                 5.645196e-03 3 1  ON 32
ci_034                 3.918896e-03 3 1  ON 33
ci_035                -5.592201e-03 3 1  ON 34
ci_036                -1.330439e-02 3 1  ON 35
ci_037                -1.254874e-02 3 1  ON 36
ci_038                 1.684664e-03 3 1  ON 37
ci_039                 2.143195e-03 3 1  ON 38
ci_040                -3.018991e-03 3 1  ON 39
ci_041                 8.502946e-03 3 1  ON 40
ci_042                 8.652197e-03 3 1  ON 41
ci_043                -4.110747e-03 3 1  ON 42
ci_044                -5.522599e-03 3 1  ON 43
ci_045                -3.324782e-03 3 1  ON 44
ci_046                 5.760255e-03 3 1  ON 45
ci_047                 5.807592e-03 3 1  ON 46
ci_048                -1.335513e-02 3 1  ON 47
ci_049                -1.120037e-02 3 1  ON 48
ci_050                 3.421088e-03 3 1  ON 49
ci_051                 3.303296e-03 3 1  ON 50
ci_052                -1.856180e-03 3 1  ON 51
ci_053                -2.804461e-03 3 1  ON 52
ci_054                -2.491149e-03 3 1  ON 53
ci_055                -2.707354e-03 3 1  ON 54
ci_056                 5.384102e-03 3 1  ON 55
ci_057                 5.427862e-03 3 1  ON 56
ci_058                -2.735529e-03 3 1  ON 57
ci_059                -1.828146e-03 3 1  ON 58
ci_060                 6.308612e-03 3 1  ON 59
ci_061                 5.626000e-03 3 1  ON 60
ci_062                -4.188160e-03 3 1  ON 61
ci_063                -4.888852e-03 3 1  ON 62
ci_064                -3.096913e-03 3 1  ON 63
ci_065                -3.893483e-03 3 1  ON 64
ci_066                 4.845517e-03 3 1  ON 65
ci_067                 3.749263e-03 3 1  ON 66
ci_068                -5.809002e-03 3 1  ON 67
ci_069                -3.952802e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.2117
    reference variance = 0.218922
====================================================
  Execution time = 1.3623e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9261e-01
  Total weights = 1.9569e+06
  Execution time = 1.8599e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.419147623358
                                         uncertainty =       0.118654546076

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.419147623358
                                         uncertainty =       0.118654546076

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000457681185
  error estimate for blocks of size 2^( 2) =       0.000469172851
  error estimate for blocks of size 2^( 3) =       0.000479383979
  error estimate for blocks of size 2^( 4) =       0.000487068348
  error estimate for blocks of size 2^( 5) =       0.000491490136
  error estimate for blocks of size 2^( 6) =       0.000494150110
  error estimate for blocks of size 2^( 7) =       0.000493794492

      target function =      -0.104215633337
              le_mean =     -17.211887588348
             les_mean =     300.393980639829
             stat err =       0.000491625771
             autocorr =       1.153833552734
   target nu stat err =       0.000491625771
   target dn stat err =       2.726942316234
      target stat err =       0.062309373091
              std dev =       0.647258938588
             le_variance =       0.418944133582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278724015025
                                         uncertainty =       0.001678657962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278724015025
                                         uncertainty =       0.001678657962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373338910
  error estimate for blocks of size 2^( 2) =       0.000387362379
  error estimate for blocks of size 2^( 3) =       0.000399814550
  error estimate for blocks of size 2^( 4) =       0.000409125086
  error estimate for blocks of size 2^( 5) =       0.000414285669
  error estimate for blocks of size 2^( 6) =       0.000417217888
  error estimate for blocks of size 2^( 7) =       0.000417970280

      target function =      -0.909691592027
              le_mean =     -17.211815903526
             les_mean =     296.539584619593
             stat err =       0.000414649731
             autocorr =       1.233548600243
   target nu stat err =       0.000414649731
   target dn stat err =       0.002891034494
      target stat err =       0.003754567464
              std dev =       0.527980950345
             le_variance =       0.278763883927

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284911040073
                                         uncertainty =       0.004003018802

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284911040073
                                         uncertainty =       0.004003018802

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377456430
  error estimate for blocks of size 2^( 2) =       0.000391464494
  error estimate for blocks of size 2^( 3) =       0.000403784092
  error estimate for blocks of size 2^( 4) =       0.000413175002
  error estimate for blocks of size 2^( 5) =       0.000418373705
  error estimate for blocks of size 2^( 6) =       0.000421506381
  error estimate for blocks of size 2^( 7) =       0.000422191624

      target function =      -0.486269058711
              le_mean =     -17.212110879734
             les_mean =     297.066163120458
             stat err =       0.000418811678
             autocorr =       1.231129989025
   target nu stat err =       0.000418811678
   target dn stat err =       0.351610658166
      target stat err =       0.139555166010
              std dev =       0.533804002351
             le_variance =       0.284946712926

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278709202308
                                         uncertainty =       0.001681014500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278709202308
                                         uncertainty =       0.001681014500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373329018
  error estimate for blocks of size 2^( 2) =       0.000387347207
  error estimate for blocks of size 2^( 3) =       0.000399795953
  error estimate for blocks of size 2^( 4) =       0.000409101469
  error estimate for blocks of size 2^( 5) =       0.000414262406
  error estimate for blocks of size 2^( 6) =       0.000417189171
  error estimate for blocks of size 2^( 7) =       0.000417934335

      target function =      -0.910264048555
              le_mean =     -17.211815247580
             les_mean =     296.539116007193
             stat err =       0.000414621845
             autocorr =       1.233448051305
   target nu stat err =       0.000414621845
   target dn stat err =       0.002883286890
      target stat err =       0.003749396893
              std dev =       0.527966961059
             le_variance =       0.278749111970


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.104215633337        initial
     2.3842e-04     2.3842e-03             3.3884e-03        -0.909691592027
     9.5367e-04     9.5367e-03             3.3552e-03        -0.486269058711
     3.8147e-03     3.8147e-02             3.2290e-03        -0.910264048555  <--

*****************************************************************************
Applying the update for shift_i =   3.8147e-03     and shift_s =   3.8147e-02
*****************************************************************************

  Execution time = 2.2984e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
ci_001                -4.251617e-02 3 1  ON 0
ci_002                -3.348509e-02 3 1  ON 1
ci_003                -2.662805e-02 3 1  ON 2
ci_004                 2.435791e-02 3 1  ON 3
ci_005                 2.375226e-02 3 1  ON 4
ci_006                -2.285473e-02 3 1  ON 5
ci_007                -2.125637e-02 3 1  ON 6
ci_008                -8.489002e-03 3 1  ON 7
ci_009                -1.508967e-02 3 1  ON 8
ci_010                -5.331884e-03 3 1  ON 9
ci_011                -1.055730e-02 3 1  ON 10
ci_012                -1.041021e-02 3 1  ON 11
ci_013                -1.905833e-02 3 1  ON 12
ci_014                 1.312517e-02 3 1  ON 13
ci_015                 1.280745e-02 3 1  ON 14
ci_016                 1.730833e-02 3 1  ON 15
ci_017                 1.680617e-02 3 1  ON 16
ci_018                 1.101601e-02 3 1  ON 17
ci_019                 1.064851e-02 3 1  ON 18
ci_020                 1.750225e-02 3 1  ON 19
ci_021                 1.728785e-02 3 1  ON 20
ci_022                 9.528901e-03 3 1  ON 21
ci_023                 1.059711e-02 3 1  ON 22
ci_024                 8.488182e-03 3 1  ON 23
ci_025                 7.815214e-03 3 1  ON 24
ci_026                 1.167185e-02 3 1  ON 25
ci_027                 1.082032e-02 3 1  ON 26
ci_028                -1.534139e-02 3 1  ON 27
ci_029                -1.495279e-02 3 1  ON 28
ci_030                -8.794754e-03 3 1  ON 29
ci_031                -1.069119e-02 3 1  ON 30
ci_032                -1.504405e-02 3 1  ON 31
ci_033                 5.749607e-03 3 1  ON 32
ci_034                 4.020262e-03 3 1  ON 33
ci_035                -5.597640e-03 3 1  ON 34
ci_036                -1.337432e-02 3 1  ON 35
ci_037                -1.254452e-02 3 1  ON 36
ci_038                 1.696344e-03 3 1  ON 37
ci_039                 2.142810e-03 3 1  ON 38
ci_040                -2.990489e-03 3 1  ON 39
ci_041                 8.546863e-03 3 1  ON 40
ci_042                 8.645646e-03 3 1  ON 41
ci_043                -4.120910e-03 3 1  ON 42
ci_044                -5.422408e-03 3 1  ON 43
ci_045                -3.294519e-03 3 1  ON 44
ci_046                 5.774472e-03 3 1  ON 45
ci_047                 5.814166e-03 3 1  ON 46
ci_048                -1.333689e-02 3 1  ON 47
ci_049                -1.127926e-02 3 1  ON 48
ci_050                 3.416012e-03 3 1  ON 49
ci_051                 3.317559e-03 3 1  ON 50
ci_052                -1.886410e-03 3 1  ON 51
ci_053                -2.825723e-03 3 1  ON 52
ci_054                -2.504365e-03 3 1  ON 53
ci_055                -2.735801e-03 3 1  ON 54
ci_056                 5.397416e-03 3 1  ON 55
ci_057                 5.443459e-03 3 1  ON 56
ci_058                -2.749307e-03 3 1  ON 57
ci_059                -1.825048e-03 3 1  ON 58
ci_060                 6.263117e-03 3 1  ON 59
ci_061                 5.635719e-03 3 1  ON 60
ci_062                -4.161288e-03 3 1  ON 61
ci_063                -4.856738e-03 3 1  ON 62
ci_064                -3.110657e-03 3 1  ON 63
ci_065                -3.896013e-03 3 1  ON 64
ci_066                 4.875333e-03 3 1  ON 65
ci_067                 3.790131e-03 3 1  ON 66
ci_068                -5.796062e-03 3 1  ON 67
ci_069                -3.983795e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9402e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.1984
    reference variance = 0.333106
====================================================
  Execution time = 1.3902e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9138e-01
  Total weights = 1.956989010e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5107e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279401142106
                                         uncertainty =       0.002393705600

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279401142106
                                         uncertainty =       0.002393705600

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373775554
  error estimate for blocks of size 2^( 2) =       0.000387822739
  error estimate for blocks of size 2^( 3) =       0.000400354759
  error estimate for blocks of size 2^( 4) =       0.000408948084
  error estimate for blocks of size 2^( 5) =       0.000413999259
  error estimate for blocks of size 2^( 6) =       0.000416830030
  error estimate for blocks of size 2^( 7) =       0.000419488992

      target function =      -0.911731528092
              le_mean =     -17.211784280480
             les_mean =     296.536899434123
             stat err =       0.000414816591
             autocorr =       1.231658899021
   target nu stat err =       0.000414816591
   target dn stat err =       0.003306214745
      target stat err =       0.004300373902
              std dev =       0.528598457720
             le_variance =       0.279416329503


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721178428048e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-04, overlap shift 9.5367e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911751163333       residual = 3.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913058166194       residual = 3.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913256656628       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913339577505       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913351595776       residual = 6.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913356558218       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913359852592       residual = 4.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913359370804       residual = 9.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913359205991       residual = 3.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913359133513       residual = 9.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913359069722       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913359011683       residual = 6.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-04 is 3.907514e-03

solving harmonic davidson linear method for identity shift 3.8147e-03, overlap shift 3.8147e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911751163333       residual = 3.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913013629709       residual = 3.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913203955802       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913282615887       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913293850164       residual = 6.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913298463196       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913301492057       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913301030174       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913300877063       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913300811677       residual = 8.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913300752337       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913300699563       residual = 5.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-03 is 3.754283e-03

solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911751163333       residual = 3.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912862163861       residual = 3.57e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913025514587       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913090605357       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913099444399       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913103015379       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913105270140       residual = 3.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913104877534       residual = 6.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913104759926       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913104714509       residual = 6.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913104668605       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913104630719       residual = 3.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-02 is 3.245140e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.484180 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6431e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
ci_001                -4.235678e-02 3 1  ON 0
ci_002                -3.371789e-02 3 1  ON 1
ci_003                -2.521227e-02 3 1  ON 2
ci_004                 2.438932e-02 3 1  ON 3
ci_005                 2.523558e-02 3 1  ON 4
ci_006                -2.118543e-02 3 1  ON 5
ci_007                -2.127420e-02 3 1  ON 6
ci_008                -8.346232e-03 3 1  ON 7
ci_009                -1.482764e-02 3 1  ON 8
ci_010                -9.086167e-03 3 1  ON 9
ci_011                -1.023896e-02 3 1  ON 10
ci_012                -1.032779e-02 3 1  ON 11
ci_013                -1.958190e-02 3 1  ON 12
ci_014                 1.373279e-02 3 1  ON 13
ci_015                 1.263857e-02 3 1  ON 14
ci_016                 1.704069e-02 3 1  ON 15
ci_017                 1.536775e-02 3 1  ON 16
ci_018                 1.083034e-02 3 1  ON 17
ci_019                 9.037657e-03 3 1  ON 18
ci_020                 1.796220e-02 3 1  ON 19
ci_021                 1.720790e-02 3 1  ON 20
ci_022                 1.032632e-02 3 1  ON 21
ci_023                 1.013045e-02 3 1  ON 22
ci_024                 8.542655e-03 3 1  ON 23
ci_025                 8.687306e-03 3 1  ON 24
ci_026                 1.198518e-02 3 1  ON 25
ci_027                 9.743057e-03 3 1  ON 26
ci_028                -1.788152e-02 3 1  ON 27
ci_029                -1.588507e-02 3 1  ON 28
ci_030                -1.069847e-02 3 1  ON 29
ci_031                -9.259175e-03 3 1  ON 30
ci_032                -1.423597e-02 3 1  ON 31
ci_033                 5.010070e-03 3 1  ON 32
ci_034                 5.186566e-03 3 1  ON 33
ci_035                -5.499021e-03 3 1  ON 34
ci_036                -1.372143e-02 3 1  ON 35
ci_037                -1.246625e-02 3 1  ON 36
ci_038                 2.067408e-03 3 1  ON 37
ci_039                 3.078579e-03 3 1  ON 38
ci_040                -3.110559e-03 3 1  ON 39
ci_041                 6.723016e-03 3 1  ON 40
ci_042                 9.353649e-03 3 1  ON 41
ci_043                -4.267146e-03 3 1  ON 42
ci_044                -4.220452e-03 3 1  ON 43
ci_045                -2.932507e-03 3 1  ON 44
ci_046                 5.813379e-03 3 1  ON 45
ci_047                 5.856388e-03 3 1  ON 46
ci_048                -1.253031e-02 3 1  ON 47
ci_049                -1.436726e-02 3 1  ON 48
ci_050                 3.070449e-03 3 1  ON 49
ci_051                 2.888465e-03 3 1  ON 50
ci_052                -1.417726e-03 3 1  ON 51
ci_053                -2.436328e-03 3 1  ON 52
ci_054                -3.026516e-03 3 1  ON 53
ci_055                -2.506779e-03 3 1  ON 54
ci_056                 5.621530e-03 3 1  ON 55
ci_057                 6.631551e-03 3 1  ON 56
ci_058                -2.382952e-03 3 1  ON 57
ci_059                -2.403553e-03 3 1  ON 58
ci_060                 5.559323e-03 3 1  ON 59
ci_061                 6.143846e-03 3 1  ON 60
ci_062                -4.086874e-03 3 1  ON 61
ci_063                -3.739647e-03 3 1  ON 62
ci_064                -2.647848e-03 3 1  ON 63
ci_065                -3.790936e-03 3 1  ON 64
ci_066                 4.497299e-03 3 1  ON 65
ci_067                 3.927199e-03 3 1  ON 66
ci_068                -3.768020e-03 3 1  ON 67
ci_069                -5.218357e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.2665
    reference variance = 0.24093
====================================================
  Execution time = 1.3542e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.9676e-01
  Total weights = 1.9567e+06
  Execution time = 1.8627e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281486676224
                                         uncertainty =       0.001953424796

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281486676224
                                         uncertainty =       0.001953424796

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375145711
  error estimate for blocks of size 2^( 2) =       0.000388879352
  error estimate for blocks of size 2^( 3) =       0.000401411330
  error estimate for blocks of size 2^( 4) =       0.000409970088
  error estimate for blocks of size 2^( 5) =       0.000415059126
  error estimate for blocks of size 2^( 6) =       0.000418177411
  error estimate for blocks of size 2^( 7) =       0.000420139144

      target function =      -0.778581895784
              le_mean =     -17.212716249609
             les_mean =     296.683506216116
             stat err =       0.000415836442
             autocorr =       1.228697917629
   target nu stat err =       0.000415836442
   target dn stat err =       0.073093946663
      target stat err =       0.069328894665
              std dev =       0.530536152000
             le_variance =       0.281468608579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280857689981
                                         uncertainty =       0.001923811486

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280857689981
                                         uncertainty =       0.001923811486

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374728356
  error estimate for blocks of size 2^( 2) =       0.000388520391
  error estimate for blocks of size 2^( 3) =       0.000401074937
  error estimate for blocks of size 2^( 4) =       0.000409684660
  error estimate for blocks of size 2^( 5) =       0.000414835650
  error estimate for blocks of size 2^( 6) =       0.000417862122
  error estimate for blocks of size 2^( 7) =       0.000419807974

      target function =      -0.896041763432
              le_mean =     -17.212502572208
             les_mean =     296.574087220351
             stat err =       0.000415547602
             autocorr =       1.229726249215
   target nu stat err =       0.000415547602
   target dn stat err =       0.007037503452
      target stat err =       0.008788189373
              std dev =       0.529945923883
             le_variance =       0.280842682240

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.395818115354
                                         uncertainty =       0.111643851160

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.395818115354
                                         uncertainty =       0.111643851160

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000444937898
  error estimate for blocks of size 2^( 2) =       0.000456777910
  error estimate for blocks of size 2^( 3) =       0.000467425131
  error estimate for blocks of size 2^( 4) =       0.000475114779
  error estimate for blocks of size 2^( 5) =       0.000479380103
  error estimate for blocks of size 2^( 6) =       0.000482295417
  error estimate for blocks of size 2^( 7) =       0.000484550388

      target function =      -0.225081918153
              le_mean =     -17.212385432667
             les_mean =     297.878693320243
             stat err =       0.000480335172
             autocorr =       1.165440156514
   target nu stat err =       0.000480335172
   target dn stat err =       1.302687377971
      target stat err =       0.144589639338
              std dev =       0.629237210264
             le_variance =       0.395939466781

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280699627821
                                         uncertainty =       0.001922021660

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280699627821
                                         uncertainty =       0.001922021660

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374622694
  error estimate for blocks of size 2^( 2) =       0.000388410007
  error estimate for blocks of size 2^( 3) =       0.000400965484
  error estimate for blocks of size 2^( 4) =       0.000409569708
  error estimate for blocks of size 2^( 5) =       0.000414711492
  error estimate for blocks of size 2^( 6) =       0.000417749165
  error estimate for blocks of size 2^( 7) =       0.000419710315

      target function =      -0.899853210367
              le_mean =     -17.212511283842
             les_mean =     296.571365298035
             stat err =       0.000415435170
             autocorr =       1.229754318155
   target nu stat err =       0.000415435170
   target dn stat err =       0.005743527002
      target stat err =       0.007240959062
              std dev =       0.529796494217
             le_variance =       0.280684325285


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.778581895784        initial
     9.5367e-04     9.5367e-03             3.9075e-03        -0.896041763432
     3.8147e-03     3.8147e-02             3.7543e-03        -0.225081918153
     1.5259e-02     1.5259e-01             3.2451e-03        -0.899853210367  <--

*****************************************************************************
Applying the update for shift_i =   1.5259e-02     and shift_s =   1.5259e-01
*****************************************************************************

  Execution time = 2.2928e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
ci_001                -4.238187e-02 3 1  ON 0
ci_002                -3.368152e-02 3 1  ON 1
ci_003                -2.542386e-02 3 1  ON 2
ci_004                 2.438609e-02 3 1  ON 3
ci_005                 2.502796e-02 3 1  ON 4
ci_006                -2.143965e-02 3 1  ON 5
ci_007                -2.126954e-02 3 1  ON 6
ci_008                -8.366025e-03 3 1  ON 7
ci_009                -1.486228e-02 3 1  ON 8
ci_010                -8.577024e-03 3 1  ON 9
ci_011                -1.028450e-02 3 1  ON 10
ci_012                -1.034139e-02 3 1  ON 11
ci_013                -1.949014e-02 3 1  ON 12
ci_014                 1.365078e-02 3 1  ON 13
ci_015                 1.265766e-02 3 1  ON 14
ci_016                 1.708356e-02 3 1  ON 15
ci_017                 1.558336e-02 3 1  ON 16
ci_018                 1.085694e-02 3 1  ON 17
ci_019                 9.236648e-03 3 1  ON 18
ci_020                 1.792103e-02 3 1  ON 19
ci_021                 1.722509e-02 3 1  ON 20
ci_022                 1.021113e-02 3 1  ON 21
ci_023                 1.018885e-02 3 1  ON 22
ci_024                 8.537578e-03 3 1  ON 23
ci_025                 8.569826e-03 3 1  ON 24
ci_026                 1.194649e-02 3 1  ON 25
ci_027                 9.860113e-03 3 1  ON 26
ci_028                -1.752665e-02 3 1  ON 27
ci_029                -1.573899e-02 3 1  ON 28
ci_030                -1.046700e-02 3 1  ON 29
ci_031                -9.400682e-03 3 1  ON 30
ci_032                -1.434954e-02 3 1  ON 31
ci_033                 5.108019e-03 3 1  ON 32
ci_034                 5.023436e-03 3 1  ON 33
ci_035                -5.511984e-03 3 1  ON 34
ci_036                -1.369769e-02 3 1  ON 35
ci_037                -1.249419e-02 3 1  ON 36
ci_038                 2.021235e-03 3 1  ON 37
ci_039                 2.963188e-03 3 1  ON 38
ci_040                -3.095288e-03 3 1  ON 39
ci_041                 6.915786e-03 3 1  ON 40
ci_042                 9.254735e-03 3 1  ON 41
ci_043                -4.248325e-03 3 1  ON 42
ci_044                -4.381393e-03 3 1  ON 43
ci_045                -2.976272e-03 3 1  ON 44
ci_046                 5.808266e-03 3 1  ON 45
ci_047                 5.851092e-03 3 1  ON 46
ci_048                -1.262328e-02 3 1  ON 47
ci_049                -1.391588e-02 3 1  ON 48
ci_050                 3.109538e-03 3 1  ON 49
ci_051                 2.938664e-03 3 1  ON 50
ci_052                -1.471761e-03 3 1  ON 51
ci_053                -2.489074e-03 3 1  ON 52
ci_054                -2.974830e-03 3 1  ON 53
ci_055                -2.524388e-03 3 1  ON 54
ci_056                 5.592228e-03 3 1  ON 55
ci_057                 6.475764e-03 3 1  ON 56
ci_058                -2.429127e-03 3 1  ON 57
ci_059                -2.334309e-03 3 1  ON 58
ci_060                 5.656631e-03 3 1  ON 59
ci_061                 6.072092e-03 3 1  ON 60
ci_062                -4.096061e-03 3 1  ON 61
ci_063                -3.882005e-03 3 1  ON 62
ci_064                -2.703776e-03 3 1  ON 63
ci_065                -3.803627e-03 3 1  ON 64
ci_066                 4.543394e-03 3 1  ON 65
ci_067                 3.912937e-03 3 1  ON 66
ci_068                -4.042385e-03 3 1  ON 67
ci_069                -5.050869e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9374e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.1563
    reference variance = 0.266191
====================================================
  Execution time = 1.4004e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 3.0045e-01
  Total weights = 1.956963894e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5013e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282289890150
                                         uncertainty =       0.003237305983

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282289890150
                                         uncertainty =       0.003237305983

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376109727
  error estimate for blocks of size 2^( 2) =       0.000390132932
  error estimate for blocks of size 2^( 3) =       0.000402381866
  error estimate for blocks of size 2^( 4) =       0.000411034276
  error estimate for blocks of size 2^( 5) =       0.000415362189
  error estimate for blocks of size 2^( 6) =       0.000417241673
  error estimate for blocks of size 2^( 7) =       0.000419106756

      target function =      -0.900127798296
              le_mean =     -17.211713336546
             les_mean =     296.543529628707
             stat err =       0.000415686223
             autocorr =       1.221524358186
   target nu stat err =       0.000415686223
   target dn stat err =       0.006058898629
      target stat err =       0.007631354239
              std dev =       0.531899477233
             le_variance =       0.282917053880


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721171333655e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e-03, overlap shift 3.8147e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900192749463       residual = 5.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902513127799       residual = 2.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902673388931       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902730204283       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902751635609       residual = 6.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902757558140       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902756206922       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902756265585       residual = 8.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902756169313       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902756257179       residual = 5.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.902756251436       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.902756224484       residual = 3.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-03 is 3.734104e-03

solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900192749463       residual = 5.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902228160472       residual = 2.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.902364381468       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.902411449530       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.902428463222       residual = 5.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.902433148530       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.902431990867       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.902431994311       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.902431913007       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.902431976763       residual = 4.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.902431973968       residual = 9.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-02 is 3.203104e-03

solving harmonic davidson linear method for identity shift 6.1035e-02, overlap shift 6.1035e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.900192749463       residual = 5.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.901557198666       residual = 2.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.901641943913       residual = 8.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.901669557364       residual = 2.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.901678591621       residual = 4.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.901681087518       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.901680370098       residual = 1.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.901680325568       residual = 3.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.901680277725       residual = 9.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.901680305369       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.901680305929       residual = 4.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e-02 is 2.042394e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.493429 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6523e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
ci_001                -4.134325e-02 3 1  ON 0
ci_002                -3.330697e-02 3 1  ON 1
ci_003                -2.557845e-02 3 1  ON 2
ci_004                 2.281248e-02 3 1  ON 3
ci_005                 2.405230e-02 3 1  ON 4
ci_006                -2.151570e-02 3 1  ON 5
ci_007                -2.079535e-02 3 1  ON 6
ci_008                -9.311658e-03 3 1  ON 7
ci_009                -1.380392e-02 3 1  ON 8
ci_010                -8.463632e-03 3 1  ON 9
ci_011                -8.973403e-03 3 1  ON 10
ci_012                -8.074756e-03 3 1  ON 11
ci_013                -2.031763e-02 3 1  ON 12
ci_014                 1.142414e-02 3 1  ON 13
ci_015                 1.136429e-02 3 1  ON 14
ci_016                 1.675100e-02 3 1  ON 15
ci_017                 1.651006e-02 3 1  ON 16
ci_018                 1.165607e-02 3 1  ON 17
ci_019                 1.036870e-02 3 1  ON 18
ci_020                 1.807467e-02 3 1  ON 19
ci_021                 1.888510e-02 3 1  ON 20
ci_022                 1.048036e-02 3 1  ON 21
ci_023                 9.908597e-03 3 1  ON 22
ci_024                 9.698219e-03 3 1  ON 23
ci_025                 1.177293e-02 3 1  ON 24
ci_026                 1.188928e-02 3 1  ON 25
ci_027                 1.259664e-02 3 1  ON 26
ci_028                -1.573471e-02 3 1  ON 27
ci_029                -1.703351e-02 3 1  ON 28
ci_030                -8.544877e-03 3 1  ON 29
ci_031                -7.745494e-03 3 1  ON 30
ci_032                -1.504327e-02 3 1  ON 31
ci_033                 3.166671e-03 3 1  ON 32
ci_034                 5.193476e-03 3 1  ON 33
ci_035                -5.691640e-03 3 1  ON 34
ci_036                -1.388203e-02 3 1  ON 35
ci_037                -1.305685e-02 3 1  ON 36
ci_038                 2.243218e-03 3 1  ON 37
ci_039                 1.995272e-03 3 1  ON 38
ci_040                -2.865357e-03 3 1  ON 39
ci_041                 8.944227e-03 3 1  ON 40
ci_042                 8.946301e-03 3 1  ON 41
ci_043                -4.319411e-03 3 1  ON 42
ci_044                -4.293126e-03 3 1  ON 43
ci_045                -3.177258e-03 3 1  ON 44
ci_046                 5.205107e-03 3 1  ON 45
ci_047                 5.804536e-03 3 1  ON 46
ci_048                -1.362948e-02 3 1  ON 47
ci_049                -1.361586e-02 3 1  ON 48
ci_050                 3.394633e-03 3 1  ON 49
ci_051                 3.234299e-03 3 1  ON 50
ci_052                -1.926047e-03 3 1  ON 51
ci_053                -2.604006e-03 3 1  ON 52
ci_054                -3.415007e-03 3 1  ON 53
ci_055                -2.380547e-03 3 1  ON 54
ci_056                 5.170142e-03 3 1  ON 55
ci_057                 7.106138e-03 3 1  ON 56
ci_058                 5.410722e-04 3 1  ON 57
ci_059                -1.654351e-03 3 1  ON 58
ci_060                 6.102926e-03 3 1  ON 59
ci_061                 5.900818e-03 3 1  ON 60
ci_062                -3.188872e-03 3 1  ON 61
ci_063                -3.057558e-03 3 1  ON 62
ci_064                -3.293057e-03 3 1  ON 63
ci_065                -4.175061e-03 3 1  ON 64
ci_066                 3.786372e-03 3 1  ON 65
ci_067                 4.659145e-03 3 1  ON 66
ci_068                -5.112243e-03 3 1  ON 67
ci_069                -4.801301e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.1889
    reference variance = 0.181476
====================================================
  Execution time = 1.3554e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8629e-01
  Total weights = 1.9570e+06
  Execution time = 1.8592e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000856548
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276311962902
                                         uncertainty =       0.001611747202

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276311962902
                                         uncertainty =       0.001611747202

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371639284
  error estimate for blocks of size 2^( 2) =       0.000385536074
  error estimate for blocks of size 2^( 3) =       0.000397981812
  error estimate for blocks of size 2^( 4) =       0.000406428824
  error estimate for blocks of size 2^( 5) =       0.000410467168
  error estimate for blocks of size 2^( 6) =       0.000412914334
  error estimate for blocks of size 2^( 7) =       0.000413582511

      target function =      -0.881528994227
              le_mean =     -17.211611191879
             les_mean =     296.554657377316
             stat err =       0.000410848209
             autocorr =       1.222136082441
   target nu stat err =       0.000410848209
   target dn stat err =       0.019408276487
      target stat err =       0.023395507792
              std dev =       0.525577316275
             le_variance =       0.276231515383

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275585321399
                                         uncertainty =       0.001473200596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275585321399
                                         uncertainty =       0.001473200596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371151428
  error estimate for blocks of size 2^( 2) =       0.000385174143
  error estimate for blocks of size 2^( 3) =       0.000397732572
  error estimate for blocks of size 2^( 4) =       0.000406163641
  error estimate for blocks of size 2^( 5) =       0.000410295498
  error estimate for blocks of size 2^( 6) =       0.000412776362
  error estimate for blocks of size 2^( 7) =       0.000413616895

      target function =      -0.915630224612
              le_mean =     -17.211368708674
             les_mean =     296.519506293547
             stat err =       0.000410713099
             autocorr =       1.224545243077
   target nu stat err =       0.000410713099
   target dn stat err =       0.002390470368
      target stat err =       0.003158793045
              std dev =       0.524887383673
             le_variance =       0.275506765539

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000849719
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289979335526
                                         uncertainty =       0.008073683407

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289979335526
                                         uncertainty =       0.008073683407

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380711160
  error estimate for blocks of size 2^( 2) =       0.000394469749
  error estimate for blocks of size 2^( 3) =       0.000406651113
  error estimate for blocks of size 2^( 4) =       0.000414956967
  error estimate for blocks of size 2^( 5) =       0.000418912299
  error estimate for blocks of size 2^( 6) =       0.000421186873
  error estimate for blocks of size 2^( 7) =       0.000421890236

      target function =      -0.574057352660
              le_mean =     -17.211411191266
             les_mean =     296.886078211259
             stat err =       0.000419236594
             autocorr =       1.212626769546
   target nu stat err =       0.000419236594
   target dn stat err =       0.241377978020
      target stat err =       0.129492292335
              std dev =       0.538406886475
             le_variance =       0.289881975404

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0402984
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275007892846
                                         uncertainty =       0.001455158062

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275007892846
                                         uncertainty =       0.001455158062

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370762567
  error estimate for blocks of size 2^( 2) =       0.000384754709
  error estimate for blocks of size 2^( 3) =       0.000397282248
  error estimate for blocks of size 2^( 4) =       0.000405710274
  error estimate for blocks of size 2^( 5) =       0.000409814764
  error estimate for blocks of size 2^( 6) =       0.000412281868
  error estimate for blocks of size 2^( 7) =       0.000413092340

      target function =      -0.910470078394
              le_mean =     -17.211409571713
             les_mean =     296.524905032739
             stat err =       0.000410224811
             autocorr =       1.224199188622
   target nu stat err =       0.000410224811
   target dn stat err =       0.003728012375
      target stat err =       0.004822534854
              std dev =       0.524337450624
             le_variance =       0.274929762127


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.881528994227        initial
     3.8147e-03     3.8147e-02             3.7341e-03        -0.915630224612  <--
     1.5259e-02     1.5259e-01             3.2031e-03        -0.574057352660
     6.1035e-02     6.1035e-01             2.0424e-03        -0.910470078394

*****************************************************************************
Applying the update for shift_i =   3.8147e-03     and shift_s =   3.8147e-02
*****************************************************************************

  Execution time = 2.2929e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
ci_001                -4.115413e-02 3 1  ON 0
ci_002                -3.323465e-02 3 1  ON 1
ci_003                -2.562660e-02 3 1  ON 2
ci_004                 2.252070e-02 3 1  ON 3
ci_005                 2.393612e-02 3 1  ON 4
ci_006                -2.153056e-02 3 1  ON 5
ci_007                -2.070932e-02 3 1  ON 6
ci_008                -9.442943e-03 3 1  ON 7
ci_009                -1.364959e-02 3 1  ON 8
ci_010                -8.442797e-03 3 1  ON 9
ci_011                -8.779575e-03 3 1  ON 10
ci_012                -7.739831e-03 3 1  ON 11
ci_013                -2.047924e-02 3 1  ON 12
ci_014                 1.106222e-02 3 1  ON 13
ci_015                 1.119742e-02 3 1  ON 14
ci_016                 1.669385e-02 3 1  ON 15
ci_017                 1.668565e-02 3 1  ON 16
ci_018                 1.179549e-02 3 1  ON 17
ci_019                 1.053593e-02 3 1  ON 18
ci_020                 1.811645e-02 3 1  ON 19
ci_021                 1.918851e-02 3 1  ON 20
ci_022                 1.052417e-02 3 1  ON 21
ci_023                 9.852426e-03 3 1  ON 22
ci_024                 9.890720e-03 3 1  ON 23
ci_025                 1.230393e-02 3 1  ON 24
ci_026                 1.185259e-02 3 1  ON 25
ci_027                 1.298430e-02 3 1  ON 26
ci_028                -1.544473e-02 3 1  ON 27
ci_029                -1.725436e-02 3 1  ON 28
ci_030                -8.277691e-03 3 1  ON 29
ci_031                -7.501267e-03 3 1  ON 30
ci_032                -1.515505e-02 3 1  ON 31
ci_033                 2.865568e-03 3 1  ON 32
ci_034                 5.218260e-03 3 1  ON 33
ci_035                -5.717621e-03 3 1  ON 34
ci_036                -1.391215e-02 3 1  ON 35
ci_037                -1.314739e-02 3 1  ON 36
ci_038                 2.275434e-03 3 1  ON 37
ci_039                 1.861323e-03 3 1  ON 38
ci_040                -2.834569e-03 3 1  ON 39
ci_041                 9.209294e-03 3 1  ON 40
ci_042                 8.919548e-03 3 1  ON 41
ci_043                -4.328756e-03 3 1  ON 42
ci_044                -4.280061e-03 3 1  ON 43
ci_045                -3.205805e-03 3 1  ON 44
ci_046                 5.108419e-03 3 1  ON 45
ci_047                 5.798458e-03 3 1  ON 46
ci_048                -1.378413e-02 3 1  ON 47
ci_049                -1.353302e-02 3 1  ON 48
ci_050                 3.434305e-03 3 1  ON 49
ci_051                 3.273108e-03 3 1  ON 50
ci_052                -1.992755e-03 3 1  ON 51
ci_053                -2.617545e-03 3 1  ON 52
ci_054                -3.473351e-03 3 1  ON 53
ci_055                -2.338997e-03 3 1  ON 54
ci_056                 5.108603e-03 3 1  ON 55
ci_057                 7.196721e-03 3 1  ON 56
ci_058                 9.479872e-04 3 1  ON 57
ci_059                -1.580204e-03 3 1  ON 58
ci_060                 6.175144e-03 3 1  ON 59
ci_061                 5.868895e-03 3 1  ON 60
ci_062                -3.056629e-03 3 1  ON 61
ci_063                -2.958825e-03 3 1  ON 62
ci_064                -3.375659e-03 3 1  ON 63
ci_065                -4.228393e-03 3 1  ON 64
ci_066                 3.687017e-03 3 1  ON 65
ci_067                 4.769703e-03 3 1  ON 66
ci_068                -5.283853e-03 3 1  ON 67
ci_069                -4.765277e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9467e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.1679
    reference variance = 0.254813
====================================================
  Execution time = 1.3975e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9030e-01
  Total weights = 1.957115418e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4896e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279878772322
                                         uncertainty =       0.002400923105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279878772322
                                         uncertainty =       0.002400923105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374079267
  error estimate for blocks of size 2^( 2) =       0.000388217735
  error estimate for blocks of size 2^( 3) =       0.000400493010
  error estimate for blocks of size 2^( 4) =       0.000410253873
  error estimate for blocks of size 2^( 5) =       0.000415384837
  error estimate for blocks of size 2^( 6) =       0.000417674256
  error estimate for blocks of size 2^( 7) =       0.000421381331

      target function =      -0.913088847736
              le_mean =     -17.211606307528
             les_mean =     296.529690543561
             stat err =       0.000416173574
             autocorr =       1.237718049614
   target nu stat err =       0.000416173574
   target dn stat err =       0.002832673036
      target stat err =       0.003706961605
              std dev =       0.529027972617
             le_variance =       0.279870595811


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721160630753e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-04, overlap shift 9.5367e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913103220656       residual = 3.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914574472313       residual = 3.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914777858362       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914846321642       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914855948807       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914860519965       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914861268998       residual = 4.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914861294916       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914861470381       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914861367064       residual = 8.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914861279743       residual = 2.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914861221986       residual = 5.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-04 is 3.432776e-03

solving harmonic davidson linear method for identity shift 3.8147e-03, overlap shift 3.8147e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913103220656       residual = 3.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914522885542       residual = 3.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914717721849       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914782618177       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914791603799       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914795875810       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914796562466       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914796572781       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914796732705       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914796636634       residual = 8.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914796556528       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914796503833       residual = 5.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-03 is 3.313257e-03

solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913103220656       residual = 3.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914348222386       residual = 3.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914514915184       residual = 9.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914568482215       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914575519915       residual = 4.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914578885751       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914579390335       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914579362868       residual = 8.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914579478674       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914579404667       residual = 5.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914579345474       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914579307216       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-02 is 2.908126e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.503325 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6486e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
ci_001                -4.222040e-02 3 1  ON 0
ci_002                -3.409734e-02 3 1  ON 1
ci_003                -2.638496e-02 3 1  ON 2
ci_004                 2.354748e-02 3 1  ON 3
ci_005                 2.458681e-02 3 1  ON 4
ci_006                -2.118060e-02 3 1  ON 5
ci_007                -2.080693e-02 3 1  ON 6
ci_008                -8.534454e-03 3 1  ON 7
ci_009                -1.484943e-02 3 1  ON 8
ci_010                -9.033911e-03 3 1  ON 9
ci_011                -1.020716e-02 3 1  ON 10
ci_012                -1.078760e-02 3 1  ON 11
ci_013                -1.964945e-02 3 1  ON 12
ci_014                 1.274282e-02 3 1  ON 13
ci_015                 1.286065e-02 3 1  ON 14
ci_016                 1.732233e-02 3 1  ON 15
ci_017                 1.619392e-02 3 1  ON 16
ci_018                 1.179373e-02 3 1  ON 17
ci_019                 1.150345e-02 3 1  ON 18
ci_020                 1.727495e-02 3 1  ON 19
ci_021                 1.807389e-02 3 1  ON 20
ci_022                 9.488486e-03 3 1  ON 21
ci_023                 9.999810e-03 3 1  ON 22
ci_024                 9.361213e-03 3 1  ON 23
ci_025                 9.573068e-03 3 1  ON 24
ci_026                 1.204248e-02 3 1  ON 25
ci_027                 1.224133e-02 3 1  ON 26
ci_028                -1.565522e-02 3 1  ON 27
ci_029                -1.571346e-02 3 1  ON 28
ci_030                -9.191668e-03 3 1  ON 29
ci_031                -8.782932e-03 3 1  ON 30
ci_032                -1.428601e-02 3 1  ON 31
ci_033                 5.382840e-03 3 1  ON 32
ci_034                 4.903508e-03 3 1  ON 33
ci_035                -5.621203e-03 3 1  ON 34
ci_036                -1.327326e-02 3 1  ON 35
ci_037                -1.311804e-02 3 1  ON 36
ci_038                 1.626547e-03 3 1  ON 37
ci_039                 1.747071e-03 3 1  ON 38
ci_040                -2.675705e-03 3 1  ON 39
ci_041                 8.974943e-03 3 1  ON 40
ci_042                 8.757407e-03 3 1  ON 41
ci_043                -4.226010e-03 3 1  ON 42
ci_044                -2.761343e-03 3 1  ON 43
ci_045                -3.972703e-03 3 1  ON 44
ci_046                 5.219442e-03 3 1  ON 45
ci_047                 5.628610e-03 3 1  ON 46
ci_048                -1.311940e-02 3 1  ON 47
ci_049                -1.280691e-02 3 1  ON 48
ci_050                 3.331758e-03 3 1  ON 49
ci_051                 2.080401e-03 3 1  ON 50
ci_052                -3.836648e-03 3 1  ON 51
ci_053                -3.828881e-03 3 1  ON 52
ci_054                -2.629450e-03 3 1  ON 53
ci_055                -3.478840e-03 3 1  ON 54
ci_056                 5.794207e-03 3 1  ON 55
ci_057                 5.537841e-03 3 1  ON 56
ci_058                -2.365270e-03 3 1  ON 57
ci_059                -1.617434e-03 3 1  ON 58
ci_060                 4.415133e-03 3 1  ON 59
ci_061                 5.145191e-03 3 1  ON 60
ci_062                -4.171172e-03 3 1  ON 61
ci_063                -3.536430e-03 3 1  ON 62
ci_064                -3.042407e-03 3 1  ON 63
ci_065                -3.645549e-03 3 1  ON 64
ci_066                 4.461478e-03 3 1  ON 65
ci_067                 4.675574e-03 3 1  ON 66
ci_068                -5.501711e-03 3 1  ON 67
ci_069                -4.319801e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.169
    reference variance = 0.177802
====================================================
  Execution time = 1.5764e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8646e-01
  Total weights = 1.9572e+06
  Execution time = 1.8521e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279869277934
                                         uncertainty =       0.004029473206

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279869277934
                                         uncertainty =       0.004029473206

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374086504
  error estimate for blocks of size 2^( 2) =       0.000388108725
  error estimate for blocks of size 2^( 3) =       0.000401236018
  error estimate for blocks of size 2^( 4) =       0.000410849007
  error estimate for blocks of size 2^( 5) =       0.000416084578
  error estimate for blocks of size 2^( 6) =       0.000418830669
  error estimate for blocks of size 2^( 7) =       0.000419824915

      target function =      -0.692000210887
              le_mean =     -17.211939556361
             les_mean =     296.742598326275
             stat err =       0.000416397292
             autocorr =       1.239001161638
   target nu stat err =       0.000416397292
   target dn stat err =       0.148604915397
      target stat err =       0.113290217757
              std dev =       0.529038207015
             le_variance =       0.279881424481

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273911800211
                                         uncertainty =       0.001505163374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273911800211
                                         uncertainty =       0.001505163374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370089205
  error estimate for blocks of size 2^( 2) =       0.000383992948
  error estimate for blocks of size 2^( 3) =       0.000397139807
  error estimate for blocks of size 2^( 4) =       0.000406592404
  error estimate for blocks of size 2^( 5) =       0.000411800260
  error estimate for blocks of size 2^( 6) =       0.000414395509
  error estimate for blocks of size 2^( 7) =       0.000415483509

      target function =      -0.918031667381
              le_mean =     -17.211688629436
             les_mean =     296.528736599609
             stat err =       0.000412067921
             autocorr =       1.239723340974
   target nu stat err =       0.000412067921
   target dn stat err =       0.002733925536
      target stat err =       0.003618911710
              std dev =       0.523385172574
             le_variance =       0.273932038871

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276798534038
                                         uncertainty =       0.001625982213

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276798534038
                                         uncertainty =       0.001625982213

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372029166
  error estimate for blocks of size 2^( 2) =       0.000385745116
  error estimate for blocks of size 2^( 3) =       0.000398731663
  error estimate for blocks of size 2^( 4) =       0.000408040158
  error estimate for blocks of size 2^( 5) =       0.000413098039
  error estimate for blocks of size 2^( 6) =       0.000415672227
  error estimate for blocks of size 2^( 7) =       0.000416928315

      target function =      -0.872846326165
              le_mean =     -17.211881014082
             les_mean =     296.571117634573
             stat err =       0.000413434684
             autocorr =       1.234979757504
   target nu stat err =       0.000413434684
   target dn stat err =       0.022140288666
      target stat err =       0.026180116967
              std dev =       0.526128692212
             le_variance =       0.276811400769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273802427993
                                         uncertainty =       0.001498539561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273802427993
                                         uncertainty =       0.001498539561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370016090
  error estimate for blocks of size 2^( 2) =       0.000383953948
  error estimate for blocks of size 2^( 3) =       0.000397126894
  error estimate for blocks of size 2^( 4) =       0.000406602698
  error estimate for blocks of size 2^( 5) =       0.000411826072
  error estimate for blocks of size 2^( 6) =       0.000414424946
  error estimate for blocks of size 2^( 7) =       0.000415492216

      target function =      -0.916465321750
              le_mean =     -17.211696077278
             les_mean =     296.530195110825
             stat err =       0.000412086483
             autocorr =       1.240325059897
   target nu stat err =       0.000412086483
   target dn stat err =       0.002809557661
      target stat err =       0.003703969351
              std dev =       0.523281773056
             le_variance =       0.273823814013


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.692000210887        initial
     9.5367e-04     9.5367e-03             3.4328e-03        -0.918031667381  <--
     3.8147e-03     3.8147e-02             3.3133e-03        -0.872846326165
     1.5259e-02     1.5259e-01             2.9081e-03        -0.916465321750

*****************************************************************************
Applying the update for shift_i =   9.5367e-04     and shift_s =   9.5367e-03
*****************************************************************************

  Execution time = 2.5090e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
ci_001                -4.227321e-02 3 1  ON 0
ci_002                -3.413799e-02 3 1  ON 1
ci_003                -2.641656e-02 3 1  ON 2
ci_004                 2.359955e-02 3 1  ON 3
ci_005                 2.461165e-02 3 1  ON 4
ci_006                -2.116327e-02 3 1  ON 5
ci_007                -2.080986e-02 3 1  ON 6
ci_008                -8.503619e-03 3 1  ON 7
ci_009                -1.489732e-02 3 1  ON 8
ci_010                -9.056219e-03 3 1  ON 9
ci_011                -1.026434e-02 3 1  ON 10
ci_012                -1.090816e-02 3 1  ON 11
ci_013                -1.960750e-02 3 1  ON 12
ci_014                 1.281439e-02 3 1  ON 13
ci_015                 1.292039e-02 3 1  ON 14
ci_016                 1.735016e-02 3 1  ON 15
ci_017                 1.617022e-02 3 1  ON 16
ci_018                 1.179016e-02 3 1  ON 17
ci_019                 1.153616e-02 3 1  ON 18
ci_020                 1.724155e-02 3 1  ON 19
ci_021                 1.802355e-02 3 1  ON 20
ci_022                 9.440968e-03 3 1  ON 21
ci_023                 1.000137e-02 3 1  ON 22
ci_024                 9.340452e-03 3 1  ON 23
ci_025                 9.455511e-03 3 1  ON 24
ci_026                 1.205453e-02 3 1  ON 25
ci_027                 1.221515e-02 3 1  ON 26
ci_028                -1.566488e-02 3 1  ON 27
ci_029                -1.564252e-02 3 1  ON 28
ci_030                -9.225120e-03 3 1  ON 29
ci_031                -8.826460e-03 3 1  ON 30
ci_032                -1.424962e-02 3 1  ON 31
ci_033                 5.487132e-03 3 1  ON 32
ci_034                 4.890618e-03 3 1  ON 33
ci_035                -5.617527e-03 3 1  ON 34
ci_036                -1.325185e-02 3 1  ON 35
ci_037                -1.311866e-02 3 1  ON 36
ci_038                 1.602589e-03 3 1  ON 37
ci_039                 1.742743e-03 3 1  ON 38
ci_040                -2.669733e-03 3 1  ON 39
ci_041                 8.967319e-03 3 1  ON 40
ci_042                 8.745252e-03 3 1  ON 41
ci_043                -4.222132e-03 3 1  ON 42
ci_044                -2.700131e-03 3 1  ON 43
ci_045                -4.000787e-03 3 1  ON 44
ci_046                 5.223683e-03 3 1  ON 45
ci_047                 5.621398e-03 3 1  ON 46
ci_048                -1.308749e-02 3 1  ON 47
ci_049                -1.277813e-02 3 1  ON 48
ci_050                 3.328616e-03 3 1  ON 49
ci_051                 2.039245e-03 3 1  ON 50
ci_052                -3.904464e-03 3 1  ON 51
ci_053                -3.876480e-03 3 1  ON 52
ci_054                -2.598919e-03 3 1  ON 53
ci_055                -3.526653e-03 3 1  ON 54
ci_056                 5.820342e-03 3 1  ON 55
ci_057                 5.473959e-03 3 1  ON 56
ci_058                -2.484789e-03 3 1  ON 57
ci_059                -1.614010e-03 3 1  ON 58
ci_060                 4.343090e-03 3 1  ON 59
ci_061                 5.115860e-03 3 1  ON 60
ci_062                -4.214418e-03 3 1  ON 61
ci_063                -3.553754e-03 3 1  ON 62
ci_064                -3.030770e-03 3 1  ON 63
ci_065                -3.624355e-03 3 1  ON 64
ci_066                 4.488356e-03 3 1  ON 65
ci_067                 4.672947e-03 3 1  ON 66
ci_068                -5.510661e-03 3 1  ON 67
ci_069                -4.301038e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1586e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.2558
    reference variance = 0.375266
====================================================
  Execution time = 1.3967e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9062e-01
  Total weights = 1.956935027e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5097e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278014418175
                                         uncertainty =       0.002088108250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278014418175
                                         uncertainty =       0.002088108250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372829444
  error estimate for blocks of size 2^( 2) =       0.000386483915
  error estimate for blocks of size 2^( 3) =       0.000399203637
  error estimate for blocks of size 2^( 4) =       0.000407586542
  error estimate for blocks of size 2^( 5) =       0.000412390994
  error estimate for blocks of size 2^( 6) =       0.000414870564
  error estimate for blocks of size 2^( 7) =       0.000416111754

      target function =      -0.912755095642
              le_mean =     -17.211935150070
             les_mean =     296.541334037527
             stat err =       0.000412739963
             autocorr =       1.225554517150
   target nu stat err =       0.000412739963
   target dn stat err =       0.002705895764
      target stat err =       0.003543778571
              std dev =       0.527260456846
             le_variance =       0.278003589354


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721193515007e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-04, overlap shift 2.3842e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912768000875       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913411479590       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913518803086       residual = 6.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913564589542       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913569901769       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913572310248       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913571967592       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913571844601       residual = 8.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913571956538       residual = 2.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913572076069       residual = 4.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913572056710       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913572139212       residual = 4.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-04 is 2.488771e-03

solving harmonic davidson linear method for identity shift 9.5367e-04, overlap shift 9.5367e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912768000875       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913405801850       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913511959043       residual = 6.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913557104305       residual = 1.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913562318467       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913564676715       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913564337022       residual = 1.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913564214269       residual = 7.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913564325386       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913564441962       residual = 4.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913564422896       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913564503514       residual = 4.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-04 is 2.461397e-03

solving harmonic davidson linear method for identity shift 3.8147e-03, overlap shift 3.8147e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912768000875       residual = 1.74e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913384057975       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913485788755       residual = 6.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913528528874       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913533380430       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913535554018       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913535226558       residual = 1.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913535104788       residual = 7.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913535213135       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913535318692       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913535300793       residual = 1.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913535374541       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-03 is 2.357806e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.508127 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6486e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
ci_001                -4.200565e-02 3 1  ON 0
ci_002                -3.281667e-02 3 1  ON 1
ci_003                -2.549209e-02 3 1  ON 2
ci_004                 2.403699e-02 3 1  ON 3
ci_005                 2.461669e-02 3 1  ON 4
ci_006                -2.209990e-02 3 1  ON 5
ci_007                -2.189559e-02 3 1  ON 6
ci_008                -9.024117e-03 3 1  ON 7
ci_009                -1.504520e-02 3 1  ON 8
ci_010                -8.792078e-03 3 1  ON 9
ci_011                -1.029028e-02 3 1  ON 10
ci_012                -9.976141e-03 3 1  ON 11
ci_013                -2.068137e-02 3 1  ON 12
ci_014                 1.270260e-02 3 1  ON 13
ci_015                 1.218901e-02 3 1  ON 14
ci_016                 1.754188e-02 3 1  ON 15
ci_017                 1.714434e-02 3 1  ON 16
ci_018                 1.107114e-02 3 1  ON 17
ci_019                 1.105729e-02 3 1  ON 18
ci_020                 1.880062e-02 3 1  ON 19
ci_021                 1.719947e-02 3 1  ON 20
ci_022                 1.063954e-02 3 1  ON 21
ci_023                 9.812857e-03 3 1  ON 22
ci_024                 8.575860e-03 3 1  ON 23
ci_025                 9.959258e-03 3 1  ON 24
ci_026                 1.276052e-02 3 1  ON 25
ci_027                 1.180108e-02 3 1  ON 26
ci_028                -1.594361e-02 3 1  ON 27
ci_029                -1.611876e-02 3 1  ON 28
ci_030                -9.119843e-03 3 1  ON 29
ci_031                -7.661810e-03 3 1  ON 30
ci_032                -1.547949e-02 3 1  ON 31
ci_033                 5.044737e-03 3 1  ON 32
ci_034                 6.998755e-03 3 1  ON 33
ci_035                -5.390234e-03 3 1  ON 34
ci_036                -1.244823e-02 3 1  ON 35
ci_037                -1.305613e-02 3 1  ON 36
ci_038                 1.721653e-03 3 1  ON 37
ci_039                 2.210546e-03 3 1  ON 38
ci_040                -2.856109e-03 3 1  ON 39
ci_041                 8.849693e-03 3 1  ON 40
ci_042                 7.843504e-03 3 1  ON 41
ci_043                -4.017359e-03 3 1  ON 42
ci_044                -4.505687e-03 3 1  ON 43
ci_045                -3.429957e-03 3 1  ON 44
ci_046                 6.121745e-03 3 1  ON 45
ci_047                 5.386441e-03 3 1  ON 46
ci_048                -1.214409e-02 3 1  ON 47
ci_049                -1.523953e-02 3 1  ON 48
ci_050                 4.378213e-03 3 1  ON 49
ci_051                 3.419047e-03 3 1  ON 50
ci_052                -2.863097e-03 3 1  ON 51
ci_053                -3.601741e-03 3 1  ON 52
ci_054                -3.262613e-03 3 1  ON 53
ci_055                -3.305424e-03 3 1  ON 54
ci_056                 5.363885e-03 3 1  ON 55
ci_057                 5.430644e-03 3 1  ON 56
ci_058                -2.734829e-03 3 1  ON 57
ci_059                -3.190194e-03 3 1  ON 58
ci_060                 4.209124e-03 3 1  ON 59
ci_061                 5.343728e-03 3 1  ON 60
ci_062                -4.611919e-03 3 1  ON 61
ci_063                -3.992156e-03 3 1  ON 62
ci_064                -2.693373e-03 3 1  ON 63
ci_065                -3.875410e-03 3 1  ON 64
ci_066                 4.645078e-03 3 1  ON 65
ci_067                 5.196446e-03 3 1  ON 66
ci_068                -5.762452e-03 3 1  ON 67
ci_069                -4.899953e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.1949
    reference variance = 0.232477
====================================================
  Execution time = 1.3763e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.9224e-01
  Total weights = 1.9569e+06
  Execution time = 1.8573e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279196163597
                                         uncertainty =       0.002163834817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279196163597
                                         uncertainty =       0.002163834817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373597555
  error estimate for blocks of size 2^( 2) =       0.000387589715
  error estimate for blocks of size 2^( 3) =       0.000399694463
  error estimate for blocks of size 2^( 4) =       0.000409026115
  error estimate for blocks of size 2^( 5) =       0.000412921689
  error estimate for blocks of size 2^( 6) =       0.000417325383
  error estimate for blocks of size 2^( 7) =       0.000418137918

      target function =      -0.851555461819
              le_mean =     -17.212798228542
             les_mean =     296.620802608903
             stat err =       0.000414352776
             autocorr =       1.230077446227
   target nu stat err =       0.000414352776
   target dn stat err =       0.029312259233
      target stat err =       0.033054340376
              std dev =       0.528346728960
             le_variance =       0.279150266002

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277162890853
                                         uncertainty =       0.001565064284

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277162890853
                                         uncertainty =       0.001565064284

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372238461
  error estimate for blocks of size 2^( 2) =       0.000386211587
  error estimate for blocks of size 2^( 3) =       0.000398342666
  error estimate for blocks of size 2^( 4) =       0.000407734975
  error estimate for blocks of size 2^( 5) =       0.000411672848
  error estimate for blocks of size 2^( 6) =       0.000415972237
  error estimate for blocks of size 2^( 7) =       0.000416735410

      target function =      -0.910879619117
              le_mean =     -17.212685693623
             les_mean =     296.568760382497
             stat err =       0.000413028867
             autocorr =       1.231170849200
   target nu stat err =       0.000413028867
   target dn stat err =       0.003756412355
      target stat err =       0.004873194674
              std dev =       0.526424680509
             le_variance =       0.277122944249

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283465851777
                                         uncertainty =       0.004775109770

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283465851777
                                         uncertainty =       0.004775109770

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376444491
  error estimate for blocks of size 2^( 2) =       0.000390257770
  error estimate for blocks of size 2^( 3) =       0.000402214080
  error estimate for blocks of size 2^( 4) =       0.000411743377
  error estimate for blocks of size 2^( 5) =       0.000415680850
  error estimate for blocks of size 2^( 6) =       0.000419870459
  error estimate for blocks of size 2^( 7) =       0.000420595853

      target function =      -0.326824054620
              le_mean =     -17.212809707424
             les_mean =     297.403043771092
             stat err =       0.000416972635
             autocorr =       1.226911440528
   target nu stat err =       0.000416972635
   target dn stat err =       0.816776745024
      target stat err =       0.173667912476
              std dev =       0.532372904333
             le_variance =       0.283420909268

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277144382348
                                         uncertainty =       0.001563651280

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277144382348
                                         uncertainty =       0.001563651280

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372225989
  error estimate for blocks of size 2^( 2) =       0.000386201372
  error estimate for blocks of size 2^( 3) =       0.000398333436
  error estimate for blocks of size 2^( 4) =       0.000407724911
  error estimate for blocks of size 2^( 5) =       0.000411659501
  error estimate for blocks of size 2^( 6) =       0.000415960113
  error estimate for blocks of size 2^( 7) =       0.000416724979

      target function =      -0.910603552504
              le_mean =     -17.212687400813
             les_mean =     296.569033206143
             stat err =       0.000413017376
             autocorr =       1.231184842101
   target nu stat err =       0.000413017376
   target dn stat err =       0.003821311189
      target stat err =       0.004953221982
              std dev =       0.526407042409
             le_variance =       0.277104374297


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.851555461819        initial
     2.3842e-04     2.3842e-03             2.4888e-03        -0.910879619117  <--
     9.5367e-04     9.5367e-03             2.4614e-03        -0.326824054620
     3.8147e-03     3.8147e-02             2.3578e-03        -0.910603552504

*****************************************************************************
Applying the update for shift_i =   2.3842e-04     and shift_s =   2.3842e-03
*****************************************************************************

  Execution time = 2.3103e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
ci_001                -4.200164e-02 3 1  ON 0
ci_002                -3.280105e-02 3 1  ON 1
ci_003                -2.548075e-02 3 1  ON 2
ci_004                 2.404282e-02 3 1  ON 3
ci_005                 2.461616e-02 3 1  ON 4
ci_006                -2.211093e-02 3 1  ON 5
ci_007                -2.190859e-02 3 1  ON 6
ci_008                -9.028170e-03 3 1  ON 7
ci_009                -1.504663e-02 3 1  ON 8
ci_010                -8.789380e-03 3 1  ON 9
ci_011                -1.029040e-02 3 1  ON 10
ci_012                -9.966746e-03 3 1  ON 11
ci_013                -2.069523e-02 3 1  ON 12
ci_014                 1.269982e-02 3 1  ON 13
ci_015                 1.218064e-02 3 1  ON 14
ci_016                 1.754347e-02 3 1  ON 15
ci_017                 1.715576e-02 3 1  ON 16
ci_018                 1.106310e-02 3 1  ON 17
ci_019                 1.105427e-02 3 1  ON 18
ci_020                 1.881809e-02 3 1  ON 19
ci_021                 1.718908e-02 3 1  ON 20
ci_022                 1.065251e-02 3 1  ON 21
ci_023                 9.811848e-03 3 1  ON 22
ci_024                 8.568020e-03 3 1  ON 23
ci_025                 9.965068e-03 3 1  ON 24
ci_026                 1.276759e-02 3 1  ON 25
ci_027                 1.179719e-02 3 1  ON 26
ci_028                -1.594684e-02 3 1  ON 27
ci_029                -1.612293e-02 3 1  ON 28
ci_030                -9.117540e-03 3 1  ON 29
ci_031                -7.653644e-03 3 1  ON 30
ci_032                -1.549265e-02 3 1  ON 31
ci_033                 5.040127e-03 3 1  ON 32
ci_034                 7.021132e-03 3 1  ON 33
ci_035                -5.388053e-03 3 1  ON 34
ci_036                -1.243997e-02 3 1  ON 35
ci_037                -1.305449e-02 3 1  ON 36
ci_038                 1.722793e-03 3 1  ON 37
ci_039                 2.214941e-03 3 1  ON 38
ci_040                -2.857875e-03 3 1  ON 39
ci_041                 8.848980e-03 3 1  ON 40
ci_042                 7.835312e-03 3 1  ON 41
ci_043                -4.015306e-03 3 1  ON 42
ci_044                -4.524063e-03 3 1  ON 43
ci_045                -3.424673e-03 3 1  ON 44
ci_046                 6.131245e-03 3 1  ON 45
ci_047                 5.383976e-03 3 1  ON 46
ci_048                -1.213258e-02 3 1  ON 47
ci_049                -1.526690e-02 3 1  ON 48
ci_050                 4.387363e-03 3 1  ON 49
ci_051                 3.431071e-03 3 1  ON 50
ci_052                -2.853492e-03 3 1  ON 51
ci_053                -3.598320e-03 3 1  ON 52
ci_054                -3.267961e-03 3 1  ON 53
ci_055                -3.303356e-03 3 1  ON 54
ci_056                 5.359372e-03 3 1  ON 55
ci_057                 5.430249e-03 3 1  ON 56
ci_058                -2.737755e-03 3 1  ON 57
ci_059                -3.205282e-03 3 1  ON 58
ci_060                 4.207503e-03 3 1  ON 59
ci_061                 5.346072e-03 3 1  ON 60
ci_062                -4.615533e-03 3 1  ON 61
ci_063                -3.996700e-03 3 1  ON 62
ci_064                -2.690308e-03 3 1  ON 63
ci_065                -3.877714e-03 3 1  ON 64
ci_066                 4.646679e-03 3 1  ON 65
ci_067                 5.200828e-03 3 1  ON 66
ci_068                -5.765131e-03 3 1  ON 67
ci_069                -4.906109e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9594e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.1559
    reference variance = 0.28509
====================================================
  Execution time = 1.3990e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9006e-01
  Total weights = 1.957150198e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4905e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276423862684
                                         uncertainty =       0.001632690120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276423862684
                                         uncertainty =       0.001632690120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371738059
  error estimate for blocks of size 2^( 2) =       0.000385335236
  error estimate for blocks of size 2^( 3) =       0.000397412156
  error estimate for blocks of size 2^( 4) =       0.000406278327
  error estimate for blocks of size 2^( 5) =       0.000411712221
  error estimate for blocks of size 2^( 6) =       0.000415607232
  error estimate for blocks of size 2^( 7) =       0.000416694234

      target function =      -0.913435380165
              le_mean =     -17.211749311176
             les_mean =     296.534375531073
             stat err =       0.000412573003
             autocorr =       1.231764150489
   target nu stat err =       0.000412573003
   target dn stat err =       0.002529205135
      target stat err =       0.003322742795
              std dev =       0.525717004272
             le_variance =       0.276378368581


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721174931118e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-05, overlap shift 5.9605e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913446597930       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914366358023       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914475474007       residual = 7.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914546802822       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914555737056       residual = 6.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914562320138       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914563742383       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914563864872       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914564535141       residual = 2.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914564642692       residual = 8.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914564547670       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914564554618       residual = 5.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-05 is 3.150138e-03

solving harmonic davidson linear method for identity shift 2.3842e-04, overlap shift 2.3842e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913446597930       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914364283049       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914473094735       residual = 7.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914544175262       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914553068547       residual = 6.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914559618694       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914561034212       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914561155217       residual = 1.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914561822376       residual = 2.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914561929230       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914561834651       residual = 2.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914561841577       residual = 5.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-04 is 3.141584e-03

solving harmonic davidson linear method for identity shift 9.5367e-04, overlap shift 9.5367e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913446597930       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914356075833       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914463686755       residual = 7.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914533790155       residual = 1.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914542522913       residual = 6.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914548944065       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914550333319       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914550448585       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914551103550       residual = 2.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914551207668       residual = 7.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914551114831       residual = 2.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914551121673       residual = 5.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-04 is 3.107841e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.512900 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6490e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
ci_001                -4.210729e-02 3 1  ON 0
ci_002                -3.295252e-02 3 1  ON 1
ci_003                -2.589843e-02 3 1  ON 2
ci_004                 2.443236e-02 3 1  ON 3
ci_005                 2.436371e-02 3 1  ON 4
ci_006                -2.224215e-02 3 1  ON 5
ci_007                -2.212707e-02 3 1  ON 6
ci_008                -8.326769e-03 3 1  ON 7
ci_009                -1.521056e-02 3 1  ON 8
ci_010                -9.789319e-03 3 1  ON 9
ci_011                -1.083216e-02 3 1  ON 10
ci_012                -9.790082e-03 3 1  ON 11
ci_013                -1.832300e-02 3 1  ON 12
ci_014                 1.278066e-02 3 1  ON 13
ci_015                 1.280446e-02 3 1  ON 14
ci_016                 1.703534e-02 3 1  ON 15
ci_017                 1.491249e-02 3 1  ON 16
ci_018                 1.114585e-02 3 1  ON 17
ci_019                 1.119277e-02 3 1  ON 18
ci_020                 1.796276e-02 3 1  ON 19
ci_021                 1.768373e-02 3 1  ON 20
ci_022                 1.037378e-02 3 1  ON 21
ci_023                 9.679925e-03 3 1  ON 22
ci_024                 9.620297e-03 3 1  ON 23
ci_025                 8.299452e-03 3 1  ON 24
ci_026                 1.161592e-02 3 1  ON 25
ci_027                 1.202086e-02 3 1  ON 26
ci_028                -1.461279e-02 3 1  ON 27
ci_029                -1.641988e-02 3 1  ON 28
ci_030                -9.878588e-03 3 1  ON 29
ci_031                -1.022977e-02 3 1  ON 30
ci_032                -1.410117e-02 3 1  ON 31
ci_033                 6.199217e-03 3 1  ON 32
ci_034                 5.378381e-03 3 1  ON 33
ci_035                -5.567711e-03 3 1  ON 34
ci_036                -1.353197e-02 3 1  ON 35
ci_037                -1.131871e-02 3 1  ON 36
ci_038                 2.388671e-03 3 1  ON 37
ci_039                 2.304285e-03 3 1  ON 38
ci_040                -2.792408e-03 3 1  ON 39
ci_041                 7.694988e-03 3 1  ON 40
ci_042                 8.769558e-03 3 1  ON 41
ci_043                -4.583374e-03 3 1  ON 42
ci_044                -3.644639e-03 3 1  ON 43
ci_045                -3.682764e-03 3 1  ON 44
ci_046                 5.894451e-03 3 1  ON 45
ci_047                 5.413540e-03 3 1  ON 46
ci_048                -1.363041e-02 3 1  ON 47
ci_049                -1.212532e-02 3 1  ON 48
ci_050                 3.181374e-03 3 1  ON 49
ci_051                 2.849540e-03 3 1  ON 50
ci_052                -3.243157e-03 3 1  ON 51
ci_053                -3.675538e-03 3 1  ON 52
ci_054                -2.665119e-03 3 1  ON 53
ci_055                -3.392004e-03 3 1  ON 54
ci_056                 4.868358e-03 3 1  ON 55
ci_057                 6.312397e-03 3 1  ON 56
ci_058                -2.787991e-03 3 1  ON 57
ci_059                -2.213634e-03 3 1  ON 58
ci_060                 5.437752e-03 3 1  ON 59
ci_061                 6.677115e-03 3 1  ON 60
ci_062                -4.326104e-03 3 1  ON 61
ci_063                -3.923162e-03 3 1  ON 62
ci_064                -3.183110e-03 3 1  ON 63
ci_065                -4.448444e-03 3 1  ON 64
ci_066                 4.919769e-03 3 1  ON 65
ci_067                 4.703383e-03 3 1  ON 66
ci_068                -5.314366e-03 3 1  ON 67
ci_069                -5.087254e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.1831
    reference variance = 0.179917
====================================================
  Execution time = 1.3779e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8926e-01
  Total weights = 1.9572e+06
  Execution time = 1.8734e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280238684639
                                         uncertainty =       0.002072135631

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280238684639
                                         uncertainty =       0.002072135631

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374270413
  error estimate for blocks of size 2^( 2) =       0.000387321236
  error estimate for blocks of size 2^( 3) =       0.000399866410
  error estimate for blocks of size 2^( 4) =       0.000408587374
  error estimate for blocks of size 2^( 5) =       0.000414104534
  error estimate for blocks of size 2^( 6) =       0.000417215486
  error estimate for blocks of size 2^( 7) =       0.000418231621

      target function =      -0.842442094143
              le_mean =     -17.211816991839
             les_mean =     296.594705985783
             stat err =       0.000414534754
             autocorr =       1.226735408993
   target nu stat err =       0.000414534754
   target dn stat err =       0.034259253443
      target stat err =       0.037770659751
              std dev =       0.529298294020
             le_variance =       0.280156684052

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278266014667
                                         uncertainty =       0.001612713183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278266014667
                                         uncertainty =       0.001612713183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372953962
  error estimate for blocks of size 2^( 2) =       0.000386047288
  error estimate for blocks of size 2^( 3) =       0.000398656432
  error estimate for blocks of size 2^( 4) =       0.000407434808
  error estimate for blocks of size 2^( 5) =       0.000413146100
  error estimate for blocks of size 2^( 6) =       0.000416364064
  error estimate for blocks of size 2^( 7) =       0.000417076876

      target function =      -0.914433446468
              le_mean =     -17.211608224086
             les_mean =     296.528720718491
             stat err =       0.000413505462
             autocorr =       1.229283492387
   target nu stat err =       0.000413505462
   target dn stat err =       0.002440730159
      target stat err =       0.003216601575
              std dev =       0.527436551549
             le_variance =       0.278189315910

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281544086258
                                         uncertainty =       0.001970046627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281544086258
                                         uncertainty =       0.001970046627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375142212
  error estimate for blocks of size 2^( 2) =       0.000388236073
  error estimate for blocks of size 2^( 3) =       0.000400823673
  error estimate for blocks of size 2^( 4) =       0.000409589682
  error estimate for blocks of size 2^( 5) =       0.000415211780
  error estimate for blocks of size 2^( 6) =       0.000418477212
  error estimate for blocks of size 2^( 7) =       0.000419157362

      target function =      -0.839584644366
              le_mean =     -17.211729813058
             les_mean =     296.594371203493
             stat err =       0.000415609009
             autocorr =       1.227377155318
   target nu stat err =       0.000415609009
   target dn stat err =       0.033554175199
      target stat err =       0.036734477455
              std dev =       0.530531204632
             le_variance =       0.281463359088

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278258048573
                                         uncertainty =       0.001613092658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278258048573
                                         uncertainty =       0.001613092658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372948619
  error estimate for blocks of size 2^( 2) =       0.000386041777
  error estimate for blocks of size 2^( 3) =       0.000398650556
  error estimate for blocks of size 2^( 4) =       0.000407428480
  error estimate for blocks of size 2^( 5) =       0.000413139825
  error estimate for blocks of size 2^( 6) =       0.000416357249
  error estimate for blocks of size 2^( 7) =       0.000417071230

      target function =      -0.914426777195
              le_mean =     -17.211608725701
             les_mean =     296.528743212367
             stat err =       0.000413499196
             autocorr =       1.229281461734
   target nu stat err =       0.000413499196
   target dn stat err =       0.002443465655
      target stat err =       0.003220041851
              std dev =       0.527428995173
             le_variance =       0.278181344949


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.842442094143        initial
     5.9605e-05     5.9605e-04             3.1501e-03        -0.914433446468  <--
     2.3842e-04     2.3842e-03             3.1416e-03        -0.839584644366
     9.5367e-04     9.5367e-03             3.1078e-03        -0.914426777195

*****************************************************************************
Applying the update for shift_i =   5.9605e-05     and shift_s =   5.9605e-04
*****************************************************************************

  Execution time = 2.3221e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
ci_001                -4.210782e-02 3 1  ON 0
ci_002                -3.295312e-02 3 1  ON 1
ci_003                -2.589947e-02 3 1  ON 2
ci_004                 2.443312e-02 3 1  ON 3
ci_005                 2.436307e-02 3 1  ON 4
ci_006                -2.224289e-02 3 1  ON 5
ci_007                -2.212777e-02 3 1  ON 6
ci_008                -8.325235e-03 3 1  ON 7
ci_009                -1.521100e-02 3 1  ON 8
ci_010                -9.791901e-03 3 1  ON 9
ci_011                -1.083356e-02 3 1  ON 10
ci_012                -9.789667e-03 3 1  ON 11
ci_013                -1.831541e-02 3 1  ON 12
ci_014                 1.278108e-02 3 1  ON 13
ci_015                 1.280620e-02 3 1  ON 14
ci_016                 1.703383e-02 3 1  ON 15
ci_017                 1.490577e-02 3 1  ON 16
ci_018                 1.114629e-02 3 1  ON 17
ci_019                 1.119290e-02 3 1  ON 18
ci_020                 1.796034e-02 3 1  ON 19
ci_021                 1.768534e-02 3 1  ON 20
ci_022                 1.037303e-02 3 1  ON 21
ci_023                 9.679454e-03 3 1  ON 22
ci_024                 9.623210e-03 3 1  ON 23
ci_025                 8.294756e-03 3 1  ON 24
ci_026                 1.161331e-02 3 1  ON 25
ci_027                 1.202134e-02 3 1  ON 26
ci_028                -1.460866e-02 3 1  ON 27
ci_029                -1.642099e-02 3 1  ON 28
ci_030                -9.880868e-03 3 1  ON 29
ci_031                -1.023508e-02 3 1  ON 30
ci_032                -1.409748e-02 3 1  ON 31
ci_033                 6.202222e-03 3 1  ON 32
ci_034                 5.374077e-03 3 1  ON 33
ci_035                -5.568127e-03 3 1  ON 34
ci_036                -1.353449e-02 3 1  ON 35
ci_037                -1.131476e-02 3 1  ON 36
ci_038                 2.390230e-03 3 1  ON 37
ci_039                 2.304492e-03 3 1  ON 38
ci_040                -2.792232e-03 3 1  ON 39
ci_041                 7.691960e-03 3 1  ON 40
ci_042                 8.771886e-03 3 1  ON 41
ci_043                -4.584745e-03 3 1  ON 42
ci_044                -3.642429e-03 3 1  ON 43
ci_045                -3.683355e-03 3 1  ON 44
ci_046                 5.893800e-03 3 1  ON 45
ci_047                 5.413626e-03 3 1  ON 46
ci_048                -1.363520e-02 3 1  ON 47
ci_049                -1.211676e-02 3 1  ON 48
ci_050                 3.178733e-03 3 1  ON 49
ci_051                 2.848270e-03 3 1  ON 50
ci_052                -3.244124e-03 3 1  ON 51
ci_053                -3.675798e-03 3 1  ON 52
ci_054                -2.664123e-03 3 1  ON 53
ci_055                -3.392218e-03 3 1  ON 54
ci_056                 4.867203e-03 3 1  ON 55
ci_057                 6.314555e-03 3 1  ON 56
ci_058                -2.787999e-03 3 1  ON 57
ci_059                -2.211263e-03 3 1  ON 58
ci_060                 5.440997e-03 3 1  ON 59
ci_061                 6.680596e-03 3 1  ON 60
ci_062                -4.325527e-03 3 1  ON 61
ci_063                -3.922781e-03 3 1  ON 62
ci_064                -3.184224e-03 3 1  ON 63
ci_065                -4.449789e-03 3 1  ON 64
ci_066                 4.920359e-03 3 1  ON 65
ci_067                 4.702319e-03 3 1  ON 66
ci_068                -5.313160e-03 3 1  ON 67
ci_069                -5.087738e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9716e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.249
    reference variance = 0.170682
====================================================
  Execution time = 1.4003e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5309e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8474e-01
  Total weights = 1.957286950e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5043e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274099708081
                                         uncertainty =       0.001636580342

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274099708081
                                         uncertainty =       0.001636580342

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370153927
  error estimate for blocks of size 2^( 2) =       0.000383872541
  error estimate for blocks of size 2^( 3) =       0.000396316249
  error estimate for blocks of size 2^( 4) =       0.000404694324
  error estimate for blocks of size 2^( 5) =       0.000410563002
  error estimate for blocks of size 2^( 6) =       0.000413844530
  error estimate for blocks of size 2^( 7) =       0.000416917484

      target function =      -0.920532906949
              le_mean =     -17.212323158684
             les_mean =     296.548804030571
             stat err =       0.000411504835
             autocorr =       1.235905206304
   target nu stat err =       0.000411504835
   target dn stat err =       0.002011293469
      target stat err =       0.002708624876
              std dev =       0.523476704151
             le_variance =       0.274027859789


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721232315868e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-05, overlap shift 1.4901e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920539945637       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921042611546       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921143611238       residual = 5.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921196562586       residual = 1.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921201466458       residual = 3.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921202058465       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921202296176       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921202339762       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921202417723       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921202621274       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921202688647       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921202711273       residual = 3.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-05 is 2.170545e-03

solving harmonic davidson linear method for identity shift 5.9605e-05, overlap shift 5.9605e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920539945637       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921042327629       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921143256470       residual = 5.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921196161589       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921201058795       residual = 3.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921201649455       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921201886579       residual = 3.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921201930149       residual = 5.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921202008008       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921202211230       residual = 6.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921202278564       residual = 1.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921202301153       residual = 2.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-05 is 2.168932e-03

solving harmonic davidson linear method for identity shift 2.3842e-04, overlap shift 2.3842e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.920539945637       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.921041195157       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.921141841562       residual = 5.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.921194562525       residual = 1.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.921199433212       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.921200018517       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.921200253313       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.921200296820       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.921200374270       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.921200576183       residual = 6.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.921200643359       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.921200665805       residual = 2.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-04 is 2.162507e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.517730 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6517e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
ci_001                -4.198963e-02 3 1  ON 0
ci_002                -3.241858e-02 3 1  ON 1
ci_003                -2.608260e-02 3 1  ON 2
ci_004                 2.455765e-02 3 1  ON 3
ci_005                 2.409212e-02 3 1  ON 4
ci_006                -2.263161e-02 3 1  ON 5
ci_007                -2.187040e-02 3 1  ON 6
ci_008                -9.653346e-03 3 1  ON 7
ci_009                -1.538177e-02 3 1  ON 8
ci_010                -9.007695e-03 3 1  ON 9
ci_011                -1.009555e-02 3 1  ON 10
ci_012                -9.768103e-03 3 1  ON 11
ci_013                -2.028943e-02 3 1  ON 12
ci_014                 1.269508e-02 3 1  ON 13
ci_015                 1.253502e-02 3 1  ON 14
ci_016                 1.697287e-02 3 1  ON 15
ci_017                 1.707470e-02 3 1  ON 16
ci_018                 1.126082e-02 3 1  ON 17
ci_019                 1.126112e-02 3 1  ON 18
ci_020                 1.783299e-02 3 1  ON 19
ci_021                 1.763950e-02 3 1  ON 20
ci_022                 1.142927e-02 3 1  ON 21
ci_023                 9.579867e-03 3 1  ON 22
ci_024                 8.407722e-03 3 1  ON 23
ci_025                 1.012125e-02 3 1  ON 24
ci_026                 1.220422e-02 3 1  ON 25
ci_027                 1.252682e-02 3 1  ON 26
ci_028                -1.441718e-02 3 1  ON 27
ci_029                -1.513717e-02 3 1  ON 28
ci_030                -9.065840e-03 3 1  ON 29
ci_031                -9.595601e-03 3 1  ON 30
ci_032                -1.438721e-02 3 1  ON 31
ci_033                 5.048023e-03 3 1  ON 32
ci_034                 6.689105e-03 3 1  ON 33
ci_035                -5.244207e-03 3 1  ON 34
ci_036                -1.375383e-02 3 1  ON 35
ci_037                -1.217489e-02 3 1  ON 36
ci_038                 1.982602e-03 3 1  ON 37
ci_039                 1.921310e-03 3 1  ON 38
ci_040                -3.718881e-03 3 1  ON 39
ci_041                 7.879866e-03 3 1  ON 40
ci_042                 9.575287e-03 3 1  ON 41
ci_043                -4.260274e-03 3 1  ON 42
ci_044                -4.450880e-03 3 1  ON 43
ci_045                -3.162847e-03 3 1  ON 44
ci_046                 5.921503e-03 3 1  ON 45
ci_047                 6.297540e-03 3 1  ON 46
ci_048                -1.152849e-02 3 1  ON 47
ci_049                -1.270497e-02 3 1  ON 48
ci_050                 3.560109e-03 3 1  ON 49
ci_051                 3.804570e-03 3 1  ON 50
ci_052                -2.872824e-03 3 1  ON 51
ci_053                -3.082524e-03 3 1  ON 52
ci_054                -2.766669e-03 3 1  ON 53
ci_055                -3.521110e-03 3 1  ON 54
ci_056                 5.983278e-03 3 1  ON 55
ci_057                 5.354856e-03 3 1  ON 56
ci_058                -1.771051e-03 3 1  ON 57
ci_059                -2.833025e-03 3 1  ON 58
ci_060                 4.987720e-03 3 1  ON 59
ci_061                 5.236354e-03 3 1  ON 60
ci_062                -4.126508e-03 3 1  ON 61
ci_063                -3.494902e-03 3 1  ON 62
ci_064                -2.861805e-03 3 1  ON 63
ci_065                -4.060135e-03 3 1  ON 64
ci_066                 4.043493e-03 3 1  ON 65
ci_067                 4.737912e-03 3 1  ON 66
ci_068                -5.198330e-03 3 1  ON 67
ci_069                -4.502647e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.3101
    reference variance = 0.238259
====================================================
  Execution time = 1.3557e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8832e-01
  Total weights = 1.9573e+06
  Execution time = 1.8554e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275846633069
                                         uncertainty =       0.001407949403

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275846633069
                                         uncertainty =       0.001407949403

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371495413
  error estimate for blocks of size 2^( 2) =       0.000385859880
  error estimate for blocks of size 2^( 3) =       0.000398402674
  error estimate for blocks of size 2^( 4) =       0.000407166015
  error estimate for blocks of size 2^( 5) =       0.000412473486
  error estimate for blocks of size 2^( 6) =       0.000415914570
  error estimate for blocks of size 2^( 7) =       0.000416326713

      target function =      -0.896090258858
              le_mean =     -17.212299137194
             les_mean =     296.566964770221
             stat err =       0.000412970196
             autocorr =       1.235749684981
   target nu stat err =       0.000412970196
   target dn stat err =       0.009061283001
      target stat err =       0.011303883688
              std dev =       0.525373851320
             le_variance =       0.276017683651

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275035588417
                                         uncertainty =       0.001363271088

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275035588417
                                         uncertainty =       0.001363271088

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370947890
  error estimate for blocks of size 2^( 2) =       0.000385303685
  error estimate for blocks of size 2^( 3) =       0.000397851376
  error estimate for blocks of size 2^( 4) =       0.000406622844
  error estimate for blocks of size 2^( 5) =       0.000411924366
  error estimate for blocks of size 2^( 6) =       0.000415292914
  error estimate for blocks of size 2^( 7) =       0.000415688043

      target function =      -0.915814648205
              le_mean =     -17.212247713141
             les_mean =     296.549796226153
             stat err =       0.000412382042
             autocorr =       1.235872529749
   target nu stat err =       0.000412382042
   target dn stat err =       0.002512632640
      target stat err =       0.003321116312
              std dev =       0.524599537033
             le_variance =       0.275204674255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277246328304
                                         uncertainty =       0.001571814936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277246328304
                                         uncertainty =       0.001571814936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372431384
  error estimate for blocks of size 2^( 2) =       0.000386712858
  error estimate for blocks of size 2^( 3) =       0.000399228941
  error estimate for blocks of size 2^( 4) =       0.000407971579
  error estimate for blocks of size 2^( 5) =       0.000413286689
  error estimate for blocks of size 2^( 6) =       0.000416573449
  error estimate for blocks of size 2^( 7) =       0.000417037132

      target function =      -0.839071764481
              le_mean =     -17.212423925839
             les_mean =     296.618812980715
             stat err =       0.000413717212
             autocorr =       1.233998516862
   target nu stat err =       0.000413717212
   target dn stat err =       0.033426635826
      target stat err =       0.036589078012
              std dev =       0.526697514153
             le_variance =       0.277410271415

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275034925080
                                         uncertainty =       0.001363344512

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275034925080
                                         uncertainty =       0.001363344512

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370947446
  error estimate for blocks of size 2^( 2) =       0.000385303286
  error estimate for blocks of size 2^( 3) =       0.000397851013
  error estimate for blocks of size 2^( 4) =       0.000406622487
  error estimate for blocks of size 2^( 5) =       0.000411924001
  error estimate for blocks of size 2^( 6) =       0.000415292741
  error estimate for blocks of size 2^( 7) =       0.000415687848

      target function =      -0.915824402465
              le_mean =     -17.212247579314
             les_mean =     296.549784096952
             stat err =       0.000412381769
             autocorr =       1.235873849720
   target nu stat err =       0.000412381769
   target dn stat err =       0.002512427878
      target stat err =       0.003320922964
              std dev =       0.524598909705
             le_variance =       0.275204016064


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.896090258858        initial
     1.4901e-05     1.4901e-04             2.1705e-03        -0.915814648205
     5.9605e-05     5.9605e-04             2.1689e-03        -0.839071764481
     2.3842e-04     2.3842e-03             2.1625e-03        -0.915824402465  <--

*****************************************************************************
Applying the update for shift_i =   2.3842e-04     and shift_s =   2.3842e-03
*****************************************************************************

  Execution time = 2.2899e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
ci_001                -4.199006e-02 3 1  ON 0
ci_002                -3.242017e-02 3 1  ON 1
ci_003                -2.608164e-02 3 1  ON 2
ci_004                 2.455703e-02 3 1  ON 3
ci_005                 2.409259e-02 3 1  ON 4
ci_006                -2.263061e-02 3 1  ON 5
ci_007                -2.187111e-02 3 1  ON 6
ci_008                -9.650352e-03 3 1  ON 7
ci_009                -1.538135e-02 3 1  ON 8
ci_010                -9.009700e-03 3 1  ON 9
ci_011                -1.009736e-02 3 1  ON 10
ci_012                -9.768123e-03 3 1  ON 11
ci_013                -2.028320e-02 3 1  ON 12
ci_014                 1.269547e-02 3 1  ON 13
ci_015                 1.253557e-02 3 1  ON 14
ci_016                 1.697301e-02 3 1  ON 15
ci_017                 1.706828e-02 3 1  ON 16
ci_018                 1.126059e-02 3 1  ON 17
ci_019                 1.126092e-02 3 1  ON 18
ci_020                 1.783317e-02 3 1  ON 19
ci_021                 1.763972e-02 3 1  ON 20
ci_022                 1.142634e-02 3 1  ON 21
ci_023                 9.580031e-03 3 1  ON 22
ci_024                 8.411187e-03 3 1  ON 23
ci_025                 1.011636e-02 3 1  ON 24
ci_026                 1.220278e-02 3 1  ON 25
ci_027                 1.252564e-02 3 1  ON 26
ci_028                -1.441767e-02 3 1  ON 27
ci_029                -1.514059e-02 3 1  ON 28
ci_030                -9.068336e-03 3 1  ON 29
ci_031                -9.597014e-03 3 1  ON 30
ci_032                -1.438650e-02 3 1  ON 31
ci_033                 5.050967e-03 3 1  ON 32
ci_034                 6.685603e-03 3 1  ON 33
ci_035                -5.244965e-03 3 1  ON 34
ci_036                -1.375308e-02 3 1  ON 35
ci_037                -1.217266e-02 3 1  ON 36
ci_038                 1.983548e-03 3 1  ON 37
ci_039                 1.922201e-03 3 1  ON 38
ci_040                -3.716773e-03 3 1  ON 39
ci_041                 7.879459e-03 3 1  ON 40
ci_042                 9.573713e-03 3 1  ON 41
ci_043                -4.261069e-03 3 1  ON 42
ci_044                -4.448834e-03 3 1  ON 43
ci_045                -3.164061e-03 3 1  ON 44
ci_046                 5.921425e-03 3 1  ON 45
ci_047                 6.295253e-03 3 1  ON 46
ci_048                -1.153499e-02 3 1  ON 47
ci_049                -1.270344e-02 3 1  ON 48
ci_050                 3.559300e-03 3 1  ON 49
ci_051                 3.802490e-03 3 1  ON 50
ci_052                -2.873665e-03 3 1  ON 51
ci_053                -3.084088e-03 3 1  ON 52
ci_054                -2.766547e-03 3 1  ON 53
ci_055                -3.520759e-03 3 1  ON 54
ci_056                 5.980580e-03 3 1  ON 55
ci_057                 5.357174e-03 3 1  ON 56
ci_058                -1.773361e-03 3 1  ON 57
ci_059                -2.831549e-03 3 1  ON 58
ci_060                 4.988924e-03 3 1  ON 59
ci_061                 5.240126e-03 3 1  ON 60
ci_062                -4.127184e-03 3 1  ON 61
ci_063                -3.495752e-03 3 1  ON 62
ci_064                -2.862532e-03 3 1  ON 63
ci_065                -4.061025e-03 3 1  ON 64
ci_066                 4.045525e-03 3 1  ON 65
ci_067                 4.737919e-03 3 1  ON 66
ci_068                -5.198664e-03 3 1  ON 67
ci_069                -4.504175e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9422e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.2348
    reference variance = 0.215436
====================================================
  Execution time = 1.4089e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8546e-01
  Total weights = 1.957384631e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4934e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273991565155
                                         uncertainty =       0.001389199561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273991565155
                                         uncertainty =       0.001389199561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370136918
  error estimate for blocks of size 2^( 2) =       0.000384278565
  error estimate for blocks of size 2^( 3) =       0.000396203996
  error estimate for blocks of size 2^( 4) =       0.000405157738
  error estimate for blocks of size 2^( 5) =       0.000411239600
  error estimate for blocks of size 2^( 6) =       0.000413821462
  error estimate for blocks of size 2^( 7) =       0.000414860822

      target function =      -0.919519623178
              le_mean =     -17.212110832718
             les_mean =     296.542222474250
             stat err =       0.000411269906
             autocorr =       1.234607905099
   target nu stat err =       0.000411269906
   target dn stat err =       0.002186130617
      target stat err =       0.002926068321
              std dev =       0.523452649758
             le_variance =       0.274002676539


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721211083272e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-05, overlap shift 5.9605e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919528121535       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920264876283       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920341711529       residual = 4.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920385027133       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920396669583       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920402309239       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920402868425       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920403037957       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920403167896       residual = 1.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920403127894       residual = 5.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920403172767       residual = 1.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920403137478       residual = 4.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-05 is 2.536648e-03

solving harmonic davidson linear method for identity shift 2.3842e-04, overlap shift 2.3842e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919528121535       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920263223647       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920339842189       residual = 4.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920383013626       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920394607168       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920400223904       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920400779685       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920400947552       residual = 7.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920401076898       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920401036989       residual = 5.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920401081647       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920401046576       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-04 is 2.530996e-03

solving harmonic davidson linear method for identity shift 9.5367e-04, overlap shift 9.5367e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.919528121535       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.920256686518       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.920332450039       residual = 4.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.920375053819       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.920386455349       residual = 2.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.920391982098       residual = 9.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.920392524592       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.920392685992       residual = 7.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.920392813014       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.920392773482       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.920392817293       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.920392783071       residual = 4.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-04 is 2.508638e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.522498 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6592e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
ci_001                -4.149033e-02 3 1  ON 0
ci_002                -3.381781e-02 3 1  ON 1
ci_003                -2.634269e-02 3 1  ON 2
ci_004                 2.354831e-02 3 1  ON 3
ci_005                 2.393861e-02 3 1  ON 4
ci_006                -2.247033e-02 3 1  ON 5
ci_007                -2.153098e-02 3 1  ON 6
ci_008                -8.762308e-03 3 1  ON 7
ci_009                -1.521226e-02 3 1  ON 8
ci_010                -9.565869e-03 3 1  ON 9
ci_011                -1.013093e-02 3 1  ON 10
ci_012                -1.083397e-02 3 1  ON 11
ci_013                -1.971013e-02 3 1  ON 12
ci_014                 1.287901e-02 3 1  ON 13
ci_015                 1.249263e-02 3 1  ON 14
ci_016                 1.699582e-02 3 1  ON 15
ci_017                 1.669051e-02 3 1  ON 16
ci_018                 1.054458e-02 3 1  ON 17
ci_019                 1.106470e-02 3 1  ON 18
ci_020                 1.787443e-02 3 1  ON 19
ci_021                 1.818655e-02 3 1  ON 20
ci_022                 1.110155e-02 3 1  ON 21
ci_023                 1.088562e-02 3 1  ON 22
ci_024                 1.013170e-02 3 1  ON 23
ci_025                 9.651988e-03 3 1  ON 24
ci_026                 1.103327e-02 3 1  ON 25
ci_027                 1.199403e-02 3 1  ON 26
ci_028                -1.611271e-02 3 1  ON 27
ci_029                -1.617942e-02 3 1  ON 28
ci_030                -9.450783e-03 3 1  ON 29
ci_031                -8.259138e-03 3 1  ON 30
ci_032                -1.379115e-02 3 1  ON 31
ci_033                 6.407171e-03 3 1  ON 32
ci_034                 5.952777e-03 3 1  ON 33
ci_035                -5.742046e-03 3 1  ON 34
ci_036                -1.122208e-02 3 1  ON 35
ci_037                -1.382069e-02 3 1  ON 36
ci_038                 2.033684e-03 3 1  ON 37
ci_039                 2.490697e-03 3 1  ON 38
ci_040                -2.988142e-03 3 1  ON 39
ci_041                 8.563311e-03 3 1  ON 40
ci_042                 9.036294e-03 3 1  ON 41
ci_043                -4.563839e-03 3 1  ON 42
ci_044                -3.017462e-03 3 1  ON 43
ci_045                -3.031018e-03 3 1  ON 44
ci_046                 5.508293e-03 3 1  ON 45
ci_047                 6.292081e-03 3 1  ON 46
ci_048                -1.282664e-02 3 1  ON 47
ci_049                -1.268705e-02 3 1  ON 48
ci_050                 3.098191e-03 3 1  ON 49
ci_051                 3.136900e-03 3 1  ON 50
ci_052                -2.406347e-03 3 1  ON 51
ci_053                -4.024782e-03 3 1  ON 52
ci_054                -2.958887e-03 3 1  ON 53
ci_055                -3.191381e-03 3 1  ON 54
ci_056                 6.444196e-03 3 1  ON 55
ci_057                 6.057616e-03 3 1  ON 56
ci_058                -2.819478e-03 3 1  ON 57
ci_059                -2.455607e-03 3 1  ON 58
ci_060                 5.096533e-03 3 1  ON 59
ci_061                 4.830113e-03 3 1  ON 60
ci_062                -3.660110e-03 3 1  ON 61
ci_063                -3.890176e-03 3 1  ON 62
ci_064                -3.160607e-03 3 1  ON 63
ci_065                -3.939556e-03 3 1  ON 64
ci_066                 4.886317e-03 3 1  ON 65
ci_067                 4.950787e-03 3 1  ON 66
ci_068                -4.535735e-03 3 1  ON 67
ci_069                -4.772787e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.1187
    reference variance = 1.04013
====================================================
  Execution time = 1.3554e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9051e-01
  Total weights = 1.9571e+06
  Execution time = 1.8637e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279207075025
                                         uncertainty =       0.002588532846

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279207075025
                                         uncertainty =       0.002588532846

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373645048
  error estimate for blocks of size 2^( 2) =       0.000387380673
  error estimate for blocks of size 2^( 3) =       0.000400505889
  error estimate for blocks of size 2^( 4) =       0.000409360652
  error estimate for blocks of size 2^( 5) =       0.000415876916
  error estimate for blocks of size 2^( 6) =       0.000418862422
  error estimate for blocks of size 2^( 7) =       0.000419789215

      target function =      -0.891019332581
              le_mean =     -17.211882573725
             les_mean =     296.556558883300
             stat err =       0.000415972301
             autocorr =       1.239396778366
   target nu stat err =       0.000415972301
   target dn stat err =       0.012148424719
      target stat err =       0.014967915906
              std dev =       0.528413895096
             le_variance =       0.279221244530

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278303317280
                                         uncertainty =       0.002376309378

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278303317280
                                         uncertainty =       0.002376309378

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373039861
  error estimate for blocks of size 2^( 2) =       0.000386787856
  error estimate for blocks of size 2^( 3) =       0.000399961579
  error estimate for blocks of size 2^( 4) =       0.000408859033
  error estimate for blocks of size 2^( 5) =       0.000415320915
  error estimate for blocks of size 2^( 6) =       0.000418387621
  error estimate for blocks of size 2^( 7) =       0.000419481478

      target function =      -0.912854719955
              le_mean =     -17.211768906729
             les_mean =     296.535498262185
             stat err =       0.000415512262
             autocorr =       1.240672643912
   target nu stat err =       0.000415512262
   target dn stat err =       0.003119208498
      target stat err =       0.004071734574
              std dev =       0.527558031194
             le_variance =       0.278317476278

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279911350541
                                         uncertainty =       0.002287189830

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279911350541
                                         uncertainty =       0.002287189830

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374113637
  error estimate for blocks of size 2^( 2) =       0.000387825679
  error estimate for blocks of size 2^( 3) =       0.000401019680
  error estimate for blocks of size 2^( 4) =       0.000409942766
  error estimate for blocks of size 2^( 5) =       0.000416356488
  error estimate for blocks of size 2^( 6) =       0.000419522563
  error estimate for blocks of size 2^( 7) =       0.000420763856

      target function =      -0.839529099917
              le_mean =     -17.211876759783
             les_mean =     296.599224673132
             stat err =       0.000416646418
             autocorr =       1.240304235289
   target nu stat err =       0.000416646418
   target dn stat err =       0.036512645899
      target stat err =       0.039990625771
              std dev =       0.529076579650
             le_variance =       0.279922027135

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278299905126
                                         uncertainty =       0.002378640170

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278299905126
                                         uncertainty =       0.002378640170

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373037595
  error estimate for blocks of size 2^( 2) =       0.000386785668
  error estimate for blocks of size 2^( 3) =       0.000399959080
  error estimate for blocks of size 2^( 4) =       0.000408856162
  error estimate for blocks of size 2^( 5) =       0.000415318581
  error estimate for blocks of size 2^( 6) =       0.000418384356
  error estimate for blocks of size 2^( 7) =       0.000419476173

      target function =      -0.912859352054
              le_mean =     -17.211768848139
             les_mean =     296.535492639026
             stat err =       0.000415508818
             autocorr =       1.240667157442
   target nu stat err =       0.000415508818
   target dn stat err =       0.003120127147
      target stat err =       0.004072948636
              std dev =       0.527554825661
             le_variance =       0.278314094079


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.891019332581        initial
     5.9605e-05     5.9605e-04             2.5366e-03        -0.912854719955
     2.3842e-04     2.3842e-03             2.5310e-03        -0.839529099917
     9.5367e-04     9.5367e-03             2.5086e-03        -0.912859352054  <--

*****************************************************************************
Applying the update for shift_i =   9.5367e-04     and shift_s =   9.5367e-03
*****************************************************************************

  Execution time = 2.3125e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
ci_001                -4.149572e-02 3 1  ON 0
ci_002                -3.380245e-02 3 1  ON 1
ci_003                -2.634133e-02 3 1  ON 2
ci_004                 2.356146e-02 3 1  ON 3
ci_005                 2.394159e-02 3 1  ON 4
ci_006                -2.247205e-02 3 1  ON 5
ci_007                -2.153507e-02 3 1  ON 6
ci_008                -8.770195e-03 3 1  ON 7
ci_009                -1.521371e-02 3 1  ON 8
ci_010                -9.560422e-03 3 1  ON 9
ci_011                -1.013047e-02 3 1  ON 10
ci_012                -1.082364e-02 3 1  ON 11
ci_013                -1.971701e-02 3 1  ON 12
ci_014                 1.287682e-02 3 1  ON 13
ci_015                 1.249410e-02 3 1  ON 14
ci_016                 1.699558e-02 3 1  ON 15
ci_017                 1.669503e-02 3 1  ON 16
ci_018                 1.055088e-02 3 1  ON 17
ci_019                 1.106679e-02 3 1  ON 18
ci_020                 1.787512e-02 3 1  ON 19
ci_021                 1.818160e-02 3 1  ON 20
ci_022                 1.110580e-02 3 1  ON 21
ci_023                 1.087166e-02 3 1  ON 22
ci_024                 1.011306e-02 3 1  ON 23
ci_025                 9.656439e-03 3 1  ON 24
ci_026                 1.104538e-02 3 1  ON 25
ci_027                 1.199943e-02 3 1  ON 26
ci_028                -1.609327e-02 3 1  ON 27
ci_029                -1.616817e-02 3 1  ON 28
ci_030                -9.445727e-03 3 1  ON 29
ci_031                -8.271422e-03 3 1  ON 30
ci_032                -1.379732e-02 3 1  ON 31
ci_033                 6.393300e-03 3 1  ON 32
ci_034                 5.960486e-03 3 1  ON 33
ci_035                -5.737382e-03 3 1  ON 34
ci_036                -1.124444e-02 3 1  ON 35
ci_037                -1.380663e-02 3 1  ON 36
ci_038                 2.033270e-03 3 1  ON 37
ci_039                 2.485510e-03 3 1  ON 38
ci_040                -2.994717e-03 3 1  ON 39
ci_041                 8.555392e-03 3 1  ON 40
ci_042                 9.040405e-03 3 1  ON 41
ci_043                -4.560937e-03 3 1  ON 42
ci_044                -3.031156e-03 3 1  ON 43
ci_045                -3.032253e-03 3 1  ON 44
ci_046                 5.512621e-03 3 1  ON 45
ci_047                 6.292097e-03 3 1  ON 46
ci_048                -1.281058e-02 3 1  ON 47
ci_049                -1.268836e-02 3 1  ON 48
ci_050                 3.102145e-03 3 1  ON 49
ci_051                 3.142564e-03 3 1  ON 50
ci_052                -2.411404e-03 3 1  ON 51
ci_053                -4.015905e-03 3 1  ON 52
ci_054                -2.957516e-03 3 1  ON 53
ci_055                -3.194779e-03 3 1  ON 54
ci_056                 6.439876e-03 3 1  ON 55
ci_057                 6.050973e-03 3 1  ON 56
ci_058                -2.809723e-03 3 1  ON 57
ci_059                -2.459264e-03 3 1  ON 58
ci_060                 5.095438e-03 3 1  ON 59
ci_061                 4.834194e-03 3 1  ON 60
ci_062                -3.663765e-03 3 1  ON 61
ci_063                -3.886517e-03 3 1  ON 62
ci_064                -3.157927e-03 3 1  ON 63
ci_065                -3.940655e-03 3 1  ON 64
ci_066                 4.878687e-03 3 1  ON 65
ci_067                 4.948501e-03 3 1  ON 66
ci_068                -4.542670e-03 3 1  ON 67
ci_069                -4.770104e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9722e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.2126
    reference variance = 0.181345
====================================================
  Execution time = 1.3951e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9171e-01
  Total weights = 1.957325635e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5025e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277847119981
                                         uncertainty =       0.002319976026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277847119981
                                         uncertainty =       0.002319976026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372744211
  error estimate for blocks of size 2^( 2) =       0.000386539483
  error estimate for blocks of size 2^( 3) =       0.000398998192
  error estimate for blocks of size 2^( 4) =       0.000408009465
  error estimate for blocks of size 2^( 5) =       0.000413747042
  error estimate for blocks of size 2^( 6) =       0.000417177188
  error estimate for blocks of size 2^( 7) =       0.000417792507

      target function =      -0.911350996790
              le_mean =     -17.212057900855
             les_mean =     296.546643629920
             stat err =       0.000414181551
             autocorr =       1.234694983320
   target nu stat err =       0.000414181551
   target dn stat err =       0.005208495643
      target stat err =       0.006734363021
              std dev =       0.527139919135
             le_variance =       0.277876494346


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721205790086e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-04, overlap shift 2.3842e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911400302683       residual = 3.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913014878863       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913171846218       residual = 6.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913214014417       residual = 1.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913224857526       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913227123128       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913227270219       residual = 2.48e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913227227677       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913227126737       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913227099922       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913227132541       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913227131812       residual = 4.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-04 is 3.032270e-03

solving harmonic davidson linear method for identity shift 9.5367e-04, overlap shift 9.5367e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911400302683       residual = 3.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913000344264       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913155482913       residual = 6.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913197049340       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913207709626       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913209922402       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913210062635       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913210019022       residual = 8.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913209920679       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913209893261       residual = 4.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913209925395       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913209925176       residual = 4.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-04 is 3.005089e-03

solving harmonic davidson linear method for identity shift 3.8147e-03, overlap shift 3.8147e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911400302683       residual = 3.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912944727035       residual = 2.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913092946714       residual = 6.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913132258087       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913142239415       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913144259051       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913144374710       residual = 2.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913144327719       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913144238755       residual = 1.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913144209690       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913144239806       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913144241247       residual = 3.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-03 is 2.901072e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.527304 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6464e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
ci_001                -4.244223e-02 3 1  ON 0
ci_002                -3.248682e-02 3 1  ON 1
ci_003                -2.707199e-02 3 1  ON 2
ci_004                 2.301460e-02 3 1  ON 3
ci_005                 2.402122e-02 3 1  ON 4
ci_006                -2.122345e-02 3 1  ON 5
ci_007                -2.091906e-02 3 1  ON 6
ci_008                -8.524592e-03 3 1  ON 7
ci_009                -1.419774e-02 3 1  ON 8
ci_010                -1.015166e-02 3 1  ON 9
ci_011                -1.212561e-02 3 1  ON 10
ci_012                -7.980789e-03 3 1  ON 11
ci_013                -1.868700e-02 3 1  ON 12
ci_014                 1.348193e-02 3 1  ON 13
ci_015                 1.436408e-02 3 1  ON 14
ci_016                 1.624378e-02 3 1  ON 15
ci_017                 1.671138e-02 3 1  ON 16
ci_018                 1.087601e-02 3 1  ON 17
ci_019                 1.219655e-02 3 1  ON 18
ci_020                 1.918088e-02 3 1  ON 19
ci_021                 1.685499e-02 3 1  ON 20
ci_022                 9.857599e-03 3 1  ON 21
ci_023                 9.268882e-03 3 1  ON 22
ci_024                 1.136364e-02 3 1  ON 23
ci_025                 1.001272e-02 3 1  ON 24
ci_026                 1.405046e-02 3 1  ON 25
ci_027                 1.181518e-02 3 1  ON 26
ci_028                -1.422654e-02 3 1  ON 27
ci_029                -1.736667e-02 3 1  ON 28
ci_030                -9.791431e-03 3 1  ON 29
ci_031                -7.059726e-03 3 1  ON 30
ci_032                -1.427983e-02 3 1  ON 31
ci_033                 4.990036e-03 3 1  ON 32
ci_034                 4.732686e-03 3 1  ON 33
ci_035                -5.955614e-03 3 1  ON 34
ci_036                -1.289271e-02 3 1  ON 35
ci_037                -1.165608e-02 3 1  ON 36
ci_038                 1.848549e-03 3 1  ON 37
ci_039                 2.724286e-03 3 1  ON 38
ci_040                -3.545869e-03 3 1  ON 39
ci_041                 8.188950e-03 3 1  ON 40
ci_042                 6.587819e-03 3 1  ON 41
ci_043                -4.490187e-03 3 1  ON 42
ci_044                -4.061412e-03 3 1  ON 43
ci_045                -4.114592e-03 3 1  ON 44
ci_046                 5.439892e-03 3 1  ON 45
ci_047                 6.077550e-03 3 1  ON 46
ci_048                -1.214329e-02 3 1  ON 47
ci_049                -1.314616e-02 3 1  ON 48
ci_050                 3.805091e-03 3 1  ON 49
ci_051                 3.025172e-03 3 1  ON 50
ci_052                -3.312694e-03 3 1  ON 51
ci_053                -2.317251e-03 3 1  ON 52
ci_054                -3.120373e-03 3 1  ON 53
ci_055                -2.216053e-03 3 1  ON 54
ci_056                 5.036305e-03 3 1  ON 55
ci_057                 6.727691e-03 3 1  ON 56
ci_058                -2.589198e-03 3 1  ON 57
ci_059                -1.846627e-03 3 1  ON 58
ci_060                 4.255222e-03 3 1  ON 59
ci_061                 5.244189e-03 3 1  ON 60
ci_062                -2.871080e-03 3 1  ON 61
ci_063                -4.113479e-03 3 1  ON 62
ci_064                -3.157122e-03 3 1  ON 63
ci_065                -3.872714e-03 3 1  ON 64
ci_066                 4.306943e-03 3 1  ON 65
ci_067                 3.905178e-03 3 1  ON 66
ci_068                -5.706374e-03 3 1  ON 67
ci_069                -5.385881e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.1806
    reference variance = 0.154129
====================================================
  Execution time = 1.3626e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9014e-01
  Total weights = 1.9572e+06
  Execution time = 1.8646e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0013219
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329050550327
                                         uncertainty =       0.049574535018

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.329050550327
                                         uncertainty =       0.049574535018

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000405553889
  error estimate for blocks of size 2^( 2) =       0.000417977248
  error estimate for blocks of size 2^( 3) =       0.000429618869
  error estimate for blocks of size 2^( 4) =       0.000437726746
  error estimate for blocks of size 2^( 5) =       0.000442563760
  error estimate for blocks of size 2^( 6) =       0.000445604079
  error estimate for blocks of size 2^( 7) =       0.000445412648

      target function =      -0.119891016902
              le_mean =     -17.212198607965
             les_mean =     299.312592975435
             stat err =       0.000442826808
             autocorr =       1.192259163770
   target nu stat err =       0.000442826808
   target dn stat err =       2.573907574049
      target stat err =       0.088969904214
              std dev =       0.573539809635
             le_variance =       0.328947913236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277542317614
                                         uncertainty =       0.001542881310

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277542317614
                                         uncertainty =       0.001542881310

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372506483
  error estimate for blocks of size 2^( 2) =       0.000386067863
  error estimate for blocks of size 2^( 3) =       0.000398646508
  error estimate for blocks of size 2^( 4) =       0.000407114862
  error estimate for blocks of size 2^( 5) =       0.000411664961
  error estimate for blocks of size 2^( 6) =       0.000415194889
  error estimate for blocks of size 2^( 7) =       0.000414778297

      target function =      -0.913443248035
              le_mean =     -17.211817791106
             les_mean =     296.536739466848
             stat err =       0.000412188252
             autocorr =       1.224400641008
   target nu stat err =       0.000412188252
   target dn stat err =       0.002618799484
      target stat err =       0.003437203944
              std dev =       0.526803720605
             le_variance =       0.277522160043

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00131032
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.606926798687
                                         uncertainty =       0.322592354212

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.606926798687
                                         uncertainty =       0.322592354212

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000550848634
  error estimate for blocks of size 2^( 2) =       0.000560334325
  error estimate for blocks of size 2^( 3) =       0.000569354677
  error estimate for blocks of size 2^( 4) =       0.000575422465
  error estimate for blocks of size 2^( 5) =       0.000578686436
  error estimate for blocks of size 2^( 6) =       0.000581232652
  error estimate for blocks of size 2^( 7) =       0.000580811439

      target function =      -0.041510472165
              le_mean =     -17.211587554132
             les_mean =     304.564255284965
             stat err =       0.000579038248
             autocorr =       1.104968634372
   target nu stat err =       0.000579038248
   target dn stat err =       7.718511290331
      target stat err =       0.036650792283
              std dev =       0.779017608621
             le_variance =       0.606868434541

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277490443746
                                         uncertainty =       0.001542657070

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277490443746
                                         uncertainty =       0.001542657070

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372471598
  error estimate for blocks of size 2^( 2) =       0.000386030199
  error estimate for blocks of size 2^( 3) =       0.000398606528
  error estimate for blocks of size 2^( 4) =       0.000407074983
  error estimate for blocks of size 2^( 5) =       0.000411627004
  error estimate for blocks of size 2^( 6) =       0.000415154266
  error estimate for blocks of size 2^( 7) =       0.000414735955

      target function =      -0.910255231252
              le_mean =     -17.211818640848
             les_mean =     296.539232735693
             stat err =       0.000412148052
             autocorr =       1.224391139517
   target nu stat err =       0.000412148052
   target dn stat err =       0.003692669796
      target stat err =       0.004778594631
              std dev =       0.526754385965
             le_variance =       0.277470183133


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.119891016902        initial
     2.3842e-04     2.3842e-03             3.0323e-03        -0.913443248035  <--
     9.5367e-04     9.5367e-03             3.0051e-03        -0.041510472165
     3.8147e-03     3.8147e-02             2.9011e-03        -0.910255231252

*****************************************************************************
Applying the update for shift_i =   2.3842e-04     and shift_s =   2.3842e-03
*****************************************************************************

  Execution time = 2.3025e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
ci_001                -4.245425e-02 3 1  ON 0
ci_002                -3.247222e-02 3 1  ON 1
ci_003                -2.708032e-02 3 1  ON 2
ci_004                 2.301162e-02 3 1  ON 3
ci_005                 2.402138e-02 3 1  ON 4
ci_006                -2.120902e-02 3 1  ON 5
ci_007                -2.091190e-02 3 1  ON 6
ci_008                -8.523113e-03 3 1  ON 7
ci_009                -1.418757e-02 3 1  ON 8
ci_010                -1.015744e-02 3 1  ON 9
ci_011                -1.214573e-02 3 1  ON 10
ci_012                -7.952574e-03 3 1  ON 11
ci_013                -1.867297e-02 3 1  ON 12
ci_014                 1.348928e-02 3 1  ON 13
ci_015                 1.438583e-02 3 1  ON 14
ci_016                 1.623438e-02 3 1  ON 15
ci_017                 1.671254e-02 3 1  ON 16
ci_018                 1.087815e-02 3 1  ON 17
ci_019                 1.220865e-02 3 1  ON 18
ci_020                 1.919707e-02 3 1  ON 19
ci_021                 1.684063e-02 3 1  ON 20
ci_022                 9.845334e-03 3 1  ON 21
ci_023                 9.251565e-03 3 1  ON 22
ci_024                 1.137709e-02 3 1  ON 23
ci_025                 1.001684e-02 3 1  ON 24
ci_026                 1.407765e-02 3 1  ON 25
ci_027                 1.181320e-02 3 1  ON 26
ci_028                -1.420548e-02 3 1  ON 27
ci_029                -1.737813e-02 3 1  ON 28
ci_030                -9.793412e-03 3 1  ON 29
ci_031                -7.049248e-03 3 1  ON 30
ci_032                -1.428500e-02 3 1  ON 31
ci_033                 4.975376e-03 3 1  ON 32
ci_034                 4.720007e-03 3 1  ON 33
ci_035                -5.957684e-03 3 1  ON 34
ci_036                -1.290851e-02 3 1  ON 35
ci_037                -1.163812e-02 3 1  ON 36
ci_038                 1.846882e-03 3 1  ON 37
ci_039                 2.726459e-03 3 1  ON 38
ci_040                -3.550910e-03 3 1  ON 39
ci_041                 8.184082e-03 3 1  ON 40
ci_042                 6.566853e-03 3 1  ON 41
ci_043                -4.489473e-03 3 1  ON 42
ci_044                -4.072039e-03 3 1  ON 43
ci_045                -4.124274e-03 3 1  ON 44
ci_046                 5.439049e-03 3 1  ON 45
ci_047                 6.075453e-03 3 1  ON 46
ci_048                -1.213574e-02 3 1  ON 47
ci_049                -1.314979e-02 3 1  ON 48
ci_050                 3.811408e-03 3 1  ON 49
ci_051                 3.024416e-03 3 1  ON 50
ci_052                -3.322110e-03 3 1  ON 51
ci_053                -2.302271e-03 3 1  ON 52
ci_054                -3.121317e-03 3 1  ON 53
ci_055                -2.206667e-03 3 1  ON 54
ci_056                 5.022705e-03 3 1  ON 55
ci_057                 6.734306e-03 3 1  ON 56
ci_058                -2.585487e-03 3 1  ON 57
ci_059                -1.840541e-03 3 1  ON 58
ci_060                 4.246554e-03 3 1  ON 59
ci_061                 5.248396e-03 3 1  ON 60
ci_062                -2.864166e-03 3 1  ON 61
ci_063                -4.115853e-03 3 1  ON 62
ci_064                -3.157085e-03 3 1  ON 63
ci_065                -3.872064e-03 3 1  ON 64
ci_066                 4.301987e-03 3 1  ON 65
ci_067                 3.895639e-03 3 1  ON 66
ci_068                -5.718682e-03 3 1  ON 67
ci_069                -5.392164e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9498e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.2452
    reference variance = 0.359903
====================================================
  Execution time = 1.4010e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8833e-01
  Total weights = 1.957502258e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5133e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276819637764
                                         uncertainty =       0.001694819850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276819637764
                                         uncertainty =       0.001694819850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371997073
  error estimate for blocks of size 2^( 2) =       0.000385746862
  error estimate for blocks of size 2^( 3) =       0.000398048933
  error estimate for blocks of size 2^( 4) =       0.000407279385
  error estimate for blocks of size 2^( 5) =       0.000411871110
  error estimate for blocks of size 2^( 6) =       0.000414239437
  error estimate for blocks of size 2^( 7) =       0.000417346237

      target function =      -0.915826216036
              le_mean =     -17.212284411299
             les_mean =     296.551060523707
             stat err =       0.000412684042
             autocorr =       1.230711634740
   target nu stat err =       0.000412684042
   target dn stat err =       0.002116767099
      target stat err =       0.002815930685
              std dev =       0.526083305600
             le_variance =       0.276763644431


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721228441130e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-05, overlap shift 5.9605e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915834052326       residual = 1.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916795197279       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916939301272       residual = 6.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916973803950       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916978429578       residual = 4.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916980796243       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916981705737       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916982238154       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916981953791       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916981699248       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916981814652       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916981729435       residual = 7.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-05 is 2.264770e-03

solving harmonic davidson linear method for identity shift 2.3842e-04, overlap shift 2.3842e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915834052326       residual = 1.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916793005770       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916936706707       residual = 6.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916971088768       residual = 1.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916975690344       residual = 4.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916978042513       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916978949102       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916979478427       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916979195616       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916978942166       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916979056997       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916978972258       residual = 7.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-04 is 2.259068e-03

solving harmonic davidson linear method for identity shift 9.5367e-04, overlap shift 9.5367e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915834052326       residual = 1.95e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916784338652       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916926449188       residual = 6.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916960356599       residual = 1.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916964863960       residual = 4.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916967159478       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916968054621       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916968571882       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916968295128       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916968045980       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916968158564       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916968075694       residual = 7.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-04 is 2.236542e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.537334 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6542e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
ci_001                -4.192095e-02 3 1  ON 0
ci_002                -3.248996e-02 3 1  ON 1
ci_003                -2.581959e-02 3 1  ON 2
ci_004                 2.518252e-02 3 1  ON 3
ci_005                 2.428412e-02 3 1  ON 4
ci_006                -2.158726e-02 3 1  ON 5
ci_007                -2.152470e-02 3 1  ON 6
ci_008                -9.572263e-03 3 1  ON 7
ci_009                -1.557092e-02 3 1  ON 8
ci_010                -9.272629e-03 3 1  ON 9
ci_011                -9.886662e-03 3 1  ON 10
ci_012                -9.683933e-03 3 1  ON 11
ci_013                -1.959108e-02 3 1  ON 12
ci_014                 1.292167e-02 3 1  ON 13
ci_015                 1.310152e-02 3 1  ON 14
ci_016                 1.687327e-02 3 1  ON 15
ci_017                 1.768733e-02 3 1  ON 16
ci_018                 1.038255e-02 3 1  ON 17
ci_019                 1.127875e-02 3 1  ON 18
ci_020                 1.737689e-02 3 1  ON 19
ci_021                 1.767104e-02 3 1  ON 20
ci_022                 9.949513e-03 3 1  ON 21
ci_023                 1.066165e-02 3 1  ON 22
ci_024                 9.484607e-03 3 1  ON 23
ci_025                 1.016705e-02 3 1  ON 24
ci_026                 1.252636e-02 3 1  ON 25
ci_027                 1.143819e-02 3 1  ON 26
ci_028                -1.604189e-02 3 1  ON 27
ci_029                -1.692097e-02 3 1  ON 28
ci_030                -9.214376e-03 3 1  ON 29
ci_031                -9.210318e-03 3 1  ON 30
ci_032                -1.478210e-02 3 1  ON 31
ci_033                 5.221004e-03 3 1  ON 32
ci_034                 4.507569e-03 3 1  ON 33
ci_035                -5.075202e-03 3 1  ON 34
ci_036                -1.312378e-02 3 1  ON 35
ci_037                -1.335770e-02 3 1  ON 36
ci_038                 2.032328e-03 3 1  ON 37
ci_039                 1.937296e-03 3 1  ON 38
ci_040                -3.304816e-03 3 1  ON 39
ci_041                 7.990758e-03 3 1  ON 40
ci_042                 8.300168e-03 3 1  ON 41
ci_043                -4.376064e-03 3 1  ON 42
ci_044                -3.995163e-03 3 1  ON 43
ci_045                -2.909348e-03 3 1  ON 44
ci_046                 5.186083e-03 3 1  ON 45
ci_047                 6.455771e-03 3 1  ON 46
ci_048                -1.225014e-02 3 1  ON 47
ci_049                -1.432734e-02 3 1  ON 48
ci_050                 3.490023e-03 3 1  ON 49
ci_051                 2.854375e-03 3 1  ON 50
ci_052                -2.031759e-03 3 1  ON 51
ci_053                -2.233956e-03 3 1  ON 52
ci_054                -3.080989e-03 3 1  ON 53
ci_055                -2.508418e-03 3 1  ON 54
ci_056                 5.316818e-03 3 1  ON 55
ci_057                 5.918345e-03 3 1  ON 56
ci_058                -1.918501e-03 3 1  ON 57
ci_059                -2.615235e-03 3 1  ON 58
ci_060                 5.840878e-03 3 1  ON 59
ci_061                 4.948966e-03 3 1  ON 60
ci_062                -3.766218e-03 3 1  ON 61
ci_063                -4.111176e-03 3 1  ON 62
ci_064                -3.641470e-03 3 1  ON 63
ci_065                -3.746135e-03 3 1  ON 64
ci_066                 4.831622e-03 3 1  ON 65
ci_067                 4.749996e-03 3 1  ON 66
ci_068                -5.968599e-03 3 1  ON 67
ci_069                -5.416143e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.1473
    reference variance = 0.192224
====================================================
  Execution time = 1.3754e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8788e-01
  Total weights = 1.9572e+06
  Execution time = 1.8541e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000130466
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278477014634
                                         uncertainty =       0.001635652275

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278477014634
                                         uncertainty =       0.001635652275

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373155278
  error estimate for blocks of size 2^( 2) =       0.000386571679
  error estimate for blocks of size 2^( 3) =       0.000398933293
  error estimate for blocks of size 2^( 4) =       0.000408161944
  error estimate for blocks of size 2^( 5) =       0.000412325870
  error estimate for blocks of size 2^( 6) =       0.000415979490
  error estimate for blocks of size 2^( 7) =       0.000417690134

      target function =      -0.888232719016
              le_mean =     -17.212588599566
             les_mean =     296.583341524638
             stat err =       0.000413539359
             autocorr =       1.228158799319
   target nu stat err =       0.000413539359
   target dn stat err =       0.009042627035
      target stat err =       0.011088946039
              std dev =       0.527721254905
             le_variance =       0.278489722878

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276452018580
                                         uncertainty =       0.001595710701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276452018580
                                         uncertainty =       0.001595710701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371794083
  error estimate for blocks of size 2^( 2) =       0.000385244663
  error estimate for blocks of size 2^( 3) =       0.000397682117
  error estimate for blocks of size 2^( 4) =       0.000406947732
  error estimate for blocks of size 2^( 5) =       0.000411139093
  error estimate for blocks of size 2^( 6) =       0.000414663367
  error estimate for blocks of size 2^( 7) =       0.000416382444

      target function =      -0.916445098574
              le_mean =     -17.212427040891
             les_mean =     296.555523741756
             stat err =       0.000412283159
             autocorr =       1.229663387655
   target nu stat err =       0.000412283159
   target dn stat err =       0.002058503686
      target stat err =       0.002745935296
              std dev =       0.525796234210
             le_variance =       0.276461679909

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00013073
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278185541704
                                         uncertainty =       0.001632083666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278185541704
                                         uncertainty =       0.001632083666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372955288
  error estimate for blocks of size 2^( 2) =       0.000386388575
  error estimate for blocks of size 2^( 3) =       0.000398795869
  error estimate for blocks of size 2^( 4) =       0.000408087218
  error estimate for blocks of size 2^( 5) =       0.000412305310
  error estimate for blocks of size 2^( 6) =       0.000415770438
  error estimate for blocks of size 2^( 7) =       0.000417563161

      target function =      -0.889130879688
              le_mean =     -17.212541611602
             les_mean =     296.580994236797
             stat err =       0.000413431532
             autocorr =       1.228835229834
   target nu stat err =       0.000413431532
   target dn stat err =       0.008604483340
      target stat err =       0.010573495754
              std dev =       0.527438427038
             le_variance =       0.278191294317

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276452229196
                                         uncertainty =       0.001595741274

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276452229196
                                         uncertainty =       0.001595741274

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371794253
  error estimate for blocks of size 2^( 2) =       0.000385244820
  error estimate for blocks of size 2^( 3) =       0.000397681938
  error estimate for blocks of size 2^( 4) =       0.000406947166
  error estimate for blocks of size 2^( 5) =       0.000411138342
  error estimate for blocks of size 2^( 6) =       0.000414663686
  error estimate for blocks of size 2^( 7) =       0.000416382510

      target function =      -0.916446345483
              le_mean =     -17.212427370443
             les_mean =     296.555534209771
             stat err =       0.000412282926
             autocorr =       1.229660874252
   target nu stat err =       0.000412282926
   target dn stat err =       0.002055929796
      target stat err =       0.002742667034
              std dev =       0.525796474812
             le_variance =       0.276461932925


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.888232719016        initial
     5.9605e-05     5.9605e-04             2.2648e-03        -0.916445098574
     2.3842e-04     2.3842e-03             2.2591e-03        -0.889130879688
     9.5367e-04     9.5367e-03             2.2365e-03        -0.916446345483  <--

*****************************************************************************
Applying the update for shift_i =   9.5367e-04     and shift_s =   9.5367e-03
*****************************************************************************

  Execution time = 2.3109e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
ci_001                -4.192831e-02 3 1  ON 0
ci_002                -3.249025e-02 3 1  ON 1
ci_003                -2.583172e-02 3 1  ON 2
ci_004                 2.515998e-02 3 1  ON 3
ci_005                 2.428179e-02 3 1  ON 4
ci_006                -2.158360e-02 3 1  ON 5
ci_007                -2.151776e-02 3 1  ON 6
ci_008                -9.562982e-03 3 1  ON 7
ci_009                -1.555768e-02 3 1  ON 8
ci_010                -9.281501e-03 3 1  ON 9
ci_011                -9.909188e-03 3 1  ON 10
ci_012                -9.667059e-03 3 1  ON 11
ci_013                -1.957938e-02 3 1  ON 12
ci_014                 1.292826e-02 3 1  ON 13
ci_015                 1.311519e-02 3 1  ON 14
ci_016                 1.686587e-02 3 1  ON 15
ci_017                 1.767644e-02 3 1  ON 16
ci_018                 1.038671e-02 3 1  ON 17
ci_019                 1.128921e-02 3 1  ON 18
ci_020                 1.739871e-02 3 1  ON 19
ci_021                 1.766360e-02 3 1  ON 20
ci_022                 9.948495e-03 3 1  ON 21
ci_023                 1.064616e-02 3 1  ON 22
ci_024                 9.505035e-03 3 1  ON 23
ci_025                 1.016547e-02 3 1  ON 24
ci_026                 1.253904e-02 3 1  ON 25
ci_027                 1.144180e-02 3 1  ON 26
ci_028                -1.602086e-02 3 1  ON 27
ci_029                -1.692469e-02 3 1  ON 28
ci_030                -9.219700e-03 3 1  ON 29
ci_031                -9.188964e-03 3 1  ON 30
ci_032                -1.477705e-02 3 1  ON 31
ci_033                 5.218480e-03 3 1  ON 32
ci_034                 4.510284e-03 3 1  ON 33
ci_035                -5.083471e-03 3 1  ON 34
ci_036                -1.312217e-02 3 1  ON 35
ci_037                -1.334279e-02 3 1  ON 36
ci_038                 2.030619e-03 3 1  ON 37
ci_039                 1.944585e-03 3 1  ON 38
ci_040                -3.307027e-03 3 1  ON 39
ci_041                 7.990718e-03 3 1  ON 40
ci_042                 8.284425e-03 3 1  ON 41
ci_043                -4.377122e-03 3 1  ON 42
ci_044                -3.995820e-03 3 1  ON 43
ci_045                -2.920269e-03 3 1  ON 44
ci_046                 5.188726e-03 3 1  ON 45
ci_047                 6.451905e-03 3 1  ON 46
ci_048                -1.224957e-02 3 1  ON 47
ci_049                -1.431140e-02 3 1  ON 48
ci_050                 3.492685e-03 3 1  ON 49
ci_051                 2.855803e-03 3 1  ON 50
ci_052                -2.044387e-03 3 1  ON 51
ci_053                -2.234662e-03 3 1  ON 52
ci_054                -3.080813e-03 3 1  ON 53
ci_055                -2.505778e-03 3 1  ON 54
ci_056                 5.313980e-03 3 1  ON 55
ci_057                 5.926234e-03 3 1  ON 56
ci_058                -1.923813e-03 3 1  ON 57
ci_059                -2.607537e-03 3 1  ON 58
ci_060                 5.824615e-03 3 1  ON 59
ci_061                 4.952040e-03 3 1  ON 60
ci_062                -3.758448e-03 3 1  ON 61
ci_063                -4.111151e-03 3 1  ON 62
ci_064                -3.637149e-03 3 1  ON 63
ci_065                -3.747298e-03 3 1  ON 64
ci_066                 4.826577e-03 3 1  ON 65
ci_067                 4.741810e-03 3 1  ON 66
ci_068                -5.966250e-03 3 1  ON 67
ci_069                -5.415951e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9666e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.2122
    reference variance = 0.186982
====================================================
  Execution time = 1.3980e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5252e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8878e-01
  Total weights = 1.957372332e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4901e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277912451244
                                         uncertainty =       0.002061391052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277912451244
                                         uncertainty =       0.002061391052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372707923
  error estimate for blocks of size 2^( 2) =       0.000386465921
  error estimate for blocks of size 2^( 3) =       0.000399068362
  error estimate for blocks of size 2^( 4) =       0.000408064285
  error estimate for blocks of size 2^( 5) =       0.000412851741
  error estimate for blocks of size 2^( 6) =       0.000414059328
  error estimate for blocks of size 2^( 7) =       0.000415027601

      target function =      -0.915146259738
              le_mean =     -17.211963864513
             les_mean =     296.540484308724
             stat err =       0.000412500739
             autocorr =       1.224932650596
   target nu stat err =       0.000412500739
   target dn stat err =       0.002350128330
      target stat err =       0.003107426879
              std dev =       0.527088600133
             le_variance =       0.277822392390


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721196386451e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-04, overlap shift 2.3842e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915156044695       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915734134641       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915831263395       residual = 5.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915872400488       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915883710126       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915884672988       residual = 7.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915885679987       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915885900086       residual = 5.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915886242755       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915886367059       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915886385620       residual = 6.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-04 is 2.351467e-03

solving harmonic davidson linear method for identity shift 9.5367e-04, overlap shift 9.5367e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915156044695       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915728920292       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915824973784       residual = 5.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915865529577       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915876647381       residual = 3.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915877578806       residual = 7.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915878565814       residual = 1.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915878780196       residual = 5.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915879115478       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915879236640       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915879254639       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-04 is 2.325789e-03

solving harmonic davidson linear method for identity shift 3.8147e-03, overlap shift 3.8147e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915156044695       residual = 1.10e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915708970195       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915800946325       residual = 5.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915839322652       residual = 9.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915849727869       residual = 3.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915850546166       residual = 7.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915851459681       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915851653442       residual = 4.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915851961546       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915852071475       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915852087398       residual = 5.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-03 is 2.228546e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.546321 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6487e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
ci_001                -4.283415e-02 3 1  ON 0
ci_002                -3.295253e-02 3 1  ON 1
ci_003                -2.694217e-02 3 1  ON 2
ci_004                 2.307519e-02 3 1  ON 3
ci_005                 2.404252e-02 3 1  ON 4
ci_006                -2.185868e-02 3 1  ON 5
ci_007                -2.245144e-02 3 1  ON 6
ci_008                -9.089374e-03 3 1  ON 7
ci_009                -1.525577e-02 3 1  ON 8
ci_010                -8.281947e-03 3 1  ON 9
ci_011                -1.143016e-02 3 1  ON 10
ci_012                -1.124785e-02 3 1  ON 11
ci_013                -1.943133e-02 3 1  ON 12
ci_014                 1.223070e-02 3 1  ON 13
ci_015                 1.233008e-02 3 1  ON 14
ci_016                 1.649061e-02 3 1  ON 15
ci_017                 1.752301e-02 3 1  ON 16
ci_018                 1.090193e-02 3 1  ON 17
ci_019                 1.141073e-02 3 1  ON 18
ci_020                 1.793602e-02 3 1  ON 19
ci_021                 1.640483e-02 3 1  ON 20
ci_022                 1.042295e-02 3 1  ON 21
ci_023                 1.012237e-02 3 1  ON 22
ci_024                 8.057285e-03 3 1  ON 23
ci_025                 9.600769e-03 3 1  ON 24
ci_026                 1.214715e-02 3 1  ON 25
ci_027                 1.268477e-02 3 1  ON 26
ci_028                -1.369508e-02 3 1  ON 27
ci_029                -1.473013e-02 3 1  ON 28
ci_030                -9.025617e-03 3 1  ON 29
ci_031                -9.195984e-03 3 1  ON 30
ci_032                -1.452604e-02 3 1  ON 31
ci_033                 5.004219e-03 3 1  ON 32
ci_034                 4.993936e-03 3 1  ON 33
ci_035                -5.499839e-03 3 1  ON 34
ci_036                -1.271977e-02 3 1  ON 35
ci_037                -1.332493e-02 3 1  ON 36
ci_038                 2.178480e-03 3 1  ON 37
ci_039                 2.546650e-03 3 1  ON 38
ci_040                -3.099770e-03 3 1  ON 39
ci_041                 8.955063e-03 3 1  ON 40
ci_042                 9.200913e-03 3 1  ON 41
ci_043                -4.287388e-03 3 1  ON 42
ci_044                -4.951338e-03 3 1  ON 43
ci_045                -2.831219e-03 3 1  ON 44
ci_046                 6.153623e-03 3 1  ON 45
ci_047                 5.876845e-03 3 1  ON 46
ci_048                -1.191379e-02 3 1  ON 47
ci_049                -1.363360e-02 3 1  ON 48
ci_050                 2.935134e-03 3 1  ON 49
ci_051                 2.922375e-03 3 1  ON 50
ci_052                -2.275521e-03 3 1  ON 51
ci_053                -3.113352e-03 3 1  ON 52
ci_054                -2.839439e-03 3 1  ON 53
ci_055                -2.827879e-03 3 1  ON 54
ci_056                 5.501701e-03 3 1  ON 55
ci_057                 5.339827e-03 3 1  ON 56
ci_058                -2.472546e-03 3 1  ON 57
ci_059                -2.158364e-03 3 1  ON 58
ci_060                 5.289682e-03 3 1  ON 59
ci_061                 5.268332e-03 3 1  ON 60
ci_062                -4.152654e-03 3 1  ON 61
ci_063                -4.228775e-03 3 1  ON 62
ci_064                -3.583693e-03 3 1  ON 63
ci_065                -3.847700e-03 3 1  ON 64
ci_066                 4.605027e-03 3 1  ON 65
ci_067                 4.052964e-03 3 1  ON 66
ci_068                -5.723234e-03 3 1  ON 67
ci_069                -4.454591e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.2171
    reference variance = 0.246477
====================================================
  Execution time = 1.3825e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8744e-01
  Total weights = 1.9571e+06
  Execution time = 1.8505e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275245487678
                                         uncertainty =       0.001709716254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275245487678
                                         uncertainty =       0.001709716254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370943330
  error estimate for blocks of size 2^( 2) =       0.000384994813
  error estimate for blocks of size 2^( 3) =       0.000397374233
  error estimate for blocks of size 2^( 4) =       0.000406737205
  error estimate for blocks of size 2^( 5) =       0.000411052081
  error estimate for blocks of size 2^( 6) =       0.000415016465
  error estimate for blocks of size 2^( 7) =       0.000418807811

      target function =      -0.832829545358
              le_mean =     -17.211150577306
             les_mean =     296.580129702368
             stat err =       0.000412903391
             autocorr =       1.239029840737
   target nu stat err =       0.000412903391
   target dn stat err =       0.038838863925
      target stat err =       0.041825322193
              std dev =       0.524593087939
             le_variance =       0.275197907913

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274136386614
                                         uncertainty =       0.001454558096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274136386614
                                         uncertainty =       0.001454558096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370196581
  error estimate for blocks of size 2^( 2) =       0.000384278894
  error estimate for blocks of size 2^( 3) =       0.000396670782
  error estimate for blocks of size 2^( 4) =       0.000405991485
  error estimate for blocks of size 2^( 5) =       0.000410298246
  error estimate for blocks of size 2^( 6) =       0.000414219468
  error estimate for blocks of size 2^( 7) =       0.000417934245

      target function =      -0.916634116429
              le_mean =     -17.211043221980
             les_mean =     296.507463339884
             stat err =       0.000412110861
             autocorr =       1.239262518007
   target nu stat err =       0.000412110861
   target dn stat err =       0.002596712878
      target stat err =       0.003428427942
              std dev =       0.523537025168
             le_variance =       0.274091016722

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278173156448
                                         uncertainty =       0.002457375134

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278173156448
                                         uncertainty =       0.002457375134

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372905861
  error estimate for blocks of size 2^( 2) =       0.000386893032
  error estimate for blocks of size 2^( 3) =       0.000399301395
  error estimate for blocks of size 2^( 4) =       0.000408592804
  error estimate for blocks of size 2^( 5) =       0.000412784061
  error estimate for blocks of size 2^( 6) =       0.000416576351
  error estimate for blocks of size 2^( 7) =       0.000420399746

      target function =      -0.827036921713
              le_mean =     -17.211100228200
             les_mean =     296.583176754022
             stat err =       0.000414588240
             autocorr =       1.236048584149
   target nu stat err =       0.000414588240
   target dn stat err =       0.045000975113
      target stat err =       0.047823663218
              std dev =       0.527368525442
             le_variance =       0.278117561627

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274098224742
                                         uncertainty =       0.001455480031

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274098224742
                                         uncertainty =       0.001455480031

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370170860
  error estimate for blocks of size 2^( 2) =       0.000384253213
  error estimate for blocks of size 2^( 3) =       0.000396646049
  error estimate for blocks of size 2^( 4) =       0.000405968746
  error estimate for blocks of size 2^( 5) =       0.000410276596
  error estimate for blocks of size 2^( 6) =       0.000414200954
  error estimate for blocks of size 2^( 7) =       0.000417919432

      target function =      -0.916640140953
              le_mean =     -17.211043146379
             les_mean =     296.507456114057
             stat err =       0.000412091432
             autocorr =       1.239317878498
   target nu stat err =       0.000412091432
   target dn stat err =       0.002593624126
      target stat err =       0.003424507774
              std dev =       0.523500650140
             le_variance =       0.274052930697


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.832829545358        initial
     2.3842e-04     2.3842e-03             2.3515e-03        -0.916634116429
     9.5367e-04     9.5367e-03             2.3258e-03        -0.827036921713
     3.8147e-03     3.8147e-02             2.2285e-03        -0.916640140953  <--

*****************************************************************************
Applying the update for shift_i =   3.8147e-03     and shift_s =   3.8147e-02
*****************************************************************************

  Execution time = 2.3169e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
ci_001                -4.279158e-02 3 1  ON 0
ci_002                -3.293122e-02 3 1  ON 1
ci_003                -2.689387e-02 3 1  ON 2
ci_004                 2.316758e-02 3 1  ON 3
ci_005                 2.404582e-02 3 1  ON 4
ci_006                -2.184495e-02 3 1  ON 5
ci_007                -2.240753e-02 3 1  ON 6
ci_008                -9.103733e-03 3 1  ON 7
ci_009                -1.526730e-02 3 1  ON 8
ci_010                -8.322105e-03 3 1  ON 9
ci_011                -1.137159e-02 3 1  ON 10
ci_012                -1.118756e-02 3 1  ON 11
ci_013                -1.943995e-02 3 1  ON 12
ci_014                 1.225783e-02 3 1  ON 13
ci_015                 1.236364e-02 3 1  ON 14
ci_016                 1.650970e-02 3 1  ON 15
ci_017                 1.752952e-02 3 1  ON 16
ci_018                 1.088617e-02 3 1  ON 17
ci_019                 1.140365e-02 3 1  ON 18
ci_020                 1.791071e-02 3 1  ON 19
ci_021                 1.645428e-02 3 1  ON 20
ci_022                 1.040523e-02 3 1  ON 21
ci_023                 1.014289e-02 3 1  ON 22
ci_024                 8.115785e-03 3 1  ON 23
ci_025                 9.622325e-03 3 1  ON 24
ci_026                 1.216956e-02 3 1  ON 25
ci_027                 1.263987e-02 3 1  ON 26
ci_028                -1.379232e-02 3 1  ON 27
ci_029                -1.482012e-02 3 1  ON 28
ci_030                -9.033583e-03 3 1  ON 29
ci_031                -9.197873e-03 3 1  ON 30
ci_032                -1.453702e-02 3 1  ON 31
ci_033                 5.011302e-03 3 1  ON 32
ci_034                 4.970278e-03 3 1  ON 33
ci_035                -5.484681e-03 3 1  ON 34
ci_036                -1.272935e-02 3 1  ON 35
ci_037                -1.332114e-02 3 1  ON 36
ci_038                 2.173237e-03 3 1  ON 37
ci_039                 2.525228e-03 3 1  ON 38
ci_040                -3.107071e-03 3 1  ON 39
ci_041                 8.929044e-03 3 1  ON 40
ci_042                 9.175422e-03 3 1  ON 41
ci_043                -4.290937e-03 3 1  ON 42
ci_044                -4.915290e-03 3 1  ON 43
ci_045                -2.834100e-03 3 1  ON 44
ci_046                 6.115211e-03 3 1  ON 45
ci_047                 5.899873e-03 3 1  ON 46
ci_048                -1.193078e-02 3 1  ON 47
ci_049                -1.366275e-02 3 1  ON 48
ci_050                 2.953372e-03 3 1  ON 49
ci_051                 2.919925e-03 3 1  ON 50
ci_052                -2.266087e-03 3 1  ON 51
ci_053                -3.083613e-03 3 1  ON 52
ci_054                -2.848554e-03 3 1  ON 53
ci_055                -2.815373e-03 3 1  ON 54
ci_056                 5.494974e-03 3 1  ON 55
ci_057                 5.361607e-03 3 1  ON 56
ci_058                -2.450475e-03 3 1  ON 57
ci_059                -2.172145e-03 3 1  ON 58
ci_060                 5.310581e-03 3 1  ON 59
ci_061                 5.255496e-03 3 1  ON 60
ci_062                -4.140618e-03 3 1  ON 61
ci_063                -4.224903e-03 3 1  ON 62
ci_064                -3.585502e-03 3 1  ON 63
ci_065                -3.844212e-03 3 1  ON 64
ci_066                 4.612955e-03 3 1  ON 65
ci_067                 4.078055e-03 3 1  ON 66
ci_068                -5.732705e-03 3 1  ON 67
ci_069                -4.492978e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9671e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.2022
    reference variance = 0.364822
====================================================
  Execution time = 1.6150e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5255e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8667e-01
  Total weights = 1.957243091e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5139e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275452670994
                                         uncertainty =       0.001526938793

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275452670994
                                         uncertainty =       0.001526938793

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371089260
  error estimate for blocks of size 2^( 2) =       0.000384636741
  error estimate for blocks of size 2^( 3) =       0.000396952114
  error estimate for blocks of size 2^( 4) =       0.000405279235
  error estimate for blocks of size 2^( 5) =       0.000410601390
  error estimate for blocks of size 2^( 6) =       0.000413106696
  error estimate for blocks of size 2^( 7) =       0.000413918612

      target function =      -0.917709963704
              le_mean =     -17.211215583676
             les_mean =     296.512607300008
             stat err =       0.000410726483
             autocorr =       1.225035412401
   target nu stat err =       0.000410726483
   target dn stat err =       0.002298296591
      target stat err =       0.003054070726
              std dev =       0.524799464054
             le_variance =       0.275414477472


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721121558368e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e-04, overlap shift 9.5367e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917719356719       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918344730695       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918448965514       residual = 5.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918486957832       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918496803778       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918498800713       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918499856849       residual = 2.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918499296495       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918499365647       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918499357946       residual = 3.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918499355796       residual = 7.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-04 is 2.322248e-03

solving harmonic davidson linear method for identity shift 3.8147e-03, overlap shift 3.8147e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917719356719       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918322861849       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918422576644       residual = 5.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918458425009       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918467688629       residual = 3.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918469509297       residual = 9.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918470492129       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918469961555       residual = 6.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918470024757       residual = 1.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918470020130       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918470018528       residual = 6.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-03 is 2.219411e-03

solving harmonic davidson linear method for identity shift 1.5259e-02, overlap shift 1.5259e-01 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917719356719       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918248796756       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918333716773       residual = 5.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918362853309       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918370321319       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918371633397       residual = 8.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918372397728       residual = 1.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918371963934       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918372009559       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918372012473       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918372012275       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e-02 is 1.926465e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.550419 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8673e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
ci_001                -4.258267e-02 3 1  ON 0
ci_002                -3.256948e-02 3 1  ON 1
ci_003                -2.711708e-02 3 1  ON 2
ci_004                 2.441742e-02 3 1  ON 3
ci_005                 2.429328e-02 3 1  ON 4
ci_006                -2.155166e-02 3 1  ON 5
ci_007                -2.072839e-02 3 1  ON 6
ci_008                -8.611123e-03 3 1  ON 7
ci_009                -1.421869e-02 3 1  ON 8
ci_010                -9.517675e-03 3 1  ON 9
ci_011                -1.079297e-02 3 1  ON 10
ci_012                -1.114921e-02 3 1  ON 11
ci_013                -1.913832e-02 3 1  ON 12
ci_014                 1.314758e-02 3 1  ON 13
ci_015                 1.376859e-02 3 1  ON 14
ci_016                 1.706064e-02 3 1  ON 15
ci_017                 1.717445e-02 3 1  ON 16
ci_018                 1.043782e-02 3 1  ON 17
ci_019                 1.109737e-02 3 1  ON 18
ci_020                 1.744123e-02 3 1  ON 19
ci_021                 1.736902e-02 3 1  ON 20
ci_022                 1.003773e-02 3 1  ON 21
ci_023                 9.730045e-03 3 1  ON 22
ci_024                 9.763210e-03 3 1  ON 23
ci_025                 1.058799e-02 3 1  ON 24
ci_026                 1.223572e-02 3 1  ON 25
ci_027                 1.043190e-02 3 1  ON 26
ci_028                -1.601173e-02 3 1  ON 27
ci_029                -1.646946e-02 3 1  ON 28
ci_030                -9.943103e-03 3 1  ON 29
ci_031                -9.277248e-03 3 1  ON 30
ci_032                -1.423496e-02 3 1  ON 31
ci_033                 5.059698e-03 3 1  ON 32
ci_034                 4.966575e-03 3 1  ON 33
ci_035                -5.157408e-03 3 1  ON 34
ci_036                -1.355583e-02 3 1  ON 35
ci_037                -1.263855e-02 3 1  ON 36
ci_038                 2.005203e-03 3 1  ON 37
ci_039                 2.300515e-03 3 1  ON 38
ci_040                -3.460724e-03 3 1  ON 39
ci_041                 9.480717e-03 3 1  ON 40
ci_042                 9.097858e-03 3 1  ON 41
ci_043                -4.333151e-03 3 1  ON 42
ci_044                -6.435446e-03 3 1  ON 43
ci_045                -3.844271e-03 3 1  ON 44
ci_046                 6.148552e-03 3 1  ON 45
ci_047                 5.430400e-03 3 1  ON 46
ci_048                -1.310530e-02 3 1  ON 47
ci_049                -1.353022e-02 3 1  ON 48
ci_050                 3.904106e-03 3 1  ON 49
ci_051                 3.601337e-03 3 1  ON 50
ci_052                -2.668278e-03 3 1  ON 51
ci_053                -2.920103e-03 3 1  ON 52
ci_054                -3.517766e-03 3 1  ON 53
ci_055                -3.117284e-03 3 1  ON 54
ci_056                 5.711629e-03 3 1  ON 55
ci_057                 6.630414e-03 3 1  ON 56
ci_058                -1.477071e-03 3 1  ON 57
ci_059                -2.574867e-03 3 1  ON 58
ci_060                 5.072743e-03 3 1  ON 59
ci_061                 4.448940e-03 3 1  ON 60
ci_062                -3.853380e-03 3 1  ON 61
ci_063                -3.204692e-03 3 1  ON 62
ci_064                -3.140072e-03 3 1  ON 63
ci_065                -3.986129e-03 3 1  ON 64
ci_066                 4.401260e-03 3 1  ON 65
ci_067                 5.304595e-03 3 1  ON 66
ci_068                -5.315431e-03 3 1  ON 67
ci_069                -5.120063e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.208
    reference variance = 0.354713
====================================================
  Execution time = 1.3553e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8913e-01
  Total weights = 1.9568e+06
  Execution time = 1.8567e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278099078089
                                         uncertainty =       0.001724345850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278099078089
                                         uncertainty =       0.001724345850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372900639
  error estimate for blocks of size 2^( 2) =       0.000386825976
  error estimate for blocks of size 2^( 3) =       0.000399630453
  error estimate for blocks of size 2^( 4) =       0.000408226439
  error estimate for blocks of size 2^( 5) =       0.000413545079
  error estimate for blocks of size 2^( 6) =       0.000415086369
  error estimate for blocks of size 2^( 7) =       0.000417729883

      target function =      -0.828829691553
              le_mean =     -17.212027057481
             les_mean =     296.614525206855
             stat err =       0.000413646943
             autocorr =       1.230476665880
   target nu stat err =       0.000413646943
   target dn stat err =       0.034619197564
      target stat err =       0.036955181675
              std dev =       0.527361140950
             le_variance =       0.278109772984

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275771777095
                                         uncertainty =       0.001456379349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275771777095
                                         uncertainty =       0.001456379349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371337211
  error estimate for blocks of size 2^( 2) =       0.000385290030
  error estimate for blocks of size 2^( 3) =       0.000398116624
  error estimate for blocks of size 2^( 4) =       0.000406765173
  error estimate for blocks of size 2^( 5) =       0.000412093453
  error estimate for blocks of size 2^( 6) =       0.000413679425
  error estimate for blocks of size 2^( 7) =       0.000416225175

      target function =      -0.914475033765
              le_mean =     -17.211975041318
             les_mean =     296.541383974332
             stat err =       0.000412190807
             autocorr =       1.232138872735
   target nu stat err =       0.000412190807
   target dn stat err =       0.002945554093
      target stat err =       0.003863944846
              std dev =       0.525150120197
             le_variance =       0.275782648743

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277198548958
                                         uncertainty =       0.001503602052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277198548958
                                         uncertainty =       0.001503602052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372294128
  error estimate for blocks of size 2^( 2) =       0.000386205739
  error estimate for blocks of size 2^( 3) =       0.000398984080
  error estimate for blocks of size 2^( 4) =       0.000407589911
  error estimate for blocks of size 2^( 5) =       0.000412960920
  error estimate for blocks of size 2^( 6) =       0.000414573307
  error estimate for blocks of size 2^( 7) =       0.000416961603

      target function =      -0.883978382669
              le_mean =     -17.212066547425
             les_mean =     296.568482684841
             stat err =       0.000413021435
             autocorr =       1.230758401360
   target nu stat err =       0.000413021435
   target dn stat err =       0.017262546164
      target stat err =       0.020938164418
              std dev =       0.526503405702
             le_variance =       0.277205836216

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275802180444
                                         uncertainty =       0.001444431584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275802180444
                                         uncertainty =       0.001444431584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371357829
  error estimate for blocks of size 2^( 2) =       0.000385316610
  error estimate for blocks of size 2^( 3) =       0.000398141667
  error estimate for blocks of size 2^( 4) =       0.000406806285
  error estimate for blocks of size 2^( 5) =       0.000412132200
  error estimate for blocks of size 2^( 6) =       0.000413744725
  error estimate for blocks of size 2^( 7) =       0.000416341408

      target function =      -0.412382640731
              le_mean =     -17.211986279189
             les_mean =     297.132367766329
             stat err =       0.000412256154
             autocorr =       1.232392726171
   target nu stat err =       0.000412256154
   target dn stat err =       0.589637937461
      target stat err =       0.187647315567
              std dev =       0.525179278709
             le_variance =       0.275813274785


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.828829691553        initial
     9.5367e-04     9.5367e-03             2.3222e-03        -0.914475033765  <--
     3.8147e-03     3.8147e-02             2.2194e-03        -0.883978382669
     1.5259e-02     1.5259e-01             1.9265e-03        -0.412382640731

*****************************************************************************
Applying the update for shift_i =   9.5367e-04     and shift_s =   9.5367e-03
*****************************************************************************

  Execution time = 2.2913e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
ci_001                -4.257343e-02 3 1  ON 0
ci_002                -3.255135e-02 3 1  ON 1
ci_003                -2.712344e-02 3 1  ON 2
ci_004                 2.447331e-02 3 1  ON 3
ci_005                 2.429027e-02 3 1  ON 4
ci_006                -2.153676e-02 3 1  ON 5
ci_007                -2.064765e-02 3 1  ON 6
ci_008                -8.593679e-03 3 1  ON 7
ci_009                -1.417773e-02 3 1  ON 8
ci_010                -9.567099e-03 3 1  ON 9
ci_011                -1.076954e-02 3 1  ON 10
ci_012                -1.114748e-02 3 1  ON 11
ci_013                -1.912297e-02 3 1  ON 12
ci_014                 1.318453e-02 3 1  ON 13
ci_015                 1.383268e-02 3 1  ON 14
ci_016                 1.708949e-02 3 1  ON 15
ci_017                 1.715728e-02 3 1  ON 16
ci_018                 1.042381e-02 3 1  ON 17
ci_019                 1.108324e-02 3 1  ON 18
ci_020                 1.741542e-02 3 1  ON 19
ci_021                 1.740591e-02 3 1  ON 20
ci_022                 1.002260e-02 3 1  ON 21
ci_023                 9.710926e-03 3 1  ON 22
ci_024                 9.834838e-03 3 1  ON 23
ci_025                 1.062713e-02 3 1  ON 24
ci_026                 1.224269e-02 3 1  ON 25
ci_027                 1.034791e-02 3 1  ON 26
ci_028                -1.611457e-02 3 1  ON 27
ci_029                -1.654362e-02 3 1  ON 28
ci_030                -9.983457e-03 3 1  ON 29
ci_031                -9.280668e-03 3 1  ON 30
ci_032                -1.422347e-02 3 1  ON 31
ci_033                 5.060729e-03 3 1  ON 32
ci_034                 4.963376e-03 3 1  ON 33
ci_035                -5.144919e-03 3 1  ON 34
ci_036                -1.358408e-02 3 1  ON 35
ci_037                -1.261312e-02 3 1  ON 36
ci_038                 1.998959e-03 3 1  ON 37
ci_039                 2.292096e-03 3 1  ON 38
ci_040                -3.473676e-03 3 1  ON 39
ci_041                 9.509769e-03 3 1  ON 40
ci_042                 9.101020e-03 3 1  ON 41
ci_043                -4.334724e-03 3 1  ON 42
ci_044                -6.496729e-03 3 1  ON 43
ci_045                -3.880853e-03 3 1  ON 44
ci_046                 6.150024e-03 3 1  ON 45
ci_047                 5.410926e-03 3 1  ON 46
ci_048                -1.316568e-02 3 1  ON 47
ci_049                -1.352203e-02 3 1  ON 48
ci_050                 3.936887e-03 3 1  ON 49
ci_051                 3.624774e-03 3 1  ON 50
ci_052                -2.684241e-03 3 1  ON 51
ci_053                -2.914881e-03 3 1  ON 52
ci_054                -3.544918e-03 3 1  ON 53
ci_055                -3.129695e-03 3 1  ON 54
ci_056                 5.719964e-03 3 1  ON 55
ci_057                 6.679044e-03 3 1  ON 56
ci_058                -1.436945e-03 3 1  ON 57
ci_059                -2.587404e-03 3 1  ON 58
ci_060                 5.063244e-03 3 1  ON 59
ci_061                 4.415723e-03 3 1  ON 60
ci_062                -3.845451e-03 3 1  ON 61
ci_063                -3.166243e-03 3 1  ON 62
ci_064                -3.124204e-03 3 1  ON 63
ci_065                -3.991466e-03 3 1  ON 64
ci_066                 4.393318e-03 3 1  ON 65
ci_067                 5.351736e-03 3 1  ON 66
ci_068                -5.297498e-03 3 1  ON 67
ci_069                -5.147247e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1592e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.2451
    reference variance = 0.274709
====================================================
  Execution time = 1.4003e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8667e-01
  Total weights = 1.956949406e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5350e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275878925738
                                         uncertainty =       0.001575178881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275878925738
                                         uncertainty =       0.001575178881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371384960
  error estimate for blocks of size 2^( 2) =       0.000384922456
  error estimate for blocks of size 2^( 3) =       0.000397505318
  error estimate for blocks of size 2^( 4) =       0.000406142102
  error estimate for blocks of size 2^( 5) =       0.000410684277
  error estimate for blocks of size 2^( 6) =       0.000414177821
  error estimate for blocks of size 2^( 7) =       0.000416154327

      target function =      -0.917961701767
              le_mean =     -17.212206349067
             les_mean =     296.546718702801
             stat err =       0.000411789632
             autocorr =       1.229425429028
   target nu stat err =       0.000411789632
   target dn stat err =       0.002353256342
      target stat err =       0.003131238626
              std dev =       0.525217646664
             le_variance =       0.275853576367


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721220634907e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e-04, overlap shift 2.3842e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917971567814       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918544300954       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918636484461       residual = 4.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918672990443       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918679885765       residual = 3.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918682787240       residual = 8.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918685104890       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918685727270       residual = 6.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918685931236       residual = 1.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918685956622       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918685954158       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918685930127       residual = 2.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-04 is 2.140201e-03

solving harmonic davidson linear method for identity shift 9.5367e-04, overlap shift 9.5367e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917971567814       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918539150714       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918630311935       residual = 4.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918666306244       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918673085690       residual = 2.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918675926211       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918678199818       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918678809775       residual = 6.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918679008560       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918679032885       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918679030371       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918679006982       residual = 1.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-04 is 2.118553e-03

solving harmonic davidson linear method for identity shift 3.8147e-03, overlap shift 3.8147e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.917971567814       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.918519443259       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.918606727933       residual = 4.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.918640803184       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.918647152592       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.918649769222       residual = 8.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.918651880483       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918652444834       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.918652624822       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.918652645408       residual = 4.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.918652642750       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.918652621685       residual = 1.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e-03 is 2.036169e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.555192 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6549e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
ci_001                -4.160973e-02 3 1  ON 0
ci_002                -3.240437e-02 3 1  ON 1
ci_003                -2.693961e-02 3 1  ON 2
ci_004                 2.405806e-02 3 1  ON 3
ci_005                 2.418384e-02 3 1  ON 4
ci_006                -2.203509e-02 3 1  ON 5
ci_007                -2.105964e-02 3 1  ON 6
ci_008                -9.854085e-03 3 1  ON 7
ci_009                -1.442167e-02 3 1  ON 8
ci_010                -1.041229e-02 3 1  ON 9
ci_011                -1.046423e-02 3 1  ON 10
ci_012                -1.008673e-02 3 1  ON 11
ci_013                -2.059075e-02 3 1  ON 12
ci_014                 1.308186e-02 3 1  ON 13
ci_015                 1.305853e-02 3 1  ON 14
ci_016                 1.737297e-02 3 1  ON 15
ci_017                 1.544184e-02 3 1  ON 16
ci_018                 1.167444e-02 3 1  ON 17
ci_019                 1.090206e-02 3 1  ON 18
ci_020                 1.743331e-02 3 1  ON 19
ci_021                 1.796293e-02 3 1  ON 20
ci_022                 9.585416e-03 3 1  ON 21
ci_023                 1.009195e-02 3 1  ON 22
ci_024                 8.757844e-03 3 1  ON 23
ci_025                 9.398314e-03 3 1  ON 24
ci_026                 1.242050e-02 3 1  ON 25
ci_027                 1.205991e-02 3 1  ON 26
ci_028                -1.709368e-02 3 1  ON 27
ci_029                -1.640641e-02 3 1  ON 28
ci_030                -8.635213e-03 3 1  ON 29
ci_031                -1.000046e-02 3 1  ON 30
ci_032                -1.472730e-02 3 1  ON 31
ci_033                 5.209178e-03 3 1  ON 32
ci_034                 5.823972e-03 3 1  ON 33
ci_035                -5.831278e-03 3 1  ON 34
ci_036                -1.303355e-02 3 1  ON 35
ci_037                -1.386239e-02 3 1  ON 36
ci_038                 1.917962e-03 3 1  ON 37
ci_039                 2.559227e-03 3 1  ON 38
ci_040                -2.723485e-03 3 1  ON 39
ci_041                 8.765003e-03 3 1  ON 40
ci_042                 8.337647e-03 3 1  ON 41
ci_043                -3.955654e-03 3 1  ON 42
ci_044                -4.378176e-03 3 1  ON 43
ci_045                -3.654681e-03 3 1  ON 44
ci_046                 5.829118e-03 3 1  ON 45
ci_047                 5.528180e-03 3 1  ON 46
ci_048                -1.228083e-02 3 1  ON 47
ci_049                -1.282387e-02 3 1  ON 48
ci_050                 3.398479e-03 3 1  ON 49
ci_051                 3.305330e-03 3 1  ON 50
ci_052                -2.895031e-03 3 1  ON 51
ci_053                -2.486226e-03 3 1  ON 52
ci_054                -3.018127e-03 3 1  ON 53
ci_055                -3.152480e-03 3 1  ON 54
ci_056                 5.353091e-03 3 1  ON 55
ci_057                 5.944255e-03 3 1  ON 56
ci_058                -2.064812e-03 3 1  ON 57
ci_059                -2.310615e-03 3 1  ON 58
ci_060                 4.868859e-03 3 1  ON 59
ci_061                 5.277863e-03 3 1  ON 60
ci_062                -4.290532e-03 3 1  ON 61
ci_063                -3.796624e-03 3 1  ON 62
ci_064                -3.444478e-03 3 1  ON 63
ci_065                -4.225937e-03 3 1  ON 64
ci_066                 4.801659e-03 3 1  ON 65
ci_067                 5.078442e-03 3 1  ON 66
ci_068                -4.428706e-03 3 1  ON 67
ci_069                -4.522416e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.2441
    reference variance = 0.330087
====================================================
  Execution time = 1.3614e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8987e-01
  Total weights = 1.9568e+06
  Execution time = 1.8678e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286061679085
                                         uncertainty =       0.007628552881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286061679085
                                         uncertainty =       0.007628552881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378196583
  error estimate for blocks of size 2^( 2) =       0.000391665174
  error estimate for blocks of size 2^( 3) =       0.000403974079
  error estimate for blocks of size 2^( 4) =       0.000413049408
  error estimate for blocks of size 2^( 5) =       0.000418010925
  error estimate for blocks of size 2^( 6) =       0.000421919197
  error estimate for blocks of size 2^( 7) =       0.000424485280

      target function =      -0.402567506229
              le_mean =     -17.211831761020
             les_mean =     297.154842167341
             stat err =       0.000419366202
             autocorr =       1.229565452925
   target nu stat err =       0.000419366202
   target dn stat err =       0.607628201392
      target stat err =       0.184778434446
              std dev =       0.534850736898
             le_variance =       0.286065310760

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277710716789
                                         uncertainty =       0.001582320918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277710716789
                                         uncertainty =       0.001582320918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372663930
  error estimate for blocks of size 2^( 2) =       0.000386349713
  error estimate for blocks of size 2^( 3) =       0.000398729906
  error estimate for blocks of size 2^( 4) =       0.000407991132
  error estimate for blocks of size 2^( 5) =       0.000412862937
  error estimate for blocks of size 2^( 6) =       0.000416501491
  error estimate for blocks of size 2^( 7) =       0.000418964693

      target function =      -0.913724125894
              le_mean =     -17.211798335959
             les_mean =     296.535851497681
             stat err =       0.000414080063
             autocorr =       1.234621745915
   target nu stat err =       0.000414080063
   target dn stat err =       0.002228548965
      target stat err =       0.002943220819
              std dev =       0.527026384180
             le_variance =       0.277756809622

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319847658507
                                         uncertainty =       0.040813687065

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.319847658507
                                         uncertainty =       0.040813687065

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000399917193
  error estimate for blocks of size 2^( 2) =       0.000412642139
  error estimate for blocks of size 2^( 3) =       0.000424181111
  error estimate for blocks of size 2^( 4) =       0.000432895491
  error estimate for blocks of size 2^( 5) =       0.000437682988
  error estimate for blocks of size 2^( 6) =       0.000441058330
  error estimate for blocks of size 2^( 7) =       0.000442763708

      target function =      -0.174874835999
              le_mean =     -17.212031045899
             les_mean =     298.294210316231
             stat err =       0.000438600129
             autocorr =       1.202810914069
   target nu stat err =       0.000438600129
   target dn stat err =       1.739715922979
      target stat err =       0.123870146261
              std dev =       0.565568318046
             le_variance =       0.319867522377

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277692597987
                                         uncertainty =       0.001581992733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277692597987
                                         uncertainty =       0.001581992733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372651783
  error estimate for blocks of size 2^( 2) =       0.000386336908
  error estimate for blocks of size 2^( 3) =       0.000398717936
  error estimate for blocks of size 2^( 4) =       0.000407979844
  error estimate for blocks of size 2^( 5) =       0.000412851257
  error estimate for blocks of size 2^( 6) =       0.000416488010
  error estimate for blocks of size 2^( 7) =       0.000418949814

      target function =      -0.911813501511
              le_mean =     -17.211798439778
             les_mean =     296.537331356750
             stat err =       0.000414067231
             autocorr =       1.234625710813
   target nu stat err =       0.000414067231
   target dn stat err =       0.002682768805
      target stat err =       0.003506738428
              std dev =       0.527009205999
             le_variance =       0.277738703207


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.402567506229        initial
     2.3842e-04     2.3842e-03             2.1402e-03        -0.913724125894  <--
     9.5367e-04     9.5367e-03             2.1186e-03        -0.174874835999
     3.8147e-03     3.8147e-02             2.0362e-03        -0.911813501511

*****************************************************************************
Applying the update for shift_i =   2.3842e-04     and shift_s =   2.3842e-03
*****************************************************************************

  Execution time = 2.3021e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
ci_001                -4.159826e-02 3 1  ON 0
ci_002                -3.240290e-02 3 1  ON 1
ci_003                -2.693851e-02 3 1  ON 2
ci_004                 2.405434e-02 3 1  ON 3
ci_005                 2.418538e-02 3 1  ON 4
ci_006                -2.204123e-02 3 1  ON 5
ci_007                -2.106547e-02 3 1  ON 6
ci_008                -9.865354e-03 3 1  ON 7
ci_009                -1.442417e-02 3 1  ON 8
ci_010                -1.042089e-02 3 1  ON 9
ci_011                -1.046119e-02 3 1  ON 10
ci_012                -1.007636e-02 3 1  ON 11
ci_013                -2.060932e-02 3 1  ON 12
ci_014                 1.308135e-02 3 1  ON 13
ci_015                 1.304966e-02 3 1  ON 14
ci_016                 1.737619e-02 3 1  ON 15
ci_017                 1.542160e-02 3 1  ON 16
ci_018                 1.168687e-02 3 1  ON 17
ci_019                 1.090036e-02 3 1  ON 18
ci_020                 1.743341e-02 3 1  ON 19
ci_021                 1.797094e-02 3 1  ON 20
ci_022                 9.581169e-03 3 1  ON 21
ci_023                 1.009599e-02 3 1  ON 22
ci_024                 8.746170e-03 3 1  ON 23
ci_025                 9.384662e-03 3 1  ON 24
ci_026                 1.242228e-02 3 1  ON 25
ci_027                 1.207649e-02 3 1  ON 26
ci_028                -1.710387e-02 3 1  ON 27
ci_029                -1.640360e-02 3 1  ON 28
ci_030                -8.621343e-03 3 1  ON 29
ci_031                -1.000619e-02 3 1  ON 30
ci_032                -1.473254e-02 3 1  ON 31
ci_033                 5.210685e-03 3 1  ON 32
ci_034                 5.833312e-03 3 1  ON 33
ci_035                -5.837828e-03 3 1  ON 34
ci_036                -1.302886e-02 3 1  ON 35
ci_037                -1.387418e-02 3 1  ON 36
ci_038                 1.917209e-03 3 1  ON 37
ci_039                 2.561762e-03 3 1  ON 38
ci_040                -2.716680e-03 3 1  ON 39
ci_041                 8.758917e-03 3 1  ON 40
ci_042                 8.330092e-03 3 1  ON 41
ci_043                -3.951966e-03 3 1  ON 42
ci_044                -4.356529e-03 3 1  ON 43
ci_045                -3.652564e-03 3 1  ON 44
ci_046                 5.825800e-03 3 1  ON 45
ci_047                 5.529490e-03 3 1  ON 46
ci_048                -1.226862e-02 3 1  ON 47
ci_049                -1.281654e-02 3 1  ON 48
ci_050                 3.393762e-03 3 1  ON 49
ci_051                 3.302561e-03 3 1  ON 50
ci_052                -2.896700e-03 3 1  ON 51
ci_053                -2.482623e-03 3 1  ON 52
ci_054                -3.013257e-03 3 1  ON 53
ci_055                -3.152333e-03 3 1  ON 54
ci_056                 5.349567e-03 3 1  ON 55
ci_057                 5.937199e-03 3 1  ON 56
ci_058                -2.071111e-03 3 1  ON 57
ci_059                -2.308206e-03 3 1  ON 58
ci_060                 4.866755e-03 3 1  ON 59
ci_061                 5.286982e-03 3 1  ON 60
ci_062                -4.294372e-03 3 1  ON 61
ci_063                -3.802159e-03 3 1  ON 62
ci_064                -3.447372e-03 3 1  ON 63
ci_065                -4.228081e-03 3 1  ON 64
ci_066                 4.805538e-03 3 1  ON 65
ci_067                 5.075530e-03 3 1  ON 66
ci_068                -4.419747e-03 3 1  ON 67
ci_069                -4.515917e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9575e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.2773
    reference variance = 0.155306
====================================================
  Execution time = 1.4105e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8822e-01
  Total weights = 1.956804651e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5243e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276369394272
                                         uncertainty =       0.001834571679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276369394272
                                         uncertainty =       0.001834571679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371684805
  error estimate for blocks of size 2^( 2) =       0.000385651422
  error estimate for blocks of size 2^( 3) =       0.000398081160
  error estimate for blocks of size 2^( 4) =       0.000406744007
  error estimate for blocks of size 2^( 5) =       0.000411355460
  error estimate for blocks of size 2^( 6) =       0.000414052295
  error estimate for blocks of size 2^( 7) =       0.000414571240

      target function =      -0.915815731055
              le_mean =     -17.211713102114
             les_mean =     296.531285238964
             stat err =       0.000411680751
             autocorr =       1.226793616551
   target nu stat err =       0.000411680751
   target dn stat err =       0.002649466759
      target stat err =       0.003493441101
              std dev =       0.525641692110
             le_variance =       0.276299188485


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721171310211e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-05, overlap shift 5.9605e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915828161607       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916623820271       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916735222720       residual = 7.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916788036000       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916791292609       residual = 5.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916790825646       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916792043958       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916792521172       residual = 8.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916792584414       residual = 3.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916792888752       residual = 8.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916792930737       residual = 1.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916792929709       residual = 4.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-05 is 2.217364e-03

solving harmonic davidson linear method for identity shift 2.3842e-04, overlap shift 2.3842e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915828161607       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916622018516       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916733119816       residual = 7.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916785738198       residual = 1.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916788979388       residual = 5.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916788509489       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916789721971       residual = 3.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916790196869       residual = 8.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916790259717       residual = 3.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916790562596       residual = 8.52e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916790604323       residual = 1.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916790603218       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-04 is 2.210833e-03

solving harmonic davidson linear method for identity shift 9.5367e-04, overlap shift 9.5367e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915828161607       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916614892283       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916724804888       residual = 7.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916776656764       residual = 1.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916779837551       residual = 5.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916779356382       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916780546032       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916781011858       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916781073172       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916781370337       residual = 8.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916781411053       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916781409653       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-04 is 2.185090e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.559959 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6639e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
ci_001                -4.165693e-02 3 1  ON 0
ci_002                -3.334550e-02 3 1  ON 1
ci_003                -2.624630e-02 3 1  ON 2
ci_004                 2.418995e-02 3 1  ON 3
ci_005                 2.379143e-02 3 1  ON 4
ci_006                -2.173456e-02 3 1  ON 5
ci_007                -2.197504e-02 3 1  ON 6
ci_008                -9.156815e-03 3 1  ON 7
ci_009                -1.477051e-02 3 1  ON 8
ci_010                -9.409661e-03 3 1  ON 9
ci_011                -9.265836e-03 3 1  ON 10
ci_012                -1.042806e-02 3 1  ON 11
ci_013                -1.932793e-02 3 1  ON 12
ci_014                 1.248681e-02 3 1  ON 13
ci_015                 1.266220e-02 3 1  ON 14
ci_016                 1.672815e-02 3 1  ON 15
ci_017                 1.664727e-02 3 1  ON 16
ci_018                 1.110870e-02 3 1  ON 17
ci_019                 1.238953e-02 3 1  ON 18
ci_020                 1.799040e-02 3 1  ON 19
ci_021                 1.808839e-02 3 1  ON 20
ci_022                 1.024615e-02 3 1  ON 21
ci_023                 1.015035e-02 3 1  ON 22
ci_024                 1.031009e-02 3 1  ON 23
ci_025                 9.330594e-03 3 1  ON 24
ci_026                 1.238784e-02 3 1  ON 25
ci_027                 1.140753e-02 3 1  ON 26
ci_028                -1.489303e-02 3 1  ON 27
ci_029                -1.535702e-02 3 1  ON 28
ci_030                -1.005636e-02 3 1  ON 29
ci_031                -9.675316e-03 3 1  ON 30
ci_032                -1.449115e-02 3 1  ON 31
ci_033                 6.204287e-03 3 1  ON 32
ci_034                 4.534988e-03 3 1  ON 33
ci_035                -5.507462e-03 3 1  ON 34
ci_036                -1.232171e-02 3 1  ON 35
ci_037                -1.215667e-02 3 1  ON 36
ci_038                 1.643922e-03 3 1  ON 37
ci_039                 2.235171e-03 3 1  ON 38
ci_040                -3.437685e-03 3 1  ON 39
ci_041                 8.272709e-03 3 1  ON 40
ci_042                 7.443975e-03 3 1  ON 41
ci_043                -4.289414e-03 3 1  ON 42
ci_044                -5.731166e-03 3 1  ON 43
ci_045                -3.543967e-03 3 1  ON 44
ci_046                 6.167962e-03 3 1  ON 45
ci_047                 5.408117e-03 3 1  ON 46
ci_048                -1.301161e-02 3 1  ON 47
ci_049                -1.300165e-02 3 1  ON 48
ci_050                 4.468908e-03 3 1  ON 49
ci_051                 3.973815e-03 3 1  ON 50
ci_052                -2.619998e-03 3 1  ON 51
ci_053                -3.375667e-03 3 1  ON 52
ci_054                -2.778431e-03 3 1  ON 53
ci_055                -1.886625e-03 3 1  ON 54
ci_056                 5.560767e-03 3 1  ON 55
ci_057                 5.710282e-03 3 1  ON 56
ci_058                -2.210071e-03 3 1  ON 57
ci_059                -2.196224e-04 3 1  ON 58
ci_060                 4.205375e-03 3 1  ON 59
ci_061                 3.966043e-03 3 1  ON 60
ci_062                -3.778003e-03 3 1  ON 61
ci_063                -3.992054e-03 3 1  ON 62
ci_064                -3.471371e-03 3 1  ON 63
ci_065                -4.340467e-03 3 1  ON 64
ci_066                 4.349752e-03 3 1  ON 65
ci_067                 4.401253e-03 3 1  ON 66
ci_068                -5.187831e-03 3 1  ON 67
ci_069                -4.445893e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.1956
    reference variance = 0.411702
====================================================
  Execution time = 1.3710e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8576e-01
  Total weights = 1.9573e+06
  Execution time = 1.8543e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0729339
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311143547536
                                         uncertainty =       0.027291919594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.311143547536
                                         uncertainty =       0.027291919594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000394401901
  error estimate for blocks of size 2^( 2) =       0.000407312947
  error estimate for blocks of size 2^( 3) =       0.000418758829
  error estimate for blocks of size 2^( 4) =       0.000426999834
  error estimate for blocks of size 2^( 5) =       0.000432008593
  error estimate for blocks of size 2^( 6) =       0.000435458954
  error estimate for blocks of size 2^( 7) =       0.000435717024

      target function =      -0.034315866038
              le_mean =     -17.212630721956
             les_mean =     306.055415641953
             stat err =       0.000432546101
             autocorr =       1.202781681053
   target nu stat err =       0.000432546101
   target dn stat err =       9.355864614933
      target stat err =       0.031488761064
              std dev =       0.557768517175
             le_variance =       0.311105718751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274692440455
                                         uncertainty =       0.001469702741

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274692440455
                                         uncertainty =       0.001469702741

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370626196
  error estimate for blocks of size 2^( 2) =       0.000384370091
  error estimate for blocks of size 2^( 3) =       0.000396554576
  error estimate for blocks of size 2^( 4) =       0.000405235669
  error estimate for blocks of size 2^( 5) =       0.000410311734
  error estimate for blocks of size 2^( 6) =       0.000413612374
  error estimate for blocks of size 2^( 7) =       0.000414472405

      target function =      -0.919100276366
              le_mean =     -17.212425610699
             les_mean =     296.553443096393
             stat err =       0.000410908046
             autocorr =       1.229184474275
   target nu stat err =       0.000410908046
   target dn stat err =       0.001970574681
      target stat err =       0.002648567669
              std dev =       0.524144592680
             le_variance =       0.274727554035

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0752018
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276643002447
                                         uncertainty =       0.001521371973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276643002447
                                         uncertainty =       0.001521371973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371937215
  error estimate for blocks of size 2^( 2) =       0.000385718287
  error estimate for blocks of size 2^( 3) =       0.000397917249
  error estimate for blocks of size 2^( 4) =       0.000406609417
  error estimate for blocks of size 2^( 5) =       0.000411670327
  error estimate for blocks of size 2^( 6) =       0.000414925293
  error estimate for blocks of size 2^( 7) =       0.000415911916

      target function =      -0.905593149548
              le_mean =     -17.212522429784
             les_mean =     296.567235358077
             stat err =       0.000412279238
             autocorr =       1.228693781604
   target nu stat err =       0.000412279238
   target dn stat err =       0.004028946591
      target stat err =       0.005160382772
              std dev =       0.525998653892
             le_variance =       0.276674583896

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274681810056
                                         uncertainty =       0.001469506328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274681810056
                                         uncertainty =       0.001469506328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370619051
  error estimate for blocks of size 2^( 2) =       0.000384362395
  error estimate for blocks of size 2^( 3) =       0.000396546665
  error estimate for blocks of size 2^( 4) =       0.000405227478
  error estimate for blocks of size 2^( 5) =       0.000410303387
  error estimate for blocks of size 2^( 6) =       0.000413604881
  error estimate for blocks of size 2^( 7) =       0.000414463243

      target function =      -0.919226429306
              le_mean =     -17.212426010820
             les_mean =     296.553360674769
             stat err =       0.000410899747
             autocorr =       1.229182215800
   target nu stat err =       0.000410899747
   target dn stat err =       0.001977961545
      target stat err =       0.002658722071
              std dev =       0.524134488510
             le_variance =       0.274716962045


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.034315866038        initial  <--
            N/A            N/A                    N/A                    N/A     bad update
            N/A            N/A                    N/A                    N/A     bad update
            N/A            N/A                    N/A                    N/A     bad update

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0694
  </log>
  <optVariables href="H2O.s077.opt.xml">
ci_001                -4.159826e-02 3 1  ON 0
ci_002                -3.240290e-02 3 1  ON 1
ci_003                -2.693851e-02 3 1  ON 2
ci_004                 2.405434e-02 3 1  ON 3
ci_005                 2.418538e-02 3 1  ON 4
ci_006                -2.204123e-02 3 1  ON 5
ci_007                -2.106547e-02 3 1  ON 6
ci_008                -9.865354e-03 3 1  ON 7
ci_009                -1.442417e-02 3 1  ON 8
ci_010                -1.042089e-02 3 1  ON 9
ci_011                -1.046119e-02 3 1  ON 10
ci_012                -1.007636e-02 3 1  ON 11
ci_013                -2.060932e-02 3 1  ON 12
ci_014                 1.308135e-02 3 1  ON 13
ci_015                 1.304966e-02 3 1  ON 14
ci_016                 1.737619e-02 3 1  ON 15
ci_017                 1.542160e-02 3 1  ON 16
ci_018                 1.168687e-02 3 1  ON 17
ci_019                 1.090036e-02 3 1  ON 18
ci_020                 1.743341e-02 3 1  ON 19
ci_021                 1.797094e-02 3 1  ON 20
ci_022                 9.581169e-03 3 1  ON 21
ci_023                 1.009599e-02 3 1  ON 22
ci_024                 8.746170e-03 3 1  ON 23
ci_025                 9.384662e-03 3 1  ON 24
ci_026                 1.242228e-02 3 1  ON 25
ci_027                 1.207649e-02 3 1  ON 26
ci_028                -1.710387e-02 3 1  ON 27
ci_029                -1.640360e-02 3 1  ON 28
ci_030                -8.621343e-03 3 1  ON 29
ci_031                -1.000619e-02 3 1  ON 30
ci_032                -1.473254e-02 3 1  ON 31
ci_033                 5.210685e-03 3 1  ON 32
ci_034                 5.833312e-03 3 1  ON 33
ci_035                -5.837828e-03 3 1  ON 34
ci_036                -1.302886e-02 3 1  ON 35
ci_037                -1.387418e-02 3 1  ON 36
ci_038                 1.917209e-03 3 1  ON 37
ci_039                 2.561762e-03 3 1  ON 38
ci_040                -2.716680e-03 3 1  ON 39
ci_041                 8.758917e-03 3 1  ON 40
ci_042                 8.330092e-03 3 1  ON 41
ci_043                -3.951966e-03 3 1  ON 42
ci_044                -4.356529e-03 3 1  ON 43
ci_045                -3.652564e-03 3 1  ON 44
ci_046                 5.825800e-03 3 1  ON 45
ci_047                 5.529490e-03 3 1  ON 46
ci_048                -1.226862e-02 3 1  ON 47
ci_049                -1.281654e-02 3 1  ON 48
ci_050                 3.393762e-03 3 1  ON 49
ci_051                 3.302561e-03 3 1  ON 50
ci_052                -2.896700e-03 3 1  ON 51
ci_053                -2.482623e-03 3 1  ON 52
ci_054                -3.013257e-03 3 1  ON 53
ci_055                -3.152333e-03 3 1  ON 54
ci_056                 5.349567e-03 3 1  ON 55
ci_057                 5.937199e-03 3 1  ON 56
ci_058                -2.071111e-03 3 1  ON 57
ci_059                -2.308206e-03 3 1  ON 58
ci_060                 4.866755e-03 3 1  ON 59
ci_061                 5.286982e-03 3 1  ON 60
ci_062                -4.294372e-03 3 1  ON 61
ci_063                -3.802159e-03 3 1  ON 62
ci_064                -3.447372e-03 3 1  ON 63
ci_065                -4.228081e-03 3 1  ON 64
ci_066                 4.805538e-03 3 1  ON 65
ci_067                 5.075530e-03 3 1  ON 66
ci_068                -4.419747e-03 3 1  ON 67
ci_069                -4.515917e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9718e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.1725
    reference variance = 0.224008
====================================================
  Execution time = 1.3858e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5317e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8772e-01
  Total weights = 1.957160727e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5010e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276684971384
                                         uncertainty =       0.001629750190

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276684971384
                                         uncertainty =       0.001629750190

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371958931
  error estimate for blocks of size 2^( 2) =       0.000385999062
  error estimate for blocks of size 2^( 3) =       0.000398527716
  error estimate for blocks of size 2^( 4) =       0.000407693686
  error estimate for blocks of size 2^( 5) =       0.000411595908
  error estimate for blocks of size 2^( 6) =       0.000412926650
  error estimate for blocks of size 2^( 7) =       0.000413945395

      target function =      -0.916294256773
              le_mean =     -17.211053182977
             les_mean =     296.508071508858
             stat err =       0.000411540410
             autocorr =       1.224150994361
   target nu stat err =       0.000411540410
   target dn stat err =       0.002327791957
      target stat err =       0.003081924158
              std dev =       0.526029364841
             le_variance =       0.276706892675


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721105318298e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-04, overlap shift 5.9605e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916303812287       residual = 9.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916763705204       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916848408288       residual = 5.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916900376124       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916906025987       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916908762453       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916910257626       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916910578348       residual = 9.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916910336066       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916910254559       residual = 5.77e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916910279187       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916910245139       residual = 3.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-04 is 2.456025e-03

solving harmonic davidson linear method for identity shift 2.3842e-03, overlap shift 2.3842e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916303812287       residual = 9.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916753525000       residual = 1.44e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916835954343       residual = 5.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916886167152       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916891529021       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916894143970       residual = 8.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916895565756       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916895863774       residual = 9.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916895628989       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916895551336       residual = 5.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916895574461       residual = 1.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916895542613       residual = 2.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-03 is 2.387053e-03

solving harmonic davidson linear method for identity shift 9.5367e-03, overlap shift 9.5367e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916303812287       residual = 9.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916716942623       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916791361777       residual = 5.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916835551053       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916839969766       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916842184583       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916843365908       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916843593330       residual = 7.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916843384389       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916843320360       residual = 4.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916843338571       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916843313662       residual = 2.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-03 is 2.146237e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.569884 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6377e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
ci_001                -4.228034e-02 3 1  ON 0
ci_002                -3.288631e-02 3 1  ON 1
ci_003                -2.756609e-02 3 1  ON 2
ci_004                 2.378568e-02 3 1  ON 3
ci_005                 2.471362e-02 3 1  ON 4
ci_006                -2.186781e-02 3 1  ON 5
ci_007                -2.167415e-02 3 1  ON 6
ci_008                -8.731855e-03 3 1  ON 7
ci_009                -1.427932e-02 3 1  ON 8
ci_010                -9.517113e-03 3 1  ON 9
ci_011                -1.196867e-02 3 1  ON 10
ci_012                -1.070623e-02 3 1  ON 11
ci_013                -1.838341e-02 3 1  ON 12
ci_014                 1.339146e-02 3 1  ON 13
ci_015                 1.235684e-02 3 1  ON 14
ci_016                 1.739109e-02 3 1  ON 15
ci_017                 1.695028e-02 3 1  ON 16
ci_018                 1.155003e-02 3 1  ON 17
ci_019                 1.146924e-02 3 1  ON 18
ci_020                 1.878238e-02 3 1  ON 19
ci_021                 1.745255e-02 3 1  ON 20
ci_022                 9.366776e-03 3 1  ON 21
ci_023                 9.841053e-03 3 1  ON 22
ci_024                 9.272735e-03 3 1  ON 23
ci_025                 1.013985e-02 3 1  ON 24
ci_026                 1.252877e-02 3 1  ON 25
ci_027                 1.145640e-02 3 1  ON 26
ci_028                -1.471681e-02 3 1  ON 27
ci_029                -1.481775e-02 3 1  ON 28
ci_030                -9.434634e-03 3 1  ON 29
ci_031                -9.819993e-03 3 1  ON 30
ci_032                -1.441137e-02 3 1  ON 31
ci_033                 6.087213e-03 3 1  ON 32
ci_034                 6.293361e-03 3 1  ON 33
ci_035                -5.292966e-03 3 1  ON 34
ci_036                -1.296161e-02 3 1  ON 35
ci_037                -1.220553e-02 3 1  ON 36
ci_038                 1.977589e-03 3 1  ON 37
ci_039                 2.628671e-03 3 1  ON 38
ci_040                -3.322217e-03 3 1  ON 39
ci_041                 8.786507e-03 3 1  ON 40
ci_042                 9.162596e-03 3 1  ON 41
ci_043                -4.311876e-03 3 1  ON 42
ci_044                -2.999307e-03 3 1  ON 43
ci_045                -3.421319e-03 3 1  ON 44
ci_046                 5.673823e-03 3 1  ON 45
ci_047                 5.446025e-03 3 1  ON 46
ci_048                -1.304265e-02 3 1  ON 47
ci_049                -1.226447e-02 3 1  ON 48
ci_050                 3.863641e-03 3 1  ON 49
ci_051                 2.956193e-03 3 1  ON 50
ci_052                -3.175370e-03 3 1  ON 51
ci_053                -2.608370e-03 3 1  ON 52
ci_054                -2.732006e-03 3 1  ON 53
ci_055                -3.306108e-03 3 1  ON 54
ci_056                 6.060933e-03 3 1  ON 55
ci_057                 6.555803e-03 3 1  ON 56
ci_058                -2.051795e-03 3 1  ON 57
ci_059                -3.010229e-03 3 1  ON 58
ci_060                 4.728467e-03 3 1  ON 59
ci_061                 5.700456e-03 3 1  ON 60
ci_062                -4.182552e-03 3 1  ON 61
ci_063                -3.946117e-03 3 1  ON 62
ci_064                -3.110427e-03 3 1  ON 63
ci_065                -4.163072e-03 3 1  ON 64
ci_066                 5.004111e-03 3 1  ON 65
ci_067                 4.767517e-03 3 1  ON 66
ci_068                -4.444245e-03 3 1  ON 67
ci_069                -5.129088e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.1471
    reference variance = 0.516453
====================================================
  Execution time = 1.3562e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8734e-01
  Total weights = 1.9574e+06
  Execution time = 1.8501e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276341697428
                                         uncertainty =       0.001623869286

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276341697428
                                         uncertainty =       0.001623869286

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371765741
  error estimate for blocks of size 2^( 2) =       0.000385539398
  error estimate for blocks of size 2^( 3) =       0.000397699905
  error estimate for blocks of size 2^( 4) =       0.000406560463
  error estimate for blocks of size 2^( 5) =       0.000412499588
  error estimate for blocks of size 2^( 6) =       0.000414144468
  error estimate for blocks of size 2^( 7) =       0.000416835850

      target function =      -0.703143352108
              le_mean =     -17.212941905886
             les_mean =     296.769892627898
             stat err =       0.000412510092
             autocorr =       1.231205151686
   target nu stat err =       0.000412510092
   target dn stat err =       0.122310924366
      target stat err =       0.095642558658
              std dev =       0.525756153011
             le_variance =       0.276419532429

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275850800028
                                         uncertainty =       0.001581765273

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275850800028
                                         uncertainty =       0.001581765273

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371439815
  error estimate for blocks of size 2^( 2) =       0.000385161826
  error estimate for blocks of size 2^( 3) =       0.000397346334
  error estimate for blocks of size 2^( 4) =       0.000406147229
  error estimate for blocks of size 2^( 5) =       0.000412025381
  error estimate for blocks of size 2^( 6) =       0.000413587910
  error estimate for blocks of size 2^( 7) =       0.000416361985

      target function =      -0.917181651825
              le_mean =     -17.212876503302
             les_mean =     296.570520355845
             stat err =       0.000412030626
             autocorr =       1.230501332254
   target nu stat err =       0.000412030626
   target dn stat err =       0.002145491700
      target stat err =       0.002863208580
              std dev =       0.525295223648
             le_variance =       0.275935071988

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276997855477
                                         uncertainty =       0.001559280968

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276997855477
                                         uncertainty =       0.001559280968

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372213912
  error estimate for blocks of size 2^( 2) =       0.000385869190
  error estimate for blocks of size 2^( 3) =       0.000398032370
  error estimate for blocks of size 2^( 4) =       0.000406766385
  error estimate for blocks of size 2^( 5) =       0.000412602296
  error estimate for blocks of size 2^( 6) =       0.000414147357
  error estimate for blocks of size 2^( 7) =       0.000416965911

      target function =      -0.900329748331
              le_mean =     -17.212967278274
             les_mean =     296.586694701596
             stat err =       0.000412620487
             autocorr =       1.228899509439
   target nu stat err =       0.000412620487
   target dn stat err =       0.009126193670
      target stat err =       0.011504443191
              std dev =       0.526389962984
             le_variance =       0.277086393130

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275804292106
                                         uncertainty =       0.001585113084

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275804292106
                                         uncertainty =       0.001585113084

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371408080
  error estimate for blocks of size 2^( 2) =       0.000385136931
  error estimate for blocks of size 2^( 3) =       0.000397323571
  error estimate for blocks of size 2^( 4) =       0.000406132495
  error estimate for blocks of size 2^( 5) =       0.000412015636
  error estimate for blocks of size 2^( 6) =       0.000413580674
  error estimate for blocks of size 2^( 7) =       0.000416348419

      target function =      -0.916935323343
              le_mean =     -17.212876668214
             les_mean =     296.570714599263
             stat err =       0.000412019306
             autocorr =       1.230643998044
   target nu stat err =       0.000412019306
   target dn stat err =       0.002162643713
      target stat err =       0.002883621000
              std dev =       0.525250343514
             le_variance =       0.275887923361


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.703143352108        initial
     5.9605e-04     5.9605e-03             2.4560e-03        -0.917181651825  <--
     2.3842e-03     2.3842e-02             2.3871e-03        -0.900329748331
     9.5367e-03     9.5367e-02             2.1462e-03        -0.916935323343

*****************************************************************************
Applying the update for shift_i =   5.9605e-04     and shift_s =   5.9605e-03
*****************************************************************************

  Execution time = 2.2924e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
ci_001                -4.230138e-02 3 1  ON 0
ci_002                -3.290014e-02 3 1  ON 1
ci_003                -2.757922e-02 3 1  ON 2
ci_004                 2.377694e-02 3 1  ON 3
ci_005                 2.472708e-02 3 1  ON 4
ci_006                -2.186249e-02 3 1  ON 5
ci_007                -2.169009e-02 3 1  ON 6
ci_008                -8.706877e-03 3 1  ON 7
ci_009                -1.427672e-02 3 1  ON 8
ci_010                -9.495724e-03 3 1  ON 9
ci_011                -1.200563e-02 3 1  ON 10
ci_012                -1.072192e-02 3 1  ON 11
ci_013                -1.831209e-02 3 1  ON 12
ci_014                 1.339698e-02 3 1  ON 13
ci_015                 1.233824e-02 3 1  ON 14
ci_016                 1.739092e-02 3 1  ON 15
ci_017                 1.699498e-02 3 1  ON 16
ci_018                 1.154638e-02 3 1  ON 17
ci_019                 1.148593e-02 3 1  ON 18
ci_020                 1.882300e-02 3 1  ON 19
ci_021                 1.743929e-02 3 1  ON 20
ci_022                 9.360747e-03 3 1  ON 21
ci_023                 9.833857e-03 3 1  ON 22
ci_024                 9.287592e-03 3 1  ON 23
ci_025                 1.016089e-02 3 1  ON 24
ci_026                 1.253023e-02 3 1  ON 25
ci_027                 1.144217e-02 3 1  ON 26
ci_028                -1.464784e-02 3 1  ON 27
ci_029                -1.477497e-02 3 1  ON 28
ci_030                -9.455622e-03 3 1  ON 29
ci_031                -9.814131e-03 3 1  ON 30
ci_032                -1.440347e-02 3 1  ON 31
ci_033                 6.110290e-03 3 1  ON 32
ci_034                 6.306577e-03 3 1  ON 33
ci_035                -5.280081e-03 3 1  ON 34
ci_036                -1.296049e-02 3 1  ON 35
ci_037                -1.216772e-02 3 1  ON 36
ci_038                 1.979036e-03 3 1  ON 37
ci_039                 2.630202e-03 3 1  ON 38
ci_040                -3.335791e-03 3 1  ON 39
ci_041                 8.781083e-03 3 1  ON 40
ci_042                 9.178005e-03 3 1  ON 41
ci_043                -4.320630e-03 3 1  ON 42
ci_044                -2.966127e-03 3 1  ON 43
ci_045                -3.416149e-03 3 1  ON 44
ci_046                 5.670023e-03 3 1  ON 45
ci_047                 5.443805e-03 3 1  ON 46
ci_048                -1.306678e-02 3 1  ON 47
ci_049                -1.224872e-02 3 1  ON 48
ci_050                 3.873957e-03 3 1  ON 49
ci_051                 2.948937e-03 3 1  ON 50
ci_052                -3.182533e-03 3 1  ON 51
ci_053                -2.611909e-03 3 1  ON 52
ci_054                -2.725186e-03 3 1  ON 53
ci_055                -3.310364e-03 3 1  ON 54
ci_056                 6.078041e-03 3 1  ON 55
ci_057                 6.570207e-03 3 1  ON 56
ci_058                -2.053389e-03 3 1  ON 57
ci_059                -3.026040e-03 3 1  ON 58
ci_060                 4.725239e-03 3 1  ON 59
ci_061                 5.711635e-03 3 1  ON 60
ci_062                -4.180717e-03 3 1  ON 61
ci_063                -3.951540e-03 3 1  ON 62
ci_064                -3.102986e-03 3 1  ON 63
ci_065                -4.161608e-03 3 1  ON 64
ci_066                 5.008080e-03 3 1  ON 65
ci_067                 4.759809e-03 3 1  ON 66
ci_068                -4.445409e-03 3 1  ON 67
ci_069                -5.144251e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9316e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.2095
    reference variance = 0.229098
====================================================
  Execution time = 1.3873e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9093e-01
  Total weights = 1.957347577e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5063e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278474545112
                                         uncertainty =       0.001819102516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278474545112
                                         uncertainty =       0.001819102516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373098636
  error estimate for blocks of size 2^( 2) =       0.000386805878
  error estimate for blocks of size 2^( 3) =       0.000399110072
  error estimate for blocks of size 2^( 4) =       0.000406895364
  error estimate for blocks of size 2^( 5) =       0.000413006192
  error estimate for blocks of size 2^( 6) =       0.000415745551
  error estimate for blocks of size 2^( 7) =       0.000417306671

      target function =      -0.912474317440
              le_mean =     -17.212411482761
             les_mean =     296.558037261383
             stat err =       0.000413238444
             autocorr =       1.226744483866
   target nu stat err =       0.000413238444
   target dn stat err =       0.003169463745
      target stat err =       0.004136232954
              std dev =       0.527641150931
             le_variance =       0.278405184156


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721241148276e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-04, overlap shift 1.4901e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912492190217       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913250134177       residual = 1.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913348238582       residual = 6.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913387187184       residual = 9.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913395723327       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913394747613       residual = 9.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913394933441       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913395334126       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913395140436       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913395025515       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913394971182       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913394958125       residual = 1.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-04 is 2.512331e-03

solving harmonic davidson linear method for identity shift 5.9605e-04, overlap shift 5.9605e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912492190217       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913245865682       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913343252702       residual = 6.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913381856327       residual = 9.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913390299150       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913389323442       residual = 9.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913389504873       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913389900865       residual = 6.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913389709151       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913389595951       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913389542112       residual = 1.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913389529631       residual = 1.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-04 is 2.496632e-03

solving harmonic davidson linear method for identity shift 2.3842e-03, overlap shift 2.3842e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.912492190217       residual = 1.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913229261460       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913323877473       residual = 6.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913361156437       residual = 9.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913369243336       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913368269158       residual = 9.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913368434182       residual = 1.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913368812371       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913368628202       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913368521517       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913368469559       residual = 1.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913368459202       residual = 1.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-03 is 2.435751e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.579850 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6398e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
ci_001                -4.277107e-02 3 1  ON 0
ci_002                -3.339522e-02 3 1  ON 1
ci_003                -2.638244e-02 3 1  ON 2
ci_004                 2.242273e-02 3 1  ON 3
ci_005                 2.427045e-02 3 1  ON 4
ci_006                -2.123950e-02 3 1  ON 5
ci_007                -2.188885e-02 3 1  ON 6
ci_008                -8.826762e-03 3 1  ON 7
ci_009                -1.419679e-02 3 1  ON 8
ci_010                -8.616269e-03 3 1  ON 9
ci_011                -9.508994e-03 3 1  ON 10
ci_012                -1.093709e-02 3 1  ON 11
ci_013                -1.945345e-02 3 1  ON 12
ci_014                 1.282483e-02 3 1  ON 13
ci_015                 1.250562e-02 3 1  ON 14
ci_016                 1.735909e-02 3 1  ON 15
ci_017                 1.716490e-02 3 1  ON 16
ci_018                 1.213983e-02 3 1  ON 17
ci_019                 1.079595e-02 3 1  ON 18
ci_020                 1.796521e-02 3 1  ON 19
ci_021                 1.830748e-02 3 1  ON 20
ci_022                 1.001957e-02 3 1  ON 21
ci_023                 1.008141e-02 3 1  ON 22
ci_024                 9.426359e-03 3 1  ON 23
ci_025                 9.640889e-03 3 1  ON 24
ci_026                 1.269489e-02 3 1  ON 25
ci_027                 1.102306e-02 3 1  ON 26
ci_028                -1.669052e-02 3 1  ON 27
ci_029                -1.676545e-02 3 1  ON 28
ci_030                -9.268038e-03 3 1  ON 29
ci_031                -8.520325e-03 3 1  ON 30
ci_032                -1.458629e-02 3 1  ON 31
ci_033                 5.851143e-03 3 1  ON 32
ci_034                 5.569883e-03 3 1  ON 33
ci_035                -4.865475e-03 3 1  ON 34
ci_036                -1.264903e-02 3 1  ON 35
ci_037                -1.415461e-02 3 1  ON 36
ci_038                 2.010939e-03 3 1  ON 37
ci_039                 2.395772e-03 3 1  ON 38
ci_040                -3.822454e-03 3 1  ON 39
ci_041                 8.682724e-03 3 1  ON 40
ci_042                 9.634510e-03 3 1  ON 41
ci_043                -4.142158e-03 3 1  ON 42
ci_044                -5.280894e-03 3 1  ON 43
ci_045                -3.554021e-03 3 1  ON 44
ci_046                 5.868087e-03 3 1  ON 45
ci_047                 5.970562e-03 3 1  ON 46
ci_048                -1.358047e-02 3 1  ON 47
ci_049                -1.354962e-02 3 1  ON 48
ci_050                 3.271588e-03 3 1  ON 49
ci_051                 3.145190e-03 3 1  ON 50
ci_052                -2.324067e-03 3 1  ON 51
ci_053                -1.237629e-03 3 1  ON 52
ci_054                -3.400230e-03 3 1  ON 53
ci_055                -3.129546e-03 3 1  ON 54
ci_056                 5.489112e-03 3 1  ON 55
ci_057                 5.792365e-03 3 1  ON 56
ci_058                -2.396829e-03 3 1  ON 57
ci_059                -1.723796e-03 3 1  ON 58
ci_060                 4.958115e-03 3 1  ON 59
ci_061                 5.084805e-03 3 1  ON 60
ci_062                -4.202193e-03 3 1  ON 61
ci_063                -4.161271e-03 3 1  ON 62
ci_064                -3.201779e-03 3 1  ON 63
ci_065                -4.032432e-03 3 1  ON 64
ci_066                 5.022407e-03 3 1  ON 65
ci_067                 4.546305e-03 3 1  ON 66
ci_068                -6.127809e-03 3 1  ON 67
ci_069                -4.034068e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.2072
    reference variance = 0.21851
====================================================
  Execution time = 1.3787e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.9022e-01
  Total weights = 1.9572e+06
  Execution time = 1.8550e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282433536746
                                         uncertainty =       0.004057068249

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282433536746
                                         uncertainty =       0.004057068249

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375733348
  error estimate for blocks of size 2^( 2) =       0.000389372985
  error estimate for blocks of size 2^( 3) =       0.000401588575
  error estimate for blocks of size 2^( 4) =       0.000410709490
  error estimate for blocks of size 2^( 5) =       0.000416813950
  error estimate for blocks of size 2^( 6) =       0.000419569120
  error estimate for blocks of size 2^( 7) =       0.000420053163

      target function =      -0.546912440334
              le_mean =     -17.213094376145
             les_mean =     297.003075761465
             stat err =       0.000416786431
             autocorr =       1.230460446821
   target nu stat err =       0.000416786431
   target dn stat err =       0.237973226282
      target stat err =       0.115489587263
              std dev =       0.531367196708
             le_variance =       0.282351097737

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276384287628
                                         uncertainty =       0.001670501728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276384287628
                                         uncertainty =       0.001670501728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371694944
  error estimate for blocks of size 2^( 2) =       0.000385547163
  error estimate for blocks of size 2^( 3) =       0.000397974095
  error estimate for blocks of size 2^( 4) =       0.000407234274
  error estimate for blocks of size 2^( 5) =       0.000413524439
  error estimate for blocks of size 2^( 6) =       0.000416410988
  error estimate for blocks of size 2^( 7) =       0.000416951493

      target function =      -0.913510210472
              le_mean =     -17.212878422796
             les_mean =     296.573403269748
             stat err =       0.000413530299
             autocorr =       1.237774018459
   target nu stat err =       0.000413530299
   target dn stat err =       0.002945740548
      target stat err =       0.003861823853
              std dev =       0.525656031163
             le_variance =       0.276314263098

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285207214844
                                         uncertainty =       0.007155999528

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285207214844
                                         uncertainty =       0.007155999528

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377567146
  error estimate for blocks of size 2^( 2) =       0.000391327842
  error estimate for blocks of size 2^( 3) =       0.000403702624
  error estimate for blocks of size 2^( 4) =       0.000412849608
  error estimate for blocks of size 2^( 5) =       0.000419206231
  error estimate for blocks of size 2^( 6) =       0.000422204756
  error estimate for blocks of size 2^( 7) =       0.000423156533

      target function =      -0.649060092774
              le_mean =     -17.213038394291
             les_mean =     296.830106360401
             stat err =       0.000419354282
             autocorr =       1.233598321905
   target nu stat err =       0.000419354282
   target dn stat err =       0.185602559491
      target stat err =       0.126014927109
              std dev =       0.533960578530
             le_variance =       0.285113899424

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276372746191
                                         uncertainty =       0.001669243448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276372746191
                                         uncertainty =       0.001669243448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371687224
  error estimate for blocks of size 2^( 2) =       0.000385536634
  error estimate for blocks of size 2^( 3) =       0.000397960581
  error estimate for blocks of size 2^( 4) =       0.000407218757
  error estimate for blocks of size 2^( 5) =       0.000413506374
  error estimate for blocks of size 2^( 6) =       0.000416390980
  error estimate for blocks of size 2^( 7) =       0.000416929504

      target function =      -0.913416622048
              le_mean =     -17.212879076466
             les_mean =     296.573498046357
             stat err =       0.000413511404
             autocorr =       1.237712323276
   target nu stat err =       0.000413511404
   target dn stat err =       0.002956097122
      target stat err =       0.003874303955
              std dev =       0.525645113478
             le_variance =       0.276302785323


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.546912440334        initial
     1.4901e-04     1.4901e-03             2.5123e-03        -0.913510210472  <--
     5.9605e-04     5.9605e-03             2.4966e-03        -0.649060092774
     2.3842e-03     2.3842e-02             2.4358e-03        -0.913416622048

*****************************************************************************
Applying the update for shift_i =   1.4901e-04     and shift_s =   1.4901e-03
*****************************************************************************

  Execution time = 2.3142e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
ci_001                -4.277459e-02 3 1  ON 0
ci_002                -3.339835e-02 3 1  ON 1
ci_003                -2.637477e-02 3 1  ON 2
ci_004                 2.241261e-02 3 1  ON 3
ci_005                 2.426659e-02 3 1  ON 4
ci_006                -2.123439e-02 3 1  ON 5
ci_007                -2.189032e-02 3 1  ON 6
ci_008                -8.827469e-03 3 1  ON 7
ci_009                -1.419630e-02 3 1  ON 8
ci_010                -8.610673e-03 3 1  ON 9
ci_011                -9.493295e-03 3 1  ON 10
ci_012                -1.093821e-02 3 1  ON 11
ci_013                -1.946251e-02 3 1  ON 12
ci_014                 1.282172e-02 3 1  ON 13
ci_015                 1.250659e-02 3 1  ON 14
ci_016                 1.735889e-02 3 1  ON 15
ci_017                 1.716604e-02 3 1  ON 16
ci_018                 1.214354e-02 3 1  ON 17
ci_019                 1.079117e-02 3 1  ON 18
ci_020                 1.795804e-02 3 1  ON 19
ci_021                 1.831359e-02 3 1  ON 20
ci_022                 1.002466e-02 3 1  ON 21
ci_023                 1.008330e-02 3 1  ON 22
ci_024                 9.427216e-03 3 1  ON 23
ci_025                 9.637416e-03 3 1  ON 24
ci_026                 1.269463e-02 3 1  ON 25
ci_027                 1.102021e-02 3 1  ON 26
ci_028                -1.670542e-02 3 1  ON 27
ci_029                -1.678004e-02 3 1  ON 28
ci_030                -9.267363e-03 3 1  ON 29
ci_031                -8.513664e-03 3 1  ON 30
ci_032                -1.458737e-02 3 1  ON 31
ci_033                 5.849404e-03 3 1  ON 32
ci_034                 5.565004e-03 3 1  ON 33
ci_035                -4.863002e-03 3 1  ON 34
ci_036                -1.264683e-02 3 1  ON 35
ci_037                -1.416532e-02 3 1  ON 36
ci_038                 2.011124e-03 3 1  ON 37
ci_039                 2.394413e-03 3 1  ON 38
ci_040                -3.825220e-03 3 1  ON 39
ci_041                 8.683410e-03 3 1  ON 40
ci_042                 9.638434e-03 3 1  ON 41
ci_043                -4.141074e-03 3 1  ON 42
ci_044                -5.295579e-03 3 1  ON 43
ci_045                -3.554804e-03 3 1  ON 44
ci_046                 5.869342e-03 3 1  ON 45
ci_047                 5.973997e-03 3 1  ON 46
ci_048                -1.358460e-02 3 1  ON 47
ci_049                -1.355814e-02 3 1  ON 48
ci_050                 3.268303e-03 3 1  ON 49
ci_051                 3.146306e-03 3 1  ON 50
ci_052                -2.318946e-03 3 1  ON 51
ci_053                -1.229385e-03 3 1  ON 52
ci_054                -3.403915e-03 3 1  ON 53
ci_055                -3.128251e-03 3 1  ON 54
ci_056                 5.485509e-03 3 1  ON 55
ci_057                 5.787578e-03 3 1  ON 56
ci_058                -2.398801e-03 3 1  ON 57
ci_059                -1.716435e-03 3 1  ON 58
ci_060                 4.959596e-03 3 1  ON 59
ci_061                 5.080636e-03 3 1  ON 60
ci_062                -4.202327e-03 3 1  ON 61
ci_063                -4.162436e-03 3 1  ON 62
ci_064                -3.202302e-03 3 1  ON 63
ci_065                -4.031685e-03 3 1  ON 64
ci_066                 5.022623e-03 3 1  ON 65
ci_067                 4.545168e-03 3 1  ON 66
ci_068                -6.138666e-03 3 1  ON 67
ci_069                -4.026949e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9555e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.2224
    reference variance = 0.201948
====================================================
  Execution time = 1.4015e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8864e-01
  Total weights = 1.956800572e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4948e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276584275150
                                         uncertainty =       0.001468654628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276584275150
                                         uncertainty =       0.001468654628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371870779
  error estimate for blocks of size 2^( 2) =       0.000385830928
  error estimate for blocks of size 2^( 3) =       0.000398407143
  error estimate for blocks of size 2^( 4) =       0.000406680860
  error estimate for blocks of size 2^( 5) =       0.000412598032
  error estimate for blocks of size 2^( 6) =       0.000415283289
  error estimate for blocks of size 2^( 7) =       0.000418415482

      target function =      -0.915441496513
              le_mean =     -17.212397313493
             les_mean =     296.555264673111
             stat err =       0.000413244416
             autocorr =       1.234894566972
   target nu stat err =       0.000413244416
   target dn stat err =       0.002202096827
      target stat err =       0.002922881288
              std dev =       0.525904698993
             le_variance =       0.276575752423


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721239731349e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-05, overlap shift 3.7253e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915449967438       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916112266966       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916221200751       residual = 7.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916272059334       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916285071897       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916290227677       residual = 9.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916291460641       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916291174643       residual = 4.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916291414550       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916291389694       residual = 3.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916291369749       residual = 7.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-05 is 2.131835e-03

solving harmonic davidson linear method for identity shift 1.4901e-04, overlap shift 1.4901e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915449967438       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916111324555       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916220064159       residual = 7.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916270805416       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916283784286       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916288923650       residual = 9.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916290153162       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916289867346       residual = 4.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916290106222       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916290081941       residual = 3.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916290061850       residual = 7.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-04 is 2.128016e-03

solving harmonic davidson linear method for identity shift 5.9605e-04, overlap shift 5.9605e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915449967438       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916107581557       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916215551135       residual = 7.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916265828030       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916278673715       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916283748272       residual = 8.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916284964184       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916284679143       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916284913922       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916284891880       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916284871248       residual = 7.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-04 is 2.112881e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.588776 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6527e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
ci_001                -4.204518e-02 3 1  ON 0
ci_002                -3.351968e-02 3 1  ON 1
ci_003                -2.807372e-02 3 1  ON 2
ci_004                 2.357255e-02 3 1  ON 3
ci_005                 2.243192e-02 3 1  ON 4
ci_006                -2.247642e-02 3 1  ON 5
ci_007                -2.150691e-02 3 1  ON 6
ci_008                -9.524647e-03 3 1  ON 7
ci_009                -1.509575e-02 3 1  ON 8
ci_010                -8.542978e-03 3 1  ON 9
ci_011                -1.101897e-02 3 1  ON 10
ci_012                -1.127671e-02 3 1  ON 11
ci_013                -2.002218e-02 3 1  ON 12
ci_014                 1.223083e-02 3 1  ON 13
ci_015                 1.280399e-02 3 1  ON 14
ci_016                 1.732920e-02 3 1  ON 15
ci_017                 1.598665e-02 3 1  ON 16
ci_018                 1.176563e-02 3 1  ON 17
ci_019                 1.104876e-02 3 1  ON 18
ci_020                 1.810191e-02 3 1  ON 19
ci_021                 1.773219e-02 3 1  ON 20
ci_022                 1.104565e-02 3 1  ON 21
ci_023                 1.073988e-02 3 1  ON 22
ci_024                 8.148234e-03 3 1  ON 23
ci_025                 1.053546e-02 3 1  ON 24
ci_026                 1.174517e-02 3 1  ON 25
ci_027                 9.826433e-03 3 1  ON 26
ci_028                -1.600554e-02 3 1  ON 27
ci_029                -1.558911e-02 3 1  ON 28
ci_030                -9.579405e-03 3 1  ON 29
ci_031                -9.610892e-03 3 1  ON 30
ci_032                -1.372085e-02 3 1  ON 31
ci_033                 5.835413e-03 3 1  ON 32
ci_034                 6.036674e-03 3 1  ON 33
ci_035                -5.959698e-03 3 1  ON 34
ci_036                -1.380461e-02 3 1  ON 35
ci_037                -1.394719e-02 3 1  ON 36
ci_038                 1.564621e-03 3 1  ON 37
ci_039                 2.419548e-03 3 1  ON 38
ci_040                -3.563971e-03 3 1  ON 39
ci_041                 8.673482e-03 3 1  ON 40
ci_042                 9.629973e-03 3 1  ON 41
ci_043                -4.277321e-03 3 1  ON 42
ci_044                -4.792549e-03 3 1  ON 43
ci_045                -3.239293e-03 3 1  ON 44
ci_046                 5.090671e-03 3 1  ON 45
ci_047                 5.496708e-03 3 1  ON 46
ci_048                -1.145658e-02 3 1  ON 47
ci_049                -1.289754e-02 3 1  ON 48
ci_050                 3.460125e-03 3 1  ON 49
ci_051                 3.664771e-03 3 1  ON 50
ci_052                -2.640246e-03 3 1  ON 51
ci_053                -3.091650e-03 3 1  ON 52
ci_054                -1.968785e-03 3 1  ON 53
ci_055                -2.874535e-03 3 1  ON 54
ci_056                 6.299583e-03 3 1  ON 55
ci_057                 5.527064e-03 3 1  ON 56
ci_058                -2.684968e-03 3 1  ON 57
ci_059                -2.494232e-03 3 1  ON 58
ci_060                 5.481155e-03 3 1  ON 59
ci_061                 4.752641e-03 3 1  ON 60
ci_062                -3.001954e-03 3 1  ON 61
ci_063                -4.267670e-03 3 1  ON 62
ci_064                -3.398275e-03 3 1  ON 63
ci_065                -3.951920e-03 3 1  ON 64
ci_066                 4.816917e-03 3 1  ON 65
ci_067                 4.868461e-03 3 1  ON 66
ci_068                -4.560144e-03 3 1  ON 67
ci_069                -5.448737e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.243
    reference variance = 0.318485
====================================================
  Execution time = 1.3627e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8368e-01
  Total weights = 1.9573e+06
  Execution time = 1.8456e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276829035540
                                         uncertainty =       0.003710747584

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276829035540
                                         uncertainty =       0.003710747584

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372011730
  error estimate for blocks of size 2^( 2) =       0.000385884016
  error estimate for blocks of size 2^( 3) =       0.000398097306
  error estimate for blocks of size 2^( 4) =       0.000407285610
  error estimate for blocks of size 2^( 5) =       0.000413768910
  error estimate for blocks of size 2^( 6) =       0.000416872557
  error estimate for blocks of size 2^( 7) =       0.000418365692

      target function =      -0.899965438833
              le_mean =     -17.212663405657
             les_mean =     296.576495792626
             stat err =       0.000414073192
             autocorr =       1.238913429202
   target nu stat err =       0.000414073192
   target dn stat err =       0.008048435128
      target stat err =       0.010136229470
              std dev =       0.526104034472
             le_variance =       0.276785455088

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273306915372
                                         uncertainty =       0.001404634876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273306915372
                                         uncertainty =       0.001404634876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369634141
  error estimate for blocks of size 2^( 2) =       0.000383499893
  error estimate for blocks of size 2^( 3) =       0.000395664817
  error estimate for blocks of size 2^( 4) =       0.000404821559
  error estimate for blocks of size 2^( 5) =       0.000411220035
  error estimate for blocks of size 2^( 6) =       0.000414559762
  error estimate for blocks of size 2^( 7) =       0.000416090028

      target function =      -0.921999742855
              le_mean =     -17.212561208049
             les_mean =     296.555934248097
             stat err =       0.000411672846
             autocorr =       1.240395800971
   target nu stat err =       0.000411672846
   target dn stat err =       0.001854013429
      target stat err =       0.002515946290
              std dev =       0.522741615952
             le_variance =       0.273258797048

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275051338534
                                         uncertainty =       0.001465652699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275051338534
                                         uncertainty =       0.001465652699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370809341
  error estimate for blocks of size 2^( 2) =       0.000384575025
  error estimate for blocks of size 2^( 3) =       0.000396615249
  error estimate for blocks of size 2^( 4) =       0.000405686457
  error estimate for blocks of size 2^( 5) =       0.000412000063
  error estimate for blocks of size 2^( 6) =       0.000415392860
  error estimate for blocks of size 2^( 7) =       0.000416857456

      target function =      -0.850887402490
              le_mean =     -17.212666998351
             les_mean =     296.616691788739
             stat err =       0.000412484209
             autocorr =       1.237409146080
   target nu stat err =       0.000412484209
   target dn stat err =       0.031449473104
      target stat err =       0.035408901319
              std dev =       0.524403599597
             le_variance =       0.274999135270

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273303685787
                                         uncertainty =       0.001404782811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273303685787
                                         uncertainty =       0.001404782811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369631971
  error estimate for blocks of size 2^( 2) =       0.000383498403
  error estimate for blocks of size 2^( 3) =       0.000395663963
  error estimate for blocks of size 2^( 4) =       0.000404821234
  error estimate for blocks of size 2^( 5) =       0.000411220145
  error estimate for blocks of size 2^( 6) =       0.000414559322
  error estimate for blocks of size 2^( 7) =       0.000416089972

      target function =      -0.921070428097
              le_mean =     -17.212561246360
             les_mean =     296.556640019647
             stat err =       0.000411672668
             autocorr =       1.240409298355
   target nu stat err =       0.000411672668
   target dn stat err =       0.001976166227
      target stat err =       0.002667638124
              std dev =       0.522738546307
             le_variance =       0.273255587795


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.899965438833        initial
     3.7253e-05     3.7253e-04             2.1318e-03        -0.921999742855  <--
     1.4901e-04     1.4901e-03             2.1280e-03        -0.850887402490
     5.9605e-04     5.9605e-03             2.1129e-03        -0.921070428097

*****************************************************************************
Applying the update for shift_i =   3.7253e-05     and shift_s =   3.7253e-04
*****************************************************************************

  Execution time = 2.2944e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
ci_001                -4.204394e-02 3 1  ON 0
ci_002                -3.351996e-02 3 1  ON 1
ci_003                -2.807696e-02 3 1  ON 2
ci_004                 2.357458e-02 3 1  ON 3
ci_005                 2.242837e-02 3 1  ON 4
ci_006                -2.247888e-02 3 1  ON 5
ci_007                -2.150629e-02 3 1  ON 6
ci_008                -9.525759e-03 3 1  ON 7
ci_009                -1.509713e-02 3 1  ON 8
ci_010                -8.542874e-03 3 1  ON 9
ci_011                -1.102141e-02 3 1  ON 10
ci_012                -1.127725e-02 3 1  ON 11
ci_013                -2.002325e-02 3 1  ON 12
ci_014                 1.222975e-02 3 1  ON 13
ci_015                 1.280447e-02 3 1  ON 14
ci_016                 1.732919e-02 3 1  ON 15
ci_017                 1.598448e-02 3 1  ON 16
ci_018                 1.176502e-02 3 1  ON 17
ci_019                 1.104919e-02 3 1  ON 18
ci_020                 1.810228e-02 3 1  ON 19
ci_021                 1.773113e-02 3 1  ON 20
ci_022                 1.104713e-02 3 1  ON 21
ci_023                 1.074094e-02 3 1  ON 22
ci_024                 8.145929e-03 3 1  ON 23
ci_025                 1.053702e-02 3 1  ON 24
ci_026                 1.174400e-02 3 1  ON 25
ci_027                 9.824411e-03 3 1  ON 26
ci_028                -1.600428e-02 3 1  ON 27
ci_029                -1.558691e-02 3 1  ON 28
ci_030                -9.579578e-03 3 1  ON 29
ci_031                -9.612323e-03 3 1  ON 30
ci_032                -1.371939e-02 3 1  ON 31
ci_033                 5.835423e-03 3 1  ON 32
ci_034                 6.037425e-03 3 1  ON 33
ci_035                -5.961340e-03 3 1  ON 34
ci_036                -1.380663e-02 3 1  ON 35
ci_037                -1.394728e-02 3 1  ON 36
ci_038                 1.563976e-03 3 1  ON 37
ci_039                 2.419597e-03 3 1  ON 38
ci_040                -3.563590e-03 3 1  ON 39
ci_041                 8.673365e-03 3 1  ON 40
ci_042                 9.629754e-03 3 1  ON 41
ci_043                -4.277517e-03 3 1  ON 42
ci_044                -4.791736e-03 3 1  ON 43
ci_045                -3.238844e-03 3 1  ON 44
ci_046                 5.089426e-03 3 1  ON 45
ci_047                 5.495935e-03 3 1  ON 46
ci_048                -1.145276e-02 3 1  ON 47
ci_049                -1.289660e-02 3 1  ON 48
ci_050                 3.460400e-03 3 1  ON 49
ci_051                 3.665479e-03 3 1  ON 50
ci_052                -2.640651e-03 3 1  ON 51
ci_053                -3.094266e-03 3 1  ON 52
ci_054                -1.966650e-03 3 1  ON 53
ci_055                -2.874246e-03 3 1  ON 54
ci_056                 6.300819e-03 3 1  ON 55
ci_057                 5.526666e-03 3 1  ON 56
ci_058                -2.685377e-03 3 1  ON 57
ci_059                -2.495456e-03 3 1  ON 58
ci_060                 5.482016e-03 3 1  ON 59
ci_061                 4.752125e-03 3 1  ON 60
ci_062                -2.999999e-03 3 1  ON 61
ci_063                -4.267911e-03 3 1  ON 62
ci_064                -3.398547e-03 3 1  ON 63
ci_065                -3.951805e-03 3 1  ON 64
ci_066                 4.816593e-03 3 1  ON 65
ci_067                 4.868943e-03 3 1  ON 66
ci_068                -4.557517e-03 3 1  ON 67
ci_069                -5.451036e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9486e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.1123
    reference variance = 0.484209
====================================================
  Execution time = 1.3978e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9191e-01
  Total weights = 1.957181696e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4918e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278488060030
                                         uncertainty =       0.001891820959

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278488060030
                                         uncertainty =       0.001891820959

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373113771
  error estimate for blocks of size 2^( 2) =       0.000387137084
  error estimate for blocks of size 2^( 3) =       0.000399277042
  error estimate for blocks of size 2^( 4) =       0.000407818110
  error estimate for blocks of size 2^( 5) =       0.000412488537
  error estimate for blocks of size 2^( 6) =       0.000414965690
  error estimate for blocks of size 2^( 7) =       0.000415909204

      target function =      -0.911063950947
              le_mean =     -17.211798209834
             les_mean =     296.537905716867
             stat err =       0.000412795385
             autocorr =       1.224016043878
   target nu stat err =       0.000412795385
   target dn stat err =       0.002648417591
      target stat err =       0.003457179548
              std dev =       0.527662554925
             le_variance =       0.278427771870


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721179820983e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-06, overlap shift 9.3132e-05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911076316413       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911694772733       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911817231046       residual = 6.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911849449796       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911855846554       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911859135056       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911860260276       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911860646411       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911860317484       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911860264512       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911860309033       residual = 8.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-06 is 2.299324e-03

solving harmonic davidson linear method for identity shift 3.7253e-05, overlap shift 3.7253e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911076316413       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911694551497       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911816953217       residual = 6.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911849152202       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911855543980       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911858829814       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911859954067       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911860339876       residual = 6.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911860011187       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911859958276       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911860002757       residual = 8.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-05 is 2.298189e-03

solving harmonic davidson linear method for identity shift 1.4901e-04, overlap shift 1.4901e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911076316413       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.911693668132       residual = 2.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.911815843985       residual = 6.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.911847964131       residual = 1.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.911854336052       residual = 5.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.911857611251       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.911858731653       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.911859116161       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.911858788420       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.911858735752       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911858780076       residual = 8.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-04 is 2.293661e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.592937 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6480e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
ci_001                -4.251427e-02 3 1  ON 0
ci_002                -3.257746e-02 3 1  ON 1
ci_003                -2.577877e-02 3 1  ON 2
ci_004                 2.320179e-02 3 1  ON 3
ci_005                 2.323905e-02 3 1  ON 4
ci_006                -2.116110e-02 3 1  ON 5
ci_007                -2.161279e-02 3 1  ON 6
ci_008                -8.684264e-03 3 1  ON 7
ci_009                -1.469434e-02 3 1  ON 8
ci_010                -9.645663e-03 3 1  ON 9
ci_011                -1.158476e-02 3 1  ON 10
ci_012                -9.956685e-03 3 1  ON 11
ci_013                -2.001380e-02 3 1  ON 12
ci_014                 1.301908e-02 3 1  ON 13
ci_015                 1.188237e-02 3 1  ON 14
ci_016                 1.695177e-02 3 1  ON 15
ci_017                 1.739483e-02 3 1  ON 16
ci_018                 1.102416e-02 3 1  ON 17
ci_019                 1.103477e-02 3 1  ON 18
ci_020                 1.838013e-02 3 1  ON 19
ci_021                 1.788687e-02 3 1  ON 20
ci_022                 1.020547e-02 3 1  ON 21
ci_023                 8.749512e-03 3 1  ON 22
ci_024                 8.872763e-03 3 1  ON 23
ci_025                 1.064423e-02 3 1  ON 24
ci_026                 1.198141e-02 3 1  ON 25
ci_027                 1.212088e-02 3 1  ON 26
ci_028                -1.589987e-02 3 1  ON 27
ci_029                -1.687472e-02 3 1  ON 28
ci_030                -9.691464e-03 3 1  ON 29
ci_031                -9.852863e-03 3 1  ON 30
ci_032                -1.560330e-02 3 1  ON 31
ci_033                 4.201069e-03 3 1  ON 32
ci_034                 5.144029e-03 3 1  ON 33
ci_035                -5.794114e-03 3 1  ON 34
ci_036                -1.279352e-02 3 1  ON 35
ci_037                -1.244803e-02 3 1  ON 36
ci_038                 1.803098e-03 3 1  ON 37
ci_039                 2.845962e-03 3 1  ON 38
ci_040                -3.421700e-03 3 1  ON 39
ci_041                 8.841753e-03 3 1  ON 40
ci_042                 9.408631e-03 3 1  ON 41
ci_043                -3.782238e-03 3 1  ON 42
ci_044                -5.258938e-03 3 1  ON 43
ci_045                -3.030220e-03 3 1  ON 44
ci_046                 5.975088e-03 3 1  ON 45
ci_047                 4.905095e-03 3 1  ON 46
ci_048                -1.158418e-02 3 1  ON 47
ci_049                -1.411952e-02 3 1  ON 48
ci_050                 2.977317e-03 3 1  ON 49
ci_051                 2.748187e-03 3 1  ON 50
ci_052                -3.023892e-03 3 1  ON 51
ci_053                -1.555353e-03 3 1  ON 52
ci_054                -3.059744e-03 3 1  ON 53
ci_055                -2.595692e-03 3 1  ON 54
ci_056                 5.383337e-03 3 1  ON 55
ci_057                 5.746694e-03 3 1  ON 56
ci_058                -2.446227e-03 3 1  ON 57
ci_059                -2.333645e-03 3 1  ON 58
ci_060                 4.517664e-03 3 1  ON 59
ci_061                 4.202592e-03 3 1  ON 60
ci_062                -4.105727e-03 3 1  ON 61
ci_063                -3.762345e-03 3 1  ON 62
ci_064                -3.413190e-03 3 1  ON 63
ci_065                -4.119972e-03 3 1  ON 64
ci_066                 4.771765e-03 3 1  ON 65
ci_067                 4.450010e-03 3 1  ON 66
ci_068                -4.484919e-03 3 1  ON 67
ci_069                -4.637304e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.2409
    reference variance = 0.23262
====================================================
  Execution time = 1.3503e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8255e-01
  Total weights = 1.9571e+06
  Execution time = 1.8611e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278719645436
                                         uncertainty =       0.004734213513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278719645436
                                         uncertainty =       0.004734213513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373307602
  error estimate for blocks of size 2^( 2) =       0.000386950520
  error estimate for blocks of size 2^( 3) =       0.000399082652
  error estimate for blocks of size 2^( 4) =       0.000407875296
  error estimate for blocks of size 2^( 5) =       0.000413258334
  error estimate for blocks of size 2^( 6) =       0.000415466557
  error estimate for blocks of size 2^( 7) =       0.000417438724

      target function =      -0.369742543885
              le_mean =     -17.211725274206
             les_mean =     297.266585399826
             stat err =       0.000413509728
             autocorr =       1.226980871675
   target nu stat err =       0.000413509728
   target dn stat err =       0.663457819580
      target stat err =       0.170429484469
              std dev =       0.527936674379
             le_variance =       0.278717132154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273061648665
                                         uncertainty =       0.001280420695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273061648665
                                         uncertainty =       0.001280420695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369506823
  error estimate for blocks of size 2^( 2) =       0.000383356920
  error estimate for blocks of size 2^( 3) =       0.000395684953
  error estimate for blocks of size 2^( 4) =       0.000404756824
  error estimate for blocks of size 2^( 5) =       0.000410262931
  error estimate for blocks of size 2^( 6) =       0.000412666062
  error estimate for blocks of size 2^( 7) =       0.000414605535

      target function =      -0.923212887501
              le_mean =     -17.211585968173
             les_mean =     296.521243567179
             stat err =       0.000410572838
             autocorr =       1.234626247254
   target nu stat err =       0.000410572838
   target dn stat err =       0.001686336502
      target stat err =       0.002303431146
              std dev =       0.522561560404
             le_variance =       0.273070584412

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284310214011
                                         uncertainty =       0.006580241460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284310214011
                                         uncertainty =       0.006580241460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377045892
  error estimate for blocks of size 2^( 2) =       0.000390858617
  error estimate for blocks of size 2^( 3) =       0.000403146703
  error estimate for blocks of size 2^( 4) =       0.000412141158
  error estimate for blocks of size 2^( 5) =       0.000417546841
  error estimate for blocks of size 2^( 6) =       0.000420101543
  error estimate for blocks of size 2^( 7) =       0.000422363010

      target function =      -0.244717520113
              le_mean =     -17.211609901542
             les_mean =     297.827180674102
             stat err =       0.000418038138
             autocorr =       1.229258959217
   target nu stat err =       0.000418038138
   target dn stat err =       1.126750634701
      target stat err =       0.137587748335
              std dev =       0.533223414402
             le_variance =       0.284327209666

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273060958189
                                         uncertainty =       0.001280455141

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273060958189
                                         uncertainty =       0.001280455141

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369506354
  error estimate for blocks of size 2^( 2) =       0.000383356168
  error estimate for blocks of size 2^( 3) =       0.000395683891
  error estimate for blocks of size 2^( 4) =       0.000404755479
  error estimate for blocks of size 2^( 5) =       0.000410261442
  error estimate for blocks of size 2^( 6) =       0.000412664462
  error estimate for blocks of size 2^( 7) =       0.000414603984

      target function =      -0.923218824961
              le_mean =     -17.211585956413
             les_mean =     296.521238666671
             stat err =       0.000410571342
             autocorr =       1.234620382627
   target nu stat err =       0.000410571342
   target dn stat err =       0.001685883256
      target stat err =       0.002302880365
              std dev =       0.522560897051
             le_variance =       0.273069891127


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.369742543885        initial
     9.3132e-06     9.3132e-05             2.2993e-03        -0.923212887501
     3.7253e-05     3.7253e-04             2.2982e-03        -0.244717520113
     1.4901e-04     1.4901e-03             2.2937e-03        -0.923218824961  <--

*****************************************************************************
Applying the update for shift_i =   1.4901e-04     and shift_s =   1.4901e-03
*****************************************************************************

  Execution time = 2.2874e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
ci_001                -4.251356e-02 3 1  ON 0
ci_002                -3.257918e-02 3 1  ON 1
ci_003                -2.578330e-02 3 1  ON 2
ci_004                 2.320250e-02 3 1  ON 3
ci_005                 2.323706e-02 3 1  ON 4
ci_006                -2.116366e-02 3 1  ON 5
ci_007                -2.161265e-02 3 1  ON 6
ci_008                -8.685649e-03 3 1  ON 7
ci_009                -1.469498e-02 3 1  ON 8
ci_010                -9.643934e-03 3 1  ON 9
ci_011                -1.158392e-02 3 1  ON 10
ci_012                -9.958775e-03 3 1  ON 11
ci_013                -2.001385e-02 3 1  ON 12
ci_014                 1.301767e-02 3 1  ON 13
ci_015                 1.188383e-02 3 1  ON 14
ci_016                 1.695248e-02 3 1  ON 15
ci_017                 1.739212e-02 3 1  ON 16
ci_018                 1.102523e-02 3 1  ON 17
ci_019                 1.103473e-02 3 1  ON 18
ci_020                 1.837961e-02 3 1  ON 19
ci_021                 1.788674e-02 3 1  ON 20
ci_022                 1.020669e-02 3 1  ON 21
ci_023                 8.752836e-03 3 1  ON 22
ci_024                 8.871320e-03 3 1  ON 23
ci_025                 1.064411e-02 3 1  ON 24
ci_026                 1.198115e-02 3 1  ON 25
ci_027                 1.211728e-02 3 1  ON 26
ci_028                -1.589996e-02 3 1  ON 27
ci_029                -1.687231e-02 3 1  ON 28
ci_030                -9.691323e-03 3 1  ON 29
ci_031                -9.852179e-03 3 1  ON 30
ci_032                -1.560015e-02 3 1  ON 31
ci_033                 4.203746e-03 3 1  ON 32
ci_034                 5.145433e-03 3 1  ON 33
ci_035                -5.794363e-03 3 1  ON 34
ci_036                -1.279551e-02 3 1  ON 35
ci_037                -1.245070e-02 3 1  ON 36
ci_038                 1.802748e-03 3 1  ON 37
ci_039                 2.845345e-03 3 1  ON 38
ci_040                -3.421904e-03 3 1  ON 39
ci_041                 8.841483e-03 3 1  ON 40
ci_042                 9.408708e-03 3 1  ON 41
ci_043                -3.782985e-03 3 1  ON 42
ci_044                -5.258244e-03 3 1  ON 43
ci_045                -3.030514e-03 3 1  ON 44
ci_046                 5.973634e-03 3 1  ON 45
ci_047                 4.906069e-03 3 1  ON 46
ci_048                -1.158393e-02 3 1  ON 47
ci_049                -1.411716e-02 3 1  ON 48
ci_050                 2.977982e-03 3 1  ON 49
ci_051                 2.749437e-03 3 1  ON 50
ci_052                -3.023140e-03 3 1  ON 51
ci_053                -1.557484e-03 3 1  ON 52
ci_054                -3.058074e-03 3 1  ON 53
ci_055                -2.596137e-03 3 1  ON 54
ci_056                 5.384720e-03 3 1  ON 55
ci_057                 5.746346e-03 3 1  ON 56
ci_058                -2.446492e-03 3 1  ON 57
ci_059                -2.334005e-03 3 1  ON 58
ci_060                 4.519224e-03 3 1  ON 59
ci_061                 4.203493e-03 3 1  ON 60
ci_062                -4.103940e-03 3 1  ON 61
ci_063                -3.763148e-03 3 1  ON 62
ci_064                -3.413168e-03 3 1  ON 63
ci_065                -4.119719e-03 3 1  ON 64
ci_066                 4.771729e-03 3 1  ON 65
ci_067                 4.450599e-03 3 1  ON 66
ci_068                -4.484924e-03 3 1  ON 67
ci_069                -4.638618e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9359e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.1061
    reference variance = 0.476143
====================================================
  Execution time = 1.4139e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8883e-01
  Total weights = 1.957324484e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4946e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277194234092
                                         uncertainty =       0.001815174207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277194234092
                                         uncertainty =       0.001815174207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372290822
  error estimate for blocks of size 2^( 2) =       0.000386193584
  error estimate for blocks of size 2^( 3) =       0.000399022568
  error estimate for blocks of size 2^( 4) =       0.000407241732
  error estimate for blocks of size 2^( 5) =       0.000413186716
  error estimate for blocks of size 2^( 6) =       0.000415518964
  error estimate for blocks of size 2^( 7) =       0.000418426763

      target function =      -0.915117824692
              le_mean =     -17.212096630790
             les_mean =     296.545102099056
             stat err =       0.000413593544
             autocorr =       1.234192330385
   target nu stat err =       0.000413593544
   target dn stat err =       0.002453435988
      target stat err =       0.003240028427
              std dev =       0.526498729103
             le_variance =       0.277200911747


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721209663079e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-05, overlap shift 3.7253e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915128411439       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915833218149       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915932936370       residual = 6.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915971243524       residual = 9.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915979946382       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915984826675       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915986764092       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915987282843       residual = 8.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915986995848       residual = 2.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915986948496       residual = 7.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915986849809       residual = 1.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915986871295       residual = 2.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-05 is 2.512432e-03

solving harmonic davidson linear method for identity shift 1.4901e-04, overlap shift 1.4901e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915128411439       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915832206883       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915931743166       residual = 6.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915969965852       residual = 9.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915978646659       residual = 3.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915983513814       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915985445302       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915985962573       residual = 8.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915985676269       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915985629043       residual = 7.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915985530714       residual = 1.47e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915985552141       residual = 2.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-04 is 2.507980e-03

solving harmonic davidson linear method for identity shift 5.9605e-04, overlap shift 5.9605e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915128411439       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915828190643       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915927005590       residual = 6.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915964893883       residual = 9.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915973487503       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915978302749       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915980210839       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915980722263       residual = 8.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915980438699       residual = 2.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915980391965       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915980295051       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915980316245       residual = 2.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-04 is 2.490331e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.597692 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6644e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
ci_001                -4.137449e-02 3 1  ON 0
ci_002                -3.302629e-02 3 1  ON 1
ci_003                -2.628900e-02 3 1  ON 2
ci_004                 2.397989e-02 3 1  ON 3
ci_005                 2.574504e-02 3 1  ON 4
ci_006                -2.194542e-02 3 1  ON 5
ci_007                -2.142949e-02 3 1  ON 6
ci_008                -8.652344e-03 3 1  ON 7
ci_009                -1.573086e-02 3 1  ON 8
ci_010                -1.039174e-02 3 1  ON 9
ci_011                -9.594413e-03 3 1  ON 10
ci_012                -1.107404e-02 3 1  ON 11
ci_013                -2.010394e-02 3 1  ON 12
ci_014                 1.338700e-02 3 1  ON 13
ci_015                 1.191617e-02 3 1  ON 14
ci_016                 1.727693e-02 3 1  ON 15
ci_017                 1.656297e-02 3 1  ON 16
ci_018                 1.115653e-02 3 1  ON 17
ci_019                 1.135885e-02 3 1  ON 18
ci_020                 1.744101e-02 3 1  ON 19
ci_021                 1.828276e-02 3 1  ON 20
ci_022                 1.003689e-02 3 1  ON 21
ci_023                 1.073111e-02 3 1  ON 22
ci_024                 8.662830e-03 3 1  ON 23
ci_025                 9.018104e-03 3 1  ON 24
ci_026                 1.026414e-02 3 1  ON 25
ci_027                 1.093776e-02 3 1  ON 26
ci_028                -1.696800e-02 3 1  ON 27
ci_029                -1.543459e-02 3 1  ON 28
ci_030                -9.776790e-03 3 1  ON 29
ci_031                -9.305881e-03 3 1  ON 30
ci_032                -1.405768e-02 3 1  ON 31
ci_033                 5.923985e-03 3 1  ON 32
ci_034                 5.426653e-03 3 1  ON 33
ci_035                -5.152831e-03 3 1  ON 34
ci_036                -1.243257e-02 3 1  ON 35
ci_037                -1.294251e-02 3 1  ON 36
ci_038                 1.856064e-03 3 1  ON 37
ci_039                 1.716036e-03 3 1  ON 38
ci_040                -2.922906e-03 3 1  ON 39
ci_041                 8.202929e-03 3 1  ON 40
ci_042                 9.845553e-03 3 1  ON 41
ci_043                -3.914075e-03 3 1  ON 42
ci_044                -4.886255e-03 3 1  ON 43
ci_045                -3.137322e-03 3 1  ON 44
ci_046                 5.844635e-03 3 1  ON 45
ci_047                 5.748288e-03 3 1  ON 46
ci_048                -1.073813e-02 3 1  ON 47
ci_049                -1.318278e-02 3 1  ON 48
ci_050                 2.668505e-03 3 1  ON 49
ci_051                 2.666231e-03 3 1  ON 50
ci_052                -2.885736e-03 3 1  ON 51
ci_053                -2.986671e-03 3 1  ON 52
ci_054                -3.340745e-03 3 1  ON 53
ci_055                -3.243307e-03 3 1  ON 54
ci_056                 5.771433e-03 3 1  ON 55
ci_057                 5.813337e-03 3 1  ON 56
ci_058                -2.018799e-03 3 1  ON 57
ci_059                -2.029106e-03 3 1  ON 58
ci_060                 4.148709e-03 3 1  ON 59
ci_061                 4.300659e-03 3 1  ON 60
ci_062                -4.605046e-03 3 1  ON 61
ci_063                -3.380115e-03 3 1  ON 62
ci_064                -2.956272e-03 3 1  ON 63
ci_065                -4.355174e-03 3 1  ON 64
ci_066                 4.112995e-03 3 1  ON 65
ci_067                 4.948923e-03 3 1  ON 66
ci_068                -4.087129e-03 3 1  ON 67
ci_069                -4.109507e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.153
    reference variance = 0.157406
====================================================
  Execution time = 1.5073e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8879e-01
  Total weights = 1.9577e+06
  Execution time = 2.0322e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00182909
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279505454561
                                         uncertainty =       0.001718061152

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279505454561
                                         uncertainty =       0.001718061152

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373798505
  error estimate for blocks of size 2^( 2) =       0.000387613279
  error estimate for blocks of size 2^( 3) =       0.000399993310
  error estimate for blocks of size 2^( 4) =       0.000409017301
  error estimate for blocks of size 2^( 5) =       0.000413985508
  error estimate for blocks of size 2^( 6) =       0.000415149883
  error estimate for blocks of size 2^( 7) =       0.000417832855

      target function =      -0.819818565703
              le_mean =     -17.212152606361
             les_mean =     296.626854084394
             stat err =       0.000413996386
             autocorr =       1.226642420621
   target nu stat err =       0.000413996386
   target dn stat err =       0.040551718899
      target stat err =       0.042388008536
              std dev =       0.528630915882
             le_variance =       0.279450645226

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278332805669
                                         uncertainty =       0.001657348849

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278332805669
                                         uncertainty =       0.001657348849

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373016267
  error estimate for blocks of size 2^( 2) =       0.000386849225
  error estimate for blocks of size 2^( 3) =       0.000399272007
  error estimate for blocks of size 2^( 4) =       0.000408278329
  error estimate for blocks of size 2^( 5) =       0.000413290508
  error estimate for blocks of size 2^( 6) =       0.000414491493
  error estimate for blocks of size 2^( 7) =       0.000417122023

      target function =      -0.915151635521
              le_mean =     -17.211984045774
             les_mean =     296.541180703173
             stat err =       0.000413295588
             autocorr =       1.227625768894
   target nu stat err =       0.000413295588
   target dn stat err =       0.002065364882
      target stat err =       0.002745496406
              std dev =       0.527524663645
             le_variance =       0.278282270753

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00184771
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280725004695
                                         uncertainty =       0.001724453836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280725004695
                                         uncertainty =       0.001724453836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374616201
  error estimate for blocks of size 2^( 2) =       0.000388398343
  error estimate for blocks of size 2^( 3) =       0.000400797367
  error estimate for blocks of size 2^( 4) =       0.000409793749
  error estimate for blocks of size 2^( 5) =       0.000414791355
  error estimate for blocks of size 2^( 6) =       0.000415948591
  error estimate for blocks of size 2^( 7) =       0.000418587212

      target function =      -0.847009073773
              le_mean =     -17.212049747324
             les_mean =     296.598539720302
             stat err =       0.000414780227
             autocorr =       1.225922398920
   target nu stat err =       0.000414780227
   target dn stat err =       0.035008139014
      target stat err =       0.039034103489
              std dev =       0.529787311619
             le_variance =       0.280674595553

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278329728755
                                         uncertainty =       0.001657357519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278329728755
                                         uncertainty =       0.001657357519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373014187
  error estimate for blocks of size 2^( 2) =       0.000386847246
  error estimate for blocks of size 2^( 3) =       0.000399270016
  error estimate for blocks of size 2^( 4) =       0.000408276807
  error estimate for blocks of size 2^( 5) =       0.000413288632
  error estimate for blocks of size 2^( 6) =       0.000414489885
  error estimate for blocks of size 2^( 7) =       0.000417120090

      target function =      -0.915127451025
              le_mean =     -17.211984362586
             les_mean =     296.541210292795
             stat err =       0.000413293854
             autocorr =       1.227629152948
   target nu stat err =       0.000413293854
   target dn stat err =       0.002065842455
      target stat err =       0.002745961284
              std dev =       0.527521722384
             le_variance =       0.278279167587


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.819818565703        initial
     3.7253e-05     3.7253e-04             2.5124e-03        -0.915151635521  <--
     1.4901e-04     1.4901e-03             2.5080e-03        -0.847009073773
     5.9605e-04     5.9605e-03             2.4903e-03        -0.915127451025

*****************************************************************************
Applying the update for shift_i =   3.7253e-05     and shift_s =   3.7253e-04
*****************************************************************************

  Execution time = 2.4627e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
ci_001                -4.137241e-02 3 1  ON 0
ci_002                -3.302709e-02 3 1  ON 1
ci_003                -2.628988e-02 3 1  ON 2
ci_004                 2.398115e-02 3 1  ON 3
ci_005                 2.574949e-02 3 1  ON 4
ci_006                -2.194686e-02 3 1  ON 5
ci_007                -2.142926e-02 3 1  ON 6
ci_008                -8.652316e-03 3 1  ON 7
ci_009                -1.573245e-02 3 1  ON 8
ci_010                -1.039293e-02 3 1  ON 9
ci_011                -9.591344e-03 3 1  ON 10
ci_012                -1.107580e-02 3 1  ON 11
ci_013                -2.010419e-02 3 1  ON 12
ci_014                 1.338768e-02 3 1  ON 13
ci_015                 1.191622e-02 3 1  ON 14
ci_016                 1.727752e-02 3 1  ON 15
ci_017                 1.656141e-02 3 1  ON 16
ci_018                 1.115679e-02 3 1  ON 17
ci_019                 1.135917e-02 3 1  ON 18
ci_020                 1.743936e-02 3 1  ON 19
ci_021                 1.828354e-02 3 1  ON 20
ci_022                 1.003649e-02 3 1  ON 21
ci_023                 1.073443e-02 3 1  ON 22
ci_024                 8.662385e-03 3 1  ON 23
ci_025                 9.015180e-03 3 1  ON 24
ci_026                 1.026180e-02 3 1  ON 25
ci_027                 1.093650e-02 3 1  ON 26
ci_028                -1.696977e-02 3 1  ON 27
ci_029                -1.543209e-02 3 1  ON 28
ci_030                -9.776795e-03 3 1  ON 29
ci_031                -9.304900e-03 3 1  ON 30
ci_032                -1.405513e-02 3 1  ON 31
ci_033                 5.926875e-03 3 1  ON 32
ci_034                 5.427065e-03 3 1  ON 33
ci_035                -5.151883e-03 3 1  ON 34
ci_036                -1.243213e-02 3 1  ON 35
ci_037                -1.294326e-02 3 1  ON 36
ci_038                 1.856146e-03 3 1  ON 37
ci_039                 1.714381e-03 3 1  ON 38
ci_040                -2.922185e-03 3 1  ON 39
ci_041                 8.202156e-03 3 1  ON 40
ci_042                 9.845972e-03 3 1  ON 41
ci_043                -3.914280e-03 3 1  ON 42
ci_044                -4.885715e-03 3 1  ON 43
ci_045                -3.137483e-03 3 1  ON 44
ci_046                 5.844435e-03 3 1  ON 45
ci_047                 5.749663e-03 3 1  ON 46
ci_048                -1.073657e-02 3 1  ON 47
ci_049                -1.318084e-02 3 1  ON 48
ci_050                 2.668108e-03 3 1  ON 49
ci_051                 2.666131e-03 3 1  ON 50
ci_052                -2.885332e-03 3 1  ON 51
ci_053                -2.988760e-03 3 1  ON 52
ci_054                -3.341202e-03 3 1  ON 53
ci_055                -3.244364e-03 3 1  ON 54
ci_056                 5.772018e-03 3 1  ON 55
ci_057                 5.813446e-03 3 1  ON 56
ci_058                -2.018234e-03 3 1  ON 57
ci_059                -2.028619e-03 3 1  ON 58
ci_060                 4.148101e-03 3 1  ON 59
ci_061                 4.300826e-03 3 1  ON 60
ci_062                -4.605792e-03 3 1  ON 61
ci_063                -3.379378e-03 3 1  ON 62
ci_064                -2.955620e-03 3 1  ON 63
ci_065                -4.355528e-03 3 1  ON 64
ci_066                 4.111895e-03 3 1  ON 65
ci_067                 4.949672e-03 3 1  ON 66
ci_068                -4.086417e-03 3 1  ON 67
ci_069                -4.108620e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1281e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.2476
    reference variance = 0.162472
====================================================
  Execution time = 1.4006e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8913e-01
  Total weights = 1.957511427e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5025e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276437207021
                                         uncertainty =       0.001518183155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276437207021
                                         uncertainty =       0.001518183155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371733991
  error estimate for blocks of size 2^( 2) =       0.000385778286
  error estimate for blocks of size 2^( 3) =       0.000398495071
  error estimate for blocks of size 2^( 4) =       0.000407034880
  error estimate for blocks of size 2^( 5) =       0.000413519523
  error estimate for blocks of size 2^( 6) =       0.000415074490
  error estimate for blocks of size 2^( 7) =       0.000415556511

      target function =      -0.914816465807
              le_mean =     -17.212411549382
             les_mean =     296.556236706664
             stat err =       0.000412796351
             autocorr =       1.233125134142
   target nu stat err =       0.000412796351
   target dn stat err =       0.002469879650
      target stat err =       0.003260310792
              std dev =       0.525711251947
             le_variance =       0.276372320424


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721241154938e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-06, overlap shift 9.3132e-05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914827321521       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915367772778       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915448945698       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915475756349       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915484209715       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915487696946       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915487946849       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915488273537       residual = 7.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915488042714       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915488098341       residual = 7.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915488006709       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915488034326       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-06 is 2.600872e-03

solving harmonic davidson linear method for identity shift 3.7253e-05, overlap shift 3.7253e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914827321521       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915367578832       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915448714641       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915475510040       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915483957480       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915487442351       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915487691712       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915488018163       residual = 7.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915487787503       residual = 2.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915487843030       residual = 7.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915487751505       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915487779089       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-05 is 2.599664e-03

solving harmonic davidson linear method for identity shift 1.4901e-04, overlap shift 1.4901e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.914827321521       residual = 1.07e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915366804437       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915447792130       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915474526686       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915482950495       residual = 4.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915486425951       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915486673154       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915486998662       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915486768652       residual = 2.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915486823781       residual = 7.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915486732682       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915486760137       residual = 3.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-04 is 2.594840e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.602565 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6519e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
ci_001                -4.305686e-02 3 1  ON 0
ci_002                -3.343156e-02 3 1  ON 1
ci_003                -2.642742e-02 3 1  ON 2
ci_004                 2.385783e-02 3 1  ON 3
ci_005                 2.377164e-02 3 1  ON 4
ci_006                -2.146192e-02 3 1  ON 5
ci_007                -2.129539e-02 3 1  ON 6
ci_008                -9.148553e-03 3 1  ON 7
ci_009                -1.401086e-02 3 1  ON 8
ci_010                -9.947480e-03 3 1  ON 9
ci_011                -1.040966e-02 3 1  ON 10
ci_012                -1.011388e-02 3 1  ON 11
ci_013                -2.005241e-02 3 1  ON 12
ci_014                 1.268573e-02 3 1  ON 13
ci_015                 1.316212e-02 3 1  ON 14
ci_016                 1.741363e-02 3 1  ON 15
ci_017                 1.742403e-02 3 1  ON 16
ci_018                 1.087266e-02 3 1  ON 17
ci_019                 1.151933e-02 3 1  ON 18
ci_020                 1.769639e-02 3 1  ON 19
ci_021                 1.739200e-02 3 1  ON 20
ci_022                 9.515582e-03 3 1  ON 21
ci_023                 1.075569e-02 3 1  ON 22
ci_024                 9.885028e-03 3 1  ON 23
ci_025                 8.504324e-03 3 1  ON 24
ci_026                 1.046773e-02 3 1  ON 25
ci_027                 1.152650e-02 3 1  ON 26
ci_028                -1.551691e-02 3 1  ON 27
ci_029                -1.601952e-02 3 1  ON 28
ci_030                -9.776907e-03 3 1  ON 29
ci_031                -9.290587e-03 3 1  ON 30
ci_032                -1.473194e-02 3 1  ON 31
ci_033                 5.476102e-03 3 1  ON 32
ci_034                 5.624550e-03 3 1  ON 33
ci_035                -5.304749e-03 3 1  ON 34
ci_036                -1.361163e-02 3 1  ON 35
ci_037                -1.324336e-02 3 1  ON 36
ci_038                 2.403142e-03 3 1  ON 37
ci_039                 1.930046e-03 3 1  ON 38
ci_040                -3.391940e-03 3 1  ON 39
ci_041                 8.187763e-03 3 1  ON 40
ci_042                 8.527535e-03 3 1  ON 41
ci_043                -4.588896e-03 3 1  ON 42
ci_044                -4.327909e-03 3 1  ON 43
ci_045                -3.617035e-03 3 1  ON 44
ci_046                 5.357547e-03 3 1  ON 45
ci_047                 5.584972e-03 3 1  ON 46
ci_048                -1.333624e-02 3 1  ON 47
ci_049                -1.358953e-02 3 1  ON 48
ci_050                 3.462481e-03 3 1  ON 49
ci_051                 3.233796e-03 3 1  ON 50
ci_052                -3.604766e-03 3 1  ON 51
ci_053                -2.743866e-03 3 1  ON 52
ci_054                -2.252679e-03 3 1  ON 53
ci_055                -3.393388e-03 3 1  ON 54
ci_056                 5.414220e-03 3 1  ON 55
ci_057                 6.422089e-03 3 1  ON 56
ci_058                -2.490973e-03 3 1  ON 57
ci_059                -1.485272e-03 3 1  ON 58
ci_060                 5.824768e-03 3 1  ON 59
ci_061                 5.198955e-03 3 1  ON 60
ci_062                -4.020661e-03 3 1  ON 61
ci_063                -3.739458e-03 3 1  ON 62
ci_064                -3.249100e-03 3 1  ON 63
ci_065                -3.870905e-03 3 1  ON 64
ci_066                 4.508375e-03 3 1  ON 65
ci_067                 4.972668e-03 3 1  ON 66
ci_068                -4.719055e-03 3 1  ON 67
ci_069                -3.679851e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.1925
    reference variance = 0.190143
====================================================
  Execution time = 1.3518e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8908e-01
  Total weights = 1.9571e+06
  Execution time = 1.8593e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279580987679
                                         uncertainty =       0.001825052478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279580987679
                                         uncertainty =       0.001825052478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373853586
  error estimate for blocks of size 2^( 2) =       0.000387784607
  error estimate for blocks of size 2^( 3) =       0.000400258225
  error estimate for blocks of size 2^( 4) =       0.000408913926
  error estimate for blocks of size 2^( 5) =       0.000414374887
  error estimate for blocks of size 2^( 6) =       0.000415949406
  error estimate for blocks of size 2^( 7) =       0.000416103759

      target function =      -0.861244633244
              le_mean =     -17.211956367416
             les_mean =     296.584064154788
             stat err =       0.000413835494
             autocorr =       1.225328045467
   target nu stat err =       0.000413835494
   target dn stat err =       0.014359748288
      target stat err =       0.016530145354
              std dev =       0.528708811073
             le_variance =       0.279533006906

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278071404688
                                         uncertainty =       0.001730558781

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278071404688
                                         uncertainty =       0.001730558781

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372842243
  error estimate for blocks of size 2^( 2) =       0.000386747429
  error estimate for blocks of size 2^( 3) =       0.000399207329
  error estimate for blocks of size 2^( 4) =       0.000407833925
  error estimate for blocks of size 2^( 5) =       0.000413301047
  error estimate for blocks of size 2^( 6) =       0.000414905554
  error estimate for blocks of size 2^( 7) =       0.000414895765

      target function =      -0.914710543310
              le_mean =     -17.211779023177
             les_mean =     296.534421537330
             stat err =       0.000412734073
             autocorr =       1.225435403914
   target nu stat err =       0.000412734073
   target dn stat err =       0.002217248597
      target stat err =       0.002934621875
              std dev =       0.527278555992
             le_variance =       0.278022675609

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281006488868
                                         uncertainty =       0.002364628283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281006488868
                                         uncertainty =       0.002364628283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374799830
  error estimate for blocks of size 2^( 2) =       0.000388606335
  error estimate for blocks of size 2^( 3) =       0.000400992751
  error estimate for blocks of size 2^( 4) =       0.000409536062
  error estimate for blocks of size 2^( 5) =       0.000414875630
  error estimate for blocks of size 2^( 6) =       0.000416514052
  error estimate for blocks of size 2^( 7) =       0.000416599058

      target function =      -0.474883611845
              le_mean =     -17.211859846194
             les_mean =     297.011548088141
             stat err =       0.000414381200
             autocorr =       1.222366156988
   target nu stat err =       0.000414381200
   target dn stat err =       0.459428559453
      target stat err =       0.184970690868
              std dev =       0.530047003018
             le_variance =       0.280949825409

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278071082332
                                         uncertainty =       0.001730602347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278071082332
                                         uncertainty =       0.001730602347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372842031
  error estimate for blocks of size 2^( 2) =       0.000386747303
  error estimate for blocks of size 2^( 3) =       0.000399207302
  error estimate for blocks of size 2^( 4) =       0.000407833962
  error estimate for blocks of size 2^( 5) =       0.000413301054
  error estimate for blocks of size 2^( 6) =       0.000414905511
  error estimate for blocks of size 2^( 7) =       0.000414895706

      target function =      -0.914710733818
              le_mean =     -17.211779113896
             les_mean =     296.534424531356
             stat err =       0.000412734058
             autocorr =       1.225436707749
   target nu stat err =       0.000412734058
   target dn stat err =       0.002217223184
      target stat err =       0.002934591183
              std dev =       0.527278256612
             le_variance =       0.278022359896


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.861244633244        initial
     9.3132e-06     9.3132e-05             2.6009e-03        -0.914710543310
     3.7253e-05     3.7253e-04             2.5997e-03        -0.474883611845
     1.4901e-04     1.4901e-03             2.5948e-03        -0.914710733818  <--

*****************************************************************************
Applying the update for shift_i =   1.4901e-04     and shift_s =   1.4901e-03
*****************************************************************************

  Execution time = 2.2895e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
ci_001                -4.305373e-02 3 1  ON 0
ci_002                -3.343078e-02 3 1  ON 1
ci_003                -2.642688e-02 3 1  ON 2
ci_004                 2.385816e-02 3 1  ON 3
ci_005                 2.377531e-02 3 1  ON 4
ci_006                -2.146283e-02 3 1  ON 5
ci_007                -2.129578e-02 3 1  ON 6
ci_008                -9.147777e-03 3 1  ON 7
ci_009                -1.401350e-02 3 1  ON 8
ci_010                -9.948220e-03 3 1  ON 9
ci_011                -1.040835e-02 3 1  ON 10
ci_012                -1.011537e-02 3 1  ON 11
ci_013                -2.005256e-02 3 1  ON 12
ci_014                 1.268689e-02 3 1  ON 13
ci_015                 1.316005e-02 3 1  ON 14
ci_016                 1.741337e-02 3 1  ON 15
ci_017                 1.742243e-02 3 1  ON 16
ci_018                 1.087322e-02 3 1  ON 17
ci_019                 1.151902e-02 3 1  ON 18
ci_020                 1.769593e-02 3 1  ON 19
ci_021                 1.739364e-02 3 1  ON 20
ci_022                 9.516426e-03 3 1  ON 21
ci_023                 1.075578e-02 3 1  ON 22
ci_024                 9.882803e-03 3 1  ON 23
ci_025                 8.505140e-03 3 1  ON 24
ci_026                 1.046752e-02 3 1  ON 25
ci_027                 1.152603e-02 3 1  ON 26
ci_028                -1.551954e-02 3 1  ON 27
ci_029                -1.601871e-02 3 1  ON 28
ci_030                -9.776476e-03 3 1  ON 29
ci_031                -9.290606e-03 3 1  ON 30
ci_032                -1.473080e-02 3 1  ON 31
ci_033                 5.476853e-03 3 1  ON 32
ci_034                 5.624216e-03 3 1  ON 33
ci_035                -5.304527e-03 3 1  ON 34
ci_036                -1.360984e-02 3 1  ON 35
ci_037                -1.324278e-02 3 1  ON 36
ci_038                 2.402340e-03 3 1  ON 37
ci_039                 1.929730e-03 3 1  ON 38
ci_040                -3.391271e-03 3 1  ON 39
ci_041                 8.188019e-03 3 1  ON 40
ci_042                 8.529397e-03 3 1  ON 41
ci_043                -4.587887e-03 3 1  ON 42
ci_044                -4.328745e-03 3 1  ON 43
ci_045                -3.616343e-03 3 1  ON 44
ci_046                 5.358340e-03 3 1  ON 45
ci_047                 5.585234e-03 3 1  ON 46
ci_048                -1.333141e-02 3 1  ON 47
ci_049                -1.358871e-02 3 1  ON 48
ci_050                 3.461395e-03 3 1  ON 49
ci_051                 3.233025e-03 3 1  ON 50
ci_052                -3.603705e-03 3 1  ON 51
ci_053                -2.744158e-03 3 1  ON 52
ci_054                -2.254400e-03 3 1  ON 53
ci_055                -3.393281e-03 3 1  ON 54
ci_056                 5.414758e-03 3 1  ON 55
ci_057                 6.421163e-03 3 1  ON 56
ci_058                -2.490422e-03 3 1  ON 57
ci_059                -1.485997e-03 3 1  ON 58
ci_060                 5.822028e-03 3 1  ON 59
ci_061                 5.197495e-03 3 1  ON 60
ci_062                -4.021454e-03 3 1  ON 61
ci_063                -3.738923e-03 3 1  ON 62
ci_064                -3.248687e-03 3 1  ON 63
ci_065                -3.871607e-03 3 1  ON 64
ci_066                 4.507724e-03 3 1  ON 65
ci_067                 4.972640e-03 3 1  ON 66
ci_068                -4.718000e-03 3 1  ON 67
ci_069                -3.680507e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9419e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.236
    reference variance = 0.333478
====================================================
  Execution time = 1.3896e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9004e-01
  Total weights = 1.957031680e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5054e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277479502431
                                         uncertainty =       0.002656315475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277479502431
                                         uncertainty =       0.002656315475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372464709
  error estimate for blocks of size 2^( 2) =       0.000386235074
  error estimate for blocks of size 2^( 3) =       0.000398658910
  error estimate for blocks of size 2^( 4) =       0.000407031528
  error estimate for blocks of size 2^( 5) =       0.000411863837
  error estimate for blocks of size 2^( 6) =       0.000415289218
  error estimate for blocks of size 2^( 7) =       0.000416865044

      target function =      -0.913386740287
              le_mean =     -17.211501307575
             les_mean =     296.525817748880
             stat err =       0.000412762406
             autocorr =       1.228089485006
   target nu stat err =       0.000412762406
   target dn stat err =       0.003659232170
      target stat err =       0.004766122552
              std dev =       0.526744642592
             le_variance =       0.277459918499


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721150130757e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-05, overlap shift 3.7253e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913410571170       residual = 3.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914665798928       residual = 3.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914845417133       residual = 7.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914898376145       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914907368055       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914910471948       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914912348818       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914912795866       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914912688898       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914912936478       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914912969821       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914913024374       residual = 3.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-05 is 2.321575e-03

solving harmonic davidson linear method for identity shift 1.4901e-04, overlap shift 1.4901e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913410571170       residual = 3.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914664059521       residual = 3.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914843377959       residual = 7.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914896220350       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914905190213       residual = 4.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914908284092       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914910154896       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914910600212       residual = 6.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914910493662       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914910740358       residual = 4.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914910773524       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914910827865       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-04 is 2.317895e-03

solving harmonic davidson linear method for identity shift 5.9605e-04, overlap shift 5.9605e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913410571170       residual = 3.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.914657149762       residual = 3.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.914835278894       residual = 7.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.914887659525       residual = 1.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.914896542202       residual = 4.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.914899596532       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.914901443423       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.914901881902       residual = 6.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.914901777011       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.914902020222       residual = 4.10e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.914902052690       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.914902106195       residual = 3.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-04 is 2.303292e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.607363 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6411e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
ci_001                -4.204723e-02 3 1  ON 0
ci_002                -3.344286e-02 3 1  ON 1
ci_003                -2.866700e-02 3 1  ON 2
ci_004                 2.335941e-02 3 1  ON 3
ci_005                 2.522983e-02 3 1  ON 4
ci_006                -2.086489e-02 3 1  ON 5
ci_007                -2.159889e-02 3 1  ON 6
ci_008                -8.461656e-03 3 1  ON 7
ci_009                -1.327705e-02 3 1  ON 8
ci_010                -8.287421e-03 3 1  ON 9
ci_011                -9.474111e-03 3 1  ON 10
ci_012                -1.111017e-02 3 1  ON 11
ci_013                -1.980393e-02 3 1  ON 12
ci_014                 1.239999e-02 3 1  ON 13
ci_015                 1.178502e-02 3 1  ON 14
ci_016                 1.660619e-02 3 1  ON 15
ci_017                 1.684870e-02 3 1  ON 16
ci_018                 1.041698e-02 3 1  ON 17
ci_019                 1.294416e-02 3 1  ON 18
ci_020                 1.620674e-02 3 1  ON 19
ci_021                 1.844722e-02 3 1  ON 20
ci_022                 9.853750e-03 3 1  ON 21
ci_023                 8.437884e-03 3 1  ON 22
ci_024                 9.834457e-03 3 1  ON 23
ci_025                 1.078904e-02 3 1  ON 24
ci_026                 1.241077e-02 3 1  ON 25
ci_027                 1.194075e-02 3 1  ON 26
ci_028                -1.586188e-02 3 1  ON 27
ci_029                -1.508513e-02 3 1  ON 28
ci_030                -8.169530e-03 3 1  ON 29
ci_031                -9.080273e-03 3 1  ON 30
ci_032                -1.428453e-02 3 1  ON 31
ci_033                 3.537023e-03 3 1  ON 32
ci_034                 5.038405e-03 3 1  ON 33
ci_035                -5.881370e-03 3 1  ON 34
ci_036                -1.148682e-02 3 1  ON 35
ci_037                -1.475295e-02 3 1  ON 36
ci_038                 2.220728e-03 3 1  ON 37
ci_039                 2.438383e-03 3 1  ON 38
ci_040                -3.627106e-03 3 1  ON 39
ci_041                 8.401326e-03 3 1  ON 40
ci_042                 8.846416e-03 3 1  ON 41
ci_043                -3.979479e-03 3 1  ON 42
ci_044                -3.683219e-03 3 1  ON 43
ci_045                -3.203995e-03 3 1  ON 44
ci_046                 6.128687e-03 3 1  ON 45
ci_047                 5.816322e-03 3 1  ON 46
ci_048                -1.313978e-02 3 1  ON 47
ci_049                -1.343573e-02 3 1  ON 48
ci_050                 1.842678e-03 3 1  ON 49
ci_051                 3.825391e-03 3 1  ON 50
ci_052                -2.535337e-03 3 1  ON 51
ci_053                -3.110329e-03 3 1  ON 52
ci_054                -3.215354e-03 3 1  ON 53
ci_055                -3.374342e-03 3 1  ON 54
ci_056                 6.034631e-03 3 1  ON 55
ci_057                 6.723719e-03 3 1  ON 56
ci_058                -2.345267e-03 3 1  ON 57
ci_059                -2.124382e-03 3 1  ON 58
ci_060                 4.626625e-03 3 1  ON 59
ci_061                 4.495318e-03 3 1  ON 60
ci_062                -3.502751e-03 3 1  ON 61
ci_063                -4.121966e-03 3 1  ON 62
ci_064                -2.739117e-03 3 1  ON 63
ci_065                -3.695480e-03 3 1  ON 64
ci_066                 4.428895e-03 3 1  ON 65
ci_067                 4.349606e-03 3 1  ON 66
ci_068                -5.709706e-03 3 1  ON 67
ci_069                -5.167960e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.1338
    reference variance = 0.196997
====================================================
  Execution time = 1.3625e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9055e-01
  Total weights = 1.9571e+06
  Execution time = 1.8550e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279835411593
                                         uncertainty =       0.002029848335

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279835411593
                                         uncertainty =       0.002029848335

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374051544
  error estimate for blocks of size 2^( 2) =       0.000387631874
  error estimate for blocks of size 2^( 3) =       0.000399897827
  error estimate for blocks of size 2^( 4) =       0.000408878244
  error estimate for blocks of size 2^( 5) =       0.000413353460
  error estimate for blocks of size 2^( 6) =       0.000416251663
  error estimate for blocks of size 2^( 7) =       0.000417323203

      target function =      -0.878163749887
              le_mean =     -17.211729792566
             les_mean =     296.561678078065
             stat err =       0.000413951643
             autocorr =       1.224718608795
   target nu stat err =       0.000413951643
   target dn stat err =       0.017142972496
      target stat err =       0.020509692288
              std dev =       0.528988766773
             le_variance =       0.279829115372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278126846067
                                         uncertainty =       0.001715586734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278126846067
                                         uncertainty =       0.001715586734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372910406
  error estimate for blocks of size 2^( 2) =       0.000386690082
  error estimate for blocks of size 2^( 3) =       0.000399134156
  error estimate for blocks of size 2^( 4) =       0.000408137413
  error estimate for blocks of size 2^( 5) =       0.000412767602
  error estimate for blocks of size 2^( 6) =       0.000415773680
  error estimate for blocks of size 2^( 7) =       0.000416823698

      target function =      -0.912723710960
              le_mean =     -17.211513246065
             les_mean =     296.526753879242
             stat err =       0.000413375598
             autocorr =       1.228798484897
   target nu stat err =       0.000413375598
   target dn stat err =       0.002564669452
      target stat err =       0.003361704938
              std dev =       0.527374953811
             le_variance =       0.278124341907

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294361169998
                                         uncertainty =       0.007935462564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.294361169998
                                         uncertainty =       0.007935462564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000383640200
  error estimate for blocks of size 2^( 2) =       0.000397225313
  error estimate for blocks of size 2^( 3) =       0.000409596786
  error estimate for blocks of size 2^( 4) =       0.000418553238
  error estimate for blocks of size 2^( 5) =       0.000423136218
  error estimate for blocks of size 2^( 6) =       0.000426522019
  error estimate for blocks of size 2^( 7) =       0.000427404404

      target function =      -0.161262989844
              le_mean =     -17.211477600627
             les_mean =     298.913330714958
             stat err =       0.000423903970
             autocorr =       1.220918710452
   target nu stat err =       0.000423903970
   target dn stat err =       1.676703786696
      target stat err =       0.087365125030
              std dev =       0.542549174159
             le_variance =       0.294359606381

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278117850942
                                         uncertainty =       0.001715740375

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278117850942
                                         uncertainty =       0.001715740375

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372904381
  error estimate for blocks of size 2^( 2) =       0.000386683001
  error estimate for blocks of size 2^( 3) =       0.000399126180
  error estimate for blocks of size 2^( 4) =       0.000408129363
  error estimate for blocks of size 2^( 5) =       0.000412758647
  error estimate for blocks of size 2^( 6) =       0.000415764278
  error estimate for blocks of size 2^( 7) =       0.000416814414

      target function =      -0.912788769465
              le_mean =     -17.211513583334
             les_mean =     296.526715186808
             stat err =       0.000413366676
             autocorr =       1.228785146716
   target nu stat err =       0.000413366676
   target dn stat err =       0.002560399396
      target stat err =       0.003356747901
              std dev =       0.527366433038
             le_variance =       0.278115354696


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.878163749887        initial
     3.7253e-05     3.7253e-04             2.3216e-03        -0.912723710960
     1.4901e-04     1.4901e-03             2.3179e-03        -0.161262989844
     5.9605e-04     5.9605e-03             2.3033e-03        -0.912788769465  <--

*****************************************************************************
Applying the update for shift_i =   5.9605e-04     and shift_s =   5.9605e-03
*****************************************************************************

  Execution time = 2.2983e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
ci_001                -4.205463e-02 3 1  ON 0
ci_002                -3.344277e-02 3 1  ON 1
ci_003                -2.865218e-02 3 1  ON 2
ci_004                 2.336171e-02 3 1  ON 3
ci_005                 2.521874e-02 3 1  ON 4
ci_006                -2.086913e-02 3 1  ON 5
ci_007                -2.159612e-02 3 1  ON 6
ci_008                -8.464870e-03 3 1  ON 7
ci_009                -1.328148e-02 3 1  ON 8
ci_010                -8.297550e-03 3 1  ON 9
ci_011                -9.479683e-03 3 1  ON 10
ci_012                -1.110407e-02 3 1  ON 11
ci_013                -1.980590e-02 3 1  ON 12
ci_014                 1.240208e-02 3 1  ON 13
ci_015                 1.179387e-02 3 1  ON 14
ci_016                 1.661182e-02 3 1  ON 15
ci_017                 1.685273e-02 3 1  ON 16
ci_018                 1.041900e-02 3 1  ON 17
ci_019                 1.293686e-02 3 1  ON 18
ci_020                 1.621616e-02 3 1  ON 19
ci_021                 1.844008e-02 3 1  ON 20
ci_022                 9.851754e-03 3 1  ON 21
ci_023                 8.452487e-03 3 1  ON 22
ci_024                 9.835118e-03 3 1  ON 23
ci_025                 1.077327e-02 3 1  ON 24
ci_026                 1.239968e-02 3 1  ON 25
ci_027                 1.193734e-02 3 1  ON 26
ci_028                -1.585944e-02 3 1  ON 27
ci_029                -1.509174e-02 3 1  ON 28
ci_030                -8.179385e-03 3 1  ON 29
ci_031                -9.081483e-03 3 1  ON 30
ci_032                -1.428746e-02 3 1  ON 31
ci_033                 3.549462e-03 3 1  ON 32
ci_034                 5.042073e-03 3 1  ON 33
ci_035                -5.877927e-03 3 1  ON 34
ci_036                -1.149736e-02 3 1  ON 35
ci_037                -1.474359e-02 3 1  ON 36
ci_038                 2.221757e-03 3 1  ON 37
ci_039                 2.435491e-03 3 1  ON 38
ci_040                -3.625783e-03 3 1  ON 39
ci_041                 8.399995e-03 3 1  ON 40
ci_042                 8.845151e-03 3 1  ON 41
ci_043                -3.983085e-03 3 1  ON 42
ci_044                -3.686980e-03 3 1  ON 43
ci_045                -3.206518e-03 3 1  ON 44
ci_046                 6.123778e-03 3 1  ON 45
ci_047                 5.814863e-03 3 1  ON 46
ci_048                -1.314270e-02 3 1  ON 47
ci_049                -1.343758e-02 3 1  ON 48
ci_050                 1.851192e-03 3 1  ON 49
ci_051                 3.822295e-03 3 1  ON 50
ci_052                -2.540382e-03 3 1  ON 51
ci_053                -3.108447e-03 3 1  ON 52
ci_054                -3.209441e-03 3 1  ON 53
ci_055                -3.374854e-03 3 1  ON 54
ci_056                 6.030964e-03 3 1  ON 55
ci_057                 6.721978e-03 3 1  ON 56
ci_058                -2.345319e-03 3 1  ON 57
ci_059                -2.120383e-03 3 1  ON 58
ci_060                 4.634315e-03 3 1  ON 59
ci_061                 4.499691e-03 3 1  ON 60
ci_062                -3.505975e-03 3 1  ON 61
ci_063                -4.118835e-03 3 1  ON 62
ci_064                -2.741932e-03 3 1  ON 63
ci_065                -3.696478e-03 3 1  ON 64
ci_066                 4.428889e-03 3 1  ON 65
ci_067                 4.353254e-03 3 1  ON 66
ci_068                -5.703300e-03 3 1  ON 67
ci_069                -5.158167e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9399e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.1961
    reference variance = 0.215388
====================================================
  Execution time = 1.3889e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5296e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9379e-01
  Total weights = 1.956878918e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4932e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281373535949
                                         uncertainty =       0.002244511500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281373535949
                                         uncertainty =       0.002244511500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375153963
  error estimate for blocks of size 2^( 2) =       0.000389098363
  error estimate for blocks of size 2^( 3) =       0.000401514580
  error estimate for blocks of size 2^( 4) =       0.000410826907
  error estimate for blocks of size 2^( 5) =       0.000414820080
  error estimate for blocks of size 2^( 6) =       0.000418308238
  error estimate for blocks of size 2^( 7) =       0.000421191688

      target function =      -0.908680885110
              le_mean =     -17.211965957786
             les_mean =     296.545566102177
             stat err =       0.000416286728
             autocorr =       1.231306162013
   target nu stat err =       0.000416286728
   target dn stat err =       0.003031202362
      target stat err =       0.003924913661
              std dev =       0.530547822801
             le_variance =       0.281480992278


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721196595779e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-04, overlap shift 1.4901e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908696917157       residual = 2.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909624795911       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909750146705       residual = 7.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909818565908       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909829459759       residual = 7.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909835736486       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909837179004       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909837454859       residual = 6.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909837948238       residual = 1.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909837884758       residual = 4.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.909837999018       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.909837937106       residual = 3.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-04 is 2.317250e-03

solving harmonic davidson linear method for identity shift 5.9605e-04, overlap shift 5.9605e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908696917157       residual = 2.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909619558887       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909744032986       residual = 7.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909811846189       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909822625701       residual = 7.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909828824833       residual = 1.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909830251116       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909830522223       residual = 6.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909831009612       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909830946756       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.909831059231       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.909830998245       residual = 2.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-04 is 2.304634e-03

solving harmonic davidson linear method for identity shift 2.3842e-03, overlap shift 2.3842e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908696917157       residual = 2.17e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.909599188260       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.909720272236       residual = 7.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.909785758869       residual = 1.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.909796102504       residual = 6.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.909802007139       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.909803371758       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.909803625094       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.909804089717       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.909804029277       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.909804135045       residual = 1.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.909804077545       residual = 2.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-03 is 2.255499e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.612139 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6392e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
ci_001                -4.194154e-02 3 1  ON 0
ci_002                -3.311859e-02 3 1  ON 1
ci_003                -2.645284e-02 3 1  ON 2
ci_004                 2.529249e-02 3 1  ON 3
ci_005                 2.493075e-02 3 1  ON 4
ci_006                -2.190747e-02 3 1  ON 5
ci_007                -2.285780e-02 3 1  ON 6
ci_008                -8.297650e-03 3 1  ON 7
ci_009                -1.427445e-02 3 1  ON 8
ci_010                -9.615194e-03 3 1  ON 9
ci_011                -1.003192e-02 3 1  ON 10
ci_012                -9.133695e-03 3 1  ON 11
ci_013                -2.046573e-02 3 1  ON 12
ci_014                 1.317458e-02 3 1  ON 13
ci_015                 1.163178e-02 3 1  ON 14
ci_016                 1.697739e-02 3 1  ON 15
ci_017                 1.639293e-02 3 1  ON 16
ci_018                 1.071921e-02 3 1  ON 17
ci_019                 1.063222e-02 3 1  ON 18
ci_020                 1.817695e-02 3 1  ON 19
ci_021                 1.830081e-02 3 1  ON 20
ci_022                 1.010013e-02 3 1  ON 21
ci_023                 8.223004e-03 3 1  ON 22
ci_024                 1.045381e-02 3 1  ON 23
ci_025                 8.744210e-03 3 1  ON 24
ci_026                 1.256618e-02 3 1  ON 25
ci_027                 9.781458e-03 3 1  ON 26
ci_028                -1.644720e-02 3 1  ON 27
ci_029                -1.583056e-02 3 1  ON 28
ci_030                -9.058900e-03 3 1  ON 29
ci_031                -1.117245e-02 3 1  ON 30
ci_032                -1.485606e-02 3 1  ON 31
ci_033                 4.135475e-03 3 1  ON 32
ci_034                 5.007080e-03 3 1  ON 33
ci_035                -5.683250e-03 3 1  ON 34
ci_036                -1.087833e-02 3 1  ON 35
ci_037                -1.287081e-02 3 1  ON 36
ci_038                 1.734875e-03 3 1  ON 37
ci_039                 1.622692e-03 3 1  ON 38
ci_040                -3.561858e-03 3 1  ON 39
ci_041                 9.546457e-03 3 1  ON 40
ci_042                 9.371290e-03 3 1  ON 41
ci_043                -4.177283e-03 3 1  ON 42
ci_044                -3.488676e-03 3 1  ON 43
ci_045                -3.342624e-03 3 1  ON 44
ci_046                 5.247078e-03 3 1  ON 45
ci_047                 6.347424e-03 3 1  ON 46
ci_048                -1.432217e-02 3 1  ON 47
ci_049                -1.263561e-02 3 1  ON 48
ci_050                 2.965564e-03 3 1  ON 49
ci_051                 2.664420e-03 3 1  ON 50
ci_052                -1.909545e-03 3 1  ON 51
ci_053                -3.129828e-03 3 1  ON 52
ci_054                -2.549293e-03 3 1  ON 53
ci_055                -3.449201e-03 3 1  ON 54
ci_056                 6.366529e-03 3 1  ON 55
ci_057                 6.036098e-03 3 1  ON 56
ci_058                -1.527931e-03 3 1  ON 57
ci_059                -2.151972e-03 3 1  ON 58
ci_060                 5.529804e-03 3 1  ON 59
ci_061                 5.943901e-03 3 1  ON 60
ci_062                -4.041146e-03 3 1  ON 61
ci_063                -4.295577e-03 3 1  ON 62
ci_064                -3.215977e-03 3 1  ON 63
ci_065                -4.201477e-03 3 1  ON 64
ci_066                 5.110132e-03 3 1  ON 65
ci_067                 4.524903e-03 3 1  ON 66
ci_068                -4.767385e-03 3 1  ON 67
ci_069                -5.134548e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.2293
    reference variance = 0.310815
====================================================
  Execution time = 1.3601e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.9010e-01
  Total weights = 1.9575e+06
  Execution time = 1.8544e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.129145
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279727397487
                                         uncertainty =       0.001601626857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279727397487
                                         uncertainty =       0.001601626857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373979498
  error estimate for blocks of size 2^( 2) =       0.000388054473
  error estimate for blocks of size 2^( 3) =       0.000400389562
  error estimate for blocks of size 2^( 4) =       0.000409475251
  error estimate for blocks of size 2^( 5) =       0.000414212048
  error estimate for blocks of size 2^( 6) =       0.000417138548
  error estimate for blocks of size 2^( 7) =       0.000419500978

      target function =      -0.881327072657
              le_mean =     -17.211548073876
             les_mean =     296.552896307034
             stat err =       0.000415081706
             autocorr =       1.231889057333
   target nu stat err =       0.000415081706
   target dn stat err =       0.013843900209
      target stat err =       0.016677763157
              std dev =       0.528886878373
             le_variance =       0.279721330115

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278765644005
                                         uncertainty =       0.001625261814

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278765644005
                                         uncertainty =       0.001625261814

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373334383
  error estimate for blocks of size 2^( 2) =       0.000387429271
  error estimate for blocks of size 2^( 3) =       0.000399758268
  error estimate for blocks of size 2^( 4) =       0.000408897839
  error estimate for blocks of size 2^( 5) =       0.000413684476
  error estimate for blocks of size 2^( 6) =       0.000416660496
  error estimate for blocks of size 2^( 7) =       0.000418962217

      target function =      -0.913279215406
              le_mean =     -17.211416807786
             les_mean =     296.522985340248
             stat err =       0.000414551257
             autocorr =       1.232992668770
   target nu stat err =       0.000414551257
   target dn stat err =       0.002551162161
      target stat err =       0.003348336922
              std dev =       0.527974547674
             le_variance =       0.278757122991

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.124484
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282475196639
                                         uncertainty =       0.002233476866

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282475196639
                                         uncertainty =       0.002233476866

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375805745
  error estimate for blocks of size 2^( 2) =       0.000389855159
  error estimate for blocks of size 2^( 3) =       0.000402115780
  error estimate for blocks of size 2^( 4) =       0.000411234267
  error estimate for blocks of size 2^( 5) =       0.000415937949
  error estimate for blocks of size 2^( 6) =       0.000418863258
  error estimate for blocks of size 2^( 7) =       0.000421355330

      target function =      -0.602204740870
              le_mean =     -17.211510758379
             les_mean =     296.844188620045
             stat err =       0.000416847701
             autocorr =       1.230348069833
   target nu stat err =       0.000416847701
   target dn stat err =       0.219797615216
      target stat err =       0.129183136137
              std dev =       0.531469580729
             le_variance =       0.282459915241

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278748572224
                                         uncertainty =       0.001623805874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278748572224
                                         uncertainty =       0.001623805874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373323029
  error estimate for blocks of size 2^( 2) =       0.000387418226
  error estimate for blocks of size 2^( 3) =       0.000399747387
  error estimate for blocks of size 2^( 4) =       0.000408886500
  error estimate for blocks of size 2^( 5) =       0.000413672505
  error estimate for blocks of size 2^( 6) =       0.000416649134
  error estimate for blocks of size 2^( 7) =       0.000418951686

      target function =      -0.913297017371
              le_mean =     -17.211416704382
             les_mean =     296.522968071400
             stat err =       0.000414539956
             autocorr =       1.233000445025
   target nu stat err =       0.000414539956
   target dn stat err =       0.002539041023
      target stat err =       0.003333041693
              std dev =       0.527958490483
             le_variance =       0.278740167673


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.881327072657        initial
     1.4901e-04     1.4901e-03             2.3173e-03        -0.913279215406
     5.9605e-04     5.9605e-03             2.3046e-03        -0.602204740870
     2.3842e-03     2.3842e-02             2.2555e-03        -0.913297017371  <--

*****************************************************************************
Applying the update for shift_i =   2.3842e-03     and shift_s =   2.3842e-02
*****************************************************************************

  Execution time = 2.2960e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
ci_001                -4.194691e-02 3 1  ON 0
ci_002                -3.312852e-02 3 1  ON 1
ci_003                -2.652121e-02 3 1  ON 2
ci_004                 2.523689e-02 3 1  ON 3
ci_005                 2.494754e-02 3 1  ON 4
ci_006                -2.187700e-02 3 1  ON 5
ci_007                -2.282270e-02 3 1  ON 6
ci_008                -8.304705e-03 3 1  ON 7
ci_009                -1.425003e-02 3 1  ON 8
ci_010                -9.581830e-03 3 1  ON 9
ci_011                -1.001886e-02 3 1  ON 10
ci_012                -9.182143e-03 3 1  ON 11
ci_013                -2.044505e-02 3 1  ON 12
ci_014                 1.315490e-02 3 1  ON 13
ci_015                 1.163408e-02 3 1  ON 14
ci_016                 1.696787e-02 3 1  ON 15
ci_017                 1.640868e-02 3 1  ON 16
ci_018                 1.071250e-02 3 1  ON 17
ci_019                 1.068136e-02 3 1  ON 18
ci_020                 1.812986e-02 3 1  ON 19
ci_021                 1.830408e-02 3 1  ON 20
ci_022                 1.009386e-02 3 1  ON 21
ci_023                 8.227503e-03 3 1  ON 22
ci_024                 1.043580e-02 3 1  ON 23
ci_025                 8.799664e-03 3 1  ON 24
ci_026                 1.255785e-02 3 1  ON 25
ci_027                 9.832875e-03 3 1  ON 26
ci_028                -1.642718e-02 3 1  ON 27
ci_029                -1.580860e-02 3 1  ON 28
ci_030                -9.034289e-03 3 1  ON 29
ci_031                -1.112568e-02 3 1  ON 30
ci_032                -1.484140e-02 3 1  ON 31
ci_033                 4.121182e-03 3 1  ON 32
ci_034                 5.007900e-03 3 1  ON 33
ci_035                -5.687825e-03 3 1  ON 34
ci_036                -1.090005e-02 3 1  ON 35
ci_037                -1.292031e-02 3 1  ON 36
ci_038                 1.746094e-03 3 1  ON 37
ci_039                 1.641135e-03 3 1  ON 38
ci_040                -3.563301e-03 3 1  ON 39
ci_041                 9.518577e-03 3 1  ON 40
ci_042                 9.357459e-03 3 1  ON 41
ci_043                -4.172724e-03 3 1  ON 42
ci_044                -3.492919e-03 3 1  ON 43
ci_045                -3.339625e-03 3 1  ON 44
ci_046                 5.269117e-03 3 1  ON 45
ci_047                 6.333868e-03 3 1  ON 46
ci_048                -1.428628e-02 3 1  ON 47
ci_049                -1.265136e-02 3 1  ON 48
ci_050                 2.941926e-03 3 1  ON 49
ci_051                 2.689234e-03 3 1  ON 50
ci_052                -1.923463e-03 3 1  ON 51
ci_053                -3.129533e-03 3 1  ON 52
ci_054                -2.562836e-03 3 1  ON 53
ci_055                -3.447834e-03 3 1  ON 54
ci_056                 6.358361e-03 3 1  ON 55
ci_057                 6.052532e-03 3 1  ON 56
ci_058                -1.546839e-03 3 1  ON 57
ci_059                -2.152574e-03 3 1  ON 58
ci_060                 5.506421e-03 3 1  ON 59
ci_061                 5.906710e-03 3 1  ON 60
ci_062                -4.027419e-03 3 1  ON 61
ci_063                -4.293648e-03 3 1  ON 62
ci_064                -3.205549e-03 3 1  ON 63
ci_065                -4.190050e-03 3 1  ON 64
ci_066                 5.094525e-03 3 1  ON 65
ci_067                 4.520888e-03 3 1  ON 66
ci_068                -4.791141e-03 3 1  ON 67
ci_069                -5.135664e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9362e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.2372
    reference variance = 0.157431
====================================================
  Execution time = 1.3885e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8883e-01
  Total weights = 1.956975206e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4893e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279363804960
                                         uncertainty =       0.001583959339

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279363804960
                                         uncertainty =       0.001583959339

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373799237
  error estimate for blocks of size 2^( 2) =       0.000387551904
  error estimate for blocks of size 2^( 3) =       0.000399703950
  error estimate for blocks of size 2^( 4) =       0.000408633385
  error estimate for blocks of size 2^( 5) =       0.000413685769
  error estimate for blocks of size 2^( 6) =       0.000416621008
  error estimate for blocks of size 2^( 7) =       0.000418061357

      target function =      -0.915071178681
              le_mean =     -17.211893181794
             les_mean =     296.538096280500
             stat err =       0.000414250380
             autocorr =       1.228143206602
   target nu stat err =       0.000414250380
   target dn stat err =       0.002146111045
      target stat err =       0.002847413110
              std dev =       0.528631950189
             le_variance =       0.279451738760


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721189318179e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e-04, overlap shift 5.9605e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915079333262       residual = 1.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915986591010       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916111857128       residual = 5.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916138187026       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916145125059       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916147783868       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916148932297       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916148397942       residual = 9.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916148434466       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916148514644       residual = 6.80e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916148581520       residual = 1.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916148604082       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-04 is 2.645254e-03

solving harmonic davidson linear method for identity shift 2.3842e-03, overlap shift 2.3842e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915079333262       residual = 1.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915966409183       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916087951758       residual = 4.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916113377323       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916120020122       residual = 3.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916122553001       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916123631725       residual = 2.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916123115759       residual = 8.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916123153709       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916123229595       residual = 6.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916123293160       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916123314036       residual = 3.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-03 is 2.583679e-03

solving harmonic davidson linear method for identity shift 9.5367e-03, overlap shift 9.5367e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915079333262       residual = 1.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915893919420       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916002492552       residual = 4.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916024823454       residual = 9.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916030479780       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916032600025       residual = 9.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916033455093       residual = 1.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916033003519       residual = 7.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916033046025       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916033107655       residual = 5.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916033160556       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.916033176188       residual = 2.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e-03 is 2.363889e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.622162 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6393e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
ci_001                -4.141947e-02 3 1  ON 0
ci_002                -3.318014e-02 3 1  ON 1
ci_003                -2.633424e-02 3 1  ON 2
ci_004                 2.342732e-02 3 1  ON 3
ci_005                 2.410265e-02 3 1  ON 4
ci_006                -2.205364e-02 3 1  ON 5
ci_007                -2.203092e-02 3 1  ON 6
ci_008                -9.148231e-03 3 1  ON 7
ci_009                -1.469260e-02 3 1  ON 8
ci_010                -9.742166e-03 3 1  ON 9
ci_011                -1.008723e-02 3 1  ON 10
ci_012                -1.019693e-02 3 1  ON 11
ci_013                -1.912545e-02 3 1  ON 12
ci_014                 1.236222e-02 3 1  ON 13
ci_015                 1.304073e-02 3 1  ON 14
ci_016                 1.603112e-02 3 1  ON 15
ci_017                 1.663496e-02 3 1  ON 16
ci_018                 1.049610e-02 3 1  ON 17
ci_019                 1.056395e-02 3 1  ON 18
ci_020                 1.917130e-02 3 1  ON 19
ci_021                 1.837508e-02 3 1  ON 20
ci_022                 1.008925e-02 3 1  ON 21
ci_023                 1.054143e-02 3 1  ON 22
ci_024                 8.802088e-03 3 1  ON 23
ci_025                 9.301667e-03 3 1  ON 24
ci_026                 1.171434e-02 3 1  ON 25
ci_027                 1.123658e-02 3 1  ON 26
ci_028                -1.518403e-02 3 1  ON 27
ci_029                -1.591138e-02 3 1  ON 28
ci_030                -9.765078e-03 3 1  ON 29
ci_031                -8.541997e-03 3 1  ON 30
ci_032                -1.358246e-02 3 1  ON 31
ci_033                 6.173753e-03 3 1  ON 32
ci_034                 6.521081e-03 3 1  ON 33
ci_035                -5.318537e-03 3 1  ON 34
ci_036                -1.327583e-02 3 1  ON 35
ci_037                -1.309899e-02 3 1  ON 36
ci_038                 1.528349e-03 3 1  ON 37
ci_039                 2.080277e-03 3 1  ON 38
ci_040                -3.383694e-03 3 1  ON 39
ci_041                 9.147523e-03 3 1  ON 40
ci_042                 8.057153e-03 3 1  ON 41
ci_043                -4.204304e-03 3 1  ON 42
ci_044                -4.924037e-03 3 1  ON 43
ci_045                -3.018542e-03 3 1  ON 44
ci_046                 5.984319e-03 3 1  ON 45
ci_047                 5.794909e-03 3 1  ON 46
ci_048                -1.302386e-02 3 1  ON 47
ci_049                -1.256729e-02 3 1  ON 48
ci_050                 3.143040e-03 3 1  ON 49
ci_051                 2.873430e-03 3 1  ON 50
ci_052                -2.271600e-03 3 1  ON 51
ci_053                -2.434184e-03 3 1  ON 52
ci_054                -2.711573e-03 3 1  ON 53
ci_055                -2.639725e-03 3 1  ON 54
ci_056                 5.842213e-03 3 1  ON 55
ci_057                 5.774002e-03 3 1  ON 56
ci_058                -2.690702e-03 3 1  ON 57
ci_059                -1.355323e-03 3 1  ON 58
ci_060                 5.183801e-03 3 1  ON 59
ci_061                 5.638892e-03 3 1  ON 60
ci_062                -3.452477e-03 3 1  ON 61
ci_063                -3.659137e-03 3 1  ON 62
ci_064                -3.103843e-03 3 1  ON 63
ci_065                -3.888747e-03 3 1  ON 64
ci_066                 4.534363e-03 3 1  ON 65
ci_067                 4.459478e-03 3 1  ON 66
ci_068                -4.926266e-03 3 1  ON 67
ci_069                -4.778635e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.1455
    reference variance = 0.384282
====================================================
  Execution time = 1.3555e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9007e-01
  Total weights = 1.9571e+06
  Execution time = 1.8587e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279902863498
                                         uncertainty =       0.001899001282

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279902863498
                                         uncertainty =       0.001899001282

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374083970
  error estimate for blocks of size 2^( 2) =       0.000388256268
  error estimate for blocks of size 2^( 3) =       0.000400713000
  error estimate for blocks of size 2^( 4) =       0.000409355044
  error estimate for blocks of size 2^( 5) =       0.000415088403
  error estimate for blocks of size 2^( 6) =       0.000417977282
  error estimate for blocks of size 2^( 7) =       0.000419640714

      target function =      -0.883632070811
              le_mean =     -17.211713088399
             les_mean =     296.556551143448
             stat err =       0.000415515361
             autocorr =       1.233775008852
   target nu stat err =       0.000415515361
   target dn stat err =       0.017139005047
      target stat err =       0.020760683466
              std dev =       0.529034624543
             le_variance =       0.279877633965

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278022979901
                                         uncertainty =       0.001556368363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278022979901
                                         uncertainty =       0.001556368363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372824516
  error estimate for blocks of size 2^( 2) =       0.000387024286
  error estimate for blocks of size 2^( 3) =       0.000399428449
  error estimate for blocks of size 2^( 4) =       0.000408024831
  error estimate for blocks of size 2^( 5) =       0.000413672783
  error estimate for blocks of size 2^( 6) =       0.000416578982
  error estimate for blocks of size 2^( 7) =       0.000418136259

      target function =      -0.913520299853
              le_mean =     -17.211544607940
             les_mean =     296.527224361087
             stat err =       0.000414103214
             autocorr =       1.233696336612
   target nu stat err =       0.000414103214
   target dn stat err =       0.002358281032
      target stat err =       0.003105359624
              std dev =       0.527253487596
             le_variance =       0.277996240183

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279552766875
                                         uncertainty =       0.001528853862

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279552766875
                                         uncertainty =       0.001528853862

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373846636
  error estimate for blocks of size 2^( 2) =       0.000388030665
  error estimate for blocks of size 2^( 3) =       0.000400375414
  error estimate for blocks of size 2^( 4) =       0.000408969356
  error estimate for blocks of size 2^( 5) =       0.000414578677
  error estimate for blocks of size 2^( 6) =       0.000417461509
  error estimate for blocks of size 2^( 7) =       0.000418996969

      target function =      -0.903122897158
              le_mean =     -17.211661323773
             les_mean =     296.539385201371
             stat err =       0.000415001628
             autocorr =       1.232289214549
   target nu stat err =       0.000415001628
   target dn stat err =       0.003723606203
      target stat err =       0.004742708961
              std dev =       0.528698982216
             le_variance =       0.279522613796

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277996067048
                                         uncertainty =       0.001562386052

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277996067048
                                         uncertainty =       0.001562386052

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372806698
  error estimate for blocks of size 2^( 2) =       0.000387006982
  error estimate for blocks of size 2^( 3) =       0.000399418776
  error estimate for blocks of size 2^( 4) =       0.000408015135
  error estimate for blocks of size 2^( 5) =       0.000413667608
  error estimate for blocks of size 2^( 6) =       0.000416578967
  error estimate for blocks of size 2^( 7) =       0.000418140973

      target function =      -0.911428010856
              le_mean =     -17.211545840059
             les_mean =     296.528886387226
             stat err =       0.000414100671
             autocorr =       1.233799113407
   target nu stat err =       0.000414100671
   target dn stat err =       0.002695835716
      target stat err =       0.003519036738
              std dev =       0.527228289133
             le_variance =       0.277969668862


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.883632070811        initial
     5.9605e-04     5.9605e-03             2.6453e-03        -0.913520299853  <--
     2.3842e-03     2.3842e-02             2.5837e-03        -0.903122897158
     9.5367e-03     9.5367e-02             2.3639e-03        -0.911428010856

*****************************************************************************
Applying the update for shift_i =   5.9605e-04     and shift_s =   5.9605e-03
*****************************************************************************

  Execution time = 2.2947e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
ci_001                -4.140746e-02 3 1  ON 0
ci_002                -3.318195e-02 3 1  ON 1
ci_003                -2.633875e-02 3 1  ON 2
ci_004                 2.337260e-02 3 1  ON 3
ci_005                 2.408438e-02 3 1  ON 4
ci_006                -2.206013e-02 3 1  ON 5
ci_007                -2.200953e-02 3 1  ON 6
ci_008                -9.168847e-03 3 1  ON 7
ci_009                -1.470383e-02 3 1  ON 8
ci_010                -9.746227e-03 3 1  ON 9
ci_011                -1.008930e-02 3 1  ON 10
ci_012                -1.022263e-02 3 1  ON 11
ci_013                -1.908344e-02 3 1  ON 12
ci_014                 1.234174e-02 3 1  ON 13
ci_015                 1.307505e-02 3 1  ON 14
ci_016                 1.600301e-02 3 1  ON 15
ci_017                 1.664395e-02 3 1  ON 16
ci_018                 1.049183e-02 3 1  ON 17
ci_019                 1.056435e-02 3 1  ON 18
ci_020                 1.920182e-02 3 1  ON 19
ci_021                 1.837778e-02 3 1  ON 20
ci_022                 1.009091e-02 3 1  ON 21
ci_023                 1.060232e-02 3 1  ON 22
ci_024                 8.755990e-03 3 1  ON 23
ci_025                 9.315083e-03 3 1  ON 24
ci_026                 1.168994e-02 3 1  ON 25
ci_027                 1.126801e-02 3 1  ON 26
ci_028                -1.514608e-02 3 1  ON 27
ci_029                -1.591098e-02 3 1  ON 28
ci_030                -9.779123e-03 3 1  ON 29
ci_031                -8.480423e-03 3 1  ON 30
ci_032                -1.354986e-02 3 1  ON 31
ci_033                 6.228854e-03 3 1  ON 32
ci_034                 6.560985e-03 3 1  ON 33
ci_035                -5.309887e-03 3 1  ON 34
ci_036                -1.333332e-02 3 1  ON 35
ci_037                -1.310636e-02 3 1  ON 36
ci_038                 1.523455e-03 3 1  ON 37
ci_039                 2.090561e-03 3 1  ON 38
ci_040                -3.379670e-03 3 1  ON 39
ci_041                 9.135397e-03 3 1  ON 40
ci_042                 8.027060e-03 3 1  ON 41
ci_043                -4.205081e-03 3 1  ON 42
ci_044                -4.959466e-03 3 1  ON 43
ci_045                -3.011085e-03 3 1  ON 44
ci_046                 6.003010e-03 3 1  ON 45
ci_047                 5.780943e-03 3 1  ON 46
ci_048                -1.299005e-02 3 1  ON 47
ci_049                -1.255735e-02 3 1  ON 48
ci_050                 3.147754e-03 3 1  ON 49
ci_051                 2.877463e-03 3 1  ON 50
ci_052                -2.276419e-03 3 1  ON 51
ci_053                -2.418071e-03 3 1  ON 52
ci_054                -2.713070e-03 3 1  ON 53
ci_055                -2.621234e-03 3 1  ON 54
ci_056                 5.829572e-03 3 1  ON 55
ci_057                 5.767186e-03 3 1  ON 56
ci_058                -2.715301e-03 3 1  ON 57
ci_059                -1.338309e-03 3 1  ON 58
ci_060                 5.175424e-03 3 1  ON 59
ci_061                 5.631962e-03 3 1  ON 60
ci_062                -3.436403e-03 3 1  ON 61
ci_063                -3.644220e-03 3 1  ON 62
ci_064                -3.101742e-03 3 1  ON 63
ci_065                -3.881859e-03 3 1  ON 64
ci_066                 4.519008e-03 3 1  ON 65
ci_067                 4.456733e-03 3 1  ON 66
ci_068                -4.928796e-03 3 1  ON 67
ci_069                -4.769237e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9354e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.2297
    reference variance = 0.407
====================================================
  Execution time = 1.3956e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8877e-01
  Total weights = 1.957101839e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4851e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276599583088
                                         uncertainty =       0.002161610362

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276599583088
                                         uncertainty =       0.002161610362

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371890626
  error estimate for blocks of size 2^( 2) =       0.000385568076
  error estimate for blocks of size 2^( 3) =       0.000397539216
  error estimate for blocks of size 2^( 4) =       0.000406190575
  error estimate for blocks of size 2^( 5) =       0.000412165018
  error estimate for blocks of size 2^( 6) =       0.000414744822
  error estimate for blocks of size 2^( 7) =       0.000415294335

      target function =      -0.915358272523
              le_mean =     -17.212784256828
             les_mean =     296.568716592557
             stat err =       0.000412098688
             autocorr =       1.227925445071
   target nu stat err =       0.000412098688
   target dn stat err =       0.003276585384
      target stat err =       0.004302354336
              std dev =       0.525932767541
             le_variance =       0.276605275973


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721278425683e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e-04, overlap shift 1.4901e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915377921118       residual = 6.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915769132847       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915862427300       residual = 4.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915895466897       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915908382608       residual = 4.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915910334544       residual = 8.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915911695947       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915910961118       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915911073920       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915911323269       residual = 5.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915911327724       residual = 1.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915911317241       residual = 1.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-04 is 2.103279e-03

solving harmonic davidson linear method for identity shift 5.9605e-04, overlap shift 5.9605e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915377921118       residual = 6.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915766866693       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915859469821       residual = 4.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915892197505       residual = 9.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915904971414       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915906892143       residual = 8.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915908237056       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915907511582       residual = 8.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915907620871       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915907867736       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915907871638       residual = 1.20e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915907861442       residual = 1.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-04 is 2.087099e-03

solving harmonic davidson linear method for identity shift 2.3842e-03, overlap shift 2.3842e-02 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915377921118       residual = 6.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915758058547       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915847993120       residual = 4.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915879525687       residual = 9.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915891759148       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915893562476       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915894844811       residual = 2.11e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915894154962       residual = 7.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915894251245       residual = 1.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915894488520       residual = 4.99e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915894490432       residual = 1.11e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915894481297       residual = 1.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e-03 is 2.024804e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.632202 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6460e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
ci_001                -4.163617e-02 3 1  ON 0
ci_002                -3.291510e-02 3 1  ON 1
ci_003                -2.622161e-02 3 1  ON 2
ci_004                 2.545970e-02 3 1  ON 3
ci_005                 2.584685e-02 3 1  ON 4
ci_006                -2.172456e-02 3 1  ON 5
ci_007                -2.116358e-02 3 1  ON 6
ci_008                -9.493327e-03 3 1  ON 7
ci_009                -1.500590e-02 3 1  ON 8
ci_010                -9.703525e-03 3 1  ON 9
ci_011                -1.121163e-02 3 1  ON 10
ci_012                -1.167473e-02 3 1  ON 11
ci_013                -2.040656e-02 3 1  ON 12
ci_014                 1.249918e-02 3 1  ON 13
ci_015                 1.308469e-02 3 1  ON 14
ci_016                 1.722003e-02 3 1  ON 15
ci_017                 1.675208e-02 3 1  ON 16
ci_018                 1.129771e-02 3 1  ON 17
ci_019                 1.047220e-02 3 1  ON 18
ci_020                 1.782171e-02 3 1  ON 19
ci_021                 1.748605e-02 3 1  ON 20
ci_022                 9.547702e-03 3 1  ON 21
ci_023                 9.733387e-03 3 1  ON 22
ci_024                 8.617545e-03 3 1  ON 23
ci_025                 1.008564e-02 3 1  ON 24
ci_026                 1.225101e-02 3 1  ON 25
ci_027                 1.236511e-02 3 1  ON 26
ci_028                -1.499867e-02 3 1  ON 27
ci_029                -1.462924e-02 3 1  ON 28
ci_030                -8.971135e-03 3 1  ON 29
ci_031                -8.076306e-03 3 1  ON 30
ci_032                -1.428541e-02 3 1  ON 31
ci_033                 6.668339e-03 3 1  ON 32
ci_034                 5.718294e-03 3 1  ON 33
ci_035                -5.162540e-03 3 1  ON 34
ci_036                -1.339676e-02 3 1  ON 35
ci_037                -1.283243e-02 3 1  ON 36
ci_038                 2.263081e-03 3 1  ON 37
ci_039                 2.560659e-03 3 1  ON 38
ci_040                -3.197045e-03 3 1  ON 39
ci_041                 7.499461e-03 3 1  ON 40
ci_042                 8.425670e-03 3 1  ON 41
ci_043                -4.413518e-03 3 1  ON 42
ci_044                -4.262659e-03 3 1  ON 43
ci_045                -3.133160e-03 3 1  ON 44
ci_046                 5.702344e-03 3 1  ON 45
ci_047                 5.825900e-03 3 1  ON 46
ci_048                -1.162424e-02 3 1  ON 47
ci_049                -1.334797e-02 3 1  ON 48
ci_050                 2.854525e-03 3 1  ON 49
ci_051                 2.987316e-03 3 1  ON 50
ci_052                -2.907854e-03 3 1  ON 51
ci_053                -2.380126e-03 3 1  ON 52
ci_054                -2.588487e-03 3 1  ON 53
ci_055                -2.824275e-03 3 1  ON 54
ci_056                 5.594524e-03 3 1  ON 55
ci_057                 5.775950e-03 3 1  ON 56
ci_058                -3.022977e-03 3 1  ON 57
ci_059                -1.861412e-03 3 1  ON 58
ci_060                 5.817946e-03 3 1  ON 59
ci_061                 4.293294e-03 3 1  ON 60
ci_062                -4.120490e-03 3 1  ON 61
ci_063                -3.605739e-03 3 1  ON 62
ci_064                -3.019165e-03 3 1  ON 63
ci_065                -4.217549e-03 3 1  ON 64
ci_066                 4.549332e-03 3 1  ON 65
ci_067                 4.503563e-03 3 1  ON 66
ci_068                -6.481123e-03 3 1  ON 67
ci_069                -4.858155e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.314
    reference variance = 1.37689
====================================================
  Execution time = 1.3538e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9314e-01
  Total weights = 1.9572e+06
  Execution time = 1.8531e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.180727
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279644939590
                                         uncertainty =       0.002068955121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279644939590
                                         uncertainty =       0.002068955121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373961827
  error estimate for blocks of size 2^( 2) =       0.000387891614
  error estimate for blocks of size 2^( 3) =       0.000400579976
  error estimate for blocks of size 2^( 4) =       0.000409874418
  error estimate for blocks of size 2^( 5) =       0.000415514947
  error estimate for blocks of size 2^( 6) =       0.000418329220
  error estimate for blocks of size 2^( 7) =       0.000420510797

      target function =      -0.895202310786
              le_mean =     -17.212403785935
             les_mean =     296.571341646219
             stat err =       0.000416057345
             autocorr =       1.237803884853
   target nu stat err =       0.000416057345
   target dn stat err =       0.007151237053
      target stat err =       0.008911625167
              std dev =       0.528861887831
             le_variance =       0.279694896400

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279557790985
                                         uncertainty =       0.002165993898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279557790985
                                         uncertainty =       0.002165993898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373901178
  error estimate for blocks of size 2^( 2) =       0.000387740107
  error estimate for blocks of size 2^( 3) =       0.000400347196
  error estimate for blocks of size 2^( 4) =       0.000409544168
  error estimate for blocks of size 2^( 5) =       0.000415116601
  error estimate for blocks of size 2^( 6) =       0.000417846671
  error estimate for blocks of size 2^( 7) =       0.000420022724

      target function =      -0.909501418193
              le_mean =     -17.212311110921
             les_mean =     296.556855803340
             stat err =       0.000415632541
             autocorr =       1.235678295747
   target nu stat err =       0.000415632541
   target dn stat err =       0.004601489534
      target stat err =       0.005934274484
              std dev =       0.528776116789
             le_variance =       0.279604181687

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.188829
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286855279937
                                         uncertainty =       0.004476796125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286855279937
                                         uncertainty =       0.004476796125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378742809
  error estimate for blocks of size 2^( 2) =       0.000392276069
  error estimate for blocks of size 2^( 3) =       0.000404664607
  error estimate for blocks of size 2^( 4) =       0.000413620569
  error estimate for blocks of size 2^( 5) =       0.000418953236
  error estimate for blocks of size 2^( 6) =       0.000421399744
  error estimate for blocks of size 2^( 7) =       0.000423597184

      target function =      -0.451700149707
              le_mean =     -17.212350907797
             les_mean =     297.173760821242
             stat err =       0.000419392683
             autocorr =       1.226176268228
   target nu stat err =       0.000419392683
   target dn stat err =       0.369089312616
      target stat err =       0.125902143428
              std dev =       0.535623217646
             le_variance =       0.286892231282

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279512218135
                                         uncertainty =       0.002159994972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279512218135
                                         uncertainty =       0.002159994972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373870845
  error estimate for blocks of size 2^( 2) =       0.000387712763
  error estimate for blocks of size 2^( 3) =       0.000400322647
  error estimate for blocks of size 2^( 4) =       0.000409522478
  error estimate for blocks of size 2^( 5) =       0.000415096458
  error estimate for blocks of size 2^( 6) =       0.000417828654
  error estimate for blocks of size 2^( 7) =       0.000420009242

      target function =      -0.908777032697
              le_mean =     -17.212310742813
             les_mean =     296.557407695123
             stat err =       0.000415614208
             autocorr =       1.235769785659
   target nu stat err =       0.000415614208
   target dn stat err =       0.004626765995
      target stat err =       0.005957096304
              std dev =       0.528733219480
             le_variance =       0.279558817382


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.895202310786        initial
     1.4901e-04     1.4901e-03             2.1033e-03        -0.909501418193  <--
     5.9605e-04     5.9605e-03             2.0871e-03        -0.451700149707
     2.3842e-03     2.3842e-02             2.0248e-03        -0.908777032697

*****************************************************************************
Applying the update for shift_i =   1.4901e-04     and shift_s =   1.4901e-03
*****************************************************************************

  Execution time = 2.2892e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
ci_001                -4.163744e-02 3 1  ON 0
ci_002                -3.291338e-02 3 1  ON 1
ci_003                -2.622084e-02 3 1  ON 2
ci_004                 2.547588e-02 3 1  ON 3
ci_005                 2.586121e-02 3 1  ON 4
ci_006                -2.172153e-02 3 1  ON 5
ci_007                -2.115730e-02 3 1  ON 6
ci_008                -9.495030e-03 3 1  ON 7
ci_009                -1.500780e-02 3 1  ON 8
ci_010                -9.703351e-03 3 1  ON 9
ci_011                -1.121883e-02 3 1  ON 10
ci_012                -1.168389e-02 3 1  ON 11
ci_013                -2.041739e-02 3 1  ON 12
ci_014                 1.250007e-02 3 1  ON 13
ci_015                 1.308448e-02 3 1  ON 14
ci_016                 1.722922e-02 3 1  ON 15
ci_017                 1.675316e-02 3 1  ON 16
ci_018                 1.130205e-02 3 1  ON 17
ci_019                 1.047099e-02 3 1  ON 18
ci_020                 1.781196e-02 3 1  ON 19
ci_021                 1.748014e-02 3 1  ON 20
ci_022                 9.544036e-03 3 1  ON 21
ci_023                 9.727150e-03 3 1  ON 22
ci_024                 8.616558e-03 3 1  ON 23
ci_025                 1.009077e-02 3 1  ON 24
ci_026                 1.225598e-02 3 1  ON 25
ci_027                 1.237297e-02 3 1  ON 26
ci_028                -1.499671e-02 3 1  ON 27
ci_029                -1.462031e-02 3 1  ON 28
ci_030                -8.965261e-03 3 1  ON 29
ci_031                -8.074070e-03 3 1  ON 30
ci_032                -1.429018e-02 3 1  ON 31
ci_033                 6.671294e-03 3 1  ON 32
ci_034                 5.712758e-03 3 1  ON 33
ci_035                -5.161645e-03 3 1  ON 34
ci_036                -1.339719e-02 3 1  ON 35
ci_037                -1.283093e-02 3 1  ON 36
ci_038                 2.267378e-03 3 1  ON 37
ci_039                 2.563420e-03 3 1  ON 38
ci_040                -3.195993e-03 3 1  ON 39
ci_041                 7.489734e-03 3 1  ON 40
ci_042                 8.427300e-03 3 1  ON 41
ci_043                -4.414748e-03 3 1  ON 42
ci_044                -4.258183e-03 3 1  ON 43
ci_045                -3.133812e-03 3 1  ON 44
ci_046                 5.700367e-03 3 1  ON 45
ci_047                 5.826200e-03 3 1  ON 46
ci_048                -1.161310e-02 3 1  ON 47
ci_049                -1.335294e-02 3 1  ON 48
ci_050                 2.852968e-03 3 1  ON 49
ci_051                 2.987973e-03 3 1  ON 50
ci_052                -2.912001e-03 3 1  ON 51
ci_053                -2.380169e-03 3 1  ON 52
ci_054                -2.587395e-03 3 1  ON 53
ci_055                -2.825507e-03 3 1  ON 54
ci_056                 5.593106e-03 3 1  ON 55
ci_057                 5.775969e-03 3 1  ON 56
ci_058                -3.024811e-03 3 1  ON 57
ci_059                -1.864340e-03 3 1  ON 58
ci_060                 5.822296e-03 3 1  ON 59
ci_061                 4.284641e-03 3 1  ON 60
ci_062                -4.124695e-03 3 1  ON 61
ci_063                -3.605750e-03 3 1  ON 62
ci_064                -3.018710e-03 3 1  ON 63
ci_065                -4.219494e-03 3 1  ON 64
ci_066                 4.549398e-03 3 1  ON 65
ci_067                 4.504071e-03 3 1  ON 66
ci_068                -6.491373e-03 3 1  ON 67
ci_069                -4.858846e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9366e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.1818
    reference variance = 0.259438
====================================================
  Execution time = 1.3963e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8848e-01
  Total weights = 1.957035724e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5193e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278712599713
                                         uncertainty =       0.001545497408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278712599713
                                         uncertainty =       0.001545497408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373296957
  error estimate for blocks of size 2^( 2) =       0.000387220017
  error estimate for blocks of size 2^( 3) =       0.000398802969
  error estimate for blocks of size 2^( 4) =       0.000407644145
  error estimate for blocks of size 2^( 5) =       0.000413217360
  error estimate for blocks of size 2^( 6) =       0.000416952085
  error estimate for blocks of size 2^( 7) =       0.000418299024

      target function =      -0.915579720050
              le_mean =     -17.212116093364
             les_mean =     296.545423952785
             stat err =       0.000414028154
             autocorr =       1.230129544105
   target nu stat err =       0.000414028154
   target dn stat err =       0.001862603719
      target stat err =       0.002491915957
              std dev =       0.527921618766
             le_variance =       0.278701235561


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721211609336e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-05, overlap shift 3.7253e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915585772291       residual = 8.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915995392947       residual = 9.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916064371071       residual = 4.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916089505096       residual = 8.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916094987590       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916096475104       residual = 9.57e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916096102222       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916095986837       residual = 5.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916095866864       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916095792038       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916095744418       residual = 8.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-05 is 2.668192e-03

solving harmonic davidson linear method for identity shift 1.4901e-04, overlap shift 1.4901e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915585772291       residual = 8.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915994803357       residual = 9.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916063656933       residual = 4.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916088732020       residual = 8.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916094198460       residual = 3.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916095681317       residual = 9.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916095308768       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916095193814       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916095074031       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916094999608       residual = 3.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916094952063       residual = 8.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-04 is 2.663311e-03

solving harmonic davidson linear method for identity shift 5.9605e-04, overlap shift 5.9605e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915585772291       residual = 8.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915992461863       residual = 9.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916060821606       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916085663471       residual = 8.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916091066505       residual = 3.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916092530991       residual = 9.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916092159791       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916092046533       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916091927511       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916091854670       residual = 3.78e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916091807427       residual = 8.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-04 is 2.643967e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.641142 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6500e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
ci_001                -4.170942e-02 3 1  ON 0
ci_002                -3.364674e-02 3 1  ON 1
ci_003                -2.600476e-02 3 1  ON 2
ci_004                 2.281257e-02 3 1  ON 3
ci_005                 2.520325e-02 3 1  ON 4
ci_006                -2.147066e-02 3 1  ON 5
ci_007                -2.187749e-02 3 1  ON 6
ci_008                -8.696352e-03 3 1  ON 7
ci_009                -1.566056e-02 3 1  ON 8
ci_010                -9.069690e-03 3 1  ON 9
ci_011                -1.177279e-02 3 1  ON 10
ci_012                -1.083898e-02 3 1  ON 11
ci_013                -2.004570e-02 3 1  ON 12
ci_014                 1.253529e-02 3 1  ON 13
ci_015                 1.308929e-02 3 1  ON 14
ci_016                 1.652773e-02 3 1  ON 15
ci_017                 1.706909e-02 3 1  ON 16
ci_018                 1.080154e-02 3 1  ON 17
ci_019                 1.082695e-02 3 1  ON 18
ci_020                 1.774146e-02 3 1  ON 19
ci_021                 1.819412e-02 3 1  ON 20
ci_022                 9.701110e-03 3 1  ON 21
ci_023                 9.893226e-03 3 1  ON 22
ci_024                 1.020470e-02 3 1  ON 23
ci_025                 8.902642e-03 3 1  ON 24
ci_026                 1.270856e-02 3 1  ON 25
ci_027                 1.205116e-02 3 1  ON 26
ci_028                -1.559031e-02 3 1  ON 27
ci_029                -1.589421e-02 3 1  ON 28
ci_030                -9.356250e-03 3 1  ON 29
ci_031                -8.313174e-03 3 1  ON 30
ci_032                -1.423733e-02 3 1  ON 31
ci_033                 5.881336e-03 3 1  ON 32
ci_034                 6.270254e-03 3 1  ON 33
ci_035                -5.361299e-03 3 1  ON 34
ci_036                -1.218318e-02 3 1  ON 35
ci_037                -1.214084e-02 3 1  ON 36
ci_038                 1.797912e-03 3 1  ON 37
ci_039                 1.930753e-03 3 1  ON 38
ci_040                -3.230267e-03 3 1  ON 39
ci_041                 8.080406e-03 3 1  ON 40
ci_042                 8.230889e-03 3 1  ON 41
ci_043                -4.441157e-03 3 1  ON 42
ci_044                -5.299476e-03 3 1  ON 43
ci_045                -3.347618e-03 3 1  ON 44
ci_046                 5.322148e-03 3 1  ON 45
ci_047                 6.350996e-03 3 1  ON 46
ci_048                -1.265226e-02 3 1  ON 47
ci_049                -1.328788e-02 3 1  ON 48
ci_050                 3.564624e-03 3 1  ON 49
ci_051                 3.362935e-03 3 1  ON 50
ci_052                -2.575173e-03 3 1  ON 51
ci_053                -2.759664e-03 3 1  ON 52
ci_054                -3.286638e-03 3 1  ON 53
ci_055                -2.720726e-03 3 1  ON 54
ci_056                 5.857210e-03 3 1  ON 55
ci_057                 5.689770e-03 3 1  ON 56
ci_058                -1.243721e-03 3 1  ON 57
ci_059                -2.285303e-03 3 1  ON 58
ci_060                 5.026121e-03 3 1  ON 59
ci_061                 4.670307e-03 3 1  ON 60
ci_062                -4.176527e-03 3 1  ON 61
ci_063                -4.252051e-03 3 1  ON 62
ci_064                -3.165801e-03 3 1  ON 63
ci_065                -4.020724e-03 3 1  ON 64
ci_066                 4.334430e-03 3 1  ON 65
ci_067                 5.020836e-03 3 1  ON 66
ci_068                -4.804939e-03 3 1  ON 67
ci_069                -4.610018e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.2412
    reference variance = 0.2326
====================================================
  Execution time = 1.3561e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9120e-01
  Total weights = 1.9571e+06
  Execution time = 1.8589e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278212975007
                                         uncertainty =       0.001851149761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278212975007
                                         uncertainty =       0.001851149761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372987128
  error estimate for blocks of size 2^( 2) =       0.000386811658
  error estimate for blocks of size 2^( 3) =       0.000398993007
  error estimate for blocks of size 2^( 4) =       0.000407453024
  error estimate for blocks of size 2^( 5) =       0.000411755087
  error estimate for blocks of size 2^( 6) =       0.000414836987
  error estimate for blocks of size 2^( 7) =       0.000415600195

      target function =      -0.801598985282
              le_mean =     -17.211873332077
             les_mean =     296.632738758258
             stat err =       0.000412411323
             autocorr =       1.222569265553
   target nu stat err =       0.000412411323
   target dn stat err =       0.059778918018
      target stat err =       0.059883950586
              std dev =       0.527483454711
             le_variance =       0.278238794994

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277317035831
                                         uncertainty =       0.001723725604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277317035831
                                         uncertainty =       0.001723725604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372385594
  error estimate for blocks of size 2^( 2) =       0.000386255325
  error estimate for blocks of size 2^( 3) =       0.000398471205
  error estimate for blocks of size 2^( 4) =       0.000406947680
  error estimate for blocks of size 2^( 5) =       0.000411299225
  error estimate for blocks of size 2^( 6) =       0.000414482214
  error estimate for blocks of size 2^( 7) =       0.000415046391

      target function =      -0.911971142086
              le_mean =     -17.211800850321
             les_mean =     296.537287168377
             stat err =       0.000411943877
             autocorr =       1.223743395776
   target nu stat err =       0.000411943877
   target dn stat err =       0.003301858627
      target stat err =       0.004296607838
              std dev =       0.526632757806
             le_variance =       0.277342061594

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279142018349
                                         uncertainty =       0.001898267048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279142018349
                                         uncertainty =       0.001898267048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373605286
  error estimate for blocks of size 2^( 2) =       0.000387512360
  error estimate for blocks of size 2^( 3) =       0.000399762445
  error estimate for blocks of size 2^( 4) =       0.000408259169
  error estimate for blocks of size 2^( 5) =       0.000412660090
  error estimate for blocks of size 2^( 6) =       0.000415851991
  error estimate for blocks of size 2^( 7) =       0.000416447940

      target function =      -0.864319048285
              le_mean =     -17.211886038868
             les_mean =     296.578852172558
             stat err =       0.000413304798
             autocorr =       1.223812456441
   target nu stat err =       0.000413304798
   target dn stat err =       0.017138337845
      target stat err =       0.019867420898
              std dev =       0.528357661871
             le_variance =       0.279161818858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277312117927
                                         uncertainty =       0.001723198527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277312117927
                                         uncertainty =       0.001723198527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372382312
  error estimate for blocks of size 2^( 2) =       0.000386251737
  error estimate for blocks of size 2^( 3) =       0.000398467546
  error estimate for blocks of size 2^( 4) =       0.000406943871
  error estimate for blocks of size 2^( 5) =       0.000411295102
  error estimate for blocks of size 2^( 6) =       0.000414478040
  error estimate for blocks of size 2^( 7) =       0.000415042361

      target function =      -0.911926204422
              le_mean =     -17.211800919136
             les_mean =     296.537324465849
             stat err =       0.000411939844
             autocorr =       1.223741003782
   target nu stat err =       0.000411939844
   target dn stat err =       0.003295756776
      target stat err =       0.004288394263
              std dev =       0.526628115572
             le_variance =       0.277337172111


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.801598985282        initial
     3.7253e-05     3.7253e-04             2.6682e-03        -0.911971142086  <--
     1.4901e-04     1.4901e-03             2.6633e-03        -0.864319048285
     5.9605e-04     5.9605e-03             2.6440e-03        -0.911926204422

*****************************************************************************
Applying the update for shift_i =   3.7253e-05     and shift_s =   3.7253e-04
*****************************************************************************

  Execution time = 2.2939e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
ci_001                -4.170960e-02 3 1  ON 0
ci_002                -3.364800e-02 3 1  ON 1
ci_003                -2.600397e-02 3 1  ON 2
ci_004                 2.280768e-02 3 1  ON 3
ci_005                 2.520189e-02 3 1  ON 4
ci_006                -2.147021e-02 3 1  ON 5
ci_007                -2.187881e-02 3 1  ON 6
ci_008                -8.695148e-03 3 1  ON 7
ci_009                -1.566159e-02 3 1  ON 8
ci_010                -9.068684e-03 3 1  ON 9
ci_011                -1.177361e-02 3 1  ON 10
ci_012                -1.083765e-02 3 1  ON 11
ci_013                -2.004496e-02 3 1  ON 12
ci_014                 1.253529e-02 3 1  ON 13
ci_015                 1.308958e-02 3 1  ON 14
ci_016                 1.652639e-02 3 1  ON 15
ci_017                 1.706962e-02 3 1  ON 16
ci_018                 1.080089e-02 3 1  ON 17
ci_019                 1.082745e-02 3 1  ON 18
ci_020                 1.774133e-02 3 1  ON 19
ci_021                 1.819533e-02 3 1  ON 20
ci_022                 9.701343e-03 3 1  ON 21
ci_023                 9.893566e-03 3 1  ON 22
ci_024                 1.020757e-02 3 1  ON 23
ci_025                 8.900686e-03 3 1  ON 24
ci_026                 1.270874e-02 3 1  ON 25
ci_027                 1.205055e-02 3 1  ON 26
ci_028                -1.559148e-02 3 1  ON 27
ci_029                -1.589651e-02 3 1  ON 28
ci_030                -9.357031e-03 3 1  ON 29
ci_031                -8.313657e-03 3 1  ON 30
ci_032                -1.423723e-02 3 1  ON 31
ci_033                 5.879990e-03 3 1  ON 32
ci_034                 6.271191e-03 3 1  ON 33
ci_035                -5.361600e-03 3 1  ON 34
ci_036                -1.218125e-02 3 1  ON 35
ci_037                -1.213967e-02 3 1  ON 36
ci_038                 1.797222e-03 3 1  ON 37
ci_039                 1.929825e-03 3 1  ON 38
ci_040                -3.230318e-03 3 1  ON 39
ci_041                 8.081376e-03 3 1  ON 40
ci_042                 8.230814e-03 3 1  ON 41
ci_043                -4.441202e-03 3 1  ON 42
ci_044                -5.301105e-03 3 1  ON 43
ci_045                -3.347928e-03 3 1  ON 44
ci_046                 5.321520e-03 3 1  ON 45
ci_047                 6.351863e-03 3 1  ON 46
ci_048                -1.265440e-02 3 1  ON 47
ci_049                -1.328793e-02 3 1  ON 48
ci_050                 3.565597e-03 3 1  ON 49
ci_051                 3.363449e-03 3 1  ON 50
ci_052                -2.574653e-03 3 1  ON 51
ci_053                -2.760189e-03 3 1  ON 52
ci_054                -3.287763e-03 3 1  ON 53
ci_055                -2.720546e-03 3 1  ON 54
ci_056                 5.857607e-03 3 1  ON 55
ci_057                 5.689637e-03 3 1  ON 56
ci_058                -1.241090e-03 3 1  ON 57
ci_059                -2.285917e-03 3 1  ON 58
ci_060                 5.024793e-03 3 1  ON 59
ci_061                 4.670949e-03 3 1  ON 60
ci_062                -4.176738e-03 3 1  ON 61
ci_063                -4.252960e-03 3 1  ON 62
ci_064                -3.166014e-03 3 1  ON 63
ci_065                -4.020433e-03 3 1  ON 64
ci_066                 4.334140e-03 3 1  ON 65
ci_067                 5.021595e-03 3 1  ON 66
ci_068                -4.802175e-03 3 1  ON 67
ci_069                -4.609590e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9454e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.1574
    reference variance = 0.207564
====================================================
  Execution time = 1.3876e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9634e-01
  Total weights = 1.957098926e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4887e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278530231048
                                         uncertainty =       0.001783919138

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278530231048
                                         uncertainty =       0.001783919138

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373280431
  error estimate for blocks of size 2^( 2) =       0.000387174204
  error estimate for blocks of size 2^( 3) =       0.000399632127
  error estimate for blocks of size 2^( 4) =       0.000407751701
  error estimate for blocks of size 2^( 5) =       0.000413106113
  error estimate for blocks of size 2^( 6) =       0.000414641486
  error estimate for blocks of size 2^( 7) =       0.000414475252

      target function =      -0.905341917234
              le_mean =     -17.211607340784
             les_mean =     296.535763901110
             stat err =       0.000412493638
             autocorr =       1.221136082459
   target nu stat err =       0.000412493638
   target dn stat err =       0.003897577099
      target stat err =       0.004984470616
              std dev =       0.527898247853
             le_variance =       0.278676560086


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721160734078e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-06, overlap shift 9.3132e-05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905368437324       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906155970963       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906282351101       residual = 6.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906331120088       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906339968303       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906344228381       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906346082650       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906345786983       residual = 9.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906346061387       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906346102206       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.906345975939       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.906346038845       residual = 5.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-06 is 2.916483e-03

solving harmonic davidson linear method for identity shift 3.7253e-05, overlap shift 3.7253e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905368437324       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906155688086       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906282012064       residual = 6.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906330755093       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906339597520       residual = 5.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906343854723       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906345707231       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906345411706       residual = 9.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906345685874       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906345726668       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.906345600507       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.906345663356       residual = 5.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-05 is 2.915334e-03

solving harmonic davidson linear method for identity shift 1.4901e-04, overlap shift 1.4901e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.905368437324       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.906154558608       residual = 2.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.906280658428       residual = 6.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.906329297885       residual = 1.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.906338117230       residual = 5.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.906342362968       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.906344208461       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.906343913502       residual = 9.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.906344186729       residual = 2.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.906344227424       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.906344101689       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.906344164306       residual = 5.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-04 is 2.910749e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.651071 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6383e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
ci_001                -3.983152e-02 3 1  ON 0
ci_002                -3.332166e-02 3 1  ON 1
ci_003                -2.571955e-02 3 1  ON 2
ci_004                 2.345474e-02 3 1  ON 3
ci_005                 2.485945e-02 3 1  ON 4
ci_006                -2.162176e-02 3 1  ON 5
ci_007                -2.158212e-02 3 1  ON 6
ci_008                -8.898807e-03 3 1  ON 7
ci_009                -1.343466e-02 3 1  ON 8
ci_010                -7.369017e-03 3 1  ON 9
ci_011                -1.177157e-02 3 1  ON 10
ci_012                -9.872812e-03 3 1  ON 11
ci_013                -1.876595e-02 3 1  ON 12
ci_014                 1.248109e-02 3 1  ON 13
ci_015                 1.256519e-02 3 1  ON 14
ci_016                 1.546188e-02 3 1  ON 15
ci_017                 1.739284e-02 3 1  ON 16
ci_018                 1.166162e-02 3 1  ON 17
ci_019                 1.043915e-02 3 1  ON 18
ci_020                 1.712758e-02 3 1  ON 19
ci_021                 1.798188e-02 3 1  ON 20
ci_022                 9.616467e-03 3 1  ON 21
ci_023                 9.810110e-03 3 1  ON 22
ci_024                 8.961590e-03 3 1  ON 23
ci_025                 1.130167e-02 3 1  ON 24
ci_026                 1.143835e-02 3 1  ON 25
ci_027                 1.266040e-02 3 1  ON 26
ci_028                -1.588174e-02 3 1  ON 27
ci_029                -1.591537e-02 3 1  ON 28
ci_030                -7.929447e-03 3 1  ON 29
ci_031                -9.456735e-03 3 1  ON 30
ci_032                -1.568785e-02 3 1  ON 31
ci_033                 5.526836e-03 3 1  ON 32
ci_034                 6.361012e-03 3 1  ON 33
ci_035                -5.623517e-03 3 1  ON 34
ci_036                -1.321486e-02 3 1  ON 35
ci_037                -1.245036e-02 3 1  ON 36
ci_038                 1.953255e-03 3 1  ON 37
ci_039                 2.508663e-03 3 1  ON 38
ci_040                -2.830003e-03 3 1  ON 39
ci_041                 8.202227e-03 3 1  ON 40
ci_042                 9.132330e-03 3 1  ON 41
ci_043                -4.446214e-03 3 1  ON 42
ci_044                -2.385771e-03 3 1  ON 43
ci_045                -3.324698e-03 3 1  ON 44
ci_046                 6.414510e-03 3 1  ON 45
ci_047                 5.573724e-03 3 1  ON 46
ci_048                -1.409410e-02 3 1  ON 47
ci_049                -1.371256e-02 3 1  ON 48
ci_050                 4.288000e-03 3 1  ON 49
ci_051                 3.660369e-03 3 1  ON 50
ci_052                -2.112265e-03 3 1  ON 51
ci_053                -1.906893e-03 3 1  ON 52
ci_054                -2.955862e-03 3 1  ON 53
ci_055                -3.407898e-03 3 1  ON 54
ci_056                 5.007156e-03 3 1  ON 55
ci_057                 5.936895e-03 3 1  ON 56
ci_058                -4.647146e-04 3 1  ON 57
ci_059                -1.451486e-03 3 1  ON 58
ci_060                 5.831737e-03 3 1  ON 59
ci_061                 4.731964e-03 3 1  ON 60
ci_062                -3.686804e-03 3 1  ON 61
ci_063                -4.166045e-03 3 1  ON 62
ci_064                -2.441218e-03 3 1  ON 63
ci_065                -3.728650e-03 3 1  ON 64
ci_066                 4.748670e-03 3 1  ON 65
ci_067                 4.390999e-03 3 1  ON 66
ci_068                -4.739458e-03 3 1  ON 67
ci_069                -4.869417e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.2152
    reference variance = 0.367668
====================================================
  Execution time = 1.3495e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8909e-01
  Total weights = 1.9568e+06
  Execution time = 1.8538e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000335908
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279767560989
                                         uncertainty =       0.001648493659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279767560989
                                         uncertainty =       0.001648493659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373999791
  error estimate for blocks of size 2^( 2) =       0.000388052729
  error estimate for blocks of size 2^( 3) =       0.000400918531
  error estimate for blocks of size 2^( 4) =       0.000409784338
  error estimate for blocks of size 2^( 5) =       0.000415359439
  error estimate for blocks of size 2^( 6) =       0.000417512893
  error estimate for blocks of size 2^( 7) =       0.000418909600

      target function =      -0.891735934427
              le_mean =     -17.211237345074
             les_mean =     296.533750893516
             stat err =       0.000415391567
             autocorr =       1.233595092832
   target nu stat err =       0.000415391567
   target dn stat err =       0.008938895708
      target stat err =       0.011025581083
              std dev =       0.528915576505
             le_variance =       0.279751687070

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278843790911
                                         uncertainty =       0.001568104029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278843790911
                                         uncertainty =       0.001568104029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373381112
  error estimate for blocks of size 2^( 2) =       0.000387611382
  error estimate for blocks of size 2^( 3) =       0.000400573088
  error estimate for blocks of size 2^( 4) =       0.000409531563
  error estimate for blocks of size 2^( 5) =       0.000415158241
  error estimate for blocks of size 2^( 6) =       0.000417446405
  error estimate for blocks of size 2^( 7) =       0.000418864084

      target function =      -0.914543498403
              le_mean =     -17.211098642031
             les_mean =     296.510996988225
             stat err =       0.000415250073
             autocorr =       1.236843486147
   target nu stat err =       0.000415250073
   target dn stat err =       0.001949193352
      target stat err =       0.002592017826
              std dev =       0.528040632452
             le_variance =       0.278826909520

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.000334433
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309730047001
                                         uncertainty =       0.024507498711

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.309730047001
                                         uncertainty =       0.024507498711

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000393510783
  error estimate for blocks of size 2^( 2) =       0.000407226196
  error estimate for blocks of size 2^( 3) =       0.000419781706
  error estimate for blocks of size 2^( 4) =       0.000428448070
  error estimate for blocks of size 2^( 5) =       0.000434026978
  error estimate for blocks of size 2^( 6) =       0.000436331202
  error estimate for blocks of size 2^( 7) =       0.000438115391

      target function =      -0.139348784045
              le_mean =     -17.211272862358
             les_mean =     299.341999352108
             stat err =       0.000434230410
             autocorr =       1.217663238057
   target nu stat err =       0.000434230410
   target dn stat err =       1.973614513818
      target stat err =       0.077889150394
              std dev =       0.556508286090
             le_variance =       0.309701472487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278842974852
                                         uncertainty =       0.001568225546

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278842974852
                                         uncertainty =       0.001568225546

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373380567
  error estimate for blocks of size 2^( 2) =       0.000387610514
  error estimate for blocks of size 2^( 3) =       0.000400572035
  error estimate for blocks of size 2^( 4) =       0.000409530320
  error estimate for blocks of size 2^( 5) =       0.000415156882
  error estimate for blocks of size 2^( 6) =       0.000417444808
  error estimate for blocks of size 2^( 7) =       0.000418862425

      target function =      -0.914462340955
              le_mean =     -17.211098652771
             les_mean =     296.511060020759
             stat err =       0.000415248609
             autocorr =       1.236838370358
   target nu stat err =       0.000415248609
   target dn stat err =       0.001951042023
      target stat err =       0.002593900701
              std dev =       0.528039862358
             le_variance =       0.278826096239


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.891735934427        initial
     9.3132e-06     9.3132e-05             2.9165e-03        -0.914543498403  <--
     3.7253e-05     3.7253e-04             2.9153e-03        -0.139348784045
     1.4901e-04     1.4901e-03             2.9107e-03        -0.914462340955

*****************************************************************************
Applying the update for shift_i =   9.3132e-06     and shift_s =   9.3132e-05
*****************************************************************************

  Execution time = 2.2846e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
ci_001                -3.983060e-02 3 1  ON 0
ci_002                -3.332151e-02 3 1  ON 1
ci_003                -2.571949e-02 3 1  ON 2
ci_004                 2.345494e-02 3 1  ON 3
ci_005                 2.485932e-02 3 1  ON 4
ci_006                -2.162184e-02 3 1  ON 5
ci_007                -2.158199e-02 3 1  ON 6
ci_008                -8.898893e-03 3 1  ON 7
ci_009                -1.343381e-02 3 1  ON 8
ci_010                -7.368352e-03 3 1  ON 9
ci_011                -1.177154e-02 3 1  ON 10
ci_012                -9.872430e-03 3 1  ON 11
ci_013                -1.876529e-02 3 1  ON 12
ci_014                 1.248109e-02 3 1  ON 13
ci_015                 1.256499e-02 3 1  ON 14
ci_016                 1.546140e-02 3 1  ON 15
ci_017                 1.739301e-02 3 1  ON 16
ci_018                 1.166193e-02 3 1  ON 17
ci_019                 1.043899e-02 3 1  ON 18
ci_020                 1.712728e-02 3 1  ON 19
ci_021                 1.798180e-02 3 1  ON 20
ci_022                 9.616455e-03 3 1  ON 21
ci_023                 9.810092e-03 3 1  ON 22
ci_024                 8.961035e-03 3 1  ON 23
ci_025                 1.130274e-02 3 1  ON 24
ci_026                 1.143789e-02 3 1  ON 25
ci_027                 1.266062e-02 3 1  ON 26
ci_028                -1.588187e-02 3 1  ON 27
ci_029                -1.591542e-02 3 1  ON 28
ci_030                -7.928989e-03 3 1  ON 29
ci_031                -9.457184e-03 3 1  ON 30
ci_032                -1.568848e-02 3 1  ON 31
ci_033                 5.526675e-03 3 1  ON 32
ci_034                 6.361041e-03 3 1  ON 33
ci_035                -5.623618e-03 3 1  ON 34
ci_036                -1.321524e-02 3 1  ON 35
ci_037                -1.245049e-02 3 1  ON 36
ci_038                 1.953314e-03 3 1  ON 37
ci_039                 2.508875e-03 3 1  ON 38
ci_040                -2.829859e-03 3 1  ON 39
ci_041                 8.202286e-03 3 1  ON 40
ci_042                 9.132679e-03 3 1  ON 41
ci_043                -4.446215e-03 3 1  ON 42
ci_044                -2.384622e-03 3 1  ON 43
ci_045                -3.324691e-03 3 1  ON 44
ci_046                 6.414965e-03 3 1  ON 45
ci_047                 5.573399e-03 3 1  ON 46
ci_048                -1.409471e-02 3 1  ON 47
ci_049                -1.371283e-02 3 1  ON 48
ci_050                 4.288244e-03 3 1  ON 49
ci_051                 3.660471e-03 3 1  ON 50
ci_052                -2.112100e-03 3 1  ON 51
ci_053                -1.906590e-03 3 1  ON 52
ci_054                -2.955746e-03 3 1  ON 53
ci_055                -3.408136e-03 3 1  ON 54
ci_056                 5.006831e-03 3 1  ON 55
ci_057                 5.936985e-03 3 1  ON 56
ci_058                -4.644484e-04 3 1  ON 57
ci_059                -1.451188e-03 3 1  ON 58
ci_060                 5.832067e-03 3 1  ON 59
ci_061                 4.731990e-03 3 1  ON 60
ci_062                -3.686583e-03 3 1  ON 61
ci_063                -4.166056e-03 3 1  ON 62
ci_064                -2.440959e-03 3 1  ON 63
ci_065                -3.728542e-03 3 1  ON 64
ci_066                 4.748837e-03 3 1  ON 65
ci_067                 4.390754e-03 3 1  ON 66
ci_068                -4.739439e-03 3 1  ON 67
ci_069                -4.869525e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9243e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.1965
    reference variance = 0.175679
====================================================
  Execution time = 1.5938e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9184e-01
  Total weights = 1.957025153e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4863e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279089517863
                                         uncertainty =       0.001734336679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279089517863
                                         uncertainty =       0.001734336679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373536900
  error estimate for blocks of size 2^( 2) =       0.000387144405
  error estimate for blocks of size 2^( 3) =       0.000399926863
  error estimate for blocks of size 2^( 4) =       0.000409582948
  error estimate for blocks of size 2^( 5) =       0.000415298379
  error estimate for blocks of size 2^( 6) =       0.000417996424
  error estimate for blocks of size 2^( 7) =       0.000420828786

      target function =      -0.911181071561
              le_mean =     -17.211906521483
             les_mean =     296.541565131902
             stat err =       0.000415926634
             autocorr =       1.239842284186
   target nu stat err =       0.000415926634
   target dn stat err =       0.002501948197
      target stat err =       0.003273736698
              std dev =       0.528260949639
             le_variance =       0.279059630914


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721190652148e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-06, overlap shift 2.3283e-05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911192055740       residual = 2.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912284018887       residual = 3.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912493342677       residual = 9.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912533276465       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912550207206       residual = 6.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912553133775       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912554119737       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912553971904       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912553986362       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912554236379       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912554330037       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912554315667       residual = 5.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-06 is 3.010547e-03

solving harmonic davidson linear method for identity shift 9.3132e-06, overlap shift 9.3132e-05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911192055740       residual = 2.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912283922506       residual = 3.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912493223306       residual = 9.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912533151506       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912550079524       residual = 6.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912553005431       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912553991148       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912553843343       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912553857781       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912554107744       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912554201376       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912554187024       residual = 5.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-06 is 3.010222e-03

solving harmonic davidson linear method for identity shift 3.7253e-05, overlap shift 3.7253e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911192055740       residual = 2.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912283537153       residual = 3.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.912492746040       residual = 9.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.912532651904       residual = 2.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.912549569038       residual = 6.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.912552492298       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.912553477036       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.912553329343       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.912553343701       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.912553593451       residual = 7.45e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.912553686974       residual = 1.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.912553672700       residual = 5.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-05 is 3.008925e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.655914 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8434e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
ci_001                -4.100295e-02 3 1  ON 0
ci_002                -3.259485e-02 3 1  ON 1
ci_003                -2.712341e-02 3 1  ON 2
ci_004                 2.399955e-02 3 1  ON 3
ci_005                 2.482533e-02 3 1  ON 4
ci_006                -2.303410e-02 3 1  ON 5
ci_007                -2.122275e-02 3 1  ON 6
ci_008                -8.647358e-03 3 1  ON 7
ci_009                -1.595130e-02 3 1  ON 8
ci_010                -9.590129e-03 3 1  ON 9
ci_011                -9.796461e-03 3 1  ON 10
ci_012                -9.905820e-03 3 1  ON 11
ci_013                -2.048943e-02 3 1  ON 12
ci_014                 1.303333e-02 3 1  ON 13
ci_015                 1.312371e-02 3 1  ON 14
ci_016                 1.733686e-02 3 1  ON 15
ci_017                 1.666622e-02 3 1  ON 16
ci_018                 1.072408e-02 3 1  ON 17
ci_019                 1.100597e-02 3 1  ON 18
ci_020                 1.800806e-02 3 1  ON 19
ci_021                 1.838148e-02 3 1  ON 20
ci_022                 9.849610e-03 3 1  ON 21
ci_023                 1.016651e-02 3 1  ON 22
ci_024                 8.884260e-03 3 1  ON 23
ci_025                 8.292517e-03 3 1  ON 24
ci_026                 1.185761e-02 3 1  ON 25
ci_027                 1.195150e-02 3 1  ON 26
ci_028                -1.626771e-02 3 1  ON 27
ci_029                -1.625112e-02 3 1  ON 28
ci_030                -9.760759e-03 3 1  ON 29
ci_031                -1.038886e-02 3 1  ON 30
ci_032                -1.428846e-02 3 1  ON 31
ci_033                 5.003457e-03 3 1  ON 32
ci_034                 5.479222e-03 3 1  ON 33
ci_035                -5.048127e-03 3 1  ON 34
ci_036                -1.375076e-02 3 1  ON 35
ci_037                -1.294402e-02 3 1  ON 36
ci_038                 1.747338e-03 3 1  ON 37
ci_039                 2.374047e-03 3 1  ON 38
ci_040                -2.709424e-03 3 1  ON 39
ci_041                 8.245600e-03 3 1  ON 40
ci_042                 8.989528e-03 3 1  ON 41
ci_043                -4.482825e-03 3 1  ON 42
ci_044                -4.963752e-03 3 1  ON 43
ci_045                -2.876810e-03 3 1  ON 44
ci_046                 5.257433e-03 3 1  ON 45
ci_047                 5.922381e-03 3 1  ON 46
ci_048                -1.142536e-02 3 1  ON 47
ci_049                -1.276017e-02 3 1  ON 48
ci_050                 2.514292e-03 3 1  ON 49
ci_051                 3.593005e-03 3 1  ON 50
ci_052                -2.321351e-03 3 1  ON 51
ci_053                -3.196488e-03 3 1  ON 52
ci_054                -2.706663e-03 3 1  ON 53
ci_055                -3.160567e-03 3 1  ON 54
ci_056                 5.014605e-03 3 1  ON 55
ci_057                 5.341132e-03 3 1  ON 56
ci_058                -2.363492e-03 3 1  ON 57
ci_059                -1.044454e-03 3 1  ON 58
ci_060                 6.150903e-03 3 1  ON 59
ci_061                 5.483034e-03 3 1  ON 60
ci_062                -4.157574e-03 3 1  ON 61
ci_063                -4.577360e-03 3 1  ON 62
ci_064                -2.280501e-03 3 1  ON 63
ci_065                -3.976446e-03 3 1  ON 64
ci_066                 4.343241e-03 3 1  ON 65
ci_067                 4.752596e-03 3 1  ON 66
ci_068                -5.225015e-03 3 1  ON 67
ci_069                -4.628867e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.2852
    reference variance = 0.759886
====================================================
  Execution time = 1.3539e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8543e-01
  Total weights = 1.9572e+06
  Execution time = 1.8613e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0325477
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276736774947
                                         uncertainty =       0.001353246130

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276736774947
                                         uncertainty =       0.001353246130

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371986338
  error estimate for blocks of size 2^( 2) =       0.000386014752
  error estimate for blocks of size 2^( 3) =       0.000398572802
  error estimate for blocks of size 2^( 4) =       0.000406570299
  error estimate for blocks of size 2^( 5) =       0.000412102290
  error estimate for blocks of size 2^( 6) =       0.000414749907
  error estimate for blocks of size 2^( 7) =       0.000414597008

      target function =      -0.871010469241
              le_mean =     -17.211840920483
             les_mean =     296.571344878699
             stat err =       0.000412004876
             autocorr =       1.226734931644
   target nu stat err =       0.000412004876
   target dn stat err =       0.021233128914
      target stat err =       0.024998930558
              std dev =       0.526068124227
             le_variance =       0.276747671327

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275386821019
                                         uncertainty =       0.001312990614

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275386821019
                                         uncertainty =       0.001312990614

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371064465
  error estimate for blocks of size 2^( 2) =       0.000385017562
  error estimate for blocks of size 2^( 3) =       0.000397511804
  error estimate for blocks of size 2^( 4) =       0.000405466972
  error estimate for blocks of size 2^( 5) =       0.000410961559
  error estimate for blocks of size 2^( 6) =       0.000413549509
  error estimate for blocks of size 2^( 7) =       0.000413381399

      target function =      -0.919465515422
              le_mean =     -17.211752142731
             les_mean =     296.529845820067
             stat err =       0.000410839860
             autocorr =       1.225875631257
   target nu stat err =       0.000410839860
   target dn stat err =       0.001805100145
      target stat err =       0.002436828855
              std dev =       0.524764399013
             le_variance =       0.275377674472

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.033467
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285271727163
                                         uncertainty =       0.004337177404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285271727163
                                         uncertainty =       0.004337177404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377648641
  error estimate for blocks of size 2^( 2) =       0.000391298266
  error estimate for blocks of size 2^( 3) =       0.000403473015
  error estimate for blocks of size 2^( 4) =       0.000411353296
  error estimate for blocks of size 2^( 5) =       0.000417126706
  error estimate for blocks of size 2^( 6) =       0.000419451298
  error estimate for blocks of size 2^( 7) =       0.000419298376

      target function =      -0.441433108356
              le_mean =     -17.212001112894
             les_mean =     297.130755538063
             stat err =       0.000416807419
             autocorr =       1.218133896446
   target nu stat err =       0.000416807419
   target dn stat err =       0.465354625641
      target stat err =       0.158790405918
              std dev =       0.534075830129
             le_variance =       0.285236992328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275386380017
                                         uncertainty =       0.001312956496

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275386380017
                                         uncertainty =       0.001312956496

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371064174
  error estimate for blocks of size 2^( 2) =       0.000385017323
  error estimate for blocks of size 2^( 3) =       0.000397511611
  error estimate for blocks of size 2^( 4) =       0.000405466819
  error estimate for blocks of size 2^( 5) =       0.000410961426
  error estimate for blocks of size 2^( 6) =       0.000413549381
  error estimate for blocks of size 2^( 7) =       0.000413381249

      target function =      -0.919464964938
              le_mean =     -17.211752126652
             les_mean =     296.529845682754
             stat err =       0.000410839719
             autocorr =       1.225876716402
   target nu stat err =       0.000410839719
   target dn stat err =       0.001805222523
      target stat err =       0.002436981582
              std dev =       0.524763986849
             le_variance =       0.275377241894


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.871010469241        initial
     2.3283e-06     2.3283e-05             3.0105e-03        -0.919465515422  <--
     9.3132e-06     9.3132e-05             3.0102e-03        -0.441433108356
     3.7253e-05     3.7253e-04             3.0089e-03        -0.919464964938

*****************************************************************************
Applying the update for shift_i =   2.3283e-06     and shift_s =   2.3283e-05
*****************************************************************************

  Execution time = 2.2933e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
ci_001                -4.100309e-02 3 1  ON 0
ci_002                -3.259477e-02 3 1  ON 1
ci_003                -2.712357e-02 3 1  ON 2
ci_004                 2.399963e-02 3 1  ON 3
ci_005                 2.482531e-02 3 1  ON 4
ci_006                -2.303426e-02 3 1  ON 5
ci_007                -2.122270e-02 3 1  ON 6
ci_008                -8.647343e-03 3 1  ON 7
ci_009                -1.595154e-02 3 1  ON 8
ci_010                -9.590346e-03 3 1  ON 9
ci_011                -9.796272e-03 3 1  ON 10
ci_012                -9.905823e-03 3 1  ON 11
ci_013                -2.048964e-02 3 1  ON 12
ci_014                 1.303340e-02 3 1  ON 13
ci_015                 1.312376e-02 3 1  ON 14
ci_016                 1.733707e-02 3 1  ON 15
ci_017                 1.666613e-02 3 1  ON 16
ci_018                 1.072399e-02 3 1  ON 17
ci_019                 1.100603e-02 3 1  ON 18
ci_020                 1.800816e-02 3 1  ON 19
ci_021                 1.838152e-02 3 1  ON 20
ci_022                 9.849627e-03 3 1  ON 21
ci_023                 1.016655e-02 3 1  ON 22
ci_024                 8.884255e-03 3 1  ON 23
ci_025                 8.292192e-03 3 1  ON 24
ci_026                 1.185766e-02 3 1  ON 25
ci_027                 1.195143e-02 3 1  ON 26
ci_028                -1.626775e-02 3 1  ON 27
ci_029                -1.625115e-02 3 1  ON 28
ci_030                -9.760899e-03 3 1  ON 29
ci_031                -1.038893e-02 3 1  ON 30
ci_032                -1.428831e-02 3 1  ON 31
ci_033                 5.003404e-03 3 1  ON 32
ci_034                 5.479126e-03 3 1  ON 33
ci_035                -5.048072e-03 3 1  ON 34
ci_036                -1.375082e-02 3 1  ON 35
ci_037                -1.294408e-02 3 1  ON 36
ci_038                 1.747320e-03 3 1  ON 37
ci_039                 2.374035e-03 3 1  ON 38
ci_040                -2.709414e-03 3 1  ON 39
ci_041                 8.245609e-03 3 1  ON 40
ci_042                 8.989515e-03 3 1  ON 41
ci_043                -4.482829e-03 3 1  ON 42
ci_044                -4.964004e-03 3 1  ON 43
ci_045                -2.876769e-03 3 1  ON 44
ci_046                 5.257315e-03 3 1  ON 45
ci_047                 5.922415e-03 3 1  ON 46
ci_048                -1.142507e-02 3 1  ON 47
ci_049                -1.276006e-02 3 1  ON 48
ci_050                 2.514140e-03 3 1  ON 49
ci_051                 3.592999e-03 3 1  ON 50
ci_052                -2.321367e-03 3 1  ON 51
ci_053                -3.196604e-03 3 1  ON 52
ci_054                -2.706646e-03 3 1  ON 53
ci_055                -3.160557e-03 3 1  ON 54
ci_056                 5.014606e-03 3 1  ON 55
ci_057                 5.341076e-03 3 1  ON 56
ci_058                -2.363661e-03 3 1  ON 57
ci_059                -1.044413e-03 3 1  ON 58
ci_060                 6.150938e-03 3 1  ON 59
ci_061                 5.483112e-03 3 1  ON 60
ci_062                -4.157619e-03 3 1  ON 61
ci_063                -4.577383e-03 3 1  ON 62
ci_064                -2.280487e-03 3 1  ON 63
ci_065                -3.976468e-03 3 1  ON 64
ci_066                 4.343205e-03 3 1  ON 65
ci_067                 4.752634e-03 3 1  ON 66
ci_068                -5.225060e-03 3 1  ON 67
ci_069                -4.628843e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1377e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.2482
    reference variance = 0.268108
====================================================
  Execution time = 1.3900e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8815e-01
  Total weights = 1.957039398e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5049e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277227127872
                                         uncertainty =       0.001529735142

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277227127872
                                         uncertainty =       0.001529735142

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372335606
  error estimate for blocks of size 2^( 2) =       0.000385754759
  error estimate for blocks of size 2^( 3) =       0.000398236424
  error estimate for blocks of size 2^( 4) =       0.000407308255
  error estimate for blocks of size 2^( 5) =       0.000412843193
  error estimate for blocks of size 2^( 6) =       0.000416439690
  error estimate for blocks of size 2^( 7) =       0.000416882570

      target function =      -0.915928792703
              le_mean =     -17.211774931236
             les_mean =     296.533343134409
             stat err =       0.000413368427
             autocorr =       1.232552613602
   target nu stat err =       0.000413368427
   target dn stat err =       0.001996222786
      target stat err =       0.002661413442
              std dev =       0.526562063320
             le_variance =       0.277267606528


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721177493124e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-07, overlap shift 5.8208e-06 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915935754440       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916442209980       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916542112962       residual = 6.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916582438240       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916596651175       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916598243933       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916596913701       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916596732099       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916596848625       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916596915092       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916596836510       residual = 7.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-07 is 1.965049e-03

solving harmonic davidson linear method for identity shift 2.3283e-06, overlap shift 2.3283e-05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915935754440       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916442198619       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916542098828       residual = 6.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916582422718       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916596635075       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916598227759       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916596897572       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916596715975       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916596832494       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916596898959       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916596820382       residual = 7.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-06 is 1.964996e-03

solving harmonic davidson linear method for identity shift 9.3132e-06, overlap shift 9.3132e-05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915935754440       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916442153180       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916542042299       residual = 6.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.916582360634       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.916596570680       residual = 4.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.916598163071       residual = 8.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.916596833062       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.916596651487       residual = 5.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.916596767980       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.916596834438       residual = 5.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.916596755877       residual = 7.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-06 is 1.964783e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.664914 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6422e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
ci_001                -4.282261e-02 3 1  ON 0
ci_002                -3.233680e-02 3 1  ON 1
ci_003                -2.587824e-02 3 1  ON 2
ci_004                 2.437673e-02 3 1  ON 3
ci_005                 2.436910e-02 3 1  ON 4
ci_006                -2.174146e-02 3 1  ON 5
ci_007                -2.248723e-02 3 1  ON 6
ci_008                -8.889326e-03 3 1  ON 7
ci_009                -1.525653e-02 3 1  ON 8
ci_010                -9.494520e-03 3 1  ON 9
ci_011                -1.037701e-02 3 1  ON 10
ci_012                -1.015214e-02 3 1  ON 11
ci_013                -2.055485e-02 3 1  ON 12
ci_014                 1.192710e-02 3 1  ON 13
ci_015                 1.373519e-02 3 1  ON 14
ci_016                 1.619856e-02 3 1  ON 15
ci_017                 1.662328e-02 3 1  ON 16
ci_018                 1.042608e-02 3 1  ON 17
ci_019                 1.094066e-02 3 1  ON 18
ci_020                 1.736754e-02 3 1  ON 19
ci_021                 1.709889e-02 3 1  ON 20
ci_022                 9.970418e-03 3 1  ON 21
ci_023                 1.024689e-02 3 1  ON 22
ci_024                 1.003865e-02 3 1  ON 23
ci_025                 1.025719e-02 3 1  ON 24
ci_026                 1.090486e-02 3 1  ON 25
ci_027                 1.301005e-02 3 1  ON 26
ci_028                -1.601029e-02 3 1  ON 27
ci_029                -1.578472e-02 3 1  ON 28
ci_030                -9.228185e-03 3 1  ON 29
ci_031                -9.075723e-03 3 1  ON 30
ci_032                -1.461516e-02 3 1  ON 31
ci_033                 6.790123e-03 3 1  ON 32
ci_034                 5.677672e-03 3 1  ON 33
ci_035                -5.710008e-03 3 1  ON 34
ci_036                -1.283220e-02 3 1  ON 35
ci_037                -1.304762e-02 3 1  ON 36
ci_038                 1.783333e-03 3 1  ON 37
ci_039                 2.260473e-03 3 1  ON 38
ci_040                -3.318978e-03 3 1  ON 39
ci_041                 8.760284e-03 3 1  ON 40
ci_042                 8.816592e-03 3 1  ON 41
ci_043                -4.386280e-03 3 1  ON 42
ci_044                -4.400402e-03 3 1  ON 43
ci_045                -2.987557e-03 3 1  ON 44
ci_046                 5.548386e-03 3 1  ON 45
ci_047                 5.017904e-03 3 1  ON 46
ci_048                -1.317637e-02 3 1  ON 47
ci_049                -1.300670e-02 3 1  ON 48
ci_050                 3.170162e-03 3 1  ON 49
ci_051                 3.221014e-03 3 1  ON 50
ci_052                -3.344899e-03 3 1  ON 51
ci_053                -2.243696e-03 3 1  ON 52
ci_054                -2.826260e-03 3 1  ON 53
ci_055                -2.903283e-03 3 1  ON 54
ci_056                 5.847778e-03 3 1  ON 55
ci_057                 5.501518e-03 3 1  ON 56
ci_058                -2.721626e-03 3 1  ON 57
ci_059                -1.714290e-03 3 1  ON 58
ci_060                 4.840554e-03 3 1  ON 59
ci_061                 5.466512e-03 3 1  ON 60
ci_062                -3.501457e-03 3 1  ON 61
ci_063                -3.641062e-03 3 1  ON 62
ci_064                -2.845635e-03 3 1  ON 63
ci_065                -4.096373e-03 3 1  ON 64
ci_066                 4.871404e-03 3 1  ON 65
ci_067                 4.780615e-03 3 1  ON 66
ci_068                -4.521180e-03 3 1  ON 67
ci_069                -5.507164e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.0977
    reference variance = 0.282592
====================================================
  Execution time = 1.3539e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8630e-01
  Total weights = 1.9572e+06
  Execution time = 1.8485e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357240728542
                                         uncertainty =       0.079705756506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.357240728542
                                         uncertainty =       0.079705756506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000422493282
  error estimate for blocks of size 2^( 2) =       0.000434939628
  error estimate for blocks of size 2^( 3) =       0.000446249990
  error estimate for blocks of size 2^( 4) =       0.000453853259
  error estimate for blocks of size 2^( 5) =       0.000458363273
  error estimate for blocks of size 2^( 6) =       0.000462075470
  error estimate for blocks of size 2^( 7) =       0.000463543159

      target function =      -0.199816649898
              le_mean =     -17.212970049946
             les_mean =     298.152952075094
             stat err =       0.000459458790
             autocorr =       1.182642586886
   target nu stat err =       0.000459458790
   target dn stat err =       1.465738880312
      target stat err =       0.128384413500
              std dev =       0.597495729714
             le_variance =       0.357001147027

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276344321890
                                         uncertainty =       0.001374617823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276344321890
                                         uncertainty =       0.001374617823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371709350
  error estimate for blocks of size 2^( 2) =       0.000385595081
  error estimate for blocks of size 2^( 3) =       0.000398152737
  error estimate for blocks of size 2^( 4) =       0.000406644854
  error estimate for blocks of size 2^( 5) =       0.000411901307
  error estimate for blocks of size 2^( 6) =       0.000415807694
  error estimate for blocks of size 2^( 7) =       0.000416741901

      target function =      -0.918572397121
              le_mean =     -17.212688082698
             les_mean =     296.562934815370
             stat err =       0.000412773939
             autocorr =       1.233154714931
   target nu stat err =       0.000412773939
   target dn stat err =       0.001857684518
      target stat err =       0.002503322312
              std dev =       0.525676404414
             le_variance =       0.276335682158

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277990025501
                                         uncertainty =       0.001459610903

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277990025501
                                         uncertainty =       0.001459610903

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372814128
  error estimate for blocks of size 2^( 2) =       0.000386626154
  error estimate for blocks of size 2^( 3) =       0.000399097157
  error estimate for blocks of size 2^( 4) =       0.000407548828
  error estimate for blocks of size 2^( 5) =       0.000412851698
  error estimate for blocks of size 2^( 6) =       0.000416750797
  error estimate for blocks of size 2^( 7) =       0.000417690173

      target function =      -0.877998306263
              le_mean =     -17.212786991594
             les_mean =     296.598350955397
             stat err =       0.000413710374
             autocorr =       1.231425379381
   target nu stat err =       0.000413710374
   target dn stat err =       0.017521211054
      target stat err =       0.020988897369
              std dev =       0.527238795398
             le_variance =       0.277980747373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276344244202
                                         uncertainty =       0.001374612848

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276344244202
                                         uncertainty =       0.001374612848

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371709298
  error estimate for blocks of size 2^( 2) =       0.000385595037
  error estimate for blocks of size 2^( 3) =       0.000398152703
  error estimate for blocks of size 2^( 4) =       0.000406644824
  error estimate for blocks of size 2^( 5) =       0.000411901272
  error estimate for blocks of size 2^( 6) =       0.000415807665
  error estimate for blocks of size 2^( 7) =       0.000416741875

      target function =      -0.918572603431
              le_mean =     -17.212688080852
             les_mean =     296.562934593928
             stat err =       0.000412773909
             autocorr =       1.233154880720
   target nu stat err =       0.000412773909
   target dn stat err =       0.001857681485
      target stat err =       0.002503319526
              std dev =       0.525676330539
             le_variance =       0.276335604489


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.199816649898        initial
     5.8208e-07     5.8208e-06             1.9650e-03        -0.918572397121
     2.3283e-06     2.3283e-05             1.9650e-03        -0.877998306263
     9.3132e-06     9.3132e-05             1.9648e-03        -0.918572603431  <--

*****************************************************************************
Applying the update for shift_i =   9.3132e-06     and shift_s =   9.3132e-05
*****************************************************************************

  Execution time = 2.2869e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
ci_001                -4.282238e-02 3 1  ON 0
ci_002                -3.233682e-02 3 1  ON 1
ci_003                -2.587838e-02 3 1  ON 2
ci_004                 2.437671e-02 3 1  ON 3
ci_005                 2.436914e-02 3 1  ON 4
ci_006                -2.174161e-02 3 1  ON 5
ci_007                -2.248708e-02 3 1  ON 6
ci_008                -8.889310e-03 3 1  ON 7
ci_009                -1.525660e-02 3 1  ON 8
ci_010                -9.494532e-03 3 1  ON 9
ci_011                -1.037695e-02 3 1  ON 10
ci_012                -1.015211e-02 3 1  ON 11
ci_013                -2.055484e-02 3 1  ON 12
ci_014                 1.192723e-02 3 1  ON 13
ci_015                 1.373513e-02 3 1  ON 14
ci_016                 1.619869e-02 3 1  ON 15
ci_017                 1.662329e-02 3 1  ON 16
ci_018                 1.042612e-02 3 1  ON 17
ci_019                 1.094068e-02 3 1  ON 18
ci_020                 1.736761e-02 3 1  ON 19
ci_021                 1.709903e-02 3 1  ON 20
ci_022                 9.970398e-03 3 1  ON 21
ci_023                 1.024689e-02 3 1  ON 22
ci_024                 1.003852e-02 3 1  ON 23
ci_025                 1.025698e-02 3 1  ON 24
ci_026                 1.090494e-02 3 1  ON 25
ci_027                 1.300996e-02 3 1  ON 26
ci_028                -1.601031e-02 3 1  ON 27
ci_029                -1.578477e-02 3 1  ON 28
ci_030                -9.228220e-03 3 1  ON 29
ci_031                -9.075841e-03 3 1  ON 30
ci_032                -1.461512e-02 3 1  ON 31
ci_033                 6.789933e-03 3 1  ON 32
ci_034                 5.677646e-03 3 1  ON 33
ci_035                -5.709947e-03 3 1  ON 34
ci_036                -1.283230e-02 3 1  ON 35
ci_037                -1.304762e-02 3 1  ON 36
ci_038                 1.783330e-03 3 1  ON 37
ci_039                 2.260484e-03 3 1  ON 38
ci_040                -3.318924e-03 3 1  ON 39
ci_041                 8.760236e-03 3 1  ON 40
ci_042                 8.816611e-03 3 1  ON 41
ci_043                -4.386289e-03 3 1  ON 42
ci_044                -4.400457e-03 3 1  ON 43
ci_045                -2.987546e-03 3 1  ON 44
ci_046                 5.548355e-03 3 1  ON 45
ci_047                 5.017996e-03 3 1  ON 46
ci_048                -1.317618e-02 3 1  ON 47
ci_049                -1.300668e-02 3 1  ON 48
ci_050                 3.170105e-03 3 1  ON 49
ci_051                 3.221045e-03 3 1  ON 50
ci_052                -3.344806e-03 3 1  ON 51
ci_053                -2.243783e-03 3 1  ON 52
ci_054                -2.826255e-03 3 1  ON 53
ci_055                -2.903316e-03 3 1  ON 54
ci_056                 5.847699e-03 3 1  ON 55
ci_057                 5.501502e-03 3 1  ON 56
ci_058                -2.721597e-03 3 1  ON 57
ci_059                -1.714221e-03 3 1  ON 58
ci_060                 4.840688e-03 3 1  ON 59
ci_061                 5.466514e-03 3 1  ON 60
ci_062                -3.501514e-03 3 1  ON 61
ci_063                -3.641142e-03 3 1  ON 62
ci_064                -2.845586e-03 3 1  ON 63
ci_065                -4.096362e-03 3 1  ON 64
ci_066                 4.871359e-03 3 1  ON 65
ci_067                 4.780613e-03 3 1  ON 66
ci_068                -4.521249e-03 3 1  ON 67
ci_069                -5.507075e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9306e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.2109
    reference variance = 0.178568
====================================================
  Execution time = 1.3902e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8803e-01
  Total weights = 1.957134978e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5033e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276145183352
                                         uncertainty =       0.001672409384

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276145183352
                                         uncertainty =       0.001672409384

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371554057
  error estimate for blocks of size 2^( 2) =       0.000385417544
  error estimate for blocks of size 2^( 3) =       0.000397430318
  error estimate for blocks of size 2^( 4) =       0.000405871065
  error estimate for blocks of size 2^( 5) =       0.000411237850
  error estimate for blocks of size 2^( 6) =       0.000413539082
  error estimate for blocks of size 2^( 7) =       0.000415108495

      target function =      -0.916159157683
              le_mean =     -17.212096174275
             les_mean =     296.544284903631
             stat err =       0.000411439123
             autocorr =       1.226216497872
   target nu stat err =       0.000411439123
   target dn stat err =       0.002516882990
      target stat err =       0.003328006080
              std dev =       0.525456787121
             le_variance =       0.276104835131


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721209617428e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-06, overlap shift 2.3283e-05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916170418583       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916862575428       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916964000391       residual = 5.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917011137551       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917012559311       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917015648784       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917016839933       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917016182689       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917016116485       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917016139465       residual = 7.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917016164838       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917016165399       residual = 7.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-06 is 1.822701e-03

solving harmonic davidson linear method for identity shift 9.3132e-06, overlap shift 9.3132e-05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916170418583       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916862514841       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916963929294       residual = 5.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917011059922       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917012481079       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917015569981       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917016760842       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917016103712       residual = 8.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917016037508       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917016060496       residual = 7.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917016085860       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917016086421       residual = 7.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-06 is 1.822490e-03

solving harmonic davidson linear method for identity shift 3.7253e-05, overlap shift 3.7253e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.916170418583       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916862272599       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.916963645031       residual = 5.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917010749552       residual = 1.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917012168299       residual = 5.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917015254918       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917016444630       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917015787954       residual = 8.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917015721751       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917015744771       residual = 7.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917015770095       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.917015770659       residual = 7.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-05 is 1.821645e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.674910 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6423e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
ci_001                -4.358614e-02 3 1  ON 0
ci_002                -3.343782e-02 3 1  ON 1
ci_003                -2.653872e-02 3 1  ON 2
ci_004                 2.306263e-02 3 1  ON 3
ci_005                 2.403168e-02 3 1  ON 4
ci_006                -2.138404e-02 3 1  ON 5
ci_007                -2.099816e-02 3 1  ON 6
ci_008                -8.248111e-03 3 1  ON 7
ci_009                -1.461860e-02 3 1  ON 8
ci_010                -9.199174e-03 3 1  ON 9
ci_011                -1.093332e-02 3 1  ON 10
ci_012                -9.977527e-03 3 1  ON 11
ci_013                -1.935383e-02 3 1  ON 12
ci_014                 1.311222e-02 3 1  ON 13
ci_015                 1.207051e-02 3 1  ON 14
ci_016                 1.725264e-02 3 1  ON 15
ci_017                 1.753749e-02 3 1  ON 16
ci_018                 1.164981e-02 3 1  ON 17
ci_019                 1.137538e-02 3 1  ON 18
ci_020                 1.911148e-02 3 1  ON 19
ci_021                 1.748399e-02 3 1  ON 20
ci_022                 1.040895e-02 3 1  ON 21
ci_023                 1.044914e-02 3 1  ON 22
ci_024                 1.089345e-02 3 1  ON 23
ci_025                 9.211687e-03 3 1  ON 24
ci_026                 1.219349e-02 3 1  ON 25
ci_027                 1.209142e-02 3 1  ON 26
ci_028                -1.554131e-02 3 1  ON 27
ci_029                -1.506536e-02 3 1  ON 28
ci_030                -9.513477e-03 3 1  ON 29
ci_031                -1.053411e-02 3 1  ON 30
ci_032                -1.446458e-02 3 1  ON 31
ci_033                 6.126663e-03 3 1  ON 32
ci_034                 6.135571e-03 3 1  ON 33
ci_035                -5.756471e-03 3 1  ON 34
ci_036                -1.228077e-02 3 1  ON 35
ci_037                -1.383953e-02 3 1  ON 36
ci_038                 2.150124e-03 3 1  ON 37
ci_039                 2.546628e-03 3 1  ON 38
ci_040                -3.130080e-03 3 1  ON 39
ci_041                 9.175515e-03 3 1  ON 40
ci_042                 8.662582e-03 3 1  ON 41
ci_043                -4.814475e-03 3 1  ON 42
ci_044                -3.636521e-03 3 1  ON 43
ci_045                -2.486982e-03 3 1  ON 44
ci_046                 5.725112e-03 3 1  ON 45
ci_047                 5.638138e-03 3 1  ON 46
ci_048                -1.135369e-02 3 1  ON 47
ci_049                -1.335224e-02 3 1  ON 48
ci_050                 3.584745e-03 3 1  ON 49
ci_051                 2.801995e-03 3 1  ON 50
ci_052                -2.926628e-03 3 1  ON 51
ci_053                -2.219672e-03 3 1  ON 52
ci_054                -2.190756e-03 3 1  ON 53
ci_055                -3.080921e-03 3 1  ON 54
ci_056                 5.703116e-03 3 1  ON 55
ci_057                 6.608268e-03 3 1  ON 56
ci_058                -1.916120e-03 3 1  ON 57
ci_059                -3.461350e-03 3 1  ON 58
ci_060                 5.121312e-03 3 1  ON 59
ci_061                 4.212179e-03 3 1  ON 60
ci_062                -3.783980e-03 3 1  ON 61
ci_063                -3.735474e-03 3 1  ON 62
ci_064                -3.461495e-03 3 1  ON 63
ci_065                -4.154524e-03 3 1  ON 64
ci_066                 4.041863e-03 3 1  ON 65
ci_067                 5.339194e-03 3 1  ON 66
ci_068                -5.220034e-03 3 1  ON 67
ci_069                -5.713849e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.2248
    reference variance = 0.220691
====================================================
  Execution time = 1.3553e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8563e-01
  Total weights = 1.9571e+06
  Execution time = 1.8454e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276030522958
                                         uncertainty =       0.002059708683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276030522958
                                         uncertainty =       0.002059708683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371499921
  error estimate for blocks of size 2^( 2) =       0.000385351894
  error estimate for blocks of size 2^( 3) =       0.000398463376
  error estimate for blocks of size 2^( 4) =       0.000406697093
  error estimate for blocks of size 2^( 5) =       0.000411623557
  error estimate for blocks of size 2^( 6) =       0.000413875984
  error estimate for blocks of size 2^( 7) =       0.000415824534

      target function =      -0.732563316307
              le_mean =     -17.211674975567
             les_mean =     296.687088612304
             stat err =       0.000412005292
             autocorr =       1.229951927713
   target nu stat err =       0.000412005292
   target dn stat err =       0.128457534002
      target stat err =       0.109213087055
              std dev =       0.525380226588
             le_variance =       0.276024382489

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274204999066
                                         uncertainty =       0.001346755022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274204999066
                                         uncertainty =       0.001346755022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370274295
  error estimate for blocks of size 2^( 2) =       0.000384091237
  error estimate for blocks of size 2^( 3) =       0.000397192470
  error estimate for blocks of size 2^( 4) =       0.000405415217
  error estimate for blocks of size 2^( 5) =       0.000410393428
  error estimate for blocks of size 2^( 6) =       0.000412671986
  error estimate for blocks of size 2^( 7) =       0.000414581411

      target function =      -0.919158479674
              le_mean =     -17.211582741954
             les_mean =     296.524213102576
             stat err =       0.000410765510
             autocorr =       1.230667734816
   target nu stat err =       0.000410765510
   target dn stat err =       0.002076200194
      target stat err =       0.002780421151
              std dev =       0.523646929950
             le_variance =       0.274206107246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279546947787
                                         uncertainty =       0.003697879366

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279546947787
                                         uncertainty =       0.003697879366

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373858543
  error estimate for blocks of size 2^( 2) =       0.000387513398
  error estimate for blocks of size 2^( 3) =       0.000400528033
  error estimate for blocks of size 2^( 4) =       0.000408650969
  error estimate for blocks of size 2^( 5) =       0.000413688079
  error estimate for blocks of size 2^( 6) =       0.000416175896
  error estimate for blocks of size 2^( 7) =       0.000418163870

      target function =      -0.128299860398
              le_mean =     -17.211641636964
             les_mean =     298.975342505645
             stat err =       0.000414169704
             autocorr =       1.227275419196
   target nu stat err =       0.000414169704
   target dn stat err =       2.434006974958
      target stat err =       0.099102784203
              std dev =       0.528715822156
             le_variance =       0.279540420598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274204645156
                                         uncertainty =       0.001346747834

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274204645156
                                         uncertainty =       0.001346747834

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370274055
  error estimate for blocks of size 2^( 2) =       0.000384091026
  error estimate for blocks of size 2^( 3) =       0.000397192267
  error estimate for blocks of size 2^( 4) =       0.000405415038
  error estimate for blocks of size 2^( 5) =       0.000410393225
  error estimate for blocks of size 2^( 6) =       0.000412671812
  error estimate for blocks of size 2^( 7) =       0.000414581238

      target function =      -0.919156198423
              le_mean =     -17.211582739714
             les_mean =     296.524214764211
             stat err =       0.000410765328
             autocorr =       1.230668238843
   target nu stat err =       0.000410765328
   target dn stat err =       0.002076757045
      target stat err =       0.002781120313
              std dev =       0.523646590562
             le_variance =       0.274205751808


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.732563316307        initial
     2.3283e-06     2.3283e-05             1.8227e-03        -0.919158479674  <--
     9.3132e-06     9.3132e-05             1.8225e-03        -0.128299860398
     3.7253e-05     3.7253e-04             1.8216e-03        -0.919156198423

*****************************************************************************
Applying the update for shift_i =   2.3283e-06     and shift_s =   2.3283e-05
*****************************************************************************

  Execution time = 2.2879e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
ci_001                -4.358623e-02 3 1  ON 0
ci_002                -3.343794e-02 3 1  ON 1
ci_003                -2.653880e-02 3 1  ON 2
ci_004                 2.306249e-02 3 1  ON 3
ci_005                 2.403163e-02 3 1  ON 4
ci_006                -2.138398e-02 3 1  ON 5
ci_007                -2.099798e-02 3 1  ON 6
ci_008                -8.248060e-03 3 1  ON 7
ci_009                -1.461854e-02 3 1  ON 8
ci_010                -9.199142e-03 3 1  ON 9
ci_011                -1.093337e-02 3 1  ON 10
ci_012                -9.977512e-03 3 1  ON 11
ci_013                -1.935368e-02 3 1  ON 12
ci_014                 1.311233e-02 3 1  ON 13
ci_015                 1.207034e-02 3 1  ON 14
ci_016                 1.725276e-02 3 1  ON 15
ci_017                 1.753759e-02 3 1  ON 16
ci_018                 1.164993e-02 3 1  ON 17
ci_019                 1.137544e-02 3 1  ON 18
ci_020                 1.911168e-02 3 1  ON 19
ci_021                 1.748404e-02 3 1  ON 20
ci_022                 1.040899e-02 3 1  ON 21
ci_023                 1.044916e-02 3 1  ON 22
ci_024                 1.089354e-02 3 1  ON 23
ci_025                 9.211573e-03 3 1  ON 24
ci_026                 1.219359e-02 3 1  ON 25
ci_027                 1.209133e-02 3 1  ON 26
ci_028                -1.554125e-02 3 1  ON 27
ci_029                -1.506527e-02 3 1  ON 28
ci_030                -9.513485e-03 3 1  ON 29
ci_031                -1.053425e-02 3 1  ON 30
ci_032                -1.446456e-02 3 1  ON 31
ci_033                 6.126599e-03 3 1  ON 32
ci_034                 6.135616e-03 3 1  ON 33
ci_035                -5.756475e-03 3 1  ON 34
ci_036                -1.228073e-02 3 1  ON 35
ci_037                -1.383961e-02 3 1  ON 36
ci_038                 2.150159e-03 3 1  ON 37
ci_039                 2.546653e-03 3 1  ON 38
ci_040                -3.130064e-03 3 1  ON 39
ci_041                 9.175546e-03 3 1  ON 40
ci_042                 8.662556e-03 3 1  ON 41
ci_043                -4.814514e-03 3 1  ON 42
ci_044                -3.636449e-03 3 1  ON 43
ci_045                -2.486938e-03 3 1  ON 44
ci_046                 5.725130e-03 3 1  ON 45
ci_047                 5.638201e-03 3 1  ON 46
ci_048                -1.135347e-02 3 1  ON 47
ci_049                -1.335230e-02 3 1  ON 48
ci_050                 3.584778e-03 3 1  ON 49
ci_051                 2.801960e-03 3 1  ON 50
ci_052                -2.926590e-03 3 1  ON 51
ci_053                -2.219667e-03 3 1  ON 52
ci_054                -2.190700e-03 3 1  ON 53
ci_055                -3.080945e-03 3 1  ON 54
ci_056                 5.703104e-03 3 1  ON 55
ci_057                 6.608373e-03 3 1  ON 56
ci_058                -1.916058e-03 3 1  ON 57
ci_059                -3.461501e-03 3 1  ON 58
ci_060                 5.121341e-03 3 1  ON 59
ci_061                 4.212053e-03 3 1  ON 60
ci_062                -3.784014e-03 3 1  ON 61
ci_063                -3.735478e-03 3 1  ON 62
ci_064                -3.461549e-03 3 1  ON 63
ci_065                -4.154530e-03 3 1  ON 64
ci_066                 4.041787e-03 3 1  ON 65
ci_067                 5.339244e-03 3 1  ON 66
ci_068                -5.220104e-03 3 1  ON 67
ci_069                -5.713866e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9317e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.1649
    reference variance = 0.259374
====================================================
  Execution time = 1.3932e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5311e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8322e-01
  Total weights = 1.957205929e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5039e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273183476260
                                         uncertainty =       0.001306717852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273183476260
                                         uncertainty =       0.001306717852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369570684
  error estimate for blocks of size 2^( 2) =       0.000383311903
  error estimate for blocks of size 2^( 3) =       0.000395983069
  error estimate for blocks of size 2^( 4) =       0.000404948487
  error estimate for blocks of size 2^( 5) =       0.000409833367
  error estimate for blocks of size 2^( 6) =       0.000412468602
  error estimate for blocks of size 2^( 7) =       0.000412305502

      target function =      -0.922389258367
              le_mean =     -17.211816243378
             les_mean =     296.529841855011
             stat err =       0.000409888990
             autocorr =       1.230091667265
   target nu stat err =       0.000409888990
   target dn stat err =       0.001736906295
      target stat err =       0.002364584477
              std dev =       0.522651874078
             le_variance =       0.273164981477


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721181624338e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-07, overlap shift 5.8208e-06 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922394505277       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922995501861       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923104035969       residual = 6.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923159352388       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923170397918       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923172677531       residual = 8.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923173317563       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923173398858       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923173678298       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923173582976       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923173588876       residual = 9.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-07 is 2.603038e-03

solving harmonic davidson linear method for identity shift 2.3283e-06, overlap shift 2.3283e-05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922394505277       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922995488572       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923104019700       residual = 6.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923159334193       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923170379241       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923172658713       residual = 8.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923173298727       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923173380012       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923173659437       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923173564121       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923173570020       residual = 9.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-06 is 2.602959e-03

solving harmonic davidson linear method for identity shift 9.3132e-06, overlap shift 9.3132e-05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.922394505277       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.922995435421       residual = 2.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923103954633       residual = 6.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923159261420       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923170304543       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923172583451       residual = 8.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923173223392       residual = 2.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923173304637       residual = 4.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923173584006       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923173488708       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923173494605       residual = 9.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-06 is 2.602644e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.683887 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6454e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
ci_001                -4.098328e-02 3 1  ON 0
ci_002                -3.374183e-02 3 1  ON 1
ci_003                -2.649998e-02 3 1  ON 2
ci_004                 2.345075e-02 3 1  ON 3
ci_005                 2.362060e-02 3 1  ON 4
ci_006                -2.260291e-02 3 1  ON 5
ci_007                -2.284959e-02 3 1  ON 6
ci_008                -9.073380e-03 3 1  ON 7
ci_009                -1.557789e-02 3 1  ON 8
ci_010                -1.010963e-02 3 1  ON 9
ci_011                -1.135085e-02 3 1  ON 10
ci_012                -1.234549e-02 3 1  ON 11
ci_013                -1.929439e-02 3 1  ON 12
ci_014                 1.354373e-02 3 1  ON 13
ci_015                 1.263847e-02 3 1  ON 14
ci_016                 1.640840e-02 3 1  ON 15
ci_017                 1.707230e-02 3 1  ON 16
ci_018                 1.073513e-02 3 1  ON 17
ci_019                 1.087200e-02 3 1  ON 18
ci_020                 1.878269e-02 3 1  ON 19
ci_021                 1.855229e-02 3 1  ON 20
ci_022                 1.008526e-02 3 1  ON 21
ci_023                 1.034550e-02 3 1  ON 22
ci_024                 8.949261e-03 3 1  ON 23
ci_025                 1.001694e-02 3 1  ON 24
ci_026                 1.135140e-02 3 1  ON 25
ci_027                 1.209437e-02 3 1  ON 26
ci_028                -1.436996e-02 3 1  ON 27
ci_029                -1.508063e-02 3 1  ON 28
ci_030                -8.946080e-03 3 1  ON 29
ci_031                -1.045064e-02 3 1  ON 30
ci_032                -1.423947e-02 3 1  ON 31
ci_033                 4.546761e-03 3 1  ON 32
ci_034                 5.150336e-03 3 1  ON 33
ci_035                -5.300711e-03 3 1  ON 34
ci_036                -1.323843e-02 3 1  ON 35
ci_037                -1.296763e-02 3 1  ON 36
ci_038                 1.631495e-03 3 1  ON 37
ci_039                 1.871311e-03 3 1  ON 38
ci_040                -3.284488e-03 3 1  ON 39
ci_041                 8.476788e-03 3 1  ON 40
ci_042                 8.998270e-03 3 1  ON 41
ci_043                -4.764483e-03 3 1  ON 42
ci_044                -4.181905e-03 3 1  ON 43
ci_045                -3.023504e-03 3 1  ON 44
ci_046                 5.105090e-03 3 1  ON 45
ci_047                 5.055189e-03 3 1  ON 46
ci_048                -1.312643e-02 3 1  ON 47
ci_049                -1.318502e-02 3 1  ON 48
ci_050                 3.923846e-03 3 1  ON 49
ci_051                 3.804159e-03 3 1  ON 50
ci_052                -1.869670e-03 3 1  ON 51
ci_053                -2.944315e-03 3 1  ON 52
ci_054                -1.559408e-03 3 1  ON 53
ci_055                -3.025081e-03 3 1  ON 54
ci_056                 5.649099e-03 3 1  ON 55
ci_057                 5.929182e-03 3 1  ON 56
ci_058                -2.506732e-03 3 1  ON 57
ci_059                -2.412691e-03 3 1  ON 58
ci_060                 5.758058e-03 3 1  ON 59
ci_061                 4.990356e-03 3 1  ON 60
ci_062                -4.025650e-03 3 1  ON 61
ci_063                -3.387989e-03 3 1  ON 62
ci_064                -3.163833e-03 3 1  ON 63
ci_065                -4.177270e-03 3 1  ON 64
ci_066                 4.713973e-03 3 1  ON 65
ci_067                 4.805376e-03 3 1  ON 66
ci_068                -5.061617e-03 3 1  ON 67
ci_069                -5.439543e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.2665
    reference variance = 0.531882
====================================================
  Execution time = 1.3564e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8909e-01
  Total weights = 1.9571e+06
  Execution time = 1.8612e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277851342978
                                         uncertainty =       0.001535501818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277851342978
                                         uncertainty =       0.001535501818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372708461
  error estimate for blocks of size 2^( 2) =       0.000386514353
  error estimate for blocks of size 2^( 3) =       0.000398617018
  error estimate for blocks of size 2^( 4) =       0.000407278564
  error estimate for blocks of size 2^( 5) =       0.000413402914
  error estimate for blocks of size 2^( 6) =       0.000417687273
  error estimate for blocks of size 2^( 7) =       0.000419039804

      target function =      -0.849444437087
              le_mean =     -17.212148205095
             les_mean =     296.600811609072
             stat err =       0.000414352139
             autocorr =       1.235949328386
   target nu stat err =       0.000414352139
   target dn stat err =       0.020564672776
      target stat err =       0.023037508461
              std dev =       0.527089360323
             le_variance =       0.277823193766

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275753877217
                                         uncertainty =       0.001293864168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275753877217
                                         uncertainty =       0.001293864168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371302787
  error estimate for blocks of size 2^( 2) =       0.000385152134
  error estimate for blocks of size 2^( 3) =       0.000397308319
  error estimate for blocks of size 2^( 4) =       0.000406018024
  error estimate for blocks of size 2^( 5) =       0.000412129211
  error estimate for blocks of size 2^( 6) =       0.000416451541
  error estimate for blocks of size 2^( 7) =       0.000417954464

      target function =      -0.914763552109
              le_mean =     -17.212034481370
             les_mean =     296.543220129532
             stat err =       0.000413138310
             autocorr =       1.238039551376
   target nu stat err =       0.000413138310
   target dn stat err =       0.002870463489
      target stat err =       0.003770625890
              std dev =       0.525101437046
             le_variance =       0.275731519188

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277754263117
                                         uncertainty =       0.001303343180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277754263117
                                         uncertainty =       0.001303343180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372644982
  error estimate for blocks of size 2^( 2) =       0.000386456796
  error estimate for blocks of size 2^( 3) =       0.000398586157
  error estimate for blocks of size 2^( 4) =       0.000407244659
  error estimate for blocks of size 2^( 5) =       0.000413385335
  error estimate for blocks of size 2^( 6) =       0.000417822083
  error estimate for blocks of size 2^( 7) =       0.000419607258

      target function =      -0.852664577729
              le_mean =     -17.212169630756
             les_mean =     296.598220761929
             stat err =       0.000414514834
             autocorr =       1.237341553227
   target nu stat err =       0.000414514834
   target dn stat err =       0.027763770837
      target stat err =       0.031354921115
              std dev =       0.526999588001
             le_variance =       0.277728565753

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275753849795
                                         uncertainty =       0.001293866482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275753849795
                                         uncertainty =       0.001293866482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371302769
  error estimate for blocks of size 2^( 2) =       0.000385152117
  error estimate for blocks of size 2^( 3) =       0.000397308302
  error estimate for blocks of size 2^( 4) =       0.000406018010
  error estimate for blocks of size 2^( 5) =       0.000412129195
  error estimate for blocks of size 2^( 6) =       0.000416451516
  error estimate for blocks of size 2^( 7) =       0.000417954421

      target function =      -0.914761193884
              le_mean =     -17.212034482407
             les_mean =     296.543221982220
             stat err =       0.000413138286
             autocorr =       1.238039528727
   target nu stat err =       0.000413138286
   target dn stat err =       0.002870539832
      target stat err =       0.003770704548
              std dev =       0.525101411047
             le_variance =       0.275731491884


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.849444437087        initial
     5.8208e-07     5.8208e-06             2.6030e-03        -0.914763552109  <--
     2.3283e-06     2.3283e-05             2.6030e-03        -0.852664577729
     9.3132e-06     9.3132e-05             2.6026e-03        -0.914761193884

*****************************************************************************
Applying the update for shift_i =   5.8208e-07     and shift_s =   5.8208e-06
*****************************************************************************

  Execution time = 2.2949e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
ci_001                -4.098320e-02 3 1  ON 0
ci_002                -3.374184e-02 3 1  ON 1
ci_003                -2.649998e-02 3 1  ON 2
ci_004                 2.345076e-02 3 1  ON 3
ci_005                 2.362059e-02 3 1  ON 4
ci_006                -2.260295e-02 3 1  ON 5
ci_007                -2.284964e-02 3 1  ON 6
ci_008                -9.073398e-03 3 1  ON 7
ci_009                -1.557792e-02 3 1  ON 8
ci_010                -1.010965e-02 3 1  ON 9
ci_011                -1.135086e-02 3 1  ON 10
ci_012                -1.234555e-02 3 1  ON 11
ci_013                -1.929439e-02 3 1  ON 12
ci_014                 1.354374e-02 3 1  ON 13
ci_015                 1.263849e-02 3 1  ON 14
ci_016                 1.640838e-02 3 1  ON 15
ci_017                 1.707229e-02 3 1  ON 16
ci_018                 1.073511e-02 3 1  ON 17
ci_019                 1.087199e-02 3 1  ON 18
ci_020                 1.878268e-02 3 1  ON 19
ci_021                 1.855232e-02 3 1  ON 20
ci_022                 1.008526e-02 3 1  ON 21
ci_023                 1.034550e-02 3 1  ON 22
ci_024                 8.949209e-03 3 1  ON 23
ci_025                 1.001696e-02 3 1  ON 24
ci_026                 1.135138e-02 3 1  ON 25
ci_027                 1.209437e-02 3 1  ON 26
ci_028                -1.436992e-02 3 1  ON 27
ci_029                -1.508063e-02 3 1  ON 28
ci_030                -8.946072e-03 3 1  ON 29
ci_031                -1.045064e-02 3 1  ON 30
ci_032                -1.423946e-02 3 1  ON 31
ci_033                 4.546719e-03 3 1  ON 32
ci_034                 5.150311e-03 3 1  ON 33
ci_035                -5.300701e-03 3 1  ON 34
ci_036                -1.323845e-02 3 1  ON 35
ci_037                -1.296761e-02 3 1  ON 36
ci_038                 1.631484e-03 3 1  ON 37
ci_039                 1.871296e-03 3 1  ON 38
ci_040                -3.284492e-03 3 1  ON 39
ci_041                 8.476769e-03 3 1  ON 40
ci_042                 8.998277e-03 3 1  ON 41
ci_043                -4.764482e-03 3 1  ON 42
ci_044                -4.181919e-03 3 1  ON 43
ci_045                -3.023516e-03 3 1  ON 44
ci_046                 5.105075e-03 3 1  ON 45
ci_047                 5.055174e-03 3 1  ON 46
ci_048                -1.312648e-02 3 1  ON 47
ci_049                -1.318501e-02 3 1  ON 48
ci_050                 3.923853e-03 3 1  ON 49
ci_051                 3.804181e-03 3 1  ON 50
ci_052                -1.869646e-03 3 1  ON 51
ci_053                -2.944332e-03 3 1  ON 52
ci_054                -1.559393e-03 3 1  ON 53
ci_055                -3.025078e-03 3 1  ON 54
ci_056                 5.649098e-03 3 1  ON 55
ci_057                 5.929166e-03 3 1  ON 56
ci_058                -2.506744e-03 3 1  ON 57
ci_059                -2.412666e-03 3 1  ON 58
ci_060                 5.758074e-03 3 1  ON 59
ci_061                 4.990376e-03 3 1  ON 60
ci_062                -4.025653e-03 3 1  ON 61
ci_063                -3.387982e-03 3 1  ON 62
ci_064                -3.163826e-03 3 1  ON 63
ci_065                -4.177270e-03 3 1  ON 64
ci_066                 4.713990e-03 3 1  ON 65
ci_067                 4.805365e-03 3 1  ON 66
ci_068                -5.061612e-03 3 1  ON 67
ci_069                -5.439536e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9417e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.1395
    reference variance = 0.284921
====================================================
  Execution time = 1.3962e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9130e-01
  Total weights = 1.957429800e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4689e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278465090451
                                         uncertainty =       0.002351270594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278465090451
                                         uncertainty =       0.002351270594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373112387
  error estimate for blocks of size 2^( 2) =       0.000387013439
  error estimate for blocks of size 2^( 3) =       0.000399465703
  error estimate for blocks of size 2^( 4) =       0.000409042541
  error estimate for blocks of size 2^( 5) =       0.000414944326
  error estimate for blocks of size 2^( 6) =       0.000420151002
  error estimate for blocks of size 2^( 7) =       0.000419482161

      target function =      -0.911828777450
              le_mean =     -17.211814592277
             les_mean =     296.537857730404
             stat err =       0.000415905007
             autocorr =       1.242535949959
   target nu stat err =       0.000415905007
   target dn stat err =       0.004679287296
      target stat err =       0.006059785873
              std dev =       0.527660598340
             le_variance =       0.278425707040


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721181459228e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e-07, overlap shift 1.4552e-06 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911868454164       residual = 2.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912893374952       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913019634328       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913062100957       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913071614938       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913073614434       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913074694334       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913074317545       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913074515450       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913074339201       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913074294575       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913074317964       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e-07 is 2.777280e-03

solving harmonic davidson linear method for identity shift 5.8208e-07, overlap shift 5.8208e-06 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911868454164       residual = 2.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912893369335       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913019627855       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913062094111       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913071608000       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913073607466       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913074687352       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913074310567       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913074508469       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913074332222       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913074287596       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913074310986       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-07 is 2.777262e-03

solving harmonic davidson linear method for identity shift 2.3283e-06, overlap shift 2.3283e-05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911868454164       residual = 2.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912893346869       residual = 2.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913019601963       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913062066731       residual = 1.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913071580246       residual = 5.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913073579594       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913074659426       residual = 2.79e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913074282653       residual = 9.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913074480544       residual = 1.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913074304307       residual = 5.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913074259684       residual = 1.37e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913074283072       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-06 is 2.777187e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.693696 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6449e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
ci_001                -4.301491e-02 3 1  ON 0
ci_002                -3.339717e-02 3 1  ON 1
ci_003                -2.631463e-02 3 1  ON 2
ci_004                 2.217227e-02 3 1  ON 3
ci_005                 2.639785e-02 3 1  ON 4
ci_006                -2.200124e-02 3 1  ON 5
ci_007                -2.218409e-02 3 1  ON 6
ci_008                -9.183454e-03 3 1  ON 7
ci_009                -1.443971e-02 3 1  ON 8
ci_010                -1.037193e-02 3 1  ON 9
ci_011                -8.820745e-03 3 1  ON 10
ci_012                -1.192396e-02 3 1  ON 11
ci_013                -2.090336e-02 3 1  ON 12
ci_014                 1.297295e-02 3 1  ON 13
ci_015                 1.355543e-02 3 1  ON 14
ci_016                 1.734060e-02 3 1  ON 15
ci_017                 1.578019e-02 3 1  ON 16
ci_018                 1.188763e-02 3 1  ON 17
ci_019                 1.206931e-02 3 1  ON 18
ci_020                 1.840762e-02 3 1  ON 19
ci_021                 1.805468e-02 3 1  ON 20
ci_022                 1.061817e-02 3 1  ON 21
ci_023                 1.030223e-02 3 1  ON 22
ci_024                 9.181354e-03 3 1  ON 23
ci_025                 1.080062e-02 3 1  ON 24
ci_026                 1.181948e-02 3 1  ON 25
ci_027                 1.096274e-02 3 1  ON 26
ci_028                -1.457632e-02 3 1  ON 27
ci_029                -1.468344e-02 3 1  ON 28
ci_030                -9.854490e-03 3 1  ON 29
ci_031                -8.456078e-03 3 1  ON 30
ci_032                -1.413956e-02 3 1  ON 31
ci_033                 4.602331e-03 3 1  ON 32
ci_034                 5.922129e-03 3 1  ON 33
ci_035                -5.255146e-03 3 1  ON 34
ci_036                -1.332026e-02 3 1  ON 35
ci_037                -1.330365e-02 3 1  ON 36
ci_038                 2.376586e-03 3 1  ON 37
ci_039                 2.299443e-03 3 1  ON 38
ci_040                -3.181676e-03 3 1  ON 39
ci_041                 8.259845e-03 3 1  ON 40
ci_042                 8.270327e-03 3 1  ON 41
ci_043                -4.820212e-03 3 1  ON 42
ci_044                -3.077694e-03 3 1  ON 43
ci_045                -3.003201e-03 3 1  ON 44
ci_046                 5.386921e-03 3 1  ON 45
ci_047                 5.992711e-03 3 1  ON 46
ci_048                -1.300164e-02 3 1  ON 47
ci_049                -1.407732e-02 3 1  ON 48
ci_050                 1.795804e-03 3 1  ON 49
ci_051                 3.806518e-03 3 1  ON 50
ci_052                -3.374728e-03 3 1  ON 51
ci_053                -3.374631e-03 3 1  ON 52
ci_054                -2.406020e-03 3 1  ON 53
ci_055                -2.830533e-03 3 1  ON 54
ci_056                 5.847804e-03 3 1  ON 55
ci_057                 6.478192e-03 3 1  ON 56
ci_058                -1.122291e-03 3 1  ON 57
ci_059                -1.466114e-03 3 1  ON 58
ci_060                 4.775072e-03 3 1  ON 59
ci_061                 4.889205e-03 3 1  ON 60
ci_062                -3.498044e-03 3 1  ON 61
ci_063                -3.174264e-03 3 1  ON 62
ci_064                -3.126068e-03 3 1  ON 63
ci_065                -4.485057e-03 3 1  ON 64
ci_066                 4.361842e-03 3 1  ON 65
ci_067                 4.926989e-03 3 1  ON 66
ci_068                -4.827558e-03 3 1  ON 67
ci_069                -4.090910e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.2218
    reference variance = 0.360739
====================================================
  Execution time = 1.3724e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8882e-01
  Total weights = 1.9568e+06
  Execution time = 1.8560e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277984633667
                                         uncertainty =       0.001955465918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277984633667
                                         uncertainty =       0.001955465918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372809575
  error estimate for blocks of size 2^( 2) =       0.000386449662
  error estimate for blocks of size 2^( 3) =       0.000398761980
  error estimate for blocks of size 2^( 4) =       0.000407248797
  error estimate for blocks of size 2^( 5) =       0.000411294063
  error estimate for blocks of size 2^( 6) =       0.000415285777
  error estimate for blocks of size 2^( 7) =       0.000418281061

      target function =      -0.904656802991
              le_mean =     -17.212321014299
             les_mean =     296.560995702177
             stat err =       0.000413027424
             autocorr =       1.227393055985
   target nu stat err =       0.000413027424
   target dn stat err =       0.004496715340
      target stat err =       0.005738875582
              std dev =       0.527232357428
             le_variance =       0.277973958720

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277542162452
                                         uncertainty =       0.001952714757

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277542162452
                                         uncertainty =       0.001952714757

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372510300
  error estimate for blocks of size 2^( 2) =       0.000386166858
  error estimate for blocks of size 2^( 3) =       0.000398516534
  error estimate for blocks of size 2^( 4) =       0.000407014630
  error estimate for blocks of size 2^( 5) =       0.000411063690
  error estimate for blocks of size 2^( 6) =       0.000414991390
  error estimate for blocks of size 2^( 7) =       0.000417909999

      target function =      -0.915156440135
              le_mean =     -17.212171564751
             les_mean =     296.547668100472
             stat err =       0.000412744927
             autocorr =       1.227684908972
   target nu stat err =       0.000412744927
   target dn stat err =       0.002236403755
      target stat err =       0.002963606040
              std dev =       0.526809118438
             le_variance =       0.277527847270

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281879023880
                                         uncertainty =       0.002465540100

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281879023880
                                         uncertainty =       0.002465540100

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375403589
  error estimate for blocks of size 2^( 2) =       0.000388996331
  error estimate for blocks of size 2^( 3) =       0.000401289626
  error estimate for blocks of size 2^( 4) =       0.000409768530
  error estimate for blocks of size 2^( 5) =       0.000413757992
  error estimate for blocks of size 2^( 6) =       0.000417554053
  error estimate for blocks of size 2^( 7) =       0.000420371159

      target function =      -0.835766104743
              le_mean =     -17.212305291640
             les_mean =     296.617145207987
             stat err =       0.000415362934
             autocorr =       1.224217648578
   target nu stat err =       0.000415362934
   target dn stat err =       0.039882734253
      target stat err =       0.043337403179
              std dev =       0.530900846791
             le_variance =       0.281855709123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277542134633
                                         uncertainty =       0.001952714551

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277542134633
                                         uncertainty =       0.001952714551

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372510281
  error estimate for blocks of size 2^( 2) =       0.000386166840
  error estimate for blocks of size 2^( 3) =       0.000398516515
  error estimate for blocks of size 2^( 4) =       0.000407014611
  error estimate for blocks of size 2^( 5) =       0.000411063672
  error estimate for blocks of size 2^( 6) =       0.000414991375
  error estimate for blocks of size 2^( 7) =       0.000417909987

      target function =      -0.915156498343
              le_mean =     -17.212171565123
             les_mean =     296.547668068542
             stat err =       0.000412744911
             autocorr =       1.227684937769
   target nu stat err =       0.000412744911
   target dn stat err =       0.002236405137
      target stat err =       0.002963608168
              std dev =       0.526809092135
             le_variance =       0.277527819557


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.904656802991        initial
     1.4552e-07     1.4552e-06             2.7773e-03        -0.915156440135
     5.8208e-07     5.8208e-06             2.7773e-03        -0.835766104743
     2.3283e-06     2.3283e-05             2.7772e-03        -0.915156498343  <--

*****************************************************************************
Applying the update for shift_i =   2.3283e-06     and shift_s =   2.3283e-05
*****************************************************************************

  Execution time = 2.3129e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
ci_001                -4.301485e-02 3 1  ON 0
ci_002                -3.339718e-02 3 1  ON 1
ci_003                -2.631463e-02 3 1  ON 2
ci_004                 2.217230e-02 3 1  ON 3
ci_005                 2.639778e-02 3 1  ON 4
ci_006                -2.200126e-02 3 1  ON 5
ci_007                -2.218411e-02 3 1  ON 6
ci_008                -9.183451e-03 3 1  ON 7
ci_009                -1.443974e-02 3 1  ON 8
ci_010                -1.037192e-02 3 1  ON 9
ci_011                -8.820807e-03 3 1  ON 10
ci_012                -1.192397e-02 3 1  ON 11
ci_013                -2.090330e-02 3 1  ON 12
ci_014                 1.297296e-02 3 1  ON 13
ci_015                 1.355541e-02 3 1  ON 14
ci_016                 1.734057e-02 3 1  ON 15
ci_017                 1.578023e-02 3 1  ON 16
ci_018                 1.188761e-02 3 1  ON 17
ci_019                 1.206929e-02 3 1  ON 18
ci_020                 1.840763e-02 3 1  ON 19
ci_021                 1.805469e-02 3 1  ON 20
ci_022                 1.061816e-02 3 1  ON 21
ci_023                 1.030224e-02 3 1  ON 22
ci_024                 9.181349e-03 3 1  ON 23
ci_025                 1.080060e-02 3 1  ON 24
ci_026                 1.181947e-02 3 1  ON 25
ci_027                 1.096276e-02 3 1  ON 26
ci_028                -1.457631e-02 3 1  ON 27
ci_029                -1.468345e-02 3 1  ON 28
ci_030                -9.854469e-03 3 1  ON 29
ci_031                -8.456122e-03 3 1  ON 30
ci_032                -1.413956e-02 3 1  ON 31
ci_033                 4.602329e-03 3 1  ON 32
ci_034                 5.922109e-03 3 1  ON 33
ci_035                -5.255147e-03 3 1  ON 34
ci_036                -1.332026e-02 3 1  ON 35
ci_037                -1.330364e-02 3 1  ON 36
ci_038                 2.376569e-03 3 1  ON 37
ci_039                 2.299434e-03 3 1  ON 38
ci_040                -3.181678e-03 3 1  ON 39
ci_041                 8.259850e-03 3 1  ON 40
ci_042                 8.270344e-03 3 1  ON 41
ci_043                -4.820211e-03 3 1  ON 42
ci_044                -3.077722e-03 3 1  ON 43
ci_045                -3.003201e-03 3 1  ON 44
ci_046                 5.386914e-03 3 1  ON 45
ci_047                 5.992687e-03 3 1  ON 46
ci_048                -1.300164e-02 3 1  ON 47
ci_049                -1.407730e-02 3 1  ON 48
ci_050                 1.795849e-03 3 1  ON 49
ci_051                 3.806518e-03 3 1  ON 50
ci_052                -3.374693e-03 3 1  ON 51
ci_053                -3.374622e-03 3 1  ON 52
ci_054                -2.406002e-03 3 1  ON 53
ci_055                -2.830537e-03 3 1  ON 54
ci_056                 5.847799e-03 3 1  ON 55
ci_057                 6.478179e-03 3 1  ON 56
ci_058                -1.122324e-03 3 1  ON 57
ci_059                -1.466134e-03 3 1  ON 58
ci_060                 4.775098e-03 3 1  ON 59
ci_061                 4.889208e-03 3 1  ON 60
ci_062                -3.498057e-03 3 1  ON 61
ci_063                -3.174268e-03 3 1  ON 62
ci_064                -3.126069e-03 3 1  ON 63
ci_065                -4.485050e-03 3 1  ON 64
ci_066                 4.361850e-03 3 1  ON 65
ci_067                 4.926986e-03 3 1  ON 66
ci_068                -4.827564e-03 3 1  ON 67
ci_069                -4.090943e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9593e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.2219
    reference variance = 0.281416
====================================================
  Execution time = 1.3933e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5310e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8826e-01
  Total weights = 1.957116364e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5182e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275475817712
                                         uncertainty =       0.001613183936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275475817712
                                         uncertainty =       0.001613183936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371155416
  error estimate for blocks of size 2^( 2) =       0.000384854109
  error estimate for blocks of size 2^( 3) =       0.000396834667
  error estimate for blocks of size 2^( 4) =       0.000405653318
  error estimate for blocks of size 2^( 5) =       0.000410792270
  error estimate for blocks of size 2^( 6) =       0.000413537408
  error estimate for blocks of size 2^( 7) =       0.000416482587

      target function =      -0.915821406561
              le_mean =     -17.211940857353
             les_mean =     296.539168604212
             stat err =       0.000411616396
             autocorr =       1.229911117262
   target nu stat err =       0.000411616396
   target dn stat err =       0.002297484972
      target stat err =       0.003044369759
              std dev =       0.524893022725
             le_variance =       0.275512685306


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721194085735e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-07, overlap shift 5.8208e-06 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915830703191       residual = 2.92e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916902069938       residual = 3.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917115698479       residual = 8.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917178928916       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917192628052       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917197648936       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917197296182       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917196848475       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917196850651       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917196598909       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917196654721       residual = 9.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-07 is 2.456001e-03

solving harmonic davidson linear method for identity shift 2.3283e-06, overlap shift 2.3283e-05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915830703191       residual = 2.92e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916902046780       residual = 3.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917115669759       residual = 8.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917178898074       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917192596650       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917197617272       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917197264514       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917196816817       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917196818995       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917196567265       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917196623074       residual = 9.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-06 is 2.455948e-03

solving harmonic davidson linear method for identity shift 9.3132e-06, overlap shift 9.3132e-05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915830703191       residual = 2.92e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.916901954159       residual = 3.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.917115554892       residual = 8.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.917178774723       residual = 2.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.917192471054       residual = 6.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.917197490628       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.917197137856       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.917196690201       residual = 9.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.917196692387       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.917196440703       residual = 6.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.917196496498       residual = 9.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-06 is 2.455739e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.697854 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6461e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
ci_001                -4.142378e-02 3 1  ON 0
ci_002                -3.446880e-02 3 1  ON 1
ci_003                -2.614499e-02 3 1  ON 2
ci_004                 2.335780e-02 3 1  ON 3
ci_005                 2.444858e-02 3 1  ON 4
ci_006                -2.178662e-02 3 1  ON 5
ci_007                -2.088142e-02 3 1  ON 6
ci_008                -9.659945e-03 3 1  ON 7
ci_009                -1.512660e-02 3 1  ON 8
ci_010                -9.197908e-03 3 1  ON 9
ci_011                -1.116552e-02 3 1  ON 10
ci_012                -1.156146e-02 3 1  ON 11
ci_013                -1.961347e-02 3 1  ON 12
ci_014                 1.279091e-02 3 1  ON 13
ci_015                 1.313697e-02 3 1  ON 14
ci_016                 1.619487e-02 3 1  ON 15
ci_017                 1.682005e-02 3 1  ON 16
ci_018                 1.093602e-02 3 1  ON 17
ci_019                 1.016995e-02 3 1  ON 18
ci_020                 1.767262e-02 3 1  ON 19
ci_021                 1.823298e-02 3 1  ON 20
ci_022                 9.482598e-03 3 1  ON 21
ci_023                 1.085980e-02 3 1  ON 22
ci_024                 8.890260e-03 3 1  ON 23
ci_025                 8.769547e-03 3 1  ON 24
ci_026                 1.123899e-02 3 1  ON 25
ci_027                 1.230337e-02 3 1  ON 26
ci_028                -1.491833e-02 3 1  ON 27
ci_029                -1.595485e-02 3 1  ON 28
ci_030                -9.990306e-03 3 1  ON 29
ci_031                -1.078364e-02 3 1  ON 30
ci_032                -1.456484e-02 3 1  ON 31
ci_033                 5.901173e-03 3 1  ON 32
ci_034                 6.694232e-03 3 1  ON 33
ci_035                -5.145293e-03 3 1  ON 34
ci_036                -1.192101e-02 3 1  ON 35
ci_037                -1.165896e-02 3 1  ON 36
ci_038                 2.229325e-03 3 1  ON 37
ci_039                 2.793648e-03 3 1  ON 38
ci_040                -3.561366e-03 3 1  ON 39
ci_041                 8.516311e-03 3 1  ON 40
ci_042                 9.116727e-03 3 1  ON 41
ci_043                -3.881712e-03 3 1  ON 42
ci_044                -4.399656e-03 3 1  ON 43
ci_045                -3.311813e-03 3 1  ON 44
ci_046                 5.606602e-03 3 1  ON 45
ci_047                 5.680491e-03 3 1  ON 46
ci_048                -1.356519e-02 3 1  ON 47
ci_049                -1.274719e-02 3 1  ON 48
ci_050                 4.251797e-03 3 1  ON 49
ci_051                 2.677697e-03 3 1  ON 50
ci_052                -2.609578e-03 3 1  ON 51
ci_053                -2.871781e-03 3 1  ON 52
ci_054                -2.592226e-03 3 1  ON 53
ci_055                -2.810788e-03 3 1  ON 54
ci_056                 5.372479e-03 3 1  ON 55
ci_057                 6.053605e-03 3 1  ON 56
ci_058                -1.221281e-03 3 1  ON 57
ci_059                -2.766510e-03 3 1  ON 58
ci_060                 5.088527e-03 3 1  ON 59
ci_061                 5.300255e-03 3 1  ON 60
ci_062                -3.771386e-03 3 1  ON 61
ci_063                -3.931550e-03 3 1  ON 62
ci_064                -3.327217e-03 3 1  ON 63
ci_065                -3.675571e-03 3 1  ON 64
ci_066                 4.283847e-03 3 1  ON 65
ci_067                 5.067465e-03 3 1  ON 66
ci_068                -5.284861e-03 3 1  ON 67
ci_069                -4.320444e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.2172
    reference variance = 0.250242
====================================================
  Execution time = 1.3672e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8671e-01
  Total weights = 1.9571e+06
  Execution time = 1.8562e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0534047
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280596936643
                                         uncertainty =       0.004805133033

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280596936643
                                         uncertainty =       0.004805133033

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374570210
  error estimate for blocks of size 2^( 2) =       0.000388268376
  error estimate for blocks of size 2^( 3) =       0.000400203303
  error estimate for blocks of size 2^( 4) =       0.000409403440
  error estimate for blocks of size 2^( 5) =       0.000413929927
  error estimate for blocks of size 2^( 6) =       0.000415713971
  error estimate for blocks of size 2^( 7) =       0.000418497066

      target function =      -0.619930568899
              le_mean =     -17.212169210026
             les_mean =     296.820675576303
             stat err =       0.000414386101
             autocorr =       1.223894241156
   target nu stat err =       0.000414386101
   target dn stat err =       0.247100797162
      target stat err =       0.156697064964
              std dev =       0.529722271224
             le_variance =       0.280605684630

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274135194762
                                         uncertainty =       0.001333287203

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274135194762
                                         uncertainty =       0.001333287203

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370227295
  error estimate for blocks of size 2^( 2) =       0.000384005456
  error estimate for blocks of size 2^( 3) =       0.000396121981
  error estimate for blocks of size 2^( 4) =       0.000405417781
  error estimate for blocks of size 2^( 5) =       0.000410102555
  error estimate for blocks of size 2^( 6) =       0.000411740671
  error estimate for blocks of size 2^( 7) =       0.000413986092

      target function =      -0.917836772793
              le_mean =     -17.211932289727
             les_mean =     296.537324875069
             stat err =       0.000410311775
             autocorr =       1.228262214044
   target nu stat err =       0.000410311775
   target dn stat err =       0.002396956672
      target stat err =       0.003184773573
              std dev =       0.523580462112
             le_variance =       0.274136500305

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0545663
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371361879462
                                         uncertainty =       0.065871188061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.371361879462
                                         uncertainty =       0.065871188061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000430878932
  error estimate for blocks of size 2^( 2) =       0.000442883328
  error estimate for blocks of size 2^( 3) =       0.000453503604
  error estimate for blocks of size 2^( 4) =       0.000461694611
  error estimate for blocks of size 2^( 5) =       0.000465971844
  error estimate for blocks of size 2^( 6) =       0.000467726460
  error estimate for blocks of size 2^( 7) =       0.000470343600

      target function =      -0.192131630635
              le_mean =     -17.211774432991
             les_mean =     298.491095799689
             stat err =       0.000466434128
             autocorr =       1.171844863994
   target nu stat err =       0.000466434128
   target dn stat err =       1.361886488371
      target stat err =       0.098291051473
              std dev =       0.609354828937
             le_variance =       0.371313307549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274135110281
                                         uncertainty =       0.001333286475

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274135110281
                                         uncertainty =       0.001333286475

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370227239
  error estimate for blocks of size 2^( 2) =       0.000384005397
  error estimate for blocks of size 2^( 3) =       0.000396121914
  error estimate for blocks of size 2^( 4) =       0.000405417706
  error estimate for blocks of size 2^( 5) =       0.000410102471
  error estimate for blocks of size 2^( 6) =       0.000411740596
  error estimate for blocks of size 2^( 7) =       0.000413986019

      target function =      -0.917837072780
              le_mean =     -17.211932289277
             les_mean =     296.537324630085
             stat err =       0.000410311698
             autocorr =       1.228262129900
   target nu stat err =       0.000410311698
   target dn stat err =       0.002396913963
      target stat err =       0.003184720758
              std dev =       0.523580382342
             le_variance =       0.274136416773


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.619930568899        initial
     5.8208e-07     5.8208e-06             2.4560e-03        -0.917836772793
     2.3283e-06     2.3283e-05             2.4559e-03        -0.192131630635
     9.3132e-06     9.3132e-05             2.4557e-03        -0.917837072780  <--

*****************************************************************************
Applying the update for shift_i =   9.3132e-06     and shift_s =   9.3132e-05
*****************************************************************************

  Execution time = 2.3050e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
ci_001                -4.142396e-02 3 1  ON 0
ci_002                -3.446868e-02 3 1  ON 1
ci_003                -2.614504e-02 3 1  ON 2
ci_004                 2.335767e-02 3 1  ON 3
ci_005                 2.444878e-02 3 1  ON 4
ci_006                -2.178664e-02 3 1  ON 5
ci_007                -2.088157e-02 3 1  ON 6
ci_008                -9.659913e-03 3 1  ON 7
ci_009                -1.512653e-02 3 1  ON 8
ci_010                -9.198026e-03 3 1  ON 9
ci_011                -1.116529e-02 3 1  ON 10
ci_012                -1.156149e-02 3 1  ON 11
ci_013                -1.961362e-02 3 1  ON 12
ci_014                 1.279094e-02 3 1  ON 13
ci_015                 1.313701e-02 3 1  ON 14
ci_016                 1.619500e-02 3 1  ON 15
ci_017                 1.681992e-02 3 1  ON 16
ci_018                 1.093611e-02 3 1  ON 17
ci_019                 1.017013e-02 3 1  ON 18
ci_020                 1.767272e-02 3 1  ON 19
ci_021                 1.823298e-02 3 1  ON 20
ci_022                 9.482715e-03 3 1  ON 21
ci_023                 1.085973e-02 3 1  ON 22
ci_024                 8.890285e-03 3 1  ON 23
ci_025                 8.769765e-03 3 1  ON 24
ci_026                 1.123904e-02 3 1  ON 25
ci_027                 1.230326e-02 3 1  ON 26
ci_028                -1.491828e-02 3 1  ON 27
ci_029                -1.595469e-02 3 1  ON 28
ci_030                -9.990286e-03 3 1  ON 29
ci_031                -1.078343e-02 3 1  ON 30
ci_032                -1.456479e-02 3 1  ON 31
ci_033                 5.901039e-03 3 1  ON 32
ci_034                 6.694150e-03 3 1  ON 33
ci_035                -5.145302e-03 3 1  ON 34
ci_036                -1.192115e-02 3 1  ON 35
ci_037                -1.165911e-02 3 1  ON 36
ci_038                 2.229339e-03 3 1  ON 37
ci_039                 2.793603e-03 3 1  ON 38
ci_040                -3.561332e-03 3 1  ON 39
ci_041                 8.516283e-03 3 1  ON 40
ci_042                 9.116634e-03 3 1  ON 41
ci_043                -3.881800e-03 3 1  ON 42
ci_044                -4.399527e-03 3 1  ON 43
ci_045                -3.311784e-03 3 1  ON 44
ci_046                 5.606581e-03 3 1  ON 45
ci_047                 5.680523e-03 3 1  ON 46
ci_048                -1.356512e-02 3 1  ON 47
ci_049                -1.274731e-02 3 1  ON 48
ci_050                 4.251587e-03 3 1  ON 49
ci_051                 2.677795e-03 3 1  ON 50
ci_052                -2.609651e-03 3 1  ON 51
ci_053                -2.871819e-03 3 1  ON 52
ci_054                -2.592193e-03 3 1  ON 53
ci_055                -2.810790e-03 3 1  ON 54
ci_056                 5.372525e-03 3 1  ON 55
ci_057                 6.053646e-03 3 1  ON 56
ci_058                -1.221267e-03 3 1  ON 57
ci_059                -2.766391e-03 3 1  ON 58
ci_060                 5.088495e-03 3 1  ON 59
ci_061                 5.300211e-03 3 1  ON 60
ci_062                -3.771361e-03 3 1  ON 61
ci_063                -3.931489e-03 3 1  ON 62
ci_064                -3.327200e-03 3 1  ON 63
ci_065                -3.675644e-03 3 1  ON 64
ci_066                 4.283859e-03 3 1  ON 65
ci_067                 5.067454e-03 3 1  ON 66
ci_068                -5.284816e-03 3 1  ON 67
ci_069                -4.320419e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9521e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.2436
    reference variance = 0.420219
====================================================
  Execution time = 1.4088e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5233e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.9297e-01
  Total weights = 1.956910115e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4934e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278812565313
                                         uncertainty =       0.002204002937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278812565313
                                         uncertainty =       0.002204002937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373487311
  error estimate for blocks of size 2^( 2) =       0.000387325718
  error estimate for blocks of size 2^( 3) =       0.000399442009
  error estimate for blocks of size 2^( 4) =       0.000408573906
  error estimate for blocks of size 2^( 5) =       0.000413473346
  error estimate for blocks of size 2^( 6) =       0.000416616978
  error estimate for blocks of size 2^( 7) =       0.000418292228

      target function =      -0.909481525829
              le_mean =     -17.211073705228
             les_mean =     296.514024932222
             stat err =       0.000414239114
             autocorr =       1.230128569142
   target nu stat err =       0.000414239114
   target dn stat err =       0.005637478583
      target stat err =       0.007244235559
              std dev =       0.528190821254
             le_variance =       0.278985543657


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721107370523e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e-06, overlap shift 2.3283e-05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909538128602       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910372632252       residual = 3.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910607868049       residual = 7.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910668202862       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910676559047       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910679764325       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910681015033       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910681949085       residual = 8.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910681977429       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910681992615       residual = 5.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910681949123       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910681891676       residual = 2.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e-06 is 3.075746e-03

solving harmonic davidson linear method for identity shift 9.3132e-06, overlap shift 9.3132e-05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909538128602       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910372558436       residual = 3.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910607766849       residual = 7.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910668092705       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910676447262       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910679651960       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910680902435       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910681836313       residual = 8.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910681864639       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910681879812       residual = 5.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910681836328       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910681778895       residual = 2.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-06 is 3.075399e-03

solving harmonic davidson linear method for identity shift 3.7253e-05, overlap shift 3.7253e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.909538128602       residual = 1.77e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910372263300       residual = 3.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910607362241       residual = 7.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910667652297       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910676000343       residual = 4.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910679202726       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910680452271       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910681385450       residual = 8.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910681413703       residual = 1.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910681428829       residual = 5.48e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910681385375       residual = 1.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.910681327998       residual = 2.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-05 is 3.074011e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.707868 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6600e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
ci_001                -4.138693e-02 3 1  ON 0
ci_002                -3.139328e-02 3 1  ON 1
ci_003                -2.679703e-02 3 1  ON 2
ci_004                 2.428494e-02 3 1  ON 3
ci_005                 2.473968e-02 3 1  ON 4
ci_006                -2.088951e-02 3 1  ON 5
ci_007                -2.290424e-02 3 1  ON 6
ci_008                -9.543127e-03 3 1  ON 7
ci_009                -1.510367e-02 3 1  ON 8
ci_010                -1.053422e-02 3 1  ON 9
ci_011                -9.600437e-03 3 1  ON 10
ci_012                -1.097232e-02 3 1  ON 11
ci_013                -2.124209e-02 3 1  ON 12
ci_014                 1.289378e-02 3 1  ON 13
ci_015                 1.222062e-02 3 1  ON 14
ci_016                 1.729716e-02 3 1  ON 15
ci_017                 1.563464e-02 3 1  ON 16
ci_018                 1.048540e-02 3 1  ON 17
ci_019                 1.132303e-02 3 1  ON 18
ci_020                 1.843876e-02 3 1  ON 19
ci_021                 1.642094e-02 3 1  ON 20
ci_022                 9.737335e-03 3 1  ON 21
ci_023                 8.999759e-03 3 1  ON 22
ci_024                 1.039400e-02 3 1  ON 23
ci_025                 1.019243e-02 3 1  ON 24
ci_026                 1.230193e-02 3 1  ON 25
ci_027                 1.133647e-02 3 1  ON 26
ci_028                -1.437015e-02 3 1  ON 27
ci_029                -1.691868e-02 3 1  ON 28
ci_030                -9.514622e-03 3 1  ON 29
ci_031                -9.482177e-03 3 1  ON 30
ci_032                -1.529398e-02 3 1  ON 31
ci_033                 6.113789e-03 3 1  ON 32
ci_034                 4.865692e-03 3 1  ON 33
ci_035                -5.027720e-03 3 1  ON 34
ci_036                -1.361829e-02 3 1  ON 35
ci_037                -1.365862e-02 3 1  ON 36
ci_038                 1.754438e-03 3 1  ON 37
ci_039                 2.204591e-03 3 1  ON 38
ci_040                -3.621013e-03 3 1  ON 39
ci_041                 8.676601e-03 3 1  ON 40
ci_042                 1.014107e-02 3 1  ON 41
ci_043                -3.707782e-03 3 1  ON 42
ci_044                -3.432874e-03 3 1  ON 43
ci_045                -2.744292e-03 3 1  ON 44
ci_046                 6.695902e-03 3 1  ON 45
ci_047                 5.938041e-03 3 1  ON 46
ci_048                -1.267908e-02 3 1  ON 47
ci_049                -1.306887e-02 3 1  ON 48
ci_050                 3.710748e-03 3 1  ON 49
ci_051                 4.036487e-03 3 1  ON 50
ci_052                -2.056736e-03 3 1  ON 51
ci_053                -2.921806e-03 3 1  ON 52
ci_054                -2.516725e-03 3 1  ON 53
ci_055                -2.944646e-03 3 1  ON 54
ci_056                 6.421356e-03 3 1  ON 55
ci_057                 7.001825e-03 3 1  ON 56
ci_058                -1.845110e-03 3 1  ON 57
ci_059                -2.346308e-03 3 1  ON 58
ci_060                 4.907253e-03 3 1  ON 59
ci_061                 2.638224e-03 3 1  ON 60
ci_062                -3.813037e-03 3 1  ON 61
ci_063                -3.986658e-03 3 1  ON 62
ci_064                -3.128725e-03 3 1  ON 63
ci_065                -3.996922e-03 3 1  ON 64
ci_066                 4.278357e-03 3 1  ON 65
ci_067                 4.762455e-03 3 1  ON 66
ci_068                -4.881484e-03 3 1  ON 67
ci_069                -4.972966e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.2426
    reference variance = 0.261737
====================================================
  Execution time = 1.3510e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.9172e-01
  Total weights = 1.9570e+06
  Execution time = 1.8514e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.065041
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276850761186
                                         uncertainty =       0.001497137965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276850761186
                                         uncertainty =       0.001497137965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372053974
  error estimate for blocks of size 2^( 2) =       0.000386139037
  error estimate for blocks of size 2^( 3) =       0.000398416718
  error estimate for blocks of size 2^( 4) =       0.000407443646
  error estimate for blocks of size 2^( 5) =       0.000412162412
  error estimate for blocks of size 2^( 6) =       0.000415156072
  error estimate for blocks of size 2^( 7) =       0.000416908079

      target function =      -0.775391439435
              le_mean =     -17.212756519258
             les_mean =     296.689665093880
             stat err =       0.000412917552
             autocorr =       1.231727943224
   target nu stat err =       0.000412917552
   target dn stat err =       0.065134938612
      target stat err =       0.061175304482
              std dev =       0.526163775519
             le_variance =       0.276848318669

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275772709424
                                         uncertainty =       0.001538864439

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275772709424
                                         uncertainty =       0.001538864439

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371334737
  error estimate for blocks of size 2^( 2) =       0.000385490147
  error estimate for blocks of size 2^( 3) =       0.000397819717
  error estimate for blocks of size 2^( 4) =       0.000406837785
  error estimate for blocks of size 2^( 5) =       0.000411657986
  error estimate for blocks of size 2^( 6) =       0.000414647277
  error estimate for blocks of size 2^( 7) =       0.000416336774

      target function =      -0.911486874138
              le_mean =     -17.212550384563
             les_mean =     296.563609752606
             stat err =       0.000412369955
             autocorr =       1.233226577321
   target nu stat err =       0.000412369955
   target dn stat err =       0.003274716370
      target stat err =       0.004262489888
              std dev =       0.525146621436
             le_variance =       0.275778974006

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0670677
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302262452769
                                         uncertainty =       0.020487717713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.302262452769
                                         uncertainty =       0.020487717713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000388737124
  error estimate for blocks of size 2^( 2) =       0.000402312300
  error estimate for blocks of size 2^( 3) =       0.000414218956
  error estimate for blocks of size 2^( 4) =       0.000422803482
  error estimate for blocks of size 2^( 5) =       0.000427169541
  error estimate for blocks of size 2^( 6) =       0.000430261670
  error estimate for blocks of size 2^( 7) =       0.000432523581

      target function =      -0.187790482265
              le_mean =     -17.212849871082
             les_mean =     298.262422512396
             stat err =       0.000428189568
             autocorr =       1.213277464747
   target nu stat err =       0.000428189568
   target dn stat err =       1.574666575460
      target stat err =       0.123467149291
              std dev =       0.549757312871
             le_variance =       0.302233103056

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275772152990
                                         uncertainty =       0.001538800898

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275772152990
                                         uncertainty =       0.001538800898

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371334360
  error estimate for blocks of size 2^( 2) =       0.000385489743
  error estimate for blocks of size 2^( 3) =       0.000397819300
  error estimate for blocks of size 2^( 4) =       0.000406837378
  error estimate for blocks of size 2^( 5) =       0.000411657584
  error estimate for blocks of size 2^( 6) =       0.000414646864
  error estimate for blocks of size 2^( 7) =       0.000416336370

      target function =      -0.911494059526
              le_mean =     -17.212550390203
             les_mean =     296.563604384771
             stat err =       0.000412369549
             autocorr =       1.233226651726
   target nu stat err =       0.000412369549
   target dn stat err =       0.003273660066
      target stat err =       0.004261207173
              std dev =       0.525146088139
             le_variance =       0.275778413888


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.775391439435        initial
     2.3283e-06     2.3283e-05             3.0757e-03        -0.911486874138
     9.3132e-06     9.3132e-05             3.0754e-03        -0.187790482265
     3.7253e-05     3.7253e-04             3.0740e-03        -0.911494059526  <--

*****************************************************************************
Applying the update for shift_i =   3.7253e-05     and shift_s =   3.7253e-04
*****************************************************************************

  Execution time = 2.2857e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
ci_001                -4.138697e-02 3 1  ON 0
ci_002                -3.139467e-02 3 1  ON 1
ci_003                -2.679661e-02 3 1  ON 2
ci_004                 2.428446e-02 3 1  ON 3
ci_005                 2.473960e-02 3 1  ON 4
ci_006                -2.088989e-02 3 1  ON 5
ci_007                -2.290331e-02 3 1  ON 6
ci_008                -9.543110e-03 3 1  ON 7
ci_009                -1.510369e-02 3 1  ON 8
ci_010                -1.053370e-02 3 1  ON 9
ci_011                -9.601043e-03 3 1  ON 10
ci_012                -1.097254e-02 3 1  ON 11
ci_013                -2.124128e-02 3 1  ON 12
ci_014                 1.289371e-02 3 1  ON 13
ci_015                 1.222102e-02 3 1  ON 14
ci_016                 1.729665e-02 3 1  ON 15
ci_017                 1.563517e-02 3 1  ON 16
ci_018                 1.048562e-02 3 1  ON 17
ci_019                 1.132258e-02 3 1  ON 18
ci_020                 1.843839e-02 3 1  ON 19
ci_021                 1.642177e-02 3 1  ON 20
ci_022                 9.737210e-03 3 1  ON 21
ci_023                 9.000511e-03 3 1  ON 22
ci_024                 1.039335e-02 3 1  ON 23
ci_025                 1.019181e-02 3 1  ON 24
ci_026                 1.230148e-02 3 1  ON 25
ci_027                 1.133682e-02 3 1  ON 26
ci_028                -1.437037e-02 3 1  ON 27
ci_029                -1.691821e-02 3 1  ON 28
ci_030                -9.514855e-03 3 1  ON 29
ci_031                -9.482664e-03 3 1  ON 30
ci_032                -1.529368e-02 3 1  ON 31
ci_033                 6.113688e-03 3 1  ON 32
ci_034                 4.866454e-03 3 1  ON 33
ci_035                -5.027763e-03 3 1  ON 34
ci_036                -1.361762e-02 3 1  ON 35
ci_037                -1.365784e-02 3 1  ON 36
ci_038                 1.754613e-03 3 1  ON 37
ci_039                 2.204811e-03 3 1  ON 38
ci_040                -3.620993e-03 3 1  ON 39
ci_041                 8.676544e-03 3 1  ON 40
ci_042                 1.014065e-02 3 1  ON 41
ci_043                -3.707848e-03 3 1  ON 42
ci_044                -3.433260e-03 3 1  ON 43
ci_045                -2.744494e-03 3 1  ON 44
ci_046                 6.695451e-03 3 1  ON 45
ci_047                 5.937936e-03 3 1  ON 46
ci_048                -1.267953e-02 3 1  ON 47
ci_049                -1.306879e-02 3 1  ON 48
ci_050                 3.710940e-03 3 1  ON 49
ci_051                 4.036030e-03 3 1  ON 50
ci_052                -2.056884e-03 3 1  ON 51
ci_053                -2.921791e-03 3 1  ON 52
ci_054                -2.516787e-03 3 1  ON 53
ci_055                -2.944593e-03 3 1  ON 54
ci_056                 6.420955e-03 3 1  ON 55
ci_057                 7.001463e-03 3 1  ON 56
ci_058                -1.844860e-03 3 1  ON 57
ci_059                -2.346465e-03 3 1  ON 58
ci_060                 4.907328e-03 3 1  ON 59
ci_061                 2.639310e-03 3 1  ON 60
ci_062                -3.812991e-03 3 1  ON 61
ci_063                -3.986605e-03 3 1  ON 62
ci_064                -3.128794e-03 3 1  ON 63
ci_065                -3.996804e-03 3 1  ON 64
ci_066                 4.278362e-03 3 1  ON 65
ci_067                 4.762546e-03 3 1  ON 66
ci_068                -4.881619e-03 3 1  ON 67
ci_069                -4.972701e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9472e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.2535
    reference variance = 0.351266
====================================================
  Execution time = 1.4092e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5253e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8870e-01
  Total weights = 1.957193569e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4889e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277197947247
                                         uncertainty =       0.001556782936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277197947247
                                         uncertainty =       0.001556782936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372247747
  error estimate for blocks of size 2^( 2) =       0.000385977069
  error estimate for blocks of size 2^( 3) =       0.000398520468
  error estimate for blocks of size 2^( 4) =       0.000407473265
  error estimate for blocks of size 2^( 5) =       0.000413366698
  error estimate for blocks of size 2^( 6) =       0.000416043759
  error estimate for blocks of size 2^( 7) =       0.000418620129

      target function =      -0.915087313938
              le_mean =     -17.211291940127
             les_mean =     296.517267694493
             stat err =       0.000413875963
             autocorr =       1.236164455169
   target nu stat err =       0.000413875963
   target dn stat err =       0.002259528477
      target stat err =       0.002988852351
              std dev =       0.526437812904
             le_variance =       0.277136770855


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721129194013e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-06, overlap shift 9.3132e-05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915096182795       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915746643460       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915869390134       residual = 7.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915910489448       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915917185580       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915918844520       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915920773135       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915920232667       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915920095106       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915919965026       residual = 5.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915919978358       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915919969651       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-06 is 2.037508e-03

solving harmonic davidson linear method for identity shift 3.7253e-05, overlap shift 3.7253e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915096182795       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915746414952       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915869108859       residual = 7.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915910185165       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915916876907       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915918534567       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915920461713       residual = 3.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915919921580       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915919784052       residual = 3.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915919654109       residual = 5.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915919667417       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915919658761       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-05 is 2.036763e-03

solving harmonic davidson linear method for identity shift 1.4901e-04, overlap shift 1.4901e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.915096182795       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.915745502523       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.915867985803       residual = 7.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.915908970316       residual = 1.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.915915644550       residual = 3.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.915917297109       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.915919218397       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.915918679597       residual = 9.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.915918542204       residual = 3.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.915918412809       residual = 5.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.915918426017       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.915918417568       residual = 3.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-04 is 2.033788e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.717764 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6599e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
ci_001                -4.206107e-02 3 1  ON 0
ci_002                -3.264381e-02 3 1  ON 1
ci_003                -2.677307e-02 3 1  ON 2
ci_004                 2.425720e-02 3 1  ON 3
ci_005                 2.478114e-02 3 1  ON 4
ci_006                -2.118992e-02 3 1  ON 5
ci_007                -2.173075e-02 3 1  ON 6
ci_008                -9.308830e-03 3 1  ON 7
ci_009                -1.476715e-02 3 1  ON 8
ci_010                -9.296904e-03 3 1  ON 9
ci_011                -9.706988e-03 3 1  ON 10
ci_012                -1.005364e-02 3 1  ON 11
ci_013                -2.005058e-02 3 1  ON 12
ci_014                 1.337496e-02 3 1  ON 13
ci_015                 1.168323e-02 3 1  ON 14
ci_016                 1.736360e-02 3 1  ON 15
ci_017                 1.691709e-02 3 1  ON 16
ci_018                 1.099787e-02 3 1  ON 17
ci_019                 1.064365e-02 3 1  ON 18
ci_020                 1.768849e-02 3 1  ON 19
ci_021                 1.688034e-02 3 1  ON 20
ci_022                 1.014844e-02 3 1  ON 21
ci_023                 9.789589e-03 3 1  ON 22
ci_024                 9.646856e-03 3 1  ON 23
ci_025                 1.109491e-02 3 1  ON 24
ci_026                 1.184936e-02 3 1  ON 25
ci_027                 1.137125e-02 3 1  ON 26
ci_028                -1.541461e-02 3 1  ON 27
ci_029                -1.679434e-02 3 1  ON 28
ci_030                -9.443822e-03 3 1  ON 29
ci_031                -9.208541e-03 3 1  ON 30
ci_032                -1.414836e-02 3 1  ON 31
ci_033                 4.257674e-03 3 1  ON 32
ci_034                 5.885235e-03 3 1  ON 33
ci_035                -4.877714e-03 3 1  ON 34
ci_036                -1.158085e-02 3 1  ON 35
ci_037                -1.368148e-02 3 1  ON 36
ci_038                 1.922283e-03 3 1  ON 37
ci_039                 1.820069e-03 3 1  ON 38
ci_040                -3.548139e-03 3 1  ON 39
ci_041                 1.049051e-02 3 1  ON 40
ci_042                 8.676980e-03 3 1  ON 41
ci_043                -4.221070e-03 3 1  ON 42
ci_044                -4.544821e-03 3 1  ON 43
ci_045                -3.452140e-03 3 1  ON 44
ci_046                 6.032281e-03 3 1  ON 45
ci_047                 5.943149e-03 3 1  ON 46
ci_048                -1.233973e-02 3 1  ON 47
ci_049                -1.409977e-02 3 1  ON 48
ci_050                 3.161848e-03 3 1  ON 49
ci_051                 3.010306e-03 3 1  ON 50
ci_052                -2.366066e-03 3 1  ON 51
ci_053                -3.130372e-03 3 1  ON 52
ci_054                -2.926132e-03 3 1  ON 53
ci_055                -2.325191e-03 3 1  ON 54
ci_056                 5.516498e-03 3 1  ON 55
ci_057                 6.391336e-03 3 1  ON 56
ci_058                -8.134097e-04 3 1  ON 57
ci_059                -1.705910e-03 3 1  ON 58
ci_060                 4.929803e-03 3 1  ON 59
ci_061                 4.119827e-03 3 1  ON 60
ci_062                -3.805617e-03 3 1  ON 61
ci_063                -3.526525e-03 3 1  ON 62
ci_064                -2.769895e-03 3 1  ON 63
ci_065                -4.199050e-03 3 1  ON 64
ci_066                 4.061069e-03 3 1  ON 65
ci_067                 5.302862e-03 3 1  ON 66
ci_068                -6.197308e-03 3 1  ON 67
ci_069                -4.976382e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.2316
    reference variance = 0.184462
====================================================
  Execution time = 1.3552e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8609e-01
  Total weights = 1.9571e+06
  Execution time = 1.8577e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274644201685
                                         uncertainty =       0.001610287013

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274644201685
                                         uncertainty =       0.001610287013

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370570417
  error estimate for blocks of size 2^( 2) =       0.000384602825
  error estimate for blocks of size 2^( 3) =       0.000396431947
  error estimate for blocks of size 2^( 4) =       0.000405102212
  error estimate for blocks of size 2^( 5) =       0.000410601717
  error estimate for blocks of size 2^( 6) =       0.000412668256
  error estimate for blocks of size 2^( 7) =       0.000412863739

      target function =      -0.803736495455
              le_mean =     -17.211818723015
             les_mean =     296.627635581975
             stat err =       0.000410308981
             autocorr =       1.225972004400
   target nu stat err =       0.000410308981
   target dn stat err =       0.066489798728
      target stat err =       0.067047897130
              std dev =       0.524065709864
             le_variance =       0.274644868256

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273828813741
                                         uncertainty =       0.001488839752

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273828813741
                                         uncertainty =       0.001488839752

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370019098
  error estimate for blocks of size 2^( 2) =       0.000384122971
  error estimate for blocks of size 2^( 3) =       0.000396011834
  error estimate for blocks of size 2^( 4) =       0.000404644012
  error estimate for blocks of size 2^( 5) =       0.000410172457
  error estimate for blocks of size 2^( 6) =       0.000412262895
  error estimate for blocks of size 2^( 7) =       0.000412549871

      target function =      -0.918574974215
              le_mean =     -17.211722788350
             les_mean =     296.529505295840
             stat err =       0.000409907309
             autocorr =       1.227221750627
   target nu stat err =       0.000409907309
   target dn stat err =       0.002516023502
      target stat err =       0.003341885325
              std dev =       0.523286026532
             le_variance =       0.273828265564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277045964301
                                         uncertainty =       0.002016135940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277045964301
                                         uncertainty =       0.002016135940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372181965
  error estimate for blocks of size 2^( 2) =       0.000386322990
  error estimate for blocks of size 2^( 3) =       0.000398235477
  error estimate for blocks of size 2^( 4) =       0.000406824963
  error estimate for blocks of size 2^( 5) =       0.000412389831
  error estimate for blocks of size 2^( 6) =       0.000414500589
  error estimate for blocks of size 2^( 7) =       0.000414893775

      target function =      -0.757342458625
              le_mean =     -17.211784216752
             les_mean =     296.669445354645
             stat err =       0.000412152289
             autocorr =       1.226322748200
   target nu stat err =       0.000412152289
   target dn stat err =       0.099251832077
      target stat err =       0.089474692391
              std dev =       0.526344782374
             le_variance =       0.277038829932

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273827564283
                                         uncertainty =       0.001488820180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273827564283
                                         uncertainty =       0.001488820180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370018255
  error estimate for blocks of size 2^( 2) =       0.000384122026
  error estimate for blocks of size 2^( 3) =       0.000396010800
  error estimate for blocks of size 2^( 4) =       0.000404642970
  error estimate for blocks of size 2^( 5) =       0.000410171274
  error estimate for blocks of size 2^( 6) =       0.000412261666
  error estimate for blocks of size 2^( 7) =       0.000412548430

      target function =      -0.918648806867
              le_mean =     -17.211722809584
             les_mean =     296.529449800668
             stat err =       0.000409906085
             autocorr =       1.227220011415
   target nu stat err =       0.000409906085
   target dn stat err =       0.002484992083
      target stat err =       0.003302454048
              std dev =       0.523284835034
             le_variance =       0.273827018576


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.803736495455        initial
     9.3132e-06     9.3132e-05             2.0375e-03        -0.918574974215
     3.7253e-05     3.7253e-04             2.0368e-03        -0.757342458625
     1.4901e-04     1.4901e-03             2.0338e-03        -0.918648806867  <--

*****************************************************************************
Applying the update for shift_i =   1.4901e-04     and shift_s =   1.4901e-03
*****************************************************************************

  Execution time = 2.6977e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
ci_001                -4.205973e-02 3 1  ON 0
ci_002                -3.264162e-02 3 1  ON 1
ci_003                -2.677352e-02 3 1  ON 2
ci_004                 2.425732e-02 3 1  ON 3
ci_005                 2.478111e-02 3 1  ON 4
ci_006                -2.118956e-02 3 1  ON 5
ci_007                -2.173296e-02 3 1  ON 6
ci_008                -9.309234e-03 3 1  ON 7
ci_009                -1.476765e-02 3 1  ON 8
ci_010                -9.298883e-03 3 1  ON 9
ci_011                -9.706837e-03 3 1  ON 10
ci_012                -1.005511e-02 3 1  ON 11
ci_013                -2.005289e-02 3 1  ON 12
ci_014                 1.337410e-02 3 1  ON 13
ci_015                 1.168405e-02 3 1  ON 14
ci_016                 1.736345e-02 3 1  ON 15
ci_017                 1.691480e-02 3 1  ON 16
ci_018                 1.099709e-02 3 1  ON 17
ci_019                 1.064476e-02 3 1  ON 18
ci_020                 1.768997e-02 3 1  ON 19
ci_021                 1.687954e-02 3 1  ON 20
ci_022                 1.014786e-02 3 1  ON 21
ci_023                 9.788309e-03 3 1  ON 22
ci_024                 9.648141e-03 3 1  ON 23
ci_025                 1.109347e-02 3 1  ON 24
ci_026                 1.185006e-02 3 1  ON 25
ci_027                 1.137123e-02 3 1  ON 26
ci_028                -1.541243e-02 3 1  ON 27
ci_029                -1.679468e-02 3 1  ON 28
ci_030                -9.444034e-03 3 1  ON 29
ci_031                -9.208756e-03 3 1  ON 30
ci_032                -1.415028e-02 3 1  ON 31
ci_033                 4.260744e-03 3 1  ON 32
ci_034                 5.883575e-03 3 1  ON 33
ci_035                -4.877932e-03 3 1  ON 34
ci_036                -1.158383e-02 3 1  ON 35
ci_037                -1.368158e-02 3 1  ON 36
ci_038                 1.922042e-03 3 1  ON 37
ci_039                 1.820628e-03 3 1  ON 38
ci_040                -3.548240e-03 3 1  ON 39
ci_041                 1.048769e-02 3 1  ON 40
ci_042                 8.679127e-03 3 1  ON 41
ci_043                -4.220288e-03 3 1  ON 42
ci_044                -4.543077e-03 3 1  ON 43
ci_045                -3.451134e-03 3 1  ON 44
ci_046                 6.033363e-03 3 1  ON 45
ci_047                 5.943137e-03 3 1  ON 46
ci_048                -1.234031e-02 3 1  ON 47
ci_049                -1.409799e-02 3 1  ON 48
ci_050                 3.162571e-03 3 1  ON 49
ci_051                 3.011695e-03 3 1  ON 50
ci_052                -2.365669e-03 3 1  ON 51
ci_053                -3.130101e-03 3 1  ON 52
ci_054                -2.925520e-03 3 1  ON 53
ci_055                -2.326132e-03 3 1  ON 54
ci_056                 5.517846e-03 3 1  ON 55
ci_057                 6.392280e-03 3 1  ON 56
ci_058                -8.148401e-04 3 1  ON 57
ci_059                -1.706878e-03 3 1  ON 58
ci_060                 4.929769e-03 3 1  ON 59
ci_061                 4.117390e-03 3 1  ON 60
ci_062                -3.805676e-03 3 1  ON 61
ci_063                -3.527158e-03 3 1  ON 62
ci_064                -2.770404e-03 3 1  ON 63
ci_065                -4.198756e-03 3 1  ON 64
ci_066                 4.061299e-03 3 1  ON 65
ci_067                 5.302087e-03 3 1  ON 66
ci_068                -6.195200e-03 3 1  ON 67
ci_069                -4.976405e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3587e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.2712
    reference variance = 0.18437
====================================================
  Execution time = 1.4125e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.9353e-01
  Total weights = 1.957126947e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5176e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280315308402
                                         uncertainty =       0.001975982981

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280315308402
                                         uncertainty =       0.001975982981

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374421449
  error estimate for blocks of size 2^( 2) =       0.000387850250
  error estimate for blocks of size 2^( 3) =       0.000400192224
  error estimate for blocks of size 2^( 4) =       0.000408433095
  error estimate for blocks of size 2^( 5) =       0.000413209096
  error estimate for blocks of size 2^( 6) =       0.000415225234
  error estimate for blocks of size 2^( 7) =       0.000416030866

      target function =      -0.908846628720
              le_mean =     -17.211220136641
             les_mean =     296.519624377904
             stat err =       0.000413224573
             autocorr =       1.218009955881
   target nu stat err =       0.000413224573
   target dn stat err =       0.002613453136
      target stat err =       0.003393555331
              std dev =       0.529511891870
             le_variance =       0.280382843632


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721122013664e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e-05, overlap shift 3.7253e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908858548816       residual = 2.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910086059679       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910191577327       residual = 6.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910224109965       residual = 9.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910230987082       residual = 3.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910232977776       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910232697364       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910232660718       residual = 4.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910232709088       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910232707776       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910232778466       residual = 7.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-05 is 3.240478e-03

solving harmonic davidson linear method for identity shift 1.4901e-04, overlap shift 1.4901e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908858548816       residual = 2.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910084307750       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910189634654       residual = 6.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910222091405       residual = 9.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910228949679       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910230934398       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910230654294       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910230617315       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910230665586       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910230664242       residual = 3.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910230734679       residual = 7.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-04 is 3.235747e-03

solving harmonic davidson linear method for identity shift 5.9605e-04, overlap shift 5.9605e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.908858548816       residual = 2.46e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.910077349681       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.910181920254       residual = 6.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.910214076675       residual = 9.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.910220860480       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.910222821622       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.910222542758       residual = 2.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.910222504482       residual = 4.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.910222552355       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.910222550888       residual = 3.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.910222620327       residual = 6.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e-04 is 3.216963e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.722001 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6654e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
ci_001                -4.182302e-02 3 1  ON 0
ci_002                -3.306667e-02 3 1  ON 1
ci_003                -2.524525e-02 3 1  ON 2
ci_004                 2.330677e-02 3 1  ON 3
ci_005                 2.466025e-02 3 1  ON 4
ci_006                -2.197501e-02 3 1  ON 5
ci_007                -2.123878e-02 3 1  ON 6
ci_008                -9.477639e-03 3 1  ON 7
ci_009                -1.449391e-02 3 1  ON 8
ci_010                -6.923756e-03 3 1  ON 9
ci_011                -9.860455e-03 3 1  ON 10
ci_012                -1.135328e-02 3 1  ON 11
ci_013                -1.987787e-02 3 1  ON 12
ci_014                 1.320369e-02 3 1  ON 13
ci_015                 1.331054e-02 3 1  ON 14
ci_016                 1.642004e-02 3 1  ON 15
ci_017                 1.695168e-02 3 1  ON 16
ci_018                 1.191506e-02 3 1  ON 17
ci_019                 1.201976e-02 3 1  ON 18
ci_020                 1.662302e-02 3 1  ON 19
ci_021                 1.874152e-02 3 1  ON 20
ci_022                 9.331259e-03 3 1  ON 21
ci_023                 9.744807e-03 3 1  ON 22
ci_024                 8.336396e-03 3 1  ON 23
ci_025                 1.087858e-02 3 1  ON 24
ci_026                 1.266278e-02 3 1  ON 25
ci_027                 1.117313e-02 3 1  ON 26
ci_028                -1.617320e-02 3 1  ON 27
ci_029                -1.611830e-02 3 1  ON 28
ci_030                -1.026217e-02 3 1  ON 29
ci_031                -9.449477e-03 3 1  ON 30
ci_032                -1.452098e-02 3 1  ON 31
ci_033                 5.471923e-03 3 1  ON 32
ci_034                 4.480802e-03 3 1  ON 33
ci_035                -5.181298e-03 3 1  ON 34
ci_036                -1.456143e-02 3 1  ON 35
ci_037                -1.308649e-02 3 1  ON 36
ci_038                 1.861208e-03 3 1  ON 37
ci_039                 2.409640e-03 3 1  ON 38
ci_040                -3.502372e-03 3 1  ON 39
ci_041                 7.251947e-03 3 1  ON 40
ci_042                 8.647233e-03 3 1  ON 41
ci_043                -4.243330e-03 3 1  ON 42
ci_044                -5.373705e-03 3 1  ON 43
ci_045                -3.092698e-03 3 1  ON 44
ci_046                 5.917981e-03 3 1  ON 45
ci_047                 5.911801e-03 3 1  ON 46
ci_048                -1.254971e-02 3 1  ON 47
ci_049                -1.258720e-02 3 1  ON 48
ci_050                 3.535345e-03 3 1  ON 49
ci_051                 3.841451e-03 3 1  ON 50
ci_052                -2.087735e-03 3 1  ON 51
ci_053                -2.831530e-03 3 1  ON 52
ci_054                -2.807974e-03 3 1  ON 53
ci_055                -3.811262e-03 3 1  ON 54
ci_056                 5.713962e-03 3 1  ON 55
ci_057                 5.317803e-03 3 1  ON 56
ci_058                -1.931818e-03 3 1  ON 57
ci_059                -1.893782e-03 3 1  ON 58
ci_060                 4.125301e-03 3 1  ON 59
ci_061                 6.424457e-03 3 1  ON 60
ci_062                -5.168877e-03 3 1  ON 61
ci_063                -4.320065e-03 3 1  ON 62
ci_064                -3.000258e-03 3 1  ON 63
ci_065                -4.436807e-03 3 1  ON 64
ci_066                 4.115616e-03 3 1  ON 65
ci_067                 5.211368e-03 3 1  ON 66
ci_068                -6.096962e-03 3 1  ON 67
ci_069                -5.685720e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.0541
    reference variance = 0.414719
====================================================
  Execution time = 1.3655e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8860e-01
  Total weights = 1.9569e+06
  Execution time = 1.8645e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278996726924
                                         uncertainty =       0.001867875843

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278996726924
                                         uncertainty =       0.001867875843

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373467454
  error estimate for blocks of size 2^( 2) =       0.000387163678
  error estimate for blocks of size 2^( 3) =       0.000399818704
  error estimate for blocks of size 2^( 4) =       0.000409198139
  error estimate for blocks of size 2^( 5) =       0.000415741248
  error estimate for blocks of size 2^( 6) =       0.000417573786
  error estimate for blocks of size 2^( 7) =       0.000419151031

      target function =      -0.821158448871
              le_mean =     -17.212504013772
             les_mean =     296.635730094347
             stat err =       0.000415416051
             autocorr =       1.237260147087
   target nu stat err =       0.000415416051
   target dn stat err =       0.056308608026
      target stat err =       0.059229858238
              std dev =       0.528162738407
             le_variance =       0.278955878242

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277916142412
                                         uncertainty =       0.001784024227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277916142412
                                         uncertainty =       0.001784024227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372742387
  error estimate for blocks of size 2^( 2) =       0.000386442666
  error estimate for blocks of size 2^( 3) =       0.000399032240
  error estimate for blocks of size 2^( 4) =       0.000408372208
  error estimate for blocks of size 2^( 5) =       0.000414884666
  error estimate for blocks of size 2^( 6) =       0.000416789283
  error estimate for blocks of size 2^( 7) =       0.000418298855

      target function =      -0.915477800990
              le_mean =     -17.212329095776
             les_mean =     296.552874881265
             stat err =       0.000414586253
             autocorr =       1.237121145442
   target nu stat err =       0.000414586253
   target dn stat err =       0.002200971035
      target stat err =       0.002921748884
              std dev =       0.527137339548
             le_variance =       0.277873774746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285729100381
                                         uncertainty =       0.005047668266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285729100381
                                         uncertainty =       0.005047668266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377948743
  error estimate for blocks of size 2^( 2) =       0.000391532938
  error estimate for blocks of size 2^( 3) =       0.000403974230
  error estimate for blocks of size 2^( 4) =       0.000413262971
  error estimate for blocks of size 2^( 5) =       0.000419655087
  error estimate for blocks of size 2^( 6) =       0.000421899864
  error estimate for blocks of size 2^( 7) =       0.000423485954

      target function =      -0.216322404505
              le_mean =     -17.212517736753
             les_mean =     297.957943529416
             stat err =       0.000419575969
             autocorr =       1.232410532552
   target nu stat err =       0.000419575969
   target dn stat err =       1.357950378960
      target stat err =       0.139722901965
              std dev =       0.534500238664
             le_variance =       0.285690505132

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277910132114
                                         uncertainty =       0.001784494457

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277910132114
                                         uncertainty =       0.001784494457

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372738373
  error estimate for blocks of size 2^( 2) =       0.000386438759
  error estimate for blocks of size 2^( 3) =       0.000399028835
  error estimate for blocks of size 2^( 4) =       0.000408369078
  error estimate for blocks of size 2^( 5) =       0.000414881818
  error estimate for blocks of size 2^( 6) =       0.000416785664
  error estimate for blocks of size 2^( 7) =       0.000418295058

      target function =      -0.915460550386
              le_mean =     -17.212329115274
             les_mean =     296.552888809521
             stat err =       0.000414582904
             autocorr =       1.237127807040
   target nu stat err =       0.000414582904
   target dn stat err =       0.002203285769
      target stat err =       0.002924588113
              std dev =       0.527131662407
             le_variance =       0.277867789512


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.821158448871        initial
     3.7253e-05     3.7253e-04             3.2405e-03        -0.915477800990  <--
     1.4901e-04     1.4901e-03             3.2357e-03        -0.216322404505
     5.9605e-04     5.9605e-03             3.2170e-03        -0.915460550386

*****************************************************************************
Applying the update for shift_i =   3.7253e-05     and shift_s =   3.7253e-04
*****************************************************************************

  Execution time = 2.3071e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
ci_001                -4.182261e-02 3 1  ON 0
ci_002                -3.306748e-02 3 1  ON 1
ci_003                -2.524308e-02 3 1  ON 2
ci_004                 2.330516e-02 3 1  ON 3
ci_005                 2.465999e-02 3 1  ON 4
ci_006                -2.197653e-02 3 1  ON 5
ci_007                -2.123789e-02 3 1  ON 6
ci_008                -9.477915e-03 3 1  ON 7
ci_009                -1.449353e-02 3 1  ON 8
ci_010                -6.920001e-03 3 1  ON 9
ci_011                -9.860728e-03 3 1  ON 10
ci_012                -1.135535e-02 3 1  ON 11
ci_013                -1.987745e-02 3 1  ON 12
ci_014                 1.320336e-02 3 1  ON 13
ci_015                 1.331318e-02 3 1  ON 14
ci_016                 1.641832e-02 3 1  ON 15
ci_017                 1.695169e-02 3 1  ON 16
ci_018                 1.191676e-02 3 1  ON 17
ci_019                 1.202166e-02 3 1  ON 18
ci_020                 1.662141e-02 3 1  ON 19
ci_021                 1.874512e-02 3 1  ON 20
ci_022                 9.329886e-03 3 1  ON 21
ci_023                 9.744770e-03 3 1  ON 22
ci_024                 8.334207e-03 3 1  ON 23
ci_025                 1.087829e-02 3 1  ON 24
ci_026                 1.266384e-02 3 1  ON 25
ci_027                 1.117284e-02 3 1  ON 26
ci_028                -1.617389e-02 3 1  ON 27
ci_029                -1.611702e-02 3 1  ON 28
ci_030                -1.026357e-02 3 1  ON 29
ci_031                -9.449548e-03 3 1  ON 30
ci_032                -1.452162e-02 3 1  ON 31
ci_033                 5.473944e-03 3 1  ON 32
ci_034                 4.478421e-03 3 1  ON 33
ci_035                -5.181760e-03 3 1  ON 34
ci_036                -1.456560e-02 3 1  ON 35
ci_037                -1.308559e-02 3 1  ON 36
ci_038                 1.861126e-03 3 1  ON 37
ci_039                 2.410492e-03 3 1  ON 38
ci_040                -3.502306e-03 3 1  ON 39
ci_041                 7.247216e-03 3 1  ON 40
ci_042                 8.647074e-03 3 1  ON 41
ci_043                -4.243366e-03 3 1  ON 42
ci_044                -5.374985e-03 3 1  ON 43
ci_045                -3.092183e-03 3 1  ON 44
ci_046                 5.917784e-03 3 1  ON 45
ci_047                 5.911730e-03 3 1  ON 46
ci_048                -1.255024e-02 3 1  ON 47
ci_049                -1.258438e-02 3 1  ON 48
ci_050                 3.535864e-03 3 1  ON 49
ci_051                 3.842616e-03 3 1  ON 50
ci_052                -2.087358e-03 3 1  ON 51
ci_053                -2.831176e-03 3 1  ON 52
ci_054                -2.807864e-03 3 1  ON 53
ci_055                -3.813645e-03 3 1  ON 54
ci_056                 5.714247e-03 3 1  ON 55
ci_057                 5.316169e-03 3 1  ON 56
ci_058                -1.933314e-03 3 1  ON 57
ci_059                -1.894070e-03 3 1  ON 58
ci_060                 4.124009e-03 3 1  ON 59
ci_061                 6.428317e-03 3 1  ON 60
ci_062                -5.170885e-03 3 1  ON 61
ci_063                -4.321295e-03 3 1  ON 62
ci_064                -3.000588e-03 3 1  ON 63
ci_065                -4.437151e-03 3 1  ON 64
ci_066                 4.115648e-03 3 1  ON 65
ci_067                 5.211308e-03 3 1  ON 66
ci_068                -6.096732e-03 3 1  ON 67
ci_069                -5.686904e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9730e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.2704
    reference variance = 0.157926
====================================================
  Execution time = 1.3954e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9156e-01
  Total weights = 1.957013699e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4888e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279128576576
                                         uncertainty =       0.002207118972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279128576576
                                         uncertainty =       0.002207118972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373583595
  error estimate for blocks of size 2^( 2) =       0.000387642209
  error estimate for blocks of size 2^( 3) =       0.000400250045
  error estimate for blocks of size 2^( 4) =       0.000409850556
  error estimate for blocks of size 2^( 5) =       0.000415418813
  error estimate for blocks of size 2^( 6) =       0.000417351533
  error estimate for blocks of size 2^( 7) =       0.000419264732

      target function =      -0.911484120489
              le_mean =     -17.211734286227
             les_mean =     296.535358307424
             stat err =       0.000415471408
             autocorr =       1.236820541051
   target nu stat err =       0.000415471408
   target dn stat err =       0.003586597750
      target stat err =       0.004655813459
              std dev =       0.528326987274
             le_variance =       0.279129405482


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721173428623e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e-06, overlap shift 9.3132e-05 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911507028864       residual = 3.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912957068239       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913119825314       residual = 9.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913168809718       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913172950047       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913175362552       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913173778581       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913173722059       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913174026246       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913174283598       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913174313538       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913174345946       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e-06 is 3.398233e-03

solving harmonic davidson linear method for identity shift 3.7253e-05, overlap shift 3.7253e-04 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911507028864       residual = 3.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912956554468       residual = 3.81e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913119242299       residual = 9.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913168200431       residual = 1.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913172337657       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913174748412       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913173165227       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913173108792       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913173412772       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913173669906       residual = 6.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913173699811       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913173732176       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e-05 is 3.396873e-03

solving harmonic davidson linear method for identity shift 1.4901e-04, overlap shift 1.4901e-03 and omega -1.7857e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.911507028864       residual = 3.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.912954503014       residual = 3.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913116914446       residual = 9.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913165767753       residual = 1.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913169892605       residual = 4.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913172296383       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913170716335       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913170660244       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913170963404       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913171219665       residual = 5.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913171249433       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913171281624       residual = 4.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e-04 is 3.391442e-03

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.726803 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6453e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
ci_001                -4.212651e-02 3 1  ON 0
ci_002                -3.221188e-02 3 1  ON 1
ci_003                -2.669642e-02 3 1  ON 2
ci_004                 2.372313e-02 3 1  ON 3
ci_005                 2.418920e-02 3 1  ON 4
ci_006                -2.169824e-02 3 1  ON 5
ci_007                -2.128435e-02 3 1  ON 6
ci_008                -8.417311e-03 3 1  ON 7
ci_009                -1.341422e-02 3 1  ON 8
ci_010                -1.031687e-02 3 1  ON 9
ci_011                -1.174556e-02 3 1  ON 10
ci_012                -9.693176e-03 3 1  ON 11
ci_013                -2.001183e-02 3 1  ON 12
ci_014                 1.230090e-02 3 1  ON 13
ci_015                 1.170894e-02 3 1  ON 14
ci_016                 1.784514e-02 3 1  ON 15
ci_017                 1.649004e-02 3 1  ON 16
ci_018                 1.015977e-02 3 1  ON 17
ci_019                 9.900079e-03 3 1  ON 18
ci_020                 1.816755e-02 3 1  ON 19
ci_021                 1.782115e-02 3 1  ON 20
ci_022                 9.125929e-03 3 1  ON 21
ci_023                 9.242628e-03 3 1  ON 22
ci_024                 9.825850e-03 3 1  ON 23
ci_025                 1.057603e-02 3 1  ON 24
ci_026                 1.184592e-02 3 1  ON 25
ci_027                 1.200580e-02 3 1  ON 26
ci_028                -1.458024e-02 3 1  ON 27
ci_029                -1.701515e-02 3 1  ON 28
ci_030                -9.740573e-03 3 1  ON 29
ci_031                -8.980540e-03 3 1  ON 30
ci_032                -1.471112e-02 3 1  ON 31
ci_033                 4.972968e-03 3 1  ON 32
ci_034                 5.670374e-03 3 1  ON 33
ci_035                -5.195624e-03 3 1  ON 34
ci_036                -1.284742e-02 3 1  ON 35
ci_037                -1.218634e-02 3 1  ON 36
ci_038                 2.305244e-03 3 1  ON 37
ci_039                 1.646924e-03 3 1  ON 38
ci_040                -3.327187e-03 3 1  ON 39
ci_041                 1.004309e-02 3 1  ON 40
ci_042                 8.048807e-03 3 1  ON 41
ci_043                -4.251925e-03 3 1  ON 42
ci_044                -3.830766e-03 3 1  ON 43
ci_045                -3.738945e-03 3 1  ON 44
ci_046                 5.711095e-03 3 1  ON 45
ci_047                 5.510585e-03 3 1  ON 46
ci_048                -1.239664e-02 3 1  ON 47
ci_049                -1.479523e-02 3 1  ON 48
ci_050                 2.961243e-03 3 1  ON 49
ci_051                 2.667900e-03 3 1  ON 50
ci_052                -2.343813e-03 3 1  ON 51
ci_053                -2.469101e-03 3 1  ON 52
ci_054                -3.586714e-03 3 1  ON 53
ci_055                -2.942799e-03 3 1  ON 54
ci_056                 5.745376e-03 3 1  ON 55
ci_057                 5.207566e-03 3 1  ON 56
ci_058                -6.732553e-04 3 1  ON 57
ci_059                -2.451592e-03 3 1  ON 58
ci_060                 4.513445e-03 3 1  ON 59
ci_061                 5.751421e-03 3 1  ON 60
ci_062                -3.641464e-03 3 1  ON 61
ci_063                -4.089762e-03 3 1  ON 62
ci_064                -2.341431e-03 3 1  ON 63
ci_065                -4.351623e-03 3 1  ON 64
ci_066                 4.445647e-03 3 1  ON 65
ci_067                 4.371194e-03 3 1  ON 66
ci_068                -4.111415e-03 3 1  ON 67
ci_069                -4.948327e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.1855
    reference variance = 0.725808
====================================================
  Execution time = 1.3879e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.9040e-01
  Total weights = 1.9571e+06
  Execution time = 1.8565e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281732884724
                                         uncertainty =       0.002790133006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281732884724
                                         uncertainty =       0.002790133006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375291065
  error estimate for blocks of size 2^( 2) =       0.000388710896
  error estimate for blocks of size 2^( 3) =       0.000400609706
  error estimate for blocks of size 2^( 4) =       0.000409190344
  error estimate for blocks of size 2^( 5) =       0.000414229789
  error estimate for blocks of size 2^( 6) =       0.000417271388
  error estimate for blocks of size 2^( 7) =       0.000418157613

      target function =      -0.603009671832
              le_mean =     -17.211253851321
             les_mean =     296.845670411941
             stat err =       0.000414712284
             autocorr =       1.221117200212
   target nu stat err =       0.000414712284
   target dn stat err =       0.191647359555
      target stat err =       0.111627896650
              std dev =       0.530741714242
             le_variance =       0.281686767236

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278572441978
                                         uncertainty =       0.002049252485

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278572441978
                                         uncertainty =       0.002049252485

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373185529
  error estimate for blocks of size 2^( 2) =       0.000386849824
  error estimate for blocks of size 2^( 3) =       0.000399013526
  error estimate for blocks of size 2^( 4) =       0.000407766931
  error estimate for blocks of size 2^( 5) =       0.000412812093
  error estimate for blocks of size 2^( 6) =       0.000415933437
  error estimate for blocks of size 2^( 7) =       0.000417079406

      target function =      -0.912829520060
              le_mean =     -17.211110956499
             les_mean =     296.512745029629
             stat err =       0.000413397967
             autocorr =       1.227120136282
   target nu stat err =       0.000413397967
   target dn stat err =       0.002592866082
      target stat err =       0.003396218557
              std dev =       0.527764036703
             le_variance =       0.278534878437

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281511411464
                                         uncertainty =       0.002038603290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281511411464
                                         uncertainty =       0.002038603290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375147816
  error estimate for blocks of size 2^( 2) =       0.000388986045
  error estimate for blocks of size 2^( 3) =       0.000401340860
  error estimate for blocks of size 2^( 4) =       0.000410218203
  error estimate for blocks of size 2^( 5) =       0.000415326382
  error estimate for blocks of size 2^( 6) =       0.000418409609
  error estimate for blocks of size 2^( 7) =       0.000419615235

      target function =      -0.889167532115
              le_mean =     -17.211330658169
             les_mean =     296.539120213979
             stat err =       0.000415892357
             autocorr =       1.229014578143
   target nu stat err =       0.000415892357
   target dn stat err =       0.006624599067
      target stat err =       0.008133834562
              std dev =       0.530539129315
             le_variance =       0.281471767734

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278570655426
                                         uncertainty =       0.002049281409

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278570655426
                                         uncertainty =       0.002049281409

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373184333
  error estimate for blocks of size 2^( 2) =       0.000386848309
  error estimate for blocks of size 2^( 3) =       0.000399011663
  error estimate for blocks of size 2^( 4) =       0.000407764827
  error estimate for blocks of size 2^( 5) =       0.000412809840
  error estimate for blocks of size 2^( 6) =       0.000415931252
  error estimate for blocks of size 2^( 7) =       0.000417077089

      target function =      -0.912845814472
              le_mean =     -17.211110899106
             les_mean =     296.512730418750
             stat err =       0.000413395752
             autocorr =       1.227114854227
   target nu stat err =       0.000413395752
   target dn stat err =       0.002592260455
      target stat err =       0.003395567340
              std dev =       0.527762344881
             le_variance =       0.278533092674


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.603009671832        initial
     9.3132e-06     9.3132e-05             3.3982e-03        -0.912829520060
     3.7253e-05     3.7253e-04             3.3969e-03        -0.889167532115
     1.4901e-04     1.4901e-03             3.3914e-03        -0.912845814472  <--

*****************************************************************************
Applying the update for shift_i =   1.4901e-04     and shift_s =   1.4901e-03
*****************************************************************************

  Execution time = 2.3251e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
ci_001                -4.212608e-02 3 1  ON 0
ci_002                -3.221336e-02 3 1  ON 1
ci_003                -2.669444e-02 3 1  ON 2
ci_004                 2.372250e-02 3 1  ON 3
ci_005                 2.418998e-02 3 1  ON 4
ci_006                -2.169873e-02 3 1  ON 5
ci_007                -2.128426e-02 3 1  ON 6
ci_008                -8.418824e-03 3 1  ON 7
ci_009                -1.341580e-02 3 1  ON 8
ci_010                -1.031144e-02 3 1  ON 9
ci_011                -1.174258e-02 3 1  ON 10
ci_012                -9.695714e-03 3 1  ON 11
ci_013                -2.001159e-02 3 1  ON 12
ci_014                 1.230248e-02 3 1  ON 13
ci_015                 1.171147e-02 3 1  ON 14
ci_016                 1.784253e-02 3 1  ON 15
ci_017                 1.649079e-02 3 1  ON 16
ci_018                 1.016251e-02 3 1  ON 17
ci_019                 9.903030e-03 3 1  ON 18
ci_020                 1.816524e-02 3 1  ON 19
ci_021                 1.782310e-02 3 1  ON 20
ci_022                 9.126136e-03 3 1  ON 21
ci_023                 9.243422e-03 3 1  ON 22
ci_024                 9.823346e-03 3 1  ON 23
ci_025                 1.057661e-02 3 1  ON 24
ci_026                 1.184707e-02 3 1  ON 25
ci_027                 1.200461e-02 3 1  ON 26
ci_028                -1.458249e-02 3 1  ON 27
ci_029                -1.701364e-02 3 1  ON 28
ci_030                -9.741458e-03 3 1  ON 29
ci_031                -8.980779e-03 3 1  ON 30
ci_032                -1.471083e-02 3 1  ON 31
ci_033                 4.973775e-03 3 1  ON 32
ci_034                 5.668263e-03 3 1  ON 33
ci_035                -5.195607e-03 3 1  ON 34
ci_036                -1.284991e-02 3 1  ON 35
ci_037                -1.218763e-02 3 1  ON 36
ci_038                 2.304593e-03 3 1  ON 37
ci_039                 1.648034e-03 3 1  ON 38
ci_040                -3.327433e-03 3 1  ON 39
ci_041                 1.003916e-02 3 1  ON 40
ci_042                 8.049514e-03 3 1  ON 41
ci_043                -4.251907e-03 3 1  ON 42
ci_044                -3.833167e-03 3 1  ON 43
ci_045                -3.738024e-03 3 1  ON 44
ci_046                 5.711418e-03 3 1  ON 45
ci_047                 5.511229e-03 3 1  ON 46
ci_048                -1.239695e-02 3 1  ON 47
ci_049                -1.479125e-02 3 1  ON 48
ci_050                 2.962009e-03 3 1  ON 49
ci_051                 2.669475e-03 3 1  ON 50
ci_052                -2.343401e-03 3 1  ON 51
ci_053                -2.469623e-03 3 1  ON 52
ci_054                -3.585619e-03 3 1  ON 53
ci_055                -2.944186e-03 3 1  ON 54
ci_056                 5.745331e-03 3 1  ON 55
ci_057                 5.207685e-03 3 1  ON 56
ci_058                -6.749025e-04 3 1  ON 57
ci_059                -2.450672e-03 3 1  ON 58
ci_060                 4.512822e-03 3 1  ON 59
ci_061                 5.752571e-03 3 1  ON 60
ci_062                -3.643719e-03 3 1  ON 61
ci_063                -4.090136e-03 3 1  ON 62
ci_064                -2.342356e-03 3 1  ON 63
ci_065                -4.351750e-03 3 1  ON 64
ci_066                 4.445131e-03 3 1  ON 65
ci_067                 4.372546e-03 3 1  ON 66
ci_068                -4.114555e-03 3 1  ON 67
ci_069                -4.949540e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9709e+01 secs
  Total Execution time = 3.9759e+03 secs

=========================================================
  A new xml input file : H2O.s099.cont.xml
