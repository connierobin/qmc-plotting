Rank =    0  Free Memory = 86411 MB
Rank =    1  Free Memory = 86411 MB
Rank =    2  Free Memory = 86411 MB
Rank =    3  Free Memory = 86411 MB
Rank =    4  Free Memory = 86411 MB
Rank =    5  Free Memory = 86411 MB
Rank =    6  Free Memory = 86411 MB
Rank =    7  Free Memory = 86410 MB
Rank =    8  Free Memory = 86410 MB
Rank =    9  Free Memory = 86410 MB
Rank =   10  Free Memory = 86410 MB
Rank =   11  Free Memory = 86410 MB
Rank =   12  Free Memory = 86410 MB
Rank =   13  Free Memory = 86410 MB
Rank =   14  Free Memory = 86410 MB
Rank =   15  Free Memory = 86395 MB
Rank =   16  Free Memory = 86395 MB
Rank =   17  Free Memory = 86395 MB
Rank =   18  Free Memory = 86395 MB
Rank =   19  Free Memory = 86395 MB
Rank =   20  Free Memory = 86395 MB
Rank =   21  Free Memory = 86395 MB
Rank =   22  Free Memory = 86395 MB
Rank =   23  Free Memory = 86395 MB
Rank =   24  Free Memory = 86395 MB
Rank =   25  Free Memory = 86395 MB
Rank =   26  Free Memory = 86395 MB
Rank =   27  Free Memory = 86395 MB
Rank =   28  Free Memory = 86395 MB
Rank =   29  Free Memory = 86395 MB
Rank =   30  Free Memory = 86395 MB
Rank =   31  Free Memory = 86395 MB
Rank =   32  Free Memory = 74036 MB
Rank =   33  Free Memory = 74036 MB
Rank =   34  Free Memory = 74036 MB
Rank =   35  Free Memory = 74036 MB
Rank =   36  Free Memory = 74036 MB
Rank =   37  Free Memory = 74036 MB
Rank =   38  Free Memory = 74036 MB
Rank =   39  Free Memory = 74036 MB
Rank =   40  Free Memory = 74036 MB
Rank =   41  Free Memory = 74036 MB
Rank =   42  Free Memory = 74036 MB
Rank =   43  Free Memory = 74036 MB
Rank =   44  Free Memory = 74036 MB
Rank =   45  Free Memory = 74036 MB
Rank =   46  Free Memory = 74036 MB
Rank =   47  Free Memory = 74036 MB
Rank =   48  Free Memory = 74036 MB
Rank =   49  Free Memory = 74036 MB
Rank =   50  Free Memory = 74036 MB
Rank =   51  Free Memory = 74036 MB
Rank =   52  Free Memory = 74036 MB
Rank =   53  Free Memory = 74036 MB
Rank =   54  Free Memory = 74036 MB
Rank =   55  Free Memory = 74036 MB
Rank =   56  Free Memory = 74036 MB
Rank =   57  Free Memory = 74036 MB
Rank =   58  Free Memory = 74036 MB
Rank =   59  Free Memory = 74036 MB
Rank =   60  Free Memory = 74036 MB
Rank =   61  Free Memory = 74036 MB
Rank =   62  Free Memory = 74036 MB
Rank =   63  Free Memory = 74036 MB
Rank =   64  Free Memory = 83468 MB
Rank =   65  Free Memory = 83468 MB
Rank =   66  Free Memory = 83468 MB
Rank =   67  Free Memory = 83468 MB
Rank =   68  Free Memory = 83468 MB
Rank =   69  Free Memory = 83468 MB
Rank =   70  Free Memory = 83468 MB
Rank =   71  Free Memory = 83468 MB
Rank =   72  Free Memory = 83468 MB
Rank =   73  Free Memory = 83468 MB
Rank =   74  Free Memory = 83468 MB
Rank =   75  Free Memory = 83468 MB
Rank =   76  Free Memory = 83468 MB
Rank =   77  Free Memory = 83468 MB
Rank =   78  Free Memory = 83468 MB
Rank =   79  Free Memory = 83468 MB
Rank =   80  Free Memory = 83468 MB
Rank =   81  Free Memory = 83467 MB
Rank =   82  Free Memory = 83467 MB
Rank =   83  Free Memory = 83467 MB
Rank =   84  Free Memory = 83467 MB
Rank =   85  Free Memory = 83467 MB
Rank =   86  Free Memory = 83467 MB
Rank =   87  Free Memory = 83467 MB
Rank =   88  Free Memory = 83467 MB
Rank =   89  Free Memory = 83467 MB
Rank =   90  Free Memory = 83467 MB
Rank =   91  Free Memory = 83467 MB
Rank =   92  Free Memory = 83467 MB
Rank =   93  Free Memory = 83467 MB
Rank =   94  Free Memory = 83467 MB
Rank =   95  Free Memory = 83467 MB
Rank =   96  Free Memory = 74955 MB
Rank =   97  Free Memory = 74955 MB
Rank =   98  Free Memory = 74955 MB
Rank =   99  Free Memory = 74955 MB
Rank =  100  Free Memory = 74955 MB
Rank =  101  Free Memory = 74955 MB
Rank =  102  Free Memory = 74955 MB
Rank =  103  Free Memory = 74955 MB
Rank =  104  Free Memory = 74955 MB
Rank =  105  Free Memory = 74955 MB
Rank =  106  Free Memory = 74955 MB
Rank =  107  Free Memory = 74955 MB
Rank =  108  Free Memory = 74955 MB
Rank =  109  Free Memory = 74955 MB
Rank =  110  Free Memory = 74955 MB
Rank =  111  Free Memory = 74955 MB
Rank =  112  Free Memory = 74955 MB
Rank =  113  Free Memory = 74955 MB
Rank =  114  Free Memory = 74955 MB
Rank =  115  Free Memory = 74955 MB
Rank =  116  Free Memory = 74955 MB
Rank =  117  Free Memory = 74955 MB
Rank =  118  Free Memory = 74955 MB
Rank =  119  Free Memory = 74955 MB
Rank =  120  Free Memory = 74955 MB
Rank =  121  Free Memory = 74955 MB
Rank =  122  Free Memory = 74955 MB
Rank =  123  Free Memory = 74955 MB
Rank =  124  Free Memory = 74955 MB
Rank =  125  Free Memory = 74955 MB
Rank =  126  Free Memory = 74955 MB
Rank =  127  Free Memory = 74955 MB
  Input file(s): opt_h2o_gs_tett_run001c.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_tett_run001c.xml

  Project = H2O
  date    = 2023-03-06 20:07:05 PST
  host    = n0100.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 105

  Range of prime numbers to use as seeds over processors and threads = 587-1483


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 1.976955e-01    1         1 OFF
     uu_1                 4.326323e-02    1         1 OFF
     uu_2                -4.191474e-02    1         1 OFF
     uu_3                -9.236738e-02    1         1 OFF
     uu_4                -1.237747e-01    1         1 OFF
     uu_5                -1.319037e-01    1         1 OFF
     uu_6                -1.106952e-01    1         1 OFF
     uu_7                -4.244237e-02    1         1 OFF
     uu_8                 8.655817e-02    1         1 OFF
     uu_9                 1.220471e-01    1         1 OFF

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.028145e-01    1         1 OFF
     ud_1                 7.596782e-02    1         1 OFF
     ud_2                -1.839231e-02    1         1 OFF
     ud_3                -6.881992e-02    1         1 OFF
     ud_4                -1.085214e-01    1         1 OFF
     ud_5                -1.357860e-01    1         1 OFF
     ud_6                -1.370235e-01    1         1 OFF
     ud_7                -9.613799e-02    1         1 OFF
     ud_8                 1.435756e-03    1         1 OFF
     ud_9                 9.067639e-02    1         1 OFF


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -6.845788e-01    1         1 OFF
     eO_1                -4.098270e-01    1         1 OFF
     eO_2                -4.967682e-02    1         1 OFF
     eO_3                 1.714303e-01    1         1 OFF
     eO_4                 2.548431e-01    1         1 OFF
     eO_5                 2.931036e-01    1         1 OFF
     eO_6                 2.514037e-01    1         1 OFF
     eO_7                 1.164447e-01    1         1 OFF
     eO_8                 2.795919e-02    1         1 OFF
     eO_9                 1.837528e-02    1         1 OFF

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.951466e-01    1         1 OFF
     eH1_1                -9.635501e-02    1         1 OFF
     eH1_2                -4.934629e-02    1         1 OFF
     eH1_3                -1.903088e-02    1         1 OFF
     eH1_4                 1.661999e-02    1         1 OFF
     eH1_5                 2.426341e-02    1         1 OFF
     eH1_6                 7.675645e-02    1         1 OFF
     eH1_7                 1.107465e-01    1         1 OFF
     eH1_8                 9.199321e-02    1         1 OFF
     eH1_9                 2.426879e-02    1         1 OFF

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.961133e-01    1         1 OFF
     eH2_1                -9.717268e-02    1         1 OFF
     eH2_2                -5.034852e-02    1         1 OFF
     eH2_3                -2.019455e-02    1         1 OFF
     eH2_4                 1.552415e-02    1         1 OFF
     eH2_5                 2.429685e-02    1         1 OFF
     eH2_6                 7.654507e-02    1         1 OFF
     eH2_7                 1.129438e-01    1         1 OFF
     eH2_8                 9.604869e-02    1         1 OFF
     eH2_9                 2.646592e-02    1         1 OFF

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.702352e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 2.3390e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 100
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 69
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1984
    reference variance = 0.264158
====================================================
  Execution time = 1.4648e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5262e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8344e-01
  Total weights = 1.957255916e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4864e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271947798578
                                         uncertainty =       0.002892675266

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271947798578
                                         uncertainty =       0.002892675266

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368736961
  error estimate for blocks of size 2^( 2) =       0.000382549159
  error estimate for blocks of size 2^( 3) =       0.000394542395
  error estimate for blocks of size 2^( 4) =       0.000403234126
  error estimate for blocks of size 2^( 5) =       0.000408850392
  error estimate for blocks of size 2^( 6) =       0.000411972889
  error estimate for blocks of size 2^( 7) =       0.000412894715

      target function =      -0.939109497053
              le_mean =     -17.212842102524
             les_mean =     296.565378084911
             stat err =       0.000409238031
             autocorr =       1.231738814168
   target nu stat err =       0.000409238031
   target dn stat err =       0.003541626152
      target stat err =       0.005931338011
              std dev =       0.521472811664
             le_variance =       0.271933893305


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721284210252e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939146245938       residual = 2.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939406188612       residual = 2.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939439013787       residual = 8.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939455153282       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939455898693       residual = 2.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939457019023       residual = 5.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939457342593       residual = 9.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939457356856       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939457355637       residual = 4.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939457344197       residual = 8.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 5.950841e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939146245938       residual = 2.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939225673096       residual = 2.76e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939235363059       residual = 7.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939239973607       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939240145053       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939240442266       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939240530975       residual = 7.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939240531681       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939240531406       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939240528515       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.776482e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939146245938       residual = 2.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939167270453       residual = 2.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939169806967       residual = 7.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939171001169       residual = 9.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939171042279       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939171117441       residual = 3.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939171140142       residual = 6.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939171140070       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939171140006       residual = 2.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939171139288       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 4.668342e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.006334 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7147e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_001 -4.206115e-02                3 1 ON  0
ci_002 -3.216641e-02                3 1 ON  1
ci_003 -2.662693e-02                3 1 ON  2
ci_004 2.381450e-02                 3 1 ON  3
ci_005 2.417465e-02                 3 1 ON  4
ci_006 -2.160302e-02                3 1 ON  5
ci_007 -2.118799e-02                3 1 ON  6
ci_008 -8.426974e-03                3 1 ON  7
ci_009 -1.353836e-02                3 1 ON  8
ci_010 -1.019074e-02                3 1 ON  9
ci_011 -1.160615e-02                3 1 ON  10
ci_012 -9.712151e-03                3 1 ON  11
ci_013 -1.996918e-02                3 1 ON  12
ci_014 1.224754e-02                 3 1 ON  13
ci_015 1.176933e-02                 3 1 ON  14
ci_016 1.778822e-02                 3 1 ON  15
ci_017 1.642223e-02                 3 1 ON  16
ci_018 1.017479e-02                 3 1 ON  17
ci_019 9.956830e-03                 3 1 ON  18
ci_020 1.807287e-02                 3 1 ON  19
ci_021 1.773344e-02                 3 1 ON  20
ci_022 9.100654e-03                 3 1 ON  21
ci_023 9.216958e-03                 3 1 ON  22
ci_024 9.749939e-03                 3 1 ON  23
ci_025 1.046806e-02                 3 1 ON  24
ci_026 1.185189e-02                 3 1 ON  25
ci_027 1.191598e-02                 3 1 ON  26
ci_028 -1.460988e-02                3 1 ON  27
ci_029 -1.683599e-02                3 1 ON  28
ci_030 -9.681284e-03                3 1 ON  29
ci_031 -9.018285e-03                3 1 ON  30
ci_032 -1.468891e-02                3 1 ON  31
ci_033 4.968766e-03                 3 1 ON  32
ci_034 5.620220e-03                 3 1 ON  33
ci_035 -5.164339e-03                3 1 ON  34
ci_036 -1.277610e-02                3 1 ON  35
ci_037 -1.226707e-02                3 1 ON  36
ci_038 2.237925e-03                 3 1 ON  37
ci_039 1.695049e-03                 3 1 ON  38
ci_040 -3.357455e-03                3 1 ON  39
ci_041 9.921055e-03                 3 1 ON  40
ci_042 8.112396e-03                 3 1 ON  41
ci_043 -4.195731e-03                3 1 ON  42
ci_044 -3.741798e-03                3 1 ON  43
ci_045 -3.719633e-03                3 1 ON  44
ci_046 5.680166e-03                 3 1 ON  45
ci_047 5.504588e-03                 3 1 ON  46
ci_048 -1.249107e-02                3 1 ON  47
ci_049 -1.472378e-02                3 1 ON  48
ci_050 2.993193e-03                 3 1 ON  49
ci_051 2.688164e-03                 3 1 ON  50
ci_052 -2.333649e-03                3 1 ON  51
ci_053 -2.457807e-03                3 1 ON  52
ci_054 -3.550077e-03                3 1 ON  53
ci_055 -2.948720e-03                3 1 ON  54
ci_056 5.710922e-03                 3 1 ON  55
ci_057 5.225404e-03                 3 1 ON  56
ci_058 -7.851829e-04                3 1 ON  57
ci_059 -2.385870e-03                3 1 ON  58
ci_060 4.598608e-03                 3 1 ON  59
ci_061 5.751267e-03                 3 1 ON  60
ci_062 -3.668169e-03                3 1 ON  61
ci_063 -4.035560e-03                3 1 ON  62
ci_064 -2.419344e-03                3 1 ON  63
ci_065 -4.349381e-03                3 1 ON  64
ci_066 4.407187e-03                 3 1 ON  65
ci_067 4.346598e-03                 3 1 ON  66
ci_068 -4.121282e-03                3 1 ON  67
ci_069 -4.983803e-03                3 1 ON  68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2008
    reference variance = 0.237032
====================================================
  Execution time = 1.3617e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8014e-01
  Total weights = 1.9576e+06
  Execution time = 1.8372e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267257640694
                                         uncertainty =       0.001495616437

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267257640694
                                         uncertainty =       0.001495616437

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365840606
  error estimate for blocks of size 2^( 2) =       0.000379560890
  error estimate for blocks of size 2^( 3) =       0.000392092717
  error estimate for blocks of size 2^( 4) =       0.000401347955
  error estimate for blocks of size 2^( 5) =       0.000406670350
  error estimate for blocks of size 2^( 6) =       0.000408474834
  error estimate for blocks of size 2^( 7) =       0.000410343586

      target function =      -0.943330239501
              le_mean =     -17.211664584327
             les_mean =     296.522321646115
             stat err =       0.000406709181
             autocorr =       1.235902290442
   target nu stat err =       0.000406709181
   target dn stat err =       0.002670033252
      target stat err =       0.004526035545
              std dev =       0.517376746771
             le_variance =       0.267678698099

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267104252485
                                         uncertainty =       0.001498686055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267104252485
                                         uncertainty =       0.001498686055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365736201
  error estimate for blocks of size 2^( 2) =       0.000379482578
  error estimate for blocks of size 2^( 3) =       0.000392046997
  error estimate for blocks of size 2^( 4) =       0.000401323178
  error estimate for blocks of size 2^( 5) =       0.000406656572
  error estimate for blocks of size 2^( 6) =       0.000408456030
  error estimate for blocks of size 2^( 7) =       0.000410334612

      target function =      -0.943762949472
              le_mean =     -17.211670472209
             les_mean =     296.522268296184
             stat err =       0.000406692598
             autocorr =       1.236507166443
   target nu stat err =       0.000406692598
   target dn stat err =       0.002402747378
      target stat err =       0.004088801568
              std dev =       0.517229095295
             le_variance =       0.267525937019

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267150575614
                                         uncertainty =       0.001497451359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267150575614
                                         uncertainty =       0.001497451359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365767699
  error estimate for blocks of size 2^( 2) =       0.000379503227
  error estimate for blocks of size 2^( 3) =       0.000392054289
  error estimate for blocks of size 2^( 4) =       0.000401321973
  error estimate for blocks of size 2^( 5) =       0.000406651329
  error estimate for blocks of size 2^( 6) =       0.000408451559
  error estimate for blocks of size 2^( 7) =       0.000410326715

      target function =      -0.944536811283
              le_mean =     -17.211666306872
             les_mean =     296.521663772617
             stat err =       0.000406687894
             autocorr =       1.236265615089
   target nu stat err =       0.000406687894
   target dn stat err =       0.002340260822
      target stat err =       0.003992219136
              std dev =       0.517273640103
             le_variance =       0.267572018746

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267240984187
                                         uncertainty =       0.001495832133

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267240984187
                                         uncertainty =       0.001495832133

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365829259
  error estimate for blocks of size 2^( 2) =       0.000379551537
  error estimate for blocks of size 2^( 3) =       0.000392085911
  error estimate for blocks of size 2^( 4) =       0.000401342798
  error estimate for blocks of size 2^( 5) =       0.000406666075
  error estimate for blocks of size 2^( 6) =       0.000408470092
  error estimate for blocks of size 2^( 7) =       0.000410339867

      target function =      -0.943953676347
              le_mean =     -17.211664525634
             les_mean =     296.521948263572
             stat err =       0.000406704708
             autocorr =       1.235951772941
   target nu stat err =       0.000406704708
   target dn stat err =       0.002567622676
      target stat err =       0.004362606788
              std dev =       0.517360699773
             le_variance =       0.267662093669


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943330239501        initial
     2.5000e-01     2.5000e+00             5.9508e-04        -0.943762949472
     1.0000e+00     1.0000e+01             1.7765e-04        -0.944536811283  <--
     4.0000e+00     4.0000e+01             4.6683e-05        -0.943953676347

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.2882e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
ci_001                -4.206115e-02 3 1  ON 0
ci_002                -3.216641e-02 3 1  ON 1
ci_003                -2.662693e-02 3 1  ON 2
ci_004                 2.381450e-02 3 1  ON 3
ci_005                 2.417465e-02 3 1  ON 4
ci_006                -2.160302e-02 3 1  ON 5
ci_007                -2.118799e-02 3 1  ON 6
ci_008                -8.426974e-03 3 1  ON 7
ci_009                -1.353836e-02 3 1  ON 8
ci_010                -1.019074e-02 3 1  ON 9
ci_011                -1.160615e-02 3 1  ON 10
ci_012                -9.712151e-03 3 1  ON 11
ci_013                -1.996918e-02 3 1  ON 12
ci_014                 1.224754e-02 3 1  ON 13
ci_015                 1.176933e-02 3 1  ON 14
ci_016                 1.778822e-02 3 1  ON 15
ci_017                 1.642223e-02 3 1  ON 16
ci_018                 1.017479e-02 3 1  ON 17
ci_019                 9.956830e-03 3 1  ON 18
ci_020                 1.807287e-02 3 1  ON 19
ci_021                 1.773344e-02 3 1  ON 20
ci_022                 9.100654e-03 3 1  ON 21
ci_023                 9.216958e-03 3 1  ON 22
ci_024                 9.749939e-03 3 1  ON 23
ci_025                 1.046806e-02 3 1  ON 24
ci_026                 1.185189e-02 3 1  ON 25
ci_027                 1.191598e-02 3 1  ON 26
ci_028                -1.460988e-02 3 1  ON 27
ci_029                -1.683599e-02 3 1  ON 28
ci_030                -9.681284e-03 3 1  ON 29
ci_031                -9.018285e-03 3 1  ON 30
ci_032                -1.468891e-02 3 1  ON 31
ci_033                 4.968766e-03 3 1  ON 32
ci_034                 5.620220e-03 3 1  ON 33
ci_035                -5.164339e-03 3 1  ON 34
ci_036                -1.277610e-02 3 1  ON 35
ci_037                -1.226707e-02 3 1  ON 36
ci_038                 2.237925e-03 3 1  ON 37
ci_039                 1.695049e-03 3 1  ON 38
ci_040                -3.357455e-03 3 1  ON 39
ci_041                 9.921055e-03 3 1  ON 40
ci_042                 8.112396e-03 3 1  ON 41
ci_043                -4.195731e-03 3 1  ON 42
ci_044                -3.741798e-03 3 1  ON 43
ci_045                -3.719633e-03 3 1  ON 44
ci_046                 5.680166e-03 3 1  ON 45
ci_047                 5.504588e-03 3 1  ON 46
ci_048                -1.249107e-02 3 1  ON 47
ci_049                -1.472378e-02 3 1  ON 48
ci_050                 2.993193e-03 3 1  ON 49
ci_051                 2.688164e-03 3 1  ON 50
ci_052                -2.333649e-03 3 1  ON 51
ci_053                -2.457807e-03 3 1  ON 52
ci_054                -3.550077e-03 3 1  ON 53
ci_055                -2.948720e-03 3 1  ON 54
ci_056                 5.710922e-03 3 1  ON 55
ci_057                 5.225404e-03 3 1  ON 56
ci_058                -7.851829e-04 3 1  ON 57
ci_059                -2.385870e-03 3 1  ON 58
ci_060                 4.598608e-03 3 1  ON 59
ci_061                 5.751267e-03 3 1  ON 60
ci_062                -3.668169e-03 3 1  ON 61
ci_063                -4.035560e-03 3 1  ON 62
ci_064                -2.419344e-03 3 1  ON 63
ci_065                -4.349381e-03 3 1  ON 64
ci_066                 4.407187e-03 3 1  ON 65
ci_067                 4.346598e-03 3 1  ON 66
ci_068                -4.121282e-03 3 1  ON 67
ci_069                -4.983803e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0036e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1275
    reference variance = 0.23297
====================================================
  Execution time = 1.4092e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5252e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7527e-01
  Total weights = 1.957060548e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4840e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.263944709911
                                         uncertainty =       0.001372116421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.263944709911
                                         uncertainty =       0.001372116421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363317633
  error estimate for blocks of size 2^( 2) =       0.000376913870
  error estimate for blocks of size 2^( 3) =       0.000389897194
  error estimate for blocks of size 2^( 4) =       0.000399439692
  error estimate for blocks of size 2^( 5) =       0.000404738722
  error estimate for blocks of size 2^( 6) =       0.000406745273
  error estimate for blocks of size 2^( 7) =       0.000409162566

      target function =      -0.952904446461
              le_mean =     -17.211996473371
             les_mean =     296.528089126491
             stat err =       0.000405021563
             autocorr =       1.242748759659
   target nu stat err =       0.000405021563
   target dn stat err =       0.002437747183
      target stat err =       0.004228093241
              std dev =       0.513808724055
             le_variance =       0.263999404915


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721199647337e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952922296090       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.953100731026       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.953122792218       residual = 5.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.953132081709       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.953132587065       residual = 2.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.953132439074       residual = 5.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.953132859960       residual = 1.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.953133033359       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.953133053877       residual = 6.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.953133091120       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.953133102173       residual = 2.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 4.824411e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952922296090       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952977047629       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952983610558       residual = 4.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.952986239081       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.952986375599       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.952986320166       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.952986433972       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.952986478450       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.952986483323       residual = 4.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.952986491844       residual = 8.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.478347e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952922296090       residual = 1.68e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952936808770       residual = 1.91e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952938530937       residual = 4.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.952939209551       residual = 1.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.952939244310       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.952939228940       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.952939257906       residual = 1.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.952939269015       residual = 2.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.952939270209       residual = 3.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.952939272256       residual = 6.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 3.917395e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.010691 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6586e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_001                -4.203650e-02 3 1  ON 0
ci_002                -3.216096e-02 3 1  ON 1
ci_003                -2.658642e-02 3 1  ON 2
ci_004                 2.374683e-02 3 1  ON 3
ci_005                 2.412947e-02 3 1  ON 4
ci_006                -2.160327e-02 3 1  ON 5
ci_007                -2.114577e-02 3 1  ON 6
ci_008                -8.483321e-03 3 1  ON 7
ci_009                -1.361373e-02 3 1  ON 8
ci_010                -1.016915e-02 3 1  ON 9
ci_011                -1.157569e-02 3 1  ON 10
ci_012                -9.753849e-03 3 1  ON 11
ci_013                -1.988154e-02 3 1  ON 12
ci_014                 1.229595e-02 3 1  ON 13
ci_015                 1.178257e-02 3 1  ON 14
ci_016                 1.766591e-02 3 1  ON 15
ci_017                 1.638472e-02 3 1  ON 16
ci_018                 1.020385e-02 3 1  ON 17
ci_019                 1.001117e-02 3 1  ON 18
ci_020                 1.804670e-02 3 1  ON 19
ci_021                 1.768558e-02 3 1  ON 20
ci_022                 9.120741e-03 3 1  ON 21
ci_023                 9.182102e-03 3 1  ON 22
ci_024                 9.693414e-03 3 1  ON 23
ci_025                 1.034980e-02 3 1  ON 24
ci_026                 1.178655e-02 3 1  ON 25
ci_027                 1.187176e-02 3 1  ON 26
ci_028                -1.465801e-02 3 1  ON 27
ci_029                -1.670944e-02 3 1  ON 28
ci_030                -9.582211e-03 3 1  ON 29
ci_031                -9.045588e-03 3 1  ON 30
ci_032                -1.471087e-02 3 1  ON 31
ci_033                 4.999413e-03 3 1  ON 32
ci_034                 5.600395e-03 3 1  ON 33
ci_035                -5.121760e-03 3 1  ON 34
ci_036                -1.278891e-02 3 1  ON 35
ci_037                -1.227834e-02 3 1  ON 36
ci_038                 2.168109e-03 3 1  ON 37
ci_039                 1.692759e-03 3 1  ON 38
ci_040                -3.305185e-03 3 1  ON 39
ci_041                 9.773220e-03 3 1  ON 40
ci_042                 8.148734e-03 3 1  ON 41
ci_043                -4.168039e-03 3 1  ON 42
ci_044                -3.821086e-03 3 1  ON 43
ci_045                -3.693705e-03 3 1  ON 44
ci_046                 5.633815e-03 3 1  ON 45
ci_047                 5.517678e-03 3 1  ON 46
ci_048                -1.253370e-02 3 1  ON 47
ci_049                -1.463389e-02 3 1  ON 48
ci_050                 3.032942e-03 3 1  ON 49
ci_051                 2.740287e-03 3 1  ON 50
ci_052                -2.323178e-03 3 1  ON 51
ci_053                -2.474464e-03 3 1  ON 52
ci_054                -3.489242e-03 3 1  ON 53
ci_055                -2.966365e-03 3 1  ON 54
ci_056                 5.673533e-03 3 1  ON 55
ci_057                 5.215607e-03 3 1  ON 56
ci_058                -8.477712e-04 3 1  ON 57
ci_059                -2.360498e-03 3 1  ON 58
ci_060                 4.567932e-03 3 1  ON 59
ci_061                 5.740978e-03 3 1  ON 60
ci_062                -3.708548e-03 3 1  ON 61
ci_063                -4.072045e-03 3 1  ON 62
ci_064                -2.484547e-03 3 1  ON 63
ci_065                -4.382861e-03 3 1  ON 64
ci_066                 4.398046e-03 3 1  ON 65
ci_067                 4.347025e-03 3 1  ON 66
ci_068                -4.174751e-03 3 1  ON 67
ci_069                -4.968915e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1727
    reference variance = 0.262747
====================================================
  Execution time = 1.3811e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7771e-01
  Total weights = 1.9573e+06
  Execution time = 1.8223e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267548413256
                                         uncertainty =       0.001594346919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267548413256
                                         uncertainty =       0.001594346919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365731648
  error estimate for blocks of size 2^( 2) =       0.000379692380
  error estimate for blocks of size 2^( 3) =       0.000392329819
  error estimate for blocks of size 2^( 4) =       0.000401244248
  error estimate for blocks of size 2^( 5) =       0.000406720656
  error estimate for blocks of size 2^( 6) =       0.000411274601
  error estimate for blocks of size 2^( 7) =       0.000411899235

      target function =      -0.946743689202
              le_mean =     -17.211793764914
             les_mean =     296.524739909336
             stat err =       0.000407784685
             autocorr =       1.243187793147
   target nu stat err =       0.000407784685
   target dn stat err =       0.002335482826
      target stat err =       0.004003982803
              std dev =       0.517222656814
             le_variance =       0.267519276721

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267439642519
                                         uncertainty =       0.001597831118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267439642519
                                         uncertainty =       0.001597831118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365657173
  error estimate for blocks of size 2^( 2) =       0.000379616531
  error estimate for blocks of size 2^( 3) =       0.000392255147
  error estimate for blocks of size 2^( 4) =       0.000401173382
  error estimate for blocks of size 2^( 5) =       0.000406639524
  error estimate for blocks of size 2^( 6) =       0.000411206447
  error estimate for blocks of size 2^( 7) =       0.000411821151

      target function =      -0.924440330748
              le_mean =     -17.211792351991
             les_mean =     296.537914592957
             stat err =       0.000407710126
             autocorr =       1.243239501999
   target nu stat err =       0.000407710126
   target dn stat err =       0.013875077810
      target stat err =       0.022327711055
              std dev =       0.517117333171
             le_variance =       0.267410336266

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267471990525
                                         uncertainty =       0.001596333875

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267471990525
                                         uncertainty =       0.001596333875

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365679334
  error estimate for blocks of size 2^( 2) =       0.000379638943
  error estimate for blocks of size 2^( 3) =       0.000392277354
  error estimate for blocks of size 2^( 4) =       0.000401193964
  error estimate for blocks of size 2^( 5) =       0.000406663494
  error estimate for blocks of size 2^( 6) =       0.000411226769
  error estimate for blocks of size 2^( 7) =       0.000411845826

      target function =      -0.948478744242
              le_mean =     -17.211791520626
             les_mean =     296.523637376257
             stat err =       0.000407732513
             autocorr =       1.243225342804
   target nu stat err =       0.000407732513
   target dn stat err =       0.002081173724
      target stat err =       0.003596006242
              std dev =       0.517148673198
             le_variance =       0.267442750190

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267536620199
                                         uncertainty =       0.001594579039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267536620199
                                         uncertainty =       0.001594579039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365723578
  error estimate for blocks of size 2^( 2) =       0.000379684106
  error estimate for blocks of size 2^( 3) =       0.000392321604
  error estimate for blocks of size 2^( 4) =       0.000401236288
  error estimate for blocks of size 2^( 5) =       0.000406711460
  error estimate for blocks of size 2^( 6) =       0.000411266700
  error estimate for blocks of size 2^( 7) =       0.000411890225

      target function =      -0.947544037046
              le_mean =     -17.211793264352
             les_mean =     296.524249919332
             stat err =       0.000407776168
             autocorr =       1.243190727869
   target nu stat err =       0.000407776168
   target dn stat err =       0.002137794582
      target stat err =       0.003682789900
              std dev =       0.517211243396
             le_variance =       0.267507470295


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946743689202        initial
     2.5000e-01     2.5000e+00             4.8244e-04        -0.924440330748
     1.0000e+00     1.0000e+01             1.4783e-04        -0.948478744242  <--
     4.0000e+00     4.0000e+01             3.9174e-05        -0.947544037046

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.3170e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
ci_001                -4.203650e-02 3 1  ON 0
ci_002                -3.216096e-02 3 1  ON 1
ci_003                -2.658642e-02 3 1  ON 2
ci_004                 2.374683e-02 3 1  ON 3
ci_005                 2.412947e-02 3 1  ON 4
ci_006                -2.160327e-02 3 1  ON 5
ci_007                -2.114577e-02 3 1  ON 6
ci_008                -8.483321e-03 3 1  ON 7
ci_009                -1.361373e-02 3 1  ON 8
ci_010                -1.016915e-02 3 1  ON 9
ci_011                -1.157569e-02 3 1  ON 10
ci_012                -9.753849e-03 3 1  ON 11
ci_013                -1.988154e-02 3 1  ON 12
ci_014                 1.229595e-02 3 1  ON 13
ci_015                 1.178257e-02 3 1  ON 14
ci_016                 1.766591e-02 3 1  ON 15
ci_017                 1.638472e-02 3 1  ON 16
ci_018                 1.020385e-02 3 1  ON 17
ci_019                 1.001117e-02 3 1  ON 18
ci_020                 1.804670e-02 3 1  ON 19
ci_021                 1.768558e-02 3 1  ON 20
ci_022                 9.120741e-03 3 1  ON 21
ci_023                 9.182102e-03 3 1  ON 22
ci_024                 9.693414e-03 3 1  ON 23
ci_025                 1.034980e-02 3 1  ON 24
ci_026                 1.178655e-02 3 1  ON 25
ci_027                 1.187176e-02 3 1  ON 26
ci_028                -1.465801e-02 3 1  ON 27
ci_029                -1.670944e-02 3 1  ON 28
ci_030                -9.582211e-03 3 1  ON 29
ci_031                -9.045588e-03 3 1  ON 30
ci_032                -1.471087e-02 3 1  ON 31
ci_033                 4.999413e-03 3 1  ON 32
ci_034                 5.600395e-03 3 1  ON 33
ci_035                -5.121760e-03 3 1  ON 34
ci_036                -1.278891e-02 3 1  ON 35
ci_037                -1.227834e-02 3 1  ON 36
ci_038                 2.168109e-03 3 1  ON 37
ci_039                 1.692759e-03 3 1  ON 38
ci_040                -3.305185e-03 3 1  ON 39
ci_041                 9.773220e-03 3 1  ON 40
ci_042                 8.148734e-03 3 1  ON 41
ci_043                -4.168039e-03 3 1  ON 42
ci_044                -3.821086e-03 3 1  ON 43
ci_045                -3.693705e-03 3 1  ON 44
ci_046                 5.633815e-03 3 1  ON 45
ci_047                 5.517678e-03 3 1  ON 46
ci_048                -1.253370e-02 3 1  ON 47
ci_049                -1.463389e-02 3 1  ON 48
ci_050                 3.032942e-03 3 1  ON 49
ci_051                 2.740287e-03 3 1  ON 50
ci_052                -2.323178e-03 3 1  ON 51
ci_053                -2.474464e-03 3 1  ON 52
ci_054                -3.489242e-03 3 1  ON 53
ci_055                -2.966365e-03 3 1  ON 54
ci_056                 5.673533e-03 3 1  ON 55
ci_057                 5.215607e-03 3 1  ON 56
ci_058                -8.477712e-04 3 1  ON 57
ci_059                -2.360498e-03 3 1  ON 58
ci_060                 4.567932e-03 3 1  ON 59
ci_061                 5.740978e-03 3 1  ON 60
ci_062                -3.708548e-03 3 1  ON 61
ci_063                -4.072045e-03 3 1  ON 62
ci_064                -2.484547e-03 3 1  ON 63
ci_065                -4.382861e-03 3 1  ON 64
ci_066                 4.398046e-03 3 1  ON 65
ci_067                 4.347025e-03 3 1  ON 66
ci_068                -4.174751e-03 3 1  ON 67
ci_069                -4.968915e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9763e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7175e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2413
    reference variance = 0.152754
====================================================
  Execution time = 1.4002e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8181e-01
  Total weights = 1.957494001e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5104e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270871888879
                                         uncertainty =       0.001703009107

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270871888879
                                         uncertainty =       0.001703009107

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367983598
  error estimate for blocks of size 2^( 2) =       0.000381633167
  error estimate for blocks of size 2^( 3) =       0.000393594760
  error estimate for blocks of size 2^( 4) =       0.000402729130
  error estimate for blocks of size 2^( 5) =       0.000409725739
  error estimate for blocks of size 2^( 6) =       0.000411772154
  error estimate for blocks of size 2^( 7) =       0.000413111882

      target function =      -0.941851705058
              le_mean =     -17.211413091275
             les_mean =     296.514553580019
             stat err =       0.000409334726
             autocorr =       1.237371923472
   target nu stat err =       0.000409334726
   target dn stat err =       0.002124198462
      target stat err =       0.003615266911
              std dev =       0.520407394502
             le_variance =       0.270823856253


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721141309127e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941864575238       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942055163599       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942086565114       residual = 6.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942094825952       residual = 9.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942096230133       residual = 2.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942096309809       residual = 4.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942096453707       residual = 9.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942096437826       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942096486713       residual = 5.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942096496163       residual = 9.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 5.514075e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941864575238       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941922836031       residual = 2.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941932097438       residual = 5.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941934399687       residual = 8.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941934799711       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941934806074       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941934849252       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941934844551       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941934856442       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941934859005       residual = 5.96e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.662892e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941864575238       residual = 1.58e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941879999211       residual = 2.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941882422677       residual = 5.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941883014097       residual = 8.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941883117681       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941883118111       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941883129379       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941883128214       residual = 1.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941883131126       residual = 3.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941883131770       residual = 5.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 4.383286e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.014350 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6524e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_001                -4.197978e-02 3 1  ON 0
ci_002                -3.212553e-02 3 1  ON 1
ci_003                -2.654092e-02 3 1  ON 2
ci_004                 2.374383e-02 3 1  ON 3
ci_005                 2.413451e-02 3 1  ON 4
ci_006                -2.151460e-02 3 1  ON 5
ci_007                -2.111939e-02 3 1  ON 6
ci_008                -8.499886e-03 3 1  ON 7
ci_009                -1.369983e-02 3 1  ON 8
ci_010                -1.008868e-02 3 1  ON 9
ci_011                -1.140940e-02 3 1  ON 10
ci_012                -9.757866e-03 3 1  ON 11
ci_013                -1.986973e-02 3 1  ON 12
ci_014                 1.227037e-02 3 1  ON 13
ci_015                 1.184658e-02 3 1  ON 14
ci_016                 1.757306e-02 3 1  ON 15
ci_017                 1.638693e-02 3 1  ON 16
ci_018                 1.023825e-02 3 1  ON 17
ci_019                 1.006881e-02 3 1  ON 18
ci_020                 1.796883e-02 3 1  ON 19
ci_021                 1.756933e-02 3 1  ON 20
ci_022                 9.151893e-03 3 1  ON 21
ci_023                 9.169782e-03 3 1  ON 22
ci_024                 9.629888e-03 3 1  ON 23
ci_025                 1.027620e-02 3 1  ON 24
ci_026                 1.170479e-02 3 1  ON 25
ci_027                 1.184523e-02 3 1  ON 26
ci_028                -1.469071e-02 3 1  ON 27
ci_029                -1.662390e-02 3 1  ON 28
ci_030                -9.605663e-03 3 1  ON 29
ci_031                -9.003694e-03 3 1  ON 30
ci_032                -1.470575e-02 3 1  ON 31
ci_033                 5.127986e-03 3 1  ON 32
ci_034                 5.634491e-03 3 1  ON 33
ci_035                -5.098256e-03 3 1  ON 34
ci_036                -1.279582e-02 3 1  ON 35
ci_037                -1.230771e-02 3 1  ON 36
ci_038                 2.173259e-03 3 1  ON 37
ci_039                 1.720728e-03 3 1  ON 38
ci_040                -3.255453e-03 3 1  ON 39
ci_041                 9.642018e-03 3 1  ON 40
ci_042                 8.151988e-03 3 1  ON 41
ci_043                -4.145436e-03 3 1  ON 42
ci_044                -3.906005e-03 3 1  ON 43
ci_045                -3.646483e-03 3 1  ON 44
ci_046                 5.638074e-03 3 1  ON 45
ci_047                 5.499921e-03 3 1  ON 46
ci_048                -1.260025e-02 3 1  ON 47
ci_049                -1.453546e-02 3 1  ON 48
ci_050                 3.099275e-03 3 1  ON 49
ci_051                 2.729897e-03 3 1  ON 50
ci_052                -2.313813e-03 3 1  ON 51
ci_053                -2.455792e-03 3 1  ON 52
ci_054                -3.459848e-03 3 1  ON 53
ci_055                -2.990768e-03 3 1  ON 54
ci_056                 5.620646e-03 3 1  ON 55
ci_057                 5.268675e-03 3 1  ON 56
ci_058                -9.495241e-04 3 1  ON 57
ci_059                -2.310923e-03 3 1  ON 58
ci_060                 4.579886e-03 3 1  ON 59
ci_061                 5.731892e-03 3 1  ON 60
ci_062                -3.742109e-03 3 1  ON 61
ci_063                -4.043526e-03 3 1  ON 62
ci_064                -2.512085e-03 3 1  ON 63
ci_065                -4.360415e-03 3 1  ON 64
ci_066                 4.412490e-03 3 1  ON 65
ci_067                 4.362466e-03 3 1  ON 66
ci_068                -4.149685e-03 3 1  ON 67
ci_069                -5.076935e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1321
    reference variance = 0.163293
====================================================
  Execution time = 1.3629e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7715e-01
  Total weights = 1.9571e+06
  Execution time = 2.3156e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265936833718
                                         uncertainty =       0.001357923479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265936833718
                                         uncertainty =       0.001357923479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364626389
  error estimate for blocks of size 2^( 2) =       0.000378208290
  error estimate for blocks of size 2^( 3) =       0.000390488987
  error estimate for blocks of size 2^( 4) =       0.000399966015
  error estimate for blocks of size 2^( 5) =       0.000405853053
  error estimate for blocks of size 2^( 6) =       0.000408815858
  error estimate for blocks of size 2^( 7) =       0.000411466109

      target function =      -0.948770933886
              le_mean =     -17.212401501474
             les_mean =     296.544469541948
             stat err =       0.000406525259
             autocorr =       1.243022174757
   target nu stat err =       0.000406525259
   target dn stat err =       0.001913793581
      target stat err =       0.003324454458
              std dev =       0.515659584810
             le_variance =       0.265904807407

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265820637691
                                         uncertainty =       0.001358430446

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265820637691
                                         uncertainty =       0.001358430446

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364546587
  error estimate for blocks of size 2^( 2) =       0.000378139376
  error estimate for blocks of size 2^( 3) =       0.000390434106
  error estimate for blocks of size 2^( 4) =       0.000399920598
  error estimate for blocks of size 2^( 5) =       0.000405817699
  error estimate for blocks of size 2^( 6) =       0.000408797307
  error estimate for blocks of size 2^( 7) =       0.000411508381

      target function =      -0.950379893769
              le_mean =     -17.212402157844
             les_mean =     296.543545204823
             stat err =       0.000406510996
             autocorr =       1.243479195222
   target nu stat err =       0.000406510996
   target dn stat err =       0.001820313507
      target stat err =       0.003180483124
              std dev =       0.515546726998
             le_variance =       0.265788427719

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265854169400
                                         uncertainty =       0.001358169121

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265854169400
                                         uncertainty =       0.001358169121

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364569633
  error estimate for blocks of size 2^( 2) =       0.000378157789
  error estimate for blocks of size 2^( 3) =       0.000390446979
  error estimate for blocks of size 2^( 4) =       0.000399930141
  error estimate for blocks of size 2^( 5) =       0.000405824220
  error estimate for blocks of size 2^( 6) =       0.000408794314
  error estimate for blocks of size 2^( 7) =       0.000411489917

      target function =      -0.950431907047
              le_mean =     -17.212401408730
             les_mean =     296.543488872687
             stat err =       0.000406509648
             autocorr =       1.243313736036
   target nu stat err =       0.000406509648
   target dn stat err =       0.001813186177
      target stat err =       0.003169015401
              std dev =       0.515579319639
             le_variance =       0.265822034839

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265943863036
                                         uncertainty =       0.001356684184

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265943863036
                                         uncertainty =       0.001356684184

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364631192
  error estimate for blocks of size 2^( 2) =       0.000378213948
  error estimate for blocks of size 2^( 3) =       0.000390494529
  error estimate for blocks of size 2^( 4) =       0.000399970929
  error estimate for blocks of size 2^( 5) =       0.000405854730
  error estimate for blocks of size 2^( 6) =       0.000408825632
  error estimate for blocks of size 2^( 7) =       0.000411461429

      target function =      -0.944666797227
              le_mean =     -17.212398982449
             les_mean =     296.546800095062
             stat err =       0.000406528180
             autocorr =       1.243007293190
   target nu stat err =       0.000406528180
   target dn stat err =       0.003431220897
      target stat err =       0.005811469853
              std dev =       0.515666377012
             le_variance =       0.265911812380


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948770933886        initial
     2.5000e-01     2.5000e+00             5.5141e-04        -0.950379893769
     1.0000e+00     1.0000e+01             1.6629e-04        -0.950431907047  <--
     4.0000e+00     4.0000e+01             4.3833e-05        -0.944666797227

*****************************************************************************
Applying the update for shift_i =   1.0000e+00     and shift_s =   1.0000e+01
*****************************************************************************

  Execution time = 2.4483e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
ci_001                -4.197978e-02 3 1  ON 0
ci_002                -3.212553e-02 3 1  ON 1
ci_003                -2.654092e-02 3 1  ON 2
ci_004                 2.374383e-02 3 1  ON 3
ci_005                 2.413451e-02 3 1  ON 4
ci_006                -2.151460e-02 3 1  ON 5
ci_007                -2.111939e-02 3 1  ON 6
ci_008                -8.499886e-03 3 1  ON 7
ci_009                -1.369983e-02 3 1  ON 8
ci_010                -1.008868e-02 3 1  ON 9
ci_011                -1.140940e-02 3 1  ON 10
ci_012                -9.757866e-03 3 1  ON 11
ci_013                -1.986973e-02 3 1  ON 12
ci_014                 1.227037e-02 3 1  ON 13
ci_015                 1.184658e-02 3 1  ON 14
ci_016                 1.757306e-02 3 1  ON 15
ci_017                 1.638693e-02 3 1  ON 16
ci_018                 1.023825e-02 3 1  ON 17
ci_019                 1.006881e-02 3 1  ON 18
ci_020                 1.796883e-02 3 1  ON 19
ci_021                 1.756933e-02 3 1  ON 20
ci_022                 9.151893e-03 3 1  ON 21
ci_023                 9.169782e-03 3 1  ON 22
ci_024                 9.629888e-03 3 1  ON 23
ci_025                 1.027620e-02 3 1  ON 24
ci_026                 1.170479e-02 3 1  ON 25
ci_027                 1.184523e-02 3 1  ON 26
ci_028                -1.469071e-02 3 1  ON 27
ci_029                -1.662390e-02 3 1  ON 28
ci_030                -9.605663e-03 3 1  ON 29
ci_031                -9.003694e-03 3 1  ON 30
ci_032                -1.470575e-02 3 1  ON 31
ci_033                 5.127986e-03 3 1  ON 32
ci_034                 5.634491e-03 3 1  ON 33
ci_035                -5.098256e-03 3 1  ON 34
ci_036                -1.279582e-02 3 1  ON 35
ci_037                -1.230771e-02 3 1  ON 36
ci_038                 2.173259e-03 3 1  ON 37
ci_039                 1.720728e-03 3 1  ON 38
ci_040                -3.255453e-03 3 1  ON 39
ci_041                 9.642018e-03 3 1  ON 40
ci_042                 8.151988e-03 3 1  ON 41
ci_043                -4.145436e-03 3 1  ON 42
ci_044                -3.906005e-03 3 1  ON 43
ci_045                -3.646483e-03 3 1  ON 44
ci_046                 5.638074e-03 3 1  ON 45
ci_047                 5.499921e-03 3 1  ON 46
ci_048                -1.260025e-02 3 1  ON 47
ci_049                -1.453546e-02 3 1  ON 48
ci_050                 3.099275e-03 3 1  ON 49
ci_051                 2.729897e-03 3 1  ON 50
ci_052                -2.313813e-03 3 1  ON 51
ci_053                -2.455792e-03 3 1  ON 52
ci_054                -3.459848e-03 3 1  ON 53
ci_055                -2.990768e-03 3 1  ON 54
ci_056                 5.620646e-03 3 1  ON 55
ci_057                 5.268675e-03 3 1  ON 56
ci_058                -9.495241e-04 3 1  ON 57
ci_059                -2.310923e-03 3 1  ON 58
ci_060                 4.579886e-03 3 1  ON 59
ci_061                 5.731892e-03 3 1  ON 60
ci_062                -3.742109e-03 3 1  ON 61
ci_063                -4.043526e-03 3 1  ON 62
ci_064                -2.512085e-03 3 1  ON 63
ci_065                -4.360415e-03 3 1  ON 64
ci_066                 4.412490e-03 3 1  ON 65
ci_067                 4.362466e-03 3 1  ON 66
ci_068                -4.149685e-03 3 1  ON 67
ci_069                -5.076935e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1013e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7179e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2139
    reference variance = 0.173575
====================================================
  Execution time = 1.4004e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7838e-01
  Total weights = 1.956961601e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4802e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268120782300
                                         uncertainty =       0.001462367758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268120782300
                                         uncertainty =       0.001462367758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366104547
  error estimate for blocks of size 2^( 2) =       0.000380026418
  error estimate for blocks of size 2^( 3) =       0.000392346312
  error estimate for blocks of size 2^( 4) =       0.000401305384
  error estimate for blocks of size 2^( 5) =       0.000407007816
  error estimate for blocks of size 2^( 6) =       0.000409608998
  error estimate for blocks of size 2^( 7) =       0.000410977777

      target function =      -0.947623857810
              le_mean =     -17.211698015935
             les_mean =     296.520924777176
             stat err =       0.000407224994
             autocorr =       1.237253251949
   target nu stat err =       0.000407224994
   target dn stat err =       0.001912387559
      target stat err =       0.003310181515
              std dev =       0.517750016076
             le_variance =       0.268065079147


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721169801593e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947634349500       residual = 1.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947853562492       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947877198225       residual = 5.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947883687552       residual = 1.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947884307522       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947884409646       residual = 6.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947884647536       residual = 1.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947884707004       residual = 3.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947884722265       residual = 7.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947884715833       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.947884720447       residual = 4.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e-01 is 3.924926e-04

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947634349500       residual = 1.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947701587186       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947708614235       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947710436276       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947710591166       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947710618415       residual = 4.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947710680130       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947710694371       residual = 2.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947710697174       residual = 5.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947710695455       residual = 9.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.199923e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947634349500       residual = 1.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947652169498       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947654012964       residual = 4.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947654482178       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947654520501       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947654527460       residual = 4.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947654542916       residual = 9.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947654546432       residual = 2.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947654547022       residual = 4.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947654546598       residual = 8.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 3.185946e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.018101 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6493e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_001                -4.187268e-02 3 1  ON 0
ci_002                -3.204935e-02 3 1  ON 1
ci_003                -2.645962e-02 3 1  ON 2
ci_004                 2.373738e-02 3 1  ON 3
ci_005                 2.419085e-02 3 1  ON 4
ci_006                -2.144376e-02 3 1  ON 5
ci_007                -2.110035e-02 3 1  ON 6
ci_008                -8.493510e-03 3 1  ON 7
ci_009                -1.375660e-02 3 1  ON 8
ci_010                -1.010164e-02 3 1  ON 9
ci_011                -1.137556e-02 3 1  ON 10
ci_012                -9.703389e-03 3 1  ON 11
ci_013                -1.985579e-02 3 1  ON 12
ci_014                 1.225202e-02 3 1  ON 13
ci_015                 1.194244e-02 3 1  ON 14
ci_016                 1.756746e-02 3 1  ON 15
ci_017                 1.633903e-02 3 1  ON 16
ci_018                 1.028912e-02 3 1  ON 17
ci_019                 1.010843e-02 3 1  ON 18
ci_020                 1.788124e-02 3 1  ON 19
ci_021                 1.749821e-02 3 1  ON 20
ci_022                 9.154283e-03 3 1  ON 21
ci_023                 9.103527e-03 3 1  ON 22
ci_024                 9.648513e-03 3 1  ON 23
ci_025                 1.028415e-02 3 1  ON 24
ci_026                 1.171941e-02 3 1  ON 25
ci_027                 1.172524e-02 3 1  ON 26
ci_028                -1.470857e-02 3 1  ON 27
ci_029                -1.655740e-02 3 1  ON 28
ci_030                -9.520815e-03 3 1  ON 29
ci_031                -9.006935e-03 3 1  ON 30
ci_032                -1.468231e-02 3 1  ON 31
ci_033                 5.244504e-03 3 1  ON 32
ci_034                 5.591325e-03 3 1  ON 33
ci_035                -5.106494e-03 3 1  ON 34
ci_036                -1.273708e-02 3 1  ON 35
ci_037                -1.235870e-02 3 1  ON 36
ci_038                 2.123972e-03 3 1  ON 37
ci_039                 1.738114e-03 3 1  ON 38
ci_040                -3.207112e-03 3 1  ON 39
ci_041                 9.554911e-03 3 1  ON 40
ci_042                 8.242988e-03 3 1  ON 41
ci_043                -4.124483e-03 3 1  ON 42
ci_044                -3.801278e-03 3 1  ON 43
ci_045                -3.583464e-03 3 1  ON 44
ci_046                 5.664604e-03 3 1  ON 45
ci_047                 5.532340e-03 3 1  ON 46
ci_048                -1.262754e-02 3 1  ON 47
ci_049                -1.441897e-02 3 1  ON 48
ci_050                 3.123986e-03 3 1  ON 49
ci_051                 2.761584e-03 3 1  ON 50
ci_052                -2.219767e-03 3 1  ON 51
ci_053                -2.432493e-03 3 1  ON 52
ci_054                -3.395127e-03 3 1  ON 53
ci_055                -2.972951e-03 3 1  ON 54
ci_056                 5.591436e-03 3 1  ON 55
ci_057                 5.355626e-03 3 1  ON 56
ci_058                -1.002635e-03 3 1  ON 57
ci_059                -2.290888e-03 3 1  ON 58
ci_060                 4.629487e-03 3 1  ON 59
ci_061                 5.714363e-03 3 1  ON 60
ci_062                -3.679301e-03 3 1  ON 61
ci_063                -4.004896e-03 3 1  ON 62
ci_064                -2.542377e-03 3 1  ON 63
ci_065                -4.371597e-03 3 1  ON 64
ci_066                 4.444657e-03 3 1  ON 65
ci_067                 4.361449e-03 3 1  ON 66
ci_068                -4.186552e-03 3 1  ON 67
ci_069                -5.081576e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2231
    reference variance = 0.248621
====================================================
  Execution time = 1.3795e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7916e-01
  Total weights = 1.9575e+06
  Execution time = 1.8399e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0261991
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268334019587
                                         uncertainty =       0.001338107948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268334019587
                                         uncertainty =       0.001338107948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366277561
  error estimate for blocks of size 2^( 2) =       0.000380255685
  error estimate for blocks of size 2^( 3) =       0.000392771996
  error estimate for blocks of size 2^( 4) =       0.000402074588
  error estimate for blocks of size 2^( 5) =       0.000407376382
  error estimate for blocks of size 2^( 6) =       0.000410692461
  error estimate for blocks of size 2^( 7) =       0.000413994975

      target function =      -0.946149530100
              le_mean =     -17.211516513455
             les_mean =     296.515549708904
             stat err =       0.000408534601
             autocorr =       1.244047791349
   target nu stat err =       0.000408534601
   target dn stat err =       0.001964669552
      target stat err =       0.003385409198
              std dev =       0.517994693949
             le_variance =       0.268318502960

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.00144932
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268233725048
                                         uncertainty =       0.001341099029

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268233725048
                                         uncertainty =       0.001341099029

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366209116
  error estimate for blocks of size 2^( 2) =       0.000380195818
  error estimate for blocks of size 2^( 3) =       0.000392723310
  error estimate for blocks of size 2^( 4) =       0.000402033710
  error estimate for blocks of size 2^( 5) =       0.000407347017
  error estimate for blocks of size 2^( 6) =       0.000410673625
  error estimate for blocks of size 2^( 7) =       0.000413990908

      target function =      -0.942405414358
              le_mean =     -17.211512139851
             les_mean =     296.517624835395
             stat err =       0.000408511315
             autocorr =       1.244370990309
   target nu stat err =       0.000408511315
   target dn stat err =       0.002886215152
      target stat err =       0.004873146022
              std dev =       0.517897898723
             le_variance =       0.268218233502

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0268193
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268260688372
                                         uncertainty =       0.001339637049

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268260688372
                                         uncertainty =       0.001339637049

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366227525
  error estimate for blocks of size 2^( 2) =       0.000380210628
  error estimate for blocks of size 2^( 3) =       0.000392734293
  error estimate for blocks of size 2^( 4) =       0.000402042329
  error estimate for blocks of size 2^( 5) =       0.000407352485
  error estimate for blocks of size 2^( 6) =       0.000410677557
  error estimate for blocks of size 2^( 7) =       0.000413989242

      target function =      -0.903097606345
              le_mean =     -17.211512615158
             les_mean =     296.541143302754
             stat err =       0.000408515403
             autocorr =       1.244270797574
   target nu stat err =       0.000408515403
   target dn stat err =       0.025203779451
      target stat err =       0.038721524098
              std dev =       0.517923932693
             le_variance =       0.268245200056

ERROR CostFunction-> Number of Effective Walkers is too small! 
  Number of effective walkers (samples) / total number of samples = 0.0849288
  User specified threshold minwalkers = 0.3
  If this message appears frequently. You might have to be cautious. 
  Find info about parameter "minwalkers" in the user manual!
Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268322387520
                                         uncertainty =       0.001338286307

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268322387520
                                         uncertainty =       0.001338286307

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366269625
  error estimate for blocks of size 2^( 2) =       0.000380248418
  error estimate for blocks of size 2^( 3) =       0.000392765719
  error estimate for blocks of size 2^( 4) =       0.000402069076
  error estimate for blocks of size 2^( 5) =       0.000407371972
  error estimate for blocks of size 2^( 6) =       0.000410689206
  error estimate for blocks of size 2^( 7) =       0.000413992753

      target function =      -0.946236445318
              le_mean =     -17.211515772751
             les_mean =     296.515472578736
             stat err =       0.000408530752
             autocorr =       1.244078255235
   target nu stat err =       0.000408530752
   target dn stat err =       0.001962922144
      target stat err =       0.003383137847
              std dev =       0.517983470809
             le_variance =       0.268306876032


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946149530100        initial
     2.5000e-01     2.5000e+00             3.9249e-04        -0.942405414358
     1.0000e+00     1.0000e+01             1.1999e-04        -0.903097606345
     4.0000e+00     4.0000e+01             3.1859e-05        -0.946236445318  <--

*****************************************************************************
Applying the update for shift_i =   4.0000e+00     and shift_s =   4.0000e+01
*****************************************************************************

  Execution time = 2.3174e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
ci_001                -4.195175e-02 3 1  ON 0
ci_002                -3.210554e-02 3 1  ON 1
ci_003                -2.651955e-02 3 1  ON 2
ci_004                 2.374206e-02 3 1  ON 3
ci_005                 2.414939e-02 3 1  ON 4
ci_006                -2.149603e-02 3 1  ON 5
ci_007                -2.111436e-02 3 1  ON 6
ci_008                -8.498200e-03 3 1  ON 7
ci_009                -1.371483e-02 3 1  ON 8
ci_010                -1.009208e-02 3 1  ON 9
ci_011                -1.140046e-02 3 1  ON 10
ci_012                -9.743474e-03 3 1  ON 11
ci_013                -1.986606e-02 3 1  ON 12
ci_014                 1.226553e-02 3 1  ON 13
ci_015                 1.187181e-02 3 1  ON 14
ci_016                 1.757152e-02 3 1  ON 15
ci_017                 1.637434e-02 3 1  ON 16
ci_018                 1.025179e-02 3 1  ON 17
ci_019                 1.007937e-02 3 1  ON 18
ci_020                 1.794580e-02 3 1  ON 19
ci_021                 1.755057e-02 3 1  ON 20
ci_022                 9.152493e-03 3 1  ON 21
ci_023                 9.152290e-03 3 1  ON 22
ci_024                 9.634892e-03 3 1  ON 23
ci_025                 1.027835e-02 3 1  ON 24
ci_026                 1.170866e-02 3 1  ON 25
ci_027                 1.181337e-02 3 1  ON 26
ci_028                -1.469547e-02 3 1  ON 27
ci_029                -1.660627e-02 3 1  ON 28
ci_030                -9.583191e-03 3 1  ON 29
ci_031                -9.004733e-03 3 1  ON 30
ci_032                -1.469957e-02 3 1  ON 31
ci_033                 5.158657e-03 3 1  ON 32
ci_034                 5.623149e-03 3 1  ON 33
ci_035                -5.100430e-03 3 1  ON 34
ci_036                -1.278031e-02 3 1  ON 35
ci_037                -1.232137e-02 3 1  ON 36
ci_038                 2.160212e-03 3 1  ON 37
ci_039                 1.725325e-03 3 1  ON 38
ci_040                -3.242641e-03 3 1  ON 39
ci_041                 9.618920e-03 3 1  ON 40
ci_042                 8.176109e-03 3 1  ON 41
ci_043                -4.139897e-03 3 1  ON 42
ci_044                -3.878335e-03 3 1  ON 43
ci_045                -3.629794e-03 3 1  ON 44
ci_046                 5.645056e-03 3 1  ON 45
ci_047                 5.508450e-03 3 1  ON 46
ci_048                -1.260746e-02 3 1  ON 47
ci_049                -1.450490e-02 3 1  ON 48
ci_050                 3.105851e-03 3 1  ON 49
ci_051                 2.738319e-03 3 1  ON 50
ci_052                -2.288859e-03 3 1  ON 51
ci_053                -2.449615e-03 3 1  ON 52
ci_054                -3.442733e-03 3 1  ON 53
ci_055                -2.986126e-03 3 1  ON 54
ci_056                 5.612935e-03 3 1  ON 55
ci_057                 5.291641e-03 3 1  ON 56
ci_058                -9.636625e-04 3 1  ON 57
ci_059                -2.305604e-03 3 1  ON 58
ci_060                 4.592933e-03 3 1  ON 59
ci_061                 5.727296e-03 3 1  ON 60
ci_062                -3.725519e-03 3 1  ON 61
ci_063                -4.033332e-03 3 1  ON 62
ci_064                -2.520110e-03 3 1  ON 63
ci_065                -4.363372e-03 3 1  ON 64
ci_066                 4.421043e-03 3 1  ON 65
ci_067                 4.362172e-03 3 1  ON 66
ci_068                -4.159387e-03 3 1  ON 67
ci_069                -5.078149e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9678e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7189e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2802
    reference variance = 0.221605
====================================================
  Execution time = 1.4068e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5330e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8400e-01
  Total weights = 1.957581343e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5091e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270125236824
                                         uncertainty =       0.001333805037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270125236824
                                         uncertainty =       0.001333805037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367453735
  error estimate for blocks of size 2^( 2) =       0.000381500223
  error estimate for blocks of size 2^( 3) =       0.000393642549
  error estimate for blocks of size 2^( 4) =       0.000403186927
  error estimate for blocks of size 2^( 5) =       0.000408756560
  error estimate for blocks of size 2^( 6) =       0.000410879328
  error estimate for blocks of size 2^( 7) =       0.000411283776

      target function =      -0.938200638371
              le_mean =     -17.212342139478
             les_mean =     296.548717271812
             stat err =       0.000408526648
             autocorr =       1.236048315450
   target nu stat err =       0.000408526648
   target dn stat err =       0.003476216490
      target stat err =       0.005806623494
              std dev =       0.519658056279
             le_variance =       0.270044495456


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721234213948e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938235474389       residual = 1.92e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938300523687       residual = 2.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938308413267       residual = 5.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938311146575       residual = 9.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938311525838       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938311599177       residual = 4.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938311604718       residual = 8.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938311598547       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938311597675       residual = 4.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938311599652       residual = 7.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+00 is 1.520162e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938235474389       residual = 1.92e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938252707731       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938254772949       residual = 5.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938255473951       residual = 8.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938255569875       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938255587752       residual = 3.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938255589086       residual = 7.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938255587511       residual = 2.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938255587301       residual = 3.97e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938255587781       residual = 6.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+00 is 3.980088e-05

solving harmonic davidson linear method for identity shift 1.6000e+01, overlap shift 1.6000e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938235474389       residual = 1.92e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938239848006       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938240370441       residual = 5.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938240546798       residual = 8.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938240570841       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938240575277       residual = 3.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938240575607       residual = 6.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938240575211       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938240575160       residual = 3.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938240575279       residual = 6.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+01 is 1.006928e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.026333 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6594e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_001                -4.193712e-02 3 1  ON 0
ci_002                -3.207810e-02 3 1  ON 1
ci_003                -2.650136e-02 3 1  ON 2
ci_004                 2.372640e-02 3 1  ON 3
ci_005                 2.413389e-02 3 1  ON 4
ci_006                -2.145623e-02 3 1  ON 5
ci_007                -2.111322e-02 3 1  ON 6
ci_008                -8.510499e-03 3 1  ON 7
ci_009                -1.373084e-02 3 1  ON 8
ci_010                -1.008802e-02 3 1  ON 9
ci_011                -1.138372e-02 3 1  ON 10
ci_012                -9.757678e-03 3 1  ON 11
ci_013                -1.985596e-02 3 1  ON 12
ci_014                 1.224747e-02 3 1  ON 13
ci_015                 1.187325e-02 3 1  ON 14
ci_016                 1.756588e-02 3 1  ON 15
ci_017                 1.637291e-02 3 1  ON 16
ci_018                 1.023593e-02 3 1  ON 17
ci_019                 1.010116e-02 3 1  ON 18
ci_020                 1.790903e-02 3 1  ON 19
ci_021                 1.752740e-02 3 1  ON 20
ci_022                 9.165947e-03 3 1  ON 21
ci_023                 9.144529e-03 3 1  ON 22
ci_024                 9.614884e-03 3 1  ON 23
ci_025                 1.026344e-02 3 1  ON 24
ci_026                 1.169113e-02 3 1  ON 25
ci_027                 1.177952e-02 3 1  ON 26
ci_028                -1.471300e-02 3 1  ON 27
ci_029                -1.659609e-02 3 1  ON 28
ci_030                -9.587502e-03 3 1  ON 29
ci_031                -9.021894e-03 3 1  ON 30
ci_032                -1.469859e-02 3 1  ON 31
ci_033                 5.188587e-03 3 1  ON 32
ci_034                 5.620707e-03 3 1  ON 33
ci_035                -5.099215e-03 3 1  ON 34
ci_036                -1.276294e-02 3 1  ON 35
ci_037                -1.235261e-02 3 1  ON 36
ci_038                 2.153303e-03 3 1  ON 37
ci_039                 1.731133e-03 3 1  ON 38
ci_040                -3.237858e-03 3 1  ON 39
ci_041                 9.590965e-03 3 1  ON 40
ci_042                 8.184653e-03 3 1  ON 41
ci_043                -4.134333e-03 3 1  ON 42
ci_044                -3.875909e-03 3 1  ON 43
ci_045                -3.623718e-03 3 1  ON 44
ci_046                 5.653750e-03 3 1  ON 45
ci_047                 5.508489e-03 3 1  ON 46
ci_048                -1.260384e-02 3 1  ON 47
ci_049                -1.449107e-02 3 1  ON 48
ci_050                 3.090733e-03 3 1  ON 49
ci_051                 2.750806e-03 3 1  ON 50
ci_052                -2.275270e-03 3 1  ON 51
ci_053                -2.447465e-03 3 1  ON 52
ci_054                -3.430888e-03 3 1  ON 53
ci_055                -2.972869e-03 3 1  ON 54
ci_056                 5.614394e-03 3 1  ON 55
ci_057                 5.293825e-03 3 1  ON 56
ci_058                -9.829478e-04 3 1  ON 57
ci_059                -2.299026e-03 3 1  ON 58
ci_060                 4.588929e-03 3 1  ON 59
ci_061                 5.735323e-03 3 1  ON 60
ci_062                -3.724666e-03 3 1  ON 61
ci_063                -4.042883e-03 3 1  ON 62
ci_064                -2.530358e-03 3 1  ON 63
ci_065                -4.365025e-03 3 1  ON 64
ci_066                 4.438314e-03 3 1  ON 65
ci_067                 4.365249e-03 3 1  ON 66
ci_068                -4.136421e-03 3 1  ON 67
ci_069                -5.074820e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1979
    reference variance = 0.181104
====================================================
  Execution time = 1.3774e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7775e-01
  Total weights = 1.9575e+06
  Execution time = 1.8180e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266893279887
                                         uncertainty =       0.001574094925

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266893279887
                                         uncertainty =       0.001574094925

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365328484
  error estimate for blocks of size 2^( 2) =       0.000378882761
  error estimate for blocks of size 2^( 3) =       0.000391973824
  error estimate for blocks of size 2^( 4) =       0.000401150727
  error estimate for blocks of size 2^( 5) =       0.000407168105
  error estimate for blocks of size 2^( 6) =       0.000411476871
  error estimate for blocks of size 2^( 7) =       0.000414141010

      target function =      -0.948881142629
              le_mean =     -17.211564905275
             les_mean =     296.515596803861
             stat err =       0.000408484178
             autocorr =       1.250211270513
   target nu stat err =       0.000408484178
   target dn stat err =       0.002069021626
      target stat err =       0.003577589558
              std dev =       0.516652496782
             le_variance =       0.266929802431

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266852723822
                                         uncertainty =       0.001570482794

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266852723822
                                         uncertainty =       0.001570482794

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365301100
  error estimate for blocks of size 2^( 2) =       0.000378861108
  error estimate for blocks of size 2^( 3) =       0.000391960389
  error estimate for blocks of size 2^( 4) =       0.000401142273
  error estimate for blocks of size 2^( 5) =       0.000407161678
  error estimate for blocks of size 2^( 6) =       0.000411477217
  error estimate for blocks of size 2^( 7) =       0.000414131194

      target function =      -0.947150184438
              le_mean =     -17.211566133881
             les_mean =     296.516659936825
             stat err =       0.000408478090
             autocorr =       1.250361449621
   target nu stat err =       0.000408478090
   target dn stat err =       0.002506537097
      target stat err =       0.004289926317
              std dev =       0.516613769331
             le_variance =       0.266889786662

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266870655283
                                         uncertainty =       0.001572165679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266870655283
                                         uncertainty =       0.001572165679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365313196
  error estimate for blocks of size 2^( 2) =       0.000378870437
  error estimate for blocks of size 2^( 3) =       0.000391965845
  error estimate for blocks of size 2^( 4) =       0.000401145325
  error estimate for blocks of size 2^( 5) =       0.000407163803
  error estimate for blocks of size 2^( 6) =       0.000411476164
  error estimate for blocks of size 2^( 7) =       0.000414134957

      target function =      -0.948336107176
              le_mean =     -17.211565449844
             les_mean =     296.515936839487
             stat err =       0.000408480063
             autocorr =       1.250290719156
   target nu stat err =       0.000408480063
   target dn stat err =       0.002183509734
      target stat err =       0.003763308065
              std dev =       0.516630876225
             le_variance =       0.266907462269

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266890268176
                                         uncertainty =       0.001573847857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266890268176
                                         uncertainty =       0.001573847857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365326448
  error estimate for blocks of size 2^( 2) =       0.000378881098
  error estimate for blocks of size 2^( 3) =       0.000391972713
  error estimate for blocks of size 2^( 4) =       0.000401149940
  error estimate for blocks of size 2^( 5) =       0.000407167459
  error estimate for blocks of size 2^( 6) =       0.000411476681
  error estimate for blocks of size 2^( 7) =       0.000414140144

      target function =      -0.948838106728
              le_mean =     -17.211564959701
             les_mean =     296.515624037115
             stat err =       0.000408483556
             autocorr =       1.250221400293
   target nu stat err =       0.000408483556
   target dn stat err =       0.002077732238
      target stat err =       0.003591708976
              std dev =       0.516649616889
             le_variance =       0.266926826631


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948881142629        initial  <--
     1.0000e+00     1.0000e+01             1.5202e-04        -0.947150184438
     4.0000e+00     4.0000e+01             3.9801e-05        -0.948336107176
     1.6000e+01     1.6000e+02             1.0069e-05        -0.948838106728

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1191
  </log>
  <optVariables href="H2O.s004.opt.xml">
ci_001                -4.195175e-02 3 1  ON 0
ci_002                -3.210554e-02 3 1  ON 1
ci_003                -2.651955e-02 3 1  ON 2
ci_004                 2.374206e-02 3 1  ON 3
ci_005                 2.414939e-02 3 1  ON 4
ci_006                -2.149603e-02 3 1  ON 5
ci_007                -2.111436e-02 3 1  ON 6
ci_008                -8.498200e-03 3 1  ON 7
ci_009                -1.371483e-02 3 1  ON 8
ci_010                -1.009208e-02 3 1  ON 9
ci_011                -1.140046e-02 3 1  ON 10
ci_012                -9.743474e-03 3 1  ON 11
ci_013                -1.986606e-02 3 1  ON 12
ci_014                 1.226553e-02 3 1  ON 13
ci_015                 1.187181e-02 3 1  ON 14
ci_016                 1.757152e-02 3 1  ON 15
ci_017                 1.637434e-02 3 1  ON 16
ci_018                 1.025179e-02 3 1  ON 17
ci_019                 1.007937e-02 3 1  ON 18
ci_020                 1.794580e-02 3 1  ON 19
ci_021                 1.755057e-02 3 1  ON 20
ci_022                 9.152493e-03 3 1  ON 21
ci_023                 9.152290e-03 3 1  ON 22
ci_024                 9.634892e-03 3 1  ON 23
ci_025                 1.027835e-02 3 1  ON 24
ci_026                 1.170866e-02 3 1  ON 25
ci_027                 1.181337e-02 3 1  ON 26
ci_028                -1.469547e-02 3 1  ON 27
ci_029                -1.660627e-02 3 1  ON 28
ci_030                -9.583191e-03 3 1  ON 29
ci_031                -9.004733e-03 3 1  ON 30
ci_032                -1.469957e-02 3 1  ON 31
ci_033                 5.158657e-03 3 1  ON 32
ci_034                 5.623149e-03 3 1  ON 33
ci_035                -5.100430e-03 3 1  ON 34
ci_036                -1.278031e-02 3 1  ON 35
ci_037                -1.232137e-02 3 1  ON 36
ci_038                 2.160212e-03 3 1  ON 37
ci_039                 1.725325e-03 3 1  ON 38
ci_040                -3.242641e-03 3 1  ON 39
ci_041                 9.618920e-03 3 1  ON 40
ci_042                 8.176109e-03 3 1  ON 41
ci_043                -4.139897e-03 3 1  ON 42
ci_044                -3.878335e-03 3 1  ON 43
ci_045                -3.629794e-03 3 1  ON 44
ci_046                 5.645056e-03 3 1  ON 45
ci_047                 5.508450e-03 3 1  ON 46
ci_048                -1.260746e-02 3 1  ON 47
ci_049                -1.450490e-02 3 1  ON 48
ci_050                 3.105851e-03 3 1  ON 49
ci_051                 2.738319e-03 3 1  ON 50
ci_052                -2.288859e-03 3 1  ON 51
ci_053                -2.449615e-03 3 1  ON 52
ci_054                -3.442733e-03 3 1  ON 53
ci_055                -2.986126e-03 3 1  ON 54
ci_056                 5.612935e-03 3 1  ON 55
ci_057                 5.291641e-03 3 1  ON 56
ci_058                -9.636625e-04 3 1  ON 57
ci_059                -2.305604e-03 3 1  ON 58
ci_060                 4.592933e-03 3 1  ON 59
ci_061                 5.727296e-03 3 1  ON 60
ci_062                -3.725519e-03 3 1  ON 61
ci_063                -4.033332e-03 3 1  ON 62
ci_064                -2.520110e-03 3 1  ON 63
ci_065                -4.363372e-03 3 1  ON 64
ci_066                 4.421043e-03 3 1  ON 65
ci_067                 4.362172e-03 3 1  ON 66
ci_068                -4.159387e-03 3 1  ON 67
ci_069                -5.078149e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9728e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7199e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2567
    reference variance = 0.270656
====================================================
  Execution time = 1.4145e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7480e-01
  Total weights = 1.957253243e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5017e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265389289379
                                         uncertainty =       0.001447880881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265389289379
                                         uncertainty =       0.001447880881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364301158
  error estimate for blocks of size 2^( 2) =       0.000378196259
  error estimate for blocks of size 2^( 3) =       0.000390918644
  error estimate for blocks of size 2^( 4) =       0.000400083461
  error estimate for blocks of size 2^( 5) =       0.000406301053
  error estimate for blocks of size 2^( 6) =       0.000409074051
  error estimate for blocks of size 2^( 7) =       0.000409997083

      target function =      -0.953722362332
              le_mean =     -17.212273293111
             les_mean =     296.537149156439
             stat err =       0.000406363912
             autocorr =       1.244254333392
   target nu stat err =       0.000406363912
   target dn stat err =       0.001773982969
      target stat err =       0.003124271036
              std dev =       0.515199638033
             le_variance =       0.265430667030


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721227329311e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.953731511348       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.953736703678       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.953737649282       residual = 5.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.953737991087       residual = 7.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.953738020614       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.953738026244       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.953738038392       residual = 6.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.953738036113       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.953738036873       residual = 3.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.953738037318       residual = 6.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+01 is 1.607988e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.953731511348       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.953732817281       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.953733054758       residual = 5.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.953733140506       residual = 7.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.953733147892       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.953733149297       residual = 3.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.953733152335       residual = 6.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.953733151763       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.953733151954       residual = 3.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.953733152065       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+01 is 4.040576e-06

solving harmonic davidson linear method for identity shift 1.6000e+02, overlap shift 1.6000e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.953731511348       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.953731838326       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.953731897763       residual = 5.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.953731919218       residual = 7.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.953731921065       residual = 1.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.953731921416       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.953731922176       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.953731922033       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.953731922081       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.953731922108       residual = 6.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+02 is 1.011440e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.034542 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6663e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_001                -4.194929e-02 3 1  ON 0
ci_002                -3.210493e-02 3 1  ON 1
ci_003                -2.651824e-02 3 1  ON 2
ci_004                 2.374182e-02 3 1  ON 3
ci_005                 2.415054e-02 3 1  ON 4
ci_006                -2.149366e-02 3 1  ON 5
ci_007                -2.111287e-02 3 1  ON 6
ci_008                -8.498881e-03 3 1  ON 7
ci_009                -1.371530e-02 3 1  ON 8
ci_010                -1.009125e-02 3 1  ON 9
ci_011                -1.139962e-02 3 1  ON 10
ci_012                -9.744991e-03 3 1  ON 11
ci_013                -1.986368e-02 3 1  ON 12
ci_014                 1.226855e-02 3 1  ON 13
ci_015                 1.187333e-02 3 1  ON 14
ci_016                 1.756913e-02 3 1  ON 15
ci_017                 1.637475e-02 3 1  ON 16
ci_018                 1.025098e-02 3 1  ON 17
ci_019                 1.008005e-02 3 1  ON 18
ci_020                 1.794176e-02 3 1  ON 19
ci_021                 1.754917e-02 3 1  ON 20
ci_022                 9.152404e-03 3 1  ON 21
ci_023                 9.153361e-03 3 1  ON 22
ci_024                 9.633444e-03 3 1  ON 23
ci_025                 1.027675e-02 3 1  ON 24
ci_026                 1.170710e-02 3 1  ON 25
ci_027                 1.181256e-02 3 1  ON 26
ci_028                -1.469702e-02 3 1  ON 27
ci_029                -1.660419e-02 3 1  ON 28
ci_030                -9.580694e-03 3 1  ON 29
ci_031                -9.005146e-03 3 1  ON 30
ci_032                -1.469855e-02 3 1  ON 31
ci_033                 5.161655e-03 3 1  ON 32
ci_034                 5.625273e-03 3 1  ON 33
ci_035                -5.100143e-03 3 1  ON 34
ci_036                -1.278161e-02 3 1  ON 35
ci_037                -1.232287e-02 3 1  ON 36
ci_038                 2.159731e-03 3 1  ON 37
ci_039                 1.725235e-03 3 1  ON 38
ci_040                -3.241753e-03 3 1  ON 39
ci_041                 9.616651e-03 3 1  ON 40
ci_042                 8.176279e-03 3 1  ON 41
ci_043                -4.139143e-03 3 1  ON 42
ci_044                -3.880228e-03 3 1  ON 43
ci_045                -3.628861e-03 3 1  ON 44
ci_046                 5.643678e-03 3 1  ON 45
ci_047                 5.509146e-03 3 1  ON 46
ci_048                -1.260722e-02 3 1  ON 47
ci_049                -1.450131e-02 3 1  ON 48
ci_050                 3.106337e-03 3 1  ON 49
ci_051                 2.738621e-03 3 1  ON 50
ci_052                -2.289922e-03 3 1  ON 51
ci_053                -2.449377e-03 3 1  ON 52
ci_054                -3.441629e-03 3 1  ON 53
ci_055                -2.986385e-03 3 1  ON 54
ci_056                 5.611742e-03 3 1  ON 55
ci_057                 5.291441e-03 3 1  ON 56
ci_058                -9.655714e-04 3 1  ON 57
ci_059                -2.304943e-03 3 1  ON 58
ci_060                 4.594458e-03 3 1  ON 59
ci_061                 5.728108e-03 3 1  ON 60
ci_062                -3.726112e-03 3 1  ON 61
ci_063                -4.033089e-03 3 1  ON 62
ci_064                -2.521136e-03 3 1  ON 63
ci_065                -4.363553e-03 3 1  ON 64
ci_066                 4.422101e-03 3 1  ON 65
ci_067                 4.362931e-03 3 1  ON 66
ci_068                -4.160183e-03 3 1  ON 67
ci_069                -5.076673e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1984
    reference variance = 0.209618
====================================================
  Execution time = 1.3653e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7566e-01
  Total weights = 1.9571e+06
  Execution time = 1.8358e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264732099252
                                         uncertainty =       0.001332678691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264732099252
                                         uncertainty =       0.001332678691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363823798
  error estimate for blocks of size 2^( 2) =       0.000378373997
  error estimate for blocks of size 2^( 3) =       0.000391297179
  error estimate for blocks of size 2^( 4) =       0.000400512229
  error estimate for blocks of size 2^( 5) =       0.000406858628
  error estimate for blocks of size 2^( 6) =       0.000410161639
  error estimate for blocks of size 2^( 7) =       0.000412960136

      target function =      -0.952250406022
              le_mean =     -17.212020200161
             les_mean =     296.529292937722
             stat err =       0.000407623158
             autocorr =       1.255265207045
   target nu stat err =       0.000407623158
   target dn stat err =       0.001978186297
      target stat err =       0.003453642022
              std dev =       0.514524549785
             le_variance =       0.264735512332

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264728886480
                                         uncertainty =       0.001332815047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264728886480
                                         uncertainty =       0.001332815047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363821603
  error estimate for blocks of size 2^( 2) =       0.000378371692
  error estimate for blocks of size 2^( 3) =       0.000391295166
  error estimate for blocks of size 2^( 4) =       0.000400510336
  error estimate for blocks of size 2^( 5) =       0.000406857120
  error estimate for blocks of size 2^( 6) =       0.000410160308
  error estimate for blocks of size 2^( 7) =       0.000412959485

      target function =      -0.952164807237
              le_mean =     -17.212020144105
             les_mean =     296.529341103270
             stat err =       0.000407621812
             autocorr =       1.255272069534
   target nu stat err =       0.000407621812
   target dn stat err =       0.001988603788
      target stat err =       0.003470407423
              std dev =       0.514521444568
             le_variance =       0.264732316921

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264730467634
                                         uncertainty =       0.001332746650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264730467634
                                         uncertainty =       0.001332746650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363822683
  error estimate for blocks of size 2^( 2) =       0.000378372827
  error estimate for blocks of size 2^( 3) =       0.000391296156
  error estimate for blocks of size 2^( 4) =       0.000400511266
  error estimate for blocks of size 2^( 5) =       0.000406857858
  error estimate for blocks of size 2^( 6) =       0.000410160958
  error estimate for blocks of size 2^( 7) =       0.000412959795

      target function =      -0.952210392880
              le_mean =     -17.212020170749
             les_mean =     296.529315340325
             stat err =       0.000407622469
             autocorr =       1.255268662040
   target nu stat err =       0.000407622469
   target dn stat err =       0.001983173397
      target stat err =       0.003461675127
              std dev =       0.514522972702
             le_variance =       0.264733889438

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264731893213
                                         uncertainty =       0.001332687125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264731893213
                                         uncertainty =       0.001332687125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363823657
  error estimate for blocks of size 2^( 2) =       0.000378373849
  error estimate for blocks of size 2^( 3) =       0.000391297050
  error estimate for blocks of size 2^( 4) =       0.000400512107
  error estimate for blocks of size 2^( 5) =       0.000406858530
  error estimate for blocks of size 2^( 6) =       0.000410161552
  error estimate for blocks of size 2^( 7) =       0.000412960092

      target function =      -0.952245765894
              le_mean =     -17.212020196341
             les_mean =     296.529295521303
             stat err =       0.000407623070
             autocorr =       1.255265640263
   target nu stat err =       0.000407623070
   target dn stat err =       0.001978785359
      target stat err =       0.003454608180
              std dev =       0.514524350624
             le_variance =       0.264735307385


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.952250406022        initial  <--
     1.0000e+01     1.0000e+02             1.6080e-05        -0.952164807237
     4.0000e+01     4.0000e+02             4.0406e-06        -0.952210392880
     1.6000e+02     1.6000e+03             1.0114e-06        -0.952245765894

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0253
  </log>
  <optVariables href="H2O.s005.opt.xml">
ci_001                -4.195175e-02 3 1  ON 0
ci_002                -3.210554e-02 3 1  ON 1
ci_003                -2.651955e-02 3 1  ON 2
ci_004                 2.374206e-02 3 1  ON 3
ci_005                 2.414939e-02 3 1  ON 4
ci_006                -2.149603e-02 3 1  ON 5
ci_007                -2.111436e-02 3 1  ON 6
ci_008                -8.498200e-03 3 1  ON 7
ci_009                -1.371483e-02 3 1  ON 8
ci_010                -1.009208e-02 3 1  ON 9
ci_011                -1.140046e-02 3 1  ON 10
ci_012                -9.743474e-03 3 1  ON 11
ci_013                -1.986606e-02 3 1  ON 12
ci_014                 1.226553e-02 3 1  ON 13
ci_015                 1.187181e-02 3 1  ON 14
ci_016                 1.757152e-02 3 1  ON 15
ci_017                 1.637434e-02 3 1  ON 16
ci_018                 1.025179e-02 3 1  ON 17
ci_019                 1.007937e-02 3 1  ON 18
ci_020                 1.794580e-02 3 1  ON 19
ci_021                 1.755057e-02 3 1  ON 20
ci_022                 9.152493e-03 3 1  ON 21
ci_023                 9.152290e-03 3 1  ON 22
ci_024                 9.634892e-03 3 1  ON 23
ci_025                 1.027835e-02 3 1  ON 24
ci_026                 1.170866e-02 3 1  ON 25
ci_027                 1.181337e-02 3 1  ON 26
ci_028                -1.469547e-02 3 1  ON 27
ci_029                -1.660627e-02 3 1  ON 28
ci_030                -9.583191e-03 3 1  ON 29
ci_031                -9.004733e-03 3 1  ON 30
ci_032                -1.469957e-02 3 1  ON 31
ci_033                 5.158657e-03 3 1  ON 32
ci_034                 5.623149e-03 3 1  ON 33
ci_035                -5.100430e-03 3 1  ON 34
ci_036                -1.278031e-02 3 1  ON 35
ci_037                -1.232137e-02 3 1  ON 36
ci_038                 2.160212e-03 3 1  ON 37
ci_039                 1.725325e-03 3 1  ON 38
ci_040                -3.242641e-03 3 1  ON 39
ci_041                 9.618920e-03 3 1  ON 40
ci_042                 8.176109e-03 3 1  ON 41
ci_043                -4.139897e-03 3 1  ON 42
ci_044                -3.878335e-03 3 1  ON 43
ci_045                -3.629794e-03 3 1  ON 44
ci_046                 5.645056e-03 3 1  ON 45
ci_047                 5.508450e-03 3 1  ON 46
ci_048                -1.260746e-02 3 1  ON 47
ci_049                -1.450490e-02 3 1  ON 48
ci_050                 3.105851e-03 3 1  ON 49
ci_051                 2.738319e-03 3 1  ON 50
ci_052                -2.288859e-03 3 1  ON 51
ci_053                -2.449615e-03 3 1  ON 52
ci_054                -3.442733e-03 3 1  ON 53
ci_055                -2.986126e-03 3 1  ON 54
ci_056                 5.612935e-03 3 1  ON 55
ci_057                 5.291641e-03 3 1  ON 56
ci_058                -9.636625e-04 3 1  ON 57
ci_059                -2.305604e-03 3 1  ON 58
ci_060                 4.592933e-03 3 1  ON 59
ci_061                 5.727296e-03 3 1  ON 60
ci_062                -3.725519e-03 3 1  ON 61
ci_063                -4.033332e-03 3 1  ON 62
ci_064                -2.520110e-03 3 1  ON 63
ci_065                -4.363372e-03 3 1  ON 64
ci_066                 4.421043e-03 3 1  ON 65
ci_067                 4.362172e-03 3 1  ON 66
ci_068                -4.159387e-03 3 1  ON 67
ci_069                -5.078149e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9704e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.0947
    reference variance = 0.230578
====================================================
  Execution time = 1.6334e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5296e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7579e-01
  Total weights = 1.957177333e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4908e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265494281740
                                         uncertainty =       0.001281578325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265494281740
                                         uncertainty =       0.001281578325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364305239
  error estimate for blocks of size 2^( 2) =       0.000378313921
  error estimate for blocks of size 2^( 3) =       0.000390780805
  error estimate for blocks of size 2^( 4) =       0.000400442943
  error estimate for blocks of size 2^( 5) =       0.000404934678
  error estimate for blocks of size 2^( 6) =       0.000406979504
  error estimate for blocks of size 2^( 7) =       0.000408304750

      target function =      -0.952003415782
              le_mean =     -17.211685243026
             les_mean =     296.517902986748
             stat err =       0.000405165469
             autocorr =       1.236898365721
   target nu stat err =       0.000405165469
   target dn stat err =       0.001986004145
      target stat err =       0.003461816070
              std dev =       0.515205409696
             le_variance =       0.265436614180


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721168524303e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952014939009       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952015553600       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952015615119       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.952015636839       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.952015636902       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.952015637862       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.952015638144       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.952015637915       residual = 6.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.952015637881       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.952015637891       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+02 is 1.474603e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952014939009       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952015092751       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952015108138       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.952015113570       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.952015113586       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.952015113825       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.952015113896       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.952015113839       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.952015113830       residual = 1.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.952015113833       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+02 is 3.688780e-07

solving harmonic davidson linear method for identity shift 1.6000e+03, overlap shift 1.6000e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952014939009       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952014977451       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952014981298       residual = 3.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.952014982656       residual = 6.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.952014982660       residual = 1.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.952014982720       residual = 1.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.952014982737       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.952014982723       residual = 6.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.952014982721       residual = 1.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.952014982722       residual = 2.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.6000e+03 is 9.223371e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.037968 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8833e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_001                -4.195157e-02 3 1  ON 0
ci_002                -3.210546e-02 3 1  ON 1
ci_003                -2.651940e-02 3 1  ON 2
ci_004                 2.374205e-02 3 1  ON 3
ci_005                 2.414923e-02 3 1  ON 4
ci_006                -2.149609e-02 3 1  ON 5
ci_007                -2.111427e-02 3 1  ON 6
ci_008                -8.498214e-03 3 1  ON 7
ci_009                -1.371511e-02 3 1  ON 8
ci_010                -1.009204e-02 3 1  ON 9
ci_011                -1.140026e-02 3 1  ON 10
ci_012                -9.743586e-03 3 1  ON 11
ci_013                -1.986607e-02 3 1  ON 12
ci_014                 1.226564e-02 3 1  ON 13
ci_015                 1.187205e-02 3 1  ON 14
ci_016                 1.757142e-02 3 1  ON 15
ci_017                 1.637430e-02 3 1  ON 16
ci_018                 1.025165e-02 3 1  ON 17
ci_019                 1.007950e-02 3 1  ON 18
ci_020                 1.794546e-02 3 1  ON 19
ci_021                 1.755052e-02 3 1  ON 20
ci_022                 9.152531e-03 3 1  ON 21
ci_023                 9.152354e-03 3 1  ON 22
ci_024                 9.634884e-03 3 1  ON 23
ci_025                 1.027801e-02 3 1  ON 24
ci_026                 1.170858e-02 3 1  ON 25
ci_027                 1.181331e-02 3 1  ON 26
ci_028                -1.469561e-02 3 1  ON 27
ci_029                -1.660622e-02 3 1  ON 28
ci_030                -9.583070e-03 3 1  ON 29
ci_031                -9.004584e-03 3 1  ON 30
ci_032                -1.469953e-02 3 1  ON 31
ci_033                 5.158941e-03 3 1  ON 32
ci_034                 5.623196e-03 3 1  ON 33
ci_035                -5.100485e-03 3 1  ON 34
ci_036                -1.278031e-02 3 1  ON 35
ci_037                -1.232174e-02 3 1  ON 36
ci_038                 2.160072e-03 3 1  ON 37
ci_039                 1.725398e-03 3 1  ON 38
ci_040                -3.242636e-03 3 1  ON 39
ci_041                 9.618796e-03 3 1  ON 40
ci_042                 8.175865e-03 3 1  ON 41
ci_043                -4.139839e-03 3 1  ON 42
ci_044                -3.878508e-03 3 1  ON 43
ci_045                -3.629610e-03 3 1  ON 44
ci_046                 5.644929e-03 3 1  ON 45
ci_047                 5.508505e-03 3 1  ON 46
ci_048                -1.260747e-02 3 1  ON 47
ci_049                -1.450487e-02 3 1  ON 48
ci_050                 3.105989e-03 3 1  ON 49
ci_051                 2.738366e-03 3 1  ON 50
ci_052                -2.288900e-03 3 1  ON 51
ci_053                -2.449635e-03 3 1  ON 52
ci_054                -3.442685e-03 3 1  ON 53
ci_055                -2.986048e-03 3 1  ON 54
ci_056                 5.612857e-03 3 1  ON 55
ci_057                 5.291597e-03 3 1  ON 56
ci_058                -9.639393e-04 3 1  ON 57
ci_059                -2.305690e-03 3 1  ON 58
ci_060                 4.592887e-03 3 1  ON 59
ci_061                 5.727185e-03 3 1  ON 60
ci_062                -3.725470e-03 3 1  ON 61
ci_063                -4.033342e-03 3 1  ON 62
ci_064                -2.520237e-03 3 1  ON 63
ci_065                -4.363363e-03 3 1  ON 64
ci_066                 4.421205e-03 3 1  ON 65
ci_067                 4.362143e-03 3 1  ON 66
ci_068                -4.159414e-03 3 1  ON 67
ci_069                -5.077986e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.2257
    reference variance = 0.131082
====================================================
  Execution time = 1.3792e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7626e-01
  Total weights = 1.9575e+06
  Execution time = 1.8275e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265884641493
                                         uncertainty =       0.001485730147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265884641493
                                         uncertainty =       0.001485730147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364613802
  error estimate for blocks of size 2^( 2) =       0.000378533917
  error estimate for blocks of size 2^( 3) =       0.000391712951
  error estimate for blocks of size 2^( 4) =       0.000400880555
  error estimate for blocks of size 2^( 5) =       0.000405398087
  error estimate for blocks of size 2^( 6) =       0.000408477414
  error estimate for blocks of size 2^( 7) =       0.000408858374

      target function =      -0.951206218203
              le_mean =     -17.211226318761
             les_mean =     296.502568367480
             stat err =       0.000405903608
             autocorr =       1.239309030971
   target nu stat err =       0.000405903608
   target dn stat err =       0.001908856722
      target stat err =       0.003325324414
              std dev =       0.515641783585
             le_variance =       0.265886448979

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265884285281
                                         uncertainty =       0.001485722459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265884285281
                                         uncertainty =       0.001485722459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364613559
  error estimate for blocks of size 2^( 2) =       0.000378533664
  error estimate for blocks of size 2^( 3) =       0.000391712679
  error estimate for blocks of size 2^( 4) =       0.000400880296
  error estimate for blocks of size 2^( 5) =       0.000405397800
  error estimate for blocks of size 2^( 6) =       0.000408477096
  error estimate for blocks of size 2^( 7) =       0.000408857975

      target function =      -0.951207088292
              le_mean =     -17.211226314669
             les_mean =     296.502567714581
             stat err =       0.000405903292
             autocorr =       1.239308755565
   target nu stat err =       0.000405903292
   target dn stat err =       0.001908886579
      target stat err =       0.003325379741
              std dev =       0.515641439625
             le_variance =       0.265886094259

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265884463183
                                         uncertainty =       0.001485726300

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265884463183
                                         uncertainty =       0.001485726300

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364613680
  error estimate for blocks of size 2^( 2) =       0.000378533791
  error estimate for blocks of size 2^( 3) =       0.000391712815
  error estimate for blocks of size 2^( 4) =       0.000400880426
  error estimate for blocks of size 2^( 5) =       0.000405397944
  error estimate for blocks of size 2^( 6) =       0.000408477255
  error estimate for blocks of size 2^( 7) =       0.000408858174

      target function =      -0.951206688694
              le_mean =     -17.211226316698
             les_mean =     296.502568019599
             stat err =       0.000405903450
             autocorr =       1.239308893220
   target nu stat err =       0.000405903450
   target dn stat err =       0.001908871242
      target stat err =       0.003325351642
              std dev =       0.515641611408
             le_variance =       0.265886271416

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265884619190
                                         uncertainty =       0.001485729666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265884619190
                                         uncertainty =       0.001485729666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364613787
  error estimate for blocks of size 2^( 2) =       0.000378533902
  error estimate for blocks of size 2^( 3) =       0.000391712934
  error estimate for blocks of size 2^( 4) =       0.000400880539
  error estimate for blocks of size 2^( 5) =       0.000405398069
  error estimate for blocks of size 2^( 6) =       0.000408477394
  error estimate for blocks of size 2^( 7) =       0.000408858349

      target function =      -0.951206280969
              le_mean =     -17.211226318501
             les_mean =     296.502568321608
             stat err =       0.000405903588
             autocorr =       1.239309013755
   target nu stat err =       0.000405903588
   target dn stat err =       0.001908858492
      target stat err =       0.003325327769
              std dev =       0.515641762049
             le_variance =       0.265886426769


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.951206218203        initial
     1.0000e+02     1.0000e+03             1.4746e-06        -0.951207088292  <--
     4.0000e+02     4.0000e+03             3.6888e-07        -0.951206688694
     1.6000e+03     1.6000e+04             9.2234e-08        -0.951206280969

*****************************************************************************
Applying the update for shift_i =   1.0000e+02     and shift_s =   1.0000e+03
*****************************************************************************

  Execution time = 2.3170e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
ci_001                -4.195103e-02 3 1  ON 0
ci_002                -3.210521e-02 3 1  ON 1
ci_003                -2.651897e-02 3 1  ON 2
ci_004                 2.374205e-02 3 1  ON 3
ci_005                 2.414876e-02 3 1  ON 4
ci_006                -2.149625e-02 3 1  ON 5
ci_007                -2.111398e-02 3 1  ON 6
ci_008                -8.498257e-03 3 1  ON 7
ci_009                -1.371594e-02 3 1  ON 8
ci_010                -1.009192e-02 3 1  ON 9
ci_011                -1.139968e-02 3 1  ON 10
ci_012                -9.743921e-03 3 1  ON 11
ci_013                -1.986612e-02 3 1  ON 12
ci_014                 1.226596e-02 3 1  ON 13
ci_015                 1.187276e-02 3 1  ON 14
ci_016                 1.757114e-02 3 1  ON 15
ci_017                 1.637417e-02 3 1  ON 16
ci_018                 1.025124e-02 3 1  ON 17
ci_019                 1.007989e-02 3 1  ON 18
ci_020                 1.794443e-02 3 1  ON 19
ci_021                 1.755036e-02 3 1  ON 20
ci_022                 9.152646e-03 3 1  ON 21
ci_023                 9.152549e-03 3 1  ON 22
ci_024                 9.634859e-03 3 1  ON 23
ci_025                 1.027700e-02 3 1  ON 24
ci_026                 1.170836e-02 3 1  ON 25
ci_027                 1.181312e-02 3 1  ON 26
ci_028                -1.469601e-02 3 1  ON 27
ci_029                -1.660608e-02 3 1  ON 28
ci_030                -9.582709e-03 3 1  ON 29
ci_031                -9.004136e-03 3 1  ON 30
ci_032                -1.469943e-02 3 1  ON 31
ci_033                 5.159792e-03 3 1  ON 32
ci_034                 5.623335e-03 3 1  ON 33
ci_035                -5.100650e-03 3 1  ON 34
ci_036                -1.278029e-02 3 1  ON 35
ci_037                -1.232285e-02 3 1  ON 36
ci_038                 2.159651e-03 3 1  ON 37
ci_039                 1.725616e-03 3 1  ON 38
ci_040                -3.242623e-03 3 1  ON 39
ci_041                 9.618426e-03 3 1  ON 40
ci_042                 8.175133e-03 3 1  ON 41
ci_043                -4.139665e-03 3 1  ON 42
ci_044                -3.879028e-03 3 1  ON 43
ci_045                -3.629060e-03 3 1  ON 44
ci_046                 5.644548e-03 3 1  ON 45
ci_047                 5.508673e-03 3 1  ON 46
ci_048                -1.260749e-02 3 1  ON 47
ci_049                -1.450479e-02 3 1  ON 48
ci_050                 3.106402e-03 3 1  ON 49
ci_051                 2.738510e-03 3 1  ON 50
ci_052                -2.289022e-03 3 1  ON 51
ci_053                -2.449694e-03 3 1  ON 52
ci_054                -3.442539e-03 3 1  ON 53
ci_055                -2.985817e-03 3 1  ON 54
ci_056                 5.612626e-03 3 1  ON 55
ci_057                 5.291468e-03 3 1  ON 56
ci_058                -9.647689e-04 3 1  ON 57
ci_059                -2.305945e-03 3 1  ON 58
ci_060                 4.592750e-03 3 1  ON 59
ci_061                 5.726853e-03 3 1  ON 60
ci_062                -3.725323e-03 3 1  ON 61
ci_063                -4.033373e-03 3 1  ON 62
ci_064                -2.520620e-03 3 1  ON 63
ci_065                -4.363337e-03 3 1  ON 64
ci_066                 4.421690e-03 3 1  ON 65
ci_067                 4.362054e-03 3 1  ON 66
ci_068                -4.159495e-03 3 1  ON 67
ci_069                -5.077497e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2010e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7197e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2244
    reference variance = 0.273865
====================================================
  Execution time = 1.4053e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7827e-01
  Total weights = 1.957434341e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5000e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267264363003
                                         uncertainty =       0.001689786336

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267264363003
                                         uncertainty =       0.001689786336

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365538028
  error estimate for blocks of size 2^( 2) =       0.000379509651
  error estimate for blocks of size 2^( 3) =       0.000392311462
  error estimate for blocks of size 2^( 4) =       0.000401476774
  error estimate for blocks of size 2^( 5) =       0.000407259947
  error estimate for blocks of size 2^( 6) =       0.000409237390
  error estimate for blocks of size 2^( 7) =       0.000411782818

      target function =      -0.947800179264
              le_mean =     -17.212186449802
             les_mean =     296.537633634823
             stat err =       0.000407439232
             autocorr =       1.242397473293
   target nu stat err =       0.000407439232
   target dn stat err =       0.002475741983
      target stat err =       0.004249116466
              std dev =       0.516948837397
             le_variance =       0.267236100486


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721218644980e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947818141798       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947820199591       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947820536694       residual = 5.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947820644464       residual = 8.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947820652012       residual = 1.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947820654065       residual = 3.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947820655023       residual = 6.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947820653901       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947820654409       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947820654443       residual = 2.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 6.080777e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947818141798       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947818657494       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947818741929       residual = 5.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947818768900       residual = 8.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947818770789       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947818771299       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947818771540       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947818771259       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947818771386       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947818771395       residual = 2.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+02 is 1.523050e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947818141798       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947818270800       residual = 2.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947818291919       residual = 5.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947818298663       residual = 8.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947818299136       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947818299263       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947818299323       residual = 6.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947818299253       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947818299285       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947818299287       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+02 is 3.809415e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.041454 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6562e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_001                -4.194951e-02 3 1  ON 0
ci_002                -3.210486e-02 3 1  ON 1
ci_003                -2.651851e-02 3 1  ON 2
ci_004                 2.374139e-02 3 1  ON 3
ci_005                 2.414826e-02 3 1  ON 4
ci_006                -2.149563e-02 3 1  ON 5
ci_007                -2.111331e-02 3 1  ON 6
ci_008                -8.498358e-03 3 1  ON 7
ci_009                -1.371606e-02 3 1  ON 8
ci_010                -1.009157e-02 3 1  ON 9
ci_011                -1.139883e-02 3 1  ON 10
ci_012                -9.744129e-03 3 1  ON 11
ci_013                -1.986583e-02 3 1  ON 12
ci_014                 1.226564e-02 3 1  ON 13
ci_015                 1.187358e-02 3 1  ON 14
ci_016                 1.757080e-02 3 1  ON 15
ci_017                 1.637403e-02 3 1  ON 16
ci_018                 1.025084e-02 3 1  ON 17
ci_019                 1.007990e-02 3 1  ON 18
ci_020                 1.794321e-02 3 1  ON 19
ci_021                 1.754941e-02 3 1  ON 20
ci_022                 9.153338e-03 3 1  ON 21
ci_023                 9.151319e-03 3 1  ON 22
ci_024                 9.634608e-03 3 1  ON 23
ci_025                 1.027658e-02 3 1  ON 24
ci_026                 1.170833e-02 3 1  ON 25
ci_027                 1.181280e-02 3 1  ON 26
ci_028                -1.469627e-02 3 1  ON 27
ci_029                -1.660556e-02 3 1  ON 28
ci_030                -9.582654e-03 3 1  ON 29
ci_031                -9.004689e-03 3 1  ON 30
ci_032                -1.470009e-02 3 1  ON 31
ci_033                 5.160649e-03 3 1  ON 32
ci_034                 5.623784e-03 3 1  ON 33
ci_035                -5.100481e-03 3 1  ON 34
ci_036                -1.278000e-02 3 1  ON 35
ci_037                -1.232278e-02 3 1  ON 36
ci_038                 2.158972e-03 3 1  ON 37
ci_039                 1.725744e-03 3 1  ON 38
ci_040                -3.242269e-03 3 1  ON 39
ci_041                 9.618051e-03 3 1  ON 40
ci_042                 8.175788e-03 3 1  ON 41
ci_043                -4.139544e-03 3 1  ON 42
ci_044                -3.878831e-03 3 1  ON 43
ci_045                -3.628267e-03 3 1  ON 44
ci_046                 5.644751e-03 3 1  ON 45
ci_047                 5.508791e-03 3 1  ON 46
ci_048                -1.260788e-02 3 1  ON 47
ci_049                -1.450358e-02 3 1  ON 48
ci_050                 3.106929e-03 3 1  ON 49
ci_051                 2.739331e-03 3 1  ON 50
ci_052                -2.289256e-03 3 1  ON 51
ci_053                -2.449744e-03 3 1  ON 52
ci_054                -3.442032e-03 3 1  ON 53
ci_055                -2.985683e-03 3 1  ON 54
ci_056                 5.611362e-03 3 1  ON 55
ci_057                 5.291301e-03 3 1  ON 56
ci_058                -9.657277e-04 3 1  ON 57
ci_059                -2.305363e-03 3 1  ON 58
ci_060                 4.593864e-03 3 1  ON 59
ci_061                 5.726882e-03 3 1  ON 60
ci_062                -3.725450e-03 3 1  ON 61
ci_063                -4.033686e-03 3 1  ON 62
ci_064                -2.521161e-03 3 1  ON 63
ci_065                -4.362967e-03 3 1  ON 64
ci_066                 4.422162e-03 3 1  ON 65
ci_067                 4.362223e-03 3 1  ON 66
ci_068                -4.159431e-03 3 1  ON 67
ci_069                -5.077803e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.2689
    reference variance = 0.233285
====================================================
  Execution time = 1.3741e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7747e-01
  Total weights = 1.9571e+06
  Execution time = 1.8245e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265870175792
                                         uncertainty =       0.001405200754

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265870175792
                                         uncertainty =       0.001405200754

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364567782
  error estimate for blocks of size 2^( 2) =       0.000378449541
  error estimate for blocks of size 2^( 3) =       0.000391127668
  error estimate for blocks of size 2^( 4) =       0.000399916375
  error estimate for blocks of size 2^( 5) =       0.000406307185
  error estimate for blocks of size 2^( 6) =       0.000409351964
  error estimate for blocks of size 2^( 7) =       0.000409612309

      target function =      -0.949145269257
              le_mean =     -17.212077162676
             les_mean =     296.533080513367
             stat err =       0.000406296958
             autocorr =       1.242025663469
   target nu stat err =       0.000406296958
   target dn stat err =       0.001910506584
      target stat err =       0.003319458834
              std dev =       0.515576701573
             le_variance =       0.265819335205

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265867227370
                                         uncertainty =       0.001405178762

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265867227370
                                         uncertainty =       0.001405178762

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364565755
  error estimate for blocks of size 2^( 2) =       0.000378447653
  error estimate for blocks of size 2^( 3) =       0.000391126080
  error estimate for blocks of size 2^( 4) =       0.000399914874
  error estimate for blocks of size 2^( 5) =       0.000406305647
  error estimate for blocks of size 2^( 6) =       0.000409350416
  error estimate for blocks of size 2^( 7) =       0.000409610755

      target function =      -0.949183215445
              le_mean =     -17.212077245449
             les_mean =     296.533060990431
             stat err =       0.000406295423
             autocorr =       1.242030089384
   target nu stat err =       0.000406295423
   target dn stat err =       0.001909371572
      target stat err =       0.003317839875
              std dev =       0.515573835356
             le_variance =       0.265816379704

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265868696578
                                         uncertainty =       0.001405189696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265868696578
                                         uncertainty =       0.001405189696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364566765
  error estimate for blocks of size 2^( 2) =       0.000378448594
  error estimate for blocks of size 2^( 3) =       0.000391126871
  error estimate for blocks of size 2^( 4) =       0.000399915621
  error estimate for blocks of size 2^( 5) =       0.000406306413
  error estimate for blocks of size 2^( 6) =       0.000409351187
  error estimate for blocks of size 2^( 7) =       0.000409611529

      target function =      -0.949168320580
              le_mean =     -17.212077204091
             les_mean =     296.533068347567
             stat err =       0.000406296188
             autocorr =       1.242027881447
   target nu stat err =       0.000406296188
   target dn stat err =       0.001909903052
      target stat err =       0.003318617615
              std dev =       0.515575263608
             le_variance =       0.265817852444

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265869990597
                                         uncertainty =       0.001405199367

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265869990597
                                         uncertainty =       0.001405199367

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364567655
  error estimate for blocks of size 2^( 2) =       0.000378449423
  error estimate for blocks of size 2^( 3) =       0.000391127568
  error estimate for blocks of size 2^( 4) =       0.000399916280
  error estimate for blocks of size 2^( 5) =       0.000406307088
  error estimate for blocks of size 2^( 6) =       0.000409351867
  error estimate for blocks of size 2^( 7) =       0.000409612211

      target function =      -0.949148831363
              le_mean =     -17.212077167853
             les_mean =     296.533078591176
             stat err =       0.000406296862
             autocorr =       1.242025940994
   target nu stat err =       0.000406296862
   target dn stat err =       0.001910423788
      target stat err =       0.003319346165
              std dev =       0.515576521542
             le_variance =       0.265819149566


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949145269257        initial
     2.5000e+01     2.5000e+02             6.0808e-06        -0.949183215445  <--
     1.0000e+02     1.0000e+03             1.5231e-06        -0.949168320580
     4.0000e+02     4.0000e+03             3.8094e-07        -0.949148831363

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 2.3129e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
ci_001                -4.194495e-02 3 1  ON 0
ci_002                -3.210383e-02 3 1  ON 1
ci_003                -2.651713e-02 3 1  ON 2
ci_004                 2.373945e-02 3 1  ON 3
ci_005                 2.414676e-02 3 1  ON 4
ci_006                -2.149378e-02 3 1  ON 5
ci_007                -2.111131e-02 3 1  ON 6
ci_008                -8.498660e-03 3 1  ON 7
ci_009                -1.371643e-02 3 1  ON 8
ci_010                -1.009052e-02 3 1  ON 9
ci_011                -1.139632e-02 3 1  ON 10
ci_012                -9.744748e-03 3 1  ON 11
ci_013                -1.986495e-02 3 1  ON 12
ci_014                 1.226467e-02 3 1  ON 13
ci_015                 1.187602e-02 3 1  ON 14
ci_016                 1.756976e-02 3 1  ON 15
ci_017                 1.637361e-02 3 1  ON 16
ci_018                 1.024966e-02 3 1  ON 17
ci_019                 1.007994e-02 3 1  ON 18
ci_020                 1.793956e-02 3 1  ON 19
ci_021                 1.754657e-02 3 1  ON 20
ci_022                 9.155409e-03 3 1  ON 21
ci_023                 9.147639e-03 3 1  ON 22
ci_024                 9.633856e-03 3 1  ON 23
ci_025                 1.027530e-02 3 1  ON 24
ci_026                 1.170824e-02 3 1  ON 25
ci_027                 1.181184e-02 3 1  ON 26
ci_028                -1.469706e-02 3 1  ON 27
ci_029                -1.660401e-02 3 1  ON 28
ci_030                -9.582492e-03 3 1  ON 29
ci_031                -9.006340e-03 3 1  ON 30
ci_032                -1.470207e-02 3 1  ON 31
ci_033                 5.163212e-03 3 1  ON 32
ci_034                 5.625128e-03 3 1  ON 33
ci_035                -5.099978e-03 3 1  ON 34
ci_036                -1.277913e-02 3 1  ON 35
ci_037                -1.232259e-02 3 1  ON 36
ci_038                 2.156943e-03 3 1  ON 37
ci_039                 1.726126e-03 3 1  ON 38
ci_040                -3.241211e-03 3 1  ON 39
ci_041                 9.616929e-03 3 1  ON 40
ci_042                 8.177746e-03 3 1  ON 41
ci_043                -4.139182e-03 3 1  ON 42
ci_044                -3.878241e-03 3 1  ON 43
ci_045                -3.625897e-03 3 1  ON 44
ci_046                 5.645360e-03 3 1  ON 45
ci_047                 5.509142e-03 3 1  ON 46
ci_048                -1.260904e-02 3 1  ON 47
ci_049                -1.449997e-02 3 1  ON 48
ci_050                 3.108504e-03 3 1  ON 49
ci_051                 2.741786e-03 3 1  ON 50
ci_052                -2.289957e-03 3 1  ON 51
ci_053                -2.449892e-03 3 1  ON 52
ci_054                -3.440518e-03 3 1  ON 53
ci_055                -2.985283e-03 3 1  ON 54
ci_056                 5.607582e-03 3 1  ON 55
ci_057                 5.290802e-03 3 1  ON 56
ci_058                -9.685945e-04 3 1  ON 57
ci_059                -2.303621e-03 3 1  ON 58
ci_060                 4.597197e-03 3 1  ON 59
ci_061                 5.726970e-03 3 1  ON 60
ci_062                -3.725828e-03 3 1  ON 61
ci_063                -4.034620e-03 3 1  ON 62
ci_064                -2.522779e-03 3 1  ON 63
ci_065                -4.361861e-03 3 1  ON 64
ci_066                 4.423574e-03 3 1  ON 65
ci_067                 4.362728e-03 3 1  ON 66
ci_068                -4.159241e-03 3 1  ON 67
ci_069                -5.078717e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9697e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.2181
    reference variance = 0.190542
====================================================
  Execution time = 1.4041e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7739e-01
  Total weights = 1.956972899e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4890e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265543838276
                                         uncertainty =       0.001356367167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265543838276
                                         uncertainty =       0.001356367167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364415935
  error estimate for blocks of size 2^( 2) =       0.000378373636
  error estimate for blocks of size 2^( 3) =       0.000391179829
  error estimate for blocks of size 2^( 4) =       0.000400397641
  error estimate for blocks of size 2^( 5) =       0.000406941707
  error estimate for blocks of size 2^( 6) =       0.000409499477
  error estimate for blocks of size 2^( 7) =       0.000409603165

      target function =      -0.949279975626
              le_mean =     -17.211492932422
             les_mean =     296.512878371509
             stat err =       0.000406610498
             autocorr =       1.244980228575
   target nu stat err =       0.000406610498
   target dn stat err =       0.002615677490
      target stat err =       0.004490174386
              std dev =       0.515361957779
             le_variance =       0.265597947526


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721149293242e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949300204228       residual = 3.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949315376448       residual = 3.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949317328092       residual = 6.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949317848437       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949318006660       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949318047830       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949318050008       residual = 4.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949318053196       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949318053637       residual = 3.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949318054128       residual = 4.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 3.035146e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949300204228       residual = 3.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949304035227       residual = 3.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949304526961       residual = 6.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949304657716       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949304697456       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949304707757       residual = 4.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949304708302       residual = 4.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949304709098       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949304709205       residual = 3.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949304709326       residual = 4.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 7.661294e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949300204228       residual = 3.06e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949301164379       residual = 3.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949301287554       residual = 6.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949301320285       residual = 1.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949301330231       residual = 2.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949301332807       residual = 4.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949301332943       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949301333142       residual = 1.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949301333168       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949301333199       residual = 4.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+02 is 1.919969e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.044949 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6539e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_001                -4.194164e-02 3 1  ON 0
ci_002                -3.210582e-02 3 1  ON 1
ci_003                -2.651292e-02 3 1  ON 2
ci_004                 2.373872e-02 3 1  ON 3
ci_005                 2.414904e-02 3 1  ON 4
ci_006                -2.149152e-02 3 1  ON 5
ci_007                -2.111056e-02 3 1  ON 6
ci_008                -8.496483e-03 3 1  ON 7
ci_009                -1.371828e-02 3 1  ON 8
ci_010                -1.009289e-02 3 1  ON 9
ci_011                -1.139556e-02 3 1  ON 10
ci_012                -9.743212e-03 3 1  ON 11
ci_013                -1.986292e-02 3 1  ON 12
ci_014                 1.226554e-02 3 1  ON 13
ci_015                 1.188024e-02 3 1  ON 14
ci_016                 1.756774e-02 3 1  ON 15
ci_017                 1.637422e-02 3 1  ON 16
ci_018                 1.025107e-02 3 1  ON 17
ci_019                 1.007783e-02 3 1  ON 18
ci_020                 1.793758e-02 3 1  ON 19
ci_021                 1.754033e-02 3 1  ON 20
ci_022                 9.156640e-03 3 1  ON 21
ci_023                 9.148734e-03 3 1  ON 22
ci_024                 9.631673e-03 3 1  ON 23
ci_025                 1.027169e-02 3 1  ON 24
ci_026                 1.170728e-02 3 1  ON 25
ci_027                 1.180585e-02 3 1  ON 26
ci_028                -1.469542e-02 3 1  ON 27
ci_029                -1.659766e-02 3 1  ON 28
ci_030                -9.582407e-03 3 1  ON 29
ci_031                -8.998678e-03 3 1  ON 30
ci_032                -1.470265e-02 3 1  ON 31
ci_033                 5.166152e-03 3 1  ON 32
ci_034                 5.623190e-03 3 1  ON 33
ci_035                -5.099089e-03 3 1  ON 34
ci_036                -1.277935e-02 3 1  ON 35
ci_037                -1.232655e-02 3 1  ON 36
ci_038                 2.154046e-03 3 1  ON 37
ci_039                 1.726273e-03 3 1  ON 38
ci_040                -3.239736e-03 3 1  ON 39
ci_041                 9.613389e-03 3 1  ON 40
ci_042                 8.181663e-03 3 1  ON 41
ci_043                -4.136636e-03 3 1  ON 42
ci_044                -3.876603e-03 3 1  ON 43
ci_045                -3.624330e-03 3 1  ON 44
ci_046                 5.644211e-03 3 1  ON 45
ci_047                 5.509268e-03 3 1  ON 46
ci_048                -1.260933e-02 3 1  ON 47
ci_049                -1.450065e-02 3 1  ON 48
ci_050                 3.112117e-03 3 1  ON 49
ci_051                 2.742369e-03 3 1  ON 50
ci_052                -2.289205e-03 3 1  ON 51
ci_053                -2.447360e-03 3 1  ON 52
ci_054                -3.438287e-03 3 1  ON 53
ci_055                -2.984925e-03 3 1  ON 54
ci_056                 5.605873e-03 3 1  ON 55
ci_057                 5.292734e-03 3 1  ON 56
ci_058                -9.720937e-04 3 1  ON 57
ci_059                -2.303202e-03 3 1  ON 58
ci_060                 4.601293e-03 3 1  ON 59
ci_061                 5.726995e-03 3 1  ON 60
ci_062                -3.728072e-03 3 1  ON 61
ci_063                -4.034182e-03 3 1  ON 62
ci_064                -2.526402e-03 3 1  ON 63
ci_065                -4.362176e-03 3 1  ON 64
ci_066                 4.425613e-03 3 1  ON 65
ci_067                 4.361763e-03 3 1  ON 66
ci_068                -4.157881e-03 3 1  ON 67
ci_069                -5.072959e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.3116
    reference variance = 0.182757
====================================================
  Execution time = 1.3827e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7701e-01
  Total weights = 1.9572e+06
  Execution time = 1.8282e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265093863085
                                         uncertainty =       0.001393135639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265093863085
                                         uncertainty =       0.001393135639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364054157
  error estimate for blocks of size 2^( 2) =       0.000377530327
  error estimate for blocks of size 2^( 3) =       0.000390881700
  error estimate for blocks of size 2^( 4) =       0.000400232276
  error estimate for blocks of size 2^( 5) =       0.000405864312
  error estimate for blocks of size 2^( 6) =       0.000408622737
  error estimate for blocks of size 2^( 7) =       0.000409323501

      target function =      -0.949822554243
              le_mean =     -17.211640210782
             les_mean =     296.517632977365
             stat err =       0.000406010707
             autocorr =       1.243778322725
   target nu stat err =       0.000406010707
   target dn stat err =       0.002239015088
      target stat err =       0.003867029210
              std dev =       0.514850326223
             le_variance =       0.265070858412

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265084920261
                                         uncertainty =       0.001392582296

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265084920261
                                         uncertainty =       0.001392582296

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364048009
  error estimate for blocks of size 2^( 2) =       0.000377524770
  error estimate for blocks of size 2^( 3) =       0.000390876863
  error estimate for blocks of size 2^( 4) =       0.000400227833
  error estimate for blocks of size 2^( 5) =       0.000405860416
  error estimate for blocks of size 2^( 6) =       0.000408619143
  error estimate for blocks of size 2^( 7) =       0.000409319860

      target function =      -0.949993358354
              le_mean =     -17.211640421096
             les_mean =     296.517539582127
             stat err =       0.000406006813
             autocorr =       1.243796476223
   target nu stat err =       0.000406006813
   target dn stat err =       0.002235384106
      target stat err =       0.003862343093
              std dev =       0.514841631854
             le_variance =       0.265061905890

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265089311125
                                         uncertainty =       0.001392855845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265089311125
                                         uncertainty =       0.001392855845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364051028
  error estimate for blocks of size 2^( 2) =       0.000377527495
  error estimate for blocks of size 2^( 3) =       0.000390879231
  error estimate for blocks of size 2^( 4) =       0.000400230006
  error estimate for blocks of size 2^( 5) =       0.000405862317
  error estimate for blocks of size 2^( 6) =       0.000408620893
  error estimate for blocks of size 2^( 7) =       0.000409321633

      target function =      -0.949965591867
              le_mean =     -17.211640311237
             les_mean =     296.517552151661
             stat err =       0.000406008712
             autocorr =       1.243787484161
   target nu stat err =       0.000406008712
   target dn stat err =       0.002236602190
      target stat err =       0.003864151514
              std dev =       0.514845900804
             le_variance =       0.265066301574

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265093288355
                                         uncertainty =       0.001393100515

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265093288355
                                         uncertainty =       0.001393100515

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364053762
  error estimate for blocks of size 2^( 2) =       0.000377529969
  error estimate for blocks of size 2^( 3) =       0.000390881388
  error estimate for blocks of size 2^( 4) =       0.000400231988
  error estimate for blocks of size 2^( 5) =       0.000405864058
  error estimate for blocks of size 2^( 6) =       0.000408622502
  error estimate for blocks of size 2^( 7) =       0.000409323263

      target function =      -0.949883737090
              le_mean =     -17.211640222368
             les_mean =     296.517597320658
             stat err =       0.000406010453
             autocorr =       1.243779466148
   target nu stat err =       0.000406010453
   target dn stat err =       0.002238060322
      target stat err =       0.003865927414
              std dev =       0.514849767479
             le_variance =       0.265070283073


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949822554243        initial
     6.2500e+00     6.2500e+01             3.0351e-05        -0.949993358354  <--
     2.5000e+01     2.5000e+02             7.6613e-06        -0.949965591867
     1.0000e+02     1.0000e+03             1.9200e-06        -0.949883737090

*****************************************************************************
Applying the update for shift_i =   6.2500e+00     and shift_s =   6.2500e+01
*****************************************************************************

  Execution time = 2.3188e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
ci_001                -4.193180e-02 3 1  ON 0
ci_002                -3.211174e-02 3 1  ON 1
ci_003                -2.650042e-02 3 1  ON 2
ci_004                 2.373659e-02 3 1  ON 3
ci_005                 2.415576e-02 3 1  ON 4
ci_006                -2.148482e-02 3 1  ON 5
ci_007                -2.110836e-02 3 1  ON 6
ci_008                -8.490044e-03 3 1  ON 7
ci_009                -1.372378e-02 3 1  ON 8
ci_010                -1.009993e-02 3 1  ON 9
ci_011                -1.139333e-02 3 1  ON 10
ci_012                -9.738661e-03 3 1  ON 11
ci_013                -1.985689e-02 3 1  ON 12
ci_014                 1.226809e-02 3 1  ON 13
ci_015                 1.189274e-02 3 1  ON 14
ci_016                 1.756174e-02 3 1  ON 15
ci_017                 1.637603e-02 3 1  ON 16
ci_018                 1.025523e-02 3 1  ON 17
ci_019                 1.007156e-02 3 1  ON 18
ci_020                 1.793170e-02 3 1  ON 19
ci_021                 1.752180e-02 3 1  ON 20
ci_022                 9.160302e-03 3 1  ON 21
ci_023                 9.151987e-03 3 1  ON 22
ci_024                 9.625200e-03 3 1  ON 23
ci_025                 1.026099e-02 3 1  ON 24
ci_026                 1.170444e-02 3 1  ON 25
ci_027                 1.178812e-02 3 1  ON 26
ci_028                -1.469056e-02 3 1  ON 27
ci_029                -1.657883e-02 3 1  ON 28
ci_030                -9.582157e-03 3 1  ON 29
ci_031                -8.975988e-03 3 1  ON 30
ci_032                -1.470436e-02 3 1  ON 31
ci_033                 5.174872e-03 3 1  ON 32
ci_034                 5.617442e-03 3 1  ON 33
ci_035                -5.096455e-03 3 1  ON 34
ci_036                -1.278000e-02 3 1  ON 35
ci_037                -1.233827e-02 3 1  ON 36
ci_038                 2.145468e-03 3 1  ON 37
ci_039                 1.726710e-03 3 1  ON 38
ci_040                -3.235368e-03 3 1  ON 39
ci_041                 9.602897e-03 3 1  ON 40
ci_042                 8.193245e-03 3 1  ON 41
ci_043                -4.129091e-03 3 1  ON 42
ci_044                -3.871747e-03 3 1  ON 43
ci_045                -3.619688e-03 3 1  ON 44
ci_046                 5.640802e-03 3 1  ON 45
ci_047                 5.509641e-03 3 1  ON 46
ci_048                -1.261017e-02 3 1  ON 47
ci_049                -1.450264e-02 3 1  ON 48
ci_050                 3.122812e-03 3 1  ON 49
ci_051                 2.744092e-03 3 1  ON 50
ci_052                -2.286972e-03 3 1  ON 51
ci_053                -2.439859e-03 3 1  ON 52
ci_054                -3.431658e-03 3 1  ON 53
ci_055                -2.983865e-03 3 1  ON 54
ci_056                 5.600808e-03 3 1  ON 55
ci_057                 5.298460e-03 3 1  ON 56
ci_058                -9.824502e-04 3 1  ON 57
ci_059                -2.301957e-03 3 1  ON 58
ci_060                 4.613443e-03 3 1  ON 59
ci_061                 5.727069e-03 3 1  ON 60
ci_062                -3.734722e-03 3 1  ON 61
ci_063                -4.032880e-03 3 1  ON 62
ci_064                -2.537129e-03 3 1  ON 63
ci_065                -4.363109e-03 3 1  ON 64
ci_066                 4.431649e-03 3 1  ON 65
ci_067                 4.358907e-03 3 1  ON 66
ci_068                -4.153849e-03 3 1  ON 67
ci_069                -5.055881e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9733e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.1526
    reference variance = 0.151686
====================================================
  Execution time = 1.4045e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7915e-01
  Total weights = 1.956814682e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4966e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268375473143
                                         uncertainty =       0.001407547488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268375473143
                                         uncertainty =       0.001407547488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366306479
  error estimate for blocks of size 2^( 2) =       0.000379931710
  error estimate for blocks of size 2^( 3) =       0.000392813416
  error estimate for blocks of size 2^( 4) =       0.000402492885
  error estimate for blocks of size 2^( 5) =       0.000408182640
  error estimate for blocks of size 2^( 6) =       0.000412045899
  error estimate for blocks of size 2^( 7) =       0.000412495969

      target function =      -0.946319286914
              le_mean =     -17.211547516635
             les_mean =     296.516516194913
             stat err =       0.000408804348
             autocorr =       1.245494494317
   target nu stat err =       0.000408804348
   target dn stat err =       0.001970113143
      target stat err =       0.003395849206
              std dev =       0.518035590729
             le_variance =       0.268360873262


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721154751663e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+00, overlap shift 1.5625e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946330462055       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946357389885       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946361676334       residual = 3.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946363106167       residual = 9.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946363410986       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946363440800       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946363451073       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946363440469       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946363441716       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946363441591       residual = 4.10e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+00 is 7.918697e-05

solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946330462055       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946337454131       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946338559268       residual = 3.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946338924140       residual = 9.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946339001564       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946339008782       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946339011353       residual = 5.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946339008672       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946339009006       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946339008978       residual = 3.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 2.051278e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946330462055       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946332227124       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946332505584       residual = 3.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946332597273       residual = 9.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946332616706       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946332618494       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946332619137       residual = 5.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946332618465       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946332618550       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946332618543       residual = 3.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 5.175027e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.048409 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6550e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_001                -4.192453e-02 3 1  ON 0
ci_002                -3.211347e-02 3 1  ON 1
ci_003                -2.648171e-02 3 1  ON 2
ci_004                 2.374116e-02 3 1  ON 3
ci_005                 2.414467e-02 3 1  ON 4
ci_006                -2.148402e-02 3 1  ON 5
ci_007                -2.109637e-02 3 1  ON 6
ci_008                -8.492949e-03 3 1  ON 7
ci_009                -1.373379e-02 3 1  ON 8
ci_010                -1.010602e-02 3 1  ON 9
ci_011                -1.138032e-02 3 1  ON 10
ci_012                -9.743682e-03 3 1  ON 11
ci_013                -1.986293e-02 3 1  ON 12
ci_014                 1.226948e-02 3 1  ON 13
ci_015                 1.190238e-02 3 1  ON 14
ci_016                 1.755713e-02 3 1  ON 15
ci_017                 1.637458e-02 3 1  ON 16
ci_018                 1.025365e-02 3 1  ON 17
ci_019                 1.006459e-02 3 1  ON 18
ci_020                 1.792803e-02 3 1  ON 19
ci_021                 1.751280e-02 3 1  ON 20
ci_022                 9.164551e-03 3 1  ON 21
ci_023                 9.149557e-03 3 1  ON 22
ci_024                 9.626652e-03 3 1  ON 23
ci_025                 1.024739e-02 3 1  ON 24
ci_026                 1.169720e-02 3 1  ON 25
ci_027                 1.176761e-02 3 1  ON 26
ci_028                -1.469657e-02 3 1  ON 27
ci_029                -1.656650e-02 3 1  ON 28
ci_030                -9.577177e-03 3 1  ON 29
ci_031                -8.971695e-03 3 1  ON 30
ci_032                -1.469786e-02 3 1  ON 31
ci_033                 5.179616e-03 3 1  ON 32
ci_034                 5.618641e-03 3 1  ON 33
ci_035                -5.097427e-03 3 1  ON 34
ci_036                -1.277717e-02 3 1  ON 35
ci_037                -1.233930e-02 3 1  ON 36
ci_038                 2.140583e-03 3 1  ON 37
ci_039                 1.723108e-03 3 1  ON 38
ci_040                -3.232402e-03 3 1  ON 39
ci_041                 9.588550e-03 3 1  ON 40
ci_042                 8.191709e-03 3 1  ON 41
ci_043                -4.123900e-03 3 1  ON 42
ci_044                -3.873372e-03 3 1  ON 43
ci_045                -3.608288e-03 3 1  ON 44
ci_046                 5.648512e-03 3 1  ON 45
ci_047                 5.512635e-03 3 1  ON 46
ci_048                -1.262031e-02 3 1  ON 47
ci_049                -1.448606e-02 3 1  ON 48
ci_050                 3.138485e-03 3 1  ON 49
ci_051                 2.750743e-03 3 1  ON 50
ci_052                -2.283430e-03 3 1  ON 51
ci_053                -2.438216e-03 3 1  ON 52
ci_054                -3.418824e-03 3 1  ON 53
ci_055                -2.981629e-03 3 1  ON 54
ci_056                 5.600652e-03 3 1  ON 55
ci_057                 5.294591e-03 3 1  ON 56
ci_058                -9.904540e-04 3 1  ON 57
ci_059                -2.292746e-03 3 1  ON 58
ci_060                 4.612670e-03 3 1  ON 59
ci_061                 5.721598e-03 3 1  ON 60
ci_062                -3.732320e-03 3 1  ON 61
ci_063                -4.033615e-03 3 1  ON 62
ci_064                -2.548720e-03 3 1  ON 63
ci_065                -4.365560e-03 3 1  ON 64
ci_066                 4.438782e-03 3 1  ON 65
ci_067                 4.363713e-03 3 1  ON 66
ci_068                -4.157685e-03 3 1  ON 67
ci_069                -5.056464e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2652
    reference variance = 0.250524
====================================================
  Execution time = 1.3895e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7973e-01
  Total weights = 1.9576e+06
  Execution time = 1.8318e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266563507133
                                         uncertainty =       0.001845067207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266563507133
                                         uncertainty =       0.001845067207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365048950
  error estimate for blocks of size 2^( 2) =       0.000378883519
  error estimate for blocks of size 2^( 3) =       0.000391589160
  error estimate for blocks of size 2^( 4) =       0.000400757926
  error estimate for blocks of size 2^( 5) =       0.000406340413
  error estimate for blocks of size 2^( 6) =       0.000409366900
  error estimate for blocks of size 2^( 7) =       0.000409644291

      target function =      -0.945336273849
              le_mean =     -17.211888310033
             les_mean =     296.528829411937
             stat err =       0.000406527382
             autocorr =       1.240159090283
   target nu stat err =       0.000406527382
   target dn stat err =       0.002528439893
      target stat err =       0.004312049469
              std dev =       0.516257175552
             le_variance =       0.266521471309

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266520169305
                                         uncertainty =       0.001838404036

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266520169305
                                         uncertainty =       0.001838404036

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365019226
  error estimate for blocks of size 2^( 2) =       0.000378856432
  error estimate for blocks of size 2^( 3) =       0.000391564945
  error estimate for blocks of size 2^( 4) =       0.000400735870
  error estimate for blocks of size 2^( 5) =       0.000406319203
  error estimate for blocks of size 2^( 6) =       0.000409344466
  error estimate for blocks of size 2^( 7) =       0.000409621344

      target function =      -0.925014096316
              le_mean =     -17.211888066686
             les_mean =     296.540923588527
             stat err =       0.000406505221
             autocorr =       1.240225839973
   target nu stat err =       0.000406505221
   target dn stat err =       0.012269015888
      target stat err =       0.019771521374
              std dev =       0.516215140117
             le_variance =       0.266478070886

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266540506721
                                         uncertainty =       0.001841607421

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266540506721
                                         uncertainty =       0.001841607421

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365033176
  error estimate for blocks of size 2^( 2) =       0.000378869117
  error estimate for blocks of size 2^( 3) =       0.000391576443
  error estimate for blocks of size 2^( 4) =       0.000400746191
  error estimate for blocks of size 2^( 5) =       0.000406328994
  error estimate for blocks of size 2^( 6) =       0.000409355556
  error estimate for blocks of size 2^( 7) =       0.000409634025

      target function =      -0.945300321853
              le_mean =     -17.211888386683
             les_mean =     296.528853434966
             stat err =       0.000406516192
             autocorr =       1.240197990429
   target nu stat err =       0.000406516192
   target dn stat err =       0.002528616924
      target stat err =       0.004312016795
              std dev =       0.516234867656
             le_variance =       0.266498438584

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266560568255
                                         uncertainty =       0.001844628718

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266560568255
                                         uncertainty =       0.001844628718

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365046934
  error estimate for blocks of size 2^( 2) =       0.000378881676
  error estimate for blocks of size 2^( 3) =       0.000391587530
  error estimate for blocks of size 2^( 4) =       0.000400756420
  error estimate for blocks of size 2^( 5) =       0.000406338946
  error estimate for blocks of size 2^( 6) =       0.000409365441
  error estimate for blocks of size 2^( 7) =       0.000409642962

      target function =      -0.945336451237
              le_mean =     -17.211888313855
             les_mean =     296.528829439119
             stat err =       0.000406525942
             autocorr =       1.240163998067
   target nu stat err =       0.000406525942
   target dn stat err =       0.002528321032
      target stat err =       0.004311853649
              std dev =       0.516254325260
             le_variance =       0.266518528349


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945336273849        initial
     1.5625e+00     1.5625e+01             7.9187e-05        -0.925014096316
     6.2500e+00     6.2500e+01             2.0513e-05        -0.945300321853
     2.5000e+01     2.5000e+02             5.1750e-06        -0.945336451237  <--

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 2.3271e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
ci_001                -4.192997e-02 3 1  ON 0
ci_002                -3.211218e-02 3 1  ON 1
ci_003                -2.649571e-02 3 1  ON 2
ci_004                 2.373774e-02 3 1  ON 3
ci_005                 2.415297e-02 3 1  ON 4
ci_006                -2.148462e-02 3 1  ON 5
ci_007                -2.110534e-02 3 1  ON 6
ci_008                -8.490779e-03 3 1  ON 7
ci_009                -1.372630e-02 3 1  ON 8
ci_010                -1.010147e-02 3 1  ON 9
ci_011                -1.139005e-02 3 1  ON 10
ci_012                -9.739927e-03 3 1  ON 11
ci_013                -1.985841e-02 3 1  ON 12
ci_014                 1.226844e-02 3 1  ON 13
ci_015                 1.189517e-02 3 1  ON 14
ci_016                 1.756058e-02 3 1  ON 15
ci_017                 1.637567e-02 3 1  ON 16
ci_018                 1.025483e-02 3 1  ON 17
ci_019                 1.006980e-02 3 1  ON 18
ci_020                 1.793078e-02 3 1  ON 19
ci_021                 1.751953e-02 3 1  ON 20
ci_022                 9.161373e-03 3 1  ON 21
ci_023                 9.151374e-03 3 1  ON 22
ci_024                 9.625566e-03 3 1  ON 23
ci_025                 1.025756e-02 3 1  ON 24
ci_026                 1.170261e-02 3 1  ON 25
ci_027                 1.178295e-02 3 1  ON 26
ci_028                -1.469208e-02 3 1  ON 27
ci_029                -1.657572e-02 3 1  ON 28
ci_030                -9.580898e-03 3 1  ON 29
ci_031                -8.974909e-03 3 1  ON 30
ci_032                -1.470272e-02 3 1  ON 31
ci_033                 5.176069e-03 3 1  ON 32
ci_034                 5.617745e-03 3 1  ON 33
ci_035                -5.096700e-03 3 1  ON 34
ci_036                -1.277929e-02 3 1  ON 35
ci_037                -1.233853e-02 3 1  ON 36
ci_038                 2.144235e-03 3 1  ON 37
ci_039                 1.725801e-03 3 1  ON 38
ci_040                -3.234620e-03 3 1  ON 39
ci_041                 9.599274e-03 3 1  ON 40
ci_042                 8.192860e-03 3 1  ON 41
ci_043                -4.127781e-03 3 1  ON 42
ci_044                -3.872156e-03 3 1  ON 43
ci_045                -3.616810e-03 3 1  ON 44
ci_046                 5.642746e-03 3 1  ON 45
ci_047                 5.510396e-03 3 1  ON 46
ci_048                -1.261272e-02 3 1  ON 47
ci_049                -1.449846e-02 3 1  ON 48
ci_050                 3.126770e-03 3 1  ON 49
ci_051                 2.745772e-03 3 1  ON 50
ci_052                -2.286078e-03 3 1  ON 51
ci_053                -2.439445e-03 3 1  ON 52
ci_054                -3.428421e-03 3 1  ON 53
ci_055                -2.983302e-03 3 1  ON 54
ci_056                 5.600769e-03 3 1  ON 55
ci_057                 5.297484e-03 3 1  ON 56
ci_058                -9.844717e-04 3 1  ON 57
ci_059                -2.299632e-03 3 1  ON 58
ci_060                 4.613248e-03 3 1  ON 59
ci_061                 5.725690e-03 3 1  ON 60
ci_062                -3.734116e-03 3 1  ON 61
ci_063                -4.033067e-03 3 1  ON 62
ci_064                -2.540055e-03 3 1  ON 63
ci_065                -4.363728e-03 3 1  ON 64
ci_066                 4.433448e-03 3 1  ON 65
ci_067                 4.360120e-03 3 1  ON 66
ci_068                -4.154816e-03 3 1  ON 67
ci_069                -5.056028e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9827e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2091
    reference variance = 0.235456
====================================================
  Execution time = 1.6260e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5318e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8679e-01
  Total weights = 1.957318545e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4789e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272587419944
                                         uncertainty =       0.005675790809

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272587419944
                                         uncertainty =       0.005675790809

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369167889
  error estimate for blocks of size 2^( 2) =       0.000382879573
  error estimate for blocks of size 2^( 3) =       0.000395711835
  error estimate for blocks of size 2^( 4) =       0.000405236610
  error estimate for blocks of size 2^( 5) =       0.000410215577
  error estimate for blocks of size 2^( 6) =       0.000412307546
  error estimate for blocks of size 2^( 7) =       0.000414078830

      target function =      -0.933390966660
              le_mean =     -17.211578521146
             les_mean =     296.525227823740
             stat err =       0.000410459641
             autocorr =       1.236212372045
   target nu stat err =       0.000410459641
   target dn stat err =       0.009192539442
      target stat err =       0.015079112135
              std dev =       0.522082234885
             le_variance =       0.272569859983


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721157852115e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933631973520       residual = 3.09e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933731800581       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933742662193       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933744271741       residual = 3.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933744585735       residual = 9.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933744712291       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933744716577       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933744712621       residual = 9.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933744712268       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933744711906       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933744712675       residual = 6.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+00 is 8.929144e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933631973520       residual = 3.09e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933657182916       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933659919005       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933660323457       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933660402342       residual = 9.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933660433928       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933660434949       residual = 3.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933660433945       residual = 9.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933660433865       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933660433778       residual = 2.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933660433970       residual = 5.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 2.252014e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933631973520       residual = 3.09e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933638291857       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933638977183       residual = 2.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933639078426       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933639098171       residual = 9.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933639106064       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.933639106316       residual = 3.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.933639106064       residual = 9.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.933639106045       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.933639106023       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933639106071       residual = 5.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+02 is 5.642498e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.052448 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8748e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_001                -4.192971e-02 3 1  ON 0
ci_002                -3.211120e-02 3 1  ON 1
ci_003                -2.649190e-02 3 1  ON 2
ci_004                 2.373883e-02 3 1  ON 3
ci_005                 2.414931e-02 3 1  ON 4
ci_006                -2.148152e-02 3 1  ON 5
ci_007                -2.110297e-02 3 1  ON 6
ci_008                -8.489056e-03 3 1  ON 7
ci_009                -1.373016e-02 3 1  ON 8
ci_010                -1.011361e-02 3 1  ON 9
ci_011                -1.138761e-02 3 1  ON 10
ci_012                -9.744816e-03 3 1  ON 11
ci_013                -1.986035e-02 3 1  ON 12
ci_014                 1.227033e-02 3 1  ON 13
ci_015                 1.189546e-02 3 1  ON 14
ci_016                 1.755980e-02 3 1  ON 15
ci_017                 1.636892e-02 3 1  ON 16
ci_018                 1.025872e-02 3 1  ON 17
ci_019                 1.007343e-02 3 1  ON 18
ci_020                 1.792787e-02 3 1  ON 19
ci_021                 1.751845e-02 3 1  ON 20
ci_022                 9.160768e-03 3 1  ON 21
ci_023                 9.146738e-03 3 1  ON 22
ci_024                 9.623810e-03 3 1  ON 23
ci_025                 1.025542e-02 3 1  ON 24
ci_026                 1.170075e-02 3 1  ON 25
ci_027                 1.178283e-02 3 1  ON 26
ci_028                -1.469103e-02 3 1  ON 27
ci_029                -1.657454e-02 3 1  ON 28
ci_030                -9.573169e-03 3 1  ON 29
ci_031                -8.975884e-03 3 1  ON 30
ci_032                -1.470065e-02 3 1  ON 31
ci_033                 5.179698e-03 3 1  ON 32
ci_034                 5.623802e-03 3 1  ON 33
ci_035                -5.095073e-03 3 1  ON 34
ci_036                -1.277647e-02 3 1  ON 35
ci_037                -1.234025e-02 3 1  ON 36
ci_038                 2.142224e-03 3 1  ON 37
ci_039                 1.734035e-03 3 1  ON 38
ci_040                -3.230223e-03 3 1  ON 39
ci_041                 9.595796e-03 3 1  ON 40
ci_042                 8.187190e-03 3 1  ON 41
ci_043                -4.129059e-03 3 1  ON 42
ci_044                -3.870690e-03 3 1  ON 43
ci_045                -3.613086e-03 3 1  ON 44
ci_046                 5.641636e-03 3 1  ON 45
ci_047                 5.512018e-03 3 1  ON 46
ci_048                -1.261861e-02 3 1  ON 47
ci_049                -1.448860e-02 3 1  ON 48
ci_050                 3.129511e-03 3 1  ON 49
ci_051                 2.763842e-03 3 1  ON 50
ci_052                -2.278484e-03 3 1  ON 51
ci_053                -2.430679e-03 3 1  ON 52
ci_054                -3.424529e-03 3 1  ON 53
ci_055                -2.983623e-03 3 1  ON 54
ci_056                 5.603346e-03 3 1  ON 55
ci_057                 5.298591e-03 3 1  ON 56
ci_058                -9.807258e-04 3 1  ON 57
ci_059                -2.297074e-03 3 1  ON 58
ci_060                 4.604088e-03 3 1  ON 59
ci_061                 5.724891e-03 3 1  ON 60
ci_062                -3.734393e-03 3 1  ON 61
ci_063                -4.033846e-03 3 1  ON 62
ci_064                -2.539331e-03 3 1  ON 63
ci_065                -4.367253e-03 3 1  ON 64
ci_066                 4.433364e-03 3 1  ON 65
ci_067                 4.361867e-03 3 1  ON 66
ci_068                -4.177336e-03 3 1  ON 67
ci_069                -5.054258e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2363
    reference variance = 0.230169
====================================================
  Execution time = 1.3750e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7690e-01
  Total weights = 1.9572e+06
  Execution time = 1.8168e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266065383783
                                         uncertainty =       0.001350474376

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266065383783
                                         uncertainty =       0.001350474376

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364726586
  error estimate for blocks of size 2^( 2) =       0.000378893032
  error estimate for blocks of size 2^( 3) =       0.000391523500
  error estimate for blocks of size 2^( 4) =       0.000401108226
  error estimate for blocks of size 2^( 5) =       0.000406756515
  error estimate for blocks of size 2^( 6) =       0.000408390169
  error estimate for blocks of size 2^( 7) =       0.000411653557

      target function =      -0.950116767845
              le_mean =     -17.211814773823
             les_mean =     296.523471933024
             stat err =       0.000406977117
             autocorr =       1.245102596271
   target nu stat err =       0.000406977117
   target dn stat err =       0.002050227348
      target stat err =       0.003556612771
              std dev =       0.515801284572
             le_variance =       0.266050965166

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266060735963
                                         uncertainty =       0.001349479909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266060735963
                                         uncertainty =       0.001349479909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364723380
  error estimate for blocks of size 2^( 2) =       0.000378889484
  error estimate for blocks of size 2^( 3) =       0.000391519129
  error estimate for blocks of size 2^( 4) =       0.000401103641
  error estimate for blocks of size 2^( 5) =       0.000406752435
  error estimate for blocks of size 2^( 6) =       0.000408386076
  error estimate for blocks of size 2^( 7) =       0.000411650305

      target function =      -0.950050210137
              le_mean =     -17.211815719267
             les_mean =     296.523543685732
             stat err =       0.000406973114
             autocorr =       1.245099996918
   target nu stat err =       0.000406973114
   target dn stat err =       0.002050645059
      target stat err =       0.003556824004
              std dev =       0.515796750056
             le_variance =       0.266046287368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266062866514
                                         uncertainty =       0.001349971713

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266062866514
                                         uncertainty =       0.001349971713

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364724850
  error estimate for blocks of size 2^( 2) =       0.000378891126
  error estimate for blocks of size 2^( 3) =       0.000391521181
  error estimate for blocks of size 2^( 4) =       0.000401105798
  error estimate for blocks of size 2^( 5) =       0.000406754346
  error estimate for blocks of size 2^( 6) =       0.000408387986
  error estimate for blocks of size 2^( 7) =       0.000411651769

      target function =      -0.950113701095
              le_mean =     -17.211815229921
             les_mean =     296.523489445147
             stat err =       0.000406974975
             autocorr =       1.245101338415
   target nu stat err =       0.000406974975
   target dn stat err =       0.002050166425
      target stat err =       0.003556491292
              std dev =       0.515798829806
             le_variance =       0.266048432829

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266065049029
                                         uncertainty =       0.001350411226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266065049029
                                         uncertainty =       0.001350411226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364726355
  error estimate for blocks of size 2^( 2) =       0.000378892780
  error estimate for blocks of size 2^( 3) =       0.000391523196
  error estimate for blocks of size 2^( 4) =       0.000401107909
  error estimate for blocks of size 2^( 5) =       0.000406756231
  error estimate for blocks of size 2^( 6) =       0.000408389883
  error estimate for blocks of size 2^( 7) =       0.000411653319

      target function =      -0.950117844688
              le_mean =     -17.211814828622
             les_mean =     296.523473185989
             stat err =       0.000406976835
             autocorr =       1.245102448185
   target nu stat err =       0.000406976835
   target dn stat err =       0.002050206447
      target stat err =       0.003556586187
              std dev =       0.515800958252
             le_variance =       0.266050628534


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.950116767845        initial
     6.2500e+00     6.2500e+01             8.9291e-05        -0.950050210137
     2.5000e+01     2.5000e+02             2.2520e-05        -0.950113701095
     1.0000e+02     1.0000e+03             5.6425e-06        -0.950117844688  <--

*****************************************************************************
Applying the update for shift_i =   1.0000e+02     and shift_s =   1.0000e+03
*****************************************************************************

  Execution time = 2.3267e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
ci_001                -4.192991e-02 3 1  ON 0
ci_002                -3.211193e-02 3 1  ON 1
ci_003                -2.649475e-02 3 1  ON 2
ci_004                 2.373801e-02 3 1  ON 3
ci_005                 2.415206e-02 3 1  ON 4
ci_006                -2.148384e-02 3 1  ON 5
ci_007                -2.110475e-02 3 1  ON 6
ci_008                -8.490347e-03 3 1  ON 7
ci_009                -1.372727e-02 3 1  ON 8
ci_010                -1.010451e-02 3 1  ON 9
ci_011                -1.138944e-02 3 1  ON 10
ci_012                -9.741152e-03 3 1  ON 11
ci_013                -1.985889e-02 3 1  ON 12
ci_014                 1.226891e-02 3 1  ON 13
ci_015                 1.189524e-02 3 1  ON 14
ci_016                 1.756038e-02 3 1  ON 15
ci_017                 1.637398e-02 3 1  ON 16
ci_018                 1.025581e-02 3 1  ON 17
ci_019                 1.007071e-02 3 1  ON 18
ci_020                 1.793005e-02 3 1  ON 19
ci_021                 1.751926e-02 3 1  ON 20
ci_022                 9.161221e-03 3 1  ON 21
ci_023                 9.150212e-03 3 1  ON 22
ci_024                 9.625126e-03 3 1  ON 23
ci_025                 1.025702e-02 3 1  ON 24
ci_026                 1.170214e-02 3 1  ON 25
ci_027                 1.178292e-02 3 1  ON 26
ci_028                -1.469182e-02 3 1  ON 27
ci_029                -1.657543e-02 3 1  ON 28
ci_030                -9.578961e-03 3 1  ON 29
ci_031                -8.975154e-03 3 1  ON 30
ci_032                -1.470220e-02 3 1  ON 31
ci_033                 5.176978e-03 3 1  ON 32
ci_034                 5.619262e-03 3 1  ON 33
ci_035                -5.096292e-03 3 1  ON 34
ci_036                -1.277858e-02 3 1  ON 35
ci_037                -1.233896e-02 3 1  ON 36
ci_038                 2.143731e-03 3 1  ON 37
ci_039                 1.727864e-03 3 1  ON 38
ci_040                -3.233518e-03 3 1  ON 39
ci_041                 9.598403e-03 3 1  ON 40
ci_042                 8.191439e-03 3 1  ON 41
ci_043                -4.128101e-03 3 1  ON 42
ci_044                -3.871789e-03 3 1  ON 43
ci_045                -3.615877e-03 3 1  ON 44
ci_046                 5.642468e-03 3 1  ON 45
ci_047                 5.510802e-03 3 1  ON 46
ci_048                -1.261420e-02 3 1  ON 47
ci_049                -1.449599e-02 3 1  ON 48
ci_050                 3.127457e-03 3 1  ON 49
ci_051                 2.750302e-03 3 1  ON 50
ci_052                -2.284174e-03 3 1  ON 51
ci_053                -2.437247e-03 3 1  ON 52
ci_054                -3.427446e-03 3 1  ON 53
ci_055                -2.983383e-03 3 1  ON 54
ci_056                 5.601415e-03 3 1  ON 55
ci_057                 5.297761e-03 3 1  ON 56
ci_058                -9.835328e-04 3 1  ON 57
ci_059                -2.298992e-03 3 1  ON 58
ci_060                 4.610953e-03 3 1  ON 59
ci_061                 5.725490e-03 3 1  ON 60
ci_062                -3.734186e-03 3 1  ON 61
ci_063                -4.033262e-03 3 1  ON 62
ci_064                -2.539873e-03 3 1  ON 63
ci_065                -4.364611e-03 3 1  ON 64
ci_066                 4.433427e-03 3 1  ON 65
ci_067                 4.360558e-03 3 1  ON 66
ci_068                -4.160459e-03 3 1  ON 67
ci_069                -5.055584e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2022e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.299
    reference variance = 0.36979
====================================================
  Execution time = 1.4227e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8150e-01
  Total weights = 1.957008506e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4706e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267325003506
                                         uncertainty =       0.001429894813

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267325003506
                                         uncertainty =       0.001429894813

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365613623
  error estimate for blocks of size 2^( 2) =       0.000379405333
  error estimate for blocks of size 2^( 3) =       0.000391905097
  error estimate for blocks of size 2^( 4) =       0.000401233922
  error estimate for blocks of size 2^( 5) =       0.000406259290
  error estimate for blocks of size 2^( 6) =       0.000408022296
  error estimate for blocks of size 2^( 7) =       0.000408803284

      target function =      -0.942375680227
              le_mean =     -17.212224685066
             les_mean =     296.542174013437
             stat err =       0.000406079698
             autocorr =       1.233609815421
   target nu stat err =       0.000406079698
   target dn stat err =       0.002714644224
      target stat err =       0.004595229721
              std dev =       0.517055743963
             le_variance =       0.267346642365


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721222468507e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942397266267       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942399991734       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942400289919       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942400432735       residual = 5.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942400448199       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942400450725       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942400454151       residual = 3.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942400454875       residual = 8.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942400454885       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942400454937       residual = 1.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+01 is 6.878266e-06

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942397266267       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942397949290       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942398023990       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942398059742       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942398063611       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942398064243       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942398065100       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942398065281       residual = 8.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942398065284       residual = 1.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942398065297       residual = 1.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+02 is 1.723896e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942397266267       residual = 1.93e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942397437127       residual = 1.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942397455811       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942397464752       residual = 5.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942397465720       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942397465878       residual = 2.83e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942397466092       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942397466137       residual = 8.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942397466138       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942397466141       residual = 1.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+02 is 4.312454e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.055927 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6706e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_001                -4.192946e-02 3 1  ON 0
ci_002                -3.211138e-02 3 1  ON 1
ci_003                -2.649333e-02 3 1  ON 2
ci_004                 2.373796e-02 3 1  ON 3
ci_005                 2.415142e-02 3 1  ON 4
ci_006                -2.148382e-02 3 1  ON 5
ci_007                -2.110401e-02 3 1  ON 6
ci_008                -8.490865e-03 3 1  ON 7
ci_009                -1.372780e-02 3 1  ON 8
ci_010                -1.010411e-02 3 1  ON 9
ci_011                -1.138875e-02 3 1  ON 10
ci_012                -9.741216e-03 3 1  ON 11
ci_013                -1.985900e-02 3 1  ON 12
ci_014                 1.226940e-02 3 1  ON 13
ci_015                 1.189680e-02 3 1  ON 14
ci_016                 1.755955e-02 3 1  ON 15
ci_017                 1.637370e-02 3 1  ON 16
ci_018                 1.025633e-02 3 1  ON 17
ci_019                 1.007093e-02 3 1  ON 18
ci_020                 1.792923e-02 3 1  ON 19
ci_021                 1.751853e-02 3 1  ON 20
ci_022                 9.160979e-03 3 1  ON 21
ci_023                 9.150285e-03 3 1  ON 22
ci_024                 9.625204e-03 3 1  ON 23
ci_025                 1.025613e-02 3 1  ON 24
ci_026                 1.170232e-02 3 1  ON 25
ci_027                 1.178329e-02 3 1  ON 26
ci_028                -1.469176e-02 3 1  ON 27
ci_029                -1.657464e-02 3 1  ON 28
ci_030                -9.578906e-03 3 1  ON 29
ci_031                -8.975116e-03 3 1  ON 30
ci_032                -1.470290e-02 3 1  ON 31
ci_033                 5.177553e-03 3 1  ON 32
ci_034                 5.619149e-03 3 1  ON 33
ci_035                -5.096489e-03 3 1  ON 34
ci_036                -1.277881e-02 3 1  ON 35
ci_037                -1.233914e-02 3 1  ON 36
ci_038                 2.142936e-03 3 1  ON 37
ci_039                 1.727591e-03 3 1  ON 38
ci_040                -3.233716e-03 3 1  ON 39
ci_041                 9.596960e-03 3 1  ON 40
ci_042                 8.191827e-03 3 1  ON 41
ci_043                -4.127705e-03 3 1  ON 42
ci_044                -3.871961e-03 3 1  ON 43
ci_045                -3.615331e-03 3 1  ON 44
ci_046                 5.642285e-03 3 1  ON 45
ci_047                 5.510928e-03 3 1  ON 46
ci_048                -1.261466e-02 3 1  ON 47
ci_049                -1.449482e-02 3 1  ON 48
ci_050                 3.127850e-03 3 1  ON 49
ci_051                 2.750370e-03 3 1  ON 50
ci_052                -2.284240e-03 3 1  ON 51
ci_053                -2.437468e-03 3 1  ON 52
ci_054                -3.427116e-03 3 1  ON 53
ci_055                -2.983310e-03 3 1  ON 54
ci_056                 5.601280e-03 3 1  ON 55
ci_057                 5.297361e-03 3 1  ON 56
ci_058                -9.852567e-04 3 1  ON 57
ci_059                -2.298391e-03 3 1  ON 58
ci_060                 4.610519e-03 3 1  ON 59
ci_061                 5.725295e-03 3 1  ON 60
ci_062                -3.734225e-03 3 1  ON 61
ci_063                -4.033340e-03 3 1  ON 62
ci_064                -2.540768e-03 3 1  ON 63
ci_065                -4.364574e-03 3 1  ON 64
ci_066                 4.433668e-03 3 1  ON 65
ci_067                 4.360596e-03 3 1  ON 66
ci_068                -4.160699e-03 3 1  ON 67
ci_069                -5.055507e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2456
    reference variance = 0.297525
====================================================
  Execution time = 1.3690e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8276e-01
  Total weights = 1.9571e+06
  Execution time = 1.8259e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270249948089
                                         uncertainty =       0.001792031980

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270249948089
                                         uncertainty =       0.001792031980

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367587068
  error estimate for blocks of size 2^( 2) =       0.000381596875
  error estimate for blocks of size 2^( 3) =       0.000394211382
  error estimate for blocks of size 2^( 4) =       0.000402891711
  error estimate for blocks of size 2^( 5) =       0.000407839083
  error estimate for blocks of size 2^( 6) =       0.000410398117
  error estimate for blocks of size 2^( 7) =       0.000413272542

      target function =      -0.940267539938
              le_mean =     -17.212354934147
             les_mean =     296.547922955642
             stat err =       0.000408600363
             autocorr =       1.235597578842
   target nu stat err =       0.000408600363
   target dn stat err =       0.002565397174
      target stat err =       0.004331600139
              std dev =       0.519846616552
             le_variance =       0.270240504741

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270247851192
                                         uncertainty =       0.001792091467

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270247851192
                                         uncertainty =       0.001792091467

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367585645
  error estimate for blocks of size 2^( 2) =       0.000381595406
  error estimate for blocks of size 2^( 3) =       0.000394210028
  error estimate for blocks of size 2^( 4) =       0.000402890281
  error estimate for blocks of size 2^( 5) =       0.000407837476
  error estimate for blocks of size 2^( 6) =       0.000410396617
  error estimate for blocks of size 2^( 7) =       0.000413271118

      target function =      -0.940261300807
              le_mean =     -17.212354905824
             les_mean =     296.547925727124
             stat err =       0.000408598873
             autocorr =       1.235598130534
   target nu stat err =       0.000408598873
   target dn stat err =       0.002565567699
      target stat err =       0.004331822686
              std dev =       0.519844604926
             le_variance =       0.270238413271

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270248895465
                                         uncertainty =       0.001792061773

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270248895465
                                         uncertainty =       0.001792061773

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367586354
  error estimate for blocks of size 2^( 2) =       0.000381596138
  error estimate for blocks of size 2^( 3) =       0.000394210702
  error estimate for blocks of size 2^( 4) =       0.000402890993
  error estimate for blocks of size 2^( 5) =       0.000407838276
  error estimate for blocks of size 2^( 6) =       0.000410397364
  error estimate for blocks of size 2^( 7) =       0.000413271826

      target function =      -0.940264842676
              le_mean =     -17.212354919812
             les_mean =     296.547924081779
             stat err =       0.000408599615
             autocorr =       1.235597854080
   target nu stat err =       0.000408599615
   target dn stat err =       0.002565475927
      target stat err =       0.004331704563
              std dev =       0.519845606731
             le_variance =       0.270239454837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270249816235
                                         uncertainty =       0.001792035703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270249816235
                                         uncertainty =       0.001792035703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367586978
  error estimate for blocks of size 2^( 2) =       0.000381596783
  error estimate for blocks of size 2^( 3) =       0.000394211297
  error estimate for blocks of size 2^( 4) =       0.000402891621
  error estimate for blocks of size 2^( 5) =       0.000407838982
  error estimate for blocks of size 2^( 6) =       0.000410398023
  error estimate for blocks of size 2^( 7) =       0.000413272452

      target function =      -0.940267246787
              le_mean =     -17.212354932338
             les_mean =     296.547923069379
             stat err =       0.000408600269
             autocorr =       1.235597613234
   target nu stat err =       0.000408600269
   target dn stat err =       0.002565406375
      target stat err =       0.004331612536
              std dev =       0.519846490059
             le_variance =       0.270240373226


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940267539938        initial  <--
     2.5000e+01     2.5000e+02             6.8783e-06        -0.940261300807
     1.0000e+02     1.0000e+03             1.7239e-06        -0.940264842676
     4.0000e+02     4.0000e+03             4.3125e-07        -0.940267246787

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0319
  </log>
  <optVariables href="H2O.s011.opt.xml">
ci_001                -4.192991e-02 3 1  ON 0
ci_002                -3.211193e-02 3 1  ON 1
ci_003                -2.649475e-02 3 1  ON 2
ci_004                 2.373801e-02 3 1  ON 3
ci_005                 2.415206e-02 3 1  ON 4
ci_006                -2.148384e-02 3 1  ON 5
ci_007                -2.110475e-02 3 1  ON 6
ci_008                -8.490347e-03 3 1  ON 7
ci_009                -1.372727e-02 3 1  ON 8
ci_010                -1.010451e-02 3 1  ON 9
ci_011                -1.138944e-02 3 1  ON 10
ci_012                -9.741152e-03 3 1  ON 11
ci_013                -1.985889e-02 3 1  ON 12
ci_014                 1.226891e-02 3 1  ON 13
ci_015                 1.189524e-02 3 1  ON 14
ci_016                 1.756038e-02 3 1  ON 15
ci_017                 1.637398e-02 3 1  ON 16
ci_018                 1.025581e-02 3 1  ON 17
ci_019                 1.007071e-02 3 1  ON 18
ci_020                 1.793005e-02 3 1  ON 19
ci_021                 1.751926e-02 3 1  ON 20
ci_022                 9.161221e-03 3 1  ON 21
ci_023                 9.150212e-03 3 1  ON 22
ci_024                 9.625126e-03 3 1  ON 23
ci_025                 1.025702e-02 3 1  ON 24
ci_026                 1.170214e-02 3 1  ON 25
ci_027                 1.178292e-02 3 1  ON 26
ci_028                -1.469182e-02 3 1  ON 27
ci_029                -1.657543e-02 3 1  ON 28
ci_030                -9.578961e-03 3 1  ON 29
ci_031                -8.975154e-03 3 1  ON 30
ci_032                -1.470220e-02 3 1  ON 31
ci_033                 5.176978e-03 3 1  ON 32
ci_034                 5.619262e-03 3 1  ON 33
ci_035                -5.096292e-03 3 1  ON 34
ci_036                -1.277858e-02 3 1  ON 35
ci_037                -1.233896e-02 3 1  ON 36
ci_038                 2.143731e-03 3 1  ON 37
ci_039                 1.727864e-03 3 1  ON 38
ci_040                -3.233518e-03 3 1  ON 39
ci_041                 9.598403e-03 3 1  ON 40
ci_042                 8.191439e-03 3 1  ON 41
ci_043                -4.128101e-03 3 1  ON 42
ci_044                -3.871789e-03 3 1  ON 43
ci_045                -3.615877e-03 3 1  ON 44
ci_046                 5.642468e-03 3 1  ON 45
ci_047                 5.510802e-03 3 1  ON 46
ci_048                -1.261420e-02 3 1  ON 47
ci_049                -1.449599e-02 3 1  ON 48
ci_050                 3.127457e-03 3 1  ON 49
ci_051                 2.750302e-03 3 1  ON 50
ci_052                -2.284174e-03 3 1  ON 51
ci_053                -2.437247e-03 3 1  ON 52
ci_054                -3.427446e-03 3 1  ON 53
ci_055                -2.983383e-03 3 1  ON 54
ci_056                 5.601415e-03 3 1  ON 55
ci_057                 5.297761e-03 3 1  ON 56
ci_058                -9.835328e-04 3 1  ON 57
ci_059                -2.298992e-03 3 1  ON 58
ci_060                 4.610953e-03 3 1  ON 59
ci_061                 5.725490e-03 3 1  ON 60
ci_062                -3.734186e-03 3 1  ON 61
ci_063                -4.033262e-03 3 1  ON 62
ci_064                -2.539873e-03 3 1  ON 63
ci_065                -4.364611e-03 3 1  ON 64
ci_066                 4.433427e-03 3 1  ON 65
ci_067                 4.360558e-03 3 1  ON 66
ci_068                -4.160459e-03 3 1  ON 67
ci_069                -5.055584e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9752e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1889
    reference variance = 0.173055
====================================================
  Execution time = 1.4234e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8045e-01
  Total weights = 1.957492874e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5256e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268541102652
                                         uncertainty =       0.001497568699

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268541102652
                                         uncertainty =       0.001497568699

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366426429
  error estimate for blocks of size 2^( 2) =       0.000380236722
  error estimate for blocks of size 2^( 3) =       0.000392631685
  error estimate for blocks of size 2^( 4) =       0.000401493832
  error estimate for blocks of size 2^( 5) =       0.000407711793
  error estimate for blocks of size 2^( 6) =       0.000408868431
  error estimate for blocks of size 2^( 7) =       0.000407810743

      target function =      -0.944135223629
              le_mean =     -17.212961054943
             les_mean =     296.566476801155
             stat err =       0.000406471200
             autocorr =       1.230512351708
   target nu stat err =       0.000406471200
   target dn stat err =       0.002540896727
      target stat err =       0.004330572047
              std dev =       0.518205226143
             le_variance =       0.268536656402


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721296105494e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944153903364       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944154133756       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944154177424       residual = 4.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944154185148       residual = 6.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944154185895       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944154186241       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944154186025       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944154185961       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944154185987       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944154186001       residual = 6.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+02 is 5.673588e-07

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944153903364       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944153960976       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944153971895       residual = 4.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944153973827       residual = 6.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944153974014       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944153974099       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944153974045       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944153974029       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944153974035       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944153974037       residual = 6.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+03 is 1.418690e-07

solving harmonic davidson linear method for identity shift 4.0000e+03, overlap shift 4.0000e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944153903364       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944153917767       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944153920497       residual = 4.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944153920980       residual = 6.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944153921029       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944153921048       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944153921036       residual = 8.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944153921031       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944153921033       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944153921035       residual = 6.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+03 is 3.546909e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.059374 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6769e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_001                -4.192988e-02 3 1  ON 0
ci_002                -3.211189e-02 3 1  ON 1
ci_003                -2.649470e-02 3 1  ON 2
ci_004                 2.373794e-02 3 1  ON 3
ci_005                 2.415204e-02 3 1  ON 4
ci_006                -2.148379e-02 3 1  ON 5
ci_007                -2.110460e-02 3 1  ON 6
ci_008                -8.490415e-03 3 1  ON 7
ci_009                -1.372737e-02 3 1  ON 8
ci_010                -1.010441e-02 3 1  ON 9
ci_011                -1.138938e-02 3 1  ON 10
ci_012                -9.741150e-03 3 1  ON 11
ci_013                -1.985883e-02 3 1  ON 12
ci_014                 1.226897e-02 3 1  ON 13
ci_015                 1.189527e-02 3 1  ON 14
ci_016                 1.756035e-02 3 1  ON 15
ci_017                 1.637398e-02 3 1  ON 16
ci_018                 1.025583e-02 3 1  ON 17
ci_019                 1.007071e-02 3 1  ON 18
ci_020                 1.792998e-02 3 1  ON 19
ci_021                 1.751923e-02 3 1  ON 20
ci_022                 9.161217e-03 3 1  ON 21
ci_023                 9.150249e-03 3 1  ON 22
ci_024                 9.625028e-03 3 1  ON 23
ci_025                 1.025697e-02 3 1  ON 24
ci_026                 1.170210e-02 3 1  ON 25
ci_027                 1.178286e-02 3 1  ON 26
ci_028                -1.469185e-02 3 1  ON 27
ci_029                -1.657539e-02 3 1  ON 28
ci_030                -9.578956e-03 3 1  ON 29
ci_031                -8.975226e-03 3 1  ON 30
ci_032                -1.470223e-02 3 1  ON 31
ci_033                 5.177035e-03 3 1  ON 32
ci_034                 5.619357e-03 3 1  ON 33
ci_035                -5.096288e-03 3 1  ON 34
ci_036                -1.277851e-02 3 1  ON 35
ci_037                -1.233902e-02 3 1  ON 36
ci_038                 2.143711e-03 3 1  ON 37
ci_039                 1.727880e-03 3 1  ON 38
ci_040                -3.233462e-03 3 1  ON 39
ci_041                 9.598320e-03 3 1  ON 40
ci_042                 8.191448e-03 3 1  ON 41
ci_043                -4.128098e-03 3 1  ON 42
ci_044                -3.871792e-03 3 1  ON 43
ci_045                -3.615822e-03 3 1  ON 44
ci_046                 5.642493e-03 3 1  ON 45
ci_047                 5.510790e-03 3 1  ON 46
ci_048                -1.261423e-02 3 1  ON 47
ci_049                -1.449585e-02 3 1  ON 48
ci_050                 3.127484e-03 3 1  ON 49
ci_051                 2.750320e-03 3 1  ON 50
ci_052                -2.284177e-03 3 1  ON 51
ci_053                -2.437269e-03 3 1  ON 52
ci_054                -3.427386e-03 3 1  ON 53
ci_055                -2.983313e-03 3 1  ON 54
ci_056                 5.601359e-03 3 1  ON 55
ci_057                 5.297758e-03 3 1  ON 56
ci_058                -9.836222e-04 3 1  ON 57
ci_059                -2.299013e-03 3 1  ON 58
ci_060                 4.610963e-03 3 1  ON 59
ci_061                 5.725350e-03 3 1  ON 60
ci_062                -3.734293e-03 3 1  ON 61
ci_063                -4.033251e-03 3 1  ON 62
ci_064                -2.539916e-03 3 1  ON 63
ci_065                -4.364603e-03 3 1  ON 64
ci_066                 4.433435e-03 3 1  ON 65
ci_067                 4.360569e-03 3 1  ON 66
ci_068                -4.160550e-03 3 1  ON 67
ci_069                -5.055522e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2113
    reference variance = 0.196884
====================================================
  Execution time = 1.3680e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7728e-01
  Total weights = 1.9571e+06
  Execution time = 1.8311e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266388628295
                                         uncertainty =       0.001341667347

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266388628295
                                         uncertainty =       0.001341667347

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364978622
  error estimate for blocks of size 2^( 2) =       0.000379082570
  error estimate for blocks of size 2^( 3) =       0.000392149504
  error estimate for blocks of size 2^( 4) =       0.000401583331
  error estimate for blocks of size 2^( 5) =       0.000407350366
  error estimate for blocks of size 2^( 6) =       0.000410796938
  error estimate for blocks of size 2^( 7) =       0.000412921185

      target function =      -0.949494192548
              le_mean =     -17.212251000356
             les_mean =     296.538860591851
             stat err =       0.000408162955
             autocorr =       1.250640004073
   target nu stat err =       0.000408162955
   target dn stat err =       0.001926102694
      target stat err =       0.003349489417
              std dev =       0.516157717744
             le_variance =       0.266418789586

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266388483835
                                         uncertainty =       0.001341668999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266388483835
                                         uncertainty =       0.001341668999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364978523
  error estimate for blocks of size 2^( 2) =       0.000379082471
  error estimate for blocks of size 2^( 3) =       0.000392149415
  error estimate for blocks of size 2^( 4) =       0.000401583253
  error estimate for blocks of size 2^( 5) =       0.000407350286
  error estimate for blocks of size 2^( 6) =       0.000410796870
  error estimate for blocks of size 2^( 7) =       0.000412921115

      target function =      -0.949493702008
              le_mean =     -17.212250993971
             les_mean =     296.538860661102
             stat err =       0.000408162881
             autocorr =       1.250640231994
   target nu stat err =       0.000408162881
   target dn stat err =       0.001926093142
      target stat err =       0.003349470145
              std dev =       0.516157577089
             le_variance =       0.266418644386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266388556031
                                         uncertainty =       0.001341668173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266388556031
                                         uncertainty =       0.001341668173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364978573
  error estimate for blocks of size 2^( 2) =       0.000379082521
  error estimate for blocks of size 2^( 3) =       0.000392149459
  error estimate for blocks of size 2^( 4) =       0.000401583292
  error estimate for blocks of size 2^( 5) =       0.000407350326
  error estimate for blocks of size 2^( 6) =       0.000410796904
  error estimate for blocks of size 2^( 7) =       0.000412921150

      target function =      -0.949493955008
              le_mean =     -17.212250997161
             les_mean =     296.538860621854
             stat err =       0.000408162918
             autocorr =       1.250640118073
   target nu stat err =       0.000408162918
   target dn stat err =       0.001926097857
      target stat err =       0.003349479734
              std dev =       0.516157647384
             le_variance =       0.266418716953

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266388619259
                                         uncertainty =       0.001341667450

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266388619259
                                         uncertainty =       0.001341667450

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364978616
  error estimate for blocks of size 2^( 2) =       0.000379082564
  error estimate for blocks of size 2^( 3) =       0.000392149498
  error estimate for blocks of size 2^( 4) =       0.000401583326
  error estimate for blocks of size 2^( 5) =       0.000407350361
  error estimate for blocks of size 2^( 6) =       0.000410796934
  error estimate for blocks of size 2^( 7) =       0.000412921181

      target function =      -0.949494163685
              le_mean =     -17.212250999957
             les_mean =     296.538860595107
             stat err =       0.000408162951
             autocorr =       1.250640018327
   target nu stat err =       0.000408162951
   target dn stat err =       0.001926102083
      target stat err =       0.003349488201
              std dev =       0.516157708946
             le_variance =       0.266418780505


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949494192548        initial  <--
     2.5000e+02     2.5000e+03             5.6736e-07        -0.949493702008
     1.0000e+03     1.0000e+04             1.4187e-07        -0.949493955008
     4.0000e+03     4.0000e+04             3.5469e-08        -0.949494163685

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0342
  </log>
  <optVariables href="H2O.s012.opt.xml">
ci_001                -4.192991e-02 3 1  ON 0
ci_002                -3.211193e-02 3 1  ON 1
ci_003                -2.649475e-02 3 1  ON 2
ci_004                 2.373801e-02 3 1  ON 3
ci_005                 2.415206e-02 3 1  ON 4
ci_006                -2.148384e-02 3 1  ON 5
ci_007                -2.110475e-02 3 1  ON 6
ci_008                -8.490347e-03 3 1  ON 7
ci_009                -1.372727e-02 3 1  ON 8
ci_010                -1.010451e-02 3 1  ON 9
ci_011                -1.138944e-02 3 1  ON 10
ci_012                -9.741152e-03 3 1  ON 11
ci_013                -1.985889e-02 3 1  ON 12
ci_014                 1.226891e-02 3 1  ON 13
ci_015                 1.189524e-02 3 1  ON 14
ci_016                 1.756038e-02 3 1  ON 15
ci_017                 1.637398e-02 3 1  ON 16
ci_018                 1.025581e-02 3 1  ON 17
ci_019                 1.007071e-02 3 1  ON 18
ci_020                 1.793005e-02 3 1  ON 19
ci_021                 1.751926e-02 3 1  ON 20
ci_022                 9.161221e-03 3 1  ON 21
ci_023                 9.150212e-03 3 1  ON 22
ci_024                 9.625126e-03 3 1  ON 23
ci_025                 1.025702e-02 3 1  ON 24
ci_026                 1.170214e-02 3 1  ON 25
ci_027                 1.178292e-02 3 1  ON 26
ci_028                -1.469182e-02 3 1  ON 27
ci_029                -1.657543e-02 3 1  ON 28
ci_030                -9.578961e-03 3 1  ON 29
ci_031                -8.975154e-03 3 1  ON 30
ci_032                -1.470220e-02 3 1  ON 31
ci_033                 5.176978e-03 3 1  ON 32
ci_034                 5.619262e-03 3 1  ON 33
ci_035                -5.096292e-03 3 1  ON 34
ci_036                -1.277858e-02 3 1  ON 35
ci_037                -1.233896e-02 3 1  ON 36
ci_038                 2.143731e-03 3 1  ON 37
ci_039                 1.727864e-03 3 1  ON 38
ci_040                -3.233518e-03 3 1  ON 39
ci_041                 9.598403e-03 3 1  ON 40
ci_042                 8.191439e-03 3 1  ON 41
ci_043                -4.128101e-03 3 1  ON 42
ci_044                -3.871789e-03 3 1  ON 43
ci_045                -3.615877e-03 3 1  ON 44
ci_046                 5.642468e-03 3 1  ON 45
ci_047                 5.510802e-03 3 1  ON 46
ci_048                -1.261420e-02 3 1  ON 47
ci_049                -1.449599e-02 3 1  ON 48
ci_050                 3.127457e-03 3 1  ON 49
ci_051                 2.750302e-03 3 1  ON 50
ci_052                -2.284174e-03 3 1  ON 51
ci_053                -2.437247e-03 3 1  ON 52
ci_054                -3.427446e-03 3 1  ON 53
ci_055                -2.983383e-03 3 1  ON 54
ci_056                 5.601415e-03 3 1  ON 55
ci_057                 5.297761e-03 3 1  ON 56
ci_058                -9.835328e-04 3 1  ON 57
ci_059                -2.298992e-03 3 1  ON 58
ci_060                 4.610953e-03 3 1  ON 59
ci_061                 5.725490e-03 3 1  ON 60
ci_062                -3.734186e-03 3 1  ON 61
ci_063                -4.033262e-03 3 1  ON 62
ci_064                -2.539873e-03 3 1  ON 63
ci_065                -4.364611e-03 3 1  ON 64
ci_066                 4.433427e-03 3 1  ON 65
ci_067                 4.360558e-03 3 1  ON 66
ci_068                -4.160459e-03 3 1  ON 67
ci_069                -5.055584e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9809e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2335
    reference variance = 0.362391
====================================================
  Execution time = 1.4056e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5302e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7517e-01
  Total weights = 1.957535369e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4954e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265016854508
                                         uncertainty =       0.001397729216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265016854508
                                         uncertainty =       0.001397729216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364091308
  error estimate for blocks of size 2^( 2) =       0.000378390814
  error estimate for blocks of size 2^( 3) =       0.000390745848
  error estimate for blocks of size 2^( 4) =       0.000399767983
  error estimate for blocks of size 2^( 5) =       0.000405849262
  error estimate for blocks of size 2^( 6) =       0.000409016852
  error estimate for blocks of size 2^( 7) =       0.000412108952

      target function =      -0.953072046163
              le_mean =     -17.211907559568
             les_mean =     296.524934868206
             stat err =       0.000406685762
             autocorr =       1.247663050781
   target nu stat err =       0.000406685762
   target dn stat err =       0.001662970919
      target stat err =       0.002933994956
              std dev =       0.514902866136
             le_variance =       0.265124961555


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721190755957e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.953079994640       residual = 2.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.953080025648       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.953080028175       residual = 4.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.953080029187       residual = 8.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.953080029199       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.953080029178       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.953080029194       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.953080029193       residual = 9.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.953080029200       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.953080029198       residual = 2.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+03 is 7.089047e-08

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.953079994640       residual = 2.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.953080002392       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.953080003024       residual = 4.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.953080003277       residual = 8.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.953080003267       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.953080003279       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.953080003287       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.953080003279       residual = 9.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.953080003293       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.953080003277       residual = 2.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+04 is 1.772306e-08

solving harmonic davidson linear method for identity shift 4.0000e+04, overlap shift 4.0000e+05 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.953079994640       residual = 2.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.953079996578       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.953079996736       residual = 4.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.953079996799       residual = 8.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.953079996811       residual = 1.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.953079996722       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.953079996790       residual = 4.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.953079996810       residual = 9.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.953079996753       residual = 1.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.953079996754       residual = 2.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 4.0000e+04 is 4.430794e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.062871 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6560e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_001                -4.192990e-02 3 1  ON 0
ci_002                -3.211192e-02 3 1  ON 1
ci_003                -2.649474e-02 3 1  ON 2
ci_004                 2.373801e-02 3 1  ON 3
ci_005                 2.415205e-02 3 1  ON 4
ci_006                -2.148383e-02 3 1  ON 5
ci_007                -2.110474e-02 3 1  ON 6
ci_008                -8.490350e-03 3 1  ON 7
ci_009                -1.372728e-02 3 1  ON 8
ci_010                -1.010451e-02 3 1  ON 9
ci_011                -1.138943e-02 3 1  ON 10
ci_012                -9.741165e-03 3 1  ON 11
ci_013                -1.985890e-02 3 1  ON 12
ci_014                 1.226892e-02 3 1  ON 13
ci_015                 1.189525e-02 3 1  ON 14
ci_016                 1.756038e-02 3 1  ON 15
ci_017                 1.637397e-02 3 1  ON 16
ci_018                 1.025580e-02 3 1  ON 17
ci_019                 1.007071e-02 3 1  ON 18
ci_020                 1.793004e-02 3 1  ON 19
ci_021                 1.751926e-02 3 1  ON 20
ci_022                 9.161224e-03 3 1  ON 21
ci_023                 9.150214e-03 3 1  ON 22
ci_024                 9.625123e-03 3 1  ON 23
ci_025                 1.025702e-02 3 1  ON 24
ci_026                 1.170214e-02 3 1  ON 25
ci_027                 1.178291e-02 3 1  ON 26
ci_028                -1.469182e-02 3 1  ON 27
ci_029                -1.657541e-02 3 1  ON 28
ci_030                -9.578959e-03 3 1  ON 29
ci_031                -8.975157e-03 3 1  ON 30
ci_032                -1.470220e-02 3 1  ON 31
ci_033                 5.176980e-03 3 1  ON 32
ci_034                 5.619266e-03 3 1  ON 33
ci_035                -5.096290e-03 3 1  ON 34
ci_036                -1.277859e-02 3 1  ON 35
ci_037                -1.233896e-02 3 1  ON 36
ci_038                 2.143725e-03 3 1  ON 37
ci_039                 1.727863e-03 3 1  ON 38
ci_040                -3.233515e-03 3 1  ON 39
ci_041                 9.598385e-03 3 1  ON 40
ci_042                 8.191441e-03 3 1  ON 41
ci_043                -4.128104e-03 3 1  ON 42
ci_044                -3.871787e-03 3 1  ON 43
ci_045                -3.615871e-03 3 1  ON 44
ci_046                 5.642465e-03 3 1  ON 45
ci_047                 5.510803e-03 3 1  ON 46
ci_048                -1.261421e-02 3 1  ON 47
ci_049                -1.449598e-02 3 1  ON 48
ci_050                 3.127453e-03 3 1  ON 49
ci_051                 2.750308e-03 3 1  ON 50
ci_052                -2.284179e-03 3 1  ON 51
ci_053                -2.437251e-03 3 1  ON 52
ci_054                -3.427439e-03 3 1  ON 53
ci_055                -2.983379e-03 3 1  ON 54
ci_056                 5.601410e-03 3 1  ON 55
ci_057                 5.297754e-03 3 1  ON 56
ci_058                -9.835454e-04 3 1  ON 57
ci_059                -2.298983e-03 3 1  ON 58
ci_060                 4.610961e-03 3 1  ON 59
ci_061                 5.725486e-03 3 1  ON 60
ci_062                -3.734191e-03 3 1  ON 61
ci_063                -4.033260e-03 3 1  ON 62
ci_064                -2.539877e-03 3 1  ON 63
ci_065                -4.364606e-03 3 1  ON 64
ci_066                 4.433426e-03 3 1  ON 65
ci_067                 4.360562e-03 3 1  ON 66
ci_068                -4.160460e-03 3 1  ON 67
ci_069                -5.055587e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2285
    reference variance = 0.349076
====================================================
  Execution time = 1.5758e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7764e-01
  Total weights = 1.9574e+06
  Execution time = 1.8193e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266259252465
                                         uncertainty =       0.001484001374

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266259252465
                                         uncertainty =       0.001484001374

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364852634
  error estimate for blocks of size 2^( 2) =       0.000378719641
  error estimate for blocks of size 2^( 3) =       0.000391280172
  error estimate for blocks of size 2^( 4) =       0.000400700849
  error estimate for blocks of size 2^( 5) =       0.000406656975
  error estimate for blocks of size 2^( 6) =       0.000408956491
  error estimate for blocks of size 2^( 7) =       0.000410151898

      target function =      -0.948850870148
              le_mean =     -17.211290905597
             les_mean =     296.506178147890
             stat err =       0.000406616553
             autocorr =       1.242038724611
   target nu stat err =       0.000406616553
   target dn stat err =       0.002304481505
      target stat err =       0.003965775957
              std dev =       0.515979543762
             le_variance =       0.266234889581

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266259227824
                                         uncertainty =       0.001484000995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266259227824
                                         uncertainty =       0.001484000995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364852618
  error estimate for blocks of size 2^( 2) =       0.000378719624
  error estimate for blocks of size 2^( 3) =       0.000391280157
  error estimate for blocks of size 2^( 4) =       0.000400700834
  error estimate for blocks of size 2^( 5) =       0.000406656960
  error estimate for blocks of size 2^( 6) =       0.000408956473
  error estimate for blocks of size 2^( 7) =       0.000410151883

      target function =      -0.948850901242
              le_mean =     -17.211290904983
             les_mean =     296.506178108447
             stat err =       0.000406616537
             autocorr =       1.242038742727
   target nu stat err =       0.000406616537
   target dn stat err =       0.002304473627
      target stat err =       0.003965763098
              std dev =       0.515979520020
             le_variance =       0.266234865081

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266259240144
                                         uncertainty =       0.001484001185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266259240144
                                         uncertainty =       0.001484001185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364852626
  error estimate for blocks of size 2^( 2) =       0.000378719632
  error estimate for blocks of size 2^( 3) =       0.000391280165
  error estimate for blocks of size 2^( 4) =       0.000400700841
  error estimate for blocks of size 2^( 5) =       0.000406656967
  error estimate for blocks of size 2^( 6) =       0.000408956482
  error estimate for blocks of size 2^( 7) =       0.000410151891

      target function =      -0.948850885976
              le_mean =     -17.211290905290
             les_mean =     296.506178128001
             stat err =       0.000406616545
             autocorr =       1.242038733669
   target nu stat err =       0.000406616545
   target dn stat err =       0.002304477565
      target stat err =       0.003965769529
              std dev =       0.515979531891
             le_variance =       0.266234877330

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266259250924
                                         uncertainty =       0.001484001351

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266259250924
                                         uncertainty =       0.001484001351

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364852633
  error estimate for blocks of size 2^( 2) =       0.000378719639
  error estimate for blocks of size 2^( 3) =       0.000391280171
  error estimate for blocks of size 2^( 4) =       0.000400700848
  error estimate for blocks of size 2^( 5) =       0.000406656974
  error estimate for blocks of size 2^( 6) =       0.000408956490
  error estimate for blocks of size 2^( 7) =       0.000410151897

      target function =      -0.948850872157
              le_mean =     -17.211290905558
             les_mean =     296.506178145385
             stat err =       0.000406616552
             autocorr =       1.242038725728
   target nu stat err =       0.000406616552
   target dn stat err =       0.002304481013
      target stat err =       0.003965775154
              std dev =       0.515979542278
             le_variance =       0.266234888049


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948850870148        initial
     2.5000e+03     2.5000e+04             7.0890e-08        -0.948850901242  <--
     1.0000e+04     1.0000e+05             1.7723e-08        -0.948850885976
     4.0000e+04     4.0000e+05             4.4308e-09        -0.948850872157

*****************************************************************************
Applying the update for shift_i =   2.5000e+03     and shift_s =   2.5000e+04
*****************************************************************************

  Execution time = 2.5116e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
ci_001                -4.192988e-02 3 1  ON 0
ci_002                -3.211188e-02 3 1  ON 1
ci_003                -2.649471e-02 3 1  ON 2
ci_004                 2.373800e-02 3 1  ON 3
ci_005                 2.415204e-02 3 1  ON 4
ci_006                -2.148381e-02 3 1  ON 5
ci_007                -2.110473e-02 3 1  ON 6
ci_008                -8.490359e-03 3 1  ON 7
ci_009                -1.372731e-02 3 1  ON 8
ci_010                -1.010452e-02 3 1  ON 9
ci_011                -1.138942e-02 3 1  ON 10
ci_012                -9.741205e-03 3 1  ON 11
ci_013                -1.985890e-02 3 1  ON 12
ci_014                 1.226894e-02 3 1  ON 13
ci_015                 1.189528e-02 3 1  ON 14
ci_016                 1.756038e-02 3 1  ON 15
ci_017                 1.637397e-02 3 1  ON 16
ci_018                 1.025579e-02 3 1  ON 17
ci_019                 1.007072e-02 3 1  ON 18
ci_020                 1.793001e-02 3 1  ON 19
ci_021                 1.751927e-02 3 1  ON 20
ci_022                 9.161232e-03 3 1  ON 21
ci_023                 9.150220e-03 3 1  ON 22
ci_024                 9.625114e-03 3 1  ON 23
ci_025                 1.025700e-02 3 1  ON 24
ci_026                 1.170212e-02 3 1  ON 25
ci_027                 1.178288e-02 3 1  ON 26
ci_028                -1.469185e-02 3 1  ON 27
ci_029                -1.657537e-02 3 1  ON 28
ci_030                -9.578955e-03 3 1  ON 29
ci_031                -8.975166e-03 3 1  ON 30
ci_032                -1.470220e-02 3 1  ON 31
ci_033                 5.176987e-03 3 1  ON 32
ci_034                 5.619277e-03 3 1  ON 33
ci_035                -5.096281e-03 3 1  ON 34
ci_036                -1.277861e-02 3 1  ON 35
ci_037                -1.233897e-02 3 1  ON 36
ci_038                 2.143706e-03 3 1  ON 37
ci_039                 1.727857e-03 3 1  ON 38
ci_040                -3.233509e-03 3 1  ON 39
ci_041                 9.598332e-03 3 1  ON 40
ci_042                 8.191449e-03 3 1  ON 41
ci_043                -4.128111e-03 3 1  ON 42
ci_044                -3.871782e-03 3 1  ON 43
ci_045                -3.615853e-03 3 1  ON 44
ci_046                 5.642458e-03 3 1  ON 45
ci_047                 5.510805e-03 3 1  ON 46
ci_048                -1.261423e-02 3 1  ON 47
ci_049                -1.449595e-02 3 1  ON 48
ci_050                 3.127441e-03 3 1  ON 49
ci_051                 2.750327e-03 3 1  ON 50
ci_052                -2.284194e-03 3 1  ON 51
ci_053                -2.437262e-03 3 1  ON 52
ci_054                -3.427421e-03 3 1  ON 53
ci_055                -2.983368e-03 3 1  ON 54
ci_056                 5.601394e-03 3 1  ON 55
ci_057                 5.297734e-03 3 1  ON 56
ci_058                -9.835833e-04 3 1  ON 57
ci_059                -2.298956e-03 3 1  ON 58
ci_060                 4.610986e-03 3 1  ON 59
ci_061                 5.725473e-03 3 1  ON 60
ci_062                -3.734207e-03 3 1  ON 61
ci_063                -4.033255e-03 3 1  ON 62
ci_064                -2.539888e-03 3 1  ON 63
ci_065                -4.364592e-03 3 1  ON 64
ci_066                 4.433422e-03 3 1  ON 65
ci_067                 4.360576e-03 3 1  ON 66
ci_068                -4.160464e-03 3 1  ON 67
ci_069                -5.055594e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1682e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1946
    reference variance = 0.172155
====================================================
  Execution time = 1.4025e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8515e-01
  Total weights = 1.957513412e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4931e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271217408741
                                         uncertainty =       0.001928511936

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271217408741
                                         uncertainty =       0.001928511936

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368234364
  error estimate for blocks of size 2^( 2) =       0.000382364315
  error estimate for blocks of size 2^( 3) =       0.000395178252
  error estimate for blocks of size 2^( 4) =       0.000404480869
  error estimate for blocks of size 2^( 5) =       0.000410067353
  error estimate for blocks of size 2^( 6) =       0.000412574544
  error estimate for blocks of size 2^( 7) =       0.000415651291

      target function =      -0.936293666640
              le_mean =     -17.211528615587
             les_mean =     296.521868637564
             stat err =       0.000410693514
             autocorr =       1.243904559331
   target nu stat err =       0.000410693514
   target dn stat err =       0.003566910885
      target stat err =       0.005923199942
              std dev =       0.520762031309
             le_variance =       0.271193093253


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721152861559e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936330014951       residual = 3.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936330238530       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936330257561       residual = 8.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936330263816       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936330264696       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936330265121       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936330265227       residual = 9.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936330265177       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936330265202       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936330265184       residual = 7.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+02 is 3.253099e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936330014951       residual = 3.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936330070851       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936330075609       residual = 8.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936330077173       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936330077393       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936330077496       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936330077525       residual = 9.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936330077514       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936330077517       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936330077517       residual = 7.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+03 is 8.133467e-08

solving harmonic davidson linear method for identity shift 1.0000e+04, overlap shift 1.0000e+05 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.936330014951       residual = 3.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.936330028926       residual = 2.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.936330030116       residual = 8.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.936330030506       residual = 1.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.936330030560       residual = 2.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.936330030597       residual = 5.49e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.936330030615       residual = 9.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.936330030597       residual = 2.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.936330030596       residual = 4.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.936330030573       residual = 7.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.0000e+04 is 2.033412e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.066337 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6526e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_001                -4.192988e-02 3 1  ON 0
ci_002                -3.211188e-02 3 1  ON 1
ci_003                -2.649463e-02 3 1  ON 2
ci_004                 2.373801e-02 3 1  ON 3
ci_005                 2.415203e-02 3 1  ON 4
ci_006                -2.148378e-02 3 1  ON 5
ci_007                -2.110470e-02 3 1  ON 6
ci_008                -8.490350e-03 3 1  ON 7
ci_009                -1.372735e-02 3 1  ON 8
ci_010                -1.010450e-02 3 1  ON 9
ci_011                -1.138938e-02 3 1  ON 10
ci_012                -9.741240e-03 3 1  ON 11
ci_013                -1.985888e-02 3 1  ON 12
ci_014                 1.226890e-02 3 1  ON 13
ci_015                 1.189528e-02 3 1  ON 14
ci_016                 1.756037e-02 3 1  ON 15
ci_017                 1.637401e-02 3 1  ON 16
ci_018                 1.025572e-02 3 1  ON 17
ci_019                 1.007071e-02 3 1  ON 18
ci_020                 1.792999e-02 3 1  ON 19
ci_021                 1.751928e-02 3 1  ON 20
ci_022                 9.161198e-03 3 1  ON 21
ci_023                 9.150243e-03 3 1  ON 22
ci_024                 9.625119e-03 3 1  ON 23
ci_025                 1.025695e-02 3 1  ON 24
ci_026                 1.170208e-02 3 1  ON 25
ci_027                 1.178283e-02 3 1  ON 26
ci_028                -1.469183e-02 3 1  ON 27
ci_029                -1.657529e-02 3 1  ON 28
ci_030                -9.578968e-03 3 1  ON 29
ci_031                -8.975131e-03 3 1  ON 30
ci_032                -1.470220e-02 3 1  ON 31
ci_033                 5.177008e-03 3 1  ON 32
ci_034                 5.619277e-03 3 1  ON 33
ci_035                -5.096284e-03 3 1  ON 34
ci_036                -1.277857e-02 3 1  ON 35
ci_037                -1.233901e-02 3 1  ON 36
ci_038                 2.143693e-03 3 1  ON 37
ci_039                 1.727885e-03 3 1  ON 38
ci_040                -3.233470e-03 3 1  ON 39
ci_041                 9.598253e-03 3 1  ON 40
ci_042                 8.191506e-03 3 1  ON 41
ci_043                -4.128118e-03 3 1  ON 42
ci_044                -3.871768e-03 3 1  ON 43
ci_045                -3.615848e-03 3 1  ON 44
ci_046                 5.642444e-03 3 1  ON 45
ci_047                 5.510813e-03 3 1  ON 46
ci_048                -1.261423e-02 3 1  ON 47
ci_049                -1.449590e-02 3 1  ON 48
ci_050                 3.127418e-03 3 1  ON 49
ci_051                 2.750321e-03 3 1  ON 50
ci_052                -2.284187e-03 3 1  ON 51
ci_053                -2.437254e-03 3 1  ON 52
ci_054                -3.427397e-03 3 1  ON 53
ci_055                -2.983350e-03 3 1  ON 54
ci_056                 5.601411e-03 3 1  ON 55
ci_057                 5.297729e-03 3 1  ON 56
ci_058                -9.835942e-04 3 1  ON 57
ci_059                -2.298881e-03 3 1  ON 58
ci_060                 4.611013e-03 3 1  ON 59
ci_061                 5.725453e-03 3 1  ON 60
ci_062                -3.734213e-03 3 1  ON 61
ci_063                -4.033232e-03 3 1  ON 62
ci_064                -2.539913e-03 3 1  ON 63
ci_065                -4.364597e-03 3 1  ON 64
ci_066                 4.433444e-03 3 1  ON 65
ci_067                 4.360570e-03 3 1  ON 66
ci_068                -4.160525e-03 3 1  ON 67
ci_069                -5.055559e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1696
    reference variance = 0.158728
====================================================
  Execution time = 1.3646e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8280e-01
  Total weights = 1.9572e+06
  Execution time = 1.8228e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270028171746
                                         uncertainty =       0.001809725587

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270028171746
                                         uncertainty =       0.001809725587

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367928835
  error estimate for blocks of size 2^( 2) =       0.000382040825
  error estimate for blocks of size 2^( 3) =       0.000394443277
  error estimate for blocks of size 2^( 4) =       0.000403499764
  error estimate for blocks of size 2^( 5) =       0.000408599154
  error estimate for blocks of size 2^( 6) =       0.000412397545
  error estimate for blocks of size 2^( 7) =       0.000414921510

      target function =      -0.940194130291
              le_mean =     -17.212328826577
             les_mean =     296.547067611868
             stat err =       0.000409854493
             autocorr =       1.240885615087
   target nu stat err =       0.000409854493
   target dn stat err =       0.002665028159
      target stat err =       0.004494667250
              std dev =       0.520329948670
             le_variance =       0.270743255483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270028071444
                                         uncertainty =       0.001809716998

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270028071444
                                         uncertainty =       0.001809716998

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367928768
  error estimate for blocks of size 2^( 2) =       0.000382040782
  error estimate for blocks of size 2^( 3) =       0.000394443258
  error estimate for blocks of size 2^( 4) =       0.000403499765
  error estimate for blocks of size 2^( 5) =       0.000408599170
  error estimate for blocks of size 2^( 6) =       0.000412397560
  error estimate for blocks of size 2^( 7) =       0.000414921511

      target function =      -0.940194171614
              le_mean =     -17.212328827957
             les_mean =     296.547067634524
             stat err =       0.000409854502
             autocorr =       1.240886116083
   target nu stat err =       0.000409854502
   target dn stat err =       0.002665031593
      target stat err =       0.004494673296
              std dev =       0.520329854324
             le_variance =       0.270743157300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270028121585
                                         uncertainty =       0.001809721292

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270028121585
                                         uncertainty =       0.001809721292

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367928802
  error estimate for blocks of size 2^( 2) =       0.000382040804
  error estimate for blocks of size 2^( 3) =       0.000394443268
  error estimate for blocks of size 2^( 4) =       0.000403499764
  error estimate for blocks of size 2^( 5) =       0.000408599162
  error estimate for blocks of size 2^( 6) =       0.000412397553
  error estimate for blocks of size 2^( 7) =       0.000414921510

      target function =      -0.940194151378
              le_mean =     -17.212328827266
             les_mean =     296.547067622914
             stat err =       0.000409854497
             autocorr =       1.240885865614
   target nu stat err =       0.000409854497
   target dn stat err =       0.002665029875
      target stat err =       0.004494670275
              std dev =       0.520329901487
             le_variance =       0.270743206382

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270028165475
                                         uncertainty =       0.001809725050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270028165475
                                         uncertainty =       0.001809725050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367928831
  error estimate for blocks of size 2^( 2) =       0.000382040822
  error estimate for blocks of size 2^( 3) =       0.000394443276
  error estimate for blocks of size 2^( 4) =       0.000403499764
  error estimate for blocks of size 2^( 5) =       0.000408599155
  error estimate for blocks of size 2^( 6) =       0.000412397546
  error estimate for blocks of size 2^( 7) =       0.000414921510

      target function =      -0.940194132974
              le_mean =     -17.212328826663
             les_mean =     296.547067613218
             stat err =       0.000409854494
             autocorr =       1.240885646403
   target nu stat err =       0.000409854494
   target dn stat err =       0.002665028373
      target stat err =       0.004494667629
              std dev =       0.520329942771
             le_variance =       0.270743249345


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940194130291        initial
     6.2500e+02     6.2500e+03             3.2531e-07        -0.940194171614  <--
     2.5000e+03     2.5000e+04             8.1335e-08        -0.940194151378
     1.0000e+04     1.0000e+05             2.0334e-08        -0.940194132974

*****************************************************************************
Applying the update for shift_i =   6.2500e+02     and shift_s =   6.2500e+03
*****************************************************************************

  Execution time = 2.3017e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
ci_001                -4.192988e-02 3 1  ON 0
ci_002                -3.211186e-02 3 1  ON 1
ci_003                -2.649440e-02 3 1  ON 2
ci_004                 2.373805e-02 3 1  ON 3
ci_005                 2.415199e-02 3 1  ON 4
ci_006                -2.148372e-02 3 1  ON 5
ci_007                -2.110463e-02 3 1  ON 6
ci_008                -8.490321e-03 3 1  ON 7
ci_009                -1.372748e-02 3 1  ON 8
ci_010                -1.010444e-02 3 1  ON 9
ci_011                -1.138927e-02 3 1  ON 10
ci_012                -9.741344e-03 3 1  ON 11
ci_013                -1.985883e-02 3 1  ON 12
ci_014                 1.226877e-02 3 1  ON 13
ci_015                 1.189528e-02 3 1  ON 14
ci_016                 1.756034e-02 3 1  ON 15
ci_017                 1.637412e-02 3 1  ON 16
ci_018                 1.025551e-02 3 1  ON 17
ci_019                 1.007071e-02 3 1  ON 18
ci_020                 1.792993e-02 3 1  ON 19
ci_021                 1.751931e-02 3 1  ON 20
ci_022                 9.161095e-03 3 1  ON 21
ci_023                 9.150312e-03 3 1  ON 22
ci_024                 9.625133e-03 3 1  ON 23
ci_025                 1.025682e-02 3 1  ON 24
ci_026                 1.170196e-02 3 1  ON 25
ci_027                 1.178268e-02 3 1  ON 26
ci_028                -1.469179e-02 3 1  ON 27
ci_029                -1.657505e-02 3 1  ON 28
ci_030                -9.579005e-03 3 1  ON 29
ci_031                -8.975026e-03 3 1  ON 30
ci_032                -1.470221e-02 3 1  ON 31
ci_033                 5.177072e-03 3 1  ON 32
ci_034                 5.619275e-03 3 1  ON 33
ci_035                -5.096291e-03 3 1  ON 34
ci_036                -1.277847e-02 3 1  ON 35
ci_037                -1.233914e-02 3 1  ON 36
ci_038                 2.143655e-03 3 1  ON 37
ci_039                 1.727971e-03 3 1  ON 38
ci_040                -3.233353e-03 3 1  ON 39
ci_041                 9.598015e-03 3 1  ON 40
ci_042                 8.191676e-03 3 1  ON 41
ci_043                -4.128138e-03 3 1  ON 42
ci_044                -3.871727e-03 3 1  ON 43
ci_045                -3.615832e-03 3 1  ON 44
ci_046                 5.642402e-03 3 1  ON 45
ci_047                 5.510839e-03 3 1  ON 46
ci_048                -1.261424e-02 3 1  ON 47
ci_049                -1.449577e-02 3 1  ON 48
ci_050                 3.127350e-03 3 1  ON 49
ci_051                 2.750306e-03 3 1  ON 50
ci_052                -2.284167e-03 3 1  ON 51
ci_053                -2.437231e-03 3 1  ON 52
ci_054                -3.427327e-03 3 1  ON 53
ci_055                -2.983296e-03 3 1  ON 54
ci_056                 5.601461e-03 3 1  ON 55
ci_057                 5.297714e-03 3 1  ON 56
ci_058                -9.836270e-04 3 1  ON 57
ci_059                -2.298656e-03 3 1  ON 58
ci_060                 4.611097e-03 3 1  ON 59
ci_061                 5.725395e-03 3 1  ON 60
ci_062                -3.734230e-03 3 1  ON 61
ci_063                -4.033164e-03 3 1  ON 62
ci_064                -2.539987e-03 3 1  ON 63
ci_065                -4.364615e-03 3 1  ON 64
ci_066                 4.433509e-03 3 1  ON 65
ci_067                 4.360552e-03 3 1  ON 66
ci_068                -4.160707e-03 3 1  ON 67
ci_069                -5.055453e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9549e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2309
    reference variance = 0.177951
====================================================
  Execution time = 1.3986e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7307e-01
  Total weights = 1.957278978e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5017e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.263769046982
                                         uncertainty =       0.001086222945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.263769046982
                                         uncertainty =       0.001086222945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363146651
  error estimate for blocks of size 2^( 2) =       0.000377171756
  error estimate for blocks of size 2^( 3) =       0.000390000029
  error estimate for blocks of size 2^( 4) =       0.000399496122
  error estimate for blocks of size 2^( 5) =       0.000406028316
  error estimate for blocks of size 2^( 6) =       0.000410305545
  error estimate for blocks of size 2^( 7) =       0.000412146154

      target function =      -0.956677144739
              le_mean =     -17.212104813406
             les_mean =     296.529626512795
             stat err =       0.000406994034
             autocorr =       1.256064667828
   target nu stat err =       0.000406994034
   target dn stat err =       0.001729892285
      target stat err =       0.003068594933
              std dev =       0.513566919342
             le_variance =       0.263750980643


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721210481341e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.956685982639       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.956686316961       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.956686356134       residual = 4.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.956686373485       residual = 6.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.956686376437       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.956686377458       residual = 3.90e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.956686377973       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.956686378046       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.956686378091       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.956686378092       residual = 7.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+02 is 1.033010e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.956685982639       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.956686066252       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.956686076048       residual = 4.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.956686080387       residual = 6.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.956686081125       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.956686081380       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.956686081509       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.956686081527       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.956686081539       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.956686081539       residual = 7.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+02 is 2.583530e-07

solving harmonic davidson linear method for identity shift 2.5000e+03, overlap shift 2.5000e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.956685982639       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.956686003544       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.956686005993       residual = 4.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.956686007078       residual = 6.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.956686007264       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.956686007328       residual = 3.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.956686007360       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.956686007364       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.956686007367       residual = 2.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.956686007364       residual = 7.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.5000e+03 is 6.459455e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.069777 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6496e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_001                -4.192991e-02 3 1  ON 0
ci_002                -3.211177e-02 3 1  ON 1
ci_003                -2.649418e-02 3 1  ON 2
ci_004                 2.373808e-02 3 1  ON 3
ci_005                 2.415198e-02 3 1  ON 4
ci_006                -2.148358e-02 3 1  ON 5
ci_007                -2.110457e-02 3 1  ON 6
ci_008                -8.490264e-03 3 1  ON 7
ci_009                -1.372762e-02 3 1  ON 8
ci_010                -1.010451e-02 3 1  ON 9
ci_011                -1.138939e-02 3 1  ON 10
ci_012                -9.741425e-03 3 1  ON 11
ci_013                -1.985868e-02 3 1  ON 12
ci_014                 1.226894e-02 3 1  ON 13
ci_015                 1.189531e-02 3 1  ON 14
ci_016                 1.756024e-02 3 1  ON 15
ci_017                 1.637406e-02 3 1  ON 16
ci_018                 1.025554e-02 3 1  ON 17
ci_019                 1.007072e-02 3 1  ON 18
ci_020                 1.792989e-02 3 1  ON 19
ci_021                 1.751922e-02 3 1  ON 20
ci_022                 9.161080e-03 3 1  ON 21
ci_023                 9.150313e-03 3 1  ON 22
ci_024                 9.625054e-03 3 1  ON 23
ci_025                 1.025670e-02 3 1  ON 24
ci_026                 1.170192e-02 3 1  ON 25
ci_027                 1.178242e-02 3 1  ON 26
ci_028                -1.469183e-02 3 1  ON 27
ci_029                -1.657497e-02 3 1  ON 28
ci_030                -9.578842e-03 3 1  ON 29
ci_031                -8.974963e-03 3 1  ON 30
ci_032                -1.470225e-02 3 1  ON 31
ci_033                 5.177222e-03 3 1  ON 32
ci_034                 5.619378e-03 3 1  ON 33
ci_035                -5.096234e-03 3 1  ON 34
ci_036                -1.277830e-02 3 1  ON 35
ci_037                -1.233916e-02 3 1  ON 36
ci_038                 2.143557e-03 3 1  ON 37
ci_039                 1.727882e-03 3 1  ON 38
ci_040                -3.233323e-03 3 1  ON 39
ci_041                 9.597893e-03 3 1  ON 40
ci_042                 8.191804e-03 3 1  ON 41
ci_043                -4.128104e-03 3 1  ON 42
ci_044                -3.871656e-03 3 1  ON 43
ci_045                -3.615766e-03 3 1  ON 44
ci_046                 5.642423e-03 3 1  ON 45
ci_047                 5.510860e-03 3 1  ON 46
ci_048                -1.261432e-02 3 1  ON 47
ci_049                -1.449562e-02 3 1  ON 48
ci_050                 3.127356e-03 3 1  ON 49
ci_051                 2.750302e-03 3 1  ON 50
ci_052                -2.284215e-03 3 1  ON 51
ci_053                -2.437223e-03 3 1  ON 52
ci_054                -3.427174e-03 3 1  ON 53
ci_055                -2.983328e-03 3 1  ON 54
ci_056                 5.601444e-03 3 1  ON 55
ci_057                 5.297640e-03 3 1  ON 56
ci_058                -9.836541e-04 3 1  ON 57
ci_059                -2.298681e-03 3 1  ON 58
ci_060                 4.611138e-03 3 1  ON 59
ci_061                 5.725378e-03 3 1  ON 60
ci_062                -3.734265e-03 3 1  ON 61
ci_063                -4.033144e-03 3 1  ON 62
ci_064                -2.540008e-03 3 1  ON 63
ci_065                -4.364636e-03 3 1  ON 64
ci_066                 4.433553e-03 3 1  ON 65
ci_067                 4.360611e-03 3 1  ON 66
ci_068                -4.160833e-03 3 1  ON 67
ci_069                -5.055455e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2499
    reference variance = 0.189135
====================================================
  Execution time = 1.3838e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8252e-01
  Total weights = 1.9573e+06
  Execution time = 1.8249e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270610710379
                                         uncertainty =       0.001584019246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270610710379
                                         uncertainty =       0.001584019246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367832193
  error estimate for blocks of size 2^( 2) =       0.000381536309
  error estimate for blocks of size 2^( 3) =       0.000393959108
  error estimate for blocks of size 2^( 4) =       0.000403907437
  error estimate for blocks of size 2^( 5) =       0.000408603448
  error estimate for blocks of size 2^( 6) =       0.000411407476
  error estimate for blocks of size 2^( 7) =       0.000414122683

      target function =      -0.940667245972
              le_mean =     -17.211883797354
             les_mean =     296.531466195326
             stat err =       0.000409510261
             autocorr =       1.239453117783
   target nu stat err =       0.000409510261
   target dn stat err =       0.002396626447
      target stat err =       0.004054928248
              std dev =       0.520193276059
             le_variance =       0.270601044457

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270610487463
                                         uncertainty =       0.001584022962

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270610487463
                                         uncertainty =       0.001584022962

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367832042
  error estimate for blocks of size 2^( 2) =       0.000381536152
  error estimate for blocks of size 2^( 3) =       0.000393958960
  error estimate for blocks of size 2^( 4) =       0.000403907309
  error estimate for blocks of size 2^( 5) =       0.000408603361
  error estimate for blocks of size 2^( 6) =       0.000411407386
  error estimate for blocks of size 2^( 7) =       0.000414122548

      target function =      -0.940667968518
              le_mean =     -17.211883795188
             les_mean =     296.531465686904
             stat err =       0.000409510151
             autocorr =       1.239453469106
   target nu stat err =       0.000409510151
   target dn stat err =       0.002396603414
      target stat err =       0.004054896598
              std dev =       0.520193062101
             le_variance =       0.270600821858

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270610598834
                                         uncertainty =       0.001584021104

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270610598834
                                         uncertainty =       0.001584021104

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367832117
  error estimate for blocks of size 2^( 2) =       0.000381536231
  error estimate for blocks of size 2^( 3) =       0.000393959034
  error estimate for blocks of size 2^( 4) =       0.000403907373
  error estimate for blocks of size 2^( 5) =       0.000408603405
  error estimate for blocks of size 2^( 6) =       0.000411407431
  error estimate for blocks of size 2^( 7) =       0.000414122615

      target function =      -0.940667608701
              le_mean =     -17.211883796265
             les_mean =     296.531465940034
             stat err =       0.000409510206
             autocorr =       1.239453293525
   target nu stat err =       0.000409510206
   target dn stat err =       0.002396614910
      target stat err =       0.004054912402
              std dev =       0.520193168997
             le_variance =       0.270600933071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270610696430
                                         uncertainty =       0.001584019478

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270610696430
                                         uncertainty =       0.001584019478

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367832184
  error estimate for blocks of size 2^( 2) =       0.000381536300
  error estimate for blocks of size 2^( 3) =       0.000393959099
  error estimate for blocks of size 2^( 4) =       0.000403907429
  error estimate for blocks of size 2^( 5) =       0.000408603443
  error estimate for blocks of size 2^( 6) =       0.000411407470
  error estimate for blocks of size 2^( 7) =       0.000414122675

      target function =      -0.940667291464
              le_mean =     -17.211883797217
             les_mean =     296.531466163302
             stat err =       0.000409510254
             autocorr =       1.239453139749
   target nu stat err =       0.000409510254
   target dn stat err =       0.002396625003
      target stat err =       0.004054926265
              std dev =       0.520193262670
             le_variance =       0.270601030527


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940667245972        initial
     1.5625e+02     1.5625e+03             1.0330e-06        -0.940667968518  <--
     6.2500e+02     6.2500e+03             2.5835e-07        -0.940667608701
     2.5000e+03     2.5000e+04             6.4595e-08        -0.940667291464

*****************************************************************************
Applying the update for shift_i =   1.5625e+02     and shift_s =   1.5625e+03
*****************************************************************************

  Execution time = 2.3216e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
ci_001                -4.192998e-02 3 1  ON 0
ci_002                -3.211149e-02 3 1  ON 1
ci_003                -2.649351e-02 3 1  ON 2
ci_004                 2.373816e-02 3 1  ON 3
ci_005                 2.415194e-02 3 1  ON 4
ci_006                -2.148315e-02 3 1  ON 5
ci_007                -2.110438e-02 3 1  ON 6
ci_008                -8.490091e-03 3 1  ON 7
ci_009                -1.372803e-02 3 1  ON 8
ci_010                -1.010472e-02 3 1  ON 9
ci_011                -1.138973e-02 3 1  ON 10
ci_012                -9.741668e-03 3 1  ON 11
ci_013                -1.985824e-02 3 1  ON 12
ci_014                 1.226945e-02 3 1  ON 13
ci_015                 1.189539e-02 3 1  ON 14
ci_016                 1.755992e-02 3 1  ON 15
ci_017                 1.637390e-02 3 1  ON 16
ci_018                 1.025562e-02 3 1  ON 17
ci_019                 1.007073e-02 3 1  ON 18
ci_020                 1.792978e-02 3 1  ON 19
ci_021                 1.751892e-02 3 1  ON 20
ci_022                 9.161034e-03 3 1  ON 21
ci_023                 9.150315e-03 3 1  ON 22
ci_024                 9.624818e-03 3 1  ON 23
ci_025                 1.025634e-02 3 1  ON 24
ci_026                 1.170179e-02 3 1  ON 25
ci_027                 1.178165e-02 3 1  ON 26
ci_028                -1.469193e-02 3 1  ON 27
ci_029                -1.657476e-02 3 1  ON 28
ci_030                -9.578350e-03 3 1  ON 29
ci_031                -8.974776e-03 3 1  ON 30
ci_032                -1.470236e-02 3 1  ON 31
ci_033                 5.177673e-03 3 1  ON 32
ci_034                 5.619685e-03 3 1  ON 33
ci_035                -5.096062e-03 3 1  ON 34
ci_036                -1.277778e-02 3 1  ON 35
ci_037                -1.233920e-02 3 1  ON 36
ci_038                 2.143262e-03 3 1  ON 37
ci_039                 1.727616e-03 3 1  ON 38
ci_040                -3.233234e-03 3 1  ON 39
ci_041                 9.597527e-03 3 1  ON 40
ci_042                 8.192186e-03 3 1  ON 41
ci_043                -4.128001e-03 3 1  ON 42
ci_044                -3.871441e-03 3 1  ON 43
ci_045                -3.615565e-03 3 1  ON 44
ci_046                 5.642485e-03 3 1  ON 45
ci_047                 5.510924e-03 3 1  ON 46
ci_048                -1.261458e-02 3 1  ON 47
ci_049                -1.449517e-02 3 1  ON 48
ci_050                 3.127374e-03 3 1  ON 49
ci_051                 2.750288e-03 3 1  ON 50
ci_052                -2.284359e-03 3 1  ON 51
ci_053                -2.437201e-03 3 1  ON 52
ci_054                -3.426715e-03 3 1  ON 53
ci_055                -2.983423e-03 3 1  ON 54
ci_056                 5.601394e-03 3 1  ON 55
ci_057                 5.297417e-03 3 1  ON 56
ci_058                -9.837353e-04 3 1  ON 57
ci_059                -2.298754e-03 3 1  ON 58
ci_060                 4.611261e-03 3 1  ON 59
ci_061                 5.725327e-03 3 1  ON 60
ci_062                -3.734370e-03 3 1  ON 61
ci_063                -4.033086e-03 3 1  ON 62
ci_064                -2.540070e-03 3 1  ON 63
ci_065                -4.364700e-03 3 1  ON 64
ci_066                 4.433684e-03 3 1  ON 65
ci_067                 4.360790e-03 3 1  ON 66
ci_068                -4.161210e-03 3 1  ON 67
ci_069                -5.055461e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9718e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2343
    reference variance = 0.278067
====================================================
  Execution time = 1.4333e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5261e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8456e-01
  Total weights = 1.957303228e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4915e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269818571291
                                         uncertainty =       0.001965784555

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269818571291
                                         uncertainty =       0.001965784555

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367309010
  error estimate for blocks of size 2^( 2) =       0.000381115846
  error estimate for blocks of size 2^( 3) =       0.000393246347
  error estimate for blocks of size 2^( 4) =       0.000402307498
  error estimate for blocks of size 2^( 5) =       0.000407730857
  error estimate for blocks of size 2^( 6) =       0.000410588044
  error estimate for blocks of size 2^( 7) =       0.000412226031

      target function =      -0.937274343410
              le_mean =     -17.211771816031
             les_mean =     296.529647454224
             stat err =       0.000408213107
             autocorr =       1.235124474748
   target nu stat err =       0.000408213107
   target dn stat err =       0.003378151149
      target stat err =       0.005628204778
              std dev =       0.519453383666
             le_variance =       0.269831817802


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721177181603e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937307023432       residual = 2.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937309240474       residual = 2.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937309570145       residual = 7.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937309668845       residual = 9.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937309683017       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937309685995       residual = 3.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937309687511       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937309687821       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937309687952       residual = 2.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937309687775       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 5.011252e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937307023432       residual = 2.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937307578556       residual = 2.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937307661072       residual = 7.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937307685764       residual = 9.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937307689309       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937307690053       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937307690432       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937307690509       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937307690542       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937307690498       residual = 4.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+02 is 1.254414e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937307023432       residual = 2.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937307162267       residual = 2.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937307182902       residual = 7.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937307189076       residual = 9.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937307189963       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937307190148       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937307190243       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937307190261       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937307190271       residual = 2.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937307190259       residual = 4.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+02 is 3.137039e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.073213 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6838e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_001                -4.192956e-02 3 1  ON 0
ci_002                -3.211079e-02 3 1  ON 1
ci_003                -2.649309e-02 3 1  ON 2
ci_004                 2.373760e-02 3 1  ON 3
ci_005                 2.415161e-02 3 1  ON 4
ci_006                -2.148276e-02 3 1  ON 5
ci_007                -2.110392e-02 3 1  ON 6
ci_008                -8.490022e-03 3 1  ON 7
ci_009                -1.372862e-02 3 1  ON 8
ci_010                -1.010387e-02 3 1  ON 9
ci_011                -1.138879e-02 3 1  ON 10
ci_012                -9.741365e-03 3 1  ON 11
ci_013                -1.985797e-02 3 1  ON 12
ci_014                 1.226951e-02 3 1  ON 13
ci_015                 1.189548e-02 3 1  ON 14
ci_016                 1.755946e-02 3 1  ON 15
ci_017                 1.637390e-02 3 1  ON 16
ci_018                 1.025579e-02 3 1  ON 17
ci_019                 1.007118e-02 3 1  ON 18
ci_020                 1.792923e-02 3 1  ON 19
ci_021                 1.751767e-02 3 1  ON 20
ci_022                 9.160260e-03 3 1  ON 21
ci_023                 9.150220e-03 3 1  ON 22
ci_024                 9.624234e-03 3 1  ON 23
ci_025                 1.025650e-02 3 1  ON 24
ci_026                 1.170204e-02 3 1  ON 25
ci_027                 1.178104e-02 3 1  ON 26
ci_028                -1.469210e-02 3 1  ON 27
ci_029                -1.657469e-02 3 1  ON 28
ci_030                -9.577882e-03 3 1  ON 29
ci_031                -8.973771e-03 3 1  ON 30
ci_032                -1.470215e-02 3 1  ON 31
ci_033                 5.178658e-03 3 1  ON 32
ci_034                 5.619480e-03 3 1  ON 33
ci_035                -5.095998e-03 3 1  ON 34
ci_036                -1.277823e-02 3 1  ON 35
ci_037                -1.233919e-02 3 1  ON 36
ci_038                 2.142908e-03 3 1  ON 37
ci_039                 1.727486e-03 3 1  ON 38
ci_040                -3.233240e-03 3 1  ON 39
ci_041                 9.597465e-03 3 1  ON 40
ci_042                 8.192281e-03 3 1  ON 41
ci_043                -4.128077e-03 3 1  ON 42
ci_044                -3.871199e-03 3 1  ON 43
ci_045                -3.615393e-03 3 1  ON 44
ci_046                 5.642683e-03 3 1  ON 45
ci_047                 5.511166e-03 3 1  ON 46
ci_048                -1.261456e-02 3 1  ON 47
ci_049                -1.449486e-02 3 1  ON 48
ci_050                 3.127229e-03 3 1  ON 49
ci_051                 2.750994e-03 3 1  ON 50
ci_052                -2.284797e-03 3 1  ON 51
ci_053                -2.436525e-03 3 1  ON 52
ci_054                -3.426688e-03 3 1  ON 53
ci_055                -2.983485e-03 3 1  ON 54
ci_056                 5.601170e-03 3 1  ON 55
ci_057                 5.297544e-03 3 1  ON 56
ci_058                -9.846669e-04 3 1  ON 57
ci_059                -2.298501e-03 3 1  ON 58
ci_060                 4.611614e-03 3 1  ON 59
ci_061                 5.724897e-03 3 1  ON 60
ci_062                -3.734284e-03 3 1  ON 61
ci_063                -4.032889e-03 3 1  ON 62
ci_064                -2.540418e-03 3 1  ON 63
ci_065                -4.364663e-03 3 1  ON 64
ci_066                 4.433924e-03 3 1  ON 65
ci_067                 4.361072e-03 3 1  ON 66
ci_068                -4.161293e-03 3 1  ON 67
ci_069                -5.055941e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.3086
    reference variance = 0.140192
====================================================
  Execution time = 1.3700e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8177e-01
  Total weights = 1.9572e+06
  Execution time = 1.8228e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266044263214
                                         uncertainty =       0.001287399675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266044263214
                                         uncertainty =       0.001287399675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364702936
  error estimate for blocks of size 2^( 2) =       0.000378547077
  error estimate for blocks of size 2^( 3) =       0.000391030286
  error estimate for blocks of size 2^( 4) =       0.000400351629
  error estimate for blocks of size 2^( 5) =       0.000405561614
  error estimate for blocks of size 2^( 6) =       0.000410071269
  error estimate for blocks of size 2^( 7) =       0.000411482716

      target function =      -0.941897755959
              le_mean =     -17.212219305450
             les_mean =     296.542271358399
             stat err =       0.000406866807
             autocorr =       1.244589123429
   target nu stat err =       0.000406866807
   target dn stat err =       0.003064037292
      target stat err =       0.005167920757
              std dev =       0.515767838857
             le_variance =       0.266016463599

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266042435584
                                         uncertainty =       0.001287314231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266042435584
                                         uncertainty =       0.001287314231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364701681
  error estimate for blocks of size 2^( 2) =       0.000378546047
  error estimate for blocks of size 2^( 3) =       0.000391029474
  error estimate for blocks of size 2^( 4) =       0.000400351035
  error estimate for blocks of size 2^( 5) =       0.000405561100
  error estimate for blocks of size 2^( 6) =       0.000410070798
  error estimate for blocks of size 2^( 7) =       0.000411482056

      target function =      -0.941924542745
              le_mean =     -17.212219268761
             les_mean =     296.542254114119
             stat err =       0.000406866247
             autocorr =       1.244594263919
   target nu stat err =       0.000406866247
   target dn stat err =       0.003058693937
      target stat err =       0.005159373791
              std dev =       0.515766063972
             le_variance =       0.266014632745

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266043346911
                                         uncertainty =       0.001287356832

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266043346911
                                         uncertainty =       0.001287356832

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364702307
  error estimate for blocks of size 2^( 2) =       0.000378546560
  error estimate for blocks of size 2^( 3) =       0.000391029878
  error estimate for blocks of size 2^( 4) =       0.000400351331
  error estimate for blocks of size 2^( 5) =       0.000405561355
  error estimate for blocks of size 2^( 6) =       0.000410071032
  error estimate for blocks of size 2^( 7) =       0.000411482384

      target function =      -0.941911256045
              le_mean =     -17.212219286942
             les_mean =     296.542262666776
             stat err =       0.000406866526
             autocorr =       1.244591697201
   target nu stat err =       0.000406866526
   target dn stat err =       0.003061353888
      target stat err =       0.005163629123
              std dev =       0.515766949002
             le_variance =       0.266015545683

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266044148504
                                         uncertainty =       0.001287394311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266044148504
                                         uncertainty =       0.001287394311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364702858
  error estimate for blocks of size 2^( 2) =       0.000378547012
  error estimate for blocks of size 2^( 3) =       0.000391030235
  error estimate for blocks of size 2^( 4) =       0.000400351592
  error estimate for blocks of size 2^( 5) =       0.000405561581
  error estimate for blocks of size 2^( 6) =       0.000410071239
  error estimate for blocks of size 2^( 7) =       0.000411482675

      target function =      -0.941899453125
              le_mean =     -17.212219303120
             les_mean =     296.542270265618
             stat err =       0.000406866772
             autocorr =       1.244589445282
   target nu stat err =       0.000406866772
   target dn stat err =       0.003063700871
      target stat err =       0.005167382771
              std dev =       0.515767727458
             le_variance =       0.266016348688


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.941897755959        initial
     3.9062e+01     3.9062e+02             5.0113e-06        -0.941924542745  <--
     1.5625e+02     1.5625e+03             1.2544e-06        -0.941911256045
     6.2500e+02     6.2500e+03             3.1370e-07        -0.941899453125

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 2.3061e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
ci_001                -4.192830e-02 3 1  ON 0
ci_002                -3.210870e-02 3 1  ON 1
ci_003                -2.649182e-02 3 1  ON 2
ci_004                 2.373590e-02 3 1  ON 3
ci_005                 2.415061e-02 3 1  ON 4
ci_006                -2.148159e-02 3 1  ON 5
ci_007                -2.110255e-02 3 1  ON 6
ci_008                -8.489817e-03 3 1  ON 7
ci_009                -1.373037e-02 3 1  ON 8
ci_010                -1.010132e-02 3 1  ON 9
ci_011                -1.138597e-02 3 1  ON 10
ci_012                -9.740458e-03 3 1  ON 11
ci_013                -1.985718e-02 3 1  ON 12
ci_014                 1.226968e-02 3 1  ON 13
ci_015                 1.189576e-02 3 1  ON 14
ci_016                 1.755806e-02 3 1  ON 15
ci_017                 1.637390e-02 3 1  ON 16
ci_018                 1.025628e-02 3 1  ON 17
ci_019                 1.007252e-02 3 1  ON 18
ci_020                 1.792760e-02 3 1  ON 19
ci_021                 1.751391e-02 3 1  ON 20
ci_022                 9.157943e-03 3 1  ON 21
ci_023                 9.149934e-03 3 1  ON 22
ci_024                 9.622484e-03 3 1  ON 23
ci_025                 1.025696e-02 3 1  ON 24
ci_026                 1.170279e-02 3 1  ON 25
ci_027                 1.177924e-02 3 1  ON 26
ci_028                -1.469263e-02 3 1  ON 27
ci_029                -1.657448e-02 3 1  ON 28
ci_030                -9.576478e-03 3 1  ON 29
ci_031                -8.970762e-03 3 1  ON 30
ci_032                -1.470151e-02 3 1  ON 31
ci_033                 5.181604e-03 3 1  ON 32
ci_034                 5.618866e-03 3 1  ON 33
ci_035                -5.095806e-03 3 1  ON 34
ci_036                -1.277960e-02 3 1  ON 35
ci_037                -1.233917e-02 3 1  ON 36
ci_038                 2.141847e-03 3 1  ON 37
ci_039                 1.727099e-03 3 1  ON 38
ci_040                -3.233259e-03 3 1  ON 39
ci_041                 9.597279e-03 3 1  ON 40
ci_042                 8.192566e-03 3 1  ON 41
ci_043                -4.128304e-03 3 1  ON 42
ci_044                -3.870474e-03 3 1  ON 43
ci_045                -3.614879e-03 3 1  ON 44
ci_046                 5.643275e-03 3 1  ON 45
ci_047                 5.511893e-03 3 1  ON 46
ci_048                -1.261453e-02 3 1  ON 47
ci_049                -1.449393e-02 3 1  ON 48
ci_050                 3.126797e-03 3 1  ON 49
ci_051                 2.753107e-03 3 1  ON 50
ci_052                -2.286110e-03 3 1  ON 51
ci_053                -2.434499e-03 3 1  ON 52
ci_054                -3.426608e-03 3 1  ON 53
ci_055                -2.983672e-03 3 1  ON 54
ci_056                 5.600500e-03 3 1  ON 55
ci_057                 5.297924e-03 3 1  ON 56
ci_058                -9.874562e-04 3 1  ON 57
ci_059                -2.297742e-03 3 1  ON 58
ci_060                 4.612670e-03 3 1  ON 59
ci_061                 5.723608e-03 3 1  ON 60
ci_062                -3.734027e-03 3 1  ON 61
ci_063                -4.032298e-03 3 1  ON 62
ci_064                -2.541461e-03 3 1  ON 63
ci_065                -4.364555e-03 3 1  ON 64
ci_066                 4.434641e-03 3 1  ON 65
ci_067                 4.361916e-03 3 1  ON 66
ci_068                -4.161542e-03 3 1  ON 67
ci_069                -5.057378e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9906e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2182
    reference variance = 0.67473
====================================================
  Execution time = 1.4301e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5318e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7676e-01
  Total weights = 1.957323241e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4790e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265268399440
                                         uncertainty =       0.001249446412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265268399440
                                         uncertainty =       0.001249446412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364161249
  error estimate for blocks of size 2^( 2) =       0.000377993975
  error estimate for blocks of size 2^( 3) =       0.000391078215
  error estimate for blocks of size 2^( 4) =       0.000400521473
  error estimate for blocks of size 2^( 5) =       0.000406685245
  error estimate for blocks of size 2^( 6) =       0.000408658385
  error estimate for blocks of size 2^( 7) =       0.000411650239

      target function =      -0.950368933798
              le_mean =     -17.211914370736
             les_mean =     296.526754454409
             stat err =       0.000406878836
             autocorr =       1.248368325876
   target nu stat err =       0.000406878836
   target dn stat err =       0.001850010715
      target stat err =       0.003226790262
              std dev =       0.515001776642
             le_variance =       0.265226829944


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721191437074e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950378887525       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950384520728       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950385637498       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.950385865460       residual = 7.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950385884701       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.950385889903       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.950385894526       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.950385892954       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.950385892829       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.950385893072       residual = 5.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 1.448048e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950378887525       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950380304761       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950380585322       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.950380642471       residual = 7.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950380647293       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.950380648588       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.950380649746       residual = 5.46e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.950380649353       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.950380649321       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.950380649382       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 3.638734e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950378887525       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950379242397       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950379312623       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.950379326920       residual = 7.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950379328126       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.950379328450       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.950379328739       residual = 5.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.950379328641       residual = 1.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.950379328633       residual = 2.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.950379328648       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+02 is 9.108543e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.076731 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6788e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_001                -4.192712e-02 3 1  ON 0
ci_002                -3.210702e-02 3 1  ON 1
ci_003                -2.649161e-02 3 1  ON 2
ci_004                 2.373603e-02 3 1  ON 3
ci_005                 2.414856e-02 3 1  ON 4
ci_006                -2.148093e-02 3 1  ON 5
ci_007                -2.110118e-02 3 1  ON 6
ci_008                -8.489127e-03 3 1  ON 7
ci_009                -1.373197e-02 3 1  ON 8
ci_010                -1.010051e-02 3 1  ON 9
ci_011                -1.138353e-02 3 1  ON 10
ci_012                -9.742577e-03 3 1  ON 11
ci_013                -1.985651e-02 3 1  ON 12
ci_014                 1.227102e-02 3 1  ON 13
ci_015                 1.189764e-02 3 1  ON 14
ci_016                 1.755629e-02 3 1  ON 15
ci_017                 1.637523e-02 3 1  ON 16
ci_018                 1.025637e-02 3 1  ON 17
ci_019                 1.007401e-02 3 1  ON 18
ci_020                 1.792704e-02 3 1  ON 19
ci_021                 1.751098e-02 3 1  ON 20
ci_022                 9.157240e-03 3 1  ON 21
ci_023                 9.148881e-03 3 1  ON 22
ci_024                 9.623214e-03 3 1  ON 23
ci_025                 1.025472e-02 3 1  ON 24
ci_026                 1.170242e-02 3 1  ON 25
ci_027                 1.177821e-02 3 1  ON 26
ci_028                -1.469369e-02 3 1  ON 27
ci_029                -1.657084e-02 3 1  ON 28
ci_030                -9.574302e-03 3 1  ON 29
ci_031                -8.971162e-03 3 1  ON 30
ci_032                -1.469957e-02 3 1  ON 31
ci_033                 5.182734e-03 3 1  ON 32
ci_034                 5.618316e-03 3 1  ON 33
ci_035                -5.095895e-03 3 1  ON 34
ci_036                -1.278035e-02 3 1  ON 35
ci_037                -1.233882e-02 3 1  ON 36
ci_038                 2.141413e-03 3 1  ON 37
ci_039                 1.727541e-03 3 1  ON 38
ci_040                -3.232910e-03 3 1  ON 39
ci_041                 9.595613e-03 3 1  ON 40
ci_042                 8.192612e-03 3 1  ON 41
ci_043                -4.128099e-03 3 1  ON 42
ci_044                -3.870891e-03 3 1  ON 43
ci_045                -3.613818e-03 3 1  ON 44
ci_046                 5.642277e-03 3 1  ON 45
ci_047                 5.511898e-03 3 1  ON 46
ci_048                -1.261557e-02 3 1  ON 47
ci_049                -1.449271e-02 3 1  ON 48
ci_050                 3.125403e-03 3 1  ON 49
ci_051                 2.755979e-03 3 1  ON 50
ci_052                -2.285943e-03 3 1  ON 51
ci_053                -2.434662e-03 3 1  ON 52
ci_054                -3.424798e-03 3 1  ON 53
ci_055                -2.983352e-03 3 1  ON 54
ci_056                 5.599985e-03 3 1  ON 55
ci_057                 5.297037e-03 3 1  ON 56
ci_058                -9.907304e-04 3 1  ON 57
ci_059                -2.298568e-03 3 1  ON 58
ci_060                 4.610058e-03 3 1  ON 59
ci_061                 5.721663e-03 3 1  ON 60
ci_062                -3.733750e-03 3 1  ON 61
ci_063                -4.032678e-03 3 1  ON 62
ci_064                -2.542937e-03 3 1  ON 63
ci_065                -4.364186e-03 3 1  ON 64
ci_066                 4.434570e-03 3 1  ON 65
ci_067                 4.361941e-03 3 1  ON 66
ci_068                -4.162767e-03 3 1  ON 67
ci_069                -5.055673e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2501
    reference variance = 0.140528
====================================================
  Execution time = 1.6233e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7621e-01
  Total weights = 1.9573e+06
  Execution time = 1.8222e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266267019723
                                         uncertainty =       0.001605282425

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266267019723
                                         uncertainty =       0.001605282425

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364879558
  error estimate for blocks of size 2^( 2) =       0.000378882241
  error estimate for blocks of size 2^( 3) =       0.000391778909
  error estimate for blocks of size 2^( 4) =       0.000400150228
  error estimate for blocks of size 2^( 5) =       0.000406564642
  error estimate for blocks of size 2^( 6) =       0.000410125126
  error estimate for blocks of size 2^( 7) =       0.000410701972

      target function =      -0.951030146011
              le_mean =     -17.211190794335
             les_mean =     296.501448950883
             stat err =       0.000406885492
             autocorr =       1.243498725759
   target nu stat err =       0.000406885492
   target dn stat err =       0.001860478648
      target stat err =       0.003244111514
              std dev =       0.516017618946
             le_variance =       0.266274183063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266262080904
                                         uncertainty =       0.001605185188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266262080904
                                         uncertainty =       0.001605185188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364876182
  error estimate for blocks of size 2^( 2) =       0.000378879076
  error estimate for blocks of size 2^( 3) =       0.000391776123
  error estimate for blocks of size 2^( 4) =       0.000400148167
  error estimate for blocks of size 2^( 5) =       0.000406563027
  error estimate for blocks of size 2^( 6) =       0.000410124223
  error estimate for blocks of size 2^( 7) =       0.000410700988

      target function =      -0.951303368830
              le_mean =     -17.211190725053
             les_mean =     296.501285869504
             stat err =       0.000406884101
             autocorr =       1.243513235331
   target nu stat err =       0.000406884101
   target dn stat err =       0.001853930656
      target stat err =       0.003235078089
              std dev =       0.516012844624
             le_variance =       0.266269255817

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266264525778
                                         uncertainty =       0.001605233513

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266264525778
                                         uncertainty =       0.001605233513

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364877853
  error estimate for blocks of size 2^( 2) =       0.000378880642
  error estimate for blocks of size 2^( 3) =       0.000391777502
  error estimate for blocks of size 2^( 4) =       0.000400149185
  error estimate for blocks of size 2^( 5) =       0.000406563822
  error estimate for blocks of size 2^( 6) =       0.000410124664
  error estimate for blocks of size 2^( 7) =       0.000410701472

      target function =      -0.951297824921
              le_mean =     -17.211190758996
             les_mean =     296.501290298737
             stat err =       0.000406884786
             autocorr =       1.243506028065
   target nu stat err =       0.000406884786
   target dn stat err =       0.001854015920
      target stat err =       0.003235183083
              std dev =       0.516015208006
             le_variance =       0.266271694893

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266266706377
                                         uncertainty =       0.001605276298

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266266706377
                                         uncertainty =       0.001605276298

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364879343
  error estimate for blocks of size 2^( 2) =       0.000378882040
  error estimate for blocks of size 2^( 3) =       0.000391778733
  error estimate for blocks of size 2^( 4) =       0.000400150097
  error estimate for blocks of size 2^( 5) =       0.000406564538
  error estimate for blocks of size 2^( 6) =       0.000410125066
  error estimate for blocks of size 2^( 7) =       0.000410701909

      target function =      -0.951267121423
              le_mean =     -17.211190790800
             les_mean =     296.501309451869
             stat err =       0.000406885402
             autocorr =       1.243499637852
   target nu stat err =       0.000406885402
   target dn stat err =       0.001854164679
      target stat err =       0.003235226418
              std dev =       0.516017316023
             le_variance =       0.266273870436


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.951030146011        initial
     9.7656e+00     9.7656e+01             1.4480e-05        -0.951303368830  <--
     3.9062e+01     3.9062e+02             3.6387e-06        -0.951297824921
     1.5625e+02     1.5625e+03             9.1085e-07        -0.951267121423

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 2.5578e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
ci_001                -4.192363e-02 3 1  ON 0
ci_002                -3.210202e-02 3 1  ON 1
ci_003                -2.649096e-02 3 1  ON 2
ci_004                 2.373641e-02 3 1  ON 3
ci_005                 2.414242e-02 3 1  ON 4
ci_006                -2.147898e-02 3 1  ON 5
ci_007                -2.109711e-02 3 1  ON 6
ci_008                -8.487076e-03 3 1  ON 7
ci_009                -1.373673e-02 3 1  ON 8
ci_010                -1.009810e-02 3 1  ON 9
ci_011                -1.137626e-02 3 1  ON 10
ci_012                -9.748889e-03 3 1  ON 11
ci_013                -1.985453e-02 3 1  ON 12
ci_014                 1.227499e-02 3 1  ON 13
ci_015                 1.190322e-02 3 1  ON 14
ci_016                 1.755101e-02 3 1  ON 15
ci_017                 1.637919e-02 3 1  ON 16
ci_018                 1.025664e-02 3 1  ON 17
ci_019                 1.007842e-02 3 1  ON 18
ci_020                 1.792538e-02 3 1  ON 19
ci_021                 1.750226e-02 3 1  ON 20
ci_022                 9.155149e-03 3 1  ON 21
ci_023                 9.145746e-03 3 1  ON 22
ci_024                 9.625390e-03 3 1  ON 23
ci_025                 1.024804e-02 3 1  ON 24
ci_026                 1.170130e-02 3 1  ON 25
ci_027                 1.177515e-02 3 1  ON 26
ci_028                -1.469685e-02 3 1  ON 27
ci_029                -1.656000e-02 3 1  ON 28
ci_030                -9.567826e-03 3 1  ON 29
ci_031                -8.972350e-03 3 1  ON 30
ci_032                -1.469381e-02 3 1  ON 31
ci_033                 5.186097e-03 3 1  ON 32
ci_034                 5.616680e-03 3 1  ON 33
ci_035                -5.096161e-03 3 1  ON 34
ci_036                -1.278256e-02 3 1  ON 35
ci_037                -1.233778e-02 3 1  ON 36
ci_038                 2.140120e-03 3 1  ON 37
ci_039                 1.728854e-03 3 1  ON 38
ci_040                -3.231869e-03 3 1  ON 39
ci_041                 9.590657e-03 3 1  ON 40
ci_042                 8.192744e-03 3 1  ON 41
ci_043                -4.127489e-03 3 1  ON 42
ci_044                -3.872131e-03 3 1  ON 43
ci_045                -3.610658e-03 3 1  ON 44
ci_046                 5.639304e-03 3 1  ON 45
ci_047                 5.511914e-03 3 1  ON 46
ci_048                -1.261865e-02 3 1  ON 47
ci_049                -1.448906e-02 3 1  ON 48
ci_050                 3.121256e-03 3 1  ON 49
ci_051                 2.764520e-03 3 1  ON 50
ci_052                -2.285446e-03 3 1  ON 51
ci_053                -2.435145e-03 3 1  ON 52
ci_054                -3.419412e-03 3 1  ON 53
ci_055                -2.982395e-03 3 1  ON 54
ci_056                 5.598454e-03 3 1  ON 55
ci_057                 5.294398e-03 3 1  ON 56
ci_058                -1.000471e-03 3 1  ON 57
ci_059                -2.301021e-03 3 1  ON 58
ci_060                 4.602280e-03 3 1  ON 59
ci_061                 5.715872e-03 3 1  ON 60
ci_062                -3.732925e-03 3 1  ON 61
ci_063                -4.033806e-03 3 1  ON 62
ci_064                -2.547327e-03 3 1  ON 63
ci_065                -4.363089e-03 3 1  ON 64
ci_066                 4.434357e-03 3 1  ON 65
ci_067                 4.362014e-03 3 1  ON 66
ci_068                -4.166415e-03 3 1  ON 67
ci_069                -5.050593e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2372e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2124
    reference variance = 0.658364
====================================================
  Execution time = 1.4298e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8046e-01
  Total weights = 1.957167523e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4912e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264597586780
                                         uncertainty =       0.001253391050

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264597586780
                                         uncertainty =       0.001253391050

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363739759
  error estimate for blocks of size 2^( 2) =       0.000377587556
  error estimate for blocks of size 2^( 3) =       0.000390139843
  error estimate for blocks of size 2^( 4) =       0.000399567519
  error estimate for blocks of size 2^( 5) =       0.000404720713
  error estimate for blocks of size 2^( 6) =       0.000407076707
  error estimate for blocks of size 2^( 7) =       0.000406715675

      target function =      -0.944093823138
              le_mean =     -17.211636362754
             les_mean =     296.520889933416
             stat err =       0.000404520154
             autocorr =       1.236798007524
   target nu stat err =       0.000404520154
   target dn stat err =       0.003083142607
      target stat err =       0.005217259675
              std dev =       0.514405700616
             le_variance =       0.264613224827


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721163636275e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944121604597       residual = 2.89e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944167433347       residual = 2.32e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944172238209       residual = 8.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944173856880       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944174082085       residual = 2.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944174153471       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944174158717       residual = 8.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944174155237       residual = 2.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944174154883       residual = 2.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944174155874       residual = 6.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 8.168118e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944121604597       residual = 2.89e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944133344982       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944134568462       residual = 7.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944134978947       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944135035357       residual = 2.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944135053156       residual = 4.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944135054439       residual = 8.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944135053574       residual = 2.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944135053480       residual = 2.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944135053728       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 2.094165e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944121604597       residual = 2.89e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944124557942       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944124865235       residual = 7.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944124968224       residual = 1.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944124982332       residual = 2.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944124986779       residual = 4.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944124987097       residual = 8.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944124986882       residual = 2.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944124986858       residual = 2.74e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944124986920       residual = 6.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 5.269037e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.080141 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6798e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_001                -4.191554e-02 3 1  ON 0
ci_002                -3.210259e-02 3 1  ON 1
ci_003                -2.647332e-02 3 1  ON 2
ci_004                 2.374456e-02 3 1  ON 3
ci_005                 2.413242e-02 3 1  ON 4
ci_006                -2.147262e-02 3 1  ON 5
ci_007                -2.109291e-02 3 1  ON 6
ci_008                -8.495731e-03 3 1  ON 7
ci_009                -1.373991e-02 3 1  ON 8
ci_010                -1.009363e-02 3 1  ON 9
ci_011                -1.136061e-02 3 1  ON 10
ci_012                -9.746850e-03 3 1  ON 11
ci_013                -1.986194e-02 3 1  ON 12
ci_014                 1.227762e-02 3 1  ON 13
ci_015                 1.188992e-02 3 1  ON 14
ci_016                 1.754466e-02 3 1  ON 15
ci_017                 1.638311e-02 3 1  ON 16
ci_018                 1.025964e-02 3 1  ON 17
ci_019                 1.008088e-02 3 1  ON 18
ci_020                 1.790691e-02 3 1  ON 19
ci_021                 1.749738e-02 3 1  ON 20
ci_022                 9.161347e-03 3 1  ON 21
ci_023                 9.143518e-03 3 1  ON 22
ci_024                 9.631383e-03 3 1  ON 23
ci_025                 1.023450e-02 3 1  ON 24
ci_026                 1.169335e-02 3 1  ON 25
ci_027                 1.176550e-02 3 1  ON 26
ci_028                -1.470776e-02 3 1  ON 27
ci_029                -1.655048e-02 3 1  ON 28
ci_030                -9.568520e-03 3 1  ON 29
ci_031                -8.980986e-03 3 1  ON 30
ci_032                -1.469516e-02 3 1  ON 31
ci_033                 5.186574e-03 3 1  ON 32
ci_034                 5.610079e-03 3 1  ON 33
ci_035                -5.096420e-03 3 1  ON 34
ci_036                -1.278937e-02 3 1  ON 35
ci_037                -1.233432e-02 3 1  ON 36
ci_038                 2.134951e-03 3 1  ON 37
ci_039                 1.732184e-03 3 1  ON 38
ci_040                -3.228681e-03 3 1  ON 39
ci_041                 9.569715e-03 3 1  ON 40
ci_042                 8.196378e-03 3 1  ON 41
ci_043                -4.124092e-03 3 1  ON 42
ci_044                -3.872952e-03 3 1  ON 43
ci_045                -3.603885e-03 3 1  ON 44
ci_046                 5.641453e-03 3 1  ON 45
ci_047                 5.518178e-03 3 1  ON 46
ci_048                -1.262290e-02 3 1  ON 47
ci_049                -1.447783e-02 3 1  ON 48
ci_050                 3.118460e-03 3 1  ON 49
ci_051                 2.766694e-03 3 1  ON 50
ci_052                -2.297138e-03 3 1  ON 51
ci_053                -2.435649e-03 3 1  ON 52
ci_054                -3.410554e-03 3 1  ON 53
ci_055                -2.980364e-03 3 1  ON 54
ci_056                 5.595589e-03 3 1  ON 55
ci_057                 5.303619e-03 3 1  ON 56
ci_058                -9.917413e-04 3 1  ON 57
ci_059                -2.294726e-03 3 1  ON 58
ci_060                 4.604234e-03 3 1  ON 59
ci_061                 5.721502e-03 3 1  ON 60
ci_062                -3.729271e-03 3 1  ON 61
ci_063                -4.032743e-03 3 1  ON 62
ci_064                -2.553692e-03 3 1  ON 63
ci_065                -4.360708e-03 3 1  ON 64
ci_066                 4.437203e-03 3 1  ON 65
ci_067                 4.359879e-03 3 1  ON 66
ci_068                -4.181964e-03 3 1  ON 67
ci_069                -5.045897e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2389
    reference variance = 0.221386
====================================================
  Execution time = 1.3761e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7709e-01
  Total weights = 1.9575e+06
  Execution time = 1.8342e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267378039975
                                         uncertainty =       0.001670418324

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267378039975
                                         uncertainty =       0.001670418324

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365592741
  error estimate for blocks of size 2^( 2) =       0.000379167308
  error estimate for blocks of size 2^( 3) =       0.000391820146
  error estimate for blocks of size 2^( 4) =       0.000401332149
  error estimate for blocks of size 2^( 5) =       0.000406446821
  error estimate for blocks of size 2^( 6) =       0.000408919437
  error estimate for blocks of size 2^( 7) =       0.000407638505

      target function =      -0.949720834751
              le_mean =     -17.212209102981
             les_mean =     296.537283489385
             stat err =       0.000406084228
             autocorr =       1.233778268692
   target nu stat err =       0.000406084228
   target dn stat err =       0.002054588365
      target stat err =       0.003563271928
              std dev =       0.517026212395
             le_variance =       0.267316104304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267349362516
                                         uncertainty =       0.001669435328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267349362516
                                         uncertainty =       0.001669435328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365572905
  error estimate for blocks of size 2^( 2) =       0.000379149440
  error estimate for blocks of size 2^( 3) =       0.000391805692
  error estimate for blocks of size 2^( 4) =       0.000401319093
  error estimate for blocks of size 2^( 5) =       0.000406436956
  error estimate for blocks of size 2^( 6) =       0.000408911105
  error estimate for blocks of size 2^( 7) =       0.000407626623

      target function =      -0.949791975140
              le_mean =     -17.212209534819
             les_mean =     296.537256462162
             stat err =       0.000406073444
             autocorr =       1.233846629790
   target nu stat err =       0.000406073444
   target dn stat err =       0.002054817892
      target stat err =       0.003564175278
              std dev =       0.516998159632
             le_variance =       0.267287097063

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267363098398
                                         uncertainty =       0.001669911619

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267363098398
                                         uncertainty =       0.001669911619

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365582407
  error estimate for blocks of size 2^( 2) =       0.000379157977
  error estimate for blocks of size 2^( 3) =       0.000391812559
  error estimate for blocks of size 2^( 4) =       0.000401325276
  error estimate for blocks of size 2^( 5) =       0.000406441573
  error estimate for blocks of size 2^( 6) =       0.000408914964
  error estimate for blocks of size 2^( 7) =       0.000407632210

      target function =      -0.949811939956
              le_mean =     -17.212209292385
             les_mean =     296.537236361443
             stat err =       0.000406078506
             autocorr =       1.233813244952
   target nu stat err =       0.000406078506
   target dn stat err =       0.002054245107
      target stat err =       0.003563369874
              std dev =       0.517011598552
             le_variance =       0.267300993038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267376131222
                                         uncertainty =       0.001670354242

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267376131222
                                         uncertainty =       0.001670354242

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365591421
  error estimate for blocks of size 2^( 2) =       0.000379166124
  error estimate for blocks of size 2^( 3) =       0.000391819199
  error estimate for blocks of size 2^( 4) =       0.000401331306
  error estimate for blocks of size 2^( 5) =       0.000406446239
  error estimate for blocks of size 2^( 6) =       0.000408918921
  error estimate for blocks of size 2^( 7) =       0.000407637724

      target function =      -0.946886586823
              le_mean =     -17.212209154308
             les_mean =     296.538954244785
             stat err =       0.000406083548
             autocorr =       1.233783043311
   target nu stat err =       0.000406083548
   target dn stat err =       0.002680902048
      target stat err =       0.004582403980
              std dev =       0.517024345800
             le_variance =       0.267314174149


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949720834751        initial
     2.4414e+00     2.4414e+01             8.1681e-05        -0.949791975140
     9.7656e+00     9.7656e+01             2.0942e-05        -0.949811939956  <--
     3.9062e+01     3.9062e+02             5.2690e-06        -0.946886586823

*****************************************************************************
Applying the update for shift_i =   9.7656e+00     and shift_s =   9.7656e+01
*****************************************************************************

  Execution time = 2.3191e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
ci_001                -4.191554e-02 3 1  ON 0
ci_002                -3.210259e-02 3 1  ON 1
ci_003                -2.647332e-02 3 1  ON 2
ci_004                 2.374456e-02 3 1  ON 3
ci_005                 2.413242e-02 3 1  ON 4
ci_006                -2.147262e-02 3 1  ON 5
ci_007                -2.109291e-02 3 1  ON 6
ci_008                -8.495731e-03 3 1  ON 7
ci_009                -1.373991e-02 3 1  ON 8
ci_010                -1.009363e-02 3 1  ON 9
ci_011                -1.136061e-02 3 1  ON 10
ci_012                -9.746850e-03 3 1  ON 11
ci_013                -1.986194e-02 3 1  ON 12
ci_014                 1.227762e-02 3 1  ON 13
ci_015                 1.188992e-02 3 1  ON 14
ci_016                 1.754466e-02 3 1  ON 15
ci_017                 1.638311e-02 3 1  ON 16
ci_018                 1.025964e-02 3 1  ON 17
ci_019                 1.008088e-02 3 1  ON 18
ci_020                 1.790691e-02 3 1  ON 19
ci_021                 1.749738e-02 3 1  ON 20
ci_022                 9.161347e-03 3 1  ON 21
ci_023                 9.143518e-03 3 1  ON 22
ci_024                 9.631383e-03 3 1  ON 23
ci_025                 1.023450e-02 3 1  ON 24
ci_026                 1.169335e-02 3 1  ON 25
ci_027                 1.176550e-02 3 1  ON 26
ci_028                -1.470776e-02 3 1  ON 27
ci_029                -1.655048e-02 3 1  ON 28
ci_030                -9.568520e-03 3 1  ON 29
ci_031                -8.980986e-03 3 1  ON 30
ci_032                -1.469516e-02 3 1  ON 31
ci_033                 5.186574e-03 3 1  ON 32
ci_034                 5.610079e-03 3 1  ON 33
ci_035                -5.096420e-03 3 1  ON 34
ci_036                -1.278937e-02 3 1  ON 35
ci_037                -1.233432e-02 3 1  ON 36
ci_038                 2.134951e-03 3 1  ON 37
ci_039                 1.732184e-03 3 1  ON 38
ci_040                -3.228681e-03 3 1  ON 39
ci_041                 9.569715e-03 3 1  ON 40
ci_042                 8.196378e-03 3 1  ON 41
ci_043                -4.124092e-03 3 1  ON 42
ci_044                -3.872952e-03 3 1  ON 43
ci_045                -3.603885e-03 3 1  ON 44
ci_046                 5.641453e-03 3 1  ON 45
ci_047                 5.518178e-03 3 1  ON 46
ci_048                -1.262290e-02 3 1  ON 47
ci_049                -1.447783e-02 3 1  ON 48
ci_050                 3.118460e-03 3 1  ON 49
ci_051                 2.766694e-03 3 1  ON 50
ci_052                -2.297138e-03 3 1  ON 51
ci_053                -2.435649e-03 3 1  ON 52
ci_054                -3.410554e-03 3 1  ON 53
ci_055                -2.980364e-03 3 1  ON 54
ci_056                 5.595589e-03 3 1  ON 55
ci_057                 5.303619e-03 3 1  ON 56
ci_058                -9.917413e-04 3 1  ON 57
ci_059                -2.294726e-03 3 1  ON 58
ci_060                 4.604234e-03 3 1  ON 59
ci_061                 5.721502e-03 3 1  ON 60
ci_062                -3.729271e-03 3 1  ON 61
ci_063                -4.032743e-03 3 1  ON 62
ci_064                -2.553692e-03 3 1  ON 63
ci_065                -4.360708e-03 3 1  ON 64
ci_066                 4.437203e-03 3 1  ON 65
ci_067                 4.359879e-03 3 1  ON 66
ci_068                -4.181964e-03 3 1  ON 67
ci_069                -5.045897e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9995e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2527
    reference variance = 0.262559
====================================================
  Execution time = 1.4218e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8139e-01
  Total weights = 1.957305191e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4944e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267593993187
                                         uncertainty =       0.001409754812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267593993187
                                         uncertainty =       0.001409754812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365774450
  error estimate for blocks of size 2^( 2) =       0.000379649733
  error estimate for blocks of size 2^( 3) =       0.000392321703
  error estimate for blocks of size 2^( 4) =       0.000401573826
  error estimate for blocks of size 2^( 5) =       0.000407199200
  error estimate for blocks of size 2^( 6) =       0.000410950884
  error estimate for blocks of size 2^( 7) =       0.000413046162

      target function =      -0.942547610343
              le_mean =     -17.211794087067
             les_mean =     296.527249858387
             stat err =       0.000408192518
             autocorr =       1.245384188781
   target nu stat err =       0.000408192518
   target dn stat err =       0.002466041906
      target stat err =       0.004183998891
              std dev =       0.517283188077
             le_variance =       0.267581896667


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721179408707e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+00, overlap shift 2.4414e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942565177335       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942586963745       residual = 2.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942590802305       residual = 6.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942592177525       residual = 1.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942592308744       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942592367117       residual = 4.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942592368691       residual = 7.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942592382022       residual = 2.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942592379215       residual = 3.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942592381081       residual = 8.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+00 is 6.784365e-05

solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942565177335       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942570758293       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942571735917       residual = 6.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942572083941       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942572116595       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942572131229       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942572131575       residual = 7.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942572134905       residual = 2.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942572134220       residual = 3.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942572134671       residual = 7.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 1.730110e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942565177335       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942566581232       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942566826787       residual = 6.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942566914058       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942566922211       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942566925872       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942566925955       residual = 7.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942566926788       residual = 2.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942566926618       residual = 3.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942566926729       residual = 7.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 4.347079e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.083617 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6722e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_001                -4.191385e-02 3 1  ON 0
ci_002                -3.209936e-02 3 1  ON 1
ci_003                -2.645602e-02 3 1  ON 2
ci_004                 2.374213e-02 3 1  ON 3
ci_005                 2.412979e-02 3 1  ON 4
ci_006                -2.146061e-02 3 1  ON 5
ci_007                -2.108490e-02 3 1  ON 6
ci_008                -8.503955e-03 3 1  ON 7
ci_009                -1.373751e-02 3 1  ON 8
ci_010                -1.008584e-02 3 1  ON 9
ci_011                -1.135292e-02 3 1  ON 10
ci_012                -9.740149e-03 3 1  ON 11
ci_013                -1.985210e-02 3 1  ON 12
ci_014                 1.227547e-02 3 1  ON 13
ci_015                 1.189816e-02 3 1  ON 14
ci_016                 1.753282e-02 3 1  ON 15
ci_017                 1.638254e-02 3 1  ON 16
ci_018                 1.026282e-02 3 1  ON 17
ci_019                 1.008372e-02 3 1  ON 18
ci_020                 1.790149e-02 3 1  ON 19
ci_021                 1.749100e-02 3 1  ON 20
ci_022                 9.167083e-03 3 1  ON 21
ci_023                 9.148262e-03 3 1  ON 22
ci_024                 9.634274e-03 3 1  ON 23
ci_025                 1.022266e-02 3 1  ON 24
ci_026                 1.168629e-02 3 1  ON 25
ci_027                 1.176282e-02 3 1  ON 26
ci_028                -1.471329e-02 3 1  ON 27
ci_029                -1.654337e-02 3 1  ON 28
ci_030                -9.559775e-03 3 1  ON 29
ci_031                -8.981925e-03 3 1  ON 30
ci_032                -1.470012e-02 3 1  ON 31
ci_033                 5.190620e-03 3 1  ON 32
ci_034                 5.603234e-03 3 1  ON 33
ci_035                -5.094494e-03 3 1  ON 34
ci_036                -1.277789e-02 3 1  ON 35
ci_037                -1.233526e-02 3 1  ON 36
ci_038                 2.127978e-03 3 1  ON 37
ci_039                 1.735521e-03 3 1  ON 38
ci_040                -3.224377e-03 3 1  ON 39
ci_041                 9.563812e-03 3 1  ON 40
ci_042                 8.202924e-03 3 1  ON 41
ci_043                -4.122639e-03 3 1  ON 42
ci_044                -3.885043e-03 3 1  ON 43
ci_045                -3.598485e-03 3 1  ON 44
ci_046                 5.639248e-03 3 1  ON 45
ci_047                 5.520966e-03 3 1  ON 46
ci_048                -1.262306e-02 3 1  ON 47
ci_049                -1.447050e-02 3 1  ON 48
ci_050                 3.119162e-03 3 1  ON 49
ci_051                 2.763722e-03 3 1  ON 50
ci_052                -2.298922e-03 3 1  ON 51
ci_053                -2.437295e-03 3 1  ON 52
ci_054                -3.398661e-03 3 1  ON 53
ci_055                -2.975277e-03 3 1  ON 54
ci_056                 5.590667e-03 3 1  ON 55
ci_057                 5.301647e-03 3 1  ON 56
ci_058                -9.897879e-04 3 1  ON 57
ci_059                -2.289726e-03 3 1  ON 58
ci_060                 4.605880e-03 3 1  ON 59
ci_061                 5.712967e-03 3 1  ON 60
ci_062                -3.723782e-03 3 1  ON 61
ci_063                -4.025420e-03 3 1  ON 62
ci_064                -2.556747e-03 3 1  ON 63
ci_065                -4.364890e-03 3 1  ON 64
ci_066                 4.435037e-03 3 1  ON 65
ci_067                 4.358871e-03 3 1  ON 66
ci_068                -4.188645e-03 3 1  ON 67
ci_069                -5.047768e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1998
    reference variance = 0.240428
====================================================
  Execution time = 1.3944e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8487e-01
  Total weights = 1.9570e+06
  Execution time = 1.8272e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271083810786
                                         uncertainty =       0.001906282089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271083810786
                                         uncertainty =       0.001906282089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368157388
  error estimate for blocks of size 2^( 2) =       0.000382224836
  error estimate for blocks of size 2^( 3) =       0.000394810197
  error estimate for blocks of size 2^( 4) =       0.000403731425
  error estimate for blocks of size 2^( 5) =       0.000409662351
  error estimate for blocks of size 2^( 6) =       0.000412138160
  error estimate for blocks of size 2^( 7) =       0.000415038440

      target function =      -0.936753779209
              le_mean =     -17.211732563403
             les_mean =     296.528611008042
             stat err =       0.000410142594
             autocorr =       1.241088372593
   target nu stat err =       0.000410142594
   target dn stat err =       0.003441390635
      target stat err =       0.005725554951
              std dev =       0.520653171858
             le_variance =       0.271079725366

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271062979233
                                         uncertainty =       0.001906319982

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271062979233
                                         uncertainty =       0.001906319982

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368143197
  error estimate for blocks of size 2^( 2) =       0.000382212708
  error estimate for blocks of size 2^( 3) =       0.000394801307
  error estimate for blocks of size 2^( 4) =       0.000403724706
  error estimate for blocks of size 2^( 5) =       0.000409656839
  error estimate for blocks of size 2^( 6) =       0.000412133107
  error estimate for blocks of size 2^( 7) =       0.000415033791

      target function =      -0.936647643064
              le_mean =     -17.211733220736
             les_mean =     296.528697913201
             stat err =       0.000410137111
             autocorr =       1.241150871254
   target nu stat err =       0.000410137111
   target dn stat err =       0.003444757518
      target stat err =       0.005729785296
              std dev =       0.520633102213
             le_variance =       0.271058827120

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271072971743
                                         uncertainty =       0.001906296355

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271072971743
                                         uncertainty =       0.001906296355

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368150005
  error estimate for blocks of size 2^( 2) =       0.000382218504
  error estimate for blocks of size 2^( 3) =       0.000394805507
  error estimate for blocks of size 2^( 4) =       0.000403727841
  error estimate for blocks of size 2^( 5) =       0.000409659372
  error estimate for blocks of size 2^( 6) =       0.000412135392
  error estimate for blocks of size 2^( 7) =       0.000415035864

      target function =      -0.936667155607
              le_mean =     -17.211732882042
             les_mean =     296.528674452960
             stat err =       0.000410139617
             autocorr =       1.241120138241
   target nu stat err =       0.000410139617
   target dn stat err =       0.003442748584
      target stat err =       0.005726730294
              std dev =       0.520642730036
             le_variance =       0.271068852339

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271082427324
                                         uncertainty =       0.001906283463

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271082427324
                                         uncertainty =       0.001906283463

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368156446
  error estimate for blocks of size 2^( 2) =       0.000382224026
  error estimate for blocks of size 2^( 3) =       0.000394809593
  error estimate for blocks of size 2^( 4) =       0.000403730960
  error estimate for blocks of size 2^( 5) =       0.000409661962
  error estimate for blocks of size 2^( 6) =       0.000412137797
  error estimate for blocks of size 2^( 7) =       0.000415038102

      target function =      -0.936758500711
              le_mean =     -17.211732600521
             les_mean =     296.528609423406
             stat err =       0.000410142205
             autocorr =       1.241092372046
   target nu stat err =       0.000410142205
   target dn stat err =       0.003441495401
      target stat err =       0.005725784064
              std dev =       0.520651839182
             le_variance =       0.271078337643


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.936753779209        initial
     2.4414e+00     2.4414e+01             6.7844e-05        -0.936647643064
     9.7656e+00     9.7656e+01             1.7301e-05        -0.936667155607
     3.9062e+01     3.9062e+02             4.3471e-06        -0.936758500711  <--

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 2.3354e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
ci_001                -4.191511e-02 3 1  ON 0
ci_002                -3.210178e-02 3 1  ON 1
ci_003                -2.646897e-02 3 1  ON 2
ci_004                 2.374395e-02 3 1  ON 3
ci_005                 2.413176e-02 3 1  ON 4
ci_006                -2.146961e-02 3 1  ON 5
ci_007                -2.109090e-02 3 1  ON 6
ci_008                -8.497802e-03 3 1  ON 7
ci_009                -1.373931e-02 3 1  ON 8
ci_010                -1.009167e-02 3 1  ON 9
ci_011                -1.135868e-02 3 1  ON 10
ci_012                -9.745165e-03 3 1  ON 11
ci_013                -1.985947e-02 3 1  ON 12
ci_014                 1.227708e-02 3 1  ON 13
ci_015                 1.189199e-02 3 1  ON 14
ci_016                 1.754169e-02 3 1  ON 15
ci_017                 1.638296e-02 3 1  ON 16
ci_018                 1.026044e-02 3 1  ON 17
ci_019                 1.008159e-02 3 1  ON 18
ci_020                 1.790555e-02 3 1  ON 19
ci_021                 1.749578e-02 3 1  ON 20
ci_022                 9.162789e-03 3 1  ON 21
ci_023                 9.144710e-03 3 1  ON 22
ci_024                 9.632111e-03 3 1  ON 23
ci_025                 1.023152e-02 3 1  ON 24
ci_026                 1.169158e-02 3 1  ON 25
ci_027                 1.176483e-02 3 1  ON 26
ci_028                -1.470915e-02 3 1  ON 27
ci_029                -1.654869e-02 3 1  ON 28
ci_030                -9.566320e-03 3 1  ON 29
ci_031                -8.981224e-03 3 1  ON 30
ci_032                -1.469641e-02 3 1  ON 31
ci_033                 5.187591e-03 3 1  ON 32
ci_034                 5.608358e-03 3 1  ON 33
ci_035                -5.095936e-03 3 1  ON 34
ci_036                -1.278649e-02 3 1  ON 35
ci_037                -1.233456e-02 3 1  ON 36
ci_038                 2.133197e-03 3 1  ON 37
ci_039                 1.733023e-03 3 1  ON 38
ci_040                -3.227598e-03 3 1  ON 39
ci_041                 9.568230e-03 3 1  ON 40
ci_042                 8.198025e-03 3 1  ON 41
ci_043                -4.123727e-03 3 1  ON 42
ci_044                -3.875992e-03 3 1  ON 43
ci_045                -3.602527e-03 3 1  ON 44
ci_046                 5.640898e-03 3 1  ON 45
ci_047                 5.518879e-03 3 1  ON 46
ci_048                -1.262294e-02 3 1  ON 47
ci_049                -1.447599e-02 3 1  ON 48
ci_050                 3.118637e-03 3 1  ON 49
ci_051                 2.765946e-03 3 1  ON 50
ci_052                -2.297587e-03 3 1  ON 51
ci_053                -2.436063e-03 3 1  ON 52
ci_054                -3.407563e-03 3 1  ON 53
ci_055                -2.979086e-03 3 1  ON 54
ci_056                 5.594351e-03 3 1  ON 55
ci_057                 5.303123e-03 3 1  ON 56
ci_058                -9.912506e-04 3 1  ON 57
ci_059                -2.293469e-03 3 1  ON 58
ci_060                 4.604648e-03 3 1  ON 59
ci_061                 5.719357e-03 3 1  ON 60
ci_062                -3.727891e-03 3 1  ON 61
ci_063                -4.030903e-03 3 1  ON 62
ci_064                -2.554460e-03 3 1  ON 63
ci_065                -4.361760e-03 3 1  ON 64
ci_066                 4.436659e-03 3 1  ON 65
ci_067                 4.359625e-03 3 1  ON 66
ci_068                -4.183643e-03 3 1  ON 67
ci_069                -5.046367e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0082e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1946
    reference variance = 0.191446
====================================================
  Execution time = 1.4313e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8188e-01
  Total weights = 1.957479066e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4920e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267343578957
                                         uncertainty =       0.001759805561

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267343578957
                                         uncertainty =       0.001759805561

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365646493
  error estimate for blocks of size 2^( 2) =       0.000379524022
  error estimate for blocks of size 2^( 3) =       0.000392003279
  error estimate for blocks of size 2^( 4) =       0.000400835180
  error estimate for blocks of size 2^( 5) =       0.000405091353
  error estimate for blocks of size 2^( 6) =       0.000408408589
  error estimate for blocks of size 2^( 7) =       0.000409944907

      target function =      -0.941724515948
              le_mean =     -17.212180598330
             les_mean =     296.541044188582
             stat err =       0.000406070007
             autocorr =       1.233329165612
   target nu stat err =       0.000406070007
   target dn stat err =       0.002919785022
      target stat err =       0.004927102510
              std dev =       0.517102229267
             le_variance =       0.267394715513


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721218059833e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941749259881       residual = 2.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941757624184       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941758409134       residual = 4.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941758666887       residual = 7.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941758702567       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941758705235       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941758707269       residual = 3.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941758706568       residual = 9.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941758705874       residual = 1.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941758706376       residual = 2.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+00 is 1.947690e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941749259881       residual = 2.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941751364069       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941751561286       residual = 4.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941751625932       residual = 7.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941751634872       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941751635537       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941751636044       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941751635869       residual = 8.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941751635696       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941751635821       residual = 2.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+01 is 4.900606e-06

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941749259881       residual = 2.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941749786754       residual = 1.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941749836120       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941749852295       residual = 7.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941749854531       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941749854697       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941749854824       residual = 3.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941749854780       residual = 8.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941749854736       residual = 1.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941749854768       residual = 2.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+02 is 1.227128e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.087104 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6814e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_001                -4.191305e-02 3 1  ON 0
ci_002                -3.210067e-02 3 1  ON 1
ci_003                -2.646674e-02 3 1  ON 2
ci_004                 2.374456e-02 3 1  ON 3
ci_005                 2.413003e-02 3 1  ON 4
ci_006                -2.146802e-02 3 1  ON 5
ci_007                -2.108929e-02 3 1  ON 6
ci_008                -8.497521e-03 3 1  ON 7
ci_009                -1.373997e-02 3 1  ON 8
ci_010                -1.009202e-02 3 1  ON 9
ci_011                -1.135903e-02 3 1  ON 10
ci_012                -9.746207e-03 3 1  ON 11
ci_013                -1.985923e-02 3 1  ON 12
ci_014                 1.227858e-02 3 1  ON 13
ci_015                 1.189405e-02 3 1  ON 14
ci_016                 1.753989e-02 3 1  ON 15
ci_017                 1.638396e-02 3 1  ON 16
ci_018                 1.026054e-02 3 1  ON 17
ci_019                 1.008649e-02 3 1  ON 18
ci_020                 1.790173e-02 3 1  ON 19
ci_021                 1.749491e-02 3 1  ON 20
ci_022                 9.161495e-03 3 1  ON 21
ci_023                 9.146372e-03 3 1  ON 22
ci_024                 9.632411e-03 3 1  ON 23
ci_025                 1.023108e-02 3 1  ON 24
ci_026                 1.168963e-02 3 1  ON 25
ci_027                 1.176514e-02 3 1  ON 26
ci_028                -1.471036e-02 3 1  ON 27
ci_029                -1.654579e-02 3 1  ON 28
ci_030                -9.566164e-03 3 1  ON 29
ci_031                -8.980144e-03 3 1  ON 30
ci_032                -1.469711e-02 3 1  ON 31
ci_033                 5.189175e-03 3 1  ON 32
ci_034                 5.608414e-03 3 1  ON 33
ci_035                -5.095154e-03 3 1  ON 34
ci_036                -1.278590e-02 3 1  ON 35
ci_037                -1.233433e-02 3 1  ON 36
ci_038                 2.133151e-03 3 1  ON 37
ci_039                 1.733307e-03 3 1  ON 38
ci_040                -3.227561e-03 3 1  ON 39
ci_041                 9.566206e-03 3 1  ON 40
ci_042                 8.200840e-03 3 1  ON 41
ci_043                -4.123357e-03 3 1  ON 42
ci_044                -3.874626e-03 3 1  ON 43
ci_045                -3.600375e-03 3 1  ON 44
ci_046                 5.640223e-03 3 1  ON 45
ci_047                 5.518674e-03 3 1  ON 46
ci_048                -1.262309e-02 3 1  ON 47
ci_049                -1.447453e-02 3 1  ON 48
ci_050                 3.119340e-03 3 1  ON 49
ci_051                 2.768006e-03 3 1  ON 50
ci_052                -2.300344e-03 3 1  ON 51
ci_053                -2.436642e-03 3 1  ON 52
ci_054                -3.406629e-03 3 1  ON 53
ci_055                -2.978479e-03 3 1  ON 54
ci_056                 5.594474e-03 3 1  ON 55
ci_057                 5.302751e-03 3 1  ON 56
ci_058                -9.932203e-04 3 1  ON 57
ci_059                -2.292507e-03 3 1  ON 58
ci_060                 4.608158e-03 3 1  ON 59
ci_061                 5.717565e-03 3 1  ON 60
ci_062                -3.727624e-03 3 1  ON 61
ci_063                -4.030327e-03 3 1  ON 62
ci_064                -2.555356e-03 3 1  ON 63
ci_065                -4.361777e-03 3 1  ON 64
ci_066                 4.436904e-03 3 1  ON 65
ci_067                 4.360517e-03 3 1  ON 66
ci_068                -4.184419e-03 3 1  ON 67
ci_069                -5.047517e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1791
    reference variance = 0.197208
====================================================
  Execution time = 1.3881e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8057e-01
  Total weights = 1.9573e+06
  Execution time = 1.8174e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268522899779
                                         uncertainty =       0.001616449516

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268522899779
                                         uncertainty =       0.001616449516

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366390306
  error estimate for blocks of size 2^( 2) =       0.000380098328
  error estimate for blocks of size 2^( 3) =       0.000392716033
  error estimate for blocks of size 2^( 4) =       0.000402968709
  error estimate for blocks of size 2^( 5) =       0.000408108025
  error estimate for blocks of size 2^( 6) =       0.000411554031
  error estimate for blocks of size 2^( 7) =       0.000414944004

      target function =      -0.943935283488
              le_mean =     -17.212060998444
             les_mean =     296.535610982377
             stat err =       0.000409393692
             autocorr =       1.248516666315
   target nu stat err =       0.000409393692
   target dn stat err =       0.002321204929
      target stat err =       0.003959637999
              std dev =       0.518154140500
             le_variance =       0.268483713318

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268520346477
                                         uncertainty =       0.001616488823

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268520346477
                                         uncertainty =       0.001616488823

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366388549
  error estimate for blocks of size 2^( 2) =       0.000380095900
  error estimate for blocks of size 2^( 3) =       0.000392712884
  error estimate for blocks of size 2^( 4) =       0.000402965329
  error estimate for blocks of size 2^( 5) =       0.000408104528
  error estimate for blocks of size 2^( 6) =       0.000411550155
  error estimate for blocks of size 2^( 7) =       0.000414941017

      target function =      -0.943907289522
              le_mean =     -17.212060988091
             les_mean =     296.535627330048
             stat err =       0.000409390257
             autocorr =       1.248507691056
   target nu stat err =       0.000409390257
   target dn stat err =       0.002320129940
      target stat err =       0.003957634049
              std dev =       0.518151655199
             le_variance =       0.268481137786

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268521602199
                                         uncertainty =       0.001616468984

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268521602199
                                         uncertainty =       0.001616468984

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366389413
  error estimate for blocks of size 2^( 2) =       0.000380097098
  error estimate for blocks of size 2^( 3) =       0.000392714439
  error estimate for blocks of size 2^( 4) =       0.000402966999
  error estimate for blocks of size 2^( 5) =       0.000408106256
  error estimate for blocks of size 2^( 6) =       0.000411552072
  error estimate for blocks of size 2^( 7) =       0.000414942493

      target function =      -0.943923493184
              le_mean =     -17.212060991781
             les_mean =     296.535617789349
             stat err =       0.000409391955
             autocorr =       1.248512155218
   target nu stat err =       0.000409391955
   target dn stat err =       0.002320609898
      target stat err =       0.003958559336
              std dev =       0.518152877587
             le_variance =       0.268482404551

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268522735845
                                         uncertainty =       0.001616451917

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268522735845
                                         uncertainty =       0.001616451917

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366390194
  error estimate for blocks of size 2^( 2) =       0.000380098173
  error estimate for blocks of size 2^( 3) =       0.000392715832
  error estimate for blocks of size 2^( 4) =       0.000402968494
  error estimate for blocks of size 2^( 5) =       0.000408107803
  error estimate for blocks of size 2^( 6) =       0.000411553785
  error estimate for blocks of size 2^( 7) =       0.000414943814

      target function =      -0.943934051547
              le_mean =     -17.212060997448
             les_mean =     296.535611683433
             stat err =       0.000409393474
             autocorr =       1.248516102547
   target nu stat err =       0.000409393474
   target dn stat err =       0.002321124930
      target stat err =       0.003959495892
              std dev =       0.518153980959
             le_variance =       0.268483547984


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943935283488        initial  <--
     9.7656e+00     9.7656e+01             1.9477e-05        -0.943907289522
     3.9062e+01     3.9062e+02             4.9006e-06        -0.943923493184
     1.5625e+02     1.5625e+03             1.2271e-06        -0.943934051547

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 26.5883
  </log>
  <optVariables href="H2O.s020.opt.xml">
ci_001                -4.191511e-02 3 1  ON 0
ci_002                -3.210178e-02 3 1  ON 1
ci_003                -2.646897e-02 3 1  ON 2
ci_004                 2.374395e-02 3 1  ON 3
ci_005                 2.413176e-02 3 1  ON 4
ci_006                -2.146961e-02 3 1  ON 5
ci_007                -2.109090e-02 3 1  ON 6
ci_008                -8.497802e-03 3 1  ON 7
ci_009                -1.373931e-02 3 1  ON 8
ci_010                -1.009167e-02 3 1  ON 9
ci_011                -1.135868e-02 3 1  ON 10
ci_012                -9.745165e-03 3 1  ON 11
ci_013                -1.985947e-02 3 1  ON 12
ci_014                 1.227708e-02 3 1  ON 13
ci_015                 1.189199e-02 3 1  ON 14
ci_016                 1.754169e-02 3 1  ON 15
ci_017                 1.638296e-02 3 1  ON 16
ci_018                 1.026044e-02 3 1  ON 17
ci_019                 1.008159e-02 3 1  ON 18
ci_020                 1.790555e-02 3 1  ON 19
ci_021                 1.749578e-02 3 1  ON 20
ci_022                 9.162789e-03 3 1  ON 21
ci_023                 9.144710e-03 3 1  ON 22
ci_024                 9.632111e-03 3 1  ON 23
ci_025                 1.023152e-02 3 1  ON 24
ci_026                 1.169158e-02 3 1  ON 25
ci_027                 1.176483e-02 3 1  ON 26
ci_028                -1.470915e-02 3 1  ON 27
ci_029                -1.654869e-02 3 1  ON 28
ci_030                -9.566320e-03 3 1  ON 29
ci_031                -8.981224e-03 3 1  ON 30
ci_032                -1.469641e-02 3 1  ON 31
ci_033                 5.187591e-03 3 1  ON 32
ci_034                 5.608358e-03 3 1  ON 33
ci_035                -5.095936e-03 3 1  ON 34
ci_036                -1.278649e-02 3 1  ON 35
ci_037                -1.233456e-02 3 1  ON 36
ci_038                 2.133197e-03 3 1  ON 37
ci_039                 1.733023e-03 3 1  ON 38
ci_040                -3.227598e-03 3 1  ON 39
ci_041                 9.568230e-03 3 1  ON 40
ci_042                 8.198025e-03 3 1  ON 41
ci_043                -4.123727e-03 3 1  ON 42
ci_044                -3.875992e-03 3 1  ON 43
ci_045                -3.602527e-03 3 1  ON 44
ci_046                 5.640898e-03 3 1  ON 45
ci_047                 5.518879e-03 3 1  ON 46
ci_048                -1.262294e-02 3 1  ON 47
ci_049                -1.447599e-02 3 1  ON 48
ci_050                 3.118637e-03 3 1  ON 49
ci_051                 2.765946e-03 3 1  ON 50
ci_052                -2.297587e-03 3 1  ON 51
ci_053                -2.436063e-03 3 1  ON 52
ci_054                -3.407563e-03 3 1  ON 53
ci_055                -2.979086e-03 3 1  ON 54
ci_056                 5.594351e-03 3 1  ON 55
ci_057                 5.303123e-03 3 1  ON 56
ci_058                -9.912506e-04 3 1  ON 57
ci_059                -2.293469e-03 3 1  ON 58
ci_060                 4.604648e-03 3 1  ON 59
ci_061                 5.719357e-03 3 1  ON 60
ci_062                -3.727891e-03 3 1  ON 61
ci_063                -4.030903e-03 3 1  ON 62
ci_064                -2.554460e-03 3 1  ON 63
ci_065                -4.361760e-03 3 1  ON 64
ci_066                 4.436659e-03 3 1  ON 65
ci_067                 4.359625e-03 3 1  ON 66
ci_068                -4.183643e-03 3 1  ON 67
ci_069                -5.046367e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3408e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7219e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2677
    reference variance = 0.278992
====================================================
  Execution time = 1.4194e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5264e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8006e-01
  Total weights = 1.957375033e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4777e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267904399477
                                         uncertainty =       0.001726020120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267904399477
                                         uncertainty =       0.001726020120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366016642
  error estimate for blocks of size 2^( 2) =       0.000380273746
  error estimate for blocks of size 2^( 3) =       0.000393009669
  error estimate for blocks of size 2^( 4) =       0.000402123044
  error estimate for blocks of size 2^( 5) =       0.000407571372
  error estimate for blocks of size 2^( 6) =       0.000411542687
  error estimate for blocks of size 2^( 7) =       0.000412997348

      target function =      -0.944790125579
              le_mean =     -17.212300966051
             les_mean =     296.543362013447
             stat err =       0.000408558613
             autocorr =       1.245968537985
   target nu stat err =       0.000408558613
   target dn stat err =       0.002470883076
      target stat err =       0.004215772837
              std dev =       0.517625698895
             le_variance =       0.267936364157


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721230096605e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944807954095       residual = 3.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944808993997       residual = 2.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944809094303       residual = 7.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944809134299       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944809141964       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944809142190       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944809141994       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944809142029       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944809142010       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944809142027       residual = 4.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+01 is 2.235927e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944807954095       residual = 3.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944808214236       residual = 2.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944808239324       residual = 7.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944808249327       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944808251243       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944808251299       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944808251251       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944808251260       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944808251255       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944808251259       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+02 is 5.593340e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944807954095       residual = 3.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944808019141       residual = 2.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944808025413       residual = 7.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944808027914       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944808028393       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944808028408       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944808028394       residual = 6.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944808028398       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944808028397       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944808028399       residual = 4.55e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+03 is 1.398555e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.090623 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6680e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_001                -4.191502e-02 3 1  ON 0
ci_002                -3.210151e-02 3 1  ON 1
ci_003                -2.646888e-02 3 1  ON 2
ci_004                 2.374395e-02 3 1  ON 3
ci_005                 2.413163e-02 3 1  ON 4
ci_006                -2.146935e-02 3 1  ON 5
ci_007                -2.109087e-02 3 1  ON 6
ci_008                -8.497761e-03 3 1  ON 7
ci_009                -1.373950e-02 3 1  ON 8
ci_010                -1.009158e-02 3 1  ON 9
ci_011                -1.135869e-02 3 1  ON 10
ci_012                -9.745034e-03 3 1  ON 11
ci_013                -1.985938e-02 3 1  ON 12
ci_014                 1.227736e-02 3 1  ON 13
ci_015                 1.189221e-02 3 1  ON 14
ci_016                 1.754154e-02 3 1  ON 15
ci_017                 1.638288e-02 3 1  ON 16
ci_018                 1.026049e-02 3 1  ON 17
ci_019                 1.008164e-02 3 1  ON 18
ci_020                 1.790532e-02 3 1  ON 19
ci_021                 1.749538e-02 3 1  ON 20
ci_022                 9.162629e-03 3 1  ON 21
ci_023                 9.144724e-03 3 1  ON 22
ci_024                 9.632282e-03 3 1  ON 23
ci_025                 1.023113e-02 3 1  ON 24
ci_026                 1.169127e-02 3 1  ON 25
ci_027                 1.176479e-02 3 1  ON 26
ci_028                -1.470910e-02 3 1  ON 27
ci_029                -1.654854e-02 3 1  ON 28
ci_030                -9.566168e-03 3 1  ON 29
ci_031                -8.981378e-03 3 1  ON 30
ci_032                -1.469648e-02 3 1  ON 31
ci_033                 5.187761e-03 3 1  ON 32
ci_034                 5.608525e-03 3 1  ON 33
ci_035                -5.095966e-03 3 1  ON 34
ci_036                -1.278593e-02 3 1  ON 35
ci_037                -1.233461e-02 3 1  ON 36
ci_038                 2.133117e-03 3 1  ON 37
ci_039                 1.733024e-03 3 1  ON 38
ci_040                -3.227504e-03 3 1  ON 39
ci_041                 9.568137e-03 3 1  ON 40
ci_042                 8.198075e-03 3 1  ON 41
ci_043                -4.123634e-03 3 1  ON 42
ci_044                -3.876253e-03 3 1  ON 43
ci_045                -3.602556e-03 3 1  ON 44
ci_046                 5.640913e-03 3 1  ON 45
ci_047                 5.518834e-03 3 1  ON 46
ci_048                -1.262300e-02 3 1  ON 47
ci_049                -1.447572e-02 3 1  ON 48
ci_050                 3.118584e-03 3 1  ON 49
ci_051                 2.765969e-03 3 1  ON 50
ci_052                -2.297796e-03 3 1  ON 51
ci_053                -2.435808e-03 3 1  ON 52
ci_054                -3.407325e-03 3 1  ON 53
ci_055                -2.979116e-03 3 1  ON 54
ci_056                 5.594358e-03 3 1  ON 55
ci_057                 5.303131e-03 3 1  ON 56
ci_058                -9.915997e-04 3 1  ON 57
ci_059                -2.293715e-03 3 1  ON 58
ci_060                 4.604926e-03 3 1  ON 59
ci_061                 5.719391e-03 3 1  ON 60
ci_062                -3.727823e-03 3 1  ON 61
ci_063                -4.030897e-03 3 1  ON 62
ci_064                -2.554653e-03 3 1  ON 63
ci_065                -4.361779e-03 3 1  ON 64
ci_066                 4.436560e-03 3 1  ON 65
ci_067                 4.359684e-03 3 1  ON 66
ci_068                -4.183868e-03 3 1  ON 67
ci_069                -5.046684e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.2793
    reference variance = 0.241983
====================================================
  Execution time = 1.3675e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8806e-01
  Total weights = 1.9573e+06
  Execution time = 1.8235e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272588451960
                                         uncertainty =       0.003278027256

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272588451960
                                         uncertainty =       0.003278027256

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369343701
  error estimate for blocks of size 2^( 2) =       0.000382966793
  error estimate for blocks of size 2^( 3) =       0.000395836423
  error estimate for blocks of size 2^( 4) =       0.000405736101
  error estimate for blocks of size 2^( 5) =       0.000411893428
  error estimate for blocks of size 2^( 6) =       0.000415283666
  error estimate for blocks of size 2^( 7) =       0.000413761669

      target function =      -0.931458998033
              le_mean =     -17.211624605638
             les_mean =     296.528082155567
             stat err =       0.000411668716
             autocorr =       1.242322456123
   target nu stat err =       0.000411668716
   target dn stat err =       0.005909186880
      target stat err =       0.009668404268
              std dev =       0.522330871677
             le_variance =       0.272829539506

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272587857064
                                         uncertainty =       0.003277987827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272587857064
                                         uncertainty =       0.003277987827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369343302
  error estimate for blocks of size 2^( 2) =       0.000382966358
  error estimate for blocks of size 2^( 3) =       0.000395836015
  error estimate for blocks of size 2^( 4) =       0.000405735713
  error estimate for blocks of size 2^( 5) =       0.000411893067
  error estimate for blocks of size 2^( 6) =       0.000415283296
  error estimate for blocks of size 2^( 7) =       0.000413761268

      target function =      -0.931458634375
              le_mean =     -17.211624589068
             les_mean =     296.528081807691
             stat err =       0.000411668336
             autocorr =       1.242322848003
   target nu stat err =       0.000411668336
   target dn stat err =       0.005909212676
      target stat err =       0.009668438369
              std dev =       0.522330306824
             le_variance =       0.272828949427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272588154169
                                         uncertainty =       0.003278007524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272588154169
                                         uncertainty =       0.003278007524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369343501
  error estimate for blocks of size 2^( 2) =       0.000382966576
  error estimate for blocks of size 2^( 3) =       0.000395836219
  error estimate for blocks of size 2^( 4) =       0.000405735907
  error estimate for blocks of size 2^( 5) =       0.000411893247
  error estimate for blocks of size 2^( 6) =       0.000415283481
  error estimate for blocks of size 2^( 7) =       0.000413761468

      target function =      -0.931458958091
              le_mean =     -17.211624597333
             les_mean =     296.528081893970
             stat err =       0.000411668526
             autocorr =       1.242322651999
   target nu stat err =       0.000411668526
   target dn stat err =       0.005909199339
      target stat err =       0.009668423543
              std dev =       0.522330588923
             le_variance =       0.272829244125

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272588414711
                                         uncertainty =       0.003278024789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272588414711
                                         uncertainty =       0.003278024789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369343676
  error estimate for blocks of size 2^( 2) =       0.000382966766
  error estimate for blocks of size 2^( 3) =       0.000395836397
  error estimate for blocks of size 2^( 4) =       0.000405736077
  error estimate for blocks of size 2^( 5) =       0.000411893405
  error estimate for blocks of size 2^( 6) =       0.000415283643
  error estimate for blocks of size 2^( 7) =       0.000413761644

      target function =      -0.931459008904
              le_mean =     -17.211624604598
             les_mean =     296.528082113081
             stat err =       0.000411668692
             autocorr =       1.242322480595
   target nu stat err =       0.000411668692
   target dn stat err =       0.005909188387
      target stat err =       0.009668406924
              std dev =       0.522330836309
             le_variance =       0.272829502559


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.931458998033        initial
     9.7656e+01     9.7656e+02             2.2359e-06        -0.931458634375
     3.9062e+02     3.9062e+03             5.5933e-07        -0.931458958091
     1.5625e+03     1.5625e+04             1.3986e-07        -0.931459008904  <--

*****************************************************************************
Applying the update for shift_i =   1.5625e+03     and shift_s =   1.5625e+04
*****************************************************************************

  Execution time = 2.3065e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
ci_001                -4.191509e-02 3 1  ON 0
ci_002                -3.210171e-02 3 1  ON 1
ci_003                -2.646895e-02 3 1  ON 2
ci_004                 2.374395e-02 3 1  ON 3
ci_005                 2.413172e-02 3 1  ON 4
ci_006                -2.146954e-02 3 1  ON 5
ci_007                -2.109089e-02 3 1  ON 6
ci_008                -8.497792e-03 3 1  ON 7
ci_009                -1.373935e-02 3 1  ON 8
ci_010                -1.009165e-02 3 1  ON 9
ci_011                -1.135868e-02 3 1  ON 10
ci_012                -9.745133e-03 3 1  ON 11
ci_013                -1.985945e-02 3 1  ON 12
ci_014                 1.227715e-02 3 1  ON 13
ci_015                 1.189205e-02 3 1  ON 14
ci_016                 1.754165e-02 3 1  ON 15
ci_017                 1.638294e-02 3 1  ON 16
ci_018                 1.026045e-02 3 1  ON 17
ci_019                 1.008160e-02 3 1  ON 18
ci_020                 1.790549e-02 3 1  ON 19
ci_021                 1.749568e-02 3 1  ON 20
ci_022                 9.162749e-03 3 1  ON 21
ci_023                 9.144714e-03 3 1  ON 22
ci_024                 9.632154e-03 3 1  ON 23
ci_025                 1.023143e-02 3 1  ON 24
ci_026                 1.169150e-02 3 1  ON 25
ci_027                 1.176482e-02 3 1  ON 26
ci_028                -1.470914e-02 3 1  ON 27
ci_029                -1.654865e-02 3 1  ON 28
ci_030                -9.566282e-03 3 1  ON 29
ci_031                -8.981262e-03 3 1  ON 30
ci_032                -1.469643e-02 3 1  ON 31
ci_033                 5.187633e-03 3 1  ON 32
ci_034                 5.608400e-03 3 1  ON 33
ci_035                -5.095943e-03 3 1  ON 34
ci_036                -1.278635e-02 3 1  ON 35
ci_037                -1.233457e-02 3 1  ON 36
ci_038                 2.133177e-03 3 1  ON 37
ci_039                 1.733023e-03 3 1  ON 38
ci_040                -3.227575e-03 3 1  ON 39
ci_041                 9.568206e-03 3 1  ON 40
ci_042                 8.198038e-03 3 1  ON 41
ci_043                -4.123703e-03 3 1  ON 42
ci_044                -3.876057e-03 3 1  ON 43
ci_045                -3.602534e-03 3 1  ON 44
ci_046                 5.640902e-03 3 1  ON 45
ci_047                 5.518868e-03 3 1  ON 46
ci_048                -1.262295e-02 3 1  ON 47
ci_049                -1.447592e-02 3 1  ON 48
ci_050                 3.118624e-03 3 1  ON 49
ci_051                 2.765951e-03 3 1  ON 50
ci_052                -2.297639e-03 3 1  ON 51
ci_053                -2.436000e-03 3 1  ON 52
ci_054                -3.407504e-03 3 1  ON 53
ci_055                -2.979093e-03 3 1  ON 54
ci_056                 5.594353e-03 3 1  ON 55
ci_057                 5.303125e-03 3 1  ON 56
ci_058                -9.913379e-04 3 1  ON 57
ci_059                -2.293530e-03 3 1  ON 58
ci_060                 4.604717e-03 3 1  ON 59
ci_061                 5.719365e-03 3 1  ON 60
ci_062                -3.727874e-03 3 1  ON 61
ci_063                -4.030902e-03 3 1  ON 62
ci_064                -2.554509e-03 3 1  ON 63
ci_065                -4.361765e-03 3 1  ON 64
ci_066                 4.436634e-03 3 1  ON 65
ci_067                 4.359640e-03 3 1  ON 66
ci_068                -4.183699e-03 3 1  ON 67
ci_069                -5.046446e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9751e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1726
    reference variance = 0.166128
====================================================
  Execution time = 1.4016e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5293e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8094e-01
  Total weights = 1.957306133e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4851e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267122253812
                                         uncertainty =       0.001371331854

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267122253812
                                         uncertainty =       0.001371331854

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365435997
  error estimate for blocks of size 2^( 2) =       0.000379314043
  error estimate for blocks of size 2^( 3) =       0.000391768735
  error estimate for blocks of size 2^( 4) =       0.000401049851
  error estimate for blocks of size 2^( 5) =       0.000406049715
  error estimate for blocks of size 2^( 6) =       0.000408383263
  error estimate for blocks of size 2^( 7) =       0.000411285861

      target function =      -0.943299086325
              le_mean =     -17.212086110369
             les_mean =     296.536846957040
             stat err =       0.000406692172
             autocorr =       1.238536974408
   target nu stat err =       0.000406692172
   target dn stat err =       0.003167459344
      target stat err =       0.005353390974
              std dev =       0.516804543546
             le_variance =       0.267086936229


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721208611037e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943328366442       residual = 1.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943328513734       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943328539771       residual = 5.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943328548659       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943328548937       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943328549058       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943328548982       residual = 6.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943328548990       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943328548998       residual = 2.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943328548985       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+02 is 3.914832e-07

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943328366442       residual = 1.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943328403271       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943328409781       residual = 5.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943328412003       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943328412072       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943328412103       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943328412084       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943328412085       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943328412088       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943328412085       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+03 is 9.788503e-08

solving harmonic davidson linear method for identity shift 6.2500e+03, overlap shift 6.2500e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943328366442       residual = 1.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943328375650       residual = 2.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943328377277       residual = 5.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943328377833       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943328377850       residual = 2.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943328377858       residual = 3.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943328377853       residual = 6.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943328377853       residual = 1.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943328377854       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943328377851       residual = 4.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+03 is 2.447215e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.094039 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6509e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_001                -4.191503e-02 3 1  ON 0
ci_002                -3.210164e-02 3 1  ON 1
ci_003                -2.646890e-02 3 1  ON 2
ci_004                 2.374393e-02 3 1  ON 3
ci_005                 2.413164e-02 3 1  ON 4
ci_006                -2.146949e-02 3 1  ON 5
ci_007                -2.109088e-02 3 1  ON 6
ci_008                -8.497774e-03 3 1  ON 7
ci_009                -1.373945e-02 3 1  ON 8
ci_010                -1.009166e-02 3 1  ON 9
ci_011                -1.135869e-02 3 1  ON 10
ci_012                -9.745175e-03 3 1  ON 11
ci_013                -1.985943e-02 3 1  ON 12
ci_014                 1.227715e-02 3 1  ON 13
ci_015                 1.189208e-02 3 1  ON 14
ci_016                 1.754163e-02 3 1  ON 15
ci_017                 1.638296e-02 3 1  ON 16
ci_018                 1.026044e-02 3 1  ON 17
ci_019                 1.008159e-02 3 1  ON 18
ci_020                 1.790540e-02 3 1  ON 19
ci_021                 1.749563e-02 3 1  ON 20
ci_022                 9.162722e-03 3 1  ON 21
ci_023                 9.144708e-03 3 1  ON 22
ci_024                 9.632102e-03 3 1  ON 23
ci_025                 1.023139e-02 3 1  ON 24
ci_026                 1.169146e-02 3 1  ON 25
ci_027                 1.176478e-02 3 1  ON 26
ci_028                -1.470916e-02 3 1  ON 27
ci_029                -1.654863e-02 3 1  ON 28
ci_030                -9.566276e-03 3 1  ON 29
ci_031                -8.981289e-03 3 1  ON 30
ci_032                -1.469642e-02 3 1  ON 31
ci_033                 5.187637e-03 3 1  ON 32
ci_034                 5.608363e-03 3 1  ON 33
ci_035                -5.095933e-03 3 1  ON 34
ci_036                -1.278631e-02 3 1  ON 35
ci_037                -1.233454e-02 3 1  ON 36
ci_038                 2.133145e-03 3 1  ON 37
ci_039                 1.733042e-03 3 1  ON 38
ci_040                -3.227573e-03 3 1  ON 39
ci_041                 9.568120e-03 3 1  ON 40
ci_042                 8.198088e-03 3 1  ON 41
ci_043                -4.123706e-03 3 1  ON 42
ci_044                -3.876061e-03 3 1  ON 43
ci_045                -3.602495e-03 3 1  ON 44
ci_046                 5.640918e-03 3 1  ON 45
ci_047                 5.518849e-03 3 1  ON 46
ci_048                -1.262298e-02 3 1  ON 47
ci_049                -1.447587e-02 3 1  ON 48
ci_050                 3.118604e-03 3 1  ON 49
ci_051                 2.765987e-03 3 1  ON 50
ci_052                -2.297643e-03 3 1  ON 51
ci_053                -2.435975e-03 3 1  ON 52
ci_054                -3.407460e-03 3 1  ON 53
ci_055                -2.979089e-03 3 1  ON 54
ci_056                 5.594355e-03 3 1  ON 55
ci_057                 5.303161e-03 3 1  ON 56
ci_058                -9.913849e-04 3 1  ON 57
ci_059                -2.293490e-03 3 1  ON 58
ci_060                 4.604710e-03 3 1  ON 59
ci_061                 5.719330e-03 3 1  ON 60
ci_062                -3.727862e-03 3 1  ON 61
ci_063                -4.030883e-03 3 1  ON 62
ci_064                -2.554569e-03 3 1  ON 63
ci_065                -4.361754e-03 3 1  ON 64
ci_066                 4.436645e-03 3 1  ON 65
ci_067                 4.359613e-03 3 1  ON 66
ci_068                -4.183759e-03 3 1  ON 67
ci_069                -5.046501e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1907
    reference variance = 0.243298
====================================================
  Execution time = 1.3660e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7950e-01
  Total weights = 1.9571e+06
  Execution time = 1.8296e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268280488205
                                         uncertainty =       0.001250560399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268280488205
                                         uncertainty =       0.001250560399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366237012
  error estimate for blocks of size 2^( 2) =       0.000380043959
  error estimate for blocks of size 2^( 3) =       0.000392686500
  error estimate for blocks of size 2^( 4) =       0.000401713903
  error estimate for blocks of size 2^( 5) =       0.000407379784
  error estimate for blocks of size 2^( 6) =       0.000410377976
  error estimate for blocks of size 2^( 7) =       0.000411485938

      target function =      -0.945734819906
              le_mean =     -17.212024223551
             les_mean =     296.533276460044
             stat err =       0.000407739400
             autocorr =       1.239483915384
   target nu stat err =       0.000407739400
   target dn stat err =       0.001958877876
      target stat err =       0.003375917537
              std dev =       0.517937349269
             le_variance =       0.268259097767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268280317559
                                         uncertainty =       0.001250554226

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268280317559
                                         uncertainty =       0.001250554226

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366236895
  error estimate for blocks of size 2^( 2) =       0.000380043853
  error estimate for blocks of size 2^( 3) =       0.000392686411
  error estimate for blocks of size 2^( 4) =       0.000401713828
  error estimate for blocks of size 2^( 5) =       0.000407379712
  error estimate for blocks of size 2^( 6) =       0.000410377929
  error estimate for blocks of size 2^( 7) =       0.000411485878

      target function =      -0.945733799541
              le_mean =     -17.212024221226
             les_mean =     296.533276985628
             stat err =       0.000407739337
             autocorr =       1.239484319908
   target nu stat err =       0.000407739337
   target dn stat err =       0.001958964126
      target stat err =       0.003376052160
              std dev =       0.517937184010
             le_variance =       0.268258926580

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268280402862
                                         uncertainty =       0.001250557312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268280402862
                                         uncertainty =       0.001250557312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366236953
  error estimate for blocks of size 2^( 2) =       0.000380043906
  error estimate for blocks of size 2^( 3) =       0.000392686456
  error estimate for blocks of size 2^( 4) =       0.000401713865
  error estimate for blocks of size 2^( 5) =       0.000407379748
  error estimate for blocks of size 2^( 6) =       0.000410377953
  error estimate for blocks of size 2^( 7) =       0.000411485908

      target function =      -0.945734311191
              le_mean =     -17.212024222387
             les_mean =     296.533276721925
             stat err =       0.000407739368
             autocorr =       1.239484117664
   target nu stat err =       0.000407739368
   target dn stat err =       0.001958920963
      target stat err =       0.003375984797
              std dev =       0.517937266620
             le_variance =       0.268259012154

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268280477536
                                         uncertainty =       0.001250560014

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268280477536
                                         uncertainty =       0.001250560014

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366237005
  error estimate for blocks of size 2^( 2) =       0.000380043953
  error estimate for blocks of size 2^( 3) =       0.000392686495
  error estimate for blocks of size 2^( 4) =       0.000401713898
  error estimate for blocks of size 2^( 5) =       0.000407379779
  error estimate for blocks of size 2^( 6) =       0.000410377973
  error estimate for blocks of size 2^( 7) =       0.000411485934

      target function =      -0.945734756482
              le_mean =     -17.212024223406
             les_mean =     296.533276492677
             stat err =       0.000407739396
             autocorr =       1.239483940675
   target nu stat err =       0.000407739396
   target dn stat err =       0.001958883257
      target stat err =       0.003375925938
              std dev =       0.517937338936
             le_variance =       0.268259087065


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945734819906        initial  <--
     3.9062e+02     3.9062e+03             3.9148e-07        -0.945733799541
     1.5625e+03     1.5625e+04             9.7885e-08        -0.945734311191
     6.2500e+03     6.2500e+04             2.4472e-08        -0.945734756482

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0933
  </log>
  <optVariables href="H2O.s022.opt.xml">
ci_001                -4.191509e-02 3 1  ON 0
ci_002                -3.210171e-02 3 1  ON 1
ci_003                -2.646895e-02 3 1  ON 2
ci_004                 2.374395e-02 3 1  ON 3
ci_005                 2.413172e-02 3 1  ON 4
ci_006                -2.146954e-02 3 1  ON 5
ci_007                -2.109089e-02 3 1  ON 6
ci_008                -8.497792e-03 3 1  ON 7
ci_009                -1.373935e-02 3 1  ON 8
ci_010                -1.009165e-02 3 1  ON 9
ci_011                -1.135868e-02 3 1  ON 10
ci_012                -9.745133e-03 3 1  ON 11
ci_013                -1.985945e-02 3 1  ON 12
ci_014                 1.227715e-02 3 1  ON 13
ci_015                 1.189205e-02 3 1  ON 14
ci_016                 1.754165e-02 3 1  ON 15
ci_017                 1.638294e-02 3 1  ON 16
ci_018                 1.026045e-02 3 1  ON 17
ci_019                 1.008160e-02 3 1  ON 18
ci_020                 1.790549e-02 3 1  ON 19
ci_021                 1.749568e-02 3 1  ON 20
ci_022                 9.162749e-03 3 1  ON 21
ci_023                 9.144714e-03 3 1  ON 22
ci_024                 9.632154e-03 3 1  ON 23
ci_025                 1.023143e-02 3 1  ON 24
ci_026                 1.169150e-02 3 1  ON 25
ci_027                 1.176482e-02 3 1  ON 26
ci_028                -1.470914e-02 3 1  ON 27
ci_029                -1.654865e-02 3 1  ON 28
ci_030                -9.566282e-03 3 1  ON 29
ci_031                -8.981262e-03 3 1  ON 30
ci_032                -1.469643e-02 3 1  ON 31
ci_033                 5.187633e-03 3 1  ON 32
ci_034                 5.608400e-03 3 1  ON 33
ci_035                -5.095943e-03 3 1  ON 34
ci_036                -1.278635e-02 3 1  ON 35
ci_037                -1.233457e-02 3 1  ON 36
ci_038                 2.133177e-03 3 1  ON 37
ci_039                 1.733023e-03 3 1  ON 38
ci_040                -3.227575e-03 3 1  ON 39
ci_041                 9.568206e-03 3 1  ON 40
ci_042                 8.198038e-03 3 1  ON 41
ci_043                -4.123703e-03 3 1  ON 42
ci_044                -3.876057e-03 3 1  ON 43
ci_045                -3.602534e-03 3 1  ON 44
ci_046                 5.640902e-03 3 1  ON 45
ci_047                 5.518868e-03 3 1  ON 46
ci_048                -1.262295e-02 3 1  ON 47
ci_049                -1.447592e-02 3 1  ON 48
ci_050                 3.118624e-03 3 1  ON 49
ci_051                 2.765951e-03 3 1  ON 50
ci_052                -2.297639e-03 3 1  ON 51
ci_053                -2.436000e-03 3 1  ON 52
ci_054                -3.407504e-03 3 1  ON 53
ci_055                -2.979093e-03 3 1  ON 54
ci_056                 5.594353e-03 3 1  ON 55
ci_057                 5.303125e-03 3 1  ON 56
ci_058                -9.913379e-04 3 1  ON 57
ci_059                -2.293530e-03 3 1  ON 58
ci_060                 4.604717e-03 3 1  ON 59
ci_061                 5.719365e-03 3 1  ON 60
ci_062                -3.727874e-03 3 1  ON 61
ci_063                -4.030902e-03 3 1  ON 62
ci_064                -2.554509e-03 3 1  ON 63
ci_065                -4.361765e-03 3 1  ON 64
ci_066                 4.436634e-03 3 1  ON 65
ci_067                 4.359640e-03 3 1  ON 66
ci_068                -4.183699e-03 3 1  ON 67
ci_069                -5.046446e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9609e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7220e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2255
    reference variance = 0.148444
====================================================
  Execution time = 1.4093e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5275e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7856e-01
  Total weights = 1.957412654e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4835e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268317997493
                                         uncertainty =       0.001526974216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268317997493
                                         uncertainty =       0.001526974216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366343534
  error estimate for blocks of size 2^( 2) =       0.000380106849
  error estimate for blocks of size 2^( 3) =       0.000392798775
  error estimate for blocks of size 2^( 4) =       0.000401972298
  error estimate for blocks of size 2^( 5) =       0.000407073315
  error estimate for blocks of size 2^( 6) =       0.000411424620
  error estimate for blocks of size 2^( 7) =       0.000411802097

      target function =      -0.947312335789
              le_mean =     -17.211520553728
             les_mean =     296.514999419076
             stat err =       0.000408068083
             autocorr =       1.240761171620
   target nu stat err =       0.000408068083
   target dn stat err =       0.001842200728
      target stat err =       0.003191867743
              std dev =       0.518087994071
             le_variance =       0.268415169601


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721152055373e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947322205937       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947322218470       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947322221116       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947322221922       residual = 7.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947322222041       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947322222085       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947322222095       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947322222095       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947322222093       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947322222090       residual = 3.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+03 is 4.917200e-08

solving harmonic davidson linear method for identity shift 1.5625e+04, overlap shift 1.5625e+05 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947322205937       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947322209070       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947322209732       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947322209933       residual = 7.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947322209960       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947322209973       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947322209987       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947322209973       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947322210019       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947322209984       residual = 3.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+04 is 1.229318e-08

solving harmonic davidson linear method for identity shift 6.2500e+04, overlap shift 6.2500e+05 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947322205937       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947322206720       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947322206885       residual = 4.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947322206936       residual = 7.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947322206859       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947322206946       residual = 2.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947322206873       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947322207030       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947322206950       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947322206956       residual = 3.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+04 is 3.073305e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.097514 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6586e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_001                -4.191509e-02 3 1  ON 0
ci_002                -3.210171e-02 3 1  ON 1
ci_003                -2.646894e-02 3 1  ON 2
ci_004                 2.374395e-02 3 1  ON 3
ci_005                 2.413172e-02 3 1  ON 4
ci_006                -2.146954e-02 3 1  ON 5
ci_007                -2.109089e-02 3 1  ON 6
ci_008                -8.497790e-03 3 1  ON 7
ci_009                -1.373936e-02 3 1  ON 8
ci_010                -1.009165e-02 3 1  ON 9
ci_011                -1.135867e-02 3 1  ON 10
ci_012                -9.745140e-03 3 1  ON 11
ci_013                -1.985945e-02 3 1  ON 12
ci_014                 1.227715e-02 3 1  ON 13
ci_015                 1.189205e-02 3 1  ON 14
ci_016                 1.754164e-02 3 1  ON 15
ci_017                 1.638295e-02 3 1  ON 16
ci_018                 1.026045e-02 3 1  ON 17
ci_019                 1.008160e-02 3 1  ON 18
ci_020                 1.790549e-02 3 1  ON 19
ci_021                 1.749568e-02 3 1  ON 20
ci_022                 9.162750e-03 3 1  ON 21
ci_023                 9.144714e-03 3 1  ON 22
ci_024                 9.632155e-03 3 1  ON 23
ci_025                 1.023143e-02 3 1  ON 24
ci_026                 1.169150e-02 3 1  ON 25
ci_027                 1.176481e-02 3 1  ON 26
ci_028                -1.470913e-02 3 1  ON 27
ci_029                -1.654865e-02 3 1  ON 28
ci_030                -9.566276e-03 3 1  ON 29
ci_031                -8.981263e-03 3 1  ON 30
ci_032                -1.469643e-02 3 1  ON 31
ci_033                 5.187632e-03 3 1  ON 32
ci_034                 5.608399e-03 3 1  ON 33
ci_035                -5.095942e-03 3 1  ON 34
ci_036                -1.278635e-02 3 1  ON 35
ci_037                -1.233457e-02 3 1  ON 36
ci_038                 2.133175e-03 3 1  ON 37
ci_039                 1.733025e-03 3 1  ON 38
ci_040                -3.227575e-03 3 1  ON 39
ci_041                 9.568198e-03 3 1  ON 40
ci_042                 8.198038e-03 3 1  ON 41
ci_043                -4.123702e-03 3 1  ON 42
ci_044                -3.876061e-03 3 1  ON 43
ci_045                -3.602533e-03 3 1  ON 44
ci_046                 5.640905e-03 3 1  ON 45
ci_047                 5.518869e-03 3 1  ON 46
ci_048                -1.262296e-02 3 1  ON 47
ci_049                -1.447591e-02 3 1  ON 48
ci_050                 3.118628e-03 3 1  ON 49
ci_051                 2.765951e-03 3 1  ON 50
ci_052                -2.297639e-03 3 1  ON 51
ci_053                -2.436000e-03 3 1  ON 52
ci_054                -3.407503e-03 3 1  ON 53
ci_055                -2.979091e-03 3 1  ON 54
ci_056                 5.594351e-03 3 1  ON 55
ci_057                 5.303125e-03 3 1  ON 56
ci_058                -9.913390e-04 3 1  ON 57
ci_059                -2.293528e-03 3 1  ON 58
ci_060                 4.604718e-03 3 1  ON 59
ci_061                 5.719364e-03 3 1  ON 60
ci_062                -3.727877e-03 3 1  ON 61
ci_063                -4.030902e-03 3 1  ON 62
ci_064                -2.554510e-03 3 1  ON 63
ci_065                -4.361764e-03 3 1  ON 64
ci_066                 4.436633e-03 3 1  ON 65
ci_067                 4.359643e-03 3 1  ON 66
ci_068                -4.183704e-03 3 1  ON 67
ci_069                -5.046446e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.2856
    reference variance = 0.294407
====================================================
  Execution time = 1.3668e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7600e-01
  Total weights = 1.9573e+06
  Execution time = 1.8222e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265611923457
                                         uncertainty =       0.001224624856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265611923457
                                         uncertainty =       0.001224624856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364424386
  error estimate for blocks of size 2^( 2) =       0.000378401351
  error estimate for blocks of size 2^( 3) =       0.000391516325
  error estimate for blocks of size 2^( 4) =       0.000400280656
  error estimate for blocks of size 2^( 5) =       0.000406165619
  error estimate for blocks of size 2^( 6) =       0.000409157587
  error estimate for blocks of size 2^( 7) =       0.000409776850

      target function =      -0.951655992941
              le_mean =     -17.211397917276
             les_mean =     296.508213761315
             stat err =       0.000406345178
             autocorr =       1.243298357795
   target nu stat err =       0.000406345178
   target dn stat err =       0.001818763632
      target stat err =       0.003180151516
              std dev =       0.515373908548
             le_variance =       0.265610265612

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265611916429
                                         uncertainty =       0.001224625040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265611916429
                                         uncertainty =       0.001224625040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364424381
  error estimate for blocks of size 2^( 2) =       0.000378401348
  error estimate for blocks of size 2^( 3) =       0.000391516323
  error estimate for blocks of size 2^( 4) =       0.000400280654
  error estimate for blocks of size 2^( 5) =       0.000406165618
  error estimate for blocks of size 2^( 6) =       0.000409157587
  error estimate for blocks of size 2^( 7) =       0.000409776847

      target function =      -0.951655921927
              le_mean =     -17.211397917484
             les_mean =     296.508213810195
             stat err =       0.000406345176
             autocorr =       1.243298381694
   target nu stat err =       0.000406345176
   target dn stat err =       0.001818767475
      target stat err =       0.003180157422
              std dev =       0.515373901742
             le_variance =       0.265610258597

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265611919943
                                         uncertainty =       0.001224624948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265611919943
                                         uncertainty =       0.001224624948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364424383
  error estimate for blocks of size 2^( 2) =       0.000378401350
  error estimate for blocks of size 2^( 3) =       0.000391516324
  error estimate for blocks of size 2^( 4) =       0.000400280655
  error estimate for blocks of size 2^( 5) =       0.000406165618
  error estimate for blocks of size 2^( 6) =       0.000409157587
  error estimate for blocks of size 2^( 7) =       0.000409776848

      target function =      -0.951655957474
              le_mean =     -17.211397917380
             les_mean =     296.508213785732
             stat err =       0.000406345177
             autocorr =       1.243298369734
   target nu stat err =       0.000406345177
   target dn stat err =       0.001818765551
      target stat err =       0.003180154466
              std dev =       0.515373905145
             le_variance =       0.265610262105

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265611923018
                                         uncertainty =       0.001224624867

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265611923018
                                         uncertainty =       0.001224624867

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364424385
  error estimate for blocks of size 2^( 2) =       0.000378401351
  error estimate for blocks of size 2^( 3) =       0.000391516325
  error estimate for blocks of size 2^( 4) =       0.000400280656
  error estimate for blocks of size 2^( 5) =       0.000406165619
  error estimate for blocks of size 2^( 6) =       0.000409157587
  error estimate for blocks of size 2^( 7) =       0.000409776849

      target function =      -0.951655988512
              le_mean =     -17.211397917289
             les_mean =     296.508213764365
             stat err =       0.000406345178
             autocorr =       1.243298359279
   target nu stat err =       0.000406345178
   target dn stat err =       0.001818763872
      target stat err =       0.003180151884
              std dev =       0.515373908123
             le_variance =       0.265610265174


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.951655992941        initial  <--
     3.9062e+03     3.9062e+04             4.9172e-08        -0.951655921927
     1.5625e+04     1.5625e+05             1.2293e-08        -0.951655957474
     6.2500e+04     6.2500e+05             3.0733e-09        -0.951655988512

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0693
  </log>
  <optVariables href="H2O.s023.opt.xml">
ci_001                -4.191509e-02 3 1  ON 0
ci_002                -3.210171e-02 3 1  ON 1
ci_003                -2.646895e-02 3 1  ON 2
ci_004                 2.374395e-02 3 1  ON 3
ci_005                 2.413172e-02 3 1  ON 4
ci_006                -2.146954e-02 3 1  ON 5
ci_007                -2.109089e-02 3 1  ON 6
ci_008                -8.497792e-03 3 1  ON 7
ci_009                -1.373935e-02 3 1  ON 8
ci_010                -1.009165e-02 3 1  ON 9
ci_011                -1.135868e-02 3 1  ON 10
ci_012                -9.745133e-03 3 1  ON 11
ci_013                -1.985945e-02 3 1  ON 12
ci_014                 1.227715e-02 3 1  ON 13
ci_015                 1.189205e-02 3 1  ON 14
ci_016                 1.754165e-02 3 1  ON 15
ci_017                 1.638294e-02 3 1  ON 16
ci_018                 1.026045e-02 3 1  ON 17
ci_019                 1.008160e-02 3 1  ON 18
ci_020                 1.790549e-02 3 1  ON 19
ci_021                 1.749568e-02 3 1  ON 20
ci_022                 9.162749e-03 3 1  ON 21
ci_023                 9.144714e-03 3 1  ON 22
ci_024                 9.632154e-03 3 1  ON 23
ci_025                 1.023143e-02 3 1  ON 24
ci_026                 1.169150e-02 3 1  ON 25
ci_027                 1.176482e-02 3 1  ON 26
ci_028                -1.470914e-02 3 1  ON 27
ci_029                -1.654865e-02 3 1  ON 28
ci_030                -9.566282e-03 3 1  ON 29
ci_031                -8.981262e-03 3 1  ON 30
ci_032                -1.469643e-02 3 1  ON 31
ci_033                 5.187633e-03 3 1  ON 32
ci_034                 5.608400e-03 3 1  ON 33
ci_035                -5.095943e-03 3 1  ON 34
ci_036                -1.278635e-02 3 1  ON 35
ci_037                -1.233457e-02 3 1  ON 36
ci_038                 2.133177e-03 3 1  ON 37
ci_039                 1.733023e-03 3 1  ON 38
ci_040                -3.227575e-03 3 1  ON 39
ci_041                 9.568206e-03 3 1  ON 40
ci_042                 8.198038e-03 3 1  ON 41
ci_043                -4.123703e-03 3 1  ON 42
ci_044                -3.876057e-03 3 1  ON 43
ci_045                -3.602534e-03 3 1  ON 44
ci_046                 5.640902e-03 3 1  ON 45
ci_047                 5.518868e-03 3 1  ON 46
ci_048                -1.262295e-02 3 1  ON 47
ci_049                -1.447592e-02 3 1  ON 48
ci_050                 3.118624e-03 3 1  ON 49
ci_051                 2.765951e-03 3 1  ON 50
ci_052                -2.297639e-03 3 1  ON 51
ci_053                -2.436000e-03 3 1  ON 52
ci_054                -3.407504e-03 3 1  ON 53
ci_055                -2.979093e-03 3 1  ON 54
ci_056                 5.594353e-03 3 1  ON 55
ci_057                 5.303125e-03 3 1  ON 56
ci_058                -9.913379e-04 3 1  ON 57
ci_059                -2.293530e-03 3 1  ON 58
ci_060                 4.604717e-03 3 1  ON 59
ci_061                 5.719365e-03 3 1  ON 60
ci_062                -3.727874e-03 3 1  ON 61
ci_063                -4.030902e-03 3 1  ON 62
ci_064                -2.554509e-03 3 1  ON 63
ci_065                -4.361765e-03 3 1  ON 64
ci_066                 4.436634e-03 3 1  ON 65
ci_067                 4.359640e-03 3 1  ON 66
ci_068                -4.183699e-03 3 1  ON 67
ci_069                -5.046446e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9661e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2148
    reference variance = 0.208799
====================================================
  Execution time = 1.4304e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5288e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7765e-01
  Total weights = 1.957280737e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5009e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267768227740
                                         uncertainty =       0.001949976972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267768227740
                                         uncertainty =       0.001949976972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365903781
  error estimate for blocks of size 2^( 2) =       0.000379715007
  error estimate for blocks of size 2^( 3) =       0.000392810357
  error estimate for blocks of size 2^( 4) =       0.000401857213
  error estimate for blocks of size 2^( 5) =       0.000407049972
  error estimate for blocks of size 2^( 6) =       0.000410730229
  error estimate for blocks of size 2^( 7) =       0.000413148161

      target function =      -0.948851816200
              le_mean =     -17.211367035201
             les_mean =     296.508800539569
             stat err =       0.000408196393
             autocorr =       1.244527602222
   target nu stat err =       0.000408196393
   target dn stat err =       0.002090974341
      target stat err =       0.003612317181
              std dev =       0.517466089007
             le_variance =       0.267771153272


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721136703520e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948864706176       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948864707503       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948864707696       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948864707762       residual = 9.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948864707775       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948864707776       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948864707714       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948864707789       residual = 9.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948864707753       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948864707727       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+04 is 3.334478e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948864706176       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948864706507       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948864706556       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948864706579       residual = 9.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948864706397       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948864706455       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948864706485       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948864706629       residual = 9.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948864706479       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948864706498       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+05 is 8.336207e-10

solving harmonic davidson linear method for identity shift 6.2500e+05, overlap shift 6.2500e+06 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948864706176       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948864706258       residual = 2.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948864706271       residual = 4.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948864706276       residual = 9.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948864704589       residual = 1.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948864706505       residual = 2.82e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948864706343       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948864705954       residual = 9.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948864705995       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948864705712       residual = 3.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.2500e+05 is 2.084053e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.100962 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6816e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_001                -4.191509e-02 3 1  ON 0
ci_002                -3.210171e-02 3 1  ON 1
ci_003                -2.646895e-02 3 1  ON 2
ci_004                 2.374395e-02 3 1  ON 3
ci_005                 2.413172e-02 3 1  ON 4
ci_006                -2.146954e-02 3 1  ON 5
ci_007                -2.109089e-02 3 1  ON 6
ci_008                -8.497792e-03 3 1  ON 7
ci_009                -1.373935e-02 3 1  ON 8
ci_010                -1.009165e-02 3 1  ON 9
ci_011                -1.135868e-02 3 1  ON 10
ci_012                -9.745133e-03 3 1  ON 11
ci_013                -1.985945e-02 3 1  ON 12
ci_014                 1.227715e-02 3 1  ON 13
ci_015                 1.189205e-02 3 1  ON 14
ci_016                 1.754165e-02 3 1  ON 15
ci_017                 1.638294e-02 3 1  ON 16
ci_018                 1.026045e-02 3 1  ON 17
ci_019                 1.008160e-02 3 1  ON 18
ci_020                 1.790549e-02 3 1  ON 19
ci_021                 1.749568e-02 3 1  ON 20
ci_022                 9.162749e-03 3 1  ON 21
ci_023                 9.144714e-03 3 1  ON 22
ci_024                 9.632154e-03 3 1  ON 23
ci_025                 1.023143e-02 3 1  ON 24
ci_026                 1.169150e-02 3 1  ON 25
ci_027                 1.176482e-02 3 1  ON 26
ci_028                -1.470914e-02 3 1  ON 27
ci_029                -1.654865e-02 3 1  ON 28
ci_030                -9.566282e-03 3 1  ON 29
ci_031                -8.981262e-03 3 1  ON 30
ci_032                -1.469643e-02 3 1  ON 31
ci_033                 5.187634e-03 3 1  ON 32
ci_034                 5.608400e-03 3 1  ON 33
ci_035                -5.095943e-03 3 1  ON 34
ci_036                -1.278635e-02 3 1  ON 35
ci_037                -1.233457e-02 3 1  ON 36
ci_038                 2.133177e-03 3 1  ON 37
ci_039                 1.733023e-03 3 1  ON 38
ci_040                -3.227575e-03 3 1  ON 39
ci_041                 9.568206e-03 3 1  ON 40
ci_042                 8.198038e-03 3 1  ON 41
ci_043                -4.123703e-03 3 1  ON 42
ci_044                -3.876057e-03 3 1  ON 43
ci_045                -3.602534e-03 3 1  ON 44
ci_046                 5.640902e-03 3 1  ON 45
ci_047                 5.518868e-03 3 1  ON 46
ci_048                -1.262295e-02 3 1  ON 47
ci_049                -1.447592e-02 3 1  ON 48
ci_050                 3.118624e-03 3 1  ON 49
ci_051                 2.765952e-03 3 1  ON 50
ci_052                -2.297639e-03 3 1  ON 51
ci_053                -2.436000e-03 3 1  ON 52
ci_054                -3.407504e-03 3 1  ON 53
ci_055                -2.979093e-03 3 1  ON 54
ci_056                 5.594353e-03 3 1  ON 55
ci_057                 5.303125e-03 3 1  ON 56
ci_058                -9.913383e-04 3 1  ON 57
ci_059                -2.293530e-03 3 1  ON 58
ci_060                 4.604717e-03 3 1  ON 59
ci_061                 5.719365e-03 3 1  ON 60
ci_062                -3.727874e-03 3 1  ON 61
ci_063                -4.030901e-03 3 1  ON 62
ci_064                -2.554509e-03 3 1  ON 63
ci_065                -4.361765e-03 3 1  ON 64
ci_066                 4.436634e-03 3 1  ON 65
ci_067                 4.359640e-03 3 1  ON 66
ci_068                -4.183700e-03 3 1  ON 67
ci_069                -5.046446e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.2051
    reference variance = 0.251049
====================================================
  Execution time = 1.4262e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7771e-01
  Total weights = 1.9572e+06
  Execution time = 1.8536e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267117196495
                                         uncertainty =       0.001399812380

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267117196495
                                         uncertainty =       0.001399812380

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365456367
  error estimate for blocks of size 2^( 2) =       0.000379430470
  error estimate for blocks of size 2^( 3) =       0.000391962332
  error estimate for blocks of size 2^( 4) =       0.000401605762
  error estimate for blocks of size 2^( 5) =       0.000407917165
  error estimate for blocks of size 2^( 6) =       0.000411412976
  error estimate for blocks of size 2^( 7) =       0.000413135852

      target function =      -0.948764108572
              le_mean =     -17.212545592033
             les_mean =     296.549434744641
             stat err =       0.000408517939
             autocorr =       1.249542975499
   target nu stat err =       0.000408517939
   target dn stat err =       0.001933563132
      target stat err =       0.003358802792
              std dev =       0.516833351289
             le_variance =       0.267116713004

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267117195621
                                         uncertainty =       0.001399812479

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267117195621
                                         uncertainty =       0.001399812479

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365456367
  error estimate for blocks of size 2^( 2) =       0.000379430469
  error estimate for blocks of size 2^( 3) =       0.000391962332
  error estimate for blocks of size 2^( 4) =       0.000401605761
  error estimate for blocks of size 2^( 5) =       0.000407917164
  error estimate for blocks of size 2^( 6) =       0.000411412975
  error estimate for blocks of size 2^( 7) =       0.000413135850

      target function =      -0.948764116791
              le_mean =     -17.212545592001
             les_mean =     296.549434738684
             stat err =       0.000408517938
             autocorr =       1.249542973014
   target nu stat err =       0.000408517938
   target dn stat err =       0.001933563063
      target stat err =       0.003358802733
              std dev =       0.516833350435
             le_variance =       0.267116712122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267117196058
                                         uncertainty =       0.001399812430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267117196058
                                         uncertainty =       0.001399812430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365456367
  error estimate for blocks of size 2^( 2) =       0.000379430469
  error estimate for blocks of size 2^( 3) =       0.000391962332
  error estimate for blocks of size 2^( 4) =       0.000401605762
  error estimate for blocks of size 2^( 5) =       0.000407917165
  error estimate for blocks of size 2^( 6) =       0.000411412975
  error estimate for blocks of size 2^( 7) =       0.000413135851

      target function =      -0.948764112684
              le_mean =     -17.212545592017
             les_mean =     296.549434741661
             stat err =       0.000408517938
             autocorr =       1.249542974261
   target nu stat err =       0.000408517938
   target dn stat err =       0.001933563097
      target stat err =       0.003358802762
              std dev =       0.516833350862
             le_variance =       0.267116712563

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267117196441
                                         uncertainty =       0.001399812387

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267117196441
                                         uncertainty =       0.001399812387

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365456367
  error estimate for blocks of size 2^( 2) =       0.000379430470
  error estimate for blocks of size 2^( 3) =       0.000391962332
  error estimate for blocks of size 2^( 4) =       0.000401605762
  error estimate for blocks of size 2^( 5) =       0.000407917165
  error estimate for blocks of size 2^( 6) =       0.000411412976
  error estimate for blocks of size 2^( 7) =       0.000413135851

      target function =      -0.948764109086
              le_mean =     -17.212545592031
             les_mean =     296.549434744269
             stat err =       0.000408517939
             autocorr =       1.249542975335
   target nu stat err =       0.000408517939
   target dn stat err =       0.001933563128
      target stat err =       0.003358802788
              std dev =       0.516833351235
             le_variance =       0.267116712949


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948764108572        initial
     3.9062e+04     3.9062e+05             3.3345e-09        -0.948764116791  <--
     1.5625e+05     1.5625e+06             8.3362e-10        -0.948764112684
     6.2500e+05     6.2500e+06             2.0841e-10        -0.948764109086

*****************************************************************************
Applying the update for shift_i =   3.9062e+04     and shift_s =   3.9062e+05
*****************************************************************************

  Execution time = 2.3652e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
ci_001                -4.191509e-02 3 1  ON 0
ci_002                -3.210171e-02 3 1  ON 1
ci_003                -2.646894e-02 3 1  ON 2
ci_004                 2.374395e-02 3 1  ON 3
ci_005                 2.413172e-02 3 1  ON 4
ci_006                -2.146954e-02 3 1  ON 5
ci_007                -2.109089e-02 3 1  ON 6
ci_008                -8.497794e-03 3 1  ON 7
ci_009                -1.373936e-02 3 1  ON 8
ci_010                -1.009165e-02 3 1  ON 9
ci_011                -1.135868e-02 3 1  ON 10
ci_012                -9.745133e-03 3 1  ON 11
ci_013                -1.985945e-02 3 1  ON 12
ci_014                 1.227715e-02 3 1  ON 13
ci_015                 1.189205e-02 3 1  ON 14
ci_016                 1.754165e-02 3 1  ON 15
ci_017                 1.638294e-02 3 1  ON 16
ci_018                 1.026045e-02 3 1  ON 17
ci_019                 1.008161e-02 3 1  ON 18
ci_020                 1.790549e-02 3 1  ON 19
ci_021                 1.749568e-02 3 1  ON 20
ci_022                 9.162751e-03 3 1  ON 21
ci_023                 9.144713e-03 3 1  ON 22
ci_024                 9.632156e-03 3 1  ON 23
ci_025                 1.023142e-02 3 1  ON 24
ci_026                 1.169150e-02 3 1  ON 25
ci_027                 1.176482e-02 3 1  ON 26
ci_028                -1.470914e-02 3 1  ON 27
ci_029                -1.654865e-02 3 1  ON 28
ci_030                -9.566283e-03 3 1  ON 29
ci_031                -8.981262e-03 3 1  ON 30
ci_032                -1.469643e-02 3 1  ON 31
ci_033                 5.187635e-03 3 1  ON 32
ci_034                 5.608401e-03 3 1  ON 33
ci_035                -5.095943e-03 3 1  ON 34
ci_036                -1.278635e-02 3 1  ON 35
ci_037                -1.233457e-02 3 1  ON 36
ci_038                 2.133175e-03 3 1  ON 37
ci_039                 1.733023e-03 3 1  ON 38
ci_040                -3.227574e-03 3 1  ON 39
ci_041                 9.568204e-03 3 1  ON 40
ci_042                 8.198039e-03 3 1  ON 41
ci_043                -4.123702e-03 3 1  ON 42
ci_044                -3.876058e-03 3 1  ON 43
ci_045                -3.602532e-03 3 1  ON 44
ci_046                 5.640902e-03 3 1  ON 45
ci_047                 5.518869e-03 3 1  ON 46
ci_048                -1.262295e-02 3 1  ON 47
ci_049                -1.447592e-02 3 1  ON 48
ci_050                 3.118626e-03 3 1  ON 49
ci_051                 2.765954e-03 3 1  ON 50
ci_052                -2.297639e-03 3 1  ON 51
ci_053                -2.436001e-03 3 1  ON 52
ci_054                -3.407503e-03 3 1  ON 53
ci_055                -2.979093e-03 3 1  ON 54
ci_056                 5.594351e-03 3 1  ON 55
ci_057                 5.303125e-03 3 1  ON 56
ci_058                -9.913393e-04 3 1  ON 57
ci_059                -2.293530e-03 3 1  ON 58
ci_060                 4.604718e-03 3 1  ON 59
ci_061                 5.719363e-03 3 1  ON 60
ci_062                -3.727874e-03 3 1  ON 61
ci_063                -4.030901e-03 3 1  ON 62
ci_064                -2.554510e-03 3 1  ON 63
ci_065                -4.361765e-03 3 1  ON 64
ci_066                 4.436634e-03 3 1  ON 65
ci_067                 4.359640e-03 3 1  ON 66
ci_068                -4.183701e-03 3 1  ON 67
ci_069                -5.046447e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0474e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7221e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1762
    reference variance = 0.207559
====================================================
  Execution time = 1.6664e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7839e-01
  Total weights = 1.957759669e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4961e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267513935498
                                         uncertainty =       0.001676770427

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267513935498
                                         uncertainty =       0.001676770427

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365722400
  error estimate for blocks of size 2^( 2) =       0.000379716813
  error estimate for blocks of size 2^( 3) =       0.000392797234
  error estimate for blocks of size 2^( 4) =       0.000402167456
  error estimate for blocks of size 2^( 5) =       0.000407426837
  error estimate for blocks of size 2^( 6) =       0.000409256396
  error estimate for blocks of size 2^( 7) =       0.000408990237

      target function =      -0.947596581173
              le_mean =     -17.212041558658
             les_mean =     296.532766944036
             stat err =       0.000406960231
             autocorr =       1.238228573348
   target nu stat err =       0.000406960231
   target dn stat err =       0.002276569532
      target stat err =       0.003914813049
              std dev =       0.517209577807
             le_variance =       0.267505747376


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721204155866e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947611642293       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947611649623       residual = 4.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947611651156       residual = 7.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947611651438       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947611651517       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947611651522       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947611651526       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947611651511       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947611651533       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947611651526       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+03 is 2.206334e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947611642293       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947611644125       residual = 4.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947611644509       residual = 7.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947611644579       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947611644613       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947611644533       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947611644618       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947611644556       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947611644643       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947611644550       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+04 is 5.515867e-09

solving harmonic davidson linear method for identity shift 1.5625e+05, overlap shift 1.5625e+06 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947611642293       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947611642751       residual = 4.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947611642847       residual = 7.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947611642865       residual = 1.59e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947611642869       residual = 3.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947611643079       residual = 5.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947611642639       residual = 8.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947611642439       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947611643040       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947611642849       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+05 is 1.378969e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.104430 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9168e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_001                -4.191509e-02 3 1  ON 0
ci_002                -3.210171e-02 3 1  ON 1
ci_003                -2.646894e-02 3 1  ON 2
ci_004                 2.374395e-02 3 1  ON 3
ci_005                 2.413172e-02 3 1  ON 4
ci_006                -2.146954e-02 3 1  ON 5
ci_007                -2.109089e-02 3 1  ON 6
ci_008                -8.497795e-03 3 1  ON 7
ci_009                -1.373936e-02 3 1  ON 8
ci_010                -1.009165e-02 3 1  ON 9
ci_011                -1.135868e-02 3 1  ON 10
ci_012                -9.745133e-03 3 1  ON 11
ci_013                -1.985945e-02 3 1  ON 12
ci_014                 1.227715e-02 3 1  ON 13
ci_015                 1.189205e-02 3 1  ON 14
ci_016                 1.754164e-02 3 1  ON 15
ci_017                 1.638295e-02 3 1  ON 16
ci_018                 1.026045e-02 3 1  ON 17
ci_019                 1.008161e-02 3 1  ON 18
ci_020                 1.790549e-02 3 1  ON 19
ci_021                 1.749568e-02 3 1  ON 20
ci_022                 9.162751e-03 3 1  ON 21
ci_023                 9.144713e-03 3 1  ON 22
ci_024                 9.632154e-03 3 1  ON 23
ci_025                 1.023142e-02 3 1  ON 24
ci_026                 1.169150e-02 3 1  ON 25
ci_027                 1.176482e-02 3 1  ON 26
ci_028                -1.470914e-02 3 1  ON 27
ci_029                -1.654865e-02 3 1  ON 28
ci_030                -9.566282e-03 3 1  ON 29
ci_031                -8.981261e-03 3 1  ON 30
ci_032                -1.469643e-02 3 1  ON 31
ci_033                 5.187636e-03 3 1  ON 32
ci_034                 5.608402e-03 3 1  ON 33
ci_035                -5.095942e-03 3 1  ON 34
ci_036                -1.278635e-02 3 1  ON 35
ci_037                -1.233457e-02 3 1  ON 36
ci_038                 2.133174e-03 3 1  ON 37
ci_039                 1.733022e-03 3 1  ON 38
ci_040                -3.227574e-03 3 1  ON 39
ci_041                 9.568202e-03 3 1  ON 40
ci_042                 8.198042e-03 3 1  ON 41
ci_043                -4.123702e-03 3 1  ON 42
ci_044                -3.876061e-03 3 1  ON 43
ci_045                -3.602532e-03 3 1  ON 44
ci_046                 5.640902e-03 3 1  ON 45
ci_047                 5.518870e-03 3 1  ON 46
ci_048                -1.262296e-02 3 1  ON 47
ci_049                -1.447591e-02 3 1  ON 48
ci_050                 3.118627e-03 3 1  ON 49
ci_051                 2.765955e-03 3 1  ON 50
ci_052                -2.297639e-03 3 1  ON 51
ci_053                -2.436000e-03 3 1  ON 52
ci_054                -3.407502e-03 3 1  ON 53
ci_055                -2.979092e-03 3 1  ON 54
ci_056                 5.594351e-03 3 1  ON 55
ci_057                 5.303125e-03 3 1  ON 56
ci_058                -9.913401e-04 3 1  ON 57
ci_059                -2.293528e-03 3 1  ON 58
ci_060                 4.604721e-03 3 1  ON 59
ci_061                 5.719362e-03 3 1  ON 60
ci_062                -3.727874e-03 3 1  ON 61
ci_063                -4.030900e-03 3 1  ON 62
ci_064                -2.554512e-03 3 1  ON 63
ci_065                -4.361764e-03 3 1  ON 64
ci_066                 4.436634e-03 3 1  ON 65
ci_067                 4.359640e-03 3 1  ON 66
ci_068                -4.183702e-03 3 1  ON 67
ci_069                -5.046447e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.1448
    reference variance = 0.310606
====================================================
  Execution time = 1.4688e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7967e-01
  Total weights = 1.9574e+06
  Execution time = 1.8561e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266942771320
                                         uncertainty =       0.001290720369

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266942771320
                                         uncertainty =       0.001290720369

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365307747
  error estimate for blocks of size 2^( 2) =       0.000379115095
  error estimate for blocks of size 2^( 3) =       0.000392223471
  error estimate for blocks of size 2^( 4) =       0.000401986710
  error estimate for blocks of size 2^( 5) =       0.000407577497
  error estimate for blocks of size 2^( 6) =       0.000411023352
  error estimate for blocks of size 2^( 7) =       0.000410911711

      target function =      -0.945446380296
              le_mean =     -17.211314075615
             les_mean =     296.508997666791
             stat err =       0.000407874818
             autocorr =       1.246625541596
   target nu stat err =       0.000407874818
   target dn stat err =       0.002012915464
      target stat err =       0.003458162828
              std dev =       0.516623170197
             le_variance =       0.266899499984

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266942764981
                                         uncertainty =       0.001290720123

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266942764981
                                         uncertainty =       0.001290720123

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365307743
  error estimate for blocks of size 2^( 2) =       0.000379115090
  error estimate for blocks of size 2^( 3) =       0.000392223467
  error estimate for blocks of size 2^( 4) =       0.000401986706
  error estimate for blocks of size 2^( 5) =       0.000407577494
  error estimate for blocks of size 2^( 6) =       0.000411023349
  error estimate for blocks of size 2^( 7) =       0.000410911707

      target function =      -0.945446380126
              le_mean =     -17.211314075922
             les_mean =     296.508997677475
             stat err =       0.000407874814
             autocorr =       1.246625549115
   target nu stat err =       0.000407874814
   target dn stat err =       0.002012915186
      target stat err =       0.003458162372
              std dev =       0.516623164067
             le_variance =       0.266899493650

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266942768150
                                         uncertainty =       0.001290720246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266942768150
                                         uncertainty =       0.001290720246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365307745
  error estimate for blocks of size 2^( 2) =       0.000379115092
  error estimate for blocks of size 2^( 3) =       0.000392223469
  error estimate for blocks of size 2^( 4) =       0.000401986708
  error estimate for blocks of size 2^( 5) =       0.000407577495
  error estimate for blocks of size 2^( 6) =       0.000411023350
  error estimate for blocks of size 2^( 7) =       0.000410911709

      target function =      -0.945446380213
              le_mean =     -17.211314075769
             les_mean =     296.508997672132
             stat err =       0.000407874816
             autocorr =       1.246625545363
   target nu stat err =       0.000407874816
   target dn stat err =       0.002012915325
      target stat err =       0.003458162600
              std dev =       0.516623167132
             le_variance =       0.266899496817

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266942770923
                                         uncertainty =       0.001290720353

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266942770923
                                         uncertainty =       0.001290720353

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365307747
  error estimate for blocks of size 2^( 2) =       0.000379115094
  error estimate for blocks of size 2^( 3) =       0.000392223471
  error estimate for blocks of size 2^( 4) =       0.000401986710
  error estimate for blocks of size 2^( 5) =       0.000407577497
  error estimate for blocks of size 2^( 6) =       0.000411023352
  error estimate for blocks of size 2^( 7) =       0.000410911711

      target function =      -0.945446380285
              le_mean =     -17.211314075634
             les_mean =     296.508997667459
             stat err =       0.000407874817
             autocorr =       1.246625542072
   target nu stat err =       0.000407874817
   target dn stat err =       0.002012915446
      target stat err =       0.003458162800
              std dev =       0.516623169814
             le_variance =       0.266899499588


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945446380296        initial  <--
     9.7656e+03     9.7656e+04             2.2063e-08        -0.945446380126
     3.9062e+04     3.9062e+05             5.5159e-09        -0.945446380213
     1.5625e+05     1.5625e+06             1.3790e-09        -0.945446380285

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 24.1012
  </log>
  <optVariables href="H2O.s025.opt.xml">
ci_001                -4.191509e-02 3 1  ON 0
ci_002                -3.210171e-02 3 1  ON 1
ci_003                -2.646894e-02 3 1  ON 2
ci_004                 2.374395e-02 3 1  ON 3
ci_005                 2.413172e-02 3 1  ON 4
ci_006                -2.146954e-02 3 1  ON 5
ci_007                -2.109089e-02 3 1  ON 6
ci_008                -8.497794e-03 3 1  ON 7
ci_009                -1.373936e-02 3 1  ON 8
ci_010                -1.009165e-02 3 1  ON 9
ci_011                -1.135868e-02 3 1  ON 10
ci_012                -9.745133e-03 3 1  ON 11
ci_013                -1.985945e-02 3 1  ON 12
ci_014                 1.227715e-02 3 1  ON 13
ci_015                 1.189205e-02 3 1  ON 14
ci_016                 1.754165e-02 3 1  ON 15
ci_017                 1.638294e-02 3 1  ON 16
ci_018                 1.026045e-02 3 1  ON 17
ci_019                 1.008161e-02 3 1  ON 18
ci_020                 1.790549e-02 3 1  ON 19
ci_021                 1.749568e-02 3 1  ON 20
ci_022                 9.162751e-03 3 1  ON 21
ci_023                 9.144713e-03 3 1  ON 22
ci_024                 9.632156e-03 3 1  ON 23
ci_025                 1.023142e-02 3 1  ON 24
ci_026                 1.169150e-02 3 1  ON 25
ci_027                 1.176482e-02 3 1  ON 26
ci_028                -1.470914e-02 3 1  ON 27
ci_029                -1.654865e-02 3 1  ON 28
ci_030                -9.566283e-03 3 1  ON 29
ci_031                -8.981262e-03 3 1  ON 30
ci_032                -1.469643e-02 3 1  ON 31
ci_033                 5.187635e-03 3 1  ON 32
ci_034                 5.608401e-03 3 1  ON 33
ci_035                -5.095943e-03 3 1  ON 34
ci_036                -1.278635e-02 3 1  ON 35
ci_037                -1.233457e-02 3 1  ON 36
ci_038                 2.133175e-03 3 1  ON 37
ci_039                 1.733023e-03 3 1  ON 38
ci_040                -3.227574e-03 3 1  ON 39
ci_041                 9.568204e-03 3 1  ON 40
ci_042                 8.198039e-03 3 1  ON 41
ci_043                -4.123702e-03 3 1  ON 42
ci_044                -3.876058e-03 3 1  ON 43
ci_045                -3.602532e-03 3 1  ON 44
ci_046                 5.640902e-03 3 1  ON 45
ci_047                 5.518869e-03 3 1  ON 46
ci_048                -1.262295e-02 3 1  ON 47
ci_049                -1.447592e-02 3 1  ON 48
ci_050                 3.118626e-03 3 1  ON 49
ci_051                 2.765954e-03 3 1  ON 50
ci_052                -2.297639e-03 3 1  ON 51
ci_053                -2.436001e-03 3 1  ON 52
ci_054                -3.407503e-03 3 1  ON 53
ci_055                -2.979093e-03 3 1  ON 54
ci_056                 5.594351e-03 3 1  ON 55
ci_057                 5.303125e-03 3 1  ON 56
ci_058                -9.913393e-04 3 1  ON 57
ci_059                -2.293530e-03 3 1  ON 58
ci_060                 4.604718e-03 3 1  ON 59
ci_061                 5.719363e-03 3 1  ON 60
ci_062                -3.727874e-03 3 1  ON 61
ci_063                -4.030901e-03 3 1  ON 62
ci_064                -2.554510e-03 3 1  ON 63
ci_065                -4.361765e-03 3 1  ON 64
ci_066                 4.436634e-03 3 1  ON 65
ci_067                 4.359640e-03 3 1  ON 66
ci_068                -4.183701e-03 3 1  ON 67
ci_069                -5.046447e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3276e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.1568
    reference variance = 0.177464
====================================================
  Execution time = 1.4541e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5274e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7729e-01
  Total weights = 1.957419691e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5171e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267018451181
                                         uncertainty =       0.001297697827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267018451181
                                         uncertainty =       0.001297697827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365397013
  error estimate for blocks of size 2^( 2) =       0.000379245949
  error estimate for blocks of size 2^( 3) =       0.000392127785
  error estimate for blocks of size 2^( 4) =       0.000401745772
  error estimate for blocks of size 2^( 5) =       0.000408054032
  error estimate for blocks of size 2^( 6) =       0.000411812618
  error estimate for blocks of size 2^( 7) =       0.000412987602

      target function =      -0.949460253405
              le_mean =     -17.211446502874
             les_mean =     296.511179691393
             stat err =       0.000408650006
             autocorr =       1.250757265055
   target nu stat err =       0.000408650006
   target dn stat err =       0.001803803303
      target stat err =       0.003142445518
              std dev =       0.516749411348
             le_variance =       0.267029954129


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721144650287e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949469547410       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949469548067       residual = 3.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949469548203       residual = 5.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949469548231       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949469548091       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949469548310       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949469548207       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949469548274       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949469548242       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949469548309       residual = 7.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+04 is 1.734300e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949469547410       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949469547574       residual = 3.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949469547608       residual = 5.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949469547221       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949469547942       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949469548074       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949469548362       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949469547364       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949469547409       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949469546996       residual = 7.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+05 is 4.335752e-10

solving harmonic davidson linear method for identity shift 1.5625e+06, overlap shift 1.5625e+07 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949469547410       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949469547451       residual = 3.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949469547459       residual = 5.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949469547461       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949469547013       residual = 2.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949469547462       residual = 4.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949469547496       residual = 9.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949469546590       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949469549695       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949469549347       residual = 7.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5625e+06 is 1.083938e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.107863 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7066e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_001                -4.191509e-02 3 1  ON 0
ci_002                -3.210171e-02 3 1  ON 1
ci_003                -2.646894e-02 3 1  ON 2
ci_004                 2.374395e-02 3 1  ON 3
ci_005                 2.413172e-02 3 1  ON 4
ci_006                -2.146954e-02 3 1  ON 5
ci_007                -2.109089e-02 3 1  ON 6
ci_008                -8.497794e-03 3 1  ON 7
ci_009                -1.373936e-02 3 1  ON 8
ci_010                -1.009165e-02 3 1  ON 9
ci_011                -1.135868e-02 3 1  ON 10
ci_012                -9.745133e-03 3 1  ON 11
ci_013                -1.985945e-02 3 1  ON 12
ci_014                 1.227715e-02 3 1  ON 13
ci_015                 1.189205e-02 3 1  ON 14
ci_016                 1.754165e-02 3 1  ON 15
ci_017                 1.638294e-02 3 1  ON 16
ci_018                 1.026045e-02 3 1  ON 17
ci_019                 1.008161e-02 3 1  ON 18
ci_020                 1.790549e-02 3 1  ON 19
ci_021                 1.749568e-02 3 1  ON 20
ci_022                 9.162751e-03 3 1  ON 21
ci_023                 9.144713e-03 3 1  ON 22
ci_024                 9.632156e-03 3 1  ON 23
ci_025                 1.023142e-02 3 1  ON 24
ci_026                 1.169150e-02 3 1  ON 25
ci_027                 1.176482e-02 3 1  ON 26
ci_028                -1.470914e-02 3 1  ON 27
ci_029                -1.654865e-02 3 1  ON 28
ci_030                -9.566282e-03 3 1  ON 29
ci_031                -8.981262e-03 3 1  ON 30
ci_032                -1.469643e-02 3 1  ON 31
ci_033                 5.187635e-03 3 1  ON 32
ci_034                 5.608401e-03 3 1  ON 33
ci_035                -5.095943e-03 3 1  ON 34
ci_036                -1.278635e-02 3 1  ON 35
ci_037                -1.233457e-02 3 1  ON 36
ci_038                 2.133175e-03 3 1  ON 37
ci_039                 1.733023e-03 3 1  ON 38
ci_040                -3.227574e-03 3 1  ON 39
ci_041                 9.568204e-03 3 1  ON 40
ci_042                 8.198039e-03 3 1  ON 41
ci_043                -4.123702e-03 3 1  ON 42
ci_044                -3.876058e-03 3 1  ON 43
ci_045                -3.602532e-03 3 1  ON 44
ci_046                 5.640902e-03 3 1  ON 45
ci_047                 5.518869e-03 3 1  ON 46
ci_048                -1.262295e-02 3 1  ON 47
ci_049                -1.447592e-02 3 1  ON 48
ci_050                 3.118625e-03 3 1  ON 49
ci_051                 2.765954e-03 3 1  ON 50
ci_052                -2.297639e-03 3 1  ON 51
ci_053                -2.436001e-03 3 1  ON 52
ci_054                -3.407503e-03 3 1  ON 53
ci_055                -2.979093e-03 3 1  ON 54
ci_056                 5.594351e-03 3 1  ON 55
ci_057                 5.303125e-03 3 1  ON 56
ci_058                -9.913394e-04 3 1  ON 57
ci_059                -2.293530e-03 3 1  ON 58
ci_060                 4.604718e-03 3 1  ON 59
ci_061                 5.719363e-03 3 1  ON 60
ci_062                -3.727874e-03 3 1  ON 61
ci_063                -4.030901e-03 3 1  ON 62
ci_064                -2.554510e-03 3 1  ON 63
ci_065                -4.361765e-03 3 1  ON 64
ci_066                 4.436634e-03 3 1  ON 65
ci_067                 4.359640e-03 3 1  ON 66
ci_068                -4.183701e-03 3 1  ON 67
ci_069                -5.046447e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2625
    reference variance = 0.162116
====================================================
  Execution time = 1.4247e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7667e-01
  Total weights = 1.9575e+06
  Execution time = 1.8512e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267109369430
                                         uncertainty =       0.001230075650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267109369430
                                         uncertainty =       0.001230075650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365485597
  error estimate for blocks of size 2^( 2) =       0.000379346378
  error estimate for blocks of size 2^( 3) =       0.000391825766
  error estimate for blocks of size 2^( 4) =       0.000401435533
  error estimate for blocks of size 2^( 5) =       0.000406607529
  error estimate for blocks of size 2^( 6) =       0.000410172730
  error estimate for blocks of size 2^( 7) =       0.000411250200

      target function =      -0.950512367622
              le_mean =     -17.211964525947
             les_mean =     296.528397587402
             stat err =       0.000407366498
             autocorr =       1.242310300779
   target nu stat err =       0.000407366498
   target dn stat err =       0.001779025137
      target stat err =       0.003110797964
              std dev =       0.516874687427
             le_variance =       0.267159442503

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267109368949
                                         uncertainty =       0.001230075653

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267109368949
                                         uncertainty =       0.001230075653

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365485596
  error estimate for blocks of size 2^( 2) =       0.000379346378
  error estimate for blocks of size 2^( 3) =       0.000391825766
  error estimate for blocks of size 2^( 4) =       0.000401435533
  error estimate for blocks of size 2^( 5) =       0.000406607529
  error estimate for blocks of size 2^( 6) =       0.000410172730
  error estimate for blocks of size 2^( 7) =       0.000411250200

      target function =      -0.950512370432
              le_mean =     -17.211964525959
             les_mean =     296.528397586135
             stat err =       0.000407366498
             autocorr =       1.242310302223
   target nu stat err =       0.000407366498
   target dn stat err =       0.001779025119
      target stat err =       0.003110797951
              std dev =       0.516874686964
             le_variance =       0.267159442024

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267109369190
                                         uncertainty =       0.001230075652

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267109369190
                                         uncertainty =       0.001230075652

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365485596
  error estimate for blocks of size 2^( 2) =       0.000379346378
  error estimate for blocks of size 2^( 3) =       0.000391825766
  error estimate for blocks of size 2^( 4) =       0.000401435533
  error estimate for blocks of size 2^( 5) =       0.000406607529
  error estimate for blocks of size 2^( 6) =       0.000410172730
  error estimate for blocks of size 2^( 7) =       0.000411250200

      target function =      -0.950512369027
              le_mean =     -17.211964525953
             les_mean =     296.528397586768
             stat err =       0.000407366498
             autocorr =       1.242310301500
   target nu stat err =       0.000407366498
   target dn stat err =       0.001779025128
      target stat err =       0.003110797957
              std dev =       0.516874687196
             le_variance =       0.267159442264

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267109369400
                                         uncertainty =       0.001230075650

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267109369400
                                         uncertainty =       0.001230075650

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365485596
  error estimate for blocks of size 2^( 2) =       0.000379346378
  error estimate for blocks of size 2^( 3) =       0.000391825766
  error estimate for blocks of size 2^( 4) =       0.000401435533
  error estimate for blocks of size 2^( 5) =       0.000406607529
  error estimate for blocks of size 2^( 6) =       0.000410172730
  error estimate for blocks of size 2^( 7) =       0.000411250200

      target function =      -0.950512367798
              le_mean =     -17.211964525948
             les_mean =     296.528397587323
             stat err =       0.000407366498
             autocorr =       1.242310300871
   target nu stat err =       0.000407366498
   target dn stat err =       0.001779025136
      target stat err =       0.003110797963
              std dev =       0.516874687398
             le_variance =       0.267159442473


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.950512367622        initial
     9.7656e+04     9.7656e+05             1.7343e-09        -0.950512370432  <--
     3.9062e+05     3.9062e+06             4.3358e-10        -0.950512369027
     1.5625e+06     1.5625e+07             1.0839e-10        -0.950512367798

*****************************************************************************
Applying the update for shift_i =   9.7656e+04     and shift_s =   9.7656e+05
*****************************************************************************

  Execution time = 2.3627e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
ci_001                -4.191509e-02 3 1  ON 0
ci_002                -3.210171e-02 3 1  ON 1
ci_003                -2.646894e-02 3 1  ON 2
ci_004                 2.374395e-02 3 1  ON 3
ci_005                 2.413172e-02 3 1  ON 4
ci_006                -2.146954e-02 3 1  ON 5
ci_007                -2.109089e-02 3 1  ON 6
ci_008                -8.497795e-03 3 1  ON 7
ci_009                -1.373936e-02 3 1  ON 8
ci_010                -1.009165e-02 3 1  ON 9
ci_011                -1.135868e-02 3 1  ON 10
ci_012                -9.745133e-03 3 1  ON 11
ci_013                -1.985945e-02 3 1  ON 12
ci_014                 1.227715e-02 3 1  ON 13
ci_015                 1.189205e-02 3 1  ON 14
ci_016                 1.754165e-02 3 1  ON 15
ci_017                 1.638294e-02 3 1  ON 16
ci_018                 1.026045e-02 3 1  ON 17
ci_019                 1.008161e-02 3 1  ON 18
ci_020                 1.790549e-02 3 1  ON 19
ci_021                 1.749568e-02 3 1  ON 20
ci_022                 9.162751e-03 3 1  ON 21
ci_023                 9.144712e-03 3 1  ON 22
ci_024                 9.632156e-03 3 1  ON 23
ci_025                 1.023142e-02 3 1  ON 24
ci_026                 1.169150e-02 3 1  ON 25
ci_027                 1.176482e-02 3 1  ON 26
ci_028                -1.470914e-02 3 1  ON 27
ci_029                -1.654865e-02 3 1  ON 28
ci_030                -9.566282e-03 3 1  ON 29
ci_031                -8.981262e-03 3 1  ON 30
ci_032                -1.469643e-02 3 1  ON 31
ci_033                 5.187636e-03 3 1  ON 32
ci_034                 5.608401e-03 3 1  ON 33
ci_035                -5.095943e-03 3 1  ON 34
ci_036                -1.278635e-02 3 1  ON 35
ci_037                -1.233457e-02 3 1  ON 36
ci_038                 2.133175e-03 3 1  ON 37
ci_039                 1.733023e-03 3 1  ON 38
ci_040                -3.227574e-03 3 1  ON 39
ci_041                 9.568203e-03 3 1  ON 40
ci_042                 8.198039e-03 3 1  ON 41
ci_043                -4.123702e-03 3 1  ON 42
ci_044                -3.876058e-03 3 1  ON 43
ci_045                -3.602532e-03 3 1  ON 44
ci_046                 5.640902e-03 3 1  ON 45
ci_047                 5.518869e-03 3 1  ON 46
ci_048                -1.262296e-02 3 1  ON 47
ci_049                -1.447591e-02 3 1  ON 48
ci_050                 3.118624e-03 3 1  ON 49
ci_051                 2.765954e-03 3 1  ON 50
ci_052                -2.297639e-03 3 1  ON 51
ci_053                -2.436002e-03 3 1  ON 52
ci_054                -3.407502e-03 3 1  ON 53
ci_055                -2.979092e-03 3 1  ON 54
ci_056                 5.594351e-03 3 1  ON 55
ci_057                 5.303124e-03 3 1  ON 56
ci_058                -9.913399e-04 3 1  ON 57
ci_059                -2.293529e-03 3 1  ON 58
ci_060                 4.604718e-03 3 1  ON 59
ci_061                 5.719362e-03 3 1  ON 60
ci_062                -3.727874e-03 3 1  ON 61
ci_063                -4.030900e-03 3 1  ON 62
ci_064                -2.554510e-03 3 1  ON 63
ci_065                -4.361765e-03 3 1  ON 64
ci_066                 4.436634e-03 3 1  ON 65
ci_067                 4.359640e-03 3 1  ON 66
ci_068                -4.183702e-03 3 1  ON 67
ci_069                -5.046447e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0700e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7218e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.233
    reference variance = 0.177632
====================================================
  Execution time = 1.4676e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5283e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8015e-01
  Total weights = 1.957094894e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5084e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269489727438
                                         uncertainty =       0.001510530596

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269489727438
                                         uncertainty =       0.001510530596

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367062487
  error estimate for blocks of size 2^( 2) =       0.000380955247
  error estimate for blocks of size 2^( 3) =       0.000394200837
  error estimate for blocks of size 2^( 4) =       0.000403484984
  error estimate for blocks of size 2^( 5) =       0.000408017787
  error estimate for blocks of size 2^( 6) =       0.000410066847
  error estimate for blocks of size 2^( 7) =       0.000413301194

      target function =      -0.944631766389
              le_mean =     -17.211929527162
             les_mean =     296.530672033206
             stat err =       0.000408717703
             autocorr =       1.239843563281
   target nu stat err =       0.000408717703
   target dn stat err =       0.001999253850
      target stat err =       0.003434227796
              std dev =       0.519104747594
             le_variance =       0.269469738975


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721192952716e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944643247310       residual = 8.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944643248837       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944643249101       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944643249148       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944643249160       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944643249132       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944643249127       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944643249129       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944643249178       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944643249160       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+04 is 6.454907e-09

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944643247310       residual = 8.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944643247692       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944643247758       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944643247773       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944643247712       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944643247817       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944643247810       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944643247768       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944643247775       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944643247805       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+04 is 1.613730e-09

solving harmonic davidson linear method for identity shift 3.9062e+05, overlap shift 3.9062e+06 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944643247310       residual = 8.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944643247406       residual = 1.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944643247422       residual = 4.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944643247466       residual = 5.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944643247067       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944643247175       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944643247556       residual = 6.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944643247340       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944643247603       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944643247582       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.9062e+05 is 4.034327e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.111315 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7193e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_001                -4.191509e-02 3 1  ON 0
ci_002                -3.210171e-02 3 1  ON 1
ci_003                -2.646894e-02 3 1  ON 2
ci_004                 2.374395e-02 3 1  ON 3
ci_005                 2.413172e-02 3 1  ON 4
ci_006                -2.146954e-02 3 1  ON 5
ci_007                -2.109089e-02 3 1  ON 6
ci_008                -8.497795e-03 3 1  ON 7
ci_009                -1.373936e-02 3 1  ON 8
ci_010                -1.009165e-02 3 1  ON 9
ci_011                -1.135868e-02 3 1  ON 10
ci_012                -9.745133e-03 3 1  ON 11
ci_013                -1.985945e-02 3 1  ON 12
ci_014                 1.227715e-02 3 1  ON 13
ci_015                 1.189205e-02 3 1  ON 14
ci_016                 1.754165e-02 3 1  ON 15
ci_017                 1.638294e-02 3 1  ON 16
ci_018                 1.026045e-02 3 1  ON 17
ci_019                 1.008160e-02 3 1  ON 18
ci_020                 1.790549e-02 3 1  ON 19
ci_021                 1.749568e-02 3 1  ON 20
ci_022                 9.162751e-03 3 1  ON 21
ci_023                 9.144713e-03 3 1  ON 22
ci_024                 9.632156e-03 3 1  ON 23
ci_025                 1.023142e-02 3 1  ON 24
ci_026                 1.169150e-02 3 1  ON 25
ci_027                 1.176482e-02 3 1  ON 26
ci_028                -1.470914e-02 3 1  ON 27
ci_029                -1.654865e-02 3 1  ON 28
ci_030                -9.566282e-03 3 1  ON 29
ci_031                -8.981263e-03 3 1  ON 30
ci_032                -1.469643e-02 3 1  ON 31
ci_033                 5.187637e-03 3 1  ON 32
ci_034                 5.608402e-03 3 1  ON 33
ci_035                -5.095942e-03 3 1  ON 34
ci_036                -1.278635e-02 3 1  ON 35
ci_037                -1.233457e-02 3 1  ON 36
ci_038                 2.133175e-03 3 1  ON 37
ci_039                 1.733023e-03 3 1  ON 38
ci_040                -3.227574e-03 3 1  ON 39
ci_041                 9.568203e-03 3 1  ON 40
ci_042                 8.198038e-03 3 1  ON 41
ci_043                -4.123702e-03 3 1  ON 42
ci_044                -3.876058e-03 3 1  ON 43
ci_045                -3.602531e-03 3 1  ON 44
ci_046                 5.640902e-03 3 1  ON 45
ci_047                 5.518869e-03 3 1  ON 46
ci_048                -1.262296e-02 3 1  ON 47
ci_049                -1.447591e-02 3 1  ON 48
ci_050                 3.118624e-03 3 1  ON 49
ci_051                 2.765955e-03 3 1  ON 50
ci_052                -2.297639e-03 3 1  ON 51
ci_053                -2.436001e-03 3 1  ON 52
ci_054                -3.407501e-03 3 1  ON 53
ci_055                -2.979093e-03 3 1  ON 54
ci_056                 5.594351e-03 3 1  ON 55
ci_057                 5.303124e-03 3 1  ON 56
ci_058                -9.913404e-04 3 1  ON 57
ci_059                -2.293529e-03 3 1  ON 58
ci_060                 4.604719e-03 3 1  ON 59
ci_061                 5.719361e-03 3 1  ON 60
ci_062                -3.727873e-03 3 1  ON 61
ci_063                -4.030900e-03 3 1  ON 62
ci_064                -2.554511e-03 3 1  ON 63
ci_065                -4.361765e-03 3 1  ON 64
ci_066                 4.436634e-03 3 1  ON 65
ci_067                 4.359640e-03 3 1  ON 66
ci_068                -4.183703e-03 3 1  ON 67
ci_069                -5.046447e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.115
    reference variance = 0.321396
====================================================
  Execution time = 1.4327e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7783e-01
  Total weights = 1.9575e+06
  Execution time = 1.8492e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267583822355
                                         uncertainty =       0.001448336504

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267583822355
                                         uncertainty =       0.001448336504

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365786860
  error estimate for blocks of size 2^( 2) =       0.000379760971
  error estimate for blocks of size 2^( 3) =       0.000392188908
  error estimate for blocks of size 2^( 4) =       0.000401685855
  error estimate for blocks of size 2^( 5) =       0.000406876149
  error estimate for blocks of size 2^( 6) =       0.000409996367
  error estimate for blocks of size 2^( 7) =       0.000411702192

      target function =      -0.948545354743
              le_mean =     -17.211993664747
             les_mean =     296.530558904028
             stat err =       0.000407565141
             autocorr =       1.241474671166
   target nu stat err =       0.000407565141
   target dn stat err =       0.002009805630
      target stat err =       0.003479558081
              std dev =       0.517300737758
             le_variance =       0.267600053285

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267583821297
                                         uncertainty =       0.001448336535

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267583821297
                                         uncertainty =       0.001448336535

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365786859
  error estimate for blocks of size 2^( 2) =       0.000379760970
  error estimate for blocks of size 2^( 3) =       0.000392188908
  error estimate for blocks of size 2^( 4) =       0.000401685855
  error estimate for blocks of size 2^( 5) =       0.000406876149
  error estimate for blocks of size 2^( 6) =       0.000409996368
  error estimate for blocks of size 2^( 7) =       0.000411702193

      target function =      -0.948545359590
              le_mean =     -17.211993664730
             les_mean =     296.530558900586
             stat err =       0.000407565141
             autocorr =       1.241474678542
   target nu stat err =       0.000407565141
   target dn stat err =       0.002009805007
      target stat err =       0.003479557084
              std dev =       0.517300736726
             le_variance =       0.267600052217

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267583821826
                                         uncertainty =       0.001448336519

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267583821826
                                         uncertainty =       0.001448336519

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365786859
  error estimate for blocks of size 2^( 2) =       0.000379760971
  error estimate for blocks of size 2^( 3) =       0.000392188908
  error estimate for blocks of size 2^( 4) =       0.000401685855
  error estimate for blocks of size 2^( 5) =       0.000406876149
  error estimate for blocks of size 2^( 6) =       0.000409996368
  error estimate for blocks of size 2^( 7) =       0.000411702193

      target function =      -0.948545357168
              le_mean =     -17.211993664739
             les_mean =     296.530558902306
             stat err =       0.000407565141
             autocorr =       1.241474674846
   target nu stat err =       0.000407565141
   target dn stat err =       0.002009805319
      target stat err =       0.003479557582
              std dev =       0.517300737242
             le_variance =       0.267600052751

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267583822289
                                         uncertainty =       0.001448336506

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267583822289
                                         uncertainty =       0.001448336506

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365786860
  error estimate for blocks of size 2^( 2) =       0.000379760971
  error estimate for blocks of size 2^( 3) =       0.000392188908
  error estimate for blocks of size 2^( 4) =       0.000401685855
  error estimate for blocks of size 2^( 5) =       0.000406876149
  error estimate for blocks of size 2^( 6) =       0.000409996368
  error estimate for blocks of size 2^( 7) =       0.000411702192

      target function =      -0.948545355046
              le_mean =     -17.211993664746
             les_mean =     296.530558903813
             stat err =       0.000407565141
             autocorr =       1.241474671622
   target nu stat err =       0.000407565141
   target dn stat err =       0.002009805591
      target stat err =       0.003479558018
              std dev =       0.517300737694
             le_variance =       0.267600053218


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948545354743        initial
     2.4414e+04     2.4414e+05             6.4549e-09        -0.948545359590  <--
     9.7656e+04     9.7656e+05             1.6137e-09        -0.948545357168
     3.9062e+05     3.9062e+06             4.0343e-10        -0.948545355046

*****************************************************************************
Applying the update for shift_i =   2.4414e+04     and shift_s =   2.4414e+05
*****************************************************************************

  Execution time = 2.3684e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
ci_001                -4.191508e-02 3 1  ON 0
ci_002                -3.210170e-02 3 1  ON 1
ci_003                -2.646894e-02 3 1  ON 2
ci_004                 2.374395e-02 3 1  ON 3
ci_005                 2.413172e-02 3 1  ON 4
ci_006                -2.146953e-02 3 1  ON 5
ci_007                -2.109089e-02 3 1  ON 6
ci_008                -8.497795e-03 3 1  ON 7
ci_009                -1.373936e-02 3 1  ON 8
ci_010                -1.009164e-02 3 1  ON 9
ci_011                -1.135868e-02 3 1  ON 10
ci_012                -9.745133e-03 3 1  ON 11
ci_013                -1.985945e-02 3 1  ON 12
ci_014                 1.227715e-02 3 1  ON 13
ci_015                 1.189205e-02 3 1  ON 14
ci_016                 1.754164e-02 3 1  ON 15
ci_017                 1.638294e-02 3 1  ON 16
ci_018                 1.026045e-02 3 1  ON 17
ci_019                 1.008160e-02 3 1  ON 18
ci_020                 1.790549e-02 3 1  ON 19
ci_021                 1.749568e-02 3 1  ON 20
ci_022                 9.162752e-03 3 1  ON 21
ci_023                 9.144714e-03 3 1  ON 22
ci_024                 9.632157e-03 3 1  ON 23
ci_025                 1.023142e-02 3 1  ON 24
ci_026                 1.169150e-02 3 1  ON 25
ci_027                 1.176482e-02 3 1  ON 26
ci_028                -1.470914e-02 3 1  ON 27
ci_029                -1.654865e-02 3 1  ON 28
ci_030                -9.566282e-03 3 1  ON 29
ci_031                -8.981265e-03 3 1  ON 30
ci_032                -1.469643e-02 3 1  ON 31
ci_033                 5.187639e-03 3 1  ON 32
ci_034                 5.608404e-03 3 1  ON 33
ci_035                -5.095941e-03 3 1  ON 34
ci_036                -1.278635e-02 3 1  ON 35
ci_037                -1.233457e-02 3 1  ON 36
ci_038                 2.133174e-03 3 1  ON 37
ci_039                 1.733023e-03 3 1  ON 38
ci_040                -3.227574e-03 3 1  ON 39
ci_041                 9.568202e-03 3 1  ON 40
ci_042                 8.198037e-03 3 1  ON 41
ci_043                -4.123701e-03 3 1  ON 42
ci_044                -3.876057e-03 3 1  ON 43
ci_045                -3.602530e-03 3 1  ON 44
ci_046                 5.640903e-03 3 1  ON 45
ci_047                 5.518869e-03 3 1  ON 46
ci_048                -1.262296e-02 3 1  ON 47
ci_049                -1.447591e-02 3 1  ON 48
ci_050                 3.118624e-03 3 1  ON 49
ci_051                 2.765955e-03 3 1  ON 50
ci_052                -2.297638e-03 3 1  ON 51
ci_053                -2.436000e-03 3 1  ON 52
ci_054                -3.407498e-03 3 1  ON 53
ci_055                -2.979095e-03 3 1  ON 54
ci_056                 5.594351e-03 3 1  ON 55
ci_057                 5.303124e-03 3 1  ON 56
ci_058                -9.913418e-04 3 1  ON 57
ci_059                -2.293529e-03 3 1  ON 58
ci_060                 4.604721e-03 3 1  ON 59
ci_061                 5.719358e-03 3 1  ON 60
ci_062                -3.727872e-03 3 1  ON 61
ci_063                -4.030897e-03 3 1  ON 62
ci_064                -2.554512e-03 3 1  ON 63
ci_065                -4.361764e-03 3 1  ON 64
ci_066                 4.436634e-03 3 1  ON 65
ci_067                 4.359641e-03 3 1  ON 66
ci_068                -4.183705e-03 3 1  ON 67
ci_069                -5.046448e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0883e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1539
    reference variance = 0.200548
====================================================
  Execution time = 1.6853e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8177e-01
  Total weights = 1.957263511e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5135e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267988733194
                                         uncertainty =       0.001352963695

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267988733194
                                         uncertainty =       0.001352963695

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366063579
  error estimate for blocks of size 2^( 2) =       0.000380040275
  error estimate for blocks of size 2^( 3) =       0.000392586745
  error estimate for blocks of size 2^( 4) =       0.000403234735
  error estimate for blocks of size 2^( 5) =       0.000408260349
  error estimate for blocks of size 2^( 6) =       0.000410018228
  error estimate for blocks of size 2^( 7) =       0.000411781945

      target function =      -0.941909111279
              le_mean =     -17.212197096808
             les_mean =     296.541502132301
             stat err =       0.000408323814
             autocorr =       1.244217704573
   target nu stat err =       0.000408323814
   target dn stat err =       0.002866814173
      target stat err =       0.004842258131
              std dev =       0.517692077774
             le_variance =       0.268005087390


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721219709681e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941932966776       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941932982293       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941932984856       residual = 7.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941932985625       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941932985765       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941932985795       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941932985785       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941932985787       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941932985780       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941932985796       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+03 is 3.523358e-08

solving harmonic davidson linear method for identity shift 2.4414e+04, overlap shift 2.4414e+05 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941932966776       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941932970655       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941932971296       residual = 7.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941932971489       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941932971516       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941932971564       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941932971545       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941932971577       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941932971590       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941932971527       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+04 is 8.808469e-09

solving harmonic davidson linear method for identity shift 9.7656e+04, overlap shift 9.7656e+05 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941932966776       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941932967746       residual = 3.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941932967906       residual = 7.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941932967971       residual = 1.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941932967925       residual = 2.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941932967971       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941932967889       residual = 6.32e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941932968028       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941932967932       residual = 2.92e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941932967962       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+04 is 2.202122e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.114739 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9380e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_001                -4.191508e-02 3 1  ON 0
ci_002                -3.210170e-02 3 1  ON 1
ci_003                -2.646894e-02 3 1  ON 2
ci_004                 2.374395e-02 3 1  ON 3
ci_005                 2.413171e-02 3 1  ON 4
ci_006                -2.146953e-02 3 1  ON 5
ci_007                -2.109088e-02 3 1  ON 6
ci_008                -8.497795e-03 3 1  ON 7
ci_009                -1.373936e-02 3 1  ON 8
ci_010                -1.009164e-02 3 1  ON 9
ci_011                -1.135868e-02 3 1  ON 10
ci_012                -9.745137e-03 3 1  ON 11
ci_013                -1.985945e-02 3 1  ON 12
ci_014                 1.227715e-02 3 1  ON 13
ci_015                 1.189205e-02 3 1  ON 14
ci_016                 1.754164e-02 3 1  ON 15
ci_017                 1.638294e-02 3 1  ON 16
ci_018                 1.026046e-02 3 1  ON 17
ci_019                 1.008160e-02 3 1  ON 18
ci_020                 1.790549e-02 3 1  ON 19
ci_021                 1.749568e-02 3 1  ON 20
ci_022                 9.162749e-03 3 1  ON 21
ci_023                 9.144713e-03 3 1  ON 22
ci_024                 9.632154e-03 3 1  ON 23
ci_025                 1.023142e-02 3 1  ON 24
ci_026                 1.169150e-02 3 1  ON 25
ci_027                 1.176481e-02 3 1  ON 26
ci_028                -1.470914e-02 3 1  ON 27
ci_029                -1.654865e-02 3 1  ON 28
ci_030                -9.566279e-03 3 1  ON 29
ci_031                -8.981267e-03 3 1  ON 30
ci_032                -1.469643e-02 3 1  ON 31
ci_033                 5.187644e-03 3 1  ON 32
ci_034                 5.608405e-03 3 1  ON 33
ci_035                -5.095940e-03 3 1  ON 34
ci_036                -1.278634e-02 3 1  ON 35
ci_037                -1.233457e-02 3 1  ON 36
ci_038                 2.133170e-03 3 1  ON 37
ci_039                 1.733022e-03 3 1  ON 38
ci_040                -3.227573e-03 3 1  ON 39
ci_041                 9.568199e-03 3 1  ON 40
ci_042                 8.198040e-03 3 1  ON 41
ci_043                -4.123700e-03 3 1  ON 42
ci_044                -3.876052e-03 3 1  ON 43
ci_045                -3.602529e-03 3 1  ON 44
ci_046                 5.640904e-03 3 1  ON 45
ci_047                 5.518870e-03 3 1  ON 46
ci_048                -1.262296e-02 3 1  ON 47
ci_049                -1.447590e-02 3 1  ON 48
ci_050                 3.118621e-03 3 1  ON 49
ci_051                 2.765955e-03 3 1  ON 50
ci_052                -2.297635e-03 3 1  ON 51
ci_053                -2.435999e-03 3 1  ON 52
ci_054                -3.407493e-03 3 1  ON 53
ci_055                -2.979092e-03 3 1  ON 54
ci_056                 5.594348e-03 3 1  ON 55
ci_057                 5.303124e-03 3 1  ON 56
ci_058                -9.913453e-04 3 1  ON 57
ci_059                -2.293530e-03 3 1  ON 58
ci_060                 4.604720e-03 3 1  ON 59
ci_061                 5.719351e-03 3 1  ON 60
ci_062                -3.727873e-03 3 1  ON 61
ci_063                -4.030895e-03 3 1  ON 62
ci_064                -2.554516e-03 3 1  ON 63
ci_065                -4.361765e-03 3 1  ON 64
ci_066                 4.436636e-03 3 1  ON 65
ci_067                 4.359642e-03 3 1  ON 66
ci_068                -4.183706e-03 3 1  ON 67
ci_069                -5.046450e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2577
    reference variance = 0.190404
====================================================
  Execution time = 1.4475e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8622e-01
  Total weights = 1.9574e+06
  Execution time = 1.8598e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269936532510
                                         uncertainty =       0.001937111644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269936532510
                                         uncertainty =       0.001937111644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367372446
  error estimate for blocks of size 2^( 2) =       0.000381551461
  error estimate for blocks of size 2^( 3) =       0.000394216349
  error estimate for blocks of size 2^( 4) =       0.000403570178
  error estimate for blocks of size 2^( 5) =       0.000408943304
  error estimate for blocks of size 2^( 6) =       0.000412242468
  error estimate for blocks of size 2^( 7) =       0.000413119404

      target function =      -0.934529879165
              le_mean =     -17.211915716944
             les_mean =     296.536264219230
             stat err =       0.000409468839
             autocorr =       1.242305916598
   target nu stat err =       0.000409468839
   target dn stat err =       0.003512644975
      target stat err =       0.005816606469
              std dev =       0.519543095626
             le_variance =       0.269925028212

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269936529526
                                         uncertainty =       0.001937114988

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269936529526
                                         uncertainty =       0.001937114988

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367372444
  error estimate for blocks of size 2^( 2) =       0.000381551459
  error estimate for blocks of size 2^( 3) =       0.000394216347
  error estimate for blocks of size 2^( 4) =       0.000403570176
  error estimate for blocks of size 2^( 5) =       0.000408943302
  error estimate for blocks of size 2^( 6) =       0.000412242465
  error estimate for blocks of size 2^( 7) =       0.000413119403

      target function =      -0.934529857893
              le_mean =     -17.211915717082
             les_mean =     296.536264237145
             stat err =       0.000409468837
             autocorr =       1.242305918576
   target nu stat err =       0.000409468837
   target dn stat err =       0.003512628163
      target stat err =       0.005816578793
              std dev =       0.519543092692
             le_variance =       0.269925025164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269936531018
                                         uncertainty =       0.001937113316

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269936531018
                                         uncertainty =       0.001937113316

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367372445
  error estimate for blocks of size 2^( 2) =       0.000381551460
  error estimate for blocks of size 2^( 3) =       0.000394216348
  error estimate for blocks of size 2^( 4) =       0.000403570177
  error estimate for blocks of size 2^( 5) =       0.000408943303
  error estimate for blocks of size 2^( 6) =       0.000412242467
  error estimate for blocks of size 2^( 7) =       0.000413119404

      target function =      -0.934529868596
              le_mean =     -17.211915717013
             les_mean =     296.536264228146
             stat err =       0.000409468838
             autocorr =       1.242305917586
   target nu stat err =       0.000409468838
   target dn stat err =       0.003512636568
      target stat err =       0.005816592630
              std dev =       0.519543094159
             le_variance =       0.269925026688

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269936532324
                                         uncertainty =       0.001937111853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269936532324
                                         uncertainty =       0.001937111853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367372446
  error estimate for blocks of size 2^( 2) =       0.000381551461
  error estimate for blocks of size 2^( 3) =       0.000394216349
  error estimate for blocks of size 2^( 4) =       0.000403570178
  error estimate for blocks of size 2^( 5) =       0.000408943304
  error estimate for blocks of size 2^( 6) =       0.000412242467
  error estimate for blocks of size 2^( 7) =       0.000413119404

      target function =      -0.934529877851
              le_mean =     -17.211915716952
             les_mean =     296.536264220340
             stat err =       0.000409468838
             autocorr =       1.242305916721
   target nu stat err =       0.000409468838
   target dn stat err =       0.003512643924
      target stat err =       0.005816604739
              std dev =       0.519543095442
             le_variance =       0.269925028022


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.934529879165        initial  <--
     6.1035e+03     6.1035e+04             3.5234e-08        -0.934529857893
     2.4414e+04     2.4414e+05             8.8085e-09        -0.934529868596
     9.7656e+04     9.7656e+05             2.2021e-09        -0.934529877851

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.8757
  </log>
  <optVariables href="H2O.s028.opt.xml">
ci_001                -4.191508e-02 3 1  ON 0
ci_002                -3.210170e-02 3 1  ON 1
ci_003                -2.646894e-02 3 1  ON 2
ci_004                 2.374395e-02 3 1  ON 3
ci_005                 2.413172e-02 3 1  ON 4
ci_006                -2.146953e-02 3 1  ON 5
ci_007                -2.109089e-02 3 1  ON 6
ci_008                -8.497795e-03 3 1  ON 7
ci_009                -1.373936e-02 3 1  ON 8
ci_010                -1.009164e-02 3 1  ON 9
ci_011                -1.135868e-02 3 1  ON 10
ci_012                -9.745133e-03 3 1  ON 11
ci_013                -1.985945e-02 3 1  ON 12
ci_014                 1.227715e-02 3 1  ON 13
ci_015                 1.189205e-02 3 1  ON 14
ci_016                 1.754164e-02 3 1  ON 15
ci_017                 1.638294e-02 3 1  ON 16
ci_018                 1.026045e-02 3 1  ON 17
ci_019                 1.008160e-02 3 1  ON 18
ci_020                 1.790549e-02 3 1  ON 19
ci_021                 1.749568e-02 3 1  ON 20
ci_022                 9.162752e-03 3 1  ON 21
ci_023                 9.144714e-03 3 1  ON 22
ci_024                 9.632157e-03 3 1  ON 23
ci_025                 1.023142e-02 3 1  ON 24
ci_026                 1.169150e-02 3 1  ON 25
ci_027                 1.176482e-02 3 1  ON 26
ci_028                -1.470914e-02 3 1  ON 27
ci_029                -1.654865e-02 3 1  ON 28
ci_030                -9.566282e-03 3 1  ON 29
ci_031                -8.981265e-03 3 1  ON 30
ci_032                -1.469643e-02 3 1  ON 31
ci_033                 5.187639e-03 3 1  ON 32
ci_034                 5.608404e-03 3 1  ON 33
ci_035                -5.095941e-03 3 1  ON 34
ci_036                -1.278635e-02 3 1  ON 35
ci_037                -1.233457e-02 3 1  ON 36
ci_038                 2.133174e-03 3 1  ON 37
ci_039                 1.733023e-03 3 1  ON 38
ci_040                -3.227574e-03 3 1  ON 39
ci_041                 9.568202e-03 3 1  ON 40
ci_042                 8.198037e-03 3 1  ON 41
ci_043                -4.123701e-03 3 1  ON 42
ci_044                -3.876057e-03 3 1  ON 43
ci_045                -3.602530e-03 3 1  ON 44
ci_046                 5.640903e-03 3 1  ON 45
ci_047                 5.518869e-03 3 1  ON 46
ci_048                -1.262296e-02 3 1  ON 47
ci_049                -1.447591e-02 3 1  ON 48
ci_050                 3.118624e-03 3 1  ON 49
ci_051                 2.765955e-03 3 1  ON 50
ci_052                -2.297638e-03 3 1  ON 51
ci_053                -2.436000e-03 3 1  ON 52
ci_054                -3.407498e-03 3 1  ON 53
ci_055                -2.979095e-03 3 1  ON 54
ci_056                 5.594351e-03 3 1  ON 55
ci_057                 5.303124e-03 3 1  ON 56
ci_058                -9.913418e-04 3 1  ON 57
ci_059                -2.293529e-03 3 1  ON 58
ci_060                 4.604721e-03 3 1  ON 59
ci_061                 5.719358e-03 3 1  ON 60
ci_062                -3.727872e-03 3 1  ON 61
ci_063                -4.030897e-03 3 1  ON 62
ci_064                -2.554512e-03 3 1  ON 63
ci_065                -4.361764e-03 3 1  ON 64
ci_066                 4.436634e-03 3 1  ON 65
ci_067                 4.359641e-03 3 1  ON 66
ci_068                -4.183705e-03 3 1  ON 67
ci_069                -5.046448e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3261e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.2595
    reference variance = 0.517149
====================================================
  Execution time = 1.4764e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5296e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8180e-01
  Total weights = 1.957372680e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5038e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269937858888
                                         uncertainty =       0.001710111910

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269937858888
                                         uncertainty =       0.001710111910

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367395943
  error estimate for blocks of size 2^( 2) =       0.000381630475
  error estimate for blocks of size 2^( 3) =       0.000394048340
  error estimate for blocks of size 2^( 4) =       0.000403186999
  error estimate for blocks of size 2^( 5) =       0.000408801240
  error estimate for blocks of size 2^( 6) =       0.000412110820
  error estimate for blocks of size 2^( 7) =       0.000412482115

      target function =      -0.941862855807
              le_mean =     -17.211487466246
             les_mean =     296.517103704961
             stat err =       0.000409145294
             autocorr =       1.240184811376
   target nu stat err =       0.000409145294
   target dn stat err =       0.002562808866
      target stat err =       0.004334922684
              std dev =       0.519576324932
             le_variance =       0.269959557430


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721148746625e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941881659064       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941881660123       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941881660275       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941881660311       residual = 9.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941881660242       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941881660317       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941881660317       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941881660255       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941881660244       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941881660302       residual = 6.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+04 is 4.470437e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941881659064       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941881659329       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941881659367       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941881659379       residual = 9.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941881658965       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941881659285       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941881659677       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941881659232       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941881659452       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941881659604       residual = 6.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+05 is 1.117610e-09

solving harmonic davidson linear method for identity shift 9.7656e+05, overlap shift 9.7656e+06 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941881659064       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941881659130       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941881659140       residual = 5.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941881659142       residual = 9.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941881659142       residual = 2.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941881659921       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941881659030       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941881658235       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941881658982       residual = 2.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941881658553       residual = 6.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.7656e+05 is 2.794027e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.118203 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7276e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_001                -4.191508e-02 3 1  ON 0
ci_002                -3.210170e-02 3 1  ON 1
ci_003                -2.646894e-02 3 1  ON 2
ci_004                 2.374395e-02 3 1  ON 3
ci_005                 2.413172e-02 3 1  ON 4
ci_006                -2.146953e-02 3 1  ON 5
ci_007                -2.109089e-02 3 1  ON 6
ci_008                -8.497795e-03 3 1  ON 7
ci_009                -1.373936e-02 3 1  ON 8
ci_010                -1.009164e-02 3 1  ON 9
ci_011                -1.135868e-02 3 1  ON 10
ci_012                -9.745133e-03 3 1  ON 11
ci_013                -1.985945e-02 3 1  ON 12
ci_014                 1.227715e-02 3 1  ON 13
ci_015                 1.189205e-02 3 1  ON 14
ci_016                 1.754164e-02 3 1  ON 15
ci_017                 1.638294e-02 3 1  ON 16
ci_018                 1.026045e-02 3 1  ON 17
ci_019                 1.008160e-02 3 1  ON 18
ci_020                 1.790549e-02 3 1  ON 19
ci_021                 1.749568e-02 3 1  ON 20
ci_022                 9.162752e-03 3 1  ON 21
ci_023                 9.144714e-03 3 1  ON 22
ci_024                 9.632156e-03 3 1  ON 23
ci_025                 1.023142e-02 3 1  ON 24
ci_026                 1.169150e-02 3 1  ON 25
ci_027                 1.176482e-02 3 1  ON 26
ci_028                -1.470914e-02 3 1  ON 27
ci_029                -1.654865e-02 3 1  ON 28
ci_030                -9.566282e-03 3 1  ON 29
ci_031                -8.981265e-03 3 1  ON 30
ci_032                -1.469643e-02 3 1  ON 31
ci_033                 5.187639e-03 3 1  ON 32
ci_034                 5.608404e-03 3 1  ON 33
ci_035                -5.095941e-03 3 1  ON 34
ci_036                -1.278635e-02 3 1  ON 35
ci_037                -1.233457e-02 3 1  ON 36
ci_038                 2.133174e-03 3 1  ON 37
ci_039                 1.733023e-03 3 1  ON 38
ci_040                -3.227574e-03 3 1  ON 39
ci_041                 9.568202e-03 3 1  ON 40
ci_042                 8.198037e-03 3 1  ON 41
ci_043                -4.123701e-03 3 1  ON 42
ci_044                -3.876058e-03 3 1  ON 43
ci_045                -3.602530e-03 3 1  ON 44
ci_046                 5.640902e-03 3 1  ON 45
ci_047                 5.518869e-03 3 1  ON 46
ci_048                -1.262296e-02 3 1  ON 47
ci_049                -1.447591e-02 3 1  ON 48
ci_050                 3.118624e-03 3 1  ON 49
ci_051                 2.765955e-03 3 1  ON 50
ci_052                -2.297639e-03 3 1  ON 51
ci_053                -2.436000e-03 3 1  ON 52
ci_054                -3.407498e-03 3 1  ON 53
ci_055                -2.979095e-03 3 1  ON 54
ci_056                 5.594351e-03 3 1  ON 55
ci_057                 5.303124e-03 3 1  ON 56
ci_058                -9.913420e-04 3 1  ON 57
ci_059                -2.293529e-03 3 1  ON 58
ci_060                 4.604721e-03 3 1  ON 59
ci_061                 5.719357e-03 3 1  ON 60
ci_062                -3.727872e-03 3 1  ON 61
ci_063                -4.030897e-03 3 1  ON 62
ci_064                -2.554512e-03 3 1  ON 63
ci_065                -4.361765e-03 3 1  ON 64
ci_066                 4.436634e-03 3 1  ON 65
ci_067                 4.359641e-03 3 1  ON 66
ci_068                -4.183705e-03 3 1  ON 67
ci_069                -5.046448e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1094
    reference variance = 0.217826
====================================================
  Execution time = 1.4246e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7532e-01
  Total weights = 1.9575e+06
  Execution time = 1.8437e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265338503790
                                         uncertainty =       0.001328459841

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265338503790
                                         uncertainty =       0.001328459841

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364239846
  error estimate for blocks of size 2^( 2) =       0.000378467418
  error estimate for blocks of size 2^( 3) =       0.000391325474
  error estimate for blocks of size 2^( 4) =       0.000401027973
  error estimate for blocks of size 2^( 5) =       0.000406694977
  error estimate for blocks of size 2^( 6) =       0.000411212721
  error estimate for blocks of size 2^( 7) =       0.000413700356

      target function =      -0.952808715312
              le_mean =     -17.211221283336
             les_mean =     296.501454273852
             stat err =       0.000408159007
             autocorr =       1.255694120263
   target nu stat err =       0.000408159007
   target dn stat err =       0.001858285477
      target stat err =       0.003253003345
              std dev =       0.515112930454
             le_variance =       0.265341331121

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265338502979
                                         uncertainty =       0.001328459804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265338502979
                                         uncertainty =       0.001328459804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364239846
  error estimate for blocks of size 2^( 2) =       0.000378467418
  error estimate for blocks of size 2^( 3) =       0.000391325474
  error estimate for blocks of size 2^( 4) =       0.000401027973
  error estimate for blocks of size 2^( 5) =       0.000406694977
  error estimate for blocks of size 2^( 6) =       0.000411212721
  error estimate for blocks of size 2^( 7) =       0.000413700356

      target function =      -0.952808724405
              le_mean =     -17.211221283336
             les_mean =     296.501454268502
             stat err =       0.000408159007
             autocorr =       1.255694124041
   target nu stat err =       0.000408159007
   target dn stat err =       0.001858285337
      target stat err =       0.003253003172
              std dev =       0.515112929671
             le_variance =       0.265341330314

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265338503384
                                         uncertainty =       0.001328459822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265338503384
                                         uncertainty =       0.001328459822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364239846
  error estimate for blocks of size 2^( 2) =       0.000378467418
  error estimate for blocks of size 2^( 3) =       0.000391325474
  error estimate for blocks of size 2^( 4) =       0.000401027973
  error estimate for blocks of size 2^( 5) =       0.000406694977
  error estimate for blocks of size 2^( 6) =       0.000411212721
  error estimate for blocks of size 2^( 7) =       0.000413700356

      target function =      -0.952808719859
              le_mean =     -17.211221283336
             les_mean =     296.501454271176
             stat err =       0.000408159007
             autocorr =       1.255694122150
   target nu stat err =       0.000408159007
   target dn stat err =       0.001858285407
      target stat err =       0.003253003258
              std dev =       0.515112930062
             le_variance =       0.265341330717

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265338503739
                                         uncertainty =       0.001328459839

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265338503739
                                         uncertainty =       0.001328459839

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364239846
  error estimate for blocks of size 2^( 2) =       0.000378467418
  error estimate for blocks of size 2^( 3) =       0.000391325474
  error estimate for blocks of size 2^( 4) =       0.000401027973
  error estimate for blocks of size 2^( 5) =       0.000406694977
  error estimate for blocks of size 2^( 6) =       0.000411212721
  error estimate for blocks of size 2^( 7) =       0.000413700356

      target function =      -0.952808715881
              le_mean =     -17.211221283336
             les_mean =     296.501454273518
             stat err =       0.000408159007
             autocorr =       1.255694120491
   target nu stat err =       0.000408159007
   target dn stat err =       0.001858285468
      target stat err =       0.003253003334
              std dev =       0.515112930405
             le_variance =       0.265341331071


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.952808715312        initial
     6.1035e+04     6.1035e+05             4.4704e-09        -0.952808724405  <--
     2.4414e+05     2.4414e+06             1.1176e-09        -0.952808719859
     9.7656e+05     9.7656e+06             2.7940e-10        -0.952808715881

*****************************************************************************
Applying the update for shift_i =   6.1035e+04     and shift_s =   6.1035e+05
*****************************************************************************

  Execution time = 2.3625e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
ci_001                -4.191508e-02 3 1  ON 0
ci_002                -3.210170e-02 3 1  ON 1
ci_003                -2.646894e-02 3 1  ON 2
ci_004                 2.374395e-02 3 1  ON 3
ci_005                 2.413172e-02 3 1  ON 4
ci_006                -2.146953e-02 3 1  ON 5
ci_007                -2.109089e-02 3 1  ON 6
ci_008                -8.497796e-03 3 1  ON 7
ci_009                -1.373936e-02 3 1  ON 8
ci_010                -1.009164e-02 3 1  ON 9
ci_011                -1.135868e-02 3 1  ON 10
ci_012                -9.745134e-03 3 1  ON 11
ci_013                -1.985944e-02 3 1  ON 12
ci_014                 1.227715e-02 3 1  ON 13
ci_015                 1.189205e-02 3 1  ON 14
ci_016                 1.754164e-02 3 1  ON 15
ci_017                 1.638294e-02 3 1  ON 16
ci_018                 1.026045e-02 3 1  ON 17
ci_019                 1.008160e-02 3 1  ON 18
ci_020                 1.790549e-02 3 1  ON 19
ci_021                 1.749568e-02 3 1  ON 20
ci_022                 9.162751e-03 3 1  ON 21
ci_023                 9.144714e-03 3 1  ON 22
ci_024                 9.632155e-03 3 1  ON 23
ci_025                 1.023142e-02 3 1  ON 24
ci_026                 1.169150e-02 3 1  ON 25
ci_027                 1.176481e-02 3 1  ON 26
ci_028                -1.470914e-02 3 1  ON 27
ci_029                -1.654865e-02 3 1  ON 28
ci_030                -9.566281e-03 3 1  ON 29
ci_031                -8.981265e-03 3 1  ON 30
ci_032                -1.469643e-02 3 1  ON 31
ci_033                 5.187640e-03 3 1  ON 32
ci_034                 5.608402e-03 3 1  ON 33
ci_035                -5.095941e-03 3 1  ON 34
ci_036                -1.278635e-02 3 1  ON 35
ci_037                -1.233457e-02 3 1  ON 36
ci_038                 2.133173e-03 3 1  ON 37
ci_039                 1.733023e-03 3 1  ON 38
ci_040                -3.227573e-03 3 1  ON 39
ci_041                 9.568202e-03 3 1  ON 40
ci_042                 8.198037e-03 3 1  ON 41
ci_043                -4.123701e-03 3 1  ON 42
ci_044                -3.876059e-03 3 1  ON 43
ci_045                -3.602529e-03 3 1  ON 44
ci_046                 5.640902e-03 3 1  ON 45
ci_047                 5.518868e-03 3 1  ON 46
ci_048                -1.262296e-02 3 1  ON 47
ci_049                -1.447591e-02 3 1  ON 48
ci_050                 3.118625e-03 3 1  ON 49
ci_051                 2.765956e-03 3 1  ON 50
ci_052                -2.297639e-03 3 1  ON 51
ci_053                -2.435999e-03 3 1  ON 52
ci_054                -3.407497e-03 3 1  ON 53
ci_055                -2.979096e-03 3 1  ON 54
ci_056                 5.594351e-03 3 1  ON 55
ci_057                 5.303124e-03 3 1  ON 56
ci_058                -9.913424e-04 3 1  ON 57
ci_059                -2.293529e-03 3 1  ON 58
ci_060                 4.604721e-03 3 1  ON 59
ci_061                 5.719356e-03 3 1  ON 60
ci_062                -3.727872e-03 3 1  ON 61
ci_063                -4.030897e-03 3 1  ON 62
ci_064                -2.554512e-03 3 1  ON 63
ci_065                -4.361765e-03 3 1  ON 64
ci_066                 4.436634e-03 3 1  ON 65
ci_067                 4.359642e-03 3 1  ON 66
ci_068                -4.183705e-03 3 1  ON 67
ci_069                -5.046447e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0907e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.2149
    reference variance = 0.459723
====================================================
  Execution time = 1.4785e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8238e-01
  Total weights = 1.957417280e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5417e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266768893627
                                         uncertainty =       0.001437608562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266768893627
                                         uncertainty =       0.001437608562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365205713
  error estimate for blocks of size 2^( 2) =       0.000379066868
  error estimate for blocks of size 2^( 3) =       0.000391830375
  error estimate for blocks of size 2^( 4) =       0.000401736348
  error estimate for blocks of size 2^( 5) =       0.000407405029
  error estimate for blocks of size 2^( 6) =       0.000408987995
  error estimate for blocks of size 2^( 7) =       0.000411890055

      target function =      -0.940888896940
              le_mean =     -17.212934631087
             les_mean =     296.567494277686
             stat err =       0.000407504857
             autocorr =       1.245060493415
   target nu stat err =       0.000407504857
   target dn stat err =       0.003590605865
      target stat err =       0.006035480590
              std dev =       0.516478872391
             le_variance =       0.266750425626


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721293463109e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940926620372       residual = 6.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940926634256       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940926635549       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940926635855       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940926635910       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940926635928       residual = 9.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940926635925       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940926635923       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940926635924       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940926635925       residual = 7.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+04 is 1.629276e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940926620372       residual = 6.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940926623843       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940926624166       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940926624247       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940926624257       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940926624233       residual = 9.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940926624164       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940926624225       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940926624155       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940926624260       residual = 7.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+04 is 4.073207e-09

solving harmonic davidson linear method for identity shift 2.4414e+05, overlap shift 2.4414e+06 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940926620372       residual = 6.22e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940926621240       residual = 4.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940926621321       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940926621357       residual = 2.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940926621241       residual = 3.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940926621504       residual = 9.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940926621053       residual = 1.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940926621204       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940926621288       residual = 5.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940926621340       residual = 7.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.4414e+05 is 1.018303e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.121703 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7338e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_001                -4.191508e-02 3 1  ON 0
ci_002                -3.210170e-02 3 1  ON 1
ci_003                -2.646894e-02 3 1  ON 2
ci_004                 2.374395e-02 3 1  ON 3
ci_005                 2.413171e-02 3 1  ON 4
ci_006                -2.146953e-02 3 1  ON 5
ci_007                -2.109088e-02 3 1  ON 6
ci_008                -8.497797e-03 3 1  ON 7
ci_009                -1.373936e-02 3 1  ON 8
ci_010                -1.009164e-02 3 1  ON 9
ci_011                -1.135868e-02 3 1  ON 10
ci_012                -9.745132e-03 3 1  ON 11
ci_013                -1.985944e-02 3 1  ON 12
ci_014                 1.227715e-02 3 1  ON 13
ci_015                 1.189205e-02 3 1  ON 14
ci_016                 1.754164e-02 3 1  ON 15
ci_017                 1.638294e-02 3 1  ON 16
ci_018                 1.026045e-02 3 1  ON 17
ci_019                 1.008160e-02 3 1  ON 18
ci_020                 1.790549e-02 3 1  ON 19
ci_021                 1.749568e-02 3 1  ON 20
ci_022                 9.162754e-03 3 1  ON 21
ci_023                 9.144715e-03 3 1  ON 22
ci_024                 9.632158e-03 3 1  ON 23
ci_025                 1.023142e-02 3 1  ON 24
ci_026                 1.169149e-02 3 1  ON 25
ci_027                 1.176481e-02 3 1  ON 26
ci_028                -1.470914e-02 3 1  ON 27
ci_029                -1.654865e-02 3 1  ON 28
ci_030                -9.566281e-03 3 1  ON 29
ci_031                -8.981265e-03 3 1  ON 30
ci_032                -1.469643e-02 3 1  ON 31
ci_033                 5.187641e-03 3 1  ON 32
ci_034                 5.608404e-03 3 1  ON 33
ci_035                -5.095941e-03 3 1  ON 34
ci_036                -1.278635e-02 3 1  ON 35
ci_037                -1.233457e-02 3 1  ON 36
ci_038                 2.133173e-03 3 1  ON 37
ci_039                 1.733023e-03 3 1  ON 38
ci_040                -3.227572e-03 3 1  ON 39
ci_041                 9.568200e-03 3 1  ON 40
ci_042                 8.198038e-03 3 1  ON 41
ci_043                -4.123701e-03 3 1  ON 42
ci_044                -3.876057e-03 3 1  ON 43
ci_045                -3.602527e-03 3 1  ON 44
ci_046                 5.640902e-03 3 1  ON 45
ci_047                 5.518869e-03 3 1  ON 46
ci_048                -1.262296e-02 3 1  ON 47
ci_049                -1.447591e-02 3 1  ON 48
ci_050                 3.118623e-03 3 1  ON 49
ci_051                 2.765955e-03 3 1  ON 50
ci_052                -2.297640e-03 3 1  ON 51
ci_053                -2.436001e-03 3 1  ON 52
ci_054                -3.407495e-03 3 1  ON 53
ci_055                -2.979095e-03 3 1  ON 54
ci_056                 5.594350e-03 3 1  ON 55
ci_057                 5.303124e-03 3 1  ON 56
ci_058                -9.913446e-04 3 1  ON 57
ci_059                -2.293525e-03 3 1  ON 58
ci_060                 4.604722e-03 3 1  ON 59
ci_061                 5.719352e-03 3 1  ON 60
ci_062                -3.727872e-03 3 1  ON 61
ci_063                -4.030896e-03 3 1  ON 62
ci_064                -2.554513e-03 3 1  ON 63
ci_065                -4.361764e-03 3 1  ON 64
ci_066                 4.436635e-03 3 1  ON 65
ci_067                 4.359643e-03 3 1  ON 66
ci_068                -4.183707e-03 3 1  ON 67
ci_069                -5.046446e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1996
    reference variance = 0.364535
====================================================
  Execution time = 1.4179e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8175e-01
  Total weights = 1.9574e+06
  Execution time = 1.8482e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269236605798
                                         uncertainty =       0.001737973162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269236605798
                                         uncertainty =       0.001737973162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366873873
  error estimate for blocks of size 2^( 2) =       0.000380892888
  error estimate for blocks of size 2^( 3) =       0.000393265330
  error estimate for blocks of size 2^( 4) =       0.000402339059
  error estimate for blocks of size 2^( 5) =       0.000407984646
  error estimate for blocks of size 2^( 6) =       0.000410032171
  error estimate for blocks of size 2^( 7) =       0.000410939362

      target function =      -0.941950566434
              le_mean =     -17.212047739349
             les_mean =     296.536336187817
             stat err =       0.000407823809
             autocorr =       1.235695839129
   target nu stat err =       0.000407823809
   target dn stat err =       0.002804700653
      target stat err =       0.004738654730
              std dev =       0.518838007033
             le_variance =       0.269192877542

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269236602885
                                         uncertainty =       0.001737973412

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269236602885
                                         uncertainty =       0.001737973412

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366873871
  error estimate for blocks of size 2^( 2) =       0.000380892887
  error estimate for blocks of size 2^( 3) =       0.000393265328
  error estimate for blocks of size 2^( 4) =       0.000402339057
  error estimate for blocks of size 2^( 5) =       0.000407984644
  error estimate for blocks of size 2^( 6) =       0.000410032169
  error estimate for blocks of size 2^( 7) =       0.000410939359

      target function =      -0.941950595958
              le_mean =     -17.212047739346
             les_mean =     296.536336170058
             stat err =       0.000407823807
             autocorr =       1.235695841950
   target nu stat err =       0.000407823807
   target dn stat err =       0.002804698296
      target stat err =       0.004738651133
              std dev =       0.518838004233
             le_variance =       0.269192874637

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269236604341
                                         uncertainty =       0.001737973287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269236604341
                                         uncertainty =       0.001737973287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366873872
  error estimate for blocks of size 2^( 2) =       0.000380892888
  error estimate for blocks of size 2^( 3) =       0.000393265329
  error estimate for blocks of size 2^( 4) =       0.000402339058
  error estimate for blocks of size 2^( 5) =       0.000407984645
  error estimate for blocks of size 2^( 6) =       0.000410032170
  error estimate for blocks of size 2^( 7) =       0.000410939360

      target function =      -0.941950581198
              le_mean =     -17.212047739347
             les_mean =     296.536336178936
             stat err =       0.000407823808
             autocorr =       1.235695840529
   target nu stat err =       0.000407823808
   target dn stat err =       0.002804699474
      target stat err =       0.004738652932
              std dev =       0.518838005633
             le_variance =       0.269192876089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269236605616
                                         uncertainty =       0.001737973177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269236605616
                                         uncertainty =       0.001737973177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366873873
  error estimate for blocks of size 2^( 2) =       0.000380892888
  error estimate for blocks of size 2^( 3) =       0.000393265330
  error estimate for blocks of size 2^( 4) =       0.000402339059
  error estimate for blocks of size 2^( 5) =       0.000407984646
  error estimate for blocks of size 2^( 6) =       0.000410032171
  error estimate for blocks of size 2^( 7) =       0.000410939361

      target function =      -0.941950568279
              le_mean =     -17.212047739348
             les_mean =     296.536336186707
             stat err =       0.000407823809
             autocorr =       1.235695839298
   target nu stat err =       0.000407823809
   target dn stat err =       0.002804700506
      target stat err =       0.004738654505
              std dev =       0.518838006858
             le_variance =       0.269192877360


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.941950566434        initial
     1.5259e+04     1.5259e+05             1.6293e-08        -0.941950595958  <--
     6.1035e+04     6.1035e+05             4.0732e-09        -0.941950581198
     2.4414e+05     2.4414e+06             1.0183e-09        -0.941950568279

*****************************************************************************
Applying the update for shift_i =   1.5259e+04     and shift_s =   1.5259e+05
*****************************************************************************

  Execution time = 2.3558e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
ci_001                -4.191508e-02 3 1  ON 0
ci_002                -3.210170e-02 3 1  ON 1
ci_003                -2.646893e-02 3 1  ON 2
ci_004                 2.374395e-02 3 1  ON 3
ci_005                 2.413171e-02 3 1  ON 4
ci_006                -2.146953e-02 3 1  ON 5
ci_007                -2.109088e-02 3 1  ON 6
ci_008                -8.497801e-03 3 1  ON 7
ci_009                -1.373937e-02 3 1  ON 8
ci_010                -1.009163e-02 3 1  ON 9
ci_011                -1.135868e-02 3 1  ON 10
ci_012                -9.745128e-03 3 1  ON 11
ci_013                -1.985944e-02 3 1  ON 12
ci_014                 1.227714e-02 3 1  ON 13
ci_015                 1.189206e-02 3 1  ON 14
ci_016                 1.754163e-02 3 1  ON 15
ci_017                 1.638294e-02 3 1  ON 16
ci_018                 1.026046e-02 3 1  ON 17
ci_019                 1.008161e-02 3 1  ON 18
ci_020                 1.790548e-02 3 1  ON 19
ci_021                 1.749567e-02 3 1  ON 20
ci_022                 9.162763e-03 3 1  ON 21
ci_023                 9.144718e-03 3 1  ON 22
ci_024                 9.632165e-03 3 1  ON 23
ci_025                 1.023142e-02 3 1  ON 24
ci_026                 1.169148e-02 3 1  ON 25
ci_027                 1.176481e-02 3 1  ON 26
ci_028                -1.470914e-02 3 1  ON 27
ci_029                -1.654865e-02 3 1  ON 28
ci_030                -9.566281e-03 3 1  ON 29
ci_031                -8.981264e-03 3 1  ON 30
ci_032                -1.469643e-02 3 1  ON 31
ci_033                 5.187644e-03 3 1  ON 32
ci_034                 5.608407e-03 3 1  ON 33
ci_035                -5.095941e-03 3 1  ON 34
ci_036                -1.278635e-02 3 1  ON 35
ci_037                -1.233457e-02 3 1  ON 36
ci_038                 2.133171e-03 3 1  ON 37
ci_039                 1.733022e-03 3 1  ON 38
ci_040                -3.227570e-03 3 1  ON 39
ci_041                 9.568194e-03 3 1  ON 40
ci_042                 8.198040e-03 3 1  ON 41
ci_043                -4.123701e-03 3 1  ON 42
ci_044                -3.876051e-03 3 1  ON 43
ci_045                -3.602522e-03 3 1  ON 44
ci_046                 5.640899e-03 3 1  ON 45
ci_047                 5.518870e-03 3 1  ON 46
ci_048                -1.262296e-02 3 1  ON 47
ci_049                -1.447590e-02 3 1  ON 48
ci_050                 3.118618e-03 3 1  ON 49
ci_051                 2.765953e-03 3 1  ON 50
ci_052                -2.297643e-03 3 1  ON 51
ci_053                -2.436006e-03 3 1  ON 52
ci_054                -3.407490e-03 3 1  ON 53
ci_055                -2.979094e-03 3 1  ON 54
ci_056                 5.594346e-03 3 1  ON 55
ci_057                 5.303126e-03 3 1  ON 56
ci_058                -9.913513e-04 3 1  ON 57
ci_059                -2.293514e-03 3 1  ON 58
ci_060                 4.604724e-03 3 1  ON 59
ci_061                 5.719340e-03 3 1  ON 60
ci_062                -3.727871e-03 3 1  ON 61
ci_063                -4.030893e-03 3 1  ON 62
ci_064                -2.554516e-03 3 1  ON 63
ci_065                -4.361763e-03 3 1  ON 64
ci_066                 4.436635e-03 3 1  ON 65
ci_067                 4.359646e-03 3 1  ON 66
ci_068                -4.183712e-03 3 1  ON 67
ci_069                -5.046445e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0902e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.207
    reference variance = 0.175031
====================================================
  Execution time = 1.4770e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5299e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7884e-01
  Total weights = 1.957421276e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5176e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269137536398
                                         uncertainty =       0.001784426545

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269137536398
                                         uncertainty =       0.001784426545

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366813640
  error estimate for blocks of size 2^( 2) =       0.000380668342
  error estimate for blocks of size 2^( 3) =       0.000393141169
  error estimate for blocks of size 2^( 4) =       0.000402405410
  error estimate for blocks of size 2^( 5) =       0.000407643885
  error estimate for blocks of size 2^( 6) =       0.000410511341
  error estimate for blocks of size 2^( 7) =       0.000412601177

      target function =      -0.946847655396
              le_mean =     -17.212425753934
             les_mean =     296.546439568408
             stat err =       0.000408290453
             autocorr =       1.238932075199
   target nu stat err =       0.000408290453
   target dn stat err =       0.002162137103
      target stat err =       0.003722342404
              std dev =       0.518752824905
             le_variance =       0.269104493347


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721242575393e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946861119640       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946861136029       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946861138945       residual = 5.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946861139835       residual = 5.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946861139893       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946861139878       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946861139889       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946861139882       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946861139880       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946861139881       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+03 is 4.256921e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946861119640       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946861123738       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946861124467       residual = 5.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946861124689       residual = 5.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946861124703       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946861124708       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946861124702       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946861124699       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946861124700       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946861124700       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+04 is 1.064246e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946861119640       residual = 1.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946861120665       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946861120847       residual = 5.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946861120903       residual = 5.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946861120906       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946861120976       residual = 2.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946861120906       residual = 5.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946861120905       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946861120905       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946861120905       residual = 4.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 6.1035e+04 is 2.660625e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.125105 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7297e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_001                -4.191509e-02 3 1  ON 0
ci_002                -3.210170e-02 3 1  ON 1
ci_003                -2.646893e-02 3 1  ON 2
ci_004                 2.374395e-02 3 1  ON 3
ci_005                 2.413171e-02 3 1  ON 4
ci_006                -2.146953e-02 3 1  ON 5
ci_007                -2.109088e-02 3 1  ON 6
ci_008                -8.497800e-03 3 1  ON 7
ci_009                -1.373937e-02 3 1  ON 8
ci_010                -1.009164e-02 3 1  ON 9
ci_011                -1.135867e-02 3 1  ON 10
ci_012                -9.745131e-03 3 1  ON 11
ci_013                -1.985945e-02 3 1  ON 12
ci_014                 1.227714e-02 3 1  ON 13
ci_015                 1.189206e-02 3 1  ON 14
ci_016                 1.754163e-02 3 1  ON 15
ci_017                 1.638295e-02 3 1  ON 16
ci_018                 1.026045e-02 3 1  ON 17
ci_019                 1.008161e-02 3 1  ON 18
ci_020                 1.790548e-02 3 1  ON 19
ci_021                 1.749567e-02 3 1  ON 20
ci_022                 9.162763e-03 3 1  ON 21
ci_023                 9.144718e-03 3 1  ON 22
ci_024                 9.632168e-03 3 1  ON 23
ci_025                 1.023142e-02 3 1  ON 24
ci_026                 1.169148e-02 3 1  ON 25
ci_027                 1.176481e-02 3 1  ON 26
ci_028                -1.470914e-02 3 1  ON 27
ci_029                -1.654864e-02 3 1  ON 28
ci_030                -9.566276e-03 3 1  ON 29
ci_031                -8.981272e-03 3 1  ON 30
ci_032                -1.469643e-02 3 1  ON 31
ci_033                 5.187649e-03 3 1  ON 32
ci_034                 5.608407e-03 3 1  ON 33
ci_035                -5.095939e-03 3 1  ON 34
ci_036                -1.278635e-02 3 1  ON 35
ci_037                -1.233457e-02 3 1  ON 36
ci_038                 2.133165e-03 3 1  ON 37
ci_039                 1.733024e-03 3 1  ON 38
ci_040                -3.227571e-03 3 1  ON 39
ci_041                 9.568186e-03 3 1  ON 40
ci_042                 8.198043e-03 3 1  ON 41
ci_043                -4.123700e-03 3 1  ON 42
ci_044                -3.876056e-03 3 1  ON 43
ci_045                -3.602519e-03 3 1  ON 44
ci_046                 5.640899e-03 3 1  ON 45
ci_047                 5.518871e-03 3 1  ON 46
ci_048                -1.262296e-02 3 1  ON 47
ci_049                -1.447590e-02 3 1  ON 48
ci_050                 3.118615e-03 3 1  ON 49
ci_051                 2.765955e-03 3 1  ON 50
ci_052                -2.297645e-03 3 1  ON 51
ci_053                -2.436002e-03 3 1  ON 52
ci_054                -3.407485e-03 3 1  ON 53
ci_055                -2.979093e-03 3 1  ON 54
ci_056                 5.594344e-03 3 1  ON 55
ci_057                 5.303124e-03 3 1  ON 56
ci_058                -9.913494e-04 3 1  ON 57
ci_059                -2.293507e-03 3 1  ON 58
ci_060                 4.604726e-03 3 1  ON 59
ci_061                 5.719336e-03 3 1  ON 60
ci_062                -3.727874e-03 3 1  ON 61
ci_063                -4.030894e-03 3 1  ON 62
ci_064                -2.554522e-03 3 1  ON 63
ci_065                -4.361764e-03 3 1  ON 64
ci_066                 4.436635e-03 3 1  ON 65
ci_067                 4.359648e-03 3 1  ON 66
ci_068                -4.183718e-03 3 1  ON 67
ci_069                -5.046439e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2155
    reference variance = 0.22833
====================================================
  Execution time = 1.4326e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8639e-01
  Total weights = 1.9574e+06
  Execution time = 1.8522e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272716107215
                                         uncertainty =       0.001986787209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272716107215
                                         uncertainty =       0.001986787209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369278374
  error estimate for blocks of size 2^( 2) =       0.000383220328
  error estimate for blocks of size 2^( 3) =       0.000395832985
  error estimate for blocks of size 2^( 4) =       0.000405056381
  error estimate for blocks of size 2^( 5) =       0.000411412738
  error estimate for blocks of size 2^( 6) =       0.000414153391
  error estimate for blocks of size 2^( 7) =       0.000412615469

      target function =      -0.934245169911
              le_mean =     -17.212824209364
             les_mean =     296.567710065305
             stat err =       0.000410809495
             autocorr =       1.237579752901
   target nu stat err =       0.000410809495
   target dn stat err =       0.003039564805
      target stat err =       0.005052031366
              std dev =       0.522238484923
             le_variance =       0.272733035134

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272716091209
                                         uncertainty =       0.001986785970

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272716091209
                                         uncertainty =       0.001986785970

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369278363
  error estimate for blocks of size 2^( 2) =       0.000383220318
  error estimate for blocks of size 2^( 3) =       0.000395832976
  error estimate for blocks of size 2^( 4) =       0.000405056372
  error estimate for blocks of size 2^( 5) =       0.000411412730
  error estimate for blocks of size 2^( 6) =       0.000414153383
  error estimate for blocks of size 2^( 7) =       0.000412615462

      target function =      -0.934245254650
              le_mean =     -17.212824209339
             les_mean =     296.567710013098
             stat err =       0.000410809487
             autocorr =       1.237579775415
   target nu stat err =       0.000410809487
   target dn stat err =       0.003039548399
      target stat err =       0.005052005560
              std dev =       0.522238469637
             le_variance =       0.272733019168

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272716099212
                                         uncertainty =       0.001986786590

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272716099212
                                         uncertainty =       0.001986786590

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369278369
  error estimate for blocks of size 2^( 2) =       0.000383220323
  error estimate for blocks of size 2^( 3) =       0.000395832981
  error estimate for blocks of size 2^( 4) =       0.000405056377
  error estimate for blocks of size 2^( 5) =       0.000411412734
  error estimate for blocks of size 2^( 6) =       0.000414153387
  error estimate for blocks of size 2^( 7) =       0.000412615465

      target function =      -0.934245212289
              le_mean =     -17.212824209351
             les_mean =     296.567710039196
             stat err =       0.000410809491
             autocorr =       1.237579764162
   target nu stat err =       0.000410809491
   target dn stat err =       0.003039556601
      target stat err =       0.005052018463
              std dev =       0.522238477279
             le_variance =       0.272733027151

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272716106215
                                         uncertainty =       0.001986787132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272716106215
                                         uncertainty =       0.001986787132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369278373
  error estimate for blocks of size 2^( 2) =       0.000383220328
  error estimate for blocks of size 2^( 3) =       0.000395832985
  error estimate for blocks of size 2^( 4) =       0.000405056381
  error estimate for blocks of size 2^( 5) =       0.000411412738
  error estimate for blocks of size 2^( 6) =       0.000414153390
  error estimate for blocks of size 2^( 7) =       0.000412615469

      target function =      -0.934245175209
              le_mean =     -17.212824209362
             les_mean =     296.567710062041
             stat err =       0.000410809494
             autocorr =       1.237579754304
   target nu stat err =       0.000410809494
   target dn stat err =       0.003039563779
      target stat err =       0.005052029753
              std dev =       0.522238483967
             le_variance =       0.272733034136


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.934245169911        initial
     3.8147e+03     3.8147e+04             4.2569e-08        -0.934245254650  <--
     1.5259e+04     1.5259e+05             1.0642e-08        -0.934245212289
     6.1035e+04     6.1035e+05             2.6606e-09        -0.934245175209

*****************************************************************************
Applying the update for shift_i =   3.8147e+03     and shift_s =   3.8147e+04
*****************************************************************************

  Execution time = 2.3693e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
ci_001                -4.191509e-02 3 1  ON 0
ci_002                -3.210168e-02 3 1  ON 1
ci_003                -2.646891e-02 3 1  ON 2
ci_004                 2.374395e-02 3 1  ON 3
ci_005                 2.413171e-02 3 1  ON 4
ci_006                -2.146952e-02 3 1  ON 5
ci_007                -2.109087e-02 3 1  ON 6
ci_008                -8.497796e-03 3 1  ON 7
ci_009                -1.373938e-02 3 1  ON 8
ci_010                -1.009164e-02 3 1  ON 9
ci_011                -1.135863e-02 3 1  ON 10
ci_012                -9.745141e-03 3 1  ON 11
ci_013                -1.985946e-02 3 1  ON 12
ci_014                 1.227715e-02 3 1  ON 13
ci_015                 1.189207e-02 3 1  ON 14
ci_016                 1.754161e-02 3 1  ON 15
ci_017                 1.638295e-02 3 1  ON 16
ci_018                 1.026044e-02 3 1  ON 17
ci_019                 1.008162e-02 3 1  ON 18
ci_020                 1.790547e-02 3 1  ON 19
ci_021                 1.749566e-02 3 1  ON 20
ci_022                 9.162761e-03 3 1  ON 21
ci_023                 9.144716e-03 3 1  ON 22
ci_024                 9.632177e-03 3 1  ON 23
ci_025                 1.023141e-02 3 1  ON 24
ci_026                 1.169146e-02 3 1  ON 25
ci_027                 1.176481e-02 3 1  ON 26
ci_028                -1.470915e-02 3 1  ON 27
ci_029                -1.654861e-02 3 1  ON 28
ci_030                -9.566261e-03 3 1  ON 29
ci_031                -8.981293e-03 3 1  ON 30
ci_032                -1.469644e-02 3 1  ON 31
ci_033                 5.187665e-03 3 1  ON 32
ci_034                 5.608407e-03 3 1  ON 33
ci_035                -5.095935e-03 3 1  ON 34
ci_036                -1.278634e-02 3 1  ON 35
ci_037                -1.233456e-02 3 1  ON 36
ci_038                 2.133146e-03 3 1  ON 37
ci_039                 1.733027e-03 3 1  ON 38
ci_040                -3.227576e-03 3 1  ON 39
ci_041                 9.568162e-03 3 1  ON 40
ci_042                 8.198052e-03 3 1  ON 41
ci_043                -4.123695e-03 3 1  ON 42
ci_044                -3.876074e-03 3 1  ON 43
ci_045                -3.602512e-03 3 1  ON 44
ci_046                 5.640897e-03 3 1  ON 45
ci_047                 5.518876e-03 3 1  ON 46
ci_048                -1.262297e-02 3 1  ON 47
ci_049                -1.447588e-02 3 1  ON 48
ci_050                 3.118608e-03 3 1  ON 49
ci_051                 2.765961e-03 3 1  ON 50
ci_052                -2.297654e-03 3 1  ON 51
ci_053                -2.435990e-03 3 1  ON 52
ci_054                -3.407469e-03 3 1  ON 53
ci_055                -2.979091e-03 3 1  ON 54
ci_056                 5.594336e-03 3 1  ON 55
ci_057                 5.303118e-03 3 1  ON 56
ci_058                -9.913439e-04 3 1  ON 57
ci_059                -2.293489e-03 3 1  ON 58
ci_060                 4.604732e-03 3 1  ON 59
ci_061                 5.719321e-03 3 1  ON 60
ci_062                -3.727882e-03 3 1  ON 61
ci_063                -4.030894e-03 3 1  ON 62
ci_064                -2.554538e-03 3 1  ON 63
ci_065                -4.361766e-03 3 1  ON 64
ci_066                 4.436633e-03 3 1  ON 65
ci_067                 4.359653e-03 3 1  ON 66
ci_068                -4.183736e-03 3 1  ON 67
ci_069                -5.046423e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0996e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2403
    reference variance = 0.165285
====================================================
  Execution time = 1.6645e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8221e-01
  Total weights = 1.957398415e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5183e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270894498753
                                         uncertainty =       0.001577942674

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270894498753
                                         uncertainty =       0.001577942674

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368063587
  error estimate for blocks of size 2^( 2) =       0.000381850850
  error estimate for blocks of size 2^( 3) =       0.000394163677
  error estimate for blocks of size 2^( 4) =       0.000402702555
  error estimate for blocks of size 2^( 5) =       0.000408158977
  error estimate for blocks of size 2^( 6) =       0.000409796247
  error estimate for blocks of size 2^( 7) =       0.000410462028

      target function =      -0.941186074701
              le_mean =     -17.212774061109
             les_mean =     296.561802876439
             stat err =       0.000407779952
             autocorr =       1.227456277717
   target nu stat err =       0.000407779952
   target dn stat err =       0.002212561607
      target stat err =       0.003763619191
              std dev =       0.520520516502
             le_variance =       0.270941608099


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721277406111e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941200193498       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941200242880       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941200249828       residual = 4.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941200252423       residual = 7.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941200252755       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941200252797       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941200252892       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941200252921       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941200252937       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941200252939       residual = 6.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+02 is 1.725612e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941200193498       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941200205844       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941200207581       residual = 4.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941200208230       residual = 7.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941200208313       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941200208330       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941200208354       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941200208349       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941200208354       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941200208354       residual = 6.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+03 is 4.314257e-08

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941200193498       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941200196584       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941200197019       residual = 4.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941200197180       residual = 7.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941200197202       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941200197229       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941200197210       residual = 5.47e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941200197210       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941200197214       residual = 3.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941200197213       residual = 6.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.5259e+04 is 1.078579e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.128559 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.9172e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_001                -4.191508e-02 3 1  ON 0
ci_002                -3.210168e-02 3 1  ON 1
ci_003                -2.646888e-02 3 1  ON 2
ci_004                 2.374393e-02 3 1  ON 3
ci_005                 2.413169e-02 3 1  ON 4
ci_006                -2.146951e-02 3 1  ON 5
ci_007                -2.109087e-02 3 1  ON 6
ci_008                -8.497795e-03 3 1  ON 7
ci_009                -1.373939e-02 3 1  ON 8
ci_010                -1.009162e-02 3 1  ON 9
ci_011                -1.135862e-02 3 1  ON 10
ci_012                -9.745135e-03 3 1  ON 11
ci_013                -1.985945e-02 3 1  ON 12
ci_014                 1.227713e-02 3 1  ON 13
ci_015                 1.189207e-02 3 1  ON 14
ci_016                 1.754160e-02 3 1  ON 15
ci_017                 1.638296e-02 3 1  ON 16
ci_018                 1.026045e-02 3 1  ON 17
ci_019                 1.008162e-02 3 1  ON 18
ci_020                 1.790542e-02 3 1  ON 19
ci_021                 1.749564e-02 3 1  ON 20
ci_022                 9.162767e-03 3 1  ON 21
ci_023                 9.144724e-03 3 1  ON 22
ci_024                 9.632175e-03 3 1  ON 23
ci_025                 1.023139e-02 3 1  ON 24
ci_026                 1.169146e-02 3 1  ON 25
ci_027                 1.176479e-02 3 1  ON 26
ci_028                -1.470918e-02 3 1  ON 27
ci_029                -1.654860e-02 3 1  ON 28
ci_030                -9.566234e-03 3 1  ON 29
ci_031                -8.981291e-03 3 1  ON 30
ci_032                -1.469646e-02 3 1  ON 31
ci_033                 5.187670e-03 3 1  ON 32
ci_034                 5.608409e-03 3 1  ON 33
ci_035                -5.095928e-03 3 1  ON 34
ci_036                -1.278632e-02 3 1  ON 35
ci_037                -1.233454e-02 3 1  ON 36
ci_038                 2.133130e-03 3 1  ON 37
ci_039                 1.733028e-03 3 1  ON 38
ci_040                -3.227558e-03 3 1  ON 39
ci_041                 9.568140e-03 3 1  ON 40
ci_042                 8.198065e-03 3 1  ON 41
ci_043                -4.123688e-03 3 1  ON 42
ci_044                -3.876078e-03 3 1  ON 43
ci_045                -3.602500e-03 3 1  ON 44
ci_046                 5.640899e-03 3 1  ON 45
ci_047                 5.518882e-03 3 1  ON 46
ci_048                -1.262297e-02 3 1  ON 47
ci_049                -1.447585e-02 3 1  ON 48
ci_050                 3.118634e-03 3 1  ON 49
ci_051                 2.765964e-03 3 1  ON 50
ci_052                -2.297654e-03 3 1  ON 51
ci_053                -2.436014e-03 3 1  ON 52
ci_054                -3.407445e-03 3 1  ON 53
ci_055                -2.979091e-03 3 1  ON 54
ci_056                 5.594336e-03 3 1  ON 55
ci_057                 5.303120e-03 3 1  ON 56
ci_058                -9.913551e-04 3 1  ON 57
ci_059                -2.293484e-03 3 1  ON 58
ci_060                 4.604733e-03 3 1  ON 59
ci_061                 5.719320e-03 3 1  ON 60
ci_062                -3.727897e-03 3 1  ON 61
ci_063                -4.030879e-03 3 1  ON 62
ci_064                -2.554549e-03 3 1  ON 63
ci_065                -4.361762e-03 3 1  ON 64
ci_066                 4.436630e-03 3 1  ON 65
ci_067                 4.359647e-03 3 1  ON 66
ci_068                -4.183751e-03 3 1  ON 67
ci_069                -5.046404e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2353
    reference variance = 0.216649
====================================================
  Execution time = 1.4182e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8007e-01
  Total weights = 1.9578e+06
  Execution time = 1.8512e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268237102081
                                         uncertainty =       0.001510235167

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268237102081
                                         uncertainty =       0.001510235167

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366177816
  error estimate for blocks of size 2^( 2) =       0.000380192392
  error estimate for blocks of size 2^( 3) =       0.000392692523
  error estimate for blocks of size 2^( 4) =       0.000401712701
  error estimate for blocks of size 2^( 5) =       0.000406742495
  error estimate for blocks of size 2^( 6) =       0.000410622442
  error estimate for blocks of size 2^( 7) =       0.000410735039

      target function =      -0.944780618256
              le_mean =     -17.212212123052
             les_mean =     296.540312386978
             stat err =       0.000407453169
             autocorr =       1.238144523807
   target nu stat err =       0.000407453169
   target dn stat err =       0.002044343007
      target stat err =       0.003510737217
              std dev =       0.517853633156
             le_variance =       0.268172385373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268237039257
                                         uncertainty =       0.001510235507

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268237039257
                                         uncertainty =       0.001510235507

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366177773
  error estimate for blocks of size 2^( 2) =       0.000380192353
  error estimate for blocks of size 2^( 3) =       0.000392692491
  error estimate for blocks of size 2^( 4) =       0.000401712670
  error estimate for blocks of size 2^( 5) =       0.000406742467
  error estimate for blocks of size 2^( 6) =       0.000410622403
  error estimate for blocks of size 2^( 7) =       0.000410734995

      target function =      -0.944781478777
              le_mean =     -17.212212121920
             les_mean =     296.540311836459
             stat err =       0.000407453134
             autocorr =       1.238144597294
   target nu stat err =       0.000407453134
   target dn stat err =       0.002044261164
      target stat err =       0.003510608892
              std dev =       0.517853572622
             le_variance =       0.268172322678

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268237070666
                                         uncertainty =       0.001510235337

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268237070666
                                         uncertainty =       0.001510235337

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366177794
  error estimate for blocks of size 2^( 2) =       0.000380192373
  error estimate for blocks of size 2^( 3) =       0.000392692507
  error estimate for blocks of size 2^( 4) =       0.000401712686
  error estimate for blocks of size 2^( 5) =       0.000406742481
  error estimate for blocks of size 2^( 6) =       0.000410622423
  error estimate for blocks of size 2^( 7) =       0.000410735017

      target function =      -0.944781049068
              le_mean =     -17.212212122485
             les_mean =     296.540312111384
             stat err =       0.000407453152
             autocorr =       1.238144560550
   target nu stat err =       0.000407453152
   target dn stat err =       0.002044302056
      target stat err =       0.003510673010
              std dev =       0.517853602886
             le_variance =       0.268172354022

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268237098154
                                         uncertainty =       0.001510235188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268237098154
                                         uncertainty =       0.001510235188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366177813
  error estimate for blocks of size 2^( 2) =       0.000380192390
  error estimate for blocks of size 2^( 3) =       0.000392692521
  error estimate for blocks of size 2^( 4) =       0.000401712699
  error estimate for blocks of size 2^( 5) =       0.000406742493
  error estimate for blocks of size 2^( 6) =       0.000410622440
  error estimate for blocks of size 2^( 7) =       0.000410735036

      target function =      -0.944780672166
              le_mean =     -17.212212122981
             les_mean =     296.540312352493
             stat err =       0.000407453167
             autocorr =       1.238144528408
   target nu stat err =       0.000407453167
   target dn stat err =       0.002044337885
      target stat err =       0.003510729186
              std dev =       0.517853629372
             le_variance =       0.268172381454


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.944780618256        initial
     9.5367e+02     9.5367e+03             1.7256e-07        -0.944781478777  <--
     3.8147e+03     3.8147e+04             4.3143e-08        -0.944781049068
     1.5259e+04     1.5259e+05             1.0786e-08        -0.944780672166

*****************************************************************************
Applying the update for shift_i =   9.5367e+02     and shift_s =   9.5367e+03
*****************************************************************************

  Execution time = 2.3551e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
ci_001                -4.191506e-02 3 1  ON 0
ci_002                -3.210168e-02 3 1  ON 1
ci_003                -2.646879e-02 3 1  ON 2
ci_004                 2.374389e-02 3 1  ON 3
ci_005                 2.413165e-02 3 1  ON 4
ci_006                -2.146947e-02 3 1  ON 5
ci_007                -2.109087e-02 3 1  ON 6
ci_008                -8.497791e-03 3 1  ON 7
ci_009                -1.373942e-02 3 1  ON 8
ci_010                -1.009154e-02 3 1  ON 9
ci_011                -1.135857e-02 3 1  ON 10
ci_012                -9.745116e-03 3 1  ON 11
ci_013                -1.985939e-02 3 1  ON 12
ci_014                 1.227710e-02 3 1  ON 13
ci_015                 1.189209e-02 3 1  ON 14
ci_016                 1.754155e-02 3 1  ON 15
ci_017                 1.638297e-02 3 1  ON 16
ci_018                 1.026046e-02 3 1  ON 17
ci_019                 1.008164e-02 3 1  ON 18
ci_020                 1.790529e-02 3 1  ON 19
ci_021                 1.749557e-02 3 1  ON 20
ci_022                 9.162785e-03 3 1  ON 21
ci_023                 9.144750e-03 3 1  ON 22
ci_024                 9.632169e-03 3 1  ON 23
ci_025                 1.023133e-02 3 1  ON 24
ci_026                 1.169143e-02 3 1  ON 25
ci_027                 1.176475e-02 3 1  ON 26
ci_028                -1.470927e-02 3 1  ON 27
ci_029                -1.654856e-02 3 1  ON 28
ci_030                -9.566153e-03 3 1  ON 29
ci_031                -8.981286e-03 3 1  ON 30
ci_032                -1.469651e-02 3 1  ON 31
ci_033                 5.187684e-03 3 1  ON 32
ci_034                 5.608413e-03 3 1  ON 33
ci_035                -5.095910e-03 3 1  ON 34
ci_036                -1.278628e-02 3 1  ON 35
ci_037                -1.233450e-02 3 1  ON 36
ci_038                 2.133081e-03 3 1  ON 37
ci_039                 1.733033e-03 3 1  ON 38
ci_040                -3.227507e-03 3 1  ON 39
ci_041                 9.568072e-03 3 1  ON 40
ci_042                 8.198104e-03 3 1  ON 41
ci_043                -4.123666e-03 3 1  ON 42
ci_044                -3.876090e-03 3 1  ON 43
ci_045                -3.602464e-03 3 1  ON 44
ci_046                 5.640903e-03 3 1  ON 45
ci_047                 5.518898e-03 3 1  ON 46
ci_048                -1.262299e-02 3 1  ON 47
ci_049                -1.447577e-02 3 1  ON 48
ci_050                 3.118709e-03 3 1  ON 49
ci_051                 2.765976e-03 3 1  ON 50
ci_052                -2.297657e-03 3 1  ON 51
ci_053                -2.436084e-03 3 1  ON 52
ci_054                -3.407372e-03 3 1  ON 53
ci_055                -2.979089e-03 3 1  ON 54
ci_056                 5.594335e-03 3 1  ON 55
ci_057                 5.303125e-03 3 1  ON 56
ci_058                -9.913887e-04 3 1  ON 57
ci_059                -2.293471e-03 3 1  ON 58
ci_060                 4.604739e-03 3 1  ON 59
ci_061                 5.719317e-03 3 1  ON 60
ci_062                -3.727940e-03 3 1  ON 61
ci_063                -4.030834e-03 3 1  ON 62
ci_064                -2.554583e-03 3 1  ON 63
ci_065                -4.361749e-03 3 1  ON 64
ci_066                 4.436622e-03 3 1  ON 65
ci_067                 4.359630e-03 3 1  ON 66
ci_068                -4.183795e-03 3 1  ON 67
ci_069                -5.046346e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2729e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7215e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1227
    reference variance = 0.190278
====================================================
  Execution time = 1.4675e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7773e-01
  Total weights = 1.957396547e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5211e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265995626056
                                         uncertainty =       0.001412040855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265995626056
                                         uncertainty =       0.001412040855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364705016
  error estimate for blocks of size 2^( 2) =       0.000378584761
  error estimate for blocks of size 2^( 3) =       0.000391284560
  error estimate for blocks of size 2^( 4) =       0.000399523121
  error estimate for blocks of size 2^( 5) =       0.000405910679
  error estimate for blocks of size 2^( 6) =       0.000408692431
  error estimate for blocks of size 2^( 7) =       0.000409724752

      target function =      -0.948723826654
              le_mean =     -17.212030347242
             les_mean =     296.531716025365
             stat err =       0.000405962746
             autocorr =       1.239050167470
   target nu stat err =       0.000405962746
   target dn stat err =       0.002088221718
      target stat err =       0.003610500363
              std dev =       0.515770779333
             le_variance =       0.266019496814


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721203034724e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+02, overlap shift 2.3842e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948736507923       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948736784190       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948736817839       residual = 5.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948736830073       residual = 8.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948736831204       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948736831559       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948736831268       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948736831366       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948736831368       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948736831360       residual = 7.42e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+02 is 7.573213e-07

solving harmonic davidson linear method for identity shift 9.5367e+02, overlap shift 9.5367e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948736507923       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948736577008       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948736585422       residual = 5.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948736588480       residual = 8.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948736588764       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948736588851       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948736588779       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948736588804       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948736588804       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948736588802       residual = 7.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+02 is 1.893722e-07

solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948736507923       residual = 1.72e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948736525195       residual = 1.67e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948736527299       residual = 5.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948736528063       residual = 8.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948736528129       residual = 1.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948736528154       residual = 3.50e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948736528140       residual = 5.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948736528145       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948736528142       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948736528139       residual = 7.41e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+03 is 4.734567e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.132037 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7205e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_001                -4.191501e-02 3 1  ON 0
ci_002                -3.210167e-02 3 1  ON 1
ci_003                -2.646874e-02 3 1  ON 2
ci_004                 2.374392e-02 3 1  ON 3
ci_005                 2.413165e-02 3 1  ON 4
ci_006                -2.146941e-02 3 1  ON 5
ci_007                -2.109079e-02 3 1  ON 6
ci_008                -8.497822e-03 3 1  ON 7
ci_009                -1.373945e-02 3 1  ON 8
ci_010                -1.009155e-02 3 1  ON 9
ci_011                -1.135857e-02 3 1  ON 10
ci_012                -9.745054e-03 3 1  ON 11
ci_013                -1.985930e-02 3 1  ON 12
ci_014                 1.227708e-02 3 1  ON 13
ci_015                 1.189216e-02 3 1  ON 14
ci_016                 1.754146e-02 3 1  ON 15
ci_017                 1.638300e-02 3 1  ON 16
ci_018                 1.026043e-02 3 1  ON 17
ci_019                 1.008167e-02 3 1  ON 18
ci_020                 1.790519e-02 3 1  ON 19
ci_021                 1.749550e-02 3 1  ON 20
ci_022                 9.162778e-03 3 1  ON 21
ci_023                 9.144737e-03 3 1  ON 22
ci_024                 9.632114e-03 3 1  ON 23
ci_025                 1.023120e-02 3 1  ON 24
ci_026                 1.169130e-02 3 1  ON 25
ci_027                 1.176457e-02 3 1  ON 26
ci_028                -1.470928e-02 3 1  ON 27
ci_029                -1.654837e-02 3 1  ON 28
ci_030                -9.566148e-03 3 1  ON 29
ci_031                -8.981306e-03 3 1  ON 30
ci_032                -1.469649e-02 3 1  ON 31
ci_033                 5.187666e-03 3 1  ON 32
ci_034                 5.608345e-03 3 1  ON 33
ci_035                -5.095964e-03 3 1  ON 34
ci_036                -1.278628e-02 3 1  ON 35
ci_037                -1.233450e-02 3 1  ON 36
ci_038                 2.133112e-03 3 1  ON 37
ci_039                 1.733084e-03 3 1  ON 38
ci_040                -3.227502e-03 3 1  ON 39
ci_041                 9.568076e-03 3 1  ON 40
ci_042                 8.198167e-03 3 1  ON 41
ci_043                -4.123652e-03 3 1  ON 42
ci_044                -3.875989e-03 3 1  ON 43
ci_045                -3.602495e-03 3 1  ON 44
ci_046                 5.640922e-03 3 1  ON 45
ci_047                 5.518898e-03 3 1  ON 46
ci_048                -1.262309e-02 3 1  ON 47
ci_049                -1.447571e-02 3 1  ON 48
ci_050                 3.118736e-03 3 1  ON 49
ci_051                 2.766039e-03 3 1  ON 50
ci_052                -2.297730e-03 3 1  ON 51
ci_053                -2.436022e-03 3 1  ON 52
ci_054                -3.407342e-03 3 1  ON 53
ci_055                -2.979028e-03 3 1  ON 54
ci_056                 5.594354e-03 3 1  ON 55
ci_057                 5.303122e-03 3 1  ON 56
ci_058                -9.914622e-04 3 1  ON 57
ci_059                -2.293370e-03 3 1  ON 58
ci_060                 4.604750e-03 3 1  ON 59
ci_061                 5.719378e-03 3 1  ON 60
ci_062                -3.728004e-03 3 1  ON 61
ci_063                -4.030772e-03 3 1  ON 62
ci_064                -2.554633e-03 3 1  ON 63
ci_065                -4.361785e-03 3 1  ON 64
ci_066                 4.436598e-03 3 1  ON 65
ci_067                 4.359572e-03 3 1  ON 66
ci_068                -4.183883e-03 3 1  ON 67
ci_069                -5.046312e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.2103
    reference variance = 0.335232
====================================================
  Execution time = 1.4414e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7756e-01
  Total weights = 1.9572e+06
  Execution time = 1.8441e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266176299911
                                         uncertainty =       0.001363120289

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266176299911
                                         uncertainty =       0.001363120289

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364823628
  error estimate for blocks of size 2^( 2) =       0.000378805529
  error estimate for blocks of size 2^( 3) =       0.000391458529
  error estimate for blocks of size 2^( 4) =       0.000401375665
  error estimate for blocks of size 2^( 5) =       0.000406400782
  error estimate for blocks of size 2^( 6) =       0.000408467652
  error estimate for blocks of size 2^( 7) =       0.000409988885

      target function =      -0.949009724486
              le_mean =     -17.212421008358
             les_mean =     296.544998704925
             stat err =       0.000406558246
             autocorr =       1.241880000772
   target nu stat err =       0.000406558246
   target dn stat err =       0.002130867716
      target stat err =       0.003686389199
              std dev =       0.515938522154
             le_variance =       0.266192558643

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266176120372
                                         uncertainty =       0.001363114821

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266176120372
                                         uncertainty =       0.001363114821

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364823504
  error estimate for blocks of size 2^( 2) =       0.000378805412
  error estimate for blocks of size 2^( 3) =       0.000391458427
  error estimate for blocks of size 2^( 4) =       0.000401375580
  error estimate for blocks of size 2^( 5) =       0.000406400723
  error estimate for blocks of size 2^( 6) =       0.000408467591
  error estimate for blocks of size 2^( 7) =       0.000409988857

      target function =      -0.949009253127
              le_mean =     -17.212421010925
             les_mean =     296.544999071018
             stat err =       0.000406558188
             autocorr =       1.241880486502
   target nu stat err =       0.000406558188
   target dn stat err =       0.002130894478
      target stat err =       0.003686430106
              std dev =       0.515938347538
             le_variance =       0.266192378461

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266176210101
                                         uncertainty =       0.001363117554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266176210101
                                         uncertainty =       0.001363117554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364823566
  error estimate for blocks of size 2^( 2) =       0.000378805471
  error estimate for blocks of size 2^( 3) =       0.000391458478
  error estimate for blocks of size 2^( 4) =       0.000401375623
  error estimate for blocks of size 2^( 5) =       0.000406400753
  error estimate for blocks of size 2^( 6) =       0.000408467622
  error estimate for blocks of size 2^( 7) =       0.000409988871

      target function =      -0.949009493779
              le_mean =     -17.212421009639
             les_mean =     296.544998884947
             stat err =       0.000406558217
             autocorr =       1.241880243689
   target nu stat err =       0.000406558217
   target dn stat err =       0.002130881061
      target stat err =       0.003686409630
              std dev =       0.515938434807
             le_variance =       0.266192468511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266176288682
                                         uncertainty =       0.001363119947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266176288682
                                         uncertainty =       0.001363119947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364823620
  error estimate for blocks of size 2^( 2) =       0.000378805522
  error estimate for blocks of size 2^( 3) =       0.000391458522
  error estimate for blocks of size 2^( 4) =       0.000401375660
  error estimate for blocks of size 2^( 5) =       0.000406400779
  error estimate for blocks of size 2^( 6) =       0.000408467648
  error estimate for blocks of size 2^( 7) =       0.000409988883

      target function =      -0.949009696196
              le_mean =     -17.212421008518
             les_mean =     296.544998727093
             stat err =       0.000406558242
             autocorr =       1.241880031152
   target nu stat err =       0.000406558242
   target dn stat err =       0.002130869380
      target stat err =       0.003686391750
              std dev =       0.515938511233
             le_variance =       0.266192547374


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949009724486        initial  <--
     2.3842e+02     2.3842e+03             7.5732e-07        -0.949009253127
     9.5367e+02     9.5367e+03             1.8937e-07        -0.949009493779
     3.8147e+03     3.8147e+04             4.7346e-08        -0.949009696196

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.7480
  </log>
  <optVariables href="H2O.s033.opt.xml">
ci_001                -4.191506e-02 3 1  ON 0
ci_002                -3.210168e-02 3 1  ON 1
ci_003                -2.646879e-02 3 1  ON 2
ci_004                 2.374389e-02 3 1  ON 3
ci_005                 2.413165e-02 3 1  ON 4
ci_006                -2.146947e-02 3 1  ON 5
ci_007                -2.109087e-02 3 1  ON 6
ci_008                -8.497791e-03 3 1  ON 7
ci_009                -1.373942e-02 3 1  ON 8
ci_010                -1.009154e-02 3 1  ON 9
ci_011                -1.135857e-02 3 1  ON 10
ci_012                -9.745116e-03 3 1  ON 11
ci_013                -1.985939e-02 3 1  ON 12
ci_014                 1.227710e-02 3 1  ON 13
ci_015                 1.189209e-02 3 1  ON 14
ci_016                 1.754155e-02 3 1  ON 15
ci_017                 1.638297e-02 3 1  ON 16
ci_018                 1.026046e-02 3 1  ON 17
ci_019                 1.008164e-02 3 1  ON 18
ci_020                 1.790529e-02 3 1  ON 19
ci_021                 1.749557e-02 3 1  ON 20
ci_022                 9.162785e-03 3 1  ON 21
ci_023                 9.144750e-03 3 1  ON 22
ci_024                 9.632169e-03 3 1  ON 23
ci_025                 1.023133e-02 3 1  ON 24
ci_026                 1.169143e-02 3 1  ON 25
ci_027                 1.176475e-02 3 1  ON 26
ci_028                -1.470927e-02 3 1  ON 27
ci_029                -1.654856e-02 3 1  ON 28
ci_030                -9.566153e-03 3 1  ON 29
ci_031                -8.981286e-03 3 1  ON 30
ci_032                -1.469651e-02 3 1  ON 31
ci_033                 5.187684e-03 3 1  ON 32
ci_034                 5.608413e-03 3 1  ON 33
ci_035                -5.095910e-03 3 1  ON 34
ci_036                -1.278628e-02 3 1  ON 35
ci_037                -1.233450e-02 3 1  ON 36
ci_038                 2.133081e-03 3 1  ON 37
ci_039                 1.733033e-03 3 1  ON 38
ci_040                -3.227507e-03 3 1  ON 39
ci_041                 9.568072e-03 3 1  ON 40
ci_042                 8.198104e-03 3 1  ON 41
ci_043                -4.123666e-03 3 1  ON 42
ci_044                -3.876090e-03 3 1  ON 43
ci_045                -3.602464e-03 3 1  ON 44
ci_046                 5.640903e-03 3 1  ON 45
ci_047                 5.518898e-03 3 1  ON 46
ci_048                -1.262299e-02 3 1  ON 47
ci_049                -1.447577e-02 3 1  ON 48
ci_050                 3.118709e-03 3 1  ON 49
ci_051                 2.765976e-03 3 1  ON 50
ci_052                -2.297657e-03 3 1  ON 51
ci_053                -2.436084e-03 3 1  ON 52
ci_054                -3.407372e-03 3 1  ON 53
ci_055                -2.979089e-03 3 1  ON 54
ci_056                 5.594335e-03 3 1  ON 55
ci_057                 5.303125e-03 3 1  ON 56
ci_058                -9.913887e-04 3 1  ON 57
ci_059                -2.293471e-03 3 1  ON 58
ci_060                 4.604739e-03 3 1  ON 59
ci_061                 5.719317e-03 3 1  ON 60
ci_062                -3.727940e-03 3 1  ON 61
ci_063                -4.030834e-03 3 1  ON 62
ci_064                -2.554583e-03 3 1  ON 63
ci_065                -4.361749e-03 3 1  ON 64
ci_066                 4.436622e-03 3 1  ON 65
ci_067                 4.359630e-03 3 1  ON 66
ci_068                -4.183795e-03 3 1  ON 67
ci_069                -5.046346e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0959e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2045
    reference variance = 0.221344
====================================================
  Execution time = 1.4575e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5318e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8464e-01
  Total weights = 1.957091860e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5166e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268264024464
                                         uncertainty =       0.001958040034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268264024464
                                         uncertainty =       0.001958040034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366258550
  error estimate for blocks of size 2^( 2) =       0.000379937475
  error estimate for blocks of size 2^( 3) =       0.000392761361
  error estimate for blocks of size 2^( 4) =       0.000402342881
  error estimate for blocks of size 2^( 5) =       0.000408067231
  error estimate for blocks of size 2^( 6) =       0.000411343241
  error estimate for blocks of size 2^( 7) =       0.000414026790

      target function =      -0.936976868920
              le_mean =     -17.212370307354
             les_mean =     296.550332867812
             stat err =       0.000408945036
             autocorr =       1.246678122977
   target nu stat err =       0.000408945036
   target dn stat err =       0.008078272098
      target stat err =       0.013376680437
              std dev =       0.517967808613
             le_variance =       0.268290650759


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721237030735e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937165846787       residual = 4.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937165906705       residual = 4.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937165913413       residual = 7.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937165914805       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937165915008       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937165915097       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937165915091       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937165915094       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937165915091       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937165915091       residual = 8.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+03 is 7.959887e-08

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937165846787       residual = 4.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937165861767       residual = 4.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937165863444       residual = 7.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937165863792       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937165863842       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937165863863       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937165863864       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937165863865       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937165863855       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937165863864       residual = 8.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+03 is 1.990025e-08

solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937165846787       residual = 4.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937165850532       residual = 4.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937165850952       residual = 7.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937165851039       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937165851051       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937165851057       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937165851056       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937165851071       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937165851057       residual = 4.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937165851057       residual = 8.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.8147e+04 is 4.975095e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.135475 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7101e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_001                -4.191506e-02 3 1  ON 0
ci_002                -3.210167e-02 3 1  ON 1
ci_003                -2.646879e-02 3 1  ON 2
ci_004                 2.374389e-02 3 1  ON 3
ci_005                 2.413164e-02 3 1  ON 4
ci_006                -2.146946e-02 3 1  ON 5
ci_007                -2.109086e-02 3 1  ON 6
ci_008                -8.497804e-03 3 1  ON 7
ci_009                -1.373943e-02 3 1  ON 8
ci_010                -1.009153e-02 3 1  ON 9
ci_011                -1.135856e-02 3 1  ON 10
ci_012                -9.745121e-03 3 1  ON 11
ci_013                -1.985940e-02 3 1  ON 12
ci_014                 1.227710e-02 3 1  ON 13
ci_015                 1.189210e-02 3 1  ON 14
ci_016                 1.754154e-02 3 1  ON 15
ci_017                 1.638296e-02 3 1  ON 16
ci_018                 1.026046e-02 3 1  ON 17
ci_019                 1.008165e-02 3 1  ON 18
ci_020                 1.790528e-02 3 1  ON 19
ci_021                 1.749556e-02 3 1  ON 20
ci_022                 9.162790e-03 3 1  ON 21
ci_023                 9.144745e-03 3 1  ON 22
ci_024                 9.632175e-03 3 1  ON 23
ci_025                 1.023131e-02 3 1  ON 24
ci_026                 1.169143e-02 3 1  ON 25
ci_027                 1.176474e-02 3 1  ON 26
ci_028                -1.470928e-02 3 1  ON 27
ci_029                -1.654854e-02 3 1  ON 28
ci_030                -9.566161e-03 3 1  ON 29
ci_031                -8.981290e-03 3 1  ON 30
ci_032                -1.469651e-02 3 1  ON 31
ci_033                 5.187690e-03 3 1  ON 32
ci_034                 5.608415e-03 3 1  ON 33
ci_035                -5.095907e-03 3 1  ON 34
ci_036                -1.278627e-02 3 1  ON 35
ci_037                -1.233450e-02 3 1  ON 36
ci_038                 2.133077e-03 3 1  ON 37
ci_039                 1.733025e-03 3 1  ON 38
ci_040                -3.227509e-03 3 1  ON 39
ci_041                 9.568053e-03 3 1  ON 40
ci_042                 8.198114e-03 3 1  ON 41
ci_043                -4.123674e-03 3 1  ON 42
ci_044                -3.876081e-03 3 1  ON 43
ci_045                -3.602459e-03 3 1  ON 44
ci_046                 5.640900e-03 3 1  ON 45
ci_047                 5.518900e-03 3 1  ON 46
ci_048                -1.262298e-02 3 1  ON 47
ci_049                -1.447576e-02 3 1  ON 48
ci_050                 3.118716e-03 3 1  ON 49
ci_051                 2.765985e-03 3 1  ON 50
ci_052                -2.297670e-03 3 1  ON 51
ci_053                -2.436082e-03 3 1  ON 52
ci_054                -3.407365e-03 3 1  ON 53
ci_055                -2.979088e-03 3 1  ON 54
ci_056                 5.594326e-03 3 1  ON 55
ci_057                 5.303130e-03 3 1  ON 56
ci_058                -9.913974e-04 3 1  ON 57
ci_059                -2.293465e-03 3 1  ON 58
ci_060                 4.604745e-03 3 1  ON 59
ci_061                 5.719312e-03 3 1  ON 60
ci_062                -3.727942e-03 3 1  ON 61
ci_063                -4.030833e-03 3 1  ON 62
ci_064                -2.554591e-03 3 1  ON 63
ci_065                -4.361744e-03 3 1  ON 64
ci_066                 4.436625e-03 3 1  ON 65
ci_067                 4.359628e-03 3 1  ON 66
ci_068                -4.183790e-03 3 1  ON 67
ci_069                -5.046338e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1758
    reference variance = 0.25135
====================================================
  Execution time = 1.4159e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7735e-01
  Total weights = 1.9574e+06
  Execution time = 1.8580e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266703854139
                                         uncertainty =       0.001483076702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266703854139
                                         uncertainty =       0.001483076702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365203995
  error estimate for blocks of size 2^( 2) =       0.000379315190
  error estimate for blocks of size 2^( 3) =       0.000391938307
  error estimate for blocks of size 2^( 4) =       0.000401181676
  error estimate for blocks of size 2^( 5) =       0.000406477121
  error estimate for blocks of size 2^( 6) =       0.000409907097
  error estimate for blocks of size 2^( 7) =       0.000412017104

      target function =      -0.949354161078
              le_mean =     -17.211114061660
             les_mean =     296.499792758589
             stat err =       0.000407395749
             autocorr =       1.244405575977
   target nu stat err =       0.000407395749
   target dn stat err =       0.002147486637
      target stat err =       0.003707840105
              std dev =       0.516476442213
             le_variance =       0.266747915361

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266703822475
                                         uncertainty =       0.001483076784

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266703822475
                                         uncertainty =       0.001483076784

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365203973
  error estimate for blocks of size 2^( 2) =       0.000379315166
  error estimate for blocks of size 2^( 3) =       0.000391938281
  error estimate for blocks of size 2^( 4) =       0.000401181649
  error estimate for blocks of size 2^( 5) =       0.000406477092
  error estimate for blocks of size 2^( 6) =       0.000409907065
  error estimate for blocks of size 2^( 7) =       0.000412017073

      target function =      -0.949354236580
              le_mean =     -17.211114062033
             les_mean =     296.499792726844
             stat err =       0.000407395720
             autocorr =       1.244405542764
   target nu stat err =       0.000407395720
   target dn stat err =       0.002147483316
      target stat err =       0.003707835162
              std dev =       0.516476411651
             le_variance =       0.266747883792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266703838306
                                         uncertainty =       0.001483076743

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266703838306
                                         uncertainty =       0.001483076743

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365203984
  error estimate for blocks of size 2^( 2) =       0.000379315178
  error estimate for blocks of size 2^( 3) =       0.000391938294
  error estimate for blocks of size 2^( 4) =       0.000401181663
  error estimate for blocks of size 2^( 5) =       0.000406477106
  error estimate for blocks of size 2^( 6) =       0.000409907081
  error estimate for blocks of size 2^( 7) =       0.000412017088

      target function =      -0.949354198842
              le_mean =     -17.211114061846
             les_mean =     296.499792742707
             stat err =       0.000407395735
             autocorr =       1.244405559364
   target nu stat err =       0.000407395735
   target dn stat err =       0.002147484976
      target stat err =       0.003707837634
              std dev =       0.516476426931
             le_variance =       0.266747899576

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266703852160
                                         uncertainty =       0.001483076707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266703852160
                                         uncertainty =       0.001483076707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365203993
  error estimate for blocks of size 2^( 2) =       0.000379315189
  error estimate for blocks of size 2^( 3) =       0.000391938306
  error estimate for blocks of size 2^( 4) =       0.000401181675
  error estimate for blocks of size 2^( 5) =       0.000406477119
  error estimate for blocks of size 2^( 6) =       0.000409907095
  error estimate for blocks of size 2^( 7) =       0.000412017102

      target function =      -0.949354165800
              le_mean =     -17.211114061683
             les_mean =     296.499792756603
             stat err =       0.000407395748
             autocorr =       1.244405573911
   target nu stat err =       0.000407395748
   target dn stat err =       0.002147486429
      target stat err =       0.003707839797
              std dev =       0.516476440303
             le_variance =       0.266747913388


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949354161078        initial
     2.3842e+03     2.3842e+04             7.9599e-08        -0.949354236580  <--
     9.5367e+03     9.5367e+04             1.9900e-08        -0.949354198842
     3.8147e+04     3.8147e+05             4.9751e-09        -0.949354165800

*****************************************************************************
Applying the update for shift_i =   2.3842e+03     and shift_s =   2.3842e+04
*****************************************************************************

  Execution time = 2.3561e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
ci_001                -4.191505e-02 3 1  ON 0
ci_002                -3.210165e-02 3 1  ON 1
ci_003                -2.646880e-02 3 1  ON 2
ci_004                 2.374390e-02 3 1  ON 3
ci_005                 2.413163e-02 3 1  ON 4
ci_006                -2.146943e-02 3 1  ON 5
ci_007                -2.109086e-02 3 1  ON 6
ci_008                -8.497840e-03 3 1  ON 7
ci_009                -1.373946e-02 3 1  ON 8
ci_010                -1.009152e-02 3 1  ON 9
ci_011                -1.135853e-02 3 1  ON 10
ci_012                -9.745135e-03 3 1  ON 11
ci_013                -1.985942e-02 3 1  ON 12
ci_014                 1.227711e-02 3 1  ON 13
ci_015                 1.189214e-02 3 1  ON 14
ci_016                 1.754151e-02 3 1  ON 15
ci_017                 1.638296e-02 3 1  ON 16
ci_018                 1.026045e-02 3 1  ON 17
ci_019                 1.008170e-02 3 1  ON 18
ci_020                 1.790524e-02 3 1  ON 19
ci_021                 1.749553e-02 3 1  ON 20
ci_022                 9.162803e-03 3 1  ON 21
ci_023                 9.144729e-03 3 1  ON 22
ci_024                 9.632192e-03 3 1  ON 23
ci_025                 1.023128e-02 3 1  ON 24
ci_026                 1.169142e-02 3 1  ON 25
ci_027                 1.176470e-02 3 1  ON 26
ci_028                -1.470931e-02 3 1  ON 27
ci_029                -1.654850e-02 3 1  ON 28
ci_030                -9.566185e-03 3 1  ON 29
ci_031                -8.981300e-03 3 1  ON 30
ci_032                -1.469653e-02 3 1  ON 31
ci_033                 5.187708e-03 3 1  ON 32
ci_034                 5.608421e-03 3 1  ON 33
ci_035                -5.095898e-03 3 1  ON 34
ci_036                -1.278623e-02 3 1  ON 35
ci_037                -1.233449e-02 3 1  ON 36
ci_038                 2.133064e-03 3 1  ON 37
ci_039                 1.733002e-03 3 1  ON 38
ci_040                -3.227515e-03 3 1  ON 39
ci_041                 9.567993e-03 3 1  ON 40
ci_042                 8.198145e-03 3 1  ON 41
ci_043                -4.123697e-03 3 1  ON 42
ci_044                -3.876053e-03 3 1  ON 43
ci_045                -3.602443e-03 3 1  ON 44
ci_046                 5.640891e-03 3 1  ON 45
ci_047                 5.518904e-03 3 1  ON 46
ci_048                -1.262294e-02 3 1  ON 47
ci_049                -1.447573e-02 3 1  ON 48
ci_050                 3.118737e-03 3 1  ON 49
ci_051                 2.766014e-03 3 1  ON 50
ci_052                -2.297710e-03 3 1  ON 51
ci_053                -2.436076e-03 3 1  ON 52
ci_054                -3.407344e-03 3 1  ON 53
ci_055                -2.979086e-03 3 1  ON 54
ci_056                 5.594299e-03 3 1  ON 55
ci_057                 5.303147e-03 3 1  ON 56
ci_058                -9.914234e-04 3 1  ON 57
ci_059                -2.293447e-03 3 1  ON 58
ci_060                 4.604762e-03 3 1  ON 59
ci_061                 5.719297e-03 3 1  ON 60
ci_062                -3.727945e-03 3 1  ON 61
ci_063                -4.030830e-03 3 1  ON 62
ci_064                -2.554615e-03 3 1  ON 63
ci_065                -4.361729e-03 3 1  ON 64
ci_066                 4.436633e-03 3 1  ON 65
ci_067                 4.359621e-03 3 1  ON 66
ci_068                -4.183775e-03 3 1  ON 67
ci_069                -5.046313e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0667e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2018
    reference variance = 0.153077
====================================================
  Execution time = 1.4589e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7839e-01
  Total weights = 1.957324212e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.8651e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267770589674
                                         uncertainty =       0.001318397788

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267770589674
                                         uncertainty =       0.001318397788

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365908265
  error estimate for blocks of size 2^( 2) =       0.000379778578
  error estimate for blocks of size 2^( 3) =       0.000392437054
  error estimate for blocks of size 2^( 4) =       0.000401381739
  error estimate for blocks of size 2^( 5) =       0.000407195926
  error estimate for blocks of size 2^( 6) =       0.000410865537
  error estimate for blocks of size 2^( 7) =       0.000411699968

      target function =      -0.947600473148
              le_mean =     -17.211954313852
             les_mean =     296.529763353355
             stat err =       0.000407785792
             autocorr =       1.241994702858
   target nu stat err =       0.000407785792
   target dn stat err =       0.001902760780
      target stat err =       0.003295971652
              std dev =       0.517472430314
             le_variance =       0.267777716136


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721195431385e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947610989561       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947611095116       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947611108010       residual = 5.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947611112794       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947611113588       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947611113830       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947611113857       residual = 3.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947611113883       residual = 7.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947611113893       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947611113896       residual = 2.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+02 is 2.899606e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947610989561       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947611015952       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947611019176       residual = 5.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947611020373       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947611020569       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947611020633       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947611020638       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947611020644       residual = 7.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947611020643       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947611020648       residual = 2.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+03 is 7.249646e-08

solving harmonic davidson linear method for identity shift 9.5367e+03, overlap shift 9.5367e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947610989561       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947610996159       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947610996965       residual = 5.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947610997264       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947610997317       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947610997329       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947610997315       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947610997353       residual = 7.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947610997333       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947610997333       residual = 2.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.5367e+03 is 1.812451e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.139258 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.0541e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_001                -4.191505e-02 3 1  ON 0
ci_002                -3.210163e-02 3 1  ON 1
ci_003                -2.646876e-02 3 1  ON 2
ci_004                 2.374389e-02 3 1  ON 3
ci_005                 2.413159e-02 3 1  ON 4
ci_006                -2.146940e-02 3 1  ON 5
ci_007                -2.109086e-02 3 1  ON 6
ci_008                -8.497851e-03 3 1  ON 7
ci_009                -1.373951e-02 3 1  ON 8
ci_010                -1.009151e-02 3 1  ON 9
ci_011                -1.135849e-02 3 1  ON 10
ci_012                -9.745178e-03 3 1  ON 11
ci_013                -1.985942e-02 3 1  ON 12
ci_014                 1.227710e-02 3 1  ON 13
ci_015                 1.189217e-02 3 1  ON 14
ci_016                 1.754147e-02 3 1  ON 15
ci_017                 1.638297e-02 3 1  ON 16
ci_018                 1.026045e-02 3 1  ON 17
ci_019                 1.008173e-02 3 1  ON 18
ci_020                 1.790519e-02 3 1  ON 19
ci_021                 1.749552e-02 3 1  ON 20
ci_022                 9.162813e-03 3 1  ON 21
ci_023                 9.144699e-03 3 1  ON 22
ci_024                 9.632176e-03 3 1  ON 23
ci_025                 1.023123e-02 3 1  ON 24
ci_026                 1.169139e-02 3 1  ON 25
ci_027                 1.176470e-02 3 1  ON 26
ci_028                -1.470931e-02 3 1  ON 27
ci_029                -1.654845e-02 3 1  ON 28
ci_030                -9.566167e-03 3 1  ON 29
ci_031                -8.981321e-03 3 1  ON 30
ci_032                -1.469654e-02 3 1  ON 31
ci_033                 5.187708e-03 3 1  ON 32
ci_034                 5.608415e-03 3 1  ON 33
ci_035                -5.095887e-03 3 1  ON 34
ci_036                -1.278623e-02 3 1  ON 35
ci_037                -1.233451e-02 3 1  ON 36
ci_038                 2.133051e-03 3 1  ON 37
ci_039                 1.733004e-03 3 1  ON 38
ci_040                -3.227518e-03 3 1  ON 39
ci_041                 9.567941e-03 3 1  ON 40
ci_042                 8.198151e-03 3 1  ON 41
ci_043                -4.123699e-03 3 1  ON 42
ci_044                -3.876054e-03 3 1  ON 43
ci_045                -3.602432e-03 3 1  ON 44
ci_046                 5.640884e-03 3 1  ON 45
ci_047                 5.518929e-03 3 1  ON 46
ci_048                -1.262295e-02 3 1  ON 47
ci_049                -1.447566e-02 3 1  ON 48
ci_050                 3.118753e-03 3 1  ON 49
ci_051                 2.766016e-03 3 1  ON 50
ci_052                -2.297690e-03 3 1  ON 51
ci_053                -2.436063e-03 3 1  ON 52
ci_054                -3.407310e-03 3 1  ON 53
ci_055                -2.979078e-03 3 1  ON 54
ci_056                 5.594296e-03 3 1  ON 55
ci_057                 5.303155e-03 3 1  ON 56
ci_058                -9.914623e-04 3 1  ON 57
ci_059                -2.293426e-03 3 1  ON 58
ci_060                 4.604798e-03 3 1  ON 59
ci_061                 5.719264e-03 3 1  ON 60
ci_062                -3.727952e-03 3 1  ON 61
ci_063                -4.030837e-03 3 1  ON 62
ci_064                -2.554638e-03 3 1  ON 63
ci_065                -4.361723e-03 3 1  ON 64
ci_066                 4.436620e-03 3 1  ON 65
ci_067                 4.359629e-03 3 1  ON 66
ci_068                -4.183810e-03 3 1  ON 67
ci_069                -5.046297e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2319
    reference variance = 0.135733
====================================================
  Execution time = 1.4406e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7803e-01
  Total weights = 1.9574e+06
  Execution time = 1.8467e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266874419748
                                         uncertainty =       0.001502573870

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266874419748
                                         uncertainty =       0.001502573870

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365286162
  error estimate for blocks of size 2^( 2) =       0.000379166634
  error estimate for blocks of size 2^( 3) =       0.000391953268
  error estimate for blocks of size 2^( 4) =       0.000400789118
  error estimate for blocks of size 2^( 5) =       0.000405240771
  error estimate for blocks of size 2^( 6) =       0.000407421710
  error estimate for blocks of size 2^( 7) =       0.000407781300

      target function =      -0.948201773317
              le_mean =     -17.211585123670
             les_mean =     296.516695346592
             stat err =       0.000405308225
             autocorr =       1.231131358155
   target nu stat err =       0.000405308225
   target dn stat err =       0.001954411240
      target stat err =       0.003382040376
              std dev =       0.516592644052
             le_variance =       0.266867959889

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266874329989
                                         uncertainty =       0.001502571025

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266874329989
                                         uncertainty =       0.001502571025

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365286101
  error estimate for blocks of size 2^( 2) =       0.000379166576
  error estimate for blocks of size 2^( 3) =       0.000391953217
  error estimate for blocks of size 2^( 4) =       0.000400789070
  error estimate for blocks of size 2^( 5) =       0.000405240720
  error estimate for blocks of size 2^( 6) =       0.000407421671
  error estimate for blocks of size 2^( 7) =       0.000407781261

      target function =      -0.948202517031
              le_mean =     -17.211585126471
             les_mean =     296.516695003344
             stat err =       0.000405308180
             autocorr =       1.231131501939
   target nu stat err =       0.000405308180
   target dn stat err =       0.001954372123
      target stat err =       0.003381980958
              std dev =       0.516592557633
             le_variance =       0.266867870602

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266874374861
                                         uncertainty =       0.001502572448

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266874374861
                                         uncertainty =       0.001502572448

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365286131
  error estimate for blocks of size 2^( 2) =       0.000379166605
  error estimate for blocks of size 2^( 3) =       0.000391953242
  error estimate for blocks of size 2^( 4) =       0.000400789094
  error estimate for blocks of size 2^( 5) =       0.000405240745
  error estimate for blocks of size 2^( 6) =       0.000407421690
  error estimate for blocks of size 2^( 7) =       0.000407781280

      target function =      -0.948202145819
              le_mean =     -17.211585125070
             les_mean =     296.516695174581
             stat err =       0.000405308203
             autocorr =       1.231131430048
   target nu stat err =       0.000405308203
   target dn stat err =       0.001954391651
      target stat err =       0.003382010621
              std dev =       0.516592600835
             le_variance =       0.266867915238

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266874414136
                                         uncertainty =       0.001502573692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266874414136
                                         uncertainty =       0.001502573692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365286158
  error estimate for blocks of size 2^( 2) =       0.000379166630
  error estimate for blocks of size 2^( 3) =       0.000391953264
  error estimate for blocks of size 2^( 4) =       0.000400789115
  error estimate for blocks of size 2^( 5) =       0.000405240767
  error estimate for blocks of size 2^( 6) =       0.000407421707
  error estimate for blocks of size 2^( 7) =       0.000407781297

      target function =      -0.948201819948
              le_mean =     -17.211585123845
             les_mean =     296.516695325049
             stat err =       0.000405308222
             autocorr =       1.231131367128
   target nu stat err =       0.000405308222
   target dn stat err =       0.001954408788
      target stat err =       0.003382036652
              std dev =       0.516592638650
             le_variance =       0.266867954307


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948201773317        initial
     5.9605e+02     5.9605e+03             2.8996e-07        -0.948202517031  <--
     2.3842e+03     2.3842e+04             7.2496e-08        -0.948202145819
     9.5367e+03     9.5367e+04             1.8125e-08        -0.948201819948

*****************************************************************************
Applying the update for shift_i =   5.9605e+02     and shift_s =   5.9605e+03
*****************************************************************************

  Execution time = 2.3771e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
ci_001                -4.191506e-02 3 1  ON 0
ci_002                -3.210159e-02 3 1  ON 1
ci_003                -2.646867e-02 3 1  ON 2
ci_004                 2.374388e-02 3 1  ON 3
ci_005                 2.413147e-02 3 1  ON 4
ci_006                -2.146931e-02 3 1  ON 5
ci_007                -2.109087e-02 3 1  ON 6
ci_008                -8.497885e-03 3 1  ON 7
ci_009                -1.373967e-02 3 1  ON 8
ci_010                -1.009147e-02 3 1  ON 9
ci_011                -1.135838e-02 3 1  ON 10
ci_012                -9.745307e-03 3 1  ON 11
ci_013                -1.985942e-02 3 1  ON 12
ci_014                 1.227707e-02 3 1  ON 13
ci_015                 1.189224e-02 3 1  ON 14
ci_016                 1.754138e-02 3 1  ON 15
ci_017                 1.638303e-02 3 1  ON 16
ci_018                 1.026043e-02 3 1  ON 17
ci_019                 1.008181e-02 3 1  ON 18
ci_020                 1.790505e-02 3 1  ON 19
ci_021                 1.749547e-02 3 1  ON 20
ci_022                 9.162843e-03 3 1  ON 21
ci_023                 9.144611e-03 3 1  ON 22
ci_024                 9.632130e-03 3 1  ON 23
ci_025                 1.023108e-02 3 1  ON 24
ci_026                 1.169131e-02 3 1  ON 25
ci_027                 1.176468e-02 3 1  ON 26
ci_028                -1.470933e-02 3 1  ON 27
ci_029                -1.654828e-02 3 1  ON 28
ci_030                -9.566113e-03 3 1  ON 29
ci_031                -8.981382e-03 3 1  ON 30
ci_032                -1.469657e-02 3 1  ON 31
ci_033                 5.187708e-03 3 1  ON 32
ci_034                 5.608395e-03 3 1  ON 33
ci_035                -5.095852e-03 3 1  ON 34
ci_036                -1.278626e-02 3 1  ON 35
ci_037                -1.233455e-02 3 1  ON 36
ci_038                 2.133012e-03 3 1  ON 37
ci_039                 1.733008e-03 3 1  ON 38
ci_040                -3.227528e-03 3 1  ON 39
ci_041                 9.567787e-03 3 1  ON 40
ci_042                 8.198171e-03 3 1  ON 41
ci_043                -4.123704e-03 3 1  ON 42
ci_044                -3.876055e-03 3 1  ON 43
ci_045                -3.602398e-03 3 1  ON 44
ci_046                 5.640863e-03 3 1  ON 45
ci_047                 5.519001e-03 3 1  ON 46
ci_048                -1.262299e-02 3 1  ON 47
ci_049                -1.447544e-02 3 1  ON 48
ci_050                 3.118803e-03 3 1  ON 49
ci_051                 2.766023e-03 3 1  ON 50
ci_052                -2.297631e-03 3 1  ON 51
ci_053                -2.436027e-03 3 1  ON 52
ci_054                -3.407206e-03 3 1  ON 53
ci_055                -2.979053e-03 3 1  ON 54
ci_056                 5.594289e-03 3 1  ON 55
ci_057                 5.303178e-03 3 1  ON 56
ci_058                -9.915787e-04 3 1  ON 57
ci_059                -2.293360e-03 3 1  ON 58
ci_060                 4.604903e-03 3 1  ON 59
ci_061                 5.719166e-03 3 1  ON 60
ci_062                -3.727974e-03 3 1  ON 61
ci_063                -4.030858e-03 3 1  ON 62
ci_064                -2.554709e-03 3 1  ON 63
ci_065                -4.361705e-03 3 1  ON 64
ci_066                 4.436581e-03 3 1  ON 65
ci_067                 4.359654e-03 3 1  ON 66
ci_068                -4.183915e-03 3 1  ON 67
ci_069                -5.046250e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.4330e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1188
    reference variance = 0.228108
====================================================
  Execution time = 1.4756e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5298e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7824e-01
  Total weights = 1.957464265e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5124e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265882548053
                                         uncertainty =       0.001293632623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265882548053
                                         uncertainty =       0.001293632623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364577554
  error estimate for blocks of size 2^( 2) =       0.000378235252
  error estimate for blocks of size 2^( 3) =       0.000390847470
  error estimate for blocks of size 2^( 4) =       0.000400335805
  error estimate for blocks of size 2^( 5) =       0.000405574751
  error estimate for blocks of size 2^( 6) =       0.000408405347
  error estimate for blocks of size 2^( 7) =       0.000410485276

      target function =      -0.947858146775
              le_mean =     -17.212318314549
             les_mean =     296.542139509015
             stat err =       0.000406200295
             autocorr =       1.241368197718
   target nu stat err =       0.000406200295
   target dn stat err =       0.002498878558
      target stat err =       0.004288877673
              std dev =       0.515590520926
             le_variance =       0.265833585269


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721231831455e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947876446235       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947876843210       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947876909369       residual = 5.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947876936118       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947876936469       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947876936597       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947876937410       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947876937220       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947876937178       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947876937176       residual = 5.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+02 is 1.014473e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947876446235       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947876545519       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947876562064       residual = 5.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947876568753       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947876568840       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947876568873       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947876569075       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947876569028       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947876569017       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947876569017       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+02 is 2.536931e-07

solving harmonic davidson linear method for identity shift 2.3842e+03, overlap shift 2.3842e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947876446235       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947876471058       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947876475195       residual = 5.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947876476867       residual = 8.07e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947876476889       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947876476898       residual = 4.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947876476948       residual = 5.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947876476937       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947876476933       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947876476937       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3842e+03 is 6.342797e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.142717 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7277e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_001                -4.191493e-02 3 1  ON 0
ci_002                -3.210147e-02 3 1  ON 1
ci_003                -2.646861e-02 3 1  ON 2
ci_004                 2.374387e-02 3 1  ON 3
ci_005                 2.413121e-02 3 1  ON 4
ci_006                -2.146931e-02 3 1  ON 5
ci_007                -2.109080e-02 3 1  ON 6
ci_008                -8.497875e-03 3 1  ON 7
ci_009                -1.373974e-02 3 1  ON 8
ci_010                -1.009131e-02 3 1  ON 9
ci_011                -1.135829e-02 3 1  ON 10
ci_012                -9.745313e-03 3 1  ON 11
ci_013                -1.985934e-02 3 1  ON 12
ci_014                 1.227711e-02 3 1  ON 13
ci_015                 1.189235e-02 3 1  ON 14
ci_016                 1.754122e-02 3 1  ON 15
ci_017                 1.638300e-02 3 1  ON 16
ci_018                 1.026052e-02 3 1  ON 17
ci_019                 1.008187e-02 3 1  ON 18
ci_020                 1.790493e-02 3 1  ON 19
ci_021                 1.749536e-02 3 1  ON 20
ci_022                 9.162882e-03 3 1  ON 21
ci_023                 9.144590e-03 3 1  ON 22
ci_024                 9.631987e-03 3 1  ON 23
ci_025                 1.023096e-02 3 1  ON 24
ci_026                 1.169124e-02 3 1  ON 25
ci_027                 1.176451e-02 3 1  ON 26
ci_028                -1.470935e-02 3 1  ON 27
ci_029                -1.654808e-02 3 1  ON 28
ci_030                -9.566116e-03 3 1  ON 29
ci_031                -8.981506e-03 3 1  ON 30
ci_032                -1.469664e-02 3 1  ON 31
ci_033                 5.187915e-03 3 1  ON 32
ci_034                 5.608358e-03 3 1  ON 33
ci_035                -5.095836e-03 3 1  ON 34
ci_036                -1.278601e-02 3 1  ON 35
ci_037                -1.233466e-02 3 1  ON 36
ci_038                 2.132894e-03 3 1  ON 37
ci_039                 1.732895e-03 3 1  ON 38
ci_040                -3.227491e-03 3 1  ON 39
ci_041                 9.567728e-03 3 1  ON 40
ci_042                 8.198222e-03 3 1  ON 41
ci_043                -4.123636e-03 3 1  ON 42
ci_044                -3.876147e-03 3 1  ON 43
ci_045                -3.602338e-03 3 1  ON 44
ci_046                 5.640846e-03 3 1  ON 45
ci_047                 5.519111e-03 3 1  ON 46
ci_048                -1.262306e-02 3 1  ON 47
ci_049                -1.447534e-02 3 1  ON 48
ci_050                 3.118768e-03 3 1  ON 49
ci_051                 2.766005e-03 3 1  ON 50
ci_052                -2.297522e-03 3 1  ON 51
ci_053                -2.436164e-03 3 1  ON 52
ci_054                -3.407057e-03 3 1  ON 53
ci_055                -2.979111e-03 3 1  ON 54
ci_056                 5.594199e-03 3 1  ON 55
ci_057                 5.303045e-03 3 1  ON 56
ci_058                -9.915498e-04 3 1  ON 57
ci_059                -2.293431e-03 3 1  ON 58
ci_060                 4.605121e-03 3 1  ON 59
ci_061                 5.719081e-03 3 1  ON 60
ci_062                -3.728006e-03 3 1  ON 61
ci_063                -4.030813e-03 3 1  ON 62
ci_064                -2.554852e-03 3 1  ON 63
ci_065                -4.361695e-03 3 1  ON 64
ci_066                 4.436610e-03 3 1  ON 65
ci_067                 4.359623e-03 3 1  ON 66
ci_068                -4.183978e-03 3 1  ON 67
ci_069                -5.046187e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2002
    reference variance = 0.131886
====================================================
  Execution time = 1.4214e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8268e-01
  Total weights = 1.9574e+06
  Execution time = 1.8526e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267213866669
                                         uncertainty =       0.001847162833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267213866669
                                         uncertainty =       0.001847162833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365491481
  error estimate for blocks of size 2^( 2) =       0.000379275131
  error estimate for blocks of size 2^( 3) =       0.000392041690
  error estimate for blocks of size 2^( 4) =       0.000401527356
  error estimate for blocks of size 2^( 5) =       0.000406570715
  error estimate for blocks of size 2^( 6) =       0.000409347931
  error estimate for blocks of size 2^( 7) =       0.000410484506

      target function =      -0.940393473573
              le_mean =     -17.211387314947
             les_mean =     296.514530328640
             stat err =       0.000406982627
             autocorr =       1.239930162948
   target nu stat err =       0.000406982627
   target dn stat err =       0.003355111568
      target stat err =       0.005623063928
              std dev =       0.516883008946
             le_variance =       0.267168044937

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267213608416
                                         uncertainty =       0.001847135931

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267213608416
                                         uncertainty =       0.001847135931

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365491305
  error estimate for blocks of size 2^( 2) =       0.000379274987
  error estimate for blocks of size 2^( 3) =       0.000392041591
  error estimate for blocks of size 2^( 4) =       0.000401527289
  error estimate for blocks of size 2^( 5) =       0.000406570677
  error estimate for blocks of size 2^( 6) =       0.000409347885
  error estimate for blocks of size 2^( 7) =       0.000410484476

      target function =      -0.940394152733
              le_mean =     -17.211387311346
             les_mean =     296.514529798872
             stat err =       0.000406982582
             autocorr =       1.239931080778
   target nu stat err =       0.000406982582
   target dn stat err =       0.003354880870
      target stat err =       0.005622691591
              std dev =       0.516882760149
             le_variance =       0.267167787739

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267213737395
                                         uncertainty =       0.001847149379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267213737395
                                         uncertainty =       0.001847149379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365491393
  error estimate for blocks of size 2^( 2) =       0.000379275059
  error estimate for blocks of size 2^( 3) =       0.000392041640
  error estimate for blocks of size 2^( 4) =       0.000401527323
  error estimate for blocks of size 2^( 5) =       0.000406570696
  error estimate for blocks of size 2^( 6) =       0.000409347908
  error estimate for blocks of size 2^( 7) =       0.000410484491

      target function =      -0.940393819922
              le_mean =     -17.211387313140
             les_mean =     296.514530059478
             stat err =       0.000406982604
             autocorr =       1.239930622037
   target nu stat err =       0.000406982604
   target dn stat err =       0.003354996013
      target stat err =       0.005622877500
              std dev =       0.516882884405
             le_variance =       0.267167916191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267213850497
                                         uncertainty =       0.001847161151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267213850497
                                         uncertainty =       0.001847161151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365491470
  error estimate for blocks of size 2^( 2) =       0.000379275122
  error estimate for blocks of size 2^( 3) =       0.000392041684
  error estimate for blocks of size 2^( 4) =       0.000401527352
  error estimate for blocks of size 2^( 5) =       0.000406570712
  error estimate for blocks of size 2^( 6) =       0.000409347928
  error estimate for blocks of size 2^( 7) =       0.000410484504

      target function =      -0.940393517609
              le_mean =     -17.211387314720
             les_mean =     296.514530294527
             stat err =       0.000406982624
             autocorr =       1.239930220349
   target nu stat err =       0.000406982624
   target dn stat err =       0.003355097106
      target stat err =       0.005623040603
              std dev =       0.516882993367
             le_variance =       0.267168028832


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940393473573        initial
     1.4901e+02     1.4901e+03             1.0145e-06        -0.940394152733  <--
     5.9605e+02     5.9605e+03             2.5369e-07        -0.940393819922
     2.3842e+03     2.3842e+04             6.3428e-08        -0.940393517609

*****************************************************************************
Applying the update for shift_i =   1.4901e+02     and shift_s =   1.4901e+03
*****************************************************************************

  Execution time = 2.3594e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
ci_001                -4.191457e-02 3 1  ON 0
ci_002                -3.210114e-02 3 1  ON 1
ci_003                -2.646841e-02 3 1  ON 2
ci_004                 2.374384e-02 3 1  ON 3
ci_005                 2.413045e-02 3 1  ON 4
ci_006                -2.146932e-02 3 1  ON 5
ci_007                -2.109059e-02 3 1  ON 6
ci_008                -8.497847e-03 3 1  ON 7
ci_009                -1.373997e-02 3 1  ON 8
ci_010                -1.009083e-02 3 1  ON 9
ci_011                -1.135802e-02 3 1  ON 10
ci_012                -9.745330e-03 3 1  ON 11
ci_013                -1.985909e-02 3 1  ON 12
ci_014                 1.227723e-02 3 1  ON 13
ci_015                 1.189266e-02 3 1  ON 14
ci_016                 1.754073e-02 3 1  ON 15
ci_017                 1.638293e-02 3 1  ON 16
ci_018                 1.026079e-02 3 1  ON 17
ci_019                 1.008204e-02 3 1  ON 18
ci_020                 1.790457e-02 3 1  ON 19
ci_021                 1.749504e-02 3 1  ON 20
ci_022                 9.162996e-03 3 1  ON 21
ci_023                 9.144527e-03 3 1  ON 22
ci_024                 9.631560e-03 3 1  ON 23
ci_025                 1.023061e-02 3 1  ON 24
ci_026                 1.169103e-02 3 1  ON 25
ci_027                 1.176400e-02 3 1  ON 26
ci_028                -1.470940e-02 3 1  ON 27
ci_029                -1.654750e-02 3 1  ON 28
ci_030                -9.566124e-03 3 1  ON 29
ci_031                -8.981877e-03 3 1  ON 30
ci_032                -1.469684e-02 3 1  ON 31
ci_033                 5.188536e-03 3 1  ON 32
ci_034                 5.608245e-03 3 1  ON 33
ci_035                -5.095789e-03 3 1  ON 34
ci_036                -1.278526e-02 3 1  ON 35
ci_037                -1.233500e-02 3 1  ON 36
ci_038                 2.132541e-03 3 1  ON 37
ci_039                 1.732557e-03 3 1  ON 38
ci_040                -3.227382e-03 3 1  ON 39
ci_041                 9.567553e-03 3 1  ON 40
ci_042                 8.198376e-03 3 1  ON 41
ci_043                -4.123432e-03 3 1  ON 42
ci_044                -3.876424e-03 3 1  ON 43
ci_045                -3.602159e-03 3 1  ON 44
ci_046                 5.640796e-03 3 1  ON 45
ci_047                 5.519439e-03 3 1  ON 46
ci_048                -1.262328e-02 3 1  ON 47
ci_049                -1.447504e-02 3 1  ON 48
ci_050                 3.118665e-03 3 1  ON 49
ci_051                 2.765950e-03 3 1  ON 50
ci_052                -2.297197e-03 3 1  ON 51
ci_053                -2.436576e-03 3 1  ON 52
ci_054                -3.406608e-03 3 1  ON 53
ci_055                -2.979283e-03 3 1  ON 54
ci_056                 5.593930e-03 3 1  ON 55
ci_057                 5.302644e-03 3 1  ON 56
ci_058                -9.914629e-04 3 1  ON 57
ci_059                -2.293642e-03 3 1  ON 58
ci_060                 4.605774e-03 3 1  ON 59
ci_061                 5.718827e-03 3 1  ON 60
ci_062                -3.728104e-03 3 1  ON 61
ci_063                -4.030678e-03 3 1  ON 62
ci_064                -2.555279e-03 3 1  ON 63
ci_065                -4.361664e-03 3 1  ON 64
ci_066                 4.436699e-03 3 1  ON 65
ci_067                 4.359530e-03 3 1  ON 66
ci_068                -4.184169e-03 3 1  ON 67
ci_069                -5.045996e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0877e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2229
    reference variance = 0.435211
====================================================
  Execution time = 1.4921e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5306e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8466e-01
  Total weights = 1.957317185e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5421e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272156331624
                                         uncertainty =       0.002083753006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272156331624
                                         uncertainty =       0.002083753006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368872000
  error estimate for blocks of size 2^( 2) =       0.000382785464
  error estimate for blocks of size 2^( 3) =       0.000395416731
  error estimate for blocks of size 2^( 4) =       0.000404641073
  error estimate for blocks of size 2^( 5) =       0.000409496976
  error estimate for blocks of size 2^( 6) =       0.000411849011
  error estimate for blocks of size 2^( 7) =       0.000413961656

      target function =      -0.937109717899
              le_mean =     -17.211666701993
             les_mean =     296.526132837048
             stat err =       0.000409987179
             autocorr =       1.235347586890
   target nu stat err =       0.000409987179
   target dn stat err =       0.003042067326
      target stat err =       0.005075561847
              std dev =       0.521663784757
             le_variance =       0.272133104327


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721166670199e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937136216874       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937137938771       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937138196461       residual = 6.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937138284411       residual = 7.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937138289959       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937138291916       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937138291627       residual = 6.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937138291694       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937138291753       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937138291762       residual = 4.89e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+01 is 6.126632e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937136216874       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937136648054       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937136712556       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937136734561       residual = 7.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937136735947       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937136736437       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937136736365       residual = 6.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937136736382       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937136736396       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937136736399       residual = 4.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+02 is 1.533763e-06

solving harmonic davidson linear method for identity shift 5.9605e+02, overlap shift 5.9605e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937136216874       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937136324713       residual = 2.52e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937136340844       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937136346346       residual = 7.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.937136346693       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.937136346815       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.937136346798       residual = 6.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.937136346801       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.937136346805       residual = 3.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.937136346806       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.9605e+02 is 3.835724e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.146115 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7477e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_001                -4.191459e-02 3 1  ON 0
ci_002                -3.210082e-02 3 1  ON 1
ci_003                -2.646817e-02 3 1  ON 2
ci_004                 2.374391e-02 3 1  ON 3
ci_005                 2.413007e-02 3 1  ON 4
ci_006                -2.146860e-02 3 1  ON 5
ci_007                -2.109038e-02 3 1  ON 6
ci_008                -8.497467e-03 3 1  ON 7
ci_009                -1.373942e-02 3 1  ON 8
ci_010                -1.009027e-02 3 1  ON 9
ci_011                -1.135752e-02 3 1  ON 10
ci_012                -9.746101e-03 3 1  ON 11
ci_013                -1.985917e-02 3 1  ON 12
ci_014                 1.227783e-02 3 1  ON 13
ci_015                 1.189235e-02 3 1  ON 14
ci_016                 1.753990e-02 3 1  ON 15
ci_017                 1.638292e-02 3 1  ON 16
ci_018                 1.026060e-02 3 1  ON 17
ci_019                 1.008145e-02 3 1  ON 18
ci_020                 1.790439e-02 3 1  ON 19
ci_021                 1.749442e-02 3 1  ON 20
ci_022                 9.162832e-03 3 1  ON 21
ci_023                 9.144679e-03 3 1  ON 22
ci_024                 9.631619e-03 3 1  ON 23
ci_025                 1.023043e-02 3 1  ON 24
ci_026                 1.169056e-02 3 1  ON 25
ci_027                 1.176362e-02 3 1  ON 26
ci_028                -1.470965e-02 3 1  ON 27
ci_029                -1.654702e-02 3 1  ON 28
ci_030                -9.566193e-03 3 1  ON 29
ci_031                -8.982484e-03 3 1  ON 30
ci_032                -1.469694e-02 3 1  ON 31
ci_033                 5.188752e-03 3 1  ON 32
ci_034                 5.608193e-03 3 1  ON 33
ci_035                -5.095952e-03 3 1  ON 34
ci_036                -1.278525e-02 3 1  ON 35
ci_037                -1.233554e-02 3 1  ON 36
ci_038                 2.131981e-03 3 1  ON 37
ci_039                 1.732665e-03 3 1  ON 38
ci_040                -3.227192e-03 3 1  ON 39
ci_041                 9.566977e-03 3 1  ON 40
ci_042                 8.198552e-03 3 1  ON 41
ci_043                -4.123359e-03 3 1  ON 42
ci_044                -3.876960e-03 3 1  ON 43
ci_045                -3.601809e-03 3 1  ON 44
ci_046                 5.640713e-03 3 1  ON 45
ci_047                 5.519415e-03 3 1  ON 46
ci_048                -1.262316e-02 3 1  ON 47
ci_049                -1.447351e-02 3 1  ON 48
ci_050                 3.118979e-03 3 1  ON 49
ci_051                 2.765816e-03 3 1  ON 50
ci_052                -2.297071e-03 3 1  ON 51
ci_053                -2.436783e-03 3 1  ON 52
ci_054                -3.406214e-03 3 1  ON 53
ci_055                -2.979411e-03 3 1  ON 54
ci_056                 5.593522e-03 3 1  ON 55
ci_057                 5.302635e-03 3 1  ON 56
ci_058                -9.910526e-04 3 1  ON 57
ci_059                -2.293340e-03 3 1  ON 58
ci_060                 4.606129e-03 3 1  ON 59
ci_061                 5.718481e-03 3 1  ON 60
ci_062                -3.728313e-03 3 1  ON 61
ci_063                -4.030591e-03 3 1  ON 62
ci_064                -2.555603e-03 3 1  ON 63
ci_065                -4.361730e-03 3 1  ON 64
ci_066                 4.436977e-03 3 1  ON 65
ci_067                 4.359777e-03 3 1  ON 66
ci_068                -4.185095e-03 3 1  ON 67
ci_069                -5.045620e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.2735
    reference variance = 0.132966
====================================================
  Execution time = 1.4372e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7948e-01
  Total weights = 1.9574e+06
  Execution time = 1.8484e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266762183504
                                         uncertainty =       0.001372392712

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266762183504
                                         uncertainty =       0.001372392712

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365215573
  error estimate for blocks of size 2^( 2) =       0.000379447013
  error estimate for blocks of size 2^( 3) =       0.000392351685
  error estimate for blocks of size 2^( 4) =       0.000401800715
  error estimate for blocks of size 2^( 5) =       0.000407239490
  error estimate for blocks of size 2^( 6) =       0.000410789372
  error estimate for blocks of size 2^( 7) =       0.000412663054

      target function =      -0.945759472159
              le_mean =     -17.212145849020
             les_mean =     296.537445410035
             stat err =       0.000408123158
             autocorr =       1.248774153495
   target nu stat err =       0.000408123158
   target dn stat err =       0.002455827785
      target stat err =       0.004197964394
              std dev =       0.516492816177
             le_variance =       0.266764829162

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266761287367
                                         uncertainty =       0.001372389285

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266761287367
                                         uncertainty =       0.001372389285

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365214955
  error estimate for blocks of size 2^( 2) =       0.000379446640
  error estimate for blocks of size 2^( 3) =       0.000392351569
  error estimate for blocks of size 2^( 4) =       0.000401800885
  error estimate for blocks of size 2^( 5) =       0.000407239720
  error estimate for blocks of size 2^( 6) =       0.000410789727
  error estimate for blocks of size 2^( 7) =       0.000412663551

      target function =      -0.945780903666
              le_mean =     -17.212145869634
             les_mean =     296.537433392916
             stat err =       0.000408123471
             autocorr =       1.248780290771
   target nu stat err =       0.000408123471
   target dn stat err =       0.002455488295
      target stat err =       0.004197589082
              std dev =       0.516491943092
             le_variance =       0.266763927279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266761733872
                                         uncertainty =       0.001372390985

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266761733872
                                         uncertainty =       0.001372390985

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365215263
  error estimate for blocks of size 2^( 2) =       0.000379446826
  error estimate for blocks of size 2^( 3) =       0.000392351626
  error estimate for blocks of size 2^( 4) =       0.000401800800
  error estimate for blocks of size 2^( 5) =       0.000407239605
  error estimate for blocks of size 2^( 6) =       0.000410789549
  error estimate for blocks of size 2^( 7) =       0.000412663302

      target function =      -0.945773269635
              le_mean =     -17.212145859194
             les_mean =     296.537437566534
             stat err =       0.000408123314
             autocorr =       1.248777228115
   target nu stat err =       0.000408123314
   target dn stat err =       0.002455638829
      target stat err =       0.004197771833
              std dev =       0.516492378117
             le_variance =       0.266764376653

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266762127184
                                         uncertainty =       0.001372392495

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266762127184
                                         uncertainty =       0.001372392495

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365215534
  error estimate for blocks of size 2^( 2) =       0.000379446989
  error estimate for blocks of size 2^( 3) =       0.000392351678
  error estimate for blocks of size 2^( 4) =       0.000401800726
  error estimate for blocks of size 2^( 5) =       0.000407239504
  error estimate for blocks of size 2^( 6) =       0.000410789394
  error estimate for blocks of size 2^( 7) =       0.000412663085

      target function =      -0.945761742464
              le_mean =     -17.212145850273
             les_mean =     296.537444104888
             stat err =       0.000408123177
             autocorr =       1.248774538155
   target nu stat err =       0.000408123177
   target dn stat err =       0.002455799987
      target stat err =       0.004197938167
              std dev =       0.516492761307
             le_variance =       0.266764772482


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945759472159        initial
     3.7253e+01     3.7253e+02             6.1266e-06        -0.945780903666  <--
     1.4901e+02     1.4901e+03             1.5338e-06        -0.945773269635
     5.9605e+02     5.9605e+03             3.8357e-07        -0.945761742464

*****************************************************************************
Applying the update for shift_i =   3.7253e+01     and shift_s =   3.7253e+02
*****************************************************************************

  Execution time = 2.3730e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
ci_001                -4.191465e-02 3 1  ON 0
ci_002                -3.209987e-02 3 1  ON 1
ci_003                -2.646747e-02 3 1  ON 2
ci_004                 2.374411e-02 3 1  ON 3
ci_005                 2.412892e-02 3 1  ON 4
ci_006                -2.146645e-02 3 1  ON 5
ci_007                -2.108975e-02 3 1  ON 6
ci_008                -8.496329e-03 3 1  ON 7
ci_009                -1.373776e-02 3 1  ON 8
ci_010                -1.008857e-02 3 1  ON 9
ci_011                -1.135602e-02 3 1  ON 10
ci_012                -9.748410e-03 3 1  ON 11
ci_013                -1.985938e-02 3 1  ON 12
ci_014                 1.227962e-02 3 1  ON 13
ci_015                 1.189140e-02 3 1  ON 14
ci_016                 1.753738e-02 3 1  ON 15
ci_017                 1.638290e-02 3 1  ON 16
ci_018                 1.026004e-02 3 1  ON 17
ci_019                 1.007970e-02 3 1  ON 18
ci_020                 1.790387e-02 3 1  ON 19
ci_021                 1.749256e-02 3 1  ON 20
ci_022                 9.162339e-03 3 1  ON 21
ci_023                 9.145135e-03 3 1  ON 22
ci_024                 9.631794e-03 3 1  ON 23
ci_025                 1.022990e-02 3 1  ON 24
ci_026                 1.168916e-02 3 1  ON 25
ci_027                 1.176246e-02 3 1  ON 26
ci_028                -1.471041e-02 3 1  ON 27
ci_029                -1.654561e-02 3 1  ON 28
ci_030                -9.566399e-03 3 1  ON 29
ci_031                -8.984301e-03 3 1  ON 30
ci_032                -1.469723e-02 3 1  ON 31
ci_033                 5.189396e-03 3 1  ON 32
ci_034                 5.608037e-03 3 1  ON 33
ci_035                -5.096441e-03 3 1  ON 34
ci_036                -1.278523e-02 3 1  ON 35
ci_037                -1.233715e-02 3 1  ON 36
ci_038                 2.130306e-03 3 1  ON 37
ci_039                 1.732987e-03 3 1  ON 38
ci_040                -3.226625e-03 3 1  ON 39
ci_041                 9.565251e-03 3 1  ON 40
ci_042                 8.199078e-03 3 1  ON 41
ci_043                -4.123138e-03 3 1  ON 42
ci_044                -3.878565e-03 3 1  ON 43
ci_045                -3.600764e-03 3 1  ON 44
ci_046                 5.640465e-03 3 1  ON 45
ci_047                 5.519342e-03 3 1  ON 46
ci_048                -1.262281e-02 3 1  ON 47
ci_049                -1.446892e-02 3 1  ON 48
ci_050                 3.119917e-03 3 1  ON 49
ci_051                 2.765414e-03 3 1  ON 50
ci_052                -2.296693e-03 3 1  ON 51
ci_053                -2.437402e-03 3 1  ON 52
ci_054                -3.405036e-03 3 1  ON 53
ci_055                -2.979792e-03 3 1  ON 54
ci_056                 5.592298e-03 3 1  ON 55
ci_057                 5.302606e-03 3 1  ON 56
ci_058                -9.898245e-04 3 1  ON 57
ci_059                -2.292434e-03 3 1  ON 58
ci_060                 4.607191e-03 3 1  ON 59
ci_061                 5.717445e-03 3 1  ON 60
ci_062                -3.728938e-03 3 1  ON 61
ci_063                -4.030329e-03 3 1  ON 62
ci_064                -2.556573e-03 3 1  ON 63
ci_065                -4.361929e-03 3 1  ON 64
ci_066                 4.437812e-03 3 1  ON 65
ci_067                 4.360515e-03 3 1  ON 66
ci_068                -4.187869e-03 3 1  ON 67
ci_069                -5.044496e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1213e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1678
    reference variance = 0.205882
====================================================
  Execution time = 1.4713e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5296e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8022e-01
  Total weights = 1.957137983e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5036e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266417239932
                                         uncertainty =       0.001370173240

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266417239932
                                         uncertainty =       0.001370173240

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364959798
  error estimate for blocks of size 2^( 2) =       0.000378766501
  error estimate for blocks of size 2^( 3) =       0.000391102613
  error estimate for blocks of size 2^( 4) =       0.000400270419
  error estimate for blocks of size 2^( 5) =       0.000406776159
  error estimate for blocks of size 2^( 6) =       0.000408814810
  error estimate for blocks of size 2^( 7) =       0.000410596348

      target function =      -0.944500155129
              le_mean =     -17.212208275721
             les_mean =     296.540338213308
             stat err =       0.000406614434
             autocorr =       1.241296488000
   target nu stat err =       0.000406614434
   target dn stat err =       0.003019589564
      target stat err =       0.005122158087
              std dev =       0.516131096264
             le_variance =       0.266391308530


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721220827572e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944526767011       residual = 2.89e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944536779832       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944537846033       residual = 5.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944538130206       residual = 6.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944538176182       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944538192362       residual = 5.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944538201519       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944538198778       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944538199655       residual = 2.13e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944538199752       residual = 4.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+00 is 1.834587e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944526767011       residual = 2.89e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944529286867       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944529554782       residual = 5.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944529626044       residual = 6.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944529637562       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944529641611       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944529643906       residual = 5.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944529643219       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944529643438       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944529643463       residual = 4.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+01 is 4.612597e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944526767011       residual = 2.89e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944527398024       residual = 2.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944527465089       residual = 5.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944527482918       residual = 6.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944527485799       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944527486811       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944527487385       residual = 5.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944527487214       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944527487268       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944527487274       residual = 4.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+02 is 1.154794e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.149607 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7225e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_001                -4.191381e-02 3 1  ON 0
ci_002                -3.209915e-02 3 1  ON 1
ci_003                -2.646497e-02 3 1  ON 2
ci_004                 2.374439e-02 3 1  ON 3
ci_005                 2.412910e-02 3 1  ON 4
ci_006                -2.146561e-02 3 1  ON 5
ci_007                -2.108797e-02 3 1  ON 6
ci_008                -8.496715e-03 3 1  ON 7
ci_009                -1.373884e-02 3 1  ON 8
ci_010                -1.008568e-02 3 1  ON 9
ci_011                -1.135328e-02 3 1  ON 10
ci_012                -9.751799e-03 3 1  ON 11
ci_013                -1.986088e-02 3 1  ON 12
ci_014                 1.227978e-02 3 1  ON 13
ci_015                 1.189277e-02 3 1  ON 14
ci_016                 1.753708e-02 3 1  ON 15
ci_017                 1.638431e-02 3 1  ON 16
ci_018                 1.025720e-02 3 1  ON 17
ci_019                 1.008098e-02 3 1  ON 18
ci_020                 1.790356e-02 3 1  ON 19
ci_021                 1.749277e-02 3 1  ON 20
ci_022                 9.161943e-03 3 1  ON 21
ci_023                 9.146261e-03 3 1  ON 22
ci_024                 9.631860e-03 3 1  ON 23
ci_025                 1.022988e-02 3 1  ON 24
ci_026                 1.168523e-02 3 1  ON 25
ci_027                 1.176088e-02 3 1  ON 26
ci_028                -1.471039e-02 3 1  ON 27
ci_029                -1.654279e-02 3 1  ON 28
ci_030                -9.567972e-03 3 1  ON 29
ci_031                -8.986143e-03 3 1  ON 30
ci_032                -1.469897e-02 3 1  ON 31
ci_033                 5.192204e-03 3 1  ON 32
ci_034                 5.607863e-03 3 1  ON 33
ci_035                -5.096426e-03 3 1  ON 34
ci_036                -1.278554e-02 3 1  ON 35
ci_037                -1.233759e-02 3 1  ON 36
ci_038                 2.128853e-03 3 1  ON 37
ci_039                 1.733419e-03 3 1  ON 38
ci_040                -3.224984e-03 3 1  ON 39
ci_041                 9.561743e-03 3 1  ON 40
ci_042                 8.201784e-03 3 1  ON 41
ci_043                -4.121833e-03 3 1  ON 42
ci_044                -3.878357e-03 3 1  ON 43
ci_045                -3.599864e-03 3 1  ON 44
ci_046                 5.639808e-03 3 1  ON 45
ci_047                 5.519049e-03 3 1  ON 46
ci_048                -1.262252e-02 3 1  ON 47
ci_049                -1.446570e-02 3 1  ON 48
ci_050                 3.119773e-03 3 1  ON 49
ci_051                 2.768806e-03 3 1  ON 50
ci_052                -2.297497e-03 3 1  ON 51
ci_053                -2.434789e-03 3 1  ON 52
ci_054                -3.403725e-03 3 1  ON 53
ci_055                -2.979410e-03 3 1  ON 54
ci_056                 5.592181e-03 3 1  ON 55
ci_057                 5.301676e-03 3 1  ON 56
ci_058                -9.925444e-04 3 1  ON 57
ci_059                -2.290155e-03 3 1  ON 58
ci_060                 4.606684e-03 3 1  ON 59
ci_061                 5.712832e-03 3 1  ON 60
ci_062                -3.729754e-03 3 1  ON 61
ci_063                -4.029499e-03 3 1  ON 62
ci_064                -2.557730e-03 3 1  ON 63
ci_065                -4.361407e-03 3 1  ON 64
ci_066                 4.437161e-03 3 1  ON 65
ci_067                 4.360144e-03 3 1  ON 66
ci_068                -4.189444e-03 3 1  ON 67
ci_069                -5.047366e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1561
    reference variance = 0.178633
====================================================
  Execution time = 1.4428e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7914e-01
  Total weights = 1.9571e+06
  Execution time = 1.8141e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267577613145
                                         uncertainty =       0.001343715483

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267577613145
                                         uncertainty =       0.001343715483

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365744642
  error estimate for blocks of size 2^( 2) =       0.000379347770
  error estimate for blocks of size 2^( 3) =       0.000392001561
  error estimate for blocks of size 2^( 4) =       0.000400641710
  error estimate for blocks of size 2^( 5) =       0.000405490496
  error estimate for blocks of size 2^( 6) =       0.000408073091
  error estimate for blocks of size 2^( 7) =       0.000409642829

      target function =      -0.946338076406
              le_mean =     -17.211677888345
             les_mean =     296.520992755186
             stat err =       0.000405962031
             autocorr =       1.232011861141
   target nu stat err =       0.000405962031
   target dn stat err =       0.002114901727
      target stat err =       0.003634374822
              std dev =       0.517241033054
             le_variance =       0.267538286274

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267572369089
                                         uncertainty =       0.001343789119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267572369089
                                         uncertainty =       0.001343789119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365741090
  error estimate for blocks of size 2^( 2) =       0.000379344481
  error estimate for blocks of size 2^( 3) =       0.000391998226
  error estimate for blocks of size 2^( 4) =       0.000400638652
  error estimate for blocks of size 2^( 5) =       0.000405487421
  error estimate for blocks of size 2^( 6) =       0.000408070643
  error estimate for blocks of size 2^( 7) =       0.000409640138

      target function =      -0.946344985440
              le_mean =     -17.211677863504
             les_mean =     296.520987794279
             stat err =       0.000405959213
             autocorr =       1.232018689581
   target nu stat err =       0.000405959213
   target dn stat err =       0.002115341105
      target stat err =       0.003635150927
              std dev =       0.517236009182
             le_variance =       0.267533089195

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267574956572
                                         uncertainty =       0.001343752244

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267574956572
                                         uncertainty =       0.001343752244

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365742842
  error estimate for blocks of size 2^( 2) =       0.000379346103
  error estimate for blocks of size 2^( 3) =       0.000391999871
  error estimate for blocks of size 2^( 4) =       0.000400640158
  error estimate for blocks of size 2^( 5) =       0.000405488935
  error estimate for blocks of size 2^( 6) =       0.000408071845
  error estimate for blocks of size 2^( 7) =       0.000409641461

      target function =      -0.946321504523
              le_mean =     -17.211677873698
             les_mean =     296.521002089335
             stat err =       0.000405960600
             autocorr =       1.232015296326
   target nu stat err =       0.000405960600
   target dn stat err =       0.002115144262
      target stat err =       0.003634649758
              std dev =       0.517238487883
             le_variance =       0.267535653347

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267577278488
                                         uncertainty =       0.001343720047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267577278488
                                         uncertainty =       0.001343720047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365744415
  error estimate for blocks of size 2^( 2) =       0.000379347560
  error estimate for blocks of size 2^( 3) =       0.000392001348
  error estimate for blocks of size 2^( 4) =       0.000400641515
  error estimate for blocks of size 2^( 5) =       0.000405490299
  error estimate for blocks of size 2^( 6) =       0.000408072934
  error estimate for blocks of size 2^( 7) =       0.000409642657

      target function =      -0.946338206233
              le_mean =     -17.211677886319
             les_mean =     296.520992608153
             stat err =       0.000405961851
             autocorr =       1.232012293436
   target nu stat err =       0.000405961851
   target dn stat err =       0.002114928370
      target stat err =       0.003634419699
              std dev =       0.517240712415
             le_variance =       0.267537954580


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946338076406        initial
     9.3132e+00     9.3132e+01             1.8346e-05        -0.946344985440  <--
     3.7253e+01     3.7253e+02             4.6126e-06        -0.946321504523
     1.4901e+02     1.4901e+03             1.1548e-06        -0.946338206233

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 2.3618e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
ci_001                -4.191131e-02 3 1  ON 0
ci_002                -3.209698e-02 3 1  ON 1
ci_003                -2.645751e-02 3 1  ON 2
ci_004                 2.374521e-02 3 1  ON 3
ci_005                 2.412962e-02 3 1  ON 4
ci_006                -2.146310e-02 3 1  ON 5
ci_007                -2.108266e-02 3 1  ON 6
ci_008                -8.497865e-03 3 1  ON 7
ci_009                -1.374206e-02 3 1  ON 8
ci_010                -1.007706e-02 3 1  ON 9
ci_011                -1.134514e-02 3 1  ON 10
ci_012                -9.761887e-03 3 1  ON 11
ci_013                -1.986536e-02 3 1  ON 12
ci_014                 1.228026e-02 3 1  ON 13
ci_015                 1.189686e-02 3 1  ON 14
ci_016                 1.753619e-02 3 1  ON 15
ci_017                 1.638849e-02 3 1  ON 16
ci_018                 1.024877e-02 3 1  ON 17
ci_019                 1.008480e-02 3 1  ON 18
ci_020                 1.790265e-02 3 1  ON 19
ci_021                 1.749337e-02 3 1  ON 20
ci_022                 9.160769e-03 3 1  ON 21
ci_023                 9.149614e-03 3 1  ON 22
ci_024                 9.632057e-03 3 1  ON 23
ci_025                 1.022981e-02 3 1  ON 24
ci_026                 1.167356e-02 3 1  ON 25
ci_027                 1.175618e-02 3 1  ON 26
ci_028                -1.471033e-02 3 1  ON 27
ci_029                -1.653439e-02 3 1  ON 28
ci_030                -9.572653e-03 3 1  ON 29
ci_031                -8.991611e-03 3 1  ON 30
ci_032                -1.470414e-02 3 1  ON 31
ci_033                 5.200565e-03 3 1  ON 32
ci_034                 5.607348e-03 3 1  ON 33
ci_035                -5.096383e-03 3 1  ON 34
ci_036                -1.278643e-02 3 1  ON 35
ci_037                -1.233887e-02 3 1  ON 36
ci_038                 2.124530e-03 3 1  ON 37
ci_039                 1.734703e-03 3 1  ON 38
ci_040                -3.220103e-03 3 1  ON 39
ci_041                 9.551307e-03 3 1  ON 40
ci_042                 8.209830e-03 3 1  ON 41
ci_043                -4.117950e-03 3 1  ON 42
ci_044                -3.877736e-03 3 1  ON 43
ci_045                -3.597188e-03 3 1  ON 44
ci_046                 5.637852e-03 3 1  ON 45
ci_047                 5.518173e-03 3 1  ON 46
ci_048                -1.262165e-02 3 1  ON 47
ci_049                -1.445611e-02 3 1  ON 48
ci_050                 3.119347e-03 3 1  ON 49
ci_051                 2.778890e-03 3 1  ON 50
ci_052                -2.299889e-03 3 1  ON 51
ci_053                -2.427018e-03 3 1  ON 52
ci_054                -3.399827e-03 3 1  ON 53
ci_055                -2.978276e-03 3 1  ON 54
ci_056                 5.591833e-03 3 1  ON 55
ci_057                 5.298908e-03 3 1  ON 56
ci_058                -1.000634e-03 3 1  ON 57
ci_059                -2.283378e-03 3 1  ON 58
ci_060                 4.605174e-03 3 1  ON 59
ci_061                 5.699099e-03 3 1  ON 60
ci_062                -3.732181e-03 3 1  ON 61
ci_063                -4.027027e-03 3 1  ON 62
ci_064                -2.561170e-03 3 1  ON 63
ci_065                -4.359857e-03 3 1  ON 64
ci_066                 4.435221e-03 3 1  ON 65
ci_067                 4.359041e-03 3 1  ON 66
ci_068                -4.194135e-03 3 1  ON 67
ci_069                -5.055907e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0850e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.258
    reference variance = 0.168196
====================================================
  Execution time = 1.4506e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8089e-01
  Total weights = 1.957547144e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4817e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269994590309
                                         uncertainty =       0.001857951683

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269994590309
                                         uncertainty =       0.001857951683

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367387252
  error estimate for blocks of size 2^( 2) =       0.000381318430
  error estimate for blocks of size 2^( 3) =       0.000394102133
  error estimate for blocks of size 2^( 4) =       0.000403278135
  error estimate for blocks of size 2^( 5) =       0.000408883011
  error estimate for blocks of size 2^( 6) =       0.000410979311
  error estimate for blocks of size 2^( 7) =       0.000412066932

      target function =      -0.943397699554
              le_mean =     -17.211388189683
             les_mean =     296.512769877897
             stat err =       0.000408801847
             autocorr =       1.238162182939
   target nu stat err =       0.000408801847
   target dn stat err =       0.002203419365
      target stat err =       0.003756492875
              std dev =       0.519564033771
             le_variance =       0.269946785188


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721138818968e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943411846528       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943435516791       residual = 1.80e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943438542361       residual = 4.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943439967353       residual = 7.51e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943440123355       residual = 1.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943440142607       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943440144602       residual = 6.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943440141781       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943440140951       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943440140622       residual = 5.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+00 is 5.502938e-05

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943411846528       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943417915381       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943418687218       residual = 4.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943419048599       residual = 7.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943419087725       residual = 1.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943419092466       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943419092986       residual = 6.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943419092265       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943419092061       residual = 1.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943419091976       residual = 5.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+00 is 1.411217e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943411846528       residual = 1.40e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943413373500       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943413567449       residual = 4.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943413658119       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943413667908       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943413669088       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943413669220       residual = 5.96e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.943413669039       residual = 1.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943413668988       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943413668966       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+01 is 3.550939e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.153123 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6996e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_001                -4.191765e-02 3 1  ON 0
ci_002                -3.210002e-02 3 1  ON 1
ci_003                -2.644797e-02 3 1  ON 2
ci_004                 2.373716e-02 3 1  ON 3
ci_005                 2.412937e-02 3 1  ON 4
ci_006                -2.145103e-02 3 1  ON 5
ci_007                -2.106893e-02 3 1  ON 6
ci_008                -8.497527e-03 3 1  ON 7
ci_009                -1.375114e-02 3 1  ON 8
ci_010                -1.007581e-02 3 1  ON 9
ci_011                -1.133844e-02 3 1  ON 10
ci_012                -9.762063e-03 3 1  ON 11
ci_013                -1.986606e-02 3 1  ON 12
ci_014                 1.228577e-02 3 1  ON 13
ci_015                 1.190340e-02 3 1  ON 14
ci_016                 1.752907e-02 3 1  ON 15
ci_017                 1.638604e-02 3 1  ON 16
ci_018                 1.024400e-02 3 1  ON 17
ci_019                 1.008946e-02 3 1  ON 18
ci_020                 1.789785e-02 3 1  ON 19
ci_021                 1.749070e-02 3 1  ON 20
ci_022                 9.162244e-03 3 1  ON 21
ci_023                 9.155545e-03 3 1  ON 22
ci_024                 9.622756e-03 3 1  ON 23
ci_025                 1.022245e-02 3 1  ON 24
ci_026                 1.166563e-02 3 1  ON 25
ci_027                 1.174250e-02 3 1  ON 26
ci_028                -1.470806e-02 3 1  ON 27
ci_029                -1.652580e-02 3 1  ON 28
ci_030                -9.564457e-03 3 1  ON 29
ci_031                -8.993548e-03 3 1  ON 30
ci_032                -1.470738e-02 3 1  ON 31
ci_033                 5.212117e-03 3 1  ON 32
ci_034                 5.609029e-03 3 1  ON 33
ci_035                -5.093795e-03 3 1  ON 34
ci_036                -1.278152e-02 3 1  ON 35
ci_037                -1.234392e-02 3 1  ON 36
ci_038                 2.118467e-03 3 1  ON 37
ci_039                 1.736108e-03 3 1  ON 38
ci_040                -3.217155e-03 3 1  ON 39
ci_041                 9.545714e-03 3 1  ON 40
ci_042                 8.211116e-03 3 1  ON 41
ci_043                -4.113504e-03 3 1  ON 42
ci_044                -3.871332e-03 3 1  ON 43
ci_045                -3.591033e-03 3 1  ON 44
ci_046                 5.636861e-03 3 1  ON 45
ci_047                 5.522566e-03 3 1  ON 46
ci_048                -1.262933e-02 3 1  ON 47
ci_049                -1.445379e-02 3 1  ON 48
ci_050                 3.119190e-03 3 1  ON 49
ci_051                 2.780242e-03 3 1  ON 50
ci_052                -2.302867e-03 3 1  ON 51
ci_053                -2.423262e-03 3 1  ON 52
ci_054                -3.392100e-03 3 1  ON 53
ci_055                -2.976836e-03 3 1  ON 54
ci_056                 5.589461e-03 3 1  ON 55
ci_057                 5.301025e-03 3 1  ON 56
ci_058                -1.014746e-03 3 1  ON 57
ci_059                -2.276232e-03 3 1  ON 58
ci_060                 4.612423e-03 3 1  ON 59
ci_061                 5.689648e-03 3 1  ON 60
ci_062                -3.732256e-03 3 1  ON 61
ci_063                -4.026538e-03 3 1  ON 62
ci_064                -2.567030e-03 3 1  ON 63
ci_065                -4.359621e-03 3 1  ON 64
ci_066                 4.443837e-03 3 1  ON 65
ci_067                 4.358563e-03 3 1  ON 66
ci_068                -4.197996e-03 3 1  ON 67
ci_069                -5.053761e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2217
    reference variance = 0.293589
====================================================
  Execution time = 1.5798e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8016e-01
  Total weights = 1.9576e+06
  Execution time = 1.8112e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268503622666
                                         uncertainty =       0.001570833290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268503622666
                                         uncertainty =       0.001570833290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366384573
  error estimate for blocks of size 2^( 2) =       0.000380265077
  error estimate for blocks of size 2^( 3) =       0.000392767255
  error estimate for blocks of size 2^( 4) =       0.000402211182
  error estimate for blocks of size 2^( 5) =       0.000407083482
  error estimate for blocks of size 2^( 6) =       0.000410661067
  error estimate for blocks of size 2^( 7) =       0.000412907228

      target function =      -0.903522355059
              le_mean =     -17.211966173356
             les_mean =     296.556500964159
             stat err =       0.000408215740
             autocorr =       1.241381115000
   target nu stat err =       0.000408215740
   target dn stat err =       0.024706923366
      target stat err =       0.038023982115
              std dev =       0.518146032080
             le_variance =       0.268475310560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268497083515
                                         uncertainty =       0.001573105207

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268497083515
                                         uncertainty =       0.001573105207

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366380089
  error estimate for blocks of size 2^( 2) =       0.000380260278
  error estimate for blocks of size 2^( 3) =       0.000392763298
  error estimate for blocks of size 2^( 4) =       0.000402207329
  error estimate for blocks of size 2^( 5) =       0.000407081229
  error estimate for blocks of size 2^( 6) =       0.000410660712
  error estimate for blocks of size 2^( 7) =       0.000412908895

      target function =      -0.944679432679
              le_mean =     -17.211966219937
             les_mean =     296.531898585345
             stat err =       0.000408214541
             autocorr =       1.241404209946
   target nu stat err =       0.000408214541
   target dn stat err =       0.002956645328
      target stat err =       0.005017537976
              std dev =       0.518139691213
             le_variance =       0.268468739610

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268500061244
                                         uncertainty =       0.001571990157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268500061244
                                         uncertainty =       0.001571990157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366382132
  error estimate for blocks of size 2^( 2) =       0.000380262340
  error estimate for blocks of size 2^( 3) =       0.000392764899
  error estimate for blocks of size 2^( 4) =       0.000402208882
  error estimate for blocks of size 2^( 5) =       0.000407081956
  error estimate for blocks of size 2^( 6) =       0.000410660429
  error estimate for blocks of size 2^( 7) =       0.000412907854

      target function =      -0.944652865421
              le_mean =     -17.211966153463
             les_mean =     296.531912144966
             stat err =       0.000408214780
             autocorr =       1.241391822781
   target nu stat err =       0.000408214780
   target dn stat err =       0.002954179764
      target stat err =       0.005013161533
              std dev =       0.518142579810
             le_variance =       0.268471733012

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268503143550
                                         uncertainty =       0.001570978669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268503143550
                                         uncertainty =       0.001570978669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366384245
  error estimate for blocks of size 2^( 2) =       0.000380264474
  error estimate for blocks of size 2^( 3) =       0.000392766625
  error estimate for blocks of size 2^( 4) =       0.000402210523
  error estimate for blocks of size 2^( 5) =       0.000407082858
  error estimate for blocks of size 2^( 6) =       0.000410660410
  error estimate for blocks of size 2^( 7) =       0.000412907156

      target function =      -0.944535144176
              le_mean =     -17.211966112093
             les_mean =     296.531980851769
             stat err =       0.000408215237
             autocorr =       1.241380282548
   target nu stat err =       0.000408215237
   target dn stat err =       0.002953283655
      target stat err =       0.005010436410
              std dev =       0.518145567789
             le_variance =       0.268474829419


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.903522355059        initial
     2.3283e+00     2.3283e+01             5.5029e-05        -0.944679432679  <--
     9.3132e+00     9.3132e+01             1.4112e-05        -0.944652865421
     3.7253e+01     3.7253e+02             3.5509e-06        -0.944535144176

*****************************************************************************
Applying the update for shift_i =   2.3283e+00     and shift_s =   2.3283e+01
*****************************************************************************

  Execution time = 2.4968e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
ci_001                -4.193622e-02 3 1  ON 0
ci_002                -3.210894e-02 3 1  ON 1
ci_003                -2.642017e-02 3 1  ON 2
ci_004                 2.371358e-02 3 1  ON 3
ci_005                 2.412853e-02 3 1  ON 4
ci_006                -2.141579e-02 3 1  ON 5
ci_007                -2.102885e-02 3 1  ON 6
ci_008                -8.496536e-03 3 1  ON 7
ci_009                -1.377753e-02 3 1  ON 8
ci_010                -1.007217e-02 3 1  ON 9
ci_011                -1.131897e-02 3 1  ON 10
ci_012                -9.762572e-03 3 1  ON 11
ci_013                -1.986810e-02 3 1  ON 12
ci_014                 1.230189e-02 3 1  ON 13
ci_015                 1.192233e-02 3 1  ON 14
ci_016                 1.750830e-02 3 1  ON 15
ci_017                 1.637892e-02 3 1  ON 16
ci_018                 1.023013e-02 3 1  ON 17
ci_019                 1.010296e-02 3 1  ON 18
ci_020                 1.788395e-02 3 1  ON 19
ci_021                 1.748289e-02 3 1  ON 20
ci_022                 9.166564e-03 3 1  ON 21
ci_023                 9.172798e-03 3 1  ON 22
ci_024                 9.595649e-03 3 1  ON 23
ci_025                 1.020097e-02 3 1  ON 24
ci_026                 1.164255e-02 3 1  ON 25
ci_027                 1.170279e-02 3 1  ON 26
ci_028                -1.470143e-02 3 1  ON 27
ci_029                -1.650078e-02 3 1  ON 28
ci_030                -9.540744e-03 3 1  ON 29
ci_031                -8.999139e-03 3 1  ON 30
ci_032                -1.471683e-02 3 1  ON 31
ci_033                 5.245738e-03 3 1  ON 32
ci_034                 5.613915e-03 3 1  ON 33
ci_035                -5.086277e-03 3 1  ON 34
ci_036                -1.276723e-02 3 1  ON 35
ci_037                -1.235849e-02 3 1  ON 36
ci_038                 2.100877e-03 3 1  ON 37
ci_039                 1.740186e-03 3 1  ON 38
ci_040                -3.208605e-03 3 1  ON 39
ci_041                 9.529481e-03 3 1  ON 40
ci_042                 8.214798e-03 3 1  ON 41
ci_043                -4.100591e-03 3 1  ON 42
ci_044                -3.852719e-03 3 1  ON 43
ci_045                -3.573186e-03 3 1  ON 44
ci_046                 5.633982e-03 3 1  ON 45
ci_047                 5.535359e-03 3 1  ON 46
ci_048                -1.265170e-02 3 1  ON 47
ci_049                -1.444709e-02 3 1  ON 48
ci_050                 3.118741e-03 3 1  ON 49
ci_051                 2.784166e-03 3 1  ON 50
ci_052                -2.311483e-03 3 1  ON 51
ci_053                -2.412354e-03 3 1  ON 52
ci_054                -3.369645e-03 3 1  ON 53
ci_055                -2.972598e-03 3 1  ON 54
ci_056                 5.582569e-03 3 1  ON 55
ci_057                 5.307177e-03 3 1  ON 56
ci_058                -1.055663e-03 3 1  ON 57
ci_059                -2.255464e-03 3 1  ON 58
ci_060                 4.633537e-03 3 1  ON 59
ci_061                 5.662128e-03 3 1  ON 60
ci_062                -3.732430e-03 3 1  ON 61
ci_063                -4.025095e-03 3 1  ON 62
ci_064                -2.584012e-03 3 1  ON 63
ci_065                -4.358939e-03 3 1  ON 64
ci_066                 4.468835e-03 3 1  ON 65
ci_067                 4.357172e-03 3 1  ON 66
ci_068                -4.209243e-03 3 1  ON 67
ci_069                -5.047506e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1970e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.1757
    reference variance = 0.21521
====================================================
  Execution time = 1.4394e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5301e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8140e-01
  Total weights = 1.957233419e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4870e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269352939644
                                         uncertainty =       0.001556211658

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269352939644
                                         uncertainty =       0.001556211658

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367013802
  error estimate for blocks of size 2^( 2) =       0.000381131771
  error estimate for blocks of size 2^( 3) =       0.000393993792
  error estimate for blocks of size 2^( 4) =       0.000403334873
  error estimate for blocks of size 2^( 5) =       0.000407787264
  error estimate for blocks of size 2^( 6) =       0.000410980500
  error estimate for blocks of size 2^( 7) =       0.000415409232

      target function =      -0.942536782457
              le_mean =     -17.211894651851
             les_mean =     296.530720629393
             stat err =       0.000409377967
             autocorr =       1.244182634533
   target nu stat err =       0.000409377967
   target dn stat err =       0.002196260130
      target stat err =       0.003741797519
              std dev =       0.519035897055
             le_variance =       0.269398262431


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721189465185e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942550580773       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942659943155       residual = 1.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942673265191       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942676281587       residual = 6.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942677206656       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942677453085       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942677524555       residual = 5.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942677527098       residual = 1.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942677529421       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942677530978       residual = 7.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-01 is 2.644601e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942550580773       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942580672293       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942584277034       residual = 4.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942585067097       residual = 6.30e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942585307750       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942585371037       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942585388711       residual = 4.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942585389039       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942585389571       residual = 2.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942585389877       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+00 is 7.275067e-05

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942550580773       residual = 1.88e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942558297744       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942559217814       residual = 3.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942559417624       residual = 6.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942559478365       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942559494295       residual = 2.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942559498685       residual = 4.55e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942559498754       residual = 1.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942559498878       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942559498952       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+00 is 1.865585e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.156627 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6890e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_001                -4.191346e-02 3 1  ON 0
ci_002                -3.206885e-02 3 1  ON 1
ci_003                -2.642413e-02 3 1  ON 2
ci_004                 2.373621e-02 3 1  ON 3
ci_005                 2.410117e-02 3 1  ON 4
ci_006                -2.139407e-02 3 1  ON 5
ci_007                -2.101252e-02 3 1  ON 6
ci_008                -8.510290e-03 3 1  ON 7
ci_009                -1.383183e-02 3 1  ON 8
ci_010                -1.008318e-02 3 1  ON 9
ci_011                -1.127693e-02 3 1  ON 10
ci_012                -9.768312e-03 3 1  ON 11
ci_013                -1.985764e-02 3 1  ON 12
ci_014                 1.227851e-02 3 1  ON 13
ci_015                 1.196036e-02 3 1  ON 14
ci_016                 1.747924e-02 3 1  ON 15
ci_017                 1.636872e-02 3 1  ON 16
ci_018                 1.022122e-02 3 1  ON 17
ci_019                 1.010873e-02 3 1  ON 18
ci_020                 1.783834e-02 3 1  ON 19
ci_021                 1.750235e-02 3 1  ON 20
ci_022                 9.154659e-03 3 1  ON 21
ci_023                 9.191653e-03 3 1  ON 22
ci_024                 9.604131e-03 3 1  ON 23
ci_025                 1.015823e-02 3 1  ON 24
ci_026                 1.158561e-02 3 1  ON 25
ci_027                 1.168511e-02 3 1  ON 26
ci_028                -1.474608e-02 3 1  ON 27
ci_029                -1.647302e-02 3 1  ON 28
ci_030                -9.548155e-03 3 1  ON 29
ci_031                -8.974190e-03 3 1  ON 30
ci_032                -1.473305e-02 3 1  ON 31
ci_033                 5.278886e-03 3 1  ON 32
ci_034                 5.598034e-03 3 1  ON 33
ci_035                -5.094549e-03 3 1  ON 34
ci_036                -1.275158e-02 3 1  ON 35
ci_037                -1.237458e-02 3 1  ON 36
ci_038                 2.075978e-03 3 1  ON 37
ci_039                 1.745959e-03 3 1  ON 38
ci_040                -3.200737e-03 3 1  ON 39
ci_041                 9.477953e-03 3 1  ON 40
ci_042                 8.216710e-03 3 1  ON 41
ci_043                -4.088339e-03 3 1  ON 42
ci_044                -3.879547e-03 3 1  ON 43
ci_045                -3.567869e-03 3 1  ON 44
ci_046                 5.625554e-03 3 1  ON 45
ci_047                 5.543634e-03 3 1  ON 46
ci_048                -1.267186e-02 3 1  ON 47
ci_049                -1.443991e-02 3 1  ON 48
ci_050                 3.134559e-03 3 1  ON 49
ci_051                 2.815793e-03 3 1  ON 50
ci_052                -2.311417e-03 3 1  ON 51
ci_053                -2.425571e-03 3 1  ON 52
ci_054                -3.363440e-03 3 1  ON 53
ci_055                -2.972945e-03 3 1  ON 54
ci_056                 5.582383e-03 3 1  ON 55
ci_057                 5.320457e-03 3 1  ON 56
ci_058                -1.090504e-03 3 1  ON 57
ci_059                -2.182714e-03 3 1  ON 58
ci_060                 4.655676e-03 3 1  ON 59
ci_061                 5.654052e-03 3 1  ON 60
ci_062                -3.738193e-03 3 1  ON 61
ci_063                -4.030436e-03 3 1  ON 62
ci_064                -2.605539e-03 3 1  ON 63
ci_065                -4.355723e-03 3 1  ON 64
ci_066                 4.486237e-03 3 1  ON 65
ci_067                 4.359542e-03 3 1  ON 66
ci_068                -4.197448e-03 3 1  ON 67
ci_069                -5.008398e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.2456
    reference variance = 0.322176
====================================================
  Execution time = 1.3819e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7689e-01
  Total weights = 1.9572e+06
  Execution time = 1.8189e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266200851266
                                         uncertainty =       0.001392339429

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266200851266
                                         uncertainty =       0.001392339429

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364858508
  error estimate for blocks of size 2^( 2) =       0.000379226942
  error estimate for blocks of size 2^( 3) =       0.000391973564
  error estimate for blocks of size 2^( 4) =       0.000401272032
  error estimate for blocks of size 2^( 5) =       0.000406460087
  error estimate for blocks of size 2^( 6) =       0.000410406592
  error estimate for blocks of size 2^( 7) =       0.000412617117

      target function =      -0.950114448436
              le_mean =     -17.212183088049
             les_mean =     296.536155766370
             stat err =       0.000407688957
             autocorr =       1.248558629844
   target nu stat err =       0.000407688957
   target dn stat err =       0.002075010297
      target stat err =       0.003600552975
              std dev =       0.515987850097
             le_variance =       0.266243461448

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266152839345
                                         uncertainty =       0.001394759470

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266152839345
                                         uncertainty =       0.001394759470

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364825317
  error estimate for blocks of size 2^( 2) =       0.000379196824
  error estimate for blocks of size 2^( 3) =       0.000391947143
  error estimate for blocks of size 2^( 4) =       0.000401252437
  error estimate for blocks of size 2^( 5) =       0.000406441078
  error estimate for blocks of size 2^( 6) =       0.000410398069
  error estimate for blocks of size 2^( 7) =       0.000412597248

      target function =      -0.949847903843
              le_mean =     -17.212185071180
             les_mean =     296.536380945664
             stat err =       0.000407672208
             autocorr =       1.248683218569
   target nu stat err =       0.000407672208
   target dn stat err =       0.002077479659
      target stat err =       0.003602688813
              std dev =       0.515940910704
             le_variance =       0.266195023339

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266171797824
                                         uncertainty =       0.001393644924

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266171797824
                                         uncertainty =       0.001393644924

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364838439
  error estimate for blocks of size 2^( 2) =       0.000379208489
  error estimate for blocks of size 2^( 3) =       0.000391957140
  error estimate for blocks of size 2^( 4) =       0.000401259378
  error estimate for blocks of size 2^( 5) =       0.000406447663
  error estimate for blocks of size 2^( 6) =       0.000410399766
  error estimate for blocks of size 2^( 7) =       0.000412604073

      target function =      -0.950149811018
              le_mean =     -17.212183793930
             les_mean =     296.536159277421
             stat err =       0.000407677720
             autocorr =       1.248627160585
   target nu stat err =       0.000407677720
   target dn stat err =       0.002073010654
      target stat err =       0.003597488448
              std dev =       0.515959468277
             le_variance =       0.266214172904

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266196753984
                                         uncertainty =       0.001392503509

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266196753984
                                         uncertainty =       0.001392503509

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364855680
  error estimate for blocks of size 2^( 2) =       0.000379224316
  error estimate for blocks of size 2^( 3) =       0.000391971198
  error estimate for blocks of size 2^( 4) =       0.000401270153
  error estimate for blocks of size 2^( 5) =       0.000406458240
  error estimate for blocks of size 2^( 6) =       0.000410405461
  error estimate for blocks of size 2^( 7) =       0.000412615193

      target function =      -0.950117904172
              le_mean =     -17.212183126488
             les_mean =     296.536155059190
             stat err =       0.000407687262
             autocorr =       1.248567602452
   target nu stat err =       0.000407687262
   target dn stat err =       0.002074616213
      target stat err =       0.003599922484
              std dev =       0.515983850545
             le_variance =       0.266239334023


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.950114448436        initial
     5.8208e-01     5.8208e+00             2.6446e-04        -0.949847903843
     2.3283e+00     2.3283e+01             7.2751e-05        -0.950149811018  <--
     9.3132e+00     9.3132e+01             1.8656e-05        -0.950117904172

*****************************************************************************
Applying the update for shift_i =   2.3283e+00     and shift_s =   2.3283e+01
*****************************************************************************

  Execution time = 2.2996e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
ci_001                -4.191346e-02 3 1  ON 0
ci_002                -3.206885e-02 3 1  ON 1
ci_003                -2.642413e-02 3 1  ON 2
ci_004                 2.373621e-02 3 1  ON 3
ci_005                 2.410117e-02 3 1  ON 4
ci_006                -2.139407e-02 3 1  ON 5
ci_007                -2.101252e-02 3 1  ON 6
ci_008                -8.510290e-03 3 1  ON 7
ci_009                -1.383183e-02 3 1  ON 8
ci_010                -1.008318e-02 3 1  ON 9
ci_011                -1.127693e-02 3 1  ON 10
ci_012                -9.768312e-03 3 1  ON 11
ci_013                -1.985764e-02 3 1  ON 12
ci_014                 1.227851e-02 3 1  ON 13
ci_015                 1.196036e-02 3 1  ON 14
ci_016                 1.747924e-02 3 1  ON 15
ci_017                 1.636872e-02 3 1  ON 16
ci_018                 1.022122e-02 3 1  ON 17
ci_019                 1.010873e-02 3 1  ON 18
ci_020                 1.783834e-02 3 1  ON 19
ci_021                 1.750235e-02 3 1  ON 20
ci_022                 9.154659e-03 3 1  ON 21
ci_023                 9.191653e-03 3 1  ON 22
ci_024                 9.604131e-03 3 1  ON 23
ci_025                 1.015823e-02 3 1  ON 24
ci_026                 1.158561e-02 3 1  ON 25
ci_027                 1.168511e-02 3 1  ON 26
ci_028                -1.474608e-02 3 1  ON 27
ci_029                -1.647302e-02 3 1  ON 28
ci_030                -9.548155e-03 3 1  ON 29
ci_031                -8.974190e-03 3 1  ON 30
ci_032                -1.473305e-02 3 1  ON 31
ci_033                 5.278886e-03 3 1  ON 32
ci_034                 5.598034e-03 3 1  ON 33
ci_035                -5.094549e-03 3 1  ON 34
ci_036                -1.275158e-02 3 1  ON 35
ci_037                -1.237458e-02 3 1  ON 36
ci_038                 2.075978e-03 3 1  ON 37
ci_039                 1.745959e-03 3 1  ON 38
ci_040                -3.200737e-03 3 1  ON 39
ci_041                 9.477953e-03 3 1  ON 40
ci_042                 8.216710e-03 3 1  ON 41
ci_043                -4.088339e-03 3 1  ON 42
ci_044                -3.879547e-03 3 1  ON 43
ci_045                -3.567869e-03 3 1  ON 44
ci_046                 5.625554e-03 3 1  ON 45
ci_047                 5.543634e-03 3 1  ON 46
ci_048                -1.267186e-02 3 1  ON 47
ci_049                -1.443991e-02 3 1  ON 48
ci_050                 3.134559e-03 3 1  ON 49
ci_051                 2.815793e-03 3 1  ON 50
ci_052                -2.311417e-03 3 1  ON 51
ci_053                -2.425571e-03 3 1  ON 52
ci_054                -3.363440e-03 3 1  ON 53
ci_055                -2.972945e-03 3 1  ON 54
ci_056                 5.582383e-03 3 1  ON 55
ci_057                 5.320457e-03 3 1  ON 56
ci_058                -1.090504e-03 3 1  ON 57
ci_059                -2.182714e-03 3 1  ON 58
ci_060                 4.655676e-03 3 1  ON 59
ci_061                 5.654052e-03 3 1  ON 60
ci_062                -3.738193e-03 3 1  ON 61
ci_063                -4.030436e-03 3 1  ON 62
ci_064                -2.605539e-03 3 1  ON 63
ci_065                -4.355723e-03 3 1  ON 64
ci_066                 4.486237e-03 3 1  ON 65
ci_067                 4.359542e-03 3 1  ON 66
ci_068                -4.197448e-03 3 1  ON 67
ci_069                -5.008398e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9892e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.2445
    reference variance = 0.282147
====================================================
  Execution time = 1.4254e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8289e-01
  Total weights = 1.956981299e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4825e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268899437569
                                         uncertainty =       0.002283322807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268899437569
                                         uncertainty =       0.002283322807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366689549
  error estimate for blocks of size 2^( 2) =       0.000380440862
  error estimate for blocks of size 2^( 3) =       0.000392912568
  error estimate for blocks of size 2^( 4) =       0.000402155068
  error estimate for blocks of size 2^( 5) =       0.000408335886
  error estimate for blocks of size 2^( 6) =       0.000412787382
  error estimate for blocks of size 2^( 7) =       0.000415177521

      target function =      -0.939998710223
              le_mean =     -17.211612845311
             les_mean =     296.522507267810
             stat err =       0.000409613964
             autocorr =       1.247821436550
   target nu stat err =       0.000409613964
   target dn stat err =       0.005005454431
      target stat err =       0.008348409154
              std dev =       0.518577333916
             le_variance =       0.268922451251


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721161284531e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e-01, overlap shift 5.8208e+00 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940071291249       residual = 1.79e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940577835180       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940637608799       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940648527590       residual = 5.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940652203052       residual = 6.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940652008632       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940651745020       residual = 3.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940651780809       residual = 8.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940651820411       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940651802181       residual = 3.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.940651797964       residual = 9.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e-01 is 4.749287e-04

solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940071291249       residual = 1.79e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940211628641       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940227931973       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940230839191       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940231787023       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940231730416       residual = 2.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940231661086       residual = 3.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940231669265       residual = 7.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940231679891       residual = 1.81e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940231675341       residual = 2.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.940231674237       residual = 7.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+00 is 1.314429e-04

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940071291249       residual = 1.79e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940107350448       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940111520876       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940112259497       residual = 4.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940112498125       residual = 5.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940112483413       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940112465865       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940112467854       residual = 7.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940112470556       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940112469421       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.940112469142       residual = 6.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+00 is 3.376464e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.160661 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6746e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_001                -4.191043e-02 3 1  ON 0
ci_002                -3.203247e-02 3 1  ON 1
ci_003                -2.639190e-02 3 1  ON 2
ci_004                 2.364354e-02 3 1  ON 3
ci_005                 2.408362e-02 3 1  ON 4
ci_006                -2.138960e-02 3 1  ON 5
ci_007                -2.097797e-02 3 1  ON 6
ci_008                -8.431770e-03 3 1  ON 7
ci_009                -1.383289e-02 3 1  ON 8
ci_010                -1.006100e-02 3 1  ON 9
ci_011                -1.126416e-02 3 1  ON 10
ci_012                -9.779005e-03 3 1  ON 11
ci_013                -1.983335e-02 3 1  ON 12
ci_014                 1.226878e-02 3 1  ON 13
ci_015                 1.197845e-02 3 1  ON 14
ci_016                 1.744949e-02 3 1  ON 15
ci_017                 1.634957e-02 3 1  ON 16
ci_018                 1.028936e-02 3 1  ON 17
ci_019                 1.011941e-02 3 1  ON 18
ci_020                 1.778780e-02 3 1  ON 19
ci_021                 1.745521e-02 3 1  ON 20
ci_022                 9.186222e-03 3 1  ON 21
ci_023                 9.178567e-03 3 1  ON 22
ci_024                 9.662000e-03 3 1  ON 23
ci_025                 1.018264e-02 3 1  ON 24
ci_026                 1.166960e-02 3 1  ON 25
ci_027                 1.165584e-02 3 1  ON 26
ci_028                -1.475260e-02 3 1  ON 27
ci_029                -1.648117e-02 3 1  ON 28
ci_030                -9.540813e-03 3 1  ON 29
ci_031                -9.045041e-03 3 1  ON 30
ci_032                -1.472673e-02 3 1  ON 31
ci_033                 5.299902e-03 3 1  ON 32
ci_034                 5.535869e-03 3 1  ON 33
ci_035                -5.082823e-03 3 1  ON 34
ci_036                -1.278214e-02 3 1  ON 35
ci_037                -1.250602e-02 3 1  ON 36
ci_038                 2.054392e-03 3 1  ON 37
ci_039                 1.751443e-03 3 1  ON 38
ci_040                -3.201213e-03 3 1  ON 39
ci_041                 9.423006e-03 3 1  ON 40
ci_042                 8.124100e-03 3 1  ON 41
ci_043                -4.071172e-03 3 1  ON 42
ci_044                -3.900401e-03 3 1  ON 43
ci_045                -3.620576e-03 3 1  ON 44
ci_046                 5.603400e-03 3 1  ON 45
ci_047                 5.549216e-03 3 1  ON 46
ci_048                -1.274441e-02 3 1  ON 47
ci_049                -1.437437e-02 3 1  ON 48
ci_050                 3.132894e-03 3 1  ON 49
ci_051                 2.796673e-03 3 1  ON 50
ci_052                -2.322701e-03 3 1  ON 51
ci_053                -2.430493e-03 3 1  ON 52
ci_054                -3.320487e-03 3 1  ON 53
ci_055                -2.948801e-03 3 1  ON 54
ci_056                 5.582761e-03 3 1  ON 55
ci_057                 5.310946e-03 3 1  ON 56
ci_058                -1.112321e-03 3 1  ON 57
ci_059                -2.160243e-03 3 1  ON 58
ci_060                 4.655344e-03 3 1  ON 59
ci_061                 5.606177e-03 3 1  ON 60
ci_062                -3.729096e-03 3 1  ON 61
ci_063                -4.015101e-03 3 1  ON 62
ci_064                -2.648733e-03 3 1  ON 63
ci_065                -4.349495e-03 3 1  ON 64
ci_066                 4.473745e-03 3 1  ON 65
ci_067                 4.355880e-03 3 1  ON 66
ci_068                -4.210413e-03 3 1  ON 67
ci_069                -4.959863e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.118
    reference variance = 0.26007
====================================================
  Execution time = 1.3872e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7779e-01
  Total weights = 1.9574e+06
  Execution time = 1.8231e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267166749717
                                         uncertainty =       0.002904252162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267166749717
                                         uncertainty =       0.002904252162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365505070
  error estimate for blocks of size 2^( 2) =       0.000379494187
  error estimate for blocks of size 2^( 3) =       0.000392490588
  error estimate for blocks of size 2^( 4) =       0.000401997626
  error estimate for blocks of size 2^( 5) =       0.000408315927
  error estimate for blocks of size 2^( 6) =       0.000411637419
  error estimate for blocks of size 2^( 7) =       0.000415041933

      target function =      -0.948436137839
              le_mean =     -17.212155777695
             les_mean =     296.536194235344
             stat err =       0.000409248226
             autocorr =       1.253680298900
   target nu stat err =       0.000409248226
   target dn stat err =       0.003191829759
      target stat err =       0.005453544453
              std dev =       0.516902226776
             le_variance =       0.267187912046

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266984432985
                                         uncertainty =       0.002847855663

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266984432985
                                         uncertainty =       0.002847855663

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365380206
  error estimate for blocks of size 2^( 2) =       0.000379385630
  error estimate for blocks of size 2^( 3) =       0.000392396740
  error estimate for blocks of size 2^( 4) =       0.000401917860
  error estimate for blocks of size 2^( 5) =       0.000408252110
  error estimate for blocks of size 2^( 6) =       0.000411584851
  error estimate for blocks of size 2^( 7) =       0.000415008651

      target function =      -0.946701494337
              le_mean =     -17.212165765896
             les_mean =     296.537564858600
             stat err =       0.000409190868
             autocorr =       1.254185667017
   target nu stat err =       0.000409190868
   target dn stat err =       0.003165621888
      target stat err =       0.005390067465
              std dev =       0.516725643028
             le_variance =       0.267005390163

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267052210625
                                         uncertainty =       0.002872372886

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267052210625
                                         uncertainty =       0.002872372886

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365426656
  error estimate for blocks of size 2^( 2) =       0.000379425177
  error estimate for blocks of size 2^( 3) =       0.000392430000
  error estimate for blocks of size 2^( 4) =       0.000401945838
  error estimate for blocks of size 2^( 5) =       0.000408273173
  error estimate for blocks of size 2^( 6) =       0.000411601252
  error estimate for blocks of size 2^( 7) =       0.000415012186

      target function =      -0.948344093407
              le_mean =     -17.212160346084
             les_mean =     296.536406942057
             stat err =       0.000409208112
             autocorr =       1.253972526842
   target nu stat err =       0.000409208112
   target dn stat err =       0.003099263551
      target stat err =       0.005297273799
              std dev =       0.516791333202
             le_variance =       0.267073282073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267149986067
                                         uncertainty =       0.002900005594

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267149986067
                                         uncertainty =       0.002900005594

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365493598
  error estimate for blocks of size 2^( 2) =       0.000379483961
  error estimate for blocks of size 2^( 3) =       0.000392481464
  error estimate for blocks of size 2^( 4) =       0.000401989679
  error estimate for blocks of size 2^( 5) =       0.000408309189
  error estimate for blocks of size 2^( 6) =       0.000411631526
  error estimate for blocks of size 2^( 7) =       0.000415036756

      target function =      -0.948501678007
              le_mean =     -17.212156261322
             les_mean =     296.536172356386
             stat err =       0.000409241788
             autocorr =       1.253719545899
   target nu stat err =       0.000409241788
   target dn stat err =       0.003176253590
      target stat err =       0.005428154936
              std dev =       0.516886003778
             le_variance =       0.267171140901


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948436137839        initial
     5.8208e-01     5.8208e+00             4.7493e-04        -0.946701494337
     2.3283e+00     2.3283e+01             1.3144e-04        -0.948344093407
     9.3132e+00     9.3132e+01             3.3765e-05        -0.948501678007  <--

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 2.3091e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
ci_001                -4.191268e-02 3 1  ON 0
ci_002                -3.205955e-02 3 1  ON 1
ci_003                -2.641578e-02 3 1  ON 2
ci_004                 2.371251e-02 3 1  ON 3
ci_005                 2.409673e-02 3 1  ON 4
ci_006                -2.139293e-02 3 1  ON 5
ci_007                -2.100368e-02 3 1  ON 6
ci_008                -8.490078e-03 3 1  ON 7
ci_009                -1.383210e-02 3 1  ON 8
ci_010                -1.007751e-02 3 1  ON 9
ci_011                -1.127368e-02 3 1  ON 10
ci_012                -9.771051e-03 3 1  ON 11
ci_013                -1.985145e-02 3 1  ON 12
ci_014                 1.227602e-02 3 1  ON 13
ci_015                 1.196498e-02 3 1  ON 14
ci_016                 1.747164e-02 3 1  ON 15
ci_017                 1.636384e-02 3 1  ON 16
ci_018                 1.023871e-02 3 1  ON 17
ci_019                 1.011149e-02 3 1  ON 18
ci_020                 1.782541e-02 3 1  ON 19
ci_021                 1.749026e-02 3 1  ON 20
ci_022                 9.162721e-03 3 1  ON 21
ci_023                 9.188311e-03 3 1  ON 22
ci_024                 9.618930e-03 3 1  ON 23
ci_025                 1.016446e-02 3 1  ON 24
ci_026                 1.160721e-02 3 1  ON 25
ci_027                 1.167762e-02 3 1  ON 26
ci_028                -1.474777e-02 3 1  ON 27
ci_029                -1.647515e-02 3 1  ON 28
ci_030                -9.546233e-03 3 1  ON 29
ci_031                -8.992399e-03 3 1  ON 30
ci_032                -1.473142e-02 3 1  ON 31
ci_033                 5.284249e-03 3 1  ON 32
ci_034                 5.582134e-03 3 1  ON 33
ci_035                -5.091545e-03 3 1  ON 34
ci_036                -1.275942e-02 3 1  ON 35
ci_037                -1.240834e-02 3 1  ON 36
ci_038                 2.070447e-03 3 1  ON 37
ci_039                 1.747367e-03 3 1  ON 38
ci_040                -3.200860e-03 3 1  ON 39
ci_041                 9.463866e-03 3 1  ON 40
ci_042                 8.192935e-03 3 1  ON 41
ci_043                -4.083939e-03 3 1  ON 42
ci_044                -3.884884e-03 3 1  ON 43
ci_045                -3.581401e-03 3 1  ON 44
ci_046                 5.619900e-03 3 1  ON 45
ci_047                 5.545073e-03 3 1  ON 46
ci_048                -1.269035e-02 3 1  ON 47
ci_049                -1.442314e-02 3 1  ON 48
ci_050                 3.134122e-03 3 1  ON 49
ci_051                 2.810863e-03 3 1  ON 50
ci_052                -2.314305e-03 3 1  ON 51
ci_053                -2.426846e-03 3 1  ON 52
ci_054                -3.352416e-03 3 1  ON 53
ci_055                -2.966771e-03 3 1  ON 54
ci_056                 5.582482e-03 3 1  ON 55
ci_057                 5.318022e-03 3 1  ON 56
ci_058                -1.096097e-03 3 1  ON 57
ci_059                -2.176955e-03 3 1  ON 58
ci_060                 4.655589e-03 3 1  ON 59
ci_061                 5.641816e-03 3 1  ON 60
ci_062                -3.735844e-03 3 1  ON 61
ci_063                -4.026504e-03 3 1  ON 62
ci_064                -2.616623e-03 3 1  ON 63
ci_065                -4.354125e-03 3 1  ON 64
ci_066                 4.483041e-03 3 1  ON 65
ci_067                 4.358589e-03 3 1  ON 66
ci_068                -4.200762e-03 3 1  ON 67
ci_069                -4.995980e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9843e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2593
    reference variance = 0.257055
====================================================
  Execution time = 1.4430e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5269e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7815e-01
  Total weights = 1.957210201e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4738e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267737145472
                                         uncertainty =       0.001539139112

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267737145472
                                         uncertainty =       0.001539139112

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365859736
  error estimate for blocks of size 2^( 2) =       0.000379978400
  error estimate for blocks of size 2^( 3) =       0.000392744880
  error estimate for blocks of size 2^( 4) =       0.000402561717
  error estimate for blocks of size 2^( 5) =       0.000408687069
  error estimate for blocks of size 2^( 6) =       0.000410891944
  error estimate for blocks of size 2^( 7) =       0.000411323780

      target function =      -0.948001795290
              le_mean =     -17.211823536123
             les_mean =     296.525022125206
             stat err =       0.000408366128
             autocorr =       1.245862722203
   target nu stat err =       0.000408366128
   target dn stat err =       0.002029482244
      target stat err =       0.003507378691
              std dev =       0.517403799957
             le_variance =       0.267706692210


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721182353612e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948013755844       residual = 4.73e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948054207299       residual = 8.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948065785521       residual = 8.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948067746241       residual = 2.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948068443628       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948068520706       residual = 8.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948068498471       residual = 1.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948068518366       residual = 3.34e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948068522006       residual = 5.89e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948068521856       residual = 1.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948068520945       residual = 1.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+00 is 7.944191e-05

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948013755844       residual = 4.73e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948024127999       residual = 8.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948027090924       residual = 8.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948027589239       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948027765884       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948027785190       residual = 8.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948027779417       residual = 1.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948027784426       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948027785320       residual = 5.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948027785283       residual = 1.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948027785056       residual = 1.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+00 is 2.037220e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948013755844       residual = 4.73e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948016365610       residual = 8.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948017110741       residual = 8.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948017235838       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948017280144       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948017284972       residual = 8.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948017283515       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948017284770       residual = 3.15e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948017284993       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948017284983       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948017284927       residual = 1.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+01 is 5.126073e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.164706 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6913e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_001                -4.191495e-02 3 1  ON 0
ci_002                -3.206007e-02 3 1  ON 1
ci_003                -2.641621e-02 3 1  ON 2
ci_004                 2.370367e-02 3 1  ON 3
ci_005                 2.409053e-02 3 1  ON 4
ci_006                -2.138099e-02 3 1  ON 5
ci_007                -2.099743e-02 3 1  ON 6
ci_008                -8.493209e-03 3 1  ON 7
ci_009                -1.384719e-02 3 1  ON 8
ci_010                -1.006910e-02 3 1  ON 9
ci_011                -1.125488e-02 3 1  ON 10
ci_012                -9.767461e-03 3 1  ON 11
ci_013                -1.985207e-02 3 1  ON 12
ci_014                 1.227097e-02 3 1  ON 13
ci_015                 1.196098e-02 3 1  ON 14
ci_016                 1.746764e-02 3 1  ON 15
ci_017                 1.636391e-02 3 1  ON 16
ci_018                 1.023989e-02 3 1  ON 17
ci_019                 1.011188e-02 3 1  ON 18
ci_020                 1.780802e-02 3 1  ON 19
ci_021                 1.749243e-02 3 1  ON 20
ci_022                 9.158279e-03 3 1  ON 21
ci_023                 9.191480e-03 3 1  ON 22
ci_024                 9.620666e-03 3 1  ON 23
ci_025                 1.015356e-02 3 1  ON 24
ci_026                 1.160996e-02 3 1  ON 25
ci_027                 1.167247e-02 3 1  ON 26
ci_028                -1.475045e-02 3 1  ON 27
ci_029                -1.646346e-02 3 1  ON 28
ci_030                -9.545800e-03 3 1  ON 29
ci_031                -8.991975e-03 3 1  ON 30
ci_032                -1.473242e-02 3 1  ON 31
ci_033                 5.281632e-03 3 1  ON 32
ci_034                 5.592209e-03 3 1  ON 33
ci_035                -5.091568e-03 3 1  ON 34
ci_036                -1.276084e-02 3 1  ON 35
ci_037                -1.241065e-02 3 1  ON 36
ci_038                 2.067310e-03 3 1  ON 37
ci_039                 1.746800e-03 3 1  ON 38
ci_040                -3.197338e-03 3 1  ON 39
ci_041                 9.443493e-03 3 1  ON 40
ci_042                 8.201782e-03 3 1  ON 41
ci_043                -4.079911e-03 3 1  ON 42
ci_044                -3.890593e-03 3 1  ON 43
ci_045                -3.580729e-03 3 1  ON 44
ci_046                 5.622591e-03 3 1  ON 45
ci_047                 5.547237e-03 3 1  ON 46
ci_048                -1.269058e-02 3 1  ON 47
ci_049                -1.441936e-02 3 1  ON 48
ci_050                 3.128946e-03 3 1  ON 49
ci_051                 2.813501e-03 3 1  ON 50
ci_052                -2.323364e-03 3 1  ON 51
ci_053                -2.442430e-03 3 1  ON 52
ci_054                -3.346085e-03 3 1  ON 53
ci_055                -2.962420e-03 3 1  ON 54
ci_056                 5.579245e-03 3 1  ON 55
ci_057                 5.313209e-03 3 1  ON 56
ci_058                -1.095986e-03 3 1  ON 57
ci_059                -2.172282e-03 3 1  ON 58
ci_060                 4.643962e-03 3 1  ON 59
ci_061                 5.641443e-03 3 1  ON 60
ci_062                -3.733966e-03 3 1  ON 61
ci_063                -4.025791e-03 3 1  ON 62
ci_064                -2.630873e-03 3 1  ON 63
ci_065                -4.352404e-03 3 1  ON 64
ci_066                 4.479489e-03 3 1  ON 65
ci_067                 4.359938e-03 3 1  ON 66
ci_068                -4.197026e-03 3 1  ON 67
ci_069                -5.003045e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.1846
    reference variance = 0.227968
====================================================
  Execution time = 1.5819e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7689e-01
  Total weights = 1.9572e+06
  Execution time = 1.8181e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265847574148
                                         uncertainty =       0.001277883027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265847574148
                                         uncertainty =       0.001277883027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364557610
  error estimate for blocks of size 2^( 2) =       0.000378450137
  error estimate for blocks of size 2^( 3) =       0.000391264464
  error estimate for blocks of size 2^( 4) =       0.000400665796
  error estimate for blocks of size 2^( 5) =       0.000406487135
  error estimate for blocks of size 2^( 6) =       0.000409002598
  error estimate for blocks of size 2^( 7) =       0.000412859342

      target function =      -0.950120283519
              le_mean =     -17.211448322095
             les_mean =     296.510849410907
             stat err =       0.000407253717
             autocorr =       1.247951700263
   target nu stat err =       0.000407253717
   target dn stat err =       0.002308265155
      target stat err =       0.003983913691
              std dev =       0.515562316725
             le_variance =       0.265804502427

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265832922142
                                         uncertainty =       0.001278685573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265832922142
                                         uncertainty =       0.001278685573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364547602
  error estimate for blocks of size 2^( 2) =       0.000378441555
  error estimate for blocks of size 2^( 3) =       0.000391259353
  error estimate for blocks of size 2^( 4) =       0.000400662066
  error estimate for blocks of size 2^( 5) =       0.000406484697
  error estimate for blocks of size 2^( 6) =       0.000408998620
  error estimate for blocks of size 2^( 7) =       0.000412857037

      target function =      -0.950101112854
              le_mean =     -17.211449013137
             les_mean =     296.510884341950
             stat err =       0.000407250605
             autocorr =       1.248001147414
   target nu stat err =       0.000407250605
   target dn stat err =       0.002328031762
      target stat err =       0.004016742959
              std dev =       0.515548162771
             le_variance =       0.265789908136

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265839779002
                                         uncertainty =       0.001278279454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265839779002
                                         uncertainty =       0.001278279454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364552285
  error estimate for blocks of size 2^( 2) =       0.000378445536
  error estimate for blocks of size 2^( 3) =       0.000391261637
  error estimate for blocks of size 2^( 4) =       0.000400663669
  error estimate for blocks of size 2^( 5) =       0.000406485665
  error estimate for blocks of size 2^( 6) =       0.000409000333
  error estimate for blocks of size 2^( 7) =       0.000412857937

      target function =      -0.950124451202
              le_mean =     -17.211448644397
             les_mean =     296.510857972866
             stat err =       0.000407251901
             autocorr =       1.247977026780
   target nu stat err =       0.000407251901
   target dn stat err =       0.002318049699
      target stat err =       0.004000276322
              std dev =       0.515554785744
             le_variance =       0.265796737104

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265846561294
                                         uncertainty =       0.001277931281

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265846561294
                                         uncertainty =       0.001277931281

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364556918
  error estimate for blocks of size 2^( 2) =       0.000378449536
  error estimate for blocks of size 2^( 3) =       0.000391264085
  error estimate for blocks of size 2^( 4) =       0.000400665505
  error estimate for blocks of size 2^( 5) =       0.000406486926
  error estimate for blocks of size 2^( 6) =       0.000409002289
  error estimate for blocks of size 2^( 7) =       0.000412859141

      target function =      -0.950122737438
              le_mean =     -17.211448358957
             les_mean =     296.510849224332
             stat err =       0.000407253465
             autocorr =       1.247954891544
   target nu stat err =       0.000407253465
   target dn stat err =       0.002309456294
      target stat err =       0.003985921517
              std dev =       0.515561338100
             le_variance =       0.265803493343


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.950120283519        initial
     2.3283e+00     2.3283e+01             7.9442e-05        -0.950101112854
     9.3132e+00     9.3132e+01             2.0372e-05        -0.950124451202  <--
     3.7253e+01     3.7253e+02             5.1261e-06        -0.950122737438

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 2.5006e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
ci_001                -4.191495e-02 3 1  ON 0
ci_002                -3.206007e-02 3 1  ON 1
ci_003                -2.641621e-02 3 1  ON 2
ci_004                 2.370367e-02 3 1  ON 3
ci_005                 2.409053e-02 3 1  ON 4
ci_006                -2.138099e-02 3 1  ON 5
ci_007                -2.099743e-02 3 1  ON 6
ci_008                -8.493209e-03 3 1  ON 7
ci_009                -1.384719e-02 3 1  ON 8
ci_010                -1.006910e-02 3 1  ON 9
ci_011                -1.125488e-02 3 1  ON 10
ci_012                -9.767461e-03 3 1  ON 11
ci_013                -1.985207e-02 3 1  ON 12
ci_014                 1.227097e-02 3 1  ON 13
ci_015                 1.196098e-02 3 1  ON 14
ci_016                 1.746764e-02 3 1  ON 15
ci_017                 1.636391e-02 3 1  ON 16
ci_018                 1.023989e-02 3 1  ON 17
ci_019                 1.011188e-02 3 1  ON 18
ci_020                 1.780802e-02 3 1  ON 19
ci_021                 1.749243e-02 3 1  ON 20
ci_022                 9.158279e-03 3 1  ON 21
ci_023                 9.191480e-03 3 1  ON 22
ci_024                 9.620666e-03 3 1  ON 23
ci_025                 1.015356e-02 3 1  ON 24
ci_026                 1.160996e-02 3 1  ON 25
ci_027                 1.167247e-02 3 1  ON 26
ci_028                -1.475045e-02 3 1  ON 27
ci_029                -1.646346e-02 3 1  ON 28
ci_030                -9.545800e-03 3 1  ON 29
ci_031                -8.991975e-03 3 1  ON 30
ci_032                -1.473242e-02 3 1  ON 31
ci_033                 5.281632e-03 3 1  ON 32
ci_034                 5.592209e-03 3 1  ON 33
ci_035                -5.091568e-03 3 1  ON 34
ci_036                -1.276084e-02 3 1  ON 35
ci_037                -1.241065e-02 3 1  ON 36
ci_038                 2.067310e-03 3 1  ON 37
ci_039                 1.746800e-03 3 1  ON 38
ci_040                -3.197338e-03 3 1  ON 39
ci_041                 9.443493e-03 3 1  ON 40
ci_042                 8.201782e-03 3 1  ON 41
ci_043                -4.079911e-03 3 1  ON 42
ci_044                -3.890593e-03 3 1  ON 43
ci_045                -3.580729e-03 3 1  ON 44
ci_046                 5.622591e-03 3 1  ON 45
ci_047                 5.547237e-03 3 1  ON 46
ci_048                -1.269058e-02 3 1  ON 47
ci_049                -1.441936e-02 3 1  ON 48
ci_050                 3.128946e-03 3 1  ON 49
ci_051                 2.813501e-03 3 1  ON 50
ci_052                -2.323364e-03 3 1  ON 51
ci_053                -2.442430e-03 3 1  ON 52
ci_054                -3.346085e-03 3 1  ON 53
ci_055                -2.962420e-03 3 1  ON 54
ci_056                 5.579245e-03 3 1  ON 55
ci_057                 5.313209e-03 3 1  ON 56
ci_058                -1.095986e-03 3 1  ON 57
ci_059                -2.172282e-03 3 1  ON 58
ci_060                 4.643962e-03 3 1  ON 59
ci_061                 5.641443e-03 3 1  ON 60
ci_062                -3.733966e-03 3 1  ON 61
ci_063                -4.025791e-03 3 1  ON 62
ci_064                -2.630873e-03 3 1  ON 63
ci_065                -4.352404e-03 3 1  ON 64
ci_066                 4.479489e-03 3 1  ON 65
ci_067                 4.359938e-03 3 1  ON 66
ci_068                -4.197026e-03 3 1  ON 67
ci_069                -5.003045e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1926e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.2352
    reference variance = 0.299783
====================================================
  Execution time = 1.4283e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8623e-01
  Total weights = 1.957164167e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4926e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269664844283
                                         uncertainty =       0.001909085997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269664844283
                                         uncertainty =       0.001909085997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367194487
  error estimate for blocks of size 2^( 2) =       0.000380939677
  error estimate for blocks of size 2^( 3) =       0.000393808213
  error estimate for blocks of size 2^( 4) =       0.000403693968
  error estimate for blocks of size 2^( 5) =       0.000409050924
  error estimate for blocks of size 2^( 6) =       0.000411291801
  error estimate for blocks of size 2^( 7) =       0.000410721027

      target function =      -0.934386792869
              le_mean =     -17.212467544854
             les_mean =     296.555273573677
             stat err =       0.000408689430
             autocorr =       1.238780917847
   target nu stat err =       0.000408689430
   target dn stat err =       0.007224015687
      target stat err =       0.011902208480
              std dev =       0.519291423972
             le_variance =       0.269663583011


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721246754485e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934536908576       residual = 4.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934608636449       residual = 3.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934616070977       residual = 7.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934618088176       residual = 1.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934618317273       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934618387999       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934618379739       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934618385781       residual = 4.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934618389828       residual = 7.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934618392711       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934618393655       residual = 3.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+00 is 1.257772e-04

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934536908576       residual = 4.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934555292967       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934557186625       residual = 7.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934557697804       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934557755090       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934557772680       residual = 7.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934557770518       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934557772015       residual = 3.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934557773043       residual = 6.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934557773755       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934557773985       residual = 2.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+00 is 3.217492e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934536908576       residual = 4.41e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934541533845       residual = 3.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934542009496       residual = 7.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934542137725       residual = 1.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934542152046       residual = 3.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934542156437       residual = 7.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.934542155890       residual = 1.78e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.934542156264       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.934542156522       residual = 6.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.934542156699       residual = 1.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.934542156756       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+01 is 8.090728e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.168776 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6786e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_001                -4.190705e-02 3 1  ON 0
ci_002                -3.205738e-02 3 1  ON 1
ci_003                -2.639992e-02 3 1  ON 2
ci_004                 2.370917e-02 3 1  ON 3
ci_005                 2.409144e-02 3 1  ON 4
ci_006                -2.137925e-02 3 1  ON 5
ci_007                -2.099017e-02 3 1  ON 6
ci_008                -8.485927e-03 3 1  ON 7
ci_009                -1.385203e-02 3 1  ON 8
ci_010                -1.005386e-02 3 1  ON 9
ci_011                -1.125302e-02 3 1  ON 10
ci_012                -9.773889e-03 3 1  ON 11
ci_013                -1.985917e-02 3 1  ON 12
ci_014                 1.227775e-02 3 1  ON 13
ci_015                 1.197147e-02 3 1  ON 14
ci_016                 1.745140e-02 3 1  ON 15
ci_017                 1.636461e-02 3 1  ON 16
ci_018                 1.024163e-02 3 1  ON 17
ci_019                 1.011477e-02 3 1  ON 18
ci_020                 1.780147e-02 3 1  ON 19
ci_021                 1.748880e-02 3 1  ON 20
ci_022                 9.160575e-03 3 1  ON 21
ci_023                 9.197477e-03 3 1  ON 22
ci_024                 9.609698e-03 3 1  ON 23
ci_025                 1.015329e-02 3 1  ON 24
ci_026                 1.160198e-02 3 1  ON 25
ci_027                 1.166029e-02 3 1  ON 26
ci_028                -1.475762e-02 3 1  ON 27
ci_029                -1.646427e-02 3 1  ON 28
ci_030                -9.546233e-03 3 1  ON 29
ci_031                -8.990987e-03 3 1  ON 30
ci_032                -1.472660e-02 3 1  ON 31
ci_033                 5.284978e-03 3 1  ON 32
ci_034                 5.591290e-03 3 1  ON 33
ci_035                -5.095005e-03 3 1  ON 34
ci_036                -1.274406e-02 3 1  ON 35
ci_037                -1.241859e-02 3 1  ON 36
ci_038                 2.046449e-03 3 1  ON 37
ci_039                 1.744383e-03 3 1  ON 38
ci_040                -3.187041e-03 3 1  ON 39
ci_041                 9.433771e-03 3 1  ON 40
ci_042                 8.201950e-03 3 1  ON 41
ci_043                -4.070721e-03 3 1  ON 42
ci_044                -3.895637e-03 3 1  ON 43
ci_045                -3.579191e-03 3 1  ON 44
ci_046                 5.626489e-03 3 1  ON 45
ci_047                 5.546612e-03 3 1  ON 46
ci_048                -1.268351e-02 3 1  ON 47
ci_049                -1.441307e-02 3 1  ON 48
ci_050                 3.140245e-03 3 1  ON 49
ci_051                 2.808989e-03 3 1  ON 50
ci_052                -2.329146e-03 3 1  ON 51
ci_053                -2.437024e-03 3 1  ON 52
ci_054                -3.378260e-03 3 1  ON 53
ci_055                -2.955370e-03 3 1  ON 54
ci_056                 5.578996e-03 3 1  ON 55
ci_057                 5.319137e-03 3 1  ON 56
ci_058                -1.104886e-03 3 1  ON 57
ci_059                -2.161578e-03 3 1  ON 58
ci_060                 4.645753e-03 3 1  ON 59
ci_061                 5.628567e-03 3 1  ON 60
ci_062                -3.757573e-03 3 1  ON 61
ci_063                -4.015887e-03 3 1  ON 62
ci_064                -2.634106e-03 3 1  ON 63
ci_065                -4.355607e-03 3 1  ON 64
ci_066                 4.478821e-03 3 1  ON 65
ci_067                 4.343343e-03 3 1  ON 66
ci_068                -4.194826e-03 3 1  ON 67
ci_069                -4.998968e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.2708
    reference variance = 0.168362
====================================================
  Execution time = 1.3716e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8064e-01
  Total weights = 1.9573e+06
  Execution time = 1.8038e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267487774755
                                         uncertainty =       0.001579584734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267487774755
                                         uncertainty =       0.001579584734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365697428
  error estimate for blocks of size 2^( 2) =       0.000379764258
  error estimate for blocks of size 2^( 3) =       0.000392183043
  error estimate for blocks of size 2^( 4) =       0.000401630328
  error estimate for blocks of size 2^( 5) =       0.000406790317
  error estimate for blocks of size 2^( 6) =       0.000409254858
  error estimate for blocks of size 2^( 7) =       0.000411276335

      target function =      -0.943785446899
              le_mean =     -17.211925230548
             les_mean =     296.531027092774
             stat err =       0.000407237959
             autocorr =       1.240088539699
   target nu stat err =       0.000407237959
   target dn stat err =       0.002208422079
      target stat err =       0.003771015691
              std dev =       0.517174261869
             le_variance =       0.267469217140

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267473713026
                                         uncertainty =       0.001579429102

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267473713026
                                         uncertainty =       0.001579429102

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365687869
  error estimate for blocks of size 2^( 2) =       0.000379757738
  error estimate for blocks of size 2^( 3) =       0.000392181245
  error estimate for blocks of size 2^( 4) =       0.000401631626
  error estimate for blocks of size 2^( 5) =       0.000406794189
  error estimate for blocks of size 2^( 6) =       0.000409258759
  error estimate for blocks of size 2^( 7) =       0.000411278171

      target function =      -0.943518943424
              le_mean =     -17.211924996936
             les_mean =     296.531178101617
             stat err =       0.000407240686
             autocorr =       1.240169975462
   target nu stat err =       0.000407240686
   target dn stat err =       0.002210983691
      target stat err =       0.003773135759
              std dev =       0.517160744419
             le_variance =       0.267455235568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267480091937
                                         uncertainty =       0.001579492223

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267480091937
                                         uncertainty =       0.001579492223

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365692204
  error estimate for blocks of size 2^( 2) =       0.000379760611
  error estimate for blocks of size 2^( 3) =       0.000392181823
  error estimate for blocks of size 2^( 4) =       0.000401630695
  error estimate for blocks of size 2^( 5) =       0.000406792040
  error estimate for blocks of size 2^( 6) =       0.000409256612
  error estimate for blocks of size 2^( 7) =       0.000411277050

      target function =      -0.943846771384
              le_mean =     -17.211925059946
             les_mean =     296.530984666521
             stat err =       0.000407239099
             autocorr =       1.240130911772
   target nu stat err =       0.000407239099
   target dn stat err =       0.002203507428
      target stat err =       0.003763411474
              std dev =       0.517166874288
             le_variance =       0.267461575860

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267486752721
                                         uncertainty =       0.001579571531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267486752721
                                         uncertainty =       0.001579571531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365696733
  error estimate for blocks of size 2^( 2) =       0.000379763761
  error estimate for blocks of size 2^( 3) =       0.000392182852
  error estimate for blocks of size 2^( 4) =       0.000401630337
  error estimate for blocks of size 2^( 5) =       0.000406790496
  error estimate for blocks of size 2^( 6) =       0.000409255042
  error estimate for blocks of size 2^( 7) =       0.000411276391

      target function =      -0.943794784766
              le_mean =     -17.211925202715
             les_mean =     296.531020567643
             stat err =       0.000407238067
             autocorr =       1.240093908230
   target nu stat err =       0.000407238067
   target dn stat err =       0.002207768951
      target stat err =       0.003770014485
              std dev =       0.517173278877
             le_variance =       0.267468200384


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943785446899        initial
     2.3283e+00     2.3283e+01             1.2578e-04        -0.943518943424
     9.3132e+00     9.3132e+01             3.2175e-05        -0.943846771384  <--
     3.7253e+01     3.7253e+02             8.0907e-06        -0.943794784766

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 2.2880e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
ci_001                -4.190705e-02 3 1  ON 0
ci_002                -3.205738e-02 3 1  ON 1
ci_003                -2.639992e-02 3 1  ON 2
ci_004                 2.370917e-02 3 1  ON 3
ci_005                 2.409144e-02 3 1  ON 4
ci_006                -2.137925e-02 3 1  ON 5
ci_007                -2.099017e-02 3 1  ON 6
ci_008                -8.485927e-03 3 1  ON 7
ci_009                -1.385203e-02 3 1  ON 8
ci_010                -1.005386e-02 3 1  ON 9
ci_011                -1.125302e-02 3 1  ON 10
ci_012                -9.773889e-03 3 1  ON 11
ci_013                -1.985917e-02 3 1  ON 12
ci_014                 1.227775e-02 3 1  ON 13
ci_015                 1.197147e-02 3 1  ON 14
ci_016                 1.745140e-02 3 1  ON 15
ci_017                 1.636461e-02 3 1  ON 16
ci_018                 1.024163e-02 3 1  ON 17
ci_019                 1.011477e-02 3 1  ON 18
ci_020                 1.780147e-02 3 1  ON 19
ci_021                 1.748880e-02 3 1  ON 20
ci_022                 9.160575e-03 3 1  ON 21
ci_023                 9.197477e-03 3 1  ON 22
ci_024                 9.609698e-03 3 1  ON 23
ci_025                 1.015329e-02 3 1  ON 24
ci_026                 1.160198e-02 3 1  ON 25
ci_027                 1.166029e-02 3 1  ON 26
ci_028                -1.475762e-02 3 1  ON 27
ci_029                -1.646427e-02 3 1  ON 28
ci_030                -9.546233e-03 3 1  ON 29
ci_031                -8.990987e-03 3 1  ON 30
ci_032                -1.472660e-02 3 1  ON 31
ci_033                 5.284978e-03 3 1  ON 32
ci_034                 5.591290e-03 3 1  ON 33
ci_035                -5.095005e-03 3 1  ON 34
ci_036                -1.274406e-02 3 1  ON 35
ci_037                -1.241859e-02 3 1  ON 36
ci_038                 2.046449e-03 3 1  ON 37
ci_039                 1.744383e-03 3 1  ON 38
ci_040                -3.187041e-03 3 1  ON 39
ci_041                 9.433771e-03 3 1  ON 40
ci_042                 8.201950e-03 3 1  ON 41
ci_043                -4.070721e-03 3 1  ON 42
ci_044                -3.895637e-03 3 1  ON 43
ci_045                -3.579191e-03 3 1  ON 44
ci_046                 5.626489e-03 3 1  ON 45
ci_047                 5.546612e-03 3 1  ON 46
ci_048                -1.268351e-02 3 1  ON 47
ci_049                -1.441307e-02 3 1  ON 48
ci_050                 3.140245e-03 3 1  ON 49
ci_051                 2.808989e-03 3 1  ON 50
ci_052                -2.329146e-03 3 1  ON 51
ci_053                -2.437024e-03 3 1  ON 52
ci_054                -3.378260e-03 3 1  ON 53
ci_055                -2.955370e-03 3 1  ON 54
ci_056                 5.578996e-03 3 1  ON 55
ci_057                 5.319137e-03 3 1  ON 56
ci_058                -1.104886e-03 3 1  ON 57
ci_059                -2.161578e-03 3 1  ON 58
ci_060                 4.645753e-03 3 1  ON 59
ci_061                 5.628567e-03 3 1  ON 60
ci_062                -3.757573e-03 3 1  ON 61
ci_063                -4.015887e-03 3 1  ON 62
ci_064                -2.634106e-03 3 1  ON 63
ci_065                -4.355607e-03 3 1  ON 64
ci_066                 4.478821e-03 3 1  ON 65
ci_067                 4.343343e-03 3 1  ON 66
ci_068                -4.194826e-03 3 1  ON 67
ci_069                -4.998968e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9672e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.2499
    reference variance = 0.196247
====================================================
  Execution time = 1.4256e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8180e-01
  Total weights = 1.957322508e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4856e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268088583771
                                         uncertainty =       0.001524194538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268088583771
                                         uncertainty =       0.001524194538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366152359
  error estimate for blocks of size 2^( 2) =       0.000379976566
  error estimate for blocks of size 2^( 3) =       0.000392908931
  error estimate for blocks of size 2^( 4) =       0.000402297740
  error estimate for blocks of size 2^( 5) =       0.000407293500
  error estimate for blocks of size 2^( 6) =       0.000410064032
  error estimate for blocks of size 2^( 7) =       0.000413731753

      target function =      -0.941868616610
              le_mean =     -17.212217541356
             les_mean =     296.542229357691
             stat err =       0.000408346756
             autocorr =       1.243754163553
   target nu stat err =       0.000408346756
   target dn stat err =       0.002953728556
      target stat err =       0.004985609228
              std dev =       0.517817631404
             le_variance =       0.268135099393


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721221754136e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941893857182       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941920103590       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941925203524       residual = 6.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941926357406       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941926662112       residual = 2.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941926746031       residual = 3.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941926745856       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941926747466       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941926743251       residual = 4.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941926742571       residual = 7.63e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+00 is 8.128790e-05

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941893857182       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941900586939       residual = 2.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941901885680       residual = 6.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941902176954       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941902253632       residual = 2.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941902274764       residual = 3.69e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941902274591       residual = 6.21e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941902275008       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941902273962       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941902273794       residual = 7.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+00 is 2.074947e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941893857182       residual = 1.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941895550469       residual = 2.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941895876671       residual = 6.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941895949664       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941895968864       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941895974156       residual = 3.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941895974105       residual = 6.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941895974210       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941895973949       residual = 3.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941895973907       residual = 7.02e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+01 is 5.214799e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.172224 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6751e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_001                -4.190473e-02 3 1  ON 0
ci_002                -3.205932e-02 3 1  ON 1
ci_003                -2.638300e-02 3 1  ON 2
ci_004                 2.369968e-02 3 1  ON 3
ci_005                 2.408520e-02 3 1  ON 4
ci_006                -2.137867e-02 3 1  ON 5
ci_007                -2.098641e-02 3 1  ON 6
ci_008                -8.482090e-03 3 1  ON 7
ci_009                -1.385572e-02 3 1  ON 8
ci_010                -1.004420e-02 3 1  ON 9
ci_011                -1.124344e-02 3 1  ON 10
ci_012                -9.771968e-03 3 1  ON 11
ci_013                -1.985844e-02 3 1  ON 12
ci_014                 1.227871e-02 3 1  ON 13
ci_015                 1.196627e-02 3 1  ON 14
ci_016                 1.745019e-02 3 1  ON 15
ci_017                 1.636424e-02 3 1  ON 16
ci_018                 1.024110e-02 3 1  ON 17
ci_019                 1.011364e-02 3 1  ON 18
ci_020                 1.780375e-02 3 1  ON 19
ci_021                 1.746805e-02 3 1  ON 20
ci_022                 9.150805e-03 3 1  ON 21
ci_023                 9.206576e-03 3 1  ON 22
ci_024                 9.607740e-03 3 1  ON 23
ci_025                 1.015597e-02 3 1  ON 24
ci_026                 1.159762e-02 3 1  ON 25
ci_027                 1.166517e-02 3 1  ON 26
ci_028                -1.477037e-02 3 1  ON 27
ci_029                -1.646726e-02 3 1  ON 28
ci_030                -9.550205e-03 3 1  ON 29
ci_031                -8.991799e-03 3 1  ON 30
ci_032                -1.472088e-02 3 1  ON 31
ci_033                 5.283966e-03 3 1  ON 32
ci_034                 5.588422e-03 3 1  ON 33
ci_035                -5.093421e-03 3 1  ON 34
ci_036                -1.272870e-02 3 1  ON 35
ci_037                -1.241188e-02 3 1  ON 36
ci_038                 2.048741e-03 3 1  ON 37
ci_039                 1.749527e-03 3 1  ON 38
ci_040                -3.181290e-03 3 1  ON 39
ci_041                 9.430391e-03 3 1  ON 40
ci_042                 8.210118e-03 3 1  ON 41
ci_043                -4.065756e-03 3 1  ON 42
ci_044                -3.902640e-03 3 1  ON 43
ci_045                -3.573791e-03 3 1  ON 44
ci_046                 5.629538e-03 3 1  ON 45
ci_047                 5.553218e-03 3 1  ON 46
ci_048                -1.268376e-02 3 1  ON 47
ci_049                -1.440446e-02 3 1  ON 48
ci_050                 3.144281e-03 3 1  ON 49
ci_051                 2.815774e-03 3 1  ON 50
ci_052                -2.334622e-03 3 1  ON 51
ci_053                -2.449226e-03 3 1  ON 52
ci_054                -3.366458e-03 3 1  ON 53
ci_055                -2.947106e-03 3 1  ON 54
ci_056                 5.571199e-03 3 1  ON 55
ci_057                 5.316584e-03 3 1  ON 56
ci_058                -1.101578e-03 3 1  ON 57
ci_059                -2.166823e-03 3 1  ON 58
ci_060                 4.641346e-03 3 1  ON 59
ci_061                 5.618169e-03 3 1  ON 60
ci_062                -3.758378e-03 3 1  ON 61
ci_063                -4.019026e-03 3 1  ON 62
ci_064                -2.637504e-03 3 1  ON 63
ci_065                -4.356305e-03 3 1  ON 64
ci_066                 4.474904e-03 3 1  ON 65
ci_067                 4.340908e-03 3 1  ON 66
ci_068                -4.191237e-03 3 1  ON 67
ci_069                -4.996267e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.177
    reference variance = 0.273393
====================================================
  Execution time = 1.3828e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7829e-01
  Total weights = 1.9572e+06
  Execution time = 1.8292e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267348241613
                                         uncertainty =       0.001300089692

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267348241613
                                         uncertainty =       0.001300089692

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365594909
  error estimate for blocks of size 2^( 2) =       0.000379957333
  error estimate for blocks of size 2^( 3) =       0.000392769372
  error estimate for blocks of size 2^( 4) =       0.000402478629
  error estimate for blocks of size 2^( 5) =       0.000407570615
  error estimate for blocks of size 2^( 6) =       0.000410214681
  error estimate for blocks of size 2^( 7) =       0.000414429543

      target function =      -0.947784060466
              le_mean =     -17.211809512261
             les_mean =     296.524669685765
             stat err =       0.000408673367
             autocorr =       1.249546417578
   target nu stat err =       0.000408673367
   target dn stat err =       0.001796681835
      target stat err =       0.003122104047
              std dev =       0.517029278118
             le_variance =       0.267319274432

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267337963021
                                         uncertainty =       0.001300041738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267337963021
                                         uncertainty =       0.001300041738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365587815
  error estimate for blocks of size 2^( 2) =       0.000379952559
  error estimate for blocks of size 2^( 3) =       0.000392766865
  error estimate for blocks of size 2^( 4) =       0.000402477275
  error estimate for blocks of size 2^( 5) =       0.000407572064
  error estimate for blocks of size 2^( 6) =       0.000410218416
  error estimate for blocks of size 2^( 7) =       0.000414432672

      target function =      -0.947646647174
              le_mean =     -17.211810531358
             les_mean =     296.524786087280
             stat err =       0.000408675107
             autocorr =       1.249605551307
   target nu stat err =       0.000408675107
   target dn stat err =       0.001800428268
      target stat err =       0.003127384466
              std dev =       0.517019245795
             le_variance =       0.267308900522

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267342781885
                                         uncertainty =       0.001300060254

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267342781885
                                         uncertainty =       0.001300060254

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365591142
  error estimate for blocks of size 2^( 2) =       0.000379954748
  error estimate for blocks of size 2^( 3) =       0.000392767932
  error estimate for blocks of size 2^( 4) =       0.000402477777
  error estimate for blocks of size 2^( 5) =       0.000407571193
  error estimate for blocks of size 2^( 6) =       0.000410216447
  error estimate for blocks of size 2^( 7) =       0.000414430996

      target function =      -0.947756539755
              le_mean =     -17.211810000512
             les_mean =     296.524702778065
             stat err =       0.000408674103
             autocorr =       1.249576670646
   target nu stat err =       0.000408674103
   target dn stat err =       0.001797761633
      target stat err =       0.003123704994
              std dev =       0.517023951080
             le_variance =       0.267313765991

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267347532818
                                         uncertainty =       0.001300085633

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267347532818
                                         uncertainty =       0.001300085633

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365594420
  error estimate for blocks of size 2^( 2) =       0.000379956992
  error estimate for blocks of size 2^( 3) =       0.000392769175
  error estimate for blocks of size 2^( 4) =       0.000402478506
  error estimate for blocks of size 2^( 5) =       0.000407570672
  error estimate for blocks of size 2^( 6) =       0.000410214887
  error estimate for blocks of size 2^( 7) =       0.000414429710

      target function =      -0.947785883172
              le_mean =     -17.211809570355
             les_mean =     296.524670606654
             stat err =       0.000408673444
             autocorr =       1.249550228288
   target nu stat err =       0.000408673444
   target dn stat err =       0.001796785006
      target stat err =       0.003122285623
              std dev =       0.517028586746
             le_variance =       0.267318559513


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947784060466        initial
     2.3283e+00     2.3283e+01             8.1288e-05        -0.947646647174
     9.3132e+00     9.3132e+01             2.0749e-05        -0.947756539755
     3.7253e+01     3.7253e+02             5.2148e-06        -0.947785883172  <--

*****************************************************************************
Applying the update for shift_i =   3.7253e+01     and shift_s =   3.7253e+02
*****************************************************************************

  Execution time = 2.3203e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
ci_001                -4.190646e-02 3 1  ON 0
ci_002                -3.205787e-02 3 1  ON 1
ci_003                -2.639567e-02 3 1  ON 2
ci_004                 2.370679e-02 3 1  ON 3
ci_005                 2.408987e-02 3 1  ON 4
ci_006                -2.137911e-02 3 1  ON 5
ci_007                -2.098922e-02 3 1  ON 6
ci_008                -8.484963e-03 3 1  ON 7
ci_009                -1.385296e-02 3 1  ON 8
ci_010                -1.005143e-02 3 1  ON 9
ci_011                -1.125061e-02 3 1  ON 10
ci_012                -9.773406e-03 3 1  ON 11
ci_013                -1.985898e-02 3 1  ON 12
ci_014                 1.227799e-02 3 1  ON 13
ci_015                 1.197016e-02 3 1  ON 14
ci_016                 1.745109e-02 3 1  ON 15
ci_017                 1.636452e-02 3 1  ON 16
ci_018                 1.024150e-02 3 1  ON 17
ci_019                 1.011448e-02 3 1  ON 18
ci_020                 1.780204e-02 3 1  ON 19
ci_021                 1.748358e-02 3 1  ON 20
ci_022                 9.158120e-03 3 1  ON 21
ci_023                 9.199765e-03 3 1  ON 22
ci_024                 9.609206e-03 3 1  ON 23
ci_025                 1.015396e-02 3 1  ON 24
ci_026                 1.160088e-02 3 1  ON 25
ci_027                 1.166152e-02 3 1  ON 26
ci_028                -1.476082e-02 3 1  ON 27
ci_029                -1.646502e-02 3 1  ON 28
ci_030                -9.547232e-03 3 1  ON 29
ci_031                -8.991193e-03 3 1  ON 30
ci_032                -1.472516e-02 3 1  ON 31
ci_033                 5.284723e-03 3 1  ON 32
ci_034                 5.590569e-03 3 1  ON 33
ci_035                -5.094607e-03 3 1  ON 34
ci_036                -1.274020e-02 3 1  ON 35
ci_037                -1.241691e-02 3 1  ON 36
ci_038                 2.047025e-03 3 1  ON 37
ci_039                 1.745677e-03 3 1  ON 38
ci_040                -3.185594e-03 3 1  ON 39
ci_041                 9.432919e-03 3 1  ON 40
ci_042                 8.204004e-03 3 1  ON 41
ci_043                -4.069472e-03 3 1  ON 42
ci_044                -3.897398e-03 3 1  ON 43
ci_045                -3.577832e-03 3 1  ON 44
ci_046                 5.627256e-03 3 1  ON 45
ci_047                 5.548273e-03 3 1  ON 46
ci_048                -1.268357e-02 3 1  ON 47
ci_049                -1.441090e-02 3 1  ON 48
ci_050                 3.141261e-03 3 1  ON 49
ci_051                 2.810696e-03 3 1  ON 50
ci_052                -2.330525e-03 3 1  ON 51
ci_053                -2.440093e-03 3 1  ON 52
ci_054                -3.375292e-03 3 1  ON 53
ci_055                -2.953291e-03 3 1  ON 54
ci_056                 5.577035e-03 3 1  ON 55
ci_057                 5.318495e-03 3 1  ON 56
ci_058                -1.104053e-03 3 1  ON 57
ci_059                -2.162898e-03 3 1  ON 58
ci_060                 4.644645e-03 3 1  ON 59
ci_061                 5.625953e-03 3 1  ON 60
ci_062                -3.757775e-03 3 1  ON 61
ci_063                -4.016677e-03 3 1  ON 62
ci_064                -2.634961e-03 3 1  ON 63
ci_065                -4.355783e-03 3 1  ON 64
ci_066                 4.477836e-03 3 1  ON 65
ci_067                 4.342731e-03 3 1  ON 66
ci_068                -4.193923e-03 3 1  ON 67
ci_069                -4.998289e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9960e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.2098
    reference variance = 0.20031
====================================================
  Execution time = 1.4273e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5296e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7977e-01
  Total weights = 1.957212838e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4745e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267251739973
                                         uncertainty =       0.001642604231

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267251739973
                                         uncertainty =       0.001642604231

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365519135
  error estimate for blocks of size 2^( 2) =       0.000379355064
  error estimate for blocks of size 2^( 3) =       0.000391656786
  error estimate for blocks of size 2^( 4) =       0.000400274591
  error estimate for blocks of size 2^( 5) =       0.000405313351
  error estimate for blocks of size 2^( 6) =       0.000407946991
  error estimate for blocks of size 2^( 7) =       0.000409943628

      target function =      -0.945277517635
              le_mean =     -17.212323752942
             les_mean =     296.543858239445
             stat err =       0.000405869640
             autocorr =       1.232971103831
   target nu stat err =       0.000405869640
   target dn stat err =       0.002279408793
      target stat err =       0.003902408674
              std dev =       0.516922118265
             le_variance =       0.267208476352


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721232375294e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945292745735       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945299261980       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945300046585       residual = 6.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945300302573       residual = 6.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945300292511       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945300300452       residual = 3.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945300301423       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945300301713       residual = 1.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945300301115       residual = 1.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945300301355       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+00 is 1.618402e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945292745735       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945294385386       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945294582496       residual = 6.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945294646694       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945294644144       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945294646130       residual = 3.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945294646373       residual = 4.93e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945294646446       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945294646297       residual = 1.85e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945294646357       residual = 3.15e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+01 is 4.068627e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945292745735       residual = 1.43e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945293156315       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945293205653       residual = 6.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945293221715       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945293221075       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945293221572       residual = 3.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945293221633       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945293221651       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945293221614       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945293221629       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+02 is 1.018581e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.175711 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6757e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_001                -4.190434e-02 3 1  ON 0
ci_002                -3.205557e-02 3 1  ON 1
ci_003                -2.639160e-02 3 1  ON 2
ci_004                 2.370693e-02 3 1  ON 3
ci_005                 2.408755e-02 3 1  ON 4
ci_006                -2.137844e-02 3 1  ON 5
ci_007                -2.098926e-02 3 1  ON 6
ci_008                -8.485330e-03 3 1  ON 7
ci_009                -1.385426e-02 3 1  ON 8
ci_010                -1.005109e-02 3 1  ON 9
ci_011                -1.124953e-02 3 1  ON 10
ci_012                -9.775713e-03 3 1  ON 11
ci_013                -1.985917e-02 3 1  ON 12
ci_014                 1.227782e-02 3 1  ON 13
ci_015                 1.197216e-02 3 1  ON 14
ci_016                 1.744975e-02 3 1  ON 15
ci_017                 1.636115e-02 3 1  ON 16
ci_018                 1.024202e-02 3 1  ON 17
ci_019                 1.011489e-02 3 1  ON 18
ci_020                 1.779884e-02 3 1  ON 19
ci_021                 1.748041e-02 3 1  ON 20
ci_022                 9.158992e-03 3 1  ON 21
ci_023                 9.199500e-03 3 1  ON 22
ci_024                 9.609339e-03 3 1  ON 23
ci_025                 1.015051e-02 3 1  ON 24
ci_026                 1.159816e-02 3 1  ON 25
ci_027                 1.166111e-02 3 1  ON 26
ci_028                -1.476204e-02 3 1  ON 27
ci_029                -1.646412e-02 3 1  ON 28
ci_030                -9.547493e-03 3 1  ON 29
ci_031                -8.994139e-03 3 1  ON 30
ci_032                -1.472437e-02 3 1  ON 31
ci_033                 5.284468e-03 3 1  ON 32
ci_034                 5.593182e-03 3 1  ON 33
ci_035                -5.094958e-03 3 1  ON 34
ci_036                -1.274129e-02 3 1  ON 35
ci_037                -1.241561e-02 3 1  ON 36
ci_038                 2.045551e-03 3 1  ON 37
ci_039                 1.744525e-03 3 1  ON 38
ci_040                -3.185266e-03 3 1  ON 39
ci_041                 9.431267e-03 3 1  ON 40
ci_042                 8.204805e-03 3 1  ON 41
ci_043                -4.069063e-03 3 1  ON 42
ci_044                -3.897631e-03 3 1  ON 43
ci_045                -3.576759e-03 3 1  ON 44
ci_046                 5.624896e-03 3 1  ON 45
ci_047                 5.547792e-03 3 1  ON 46
ci_048                -1.268446e-02 3 1  ON 47
ci_049                -1.440774e-02 3 1  ON 48
ci_050                 3.140807e-03 3 1  ON 49
ci_051                 2.811480e-03 3 1  ON 50
ci_052                -2.331197e-03 3 1  ON 51
ci_053                -2.440916e-03 3 1  ON 52
ci_054                -3.373982e-03 3 1  ON 53
ci_055                -2.952967e-03 3 1  ON 54
ci_056                 5.577173e-03 3 1  ON 55
ci_057                 5.318380e-03 3 1  ON 56
ci_058                -1.106303e-03 3 1  ON 57
ci_059                -2.160938e-03 3 1  ON 58
ci_060                 4.644554e-03 3 1  ON 59
ci_061                 5.625730e-03 3 1  ON 60
ci_062                -3.756324e-03 3 1  ON 61
ci_063                -4.016738e-03 3 1  ON 62
ci_064                -2.636306e-03 3 1  ON 63
ci_065                -4.355481e-03 3 1  ON 64
ci_066                 4.476543e-03 3 1  ON 65
ci_067                 4.343481e-03 3 1  ON 66
ci_068                -4.195358e-03 3 1  ON 67
ci_069                -5.000742e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.1925
    reference variance = 0.22347
====================================================
  Execution time = 1.3891e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7859e-01
  Total weights = 1.9573e+06
  Execution time = 1.8126e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267855419179
                                         uncertainty =       0.001499431888

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267855419179
                                         uncertainty =       0.001499431888

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365974364
  error estimate for blocks of size 2^( 2) =       0.000379923814
  error estimate for blocks of size 2^( 3) =       0.000392514756
  error estimate for blocks of size 2^( 4) =       0.000401560455
  error estimate for blocks of size 2^( 5) =       0.000408132279
  error estimate for blocks of size 2^( 6) =       0.000410756396
  error estimate for blocks of size 2^( 7) =       0.000411681291

      target function =      -0.947271088420
              le_mean =     -17.212366690797
             les_mean =     296.544156697559
             stat err =       0.000408032605
             autocorr =       1.243049455570
   target nu stat err =       0.000408032605
   target dn stat err =       0.001957106114
      target stat err =       0.003386013386
              std dev =       0.517565908688
             le_variance =       0.267874469836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267850003274
                                         uncertainty =       0.001499401179

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267850003274
                                         uncertainty =       0.001499401179

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365970668
  error estimate for blocks of size 2^( 2) =       0.000379920351
  error estimate for blocks of size 2^( 3) =       0.000392511645
  error estimate for blocks of size 2^( 4) =       0.000401557765
  error estimate for blocks of size 2^( 5) =       0.000408129216
  error estimate for blocks of size 2^( 6) =       0.000410753031
  error estimate for blocks of size 2^( 7) =       0.000411679240

      target function =      -0.947271901054
              le_mean =     -17.212366760334
             les_mean =     296.544158604646
             stat err =       0.000408029813
             autocorr =       1.243057547790
   target nu stat err =       0.000408029813
   target dn stat err =       0.001958009491
      target stat err =       0.003387509222
              std dev =       0.517560681960
             le_variance =       0.267869059511

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267852681783
                                         uncertainty =       0.001499416277

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267852681783
                                         uncertainty =       0.001499416277

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365972496
  error estimate for blocks of size 2^( 2) =       0.000379922062
  error estimate for blocks of size 2^( 3) =       0.000392513181
  error estimate for blocks of size 2^( 4) =       0.000401559092
  error estimate for blocks of size 2^( 5) =       0.000408130728
  error estimate for blocks of size 2^( 6) =       0.000410754693
  error estimate for blocks of size 2^( 7) =       0.000411680249

      target function =      -0.947272170417
              le_mean =     -17.212366724177
             les_mean =     296.544157203544
             stat err =       0.000408031191
             autocorr =       1.243053525978
   target nu stat err =       0.000408031191
   target dn stat err =       0.001957536987
      target stat err =       0.003386731653
              std dev =       0.517563266913
             le_variance =       0.267871735258

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267855075080
                                         uncertainty =       0.001499429919

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267855075080
                                         uncertainty =       0.001499429919

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365974129
  error estimate for blocks of size 2^( 2) =       0.000379923593
  error estimate for blocks of size 2^( 3) =       0.000392514558
  error estimate for blocks of size 2^( 4) =       0.000401560283
  error estimate for blocks of size 2^( 5) =       0.000408132084
  error estimate for blocks of size 2^( 6) =       0.000410756182
  error estimate for blocks of size 2^( 7) =       0.000411681160

      target function =      -0.947271298603
              le_mean =     -17.212366694798
             les_mean =     296.544156710551
             stat err =       0.000408032427
             autocorr =       1.243049965627
   target nu stat err =       0.000408032427
   target dn stat err =       0.001957157534
      target stat err =       0.003386099665
              std dev =       0.517565576609
             le_variance =       0.267874126090


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947271088420        initial
     9.3132e+00     9.3132e+01             1.6184e-05        -0.947271901054
     3.7253e+01     3.7253e+02             4.0686e-06        -0.947272170417  <--
     1.4901e+02     1.4901e+03             1.0186e-06        -0.947271298603

*****************************************************************************
Applying the update for shift_i =   3.7253e+01     and shift_s =   3.7253e+02
*****************************************************************************

  Execution time = 2.3138e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
ci_001                -4.190434e-02 3 1  ON 0
ci_002                -3.205557e-02 3 1  ON 1
ci_003                -2.639160e-02 3 1  ON 2
ci_004                 2.370693e-02 3 1  ON 3
ci_005                 2.408755e-02 3 1  ON 4
ci_006                -2.137844e-02 3 1  ON 5
ci_007                -2.098926e-02 3 1  ON 6
ci_008                -8.485330e-03 3 1  ON 7
ci_009                -1.385426e-02 3 1  ON 8
ci_010                -1.005109e-02 3 1  ON 9
ci_011                -1.124953e-02 3 1  ON 10
ci_012                -9.775713e-03 3 1  ON 11
ci_013                -1.985917e-02 3 1  ON 12
ci_014                 1.227782e-02 3 1  ON 13
ci_015                 1.197216e-02 3 1  ON 14
ci_016                 1.744975e-02 3 1  ON 15
ci_017                 1.636115e-02 3 1  ON 16
ci_018                 1.024202e-02 3 1  ON 17
ci_019                 1.011489e-02 3 1  ON 18
ci_020                 1.779884e-02 3 1  ON 19
ci_021                 1.748041e-02 3 1  ON 20
ci_022                 9.158992e-03 3 1  ON 21
ci_023                 9.199500e-03 3 1  ON 22
ci_024                 9.609339e-03 3 1  ON 23
ci_025                 1.015051e-02 3 1  ON 24
ci_026                 1.159816e-02 3 1  ON 25
ci_027                 1.166111e-02 3 1  ON 26
ci_028                -1.476204e-02 3 1  ON 27
ci_029                -1.646412e-02 3 1  ON 28
ci_030                -9.547493e-03 3 1  ON 29
ci_031                -8.994139e-03 3 1  ON 30
ci_032                -1.472437e-02 3 1  ON 31
ci_033                 5.284468e-03 3 1  ON 32
ci_034                 5.593182e-03 3 1  ON 33
ci_035                -5.094958e-03 3 1  ON 34
ci_036                -1.274129e-02 3 1  ON 35
ci_037                -1.241561e-02 3 1  ON 36
ci_038                 2.045551e-03 3 1  ON 37
ci_039                 1.744525e-03 3 1  ON 38
ci_040                -3.185266e-03 3 1  ON 39
ci_041                 9.431267e-03 3 1  ON 40
ci_042                 8.204805e-03 3 1  ON 41
ci_043                -4.069063e-03 3 1  ON 42
ci_044                -3.897631e-03 3 1  ON 43
ci_045                -3.576759e-03 3 1  ON 44
ci_046                 5.624896e-03 3 1  ON 45
ci_047                 5.547792e-03 3 1  ON 46
ci_048                -1.268446e-02 3 1  ON 47
ci_049                -1.440774e-02 3 1  ON 48
ci_050                 3.140807e-03 3 1  ON 49
ci_051                 2.811480e-03 3 1  ON 50
ci_052                -2.331197e-03 3 1  ON 51
ci_053                -2.440916e-03 3 1  ON 52
ci_054                -3.373982e-03 3 1  ON 53
ci_055                -2.952967e-03 3 1  ON 54
ci_056                 5.577173e-03 3 1  ON 55
ci_057                 5.318380e-03 3 1  ON 56
ci_058                -1.106303e-03 3 1  ON 57
ci_059                -2.160938e-03 3 1  ON 58
ci_060                 4.644554e-03 3 1  ON 59
ci_061                 5.625730e-03 3 1  ON 60
ci_062                -3.756324e-03 3 1  ON 61
ci_063                -4.016738e-03 3 1  ON 62
ci_064                -2.636306e-03 3 1  ON 63
ci_065                -4.355481e-03 3 1  ON 64
ci_066                 4.476543e-03 3 1  ON 65
ci_067                 4.343481e-03 3 1  ON 66
ci_068                -4.195358e-03 3 1  ON 67
ci_069                -5.000742e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9901e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.2089
    reference variance = 0.256647
====================================================
  Execution time = 1.4252e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5294e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7805e-01
  Total weights = 1.957174973e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4895e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267299192824
                                         uncertainty =       0.001346536703

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267299192824
                                         uncertainty =       0.001346536703

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365611421
  error estimate for blocks of size 2^( 2) =       0.000379388857
  error estimate for blocks of size 2^( 3) =       0.000392082247
  error estimate for blocks of size 2^( 4) =       0.000402072269
  error estimate for blocks of size 2^( 5) =       0.000407378299
  error estimate for blocks of size 2^( 6) =       0.000409706281
  error estimate for blocks of size 2^( 7) =       0.000411644641

      target function =      -0.948186450119
              le_mean =     -17.212455561043
             les_mean =     296.546674572645
             stat err =       0.000407700372
             autocorr =       1.243491178687
   target nu stat err =       0.000407700372
   target dn stat err =       0.002074907726
      target stat err =       0.003587928638
              std dev =       0.517052630142
             le_variance =       0.267343422337


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721245556104e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948199056503       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948203896023       residual = 1.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948204749172       residual = 4.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948205023048       residual = 6.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948205080464       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948205079333       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948205082378       residual = 6.84e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948205081975       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948205082016       residual = 2.66e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948205082305       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+00 is 1.888247e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948199056503       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948200274270       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948200488652       residual = 4.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948200557321       residual = 6.18e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948200571719       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948200571430       residual = 3.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948200572186       residual = 6.77e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948200572087       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948200572097       residual = 2.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948200572169       residual = 4.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+01 is 4.744683e-06

solving harmonic davidson linear method for identity shift 1.4901e+02, overlap shift 1.4901e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948199056503       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948199361442       residual = 1.85e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948199415106       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948199432286       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948199435888       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948199435816       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948199436004       residual = 6.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948199435980       residual = 1.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948199435982       residual = 2.61e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948199436000       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4901e+02 is 1.187684e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.179181 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6751e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_001                -4.190266e-02 3 1  ON 0
ci_002                -3.205504e-02 3 1  ON 1
ci_003                -2.639040e-02 3 1  ON 2
ci_004                 2.370546e-02 3 1  ON 3
ci_005                 2.408281e-02 3 1  ON 4
ci_006                -2.137722e-02 3 1  ON 5
ci_007                -2.098801e-02 3 1  ON 6
ci_008                -8.485916e-03 3 1  ON 7
ci_009                -1.385602e-02 3 1  ON 8
ci_010                -1.004933e-02 3 1  ON 9
ci_011                -1.125017e-02 3 1  ON 10
ci_012                -9.776920e-03 3 1  ON 11
ci_013                -1.986014e-02 3 1  ON 12
ci_014                 1.227967e-02 3 1  ON 13
ci_015                 1.197411e-02 3 1  ON 14
ci_016                 1.744934e-02 3 1  ON 15
ci_017                 1.636195e-02 3 1  ON 16
ci_018                 1.024180e-02 3 1  ON 17
ci_019                 1.011731e-02 3 1  ON 18
ci_020                 1.779725e-02 3 1  ON 19
ci_021                 1.747878e-02 3 1  ON 20
ci_022                 9.159915e-03 3 1  ON 21
ci_023                 9.199135e-03 3 1  ON 22
ci_024                 9.612257e-03 3 1  ON 23
ci_025                 1.014922e-02 3 1  ON 24
ci_026                 1.159715e-02 3 1  ON 25
ci_027                 1.166075e-02 3 1  ON 26
ci_028                -1.476341e-02 3 1  ON 27
ci_029                -1.646198e-02 3 1  ON 28
ci_030                -9.547436e-03 3 1  ON 29
ci_031                -8.995895e-03 3 1  ON 30
ci_032                -1.472578e-02 3 1  ON 31
ci_033                 5.285063e-03 3 1  ON 32
ci_034                 5.591731e-03 3 1  ON 33
ci_035                -5.094515e-03 3 1  ON 34
ci_036                -1.274047e-02 3 1  ON 35
ci_037                -1.241428e-02 3 1  ON 36
ci_038                 2.044524e-03 3 1  ON 37
ci_039                 1.744783e-03 3 1  ON 38
ci_040                -3.185257e-03 3 1  ON 39
ci_041                 9.429116e-03 3 1  ON 40
ci_042                 8.205269e-03 3 1  ON 41
ci_043                -4.068897e-03 3 1  ON 42
ci_044                -3.898713e-03 3 1  ON 43
ci_045                -3.575329e-03 3 1  ON 44
ci_046                 5.626469e-03 3 1  ON 45
ci_047                 5.548008e-03 3 1  ON 46
ci_048                -1.268335e-02 3 1  ON 47
ci_049                -1.440708e-02 3 1  ON 48
ci_050                 3.142085e-03 3 1  ON 49
ci_051                 2.812179e-03 3 1  ON 50
ci_052                -2.332999e-03 3 1  ON 51
ci_053                -2.441172e-03 3 1  ON 52
ci_054                -3.371652e-03 3 1  ON 53
ci_055                -2.953269e-03 3 1  ON 54
ci_056                 5.575399e-03 3 1  ON 55
ci_057                 5.317908e-03 3 1  ON 56
ci_058                -1.107566e-03 3 1  ON 57
ci_059                -2.161892e-03 3 1  ON 58
ci_060                 4.643919e-03 3 1  ON 59
ci_061                 5.623352e-03 3 1  ON 60
ci_062                -3.755072e-03 3 1  ON 61
ci_063                -4.016302e-03 3 1  ON 62
ci_064                -2.637961e-03 3 1  ON 63
ci_065                -4.356125e-03 3 1  ON 64
ci_066                 4.476800e-03 3 1  ON 65
ci_067                 4.342202e-03 3 1  ON 66
ci_068                -4.198305e-03 3 1  ON 67
ci_069                -5.000689e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.2035
    reference variance = 0.327512
====================================================
  Execution time = 1.3732e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7681e-01
  Total weights = 1.9572e+06
  Execution time = 1.8776e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266796422328
                                         uncertainty =       0.001511018491

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266796422328
                                         uncertainty =       0.001511018491

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365196098
  error estimate for blocks of size 2^( 2) =       0.000379299314
  error estimate for blocks of size 2^( 3) =       0.000392247541
  error estimate for blocks of size 2^( 4) =       0.000401540077
  error estimate for blocks of size 2^( 5) =       0.000407071095
  error estimate for blocks of size 2^( 6) =       0.000410217827
  error estimate for blocks of size 2^( 7) =       0.000410696425

      target function =      -0.950281181253
              le_mean =     -17.211713233804
             les_mean =     296.519879432792
             stat err =       0.000407381356
             autocorr =       1.244371460062
   target nu stat err =       0.000407381356
   target dn stat err =       0.001940605024
      target stat err =       0.003375261990
              std dev =       0.516465274588
             le_variance =       0.266736379855

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266793069355
                                         uncertainty =       0.001511059769

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266793069355
                                         uncertainty =       0.001511059769

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365193802
  error estimate for blocks of size 2^( 2) =       0.000379296516
  error estimate for blocks of size 2^( 3) =       0.000392244482
  error estimate for blocks of size 2^( 4) =       0.000401537102
  error estimate for blocks of size 2^( 5) =       0.000407068304
  error estimate for blocks of size 2^( 6) =       0.000410214715
  error estimate for blocks of size 2^( 7) =       0.000410693460

      target function =      -0.950282329262
              le_mean =     -17.211713144672
             les_mean =     296.519875684837
             stat err =       0.000407378395
             autocorr =       1.244369019620
   target nu stat err =       0.000407378395
   target dn stat err =       0.001941026911
      target stat err =       0.003375967908
              std dev =       0.516462027595
             le_variance =       0.266733025948

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266794724912
                                         uncertainty =       0.001511039114

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266794724912
                                         uncertainty =       0.001511039114

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365194936
  error estimate for blocks of size 2^( 2) =       0.000379297899
  error estimate for blocks of size 2^( 3) =       0.000392245994
  error estimate for blocks of size 2^( 4) =       0.000401538572
  error estimate for blocks of size 2^( 5) =       0.000407069682
  error estimate for blocks of size 2^( 6) =       0.000410216252
  error estimate for blocks of size 2^( 7) =       0.000410694924

      target function =      -0.950282212456
              le_mean =     -17.211713187601
             les_mean =     296.519877233280
             stat err =       0.000407379857
             autocorr =       1.244370225917
   target nu stat err =       0.000407379857
   target dn stat err =       0.001940809835
      target stat err =       0.003375607932
              std dev =       0.516463630830
             le_variance =       0.266734681970

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266796208634
                                         uncertainty =       0.001511021051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266796208634
                                         uncertainty =       0.001511021051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365195952
  error estimate for blocks of size 2^( 2) =       0.000379299136
  error estimate for blocks of size 2^( 3) =       0.000392247347
  error estimate for blocks of size 2^( 4) =       0.000401539888
  error estimate for blocks of size 2^( 5) =       0.000407070917
  error estimate for blocks of size 2^( 6) =       0.000410217629
  error estimate for blocks of size 2^( 7) =       0.000410696236

      target function =      -0.950281363365
              le_mean =     -17.211713227865
             les_mean =     296.519879120878
             stat err =       0.000407381167
             autocorr =       1.244371305535
   target nu stat err =       0.000407381167
   target dn stat err =       0.001940629862
      target stat err =       0.003375304334
              std dev =       0.516465067650
             le_variance =       0.266736166103


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.950281181253        initial
     9.3132e+00     9.3132e+01             1.8882e-05        -0.950282329262  <--
     3.7253e+01     3.7253e+02             4.7447e-06        -0.950282212456
     1.4901e+02     1.4901e+03             1.1877e-06        -0.950281363365

*****************************************************************************
Applying the update for shift_i =   9.3132e+00     and shift_s =   9.3132e+01
*****************************************************************************

  Execution time = 2.6938e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
ci_001                -4.189763e-02 3 1  ON 0
ci_002                -3.205344e-02 3 1  ON 1
ci_003                -2.638681e-02 3 1  ON 2
ci_004                 2.370107e-02 3 1  ON 3
ci_005                 2.406867e-02 3 1  ON 4
ci_006                -2.137358e-02 3 1  ON 5
ci_007                -2.098428e-02 3 1  ON 6
ci_008                -8.487657e-03 3 1  ON 7
ci_009                -1.386127e-02 3 1  ON 8
ci_010                -1.004406e-02 3 1  ON 9
ci_011                -1.125206e-02 3 1  ON 10
ci_012                -9.780509e-03 3 1  ON 11
ci_013                -1.986302e-02 3 1  ON 12
ci_014                 1.228517e-02 3 1  ON 13
ci_015                 1.197992e-02 3 1  ON 14
ci_016                 1.744813e-02 3 1  ON 15
ci_017                 1.636432e-02 3 1  ON 16
ci_018                 1.024115e-02 3 1  ON 17
ci_019                 1.012450e-02 3 1  ON 18
ci_020                 1.779254e-02 3 1  ON 19
ci_021                 1.747391e-02 3 1  ON 20
ci_022                 9.162664e-03 3 1  ON 21
ci_023                 9.198045e-03 3 1  ON 22
ci_024                 9.620948e-03 3 1  ON 23
ci_025                 1.014538e-02 3 1  ON 24
ci_026                 1.159416e-02 3 1  ON 25
ci_027                 1.165966e-02 3 1  ON 26
ci_028                -1.476750e-02 3 1  ON 27
ci_029                -1.645562e-02 3 1  ON 28
ci_030                -9.547266e-03 3 1  ON 29
ci_031                -9.001117e-03 3 1  ON 30
ci_032                -1.472999e-02 3 1  ON 31
ci_033                 5.286835e-03 3 1  ON 32
ci_034                 5.587413e-03 3 1  ON 33
ci_035                -5.093196e-03 3 1  ON 34
ci_036                -1.273802e-02 3 1  ON 35
ci_037                -1.241032e-02 3 1  ON 36
ci_038                 2.041469e-03 3 1  ON 37
ci_039                 1.745550e-03 3 1  ON 38
ci_040                -3.185231e-03 3 1  ON 39
ci_041                 9.422721e-03 3 1  ON 40
ci_042                 8.206645e-03 3 1  ON 41
ci_043                -4.068404e-03 3 1  ON 42
ci_044                -3.901936e-03 3 1  ON 43
ci_045                -3.571077e-03 3 1  ON 44
ci_046                 5.631152e-03 3 1  ON 45
ci_047                 5.548650e-03 3 1  ON 46
ci_048                -1.268007e-02 3 1  ON 47
ci_049                -1.440514e-02 3 1  ON 48
ci_050                 3.145885e-03 3 1  ON 49
ci_051                 2.814259e-03 3 1  ON 50
ci_052                -2.338360e-03 3 1  ON 51
ci_053                -2.441930e-03 3 1  ON 52
ci_054                -3.364721e-03 3 1  ON 53
ci_055                -2.954170e-03 3 1  ON 54
ci_056                 5.570120e-03 3 1  ON 55
ci_057                 5.316503e-03 3 1  ON 56
ci_058                -1.111320e-03 3 1  ON 57
ci_059                -2.164727e-03 3 1  ON 58
ci_060                 4.642027e-03 3 1  ON 59
ci_061                 5.616270e-03 3 1  ON 60
ci_062                -3.751348e-03 3 1  ON 61
ci_063                -4.015004e-03 3 1  ON 62
ci_064                -2.642885e-03 3 1  ON 63
ci_065                -4.358040e-03 3 1  ON 64
ci_066                 4.477564e-03 3 1  ON 65
ci_067                 4.338401e-03 3 1  ON 66
ci_068                -4.207078e-03 3 1  ON 67
ci_069                -5.000531e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3698e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.1984
    reference variance = 0.410489
====================================================
  Execution time = 1.4260e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5317e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7801e-01
  Total weights = 1.957113873e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4737e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266884341993
                                         uncertainty =       0.001299700287

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266884341993
                                         uncertainty =       0.001299700287

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365308921
  error estimate for blocks of size 2^( 2) =       0.000379228233
  error estimate for blocks of size 2^( 3) =       0.000391687274
  error estimate for blocks of size 2^( 4) =       0.000400317293
  error estimate for blocks of size 2^( 5) =       0.000405949202
  error estimate for blocks of size 2^( 6) =       0.000406656575
  error estimate for blocks of size 2^( 7) =       0.000409875953

      target function =      -0.948237118261
              le_mean =     -17.211624263207
             les_mean =     296.518021552995
             stat err =       0.000405699756
             autocorr =       1.233357376847
   target nu stat err =       0.000405699756
   target dn stat err =       0.002028474190
      target stat err =       0.003505116191
              std dev =       0.516624831023
             le_variance =       0.266901216029


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721162426321e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+00, overlap shift 2.3283e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948249053790       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948275507502       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948278445651       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948279216585       residual = 6.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948279246103       residual = 1.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948279171589       residual = 2.73e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948279199919       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948279202468       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948279202197       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948279204229       residual = 3.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+00 is 6.931780e-05

solving harmonic davidson linear method for identity shift 9.3132e+00, overlap shift 9.3132e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948249053790       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948255840030       residual = 1.73e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948256589748       residual = 3.87e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948256784650       residual = 6.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948256792101       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948256773075       residual = 2.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948256780207       residual = 4.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948256780869       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948256780793       residual = 1.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948256781302       residual = 3.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+00 is 1.774204e-05

solving harmonic davidson linear method for identity shift 3.7253e+01, overlap shift 3.7253e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948249053790       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948250761506       residual = 1.72e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948250949908       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948250998769       residual = 6.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948251000636       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948250995854       residual = 2.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948250997640       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948250997808       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948250997788       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948250997915       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+01 is 4.462069e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.182648 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6743e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_001                -4.189712e-02 3 1  ON 0
ci_002                -3.204803e-02 3 1  ON 1
ci_003                -2.637923e-02 3 1  ON 2
ci_004                 2.369974e-02 3 1  ON 3
ci_005                 2.406124e-02 3 1  ON 4
ci_006                -2.135848e-02 3 1  ON 5
ci_007                -2.097840e-02 3 1  ON 6
ci_008                -8.490826e-03 3 1  ON 7
ci_009                -1.386450e-02 3 1  ON 8
ci_010                -1.004119e-02 3 1  ON 9
ci_011                -1.123432e-02 3 1  ON 10
ci_012                -9.783814e-03 3 1  ON 11
ci_013                -1.986056e-02 3 1  ON 12
ci_014                 1.228589e-02 3 1  ON 13
ci_015                 1.198111e-02 3 1  ON 14
ci_016                 1.744230e-02 3 1  ON 15
ci_017                 1.636594e-02 3 1  ON 16
ci_018                 1.025258e-02 3 1  ON 17
ci_019                 1.012670e-02 3 1  ON 18
ci_020                 1.778488e-02 3 1  ON 19
ci_021                 1.746665e-02 3 1  ON 20
ci_022                 9.166887e-03 3 1  ON 21
ci_023                 9.193989e-03 3 1  ON 22
ci_024                 9.622726e-03 3 1  ON 23
ci_025                 1.014168e-02 3 1  ON 24
ci_026                 1.158030e-02 3 1  ON 25
ci_027                 1.166218e-02 3 1  ON 26
ci_028                -1.477627e-02 3 1  ON 27
ci_029                -1.644914e-02 3 1  ON 28
ci_030                -9.541742e-03 3 1  ON 29
ci_031                -9.003619e-03 3 1  ON 30
ci_032                -1.472870e-02 3 1  ON 31
ci_033                 5.288109e-03 3 1  ON 32
ci_034                 5.589655e-03 3 1  ON 33
ci_035                -5.089285e-03 3 1  ON 34
ci_036                -1.273925e-02 3 1  ON 35
ci_037                -1.241623e-02 3 1  ON 36
ci_038                 2.037349e-03 3 1  ON 37
ci_039                 1.745805e-03 3 1  ON 38
ci_040                -3.182065e-03 3 1  ON 39
ci_041                 9.409378e-03 3 1  ON 40
ci_042                 8.212845e-03 3 1  ON 41
ci_043                -4.068292e-03 3 1  ON 42
ci_044                -3.902796e-03 3 1  ON 43
ci_045                -3.568661e-03 3 1  ON 44
ci_046                 5.634633e-03 3 1  ON 45
ci_047                 5.547529e-03 3 1  ON 46
ci_048                -1.268468e-02 3 1  ON 47
ci_049                -1.439600e-02 3 1  ON 48
ci_050                 3.148151e-03 3 1  ON 49
ci_051                 2.823146e-03 3 1  ON 50
ci_052                -2.338336e-03 3 1  ON 51
ci_053                -2.439633e-03 3 1  ON 52
ci_054                -3.358997e-03 3 1  ON 53
ci_055                -2.953218e-03 3 1  ON 54
ci_056                 5.569296e-03 3 1  ON 55
ci_057                 5.315022e-03 3 1  ON 56
ci_058                -1.121304e-03 3 1  ON 57
ci_059                -2.163369e-03 3 1  ON 58
ci_060                 4.648973e-03 3 1  ON 59
ci_061                 5.613902e-03 3 1  ON 60
ci_062                -3.756219e-03 3 1  ON 61
ci_063                -4.010964e-03 3 1  ON 62
ci_064                -2.647769e-03 3 1  ON 63
ci_065                -4.359796e-03 3 1  ON 64
ci_066                 4.479493e-03 3 1  ON 65
ci_067                 4.337694e-03 3 1  ON 66
ci_068                -4.219356e-03 3 1  ON 67
ci_069                -4.999181e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.1652
    reference variance = 0.280866
====================================================
  Execution time = 1.4043e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7842e-01
  Total weights = 1.9571e+06
  Execution time = 1.8199e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267318743555
                                         uncertainty =       0.001703960728

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267318743555
                                         uncertainty =       0.001703960728

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365770581
  error estimate for blocks of size 2^( 2) =       0.000379754470
  error estimate for blocks of size 2^( 3) =       0.000392109258
  error estimate for blocks of size 2^( 4) =       0.000401489341
  error estimate for blocks of size 2^( 5) =       0.000405851733
  error estimate for blocks of size 2^( 6) =       0.000408837475
  error estimate for blocks of size 2^( 7) =       0.000409167716

      target function =      -0.947553793610
              le_mean =     -17.211966666935
             les_mean =     296.530215935663
             stat err =       0.000406336566
             autocorr =       1.234111127434
   target nu stat err =       0.000406336566
   target dn stat err =       0.001956735510
      target stat err =       0.003384178269
              std dev =       0.517277716337
             le_variance =       0.267576235819

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267302655947
                                         uncertainty =       0.001706195738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267302655947
                                         uncertainty =       0.001706195738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365759601
  error estimate for blocks of size 2^( 2) =       0.000379743553
  error estimate for blocks of size 2^( 3) =       0.000392099614
  error estimate for blocks of size 2^( 4) =       0.000401480088
  error estimate for blocks of size 2^( 5) =       0.000405844498
  error estimate for blocks of size 2^( 6) =       0.000408829063
  error estimate for blocks of size 2^( 7) =       0.000409158281

      target function =      -0.947456218648
              le_mean =     -17.211967194921
             les_mean =     296.530291852138
             stat err =       0.000406327983
             autocorr =       1.234133084737
   target nu stat err =       0.000406327983
   target dn stat err =       0.001960483419
      target stat err =       0.003389681480
              std dev =       0.517262187703
             le_variance =       0.267560170827

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267310313674
                                         uncertainty =       0.001705101517

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267310313674
                                         uncertainty =       0.001705101517

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365764827
  error estimate for blocks of size 2^( 2) =       0.000379748742
  error estimate for blocks of size 2^( 3) =       0.000392104173
  error estimate for blocks of size 2^( 4) =       0.000401484453
  error estimate for blocks of size 2^( 5) =       0.000405847906
  error estimate for blocks of size 2^( 6) =       0.000408833070
  error estimate for blocks of size 2^( 7) =       0.000409162779

      target function =      -0.947553345375
              le_mean =     -17.211966904456
             les_mean =     296.530224369572
             stat err =       0.000406332052
             autocorr =       1.234122536029
   target nu stat err =       0.000406332052
   target dn stat err =       0.001958049589
      target stat err =       0.003386343571
              std dev =       0.517269578686
             le_variance =       0.267567817034

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267317661025
                                         uncertainty =       0.001704103622

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267317661025
                                         uncertainty =       0.001704103622

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365769842
  error estimate for blocks of size 2^( 2) =       0.000379753734
  error estimate for blocks of size 2^( 3) =       0.000392108602
  error estimate for blocks of size 2^( 4) =       0.000401488711
  error estimate for blocks of size 2^( 5) =       0.000405851237
  error estimate for blocks of size 2^( 6) =       0.000408836907
  error estimate for blocks of size 2^( 7) =       0.000409167080

      target function =      -0.947539430559
              le_mean =     -17.211966694217
             les_mean =     296.530225375951
             stat err =       0.000406335984
             autocorr =       1.234112574680
   target nu stat err =       0.000406335984
   target dn stat err =       0.001956902879
      target stat err =       0.003384354175
              std dev =       0.517276671305
             le_variance =       0.267575154676


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947553793610        initial  <--
     2.3283e+00     2.3283e+01             6.9318e-05        -0.947456218648
     9.3132e+00     9.3132e+01             1.7742e-05        -0.947553345375
     3.7253e+01     3.7253e+02             4.4621e-06        -0.947539430559

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.3527
  </log>
  <optVariables href="H2O.s047.opt.xml">
ci_001                -4.189763e-02 3 1  ON 0
ci_002                -3.205344e-02 3 1  ON 1
ci_003                -2.638681e-02 3 1  ON 2
ci_004                 2.370107e-02 3 1  ON 3
ci_005                 2.406867e-02 3 1  ON 4
ci_006                -2.137358e-02 3 1  ON 5
ci_007                -2.098428e-02 3 1  ON 6
ci_008                -8.487657e-03 3 1  ON 7
ci_009                -1.386127e-02 3 1  ON 8
ci_010                -1.004406e-02 3 1  ON 9
ci_011                -1.125206e-02 3 1  ON 10
ci_012                -9.780509e-03 3 1  ON 11
ci_013                -1.986302e-02 3 1  ON 12
ci_014                 1.228517e-02 3 1  ON 13
ci_015                 1.197992e-02 3 1  ON 14
ci_016                 1.744813e-02 3 1  ON 15
ci_017                 1.636432e-02 3 1  ON 16
ci_018                 1.024115e-02 3 1  ON 17
ci_019                 1.012450e-02 3 1  ON 18
ci_020                 1.779254e-02 3 1  ON 19
ci_021                 1.747391e-02 3 1  ON 20
ci_022                 9.162664e-03 3 1  ON 21
ci_023                 9.198045e-03 3 1  ON 22
ci_024                 9.620948e-03 3 1  ON 23
ci_025                 1.014538e-02 3 1  ON 24
ci_026                 1.159416e-02 3 1  ON 25
ci_027                 1.165966e-02 3 1  ON 26
ci_028                -1.476750e-02 3 1  ON 27
ci_029                -1.645562e-02 3 1  ON 28
ci_030                -9.547266e-03 3 1  ON 29
ci_031                -9.001117e-03 3 1  ON 30
ci_032                -1.472999e-02 3 1  ON 31
ci_033                 5.286835e-03 3 1  ON 32
ci_034                 5.587413e-03 3 1  ON 33
ci_035                -5.093196e-03 3 1  ON 34
ci_036                -1.273802e-02 3 1  ON 35
ci_037                -1.241032e-02 3 1  ON 36
ci_038                 2.041469e-03 3 1  ON 37
ci_039                 1.745550e-03 3 1  ON 38
ci_040                -3.185231e-03 3 1  ON 39
ci_041                 9.422721e-03 3 1  ON 40
ci_042                 8.206645e-03 3 1  ON 41
ci_043                -4.068404e-03 3 1  ON 42
ci_044                -3.901936e-03 3 1  ON 43
ci_045                -3.571077e-03 3 1  ON 44
ci_046                 5.631152e-03 3 1  ON 45
ci_047                 5.548650e-03 3 1  ON 46
ci_048                -1.268007e-02 3 1  ON 47
ci_049                -1.440514e-02 3 1  ON 48
ci_050                 3.145885e-03 3 1  ON 49
ci_051                 2.814259e-03 3 1  ON 50
ci_052                -2.338360e-03 3 1  ON 51
ci_053                -2.441930e-03 3 1  ON 52
ci_054                -3.364721e-03 3 1  ON 53
ci_055                -2.954170e-03 3 1  ON 54
ci_056                 5.570120e-03 3 1  ON 55
ci_057                 5.316503e-03 3 1  ON 56
ci_058                -1.111320e-03 3 1  ON 57
ci_059                -2.164727e-03 3 1  ON 58
ci_060                 4.642027e-03 3 1  ON 59
ci_061                 5.616270e-03 3 1  ON 60
ci_062                -3.751348e-03 3 1  ON 61
ci_063                -4.015004e-03 3 1  ON 62
ci_064                -2.642885e-03 3 1  ON 63
ci_065                -4.358040e-03 3 1  ON 64
ci_066                 4.477564e-03 3 1  ON 65
ci_067                 4.338401e-03 3 1  ON 66
ci_068                -4.207078e-03 3 1  ON 67
ci_069                -5.000531e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0102e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.1996
    reference variance = 0.253285
====================================================
  Execution time = 1.4396e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5313e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7917e-01
  Total weights = 1.957442334e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4833e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267702834946
                                         uncertainty =       0.001596815098

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267702834946
                                         uncertainty =       0.001596815098

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365812512
  error estimate for blocks of size 2^( 2) =       0.000379522953
  error estimate for blocks of size 2^( 3) =       0.000391706294
  error estimate for blocks of size 2^( 4) =       0.000401238428
  error estimate for blocks of size 2^( 5) =       0.000405898407
  error estimate for blocks of size 2^( 6) =       0.000409348971
  error estimate for blocks of size 2^( 7) =       0.000410922677

      target function =      -0.946280651352
              le_mean =     -17.212267244427
             les_mean =     296.541317667668
             stat err =       0.000406852121
             autocorr =       1.236961143246
   target nu stat err =       0.000406852121
   target dn stat err =       0.002211781016
      target stat err =       0.003798482691
              std dev =       0.517337015508
             le_variance =       0.267637587615


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721226724443e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+01, overlap shift 2.3283e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946294836536       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946297305767       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946297645612       residual = 3.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946297721190       residual = 8.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946297738049       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946297744218       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946297746465       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946297746764       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946297746849       residual = 2.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946297746998       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+01 is 5.565464e-06

solving harmonic davidson linear method for identity shift 9.3132e+01, overlap shift 9.3132e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946294836536       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946295455470       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946295540615       residual = 3.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946295559532       residual = 8.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946295563751       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946295565295       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946295565856       residual = 5.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946295565931       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946295565953       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946295565990       residual = 4.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+01 is 1.394469e-06

solving harmonic davidson linear method for identity shift 3.7253e+02, overlap shift 3.7253e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946294836536       residual = 1.73e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946294991371       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946295012669       residual = 3.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946295017400       residual = 8.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946295018455       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946295018841       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946295018981       residual = 5.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946295019000       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946295019005       residual = 2.77e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946295019015       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+02 is 3.488117e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.186112 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6888e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_001                -4.189701e-02 3 1  ON 0
ci_002                -3.205246e-02 3 1  ON 1
ci_003                -2.638601e-02 3 1  ON 2
ci_004                 2.370097e-02 3 1  ON 3
ci_005                 2.406898e-02 3 1  ON 4
ci_006                -2.137250e-02 3 1  ON 5
ci_007                -2.098367e-02 3 1  ON 6
ci_008                -8.488270e-03 3 1  ON 7
ci_009                -1.386156e-02 3 1  ON 8
ci_010                -1.004314e-02 3 1  ON 9
ci_011                -1.125096e-02 3 1  ON 10
ci_012                -9.780488e-03 3 1  ON 11
ci_013                -1.986257e-02 3 1  ON 12
ci_014                 1.228575e-02 3 1  ON 13
ci_015                 1.198027e-02 3 1  ON 14
ci_016                 1.744728e-02 3 1  ON 15
ci_017                 1.636456e-02 3 1  ON 16
ci_018                 1.024114e-02 3 1  ON 17
ci_019                 1.012505e-02 3 1  ON 18
ci_020                 1.779212e-02 3 1  ON 19
ci_021                 1.747417e-02 3 1  ON 20
ci_022                 9.163216e-03 3 1  ON 21
ci_023                 9.197230e-03 3 1  ON 22
ci_024                 9.620055e-03 3 1  ON 23
ci_025                 1.014471e-02 3 1  ON 24
ci_026                 1.159350e-02 3 1  ON 25
ci_027                 1.165877e-02 3 1  ON 26
ci_028                -1.476694e-02 3 1  ON 27
ci_029                -1.645548e-02 3 1  ON 28
ci_030                -9.547625e-03 3 1  ON 29
ci_031                -9.001703e-03 3 1  ON 30
ci_032                -1.473001e-02 3 1  ON 31
ci_033                 5.286207e-03 3 1  ON 32
ci_034                 5.587659e-03 3 1  ON 33
ci_035                -5.092808e-03 3 1  ON 34
ci_036                -1.273749e-02 3 1  ON 35
ci_037                -1.241119e-02 3 1  ON 36
ci_038                 2.040721e-03 3 1  ON 37
ci_039                 1.745587e-03 3 1  ON 38
ci_040                -3.184923e-03 3 1  ON 39
ci_041                 9.422349e-03 3 1  ON 40
ci_042                 8.206750e-03 3 1  ON 41
ci_043                -4.067868e-03 3 1  ON 42
ci_044                -3.901361e-03 3 1  ON 43
ci_045                -3.570269e-03 3 1  ON 44
ci_046                 5.631358e-03 3 1  ON 45
ci_047                 5.549148e-03 3 1  ON 46
ci_048                -1.268044e-02 3 1  ON 47
ci_049                -1.440375e-02 3 1  ON 48
ci_050                 3.146293e-03 3 1  ON 49
ci_051                 2.815456e-03 3 1  ON 50
ci_052                -2.338064e-03 3 1  ON 51
ci_053                -2.442168e-03 3 1  ON 52
ci_054                -3.363982e-03 3 1  ON 53
ci_055                -2.954154e-03 3 1  ON 54
ci_056                 5.569452e-03 3 1  ON 55
ci_057                 5.316065e-03 3 1  ON 56
ci_058                -1.112365e-03 3 1  ON 57
ci_059                -2.164883e-03 3 1  ON 58
ci_060                 4.642316e-03 3 1  ON 59
ci_061                 5.616226e-03 3 1  ON 60
ci_062                -3.751491e-03 3 1  ON 61
ci_063                -4.014686e-03 3 1  ON 62
ci_064                -2.643531e-03 3 1  ON 63
ci_065                -4.357933e-03 3 1  ON 64
ci_066                 4.476887e-03 3 1  ON 65
ci_067                 4.338396e-03 3 1  ON 66
ci_068                -4.206948e-03 3 1  ON 67
ci_069                -5.000468e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.1912
    reference variance = 0.201287
====================================================
  Execution time = 1.4149e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7869e-01
  Total weights = 1.9568e+06
  Execution time = 1.8118e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267038610000
                                         uncertainty =       0.001517063670

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267038610000
                                         uncertainty =       0.001517063670

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365417833
  error estimate for blocks of size 2^( 2) =       0.000379247304
  error estimate for blocks of size 2^( 3) =       0.000392138965
  error estimate for blocks of size 2^( 4) =       0.000401782542
  error estimate for blocks of size 2^( 5) =       0.000408445765
  error estimate for blocks of size 2^( 6) =       0.000412206512
  error estimate for blocks of size 2^( 7) =       0.000412930393

      target function =      -0.947104986870
              le_mean =     -17.211711274972
             les_mean =     296.521685821975
             stat err =       0.000408841303
             autocorr =       1.251785892833
   target nu stat err =       0.000408841303
   target dn stat err =       0.002290007642
      target stat err =       0.003931292376
              std dev =       0.516778854755
             le_variance =       0.267060384722

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267036682482
                                         uncertainty =       0.001517094004

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267036682482
                                         uncertainty =       0.001517094004

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365416506
  error estimate for blocks of size 2^( 2) =       0.000379246132
  error estimate for blocks of size 2^( 3) =       0.000392138053
  error estimate for blocks of size 2^( 4) =       0.000401781776
  error estimate for blocks of size 2^( 5) =       0.000408444894
  error estimate for blocks of size 2^( 6) =       0.000412205805
  error estimate for blocks of size 2^( 7) =       0.000412929398

      target function =      -0.947051464828
              le_mean =     -17.211711232208
             les_mean =     296.521716036181
             stat err =       0.000408840468
             autocorr =       1.251789869869
   target nu stat err =       0.000408840468
   target dn stat err =       0.002295240758
      target stat err =       0.003939530229
              std dev =       0.516776978630
             le_variance =       0.267058445642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267037641965
                                         uncertainty =       0.001517078852

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267037641965
                                         uncertainty =       0.001517078852

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365417166
  error estimate for blocks of size 2^( 2) =       0.000379246716
  error estimate for blocks of size 2^( 3) =       0.000392138506
  error estimate for blocks of size 2^( 4) =       0.000401782156
  error estimate for blocks of size 2^( 5) =       0.000408445327
  error estimate for blocks of size 2^( 6) =       0.000412206155
  error estimate for blocks of size 2^( 7) =       0.000412929892

      target function =      -0.947079184589
              le_mean =     -17.211711253309
             les_mean =     296.521700351538
             stat err =       0.000408840883
             autocorr =       1.251787883348
   target nu stat err =       0.000408840883
   target dn stat err =       0.002292509024
      target stat err =       0.003935228349
              std dev =       0.516777912542
             le_variance =       0.267059410891

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267038488714
                                         uncertainty =       0.001517065567

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267038488714
                                         uncertainty =       0.001517065567

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365417749
  error estimate for blocks of size 2^( 2) =       0.000379247231
  error estimate for blocks of size 2^( 3) =       0.000392138907
  error estimate for blocks of size 2^( 4) =       0.000401782494
  error estimate for blocks of size 2^( 5) =       0.000408445710
  error estimate for blocks of size 2^( 6) =       0.000412206467
  error estimate for blocks of size 2^( 7) =       0.000412930331

      target function =      -0.947101868486
              le_mean =     -17.211711272237
             les_mean =     296.521687573917
             stat err =       0.000408841250
             autocorr =       1.251786141623
   target nu stat err =       0.000408841250
   target dn stat err =       0.002290308096
      target stat err =       0.003931765005
              std dev =       0.516778736705
             le_variance =       0.267060262710


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947104986870        initial  <--
     2.3283e+01     2.3283e+02             5.5655e-06        -0.947051464828
     9.3132e+01     9.3132e+02             1.3945e-06        -0.947079184589
     3.7253e+02     3.7253e+03             3.4881e-07        -0.947101868486

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.3251
  </log>
  <optVariables href="H2O.s048.opt.xml">
ci_001                -4.189763e-02 3 1  ON 0
ci_002                -3.205344e-02 3 1  ON 1
ci_003                -2.638681e-02 3 1  ON 2
ci_004                 2.370107e-02 3 1  ON 3
ci_005                 2.406867e-02 3 1  ON 4
ci_006                -2.137358e-02 3 1  ON 5
ci_007                -2.098428e-02 3 1  ON 6
ci_008                -8.487657e-03 3 1  ON 7
ci_009                -1.386127e-02 3 1  ON 8
ci_010                -1.004406e-02 3 1  ON 9
ci_011                -1.125206e-02 3 1  ON 10
ci_012                -9.780509e-03 3 1  ON 11
ci_013                -1.986302e-02 3 1  ON 12
ci_014                 1.228517e-02 3 1  ON 13
ci_015                 1.197992e-02 3 1  ON 14
ci_016                 1.744813e-02 3 1  ON 15
ci_017                 1.636432e-02 3 1  ON 16
ci_018                 1.024115e-02 3 1  ON 17
ci_019                 1.012450e-02 3 1  ON 18
ci_020                 1.779254e-02 3 1  ON 19
ci_021                 1.747391e-02 3 1  ON 20
ci_022                 9.162664e-03 3 1  ON 21
ci_023                 9.198045e-03 3 1  ON 22
ci_024                 9.620948e-03 3 1  ON 23
ci_025                 1.014538e-02 3 1  ON 24
ci_026                 1.159416e-02 3 1  ON 25
ci_027                 1.165966e-02 3 1  ON 26
ci_028                -1.476750e-02 3 1  ON 27
ci_029                -1.645562e-02 3 1  ON 28
ci_030                -9.547266e-03 3 1  ON 29
ci_031                -9.001117e-03 3 1  ON 30
ci_032                -1.472999e-02 3 1  ON 31
ci_033                 5.286835e-03 3 1  ON 32
ci_034                 5.587413e-03 3 1  ON 33
ci_035                -5.093196e-03 3 1  ON 34
ci_036                -1.273802e-02 3 1  ON 35
ci_037                -1.241032e-02 3 1  ON 36
ci_038                 2.041469e-03 3 1  ON 37
ci_039                 1.745550e-03 3 1  ON 38
ci_040                -3.185231e-03 3 1  ON 39
ci_041                 9.422721e-03 3 1  ON 40
ci_042                 8.206645e-03 3 1  ON 41
ci_043                -4.068404e-03 3 1  ON 42
ci_044                -3.901936e-03 3 1  ON 43
ci_045                -3.571077e-03 3 1  ON 44
ci_046                 5.631152e-03 3 1  ON 45
ci_047                 5.548650e-03 3 1  ON 46
ci_048                -1.268007e-02 3 1  ON 47
ci_049                -1.440514e-02 3 1  ON 48
ci_050                 3.145885e-03 3 1  ON 49
ci_051                 2.814259e-03 3 1  ON 50
ci_052                -2.338360e-03 3 1  ON 51
ci_053                -2.441930e-03 3 1  ON 52
ci_054                -3.364721e-03 3 1  ON 53
ci_055                -2.954170e-03 3 1  ON 54
ci_056                 5.570120e-03 3 1  ON 55
ci_057                 5.316503e-03 3 1  ON 56
ci_058                -1.111320e-03 3 1  ON 57
ci_059                -2.164727e-03 3 1  ON 58
ci_060                 4.642027e-03 3 1  ON 59
ci_061                 5.616270e-03 3 1  ON 60
ci_062                -3.751348e-03 3 1  ON 61
ci_063                -4.015004e-03 3 1  ON 62
ci_064                -2.642885e-03 3 1  ON 63
ci_065                -4.358040e-03 3 1  ON 64
ci_066                 4.477564e-03 3 1  ON 65
ci_067                 4.338401e-03 3 1  ON 66
ci_068                -4.207078e-03 3 1  ON 67
ci_069                -5.000531e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0220e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.2185
    reference variance = 0.223528
====================================================
  Execution time = 1.4582e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7925e-01
  Total weights = 1.957492722e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4700e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268158955275
                                         uncertainty =       0.001873443643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268158955275
                                         uncertainty =       0.001873443643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366277832
  error estimate for blocks of size 2^( 2) =       0.000380170398
  error estimate for blocks of size 2^( 3) =       0.000393013646
  error estimate for blocks of size 2^( 4) =       0.000402016441
  error estimate for blocks of size 2^( 5) =       0.000407502335
  error estimate for blocks of size 2^( 6) =       0.000409428097
  error estimate for blocks of size 2^( 7) =       0.000410821069

      target function =      -0.946153138094
              le_mean =     -17.212290260400
             les_mean =     296.542183965516
             stat err =       0.000407441986
             autocorr =       1.237400503466
   target nu stat err =       0.000407441986
   target dn stat err =       0.002411093177
      target stat err =       0.004128094049
              std dev =       0.517995078274
             le_variance =       0.268318901116


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721229026040e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946170338879       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946170626313       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946170666741       residual = 4.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946170680975       residual = 7.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946170682812       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946170682944       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946170683049       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946170683133       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946170683120       residual = 2.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946170683127       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+02 is 7.068678e-07

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946170338879       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946170410757       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946170420866       residual = 4.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946170424425       residual = 7.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946170424884       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946170424916       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946170424946       residual = 7.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946170424964       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946170424962       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946170424962       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+02 is 1.767544e-07

solving harmonic davidson linear method for identity shift 3.7253e+03, overlap shift 3.7253e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946170338879       residual = 1.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946170356850       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946170359377       residual = 4.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946170360267       residual = 7.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946170360382       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946170360389       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946170360396       residual = 7.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946170360398       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946170360400       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946170360393       residual = 4.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.7253e+03 is 4.419093e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.189587 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7061e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_001                -4.189752e-02 3 1  ON 0
ci_002                -3.205334e-02 3 1  ON 1
ci_003                -2.638677e-02 3 1  ON 2
ci_004                 2.370113e-02 3 1  ON 3
ci_005                 2.406866e-02 3 1  ON 4
ci_006                -2.137360e-02 3 1  ON 5
ci_007                -2.098420e-02 3 1  ON 6
ci_008                -8.487743e-03 3 1  ON 7
ci_009                -1.386135e-02 3 1  ON 8
ci_010                -1.004399e-02 3 1  ON 9
ci_011                -1.125201e-02 3 1  ON 10
ci_012                -9.780590e-03 3 1  ON 11
ci_013                -1.986304e-02 3 1  ON 12
ci_014                 1.228515e-02 3 1  ON 13
ci_015                 1.197998e-02 3 1  ON 14
ci_016                 1.744810e-02 3 1  ON 15
ci_017                 1.636431e-02 3 1  ON 16
ci_018                 1.024126e-02 3 1  ON 17
ci_019                 1.012452e-02 3 1  ON 18
ci_020                 1.779242e-02 3 1  ON 19
ci_021                 1.747381e-02 3 1  ON 20
ci_022                 9.162645e-03 3 1  ON 21
ci_023                 9.198009e-03 3 1  ON 22
ci_024                 9.620874e-03 3 1  ON 23
ci_025                 1.014524e-02 3 1  ON 24
ci_026                 1.159405e-02 3 1  ON 25
ci_027                 1.165957e-02 3 1  ON 26
ci_028                -1.476757e-02 3 1  ON 27
ci_029                -1.645545e-02 3 1  ON 28
ci_030                -9.547263e-03 3 1  ON 29
ci_031                -9.001059e-03 3 1  ON 30
ci_032                -1.473000e-02 3 1  ON 31
ci_033                 5.286869e-03 3 1  ON 32
ci_034                 5.587428e-03 3 1  ON 33
ci_035                -5.093143e-03 3 1  ON 34
ci_036                -1.273802e-02 3 1  ON 35
ci_037                -1.241041e-02 3 1  ON 36
ci_038                 2.041446e-03 3 1  ON 37
ci_039                 1.745536e-03 3 1  ON 38
ci_040                -3.185241e-03 3 1  ON 39
ci_041                 9.422596e-03 3 1  ON 40
ci_042                 8.206605e-03 3 1  ON 41
ci_043                -4.068392e-03 3 1  ON 42
ci_044                -3.901941e-03 3 1  ON 43
ci_045                -3.571053e-03 3 1  ON 44
ci_046                 5.631144e-03 3 1  ON 45
ci_047                 5.548653e-03 3 1  ON 46
ci_048                -1.268011e-02 3 1  ON 47
ci_049                -1.440504e-02 3 1  ON 48
ci_050                 3.145852e-03 3 1  ON 49
ci_051                 2.814365e-03 3 1  ON 50
ci_052                -2.338298e-03 3 1  ON 51
ci_053                -2.441892e-03 3 1  ON 52
ci_054                -3.364647e-03 3 1  ON 53
ci_055                -2.954184e-03 3 1  ON 54
ci_056                 5.570083e-03 3 1  ON 55
ci_057                 5.316503e-03 3 1  ON 56
ci_058                -1.111410e-03 3 1  ON 57
ci_059                -2.164695e-03 3 1  ON 58
ci_060                 4.641985e-03 3 1  ON 59
ci_061                 5.616240e-03 3 1  ON 60
ci_062                -3.751371e-03 3 1  ON 61
ci_063                -4.015029e-03 3 1  ON 62
ci_064                -2.642923e-03 3 1  ON 63
ci_065                -4.358039e-03 3 1  ON 64
ci_066                 4.477533e-03 3 1  ON 65
ci_067                 4.338424e-03 3 1  ON 66
ci_068                -4.207157e-03 3 1  ON 67
ci_069                -5.000549e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.1871
    reference variance = 0.215586
====================================================
  Execution time = 1.4022e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8135e-01
  Total weights = 1.9572e+06
  Execution time = 1.8099e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270233535240
                                         uncertainty =       0.001532276294

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270233535240
                                         uncertainty =       0.001532276294

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367508459
  error estimate for blocks of size 2^( 2) =       0.000381786758
  error estimate for blocks of size 2^( 3) =       0.000394520782
  error estimate for blocks of size 2^( 4) =       0.000403488431
  error estimate for blocks of size 2^( 5) =       0.000407681631
  error estimate for blocks of size 2^( 6) =       0.000411150123
  error estimate for blocks of size 2^( 7) =       0.000412416383

      target function =      -0.942620996237
              le_mean =     -17.211785563094
             les_mean =     296.526916223907
             stat err =       0.000408684142
             autocorr =       1.236633177098
   target nu stat err =       0.000408684142
   target dn stat err =       0.001994283630
      target stat err =       0.003410893030
              std dev =       0.519735446825
             le_variance =       0.270124934686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270233341038
                                         uncertainty =       0.001532271357

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270233341038
                                         uncertainty =       0.001532271357

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367508327
  error estimate for blocks of size 2^( 2) =       0.000381786639
  error estimate for blocks of size 2^( 3) =       0.000394520685
  error estimate for blocks of size 2^( 4) =       0.000403488376
  error estimate for blocks of size 2^( 5) =       0.000407681575
  error estimate for blocks of size 2^( 6) =       0.000411150057
  error estimate for blocks of size 2^( 7) =       0.000412416292

      target function =      -0.942621436285
              le_mean =     -17.211785566437
             les_mean =     296.526916075735
             stat err =       0.000408684075
             autocorr =       1.236633657511
   target nu stat err =       0.000408684075
   target dn stat err =       0.001994277082
      target stat err =       0.003410885445
              std dev =       0.519735260224
             le_variance =       0.270124740720

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270233438095
                                         uncertainty =       0.001532273825

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270233438095
                                         uncertainty =       0.001532273825

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367508393
  error estimate for blocks of size 2^( 2) =       0.000381786699
  error estimate for blocks of size 2^( 3) =       0.000394520734
  error estimate for blocks of size 2^( 4) =       0.000403488404
  error estimate for blocks of size 2^( 5) =       0.000407681603
  error estimate for blocks of size 2^( 6) =       0.000411150090
  error estimate for blocks of size 2^( 7) =       0.000412416338

      target function =      -0.942621221053
              le_mean =     -17.211785564762
             les_mean =     296.526916146857
             stat err =       0.000408684109
             autocorr =       1.236633417370
   target nu stat err =       0.000408684109
   target dn stat err =       0.001994280317
      target stat err =       0.003410889208
              std dev =       0.519735353482
             le_variance =       0.270124837659

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270233523094
                                         uncertainty =       0.001532275986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270233523094
                                         uncertainty =       0.001532275986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367508451
  error estimate for blocks of size 2^( 2) =       0.000381786751
  error estimate for blocks of size 2^( 3) =       0.000394520776
  error estimate for blocks of size 2^( 4) =       0.000403488428
  error estimate for blocks of size 2^( 5) =       0.000407681628
  error estimate for blocks of size 2^( 6) =       0.000411150119
  error estimate for blocks of size 2^( 7) =       0.000412416378

      target function =      -0.942621024868
              le_mean =     -17.211785563302
             les_mean =     296.526916213947
             stat err =       0.000408684138
             autocorr =       1.236633207142
   target nu stat err =       0.000408684138
   target dn stat err =       0.001994283211
      target stat err =       0.003410892549
              std dev =       0.519735435154
             le_variance =       0.270124922555


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942620996237        initial
     2.3283e+02     2.3283e+03             7.0687e-07        -0.942621436285  <--
     9.3132e+02     9.3132e+03             1.7675e-07        -0.942621221053
     3.7253e+03     3.7253e+04             4.4191e-08        -0.942621024868

*****************************************************************************
Applying the update for shift_i =   2.3283e+02     and shift_s =   2.3283e+03
*****************************************************************************

  Execution time = 2.3182e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
ci_001                -4.189719e-02 3 1  ON 0
ci_002                -3.205304e-02 3 1  ON 1
ci_003                -2.638665e-02 3 1  ON 2
ci_004                 2.370133e-02 3 1  ON 3
ci_005                 2.406862e-02 3 1  ON 4
ci_006                -2.137365e-02 3 1  ON 5
ci_007                -2.098397e-02 3 1  ON 6
ci_008                -8.487999e-03 3 1  ON 7
ci_009                -1.386157e-02 3 1  ON 8
ci_010                -1.004375e-02 3 1  ON 9
ci_011                -1.125186e-02 3 1  ON 10
ci_012                -9.780831e-03 3 1  ON 11
ci_013                -1.986308e-02 3 1  ON 12
ci_014                 1.228506e-02 3 1  ON 13
ci_015                 1.198016e-02 3 1  ON 14
ci_016                 1.744800e-02 3 1  ON 15
ci_017                 1.636427e-02 3 1  ON 16
ci_018                 1.024157e-02 3 1  ON 17
ci_019                 1.012457e-02 3 1  ON 18
ci_020                 1.779206e-02 3 1  ON 19
ci_021                 1.747353e-02 3 1  ON 20
ci_022                 9.162586e-03 3 1  ON 21
ci_023                 9.197900e-03 3 1  ON 22
ci_024                 9.620653e-03 3 1  ON 23
ci_025                 1.014482e-02 3 1  ON 24
ci_026                 1.159371e-02 3 1  ON 25
ci_027                 1.165929e-02 3 1  ON 26
ci_028                -1.476778e-02 3 1  ON 27
ci_029                -1.645491e-02 3 1  ON 28
ci_030                -9.547254e-03 3 1  ON 29
ci_031                -9.000883e-03 3 1  ON 30
ci_032                -1.473005e-02 3 1  ON 31
ci_033                 5.286972e-03 3 1  ON 32
ci_034                 5.587473e-03 3 1  ON 33
ci_035                -5.092983e-03 3 1  ON 34
ci_036                -1.273803e-02 3 1  ON 35
ci_037                -1.241067e-02 3 1  ON 36
ci_038                 2.041378e-03 3 1  ON 37
ci_039                 1.745493e-03 3 1  ON 38
ci_040                -3.185270e-03 3 1  ON 39
ci_041                 9.422220e-03 3 1  ON 40
ci_042                 8.206483e-03 3 1  ON 41
ci_043                -4.068355e-03 3 1  ON 42
ci_044                -3.901956e-03 3 1  ON 43
ci_045                -3.570979e-03 3 1  ON 44
ci_046                 5.631118e-03 3 1  ON 45
ci_047                 5.548664e-03 3 1  ON 46
ci_048                -1.268025e-02 3 1  ON 47
ci_049                -1.440473e-02 3 1  ON 48
ci_050                 3.145751e-03 3 1  ON 49
ci_051                 2.814682e-03 3 1  ON 50
ci_052                -2.338113e-03 3 1  ON 51
ci_053                -2.441778e-03 3 1  ON 52
ci_054                -3.364424e-03 3 1  ON 53
ci_055                -2.954225e-03 3 1  ON 54
ci_056                 5.569971e-03 3 1  ON 55
ci_057                 5.316506e-03 3 1  ON 56
ci_058                -1.111678e-03 3 1  ON 57
ci_059                -2.164597e-03 3 1  ON 58
ci_060                 4.641861e-03 3 1  ON 59
ci_061                 5.616150e-03 3 1  ON 60
ci_062                -3.751441e-03 3 1  ON 61
ci_063                -4.015102e-03 3 1  ON 62
ci_064                -2.643036e-03 3 1  ON 63
ci_065                -4.358034e-03 3 1  ON 64
ci_066                 4.477438e-03 3 1  ON 65
ci_067                 4.338494e-03 3 1  ON 66
ci_068                -4.207394e-03 3 1  ON 67
ci_069                -5.000604e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0250e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.1987
    reference variance = 0.656388
====================================================
  Execution time = 1.6365e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8244e-01
  Total weights = 1.957206843e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4834e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269420478955
                                         uncertainty =       0.001746948116

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269420478955
                                         uncertainty =       0.001746948116

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367068217
  error estimate for blocks of size 2^( 2) =       0.000380948221
  error estimate for blocks of size 2^( 3) =       0.000393874399
  error estimate for blocks of size 2^( 4) =       0.000403417130
  error estimate for blocks of size 2^( 5) =       0.000408824407
  error estimate for blocks of size 2^( 6) =       0.000410796757
  error estimate for blocks of size 2^( 7) =       0.000414525148

      target function =      -0.940780336012
              le_mean =     -17.211873841351
             les_mean =     296.531040676706
             stat err =       0.000409390860
             autocorr =       1.243892130222
   target nu stat err =       0.000409390860
   target dn stat err =       0.003756359692
      target stat err =       0.006296558936
              std dev =       0.519112851394
             le_variance =       0.269478152482


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721187384135e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940821504958       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940822572248       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940822685900       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940822726604       residual = 8.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940822728889       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940822727609       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940822728304       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940822728507       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940822728458       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940822728427       residual = 4.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+01 is 3.104585e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940821504958       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940821772060       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940821800496       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940821810678       residual = 8.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940821811248       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940821810929       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940821811102       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940821811153       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940821811141       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940821811133       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+02 is 7.769655e-07

solving harmonic davidson linear method for identity shift 9.3132e+02, overlap shift 9.3132e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940821504958       residual = 1.69e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940821571751       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940821578862       residual = 4.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940821581409       residual = 8.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940821581549       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940821581470       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940821581514       residual = 4.73e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940821581527       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940821581523       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940821581520       residual = 4.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.3132e+02 is 1.942926e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.193014 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8857e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_001                -4.189721e-02 3 1  ON 0
ci_002                -3.205293e-02 3 1  ON 1
ci_003                -2.638613e-02 3 1  ON 2
ci_004                 2.370158e-02 3 1  ON 3
ci_005                 2.406836e-02 3 1  ON 4
ci_006                -2.137353e-02 3 1  ON 5
ci_007                -2.098385e-02 3 1  ON 6
ci_008                -8.488124e-03 3 1  ON 7
ci_009                -1.386205e-02 3 1  ON 8
ci_010                -1.004367e-02 3 1  ON 9
ci_011                -1.125149e-02 3 1  ON 10
ci_012                -9.780645e-03 3 1  ON 11
ci_013                -1.986283e-02 3 1  ON 12
ci_014                 1.228516e-02 3 1  ON 13
ci_015                 1.198021e-02 3 1  ON 14
ci_016                 1.744749e-02 3 1  ON 15
ci_017                 1.636423e-02 3 1  ON 16
ci_018                 1.024152e-02 3 1  ON 17
ci_019                 1.012438e-02 3 1  ON 18
ci_020                 1.779182e-02 3 1  ON 19
ci_021                 1.747345e-02 3 1  ON 20
ci_022                 9.162666e-03 3 1  ON 21
ci_023                 9.197601e-03 3 1  ON 22
ci_024                 9.620453e-03 3 1  ON 23
ci_025                 1.014470e-02 3 1  ON 24
ci_026                 1.159346e-02 3 1  ON 25
ci_027                 1.165901e-02 3 1  ON 26
ci_028                -1.476831e-02 3 1  ON 27
ci_029                -1.645494e-02 3 1  ON 28
ci_030                -9.546477e-03 3 1  ON 29
ci_031                -9.001023e-03 3 1  ON 30
ci_032                -1.473041e-02 3 1  ON 31
ci_033                 5.287365e-03 3 1  ON 32
ci_034                 5.587153e-03 3 1  ON 33
ci_035                -5.092845e-03 3 1  ON 34
ci_036                -1.273795e-02 3 1  ON 35
ci_037                -1.241082e-02 3 1  ON 36
ci_038                 2.041183e-03 3 1  ON 37
ci_039                 1.745561e-03 3 1  ON 38
ci_040                -3.185143e-03 3 1  ON 39
ci_041                 9.422121e-03 3 1  ON 40
ci_042                 8.206191e-03 3 1  ON 41
ci_043                -4.068304e-03 3 1  ON 42
ci_044                -3.902142e-03 3 1  ON 43
ci_045                -3.570879e-03 3 1  ON 44
ci_046                 5.631250e-03 3 1  ON 45
ci_047                 5.548868e-03 3 1  ON 46
ci_048                -1.268063e-02 3 1  ON 47
ci_049                -1.440451e-02 3 1  ON 48
ci_050                 3.145751e-03 3 1  ON 49
ci_051                 2.815143e-03 3 1  ON 50
ci_052                -2.337718e-03 3 1  ON 51
ci_053                -2.441644e-03 3 1  ON 52
ci_054                -3.364379e-03 3 1  ON 53
ci_055                -2.954331e-03 3 1  ON 54
ci_056                 5.569993e-03 3 1  ON 55
ci_057                 5.316634e-03 3 1  ON 56
ci_058                -1.111629e-03 3 1  ON 57
ci_059                -2.164536e-03 3 1  ON 58
ci_060                 4.642012e-03 3 1  ON 59
ci_061                 5.615970e-03 3 1  ON 60
ci_062                -3.751393e-03 3 1  ON 61
ci_063                -4.015116e-03 3 1  ON 62
ci_064                -2.643261e-03 3 1  ON 63
ci_065                -4.358017e-03 3 1  ON 64
ci_066                 4.477606e-03 3 1  ON 65
ci_067                 4.338503e-03 3 1  ON 66
ci_068                -4.207431e-03 3 1  ON 67
ci_069                -5.000696e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2782
    reference variance = 0.36872
====================================================
  Execution time = 1.3882e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7773e-01
  Total weights = 1.9573e+06
  Execution time = 1.8099e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267676689308
                                         uncertainty =       0.001390675863

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267676689308
                                         uncertainty =       0.001390675863

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365832793
  error estimate for blocks of size 2^( 2) =       0.000379492590
  error estimate for blocks of size 2^( 3) =       0.000392554244
  error estimate for blocks of size 2^( 4) =       0.000401609160
  error estimate for blocks of size 2^( 5) =       0.000407006223
  error estimate for blocks of size 2^( 6) =       0.000409970407
  error estimate for blocks of size 2^( 7) =       0.000409437989

      target function =      -0.948723531390
              le_mean =     -17.212004232116
             les_mean =     296.530818832799
             stat err =       0.000407005945
             autocorr =       1.237759420063
   target nu stat err =       0.000407005945
   target dn stat err =       0.001818360922
      target stat err =       0.003164307716
              std dev =       0.517365697151
             le_variance =       0.267667264588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267675755789
                                         uncertainty =       0.001390607817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267675755789
                                         uncertainty =       0.001390607817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365832156
  error estimate for blocks of size 2^( 2) =       0.000379492010
  error estimate for blocks of size 2^( 3) =       0.000392553748
  error estimate for blocks of size 2^( 4) =       0.000401608739
  error estimate for blocks of size 2^( 5) =       0.000407005887
  error estimate for blocks of size 2^( 6) =       0.000409969983
  error estimate for blocks of size 2^( 7) =       0.000409437561

      target function =      -0.948726494230
              le_mean =     -17.212004268210
             les_mean =     296.530818326130
             stat err =       0.000407005543
             autocorr =       1.237761280323
   target nu stat err =       0.000407005543
   target dn stat err =       0.001818376228
      target stat err =       0.003164352242
              std dev =       0.517364797022
             le_variance =       0.267666333197

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267676221792
                                         uncertainty =       0.001390641803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267676221792
                                         uncertainty =       0.001390641803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365832474
  error estimate for blocks of size 2^( 2) =       0.000379492299
  error estimate for blocks of size 2^( 3) =       0.000392553996
  error estimate for blocks of size 2^( 4) =       0.000401608949
  error estimate for blocks of size 2^( 5) =       0.000407006055
  error estimate for blocks of size 2^( 6) =       0.000409970195
  error estimate for blocks of size 2^( 7) =       0.000409437774

      target function =      -0.948725435578
              le_mean =     -17.212004250152
             les_mean =     296.530818329488
             stat err =       0.000407005743
             autocorr =       1.237760351184
   target nu stat err =       0.000407005743
   target dn stat err =       0.001818366850
      target stat err =       0.003164329882
              std dev =       0.517365246356
             le_variance =       0.267666798137

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267676630820
                                         uncertainty =       0.001390671604

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267676630820
                                         uncertainty =       0.001390671604

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365832753
  error estimate for blocks of size 2^( 2) =       0.000379492553
  error estimate for blocks of size 2^( 3) =       0.000392554213
  error estimate for blocks of size 2^( 4) =       0.000401609133
  error estimate for blocks of size 2^( 5) =       0.000407006202
  error estimate for blocks of size 2^( 6) =       0.000409970381
  error estimate for blocks of size 2^( 7) =       0.000409437962

      target function =      -0.948723831826
              le_mean =     -17.212004234368
             les_mean =     296.530818732953
             stat err =       0.000407005920
             autocorr =       1.237759536497
   target nu stat err =       0.000407005920
   target dn stat err =       0.001818361409
      target stat err =       0.003164310473
              std dev =       0.517365640755
             le_variance =       0.267667206233


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948723531390        initial
     5.8208e+01     5.8208e+02             3.1046e-06        -0.948726494230  <--
     2.3283e+02     2.3283e+03             7.7697e-07        -0.948725435578
     9.3132e+02     9.3132e+03             1.9429e-07        -0.948723831826

*****************************************************************************
Applying the update for shift_i =   5.8208e+01     and shift_s =   5.8208e+02
*****************************************************************************

  Execution time = 2.3062e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
ci_001                -4.189726e-02 3 1  ON 0
ci_002                -3.205259e-02 3 1  ON 1
ci_003                -2.638459e-02 3 1  ON 2
ci_004                 2.370233e-02 3 1  ON 3
ci_005                 2.406757e-02 3 1  ON 4
ci_006                -2.137316e-02 3 1  ON 5
ci_007                -2.098352e-02 3 1  ON 6
ci_008                -8.488498e-03 3 1  ON 7
ci_009                -1.386347e-02 3 1  ON 8
ci_010                -1.004342e-02 3 1  ON 9
ci_011                -1.125037e-02 3 1  ON 10
ci_012                -9.780089e-03 3 1  ON 11
ci_013                -1.986207e-02 3 1  ON 12
ci_014                 1.228545e-02 3 1  ON 13
ci_015                 1.198036e-02 3 1  ON 14
ci_016                 1.744594e-02 3 1  ON 15
ci_017                 1.636412e-02 3 1  ON 16
ci_018                 1.024137e-02 3 1  ON 17
ci_019                 1.012382e-02 3 1  ON 18
ci_020                 1.779110e-02 3 1  ON 19
ci_021                 1.747321e-02 3 1  ON 20
ci_022                 9.162905e-03 3 1  ON 21
ci_023                 9.196703e-03 3 1  ON 22
ci_024                 9.619856e-03 3 1  ON 23
ci_025                 1.014435e-02 3 1  ON 24
ci_026                 1.159272e-02 3 1  ON 25
ci_027                 1.165814e-02 3 1  ON 26
ci_028                -1.476990e-02 3 1  ON 27
ci_029                -1.645500e-02 3 1  ON 28
ci_030                -9.544149e-03 3 1  ON 29
ci_031                -9.001442e-03 3 1  ON 30
ci_032                -1.473149e-02 3 1  ON 31
ci_033                 5.288542e-03 3 1  ON 32
ci_034                 5.586192e-03 3 1  ON 33
ci_035                -5.092433e-03 3 1  ON 34
ci_036                -1.273772e-02 3 1  ON 35
ci_037                -1.241128e-02 3 1  ON 36
ci_038                 2.040600e-03 3 1  ON 37
ci_039                 1.745765e-03 3 1  ON 38
ci_040                -3.184762e-03 3 1  ON 39
ci_041                 9.421823e-03 3 1  ON 40
ci_042                 8.205315e-03 3 1  ON 41
ci_043                -4.068149e-03 3 1  ON 42
ci_044                -3.902699e-03 3 1  ON 43
ci_045                -3.570580e-03 3 1  ON 44
ci_046                 5.631645e-03 3 1  ON 45
ci_047                 5.549479e-03 3 1  ON 46
ci_048                -1.268178e-02 3 1  ON 47
ci_049                -1.440385e-02 3 1  ON 48
ci_050                 3.145751e-03 3 1  ON 49
ci_051                 2.816523e-03 3 1  ON 50
ci_052                -2.336533e-03 3 1  ON 51
ci_053                -2.441242e-03 3 1  ON 52
ci_054                -3.364243e-03 3 1  ON 53
ci_055                -2.954647e-03 3 1  ON 54
ci_056                 5.570060e-03 3 1  ON 55
ci_057                 5.317019e-03 3 1  ON 56
ci_058                -1.111481e-03 3 1  ON 57
ci_059                -2.164354e-03 3 1  ON 58
ci_060                 4.642463e-03 3 1  ON 59
ci_061                 5.615431e-03 3 1  ON 60
ci_062                -3.751248e-03 3 1  ON 61
ci_063                -4.015157e-03 3 1  ON 62
ci_064                -2.643936e-03 3 1  ON 63
ci_065                -4.357965e-03 3 1  ON 64
ci_066                 4.478109e-03 3 1  ON 65
ci_067                 4.338532e-03 3 1  ON 66
ci_068                -4.207543e-03 3 1  ON 67
ci_069                -5.000971e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1926e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.1842
    reference variance = 3.49631
====================================================
  Execution time = 1.4399e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5268e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7815e-01
  Total weights = 1.957458231e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5032e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267129495158
                                         uncertainty =       0.001992024051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267129495158
                                         uncertainty =       0.001992024051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365444718
  error estimate for blocks of size 2^( 2) =       0.000379467456
  error estimate for blocks of size 2^( 3) =       0.000392293220
  error estimate for blocks of size 2^( 4) =       0.000401703295
  error estimate for blocks of size 2^( 5) =       0.000407737858
  error estimate for blocks of size 2^( 6) =       0.000410635460
  error estimate for blocks of size 2^( 7) =       0.000411926262

      target function =      -0.947994637453
              le_mean =     -17.211885931275
             les_mean =     296.527170625098
             stat err =       0.000408000719
             autocorr =       1.246460376990
   target nu stat err =       0.000408000719
   target dn stat err =       0.002520060335
      target stat err =       0.004322449680
              std dev =       0.516816876678
             le_variance =       0.267099684020


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721188593127e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+01, overlap shift 1.4552e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948013572977       residual = 7.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948016006161       residual = 9.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948016279300       residual = 2.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948016371913       residual = 3.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948016387035       residual = 6.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948016390880       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948016392019       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948016392181       residual = 5.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948016392436       residual = 8.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+01 is 7.459644e-06

solving harmonic davidson linear method for identity shift 5.8208e+01, overlap shift 5.8208e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948013572977       residual = 7.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948014183794       residual = 9.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948014252287       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948014275489       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948014279271       residual = 6.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948014280232       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948014280517       residual = 2.24e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948014280557       residual = 5.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948014280620       residual = 8.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+01 is 1.872637e-06

solving harmonic davidson linear method for identity shift 2.3283e+02, overlap shift 2.3283e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948013572977       residual = 7.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948013725840       residual = 9.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948013742976       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948013748779       residual = 3.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948013749725       residual = 6.76e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948013749966       residual = 1.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948013750037       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948013750046       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948013750062       residual = 8.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+02 is 4.686447e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.196022 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6911e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_001                -4.189592e-02 3 1  ON 0
ci_002                -3.205283e-02 3 1  ON 1
ci_003                -2.638414e-02 3 1  ON 2
ci_004                 2.370138e-02 3 1  ON 3
ci_005                 2.406667e-02 3 1  ON 4
ci_006                -2.137261e-02 3 1  ON 5
ci_007                -2.098341e-02 3 1  ON 6
ci_008                -8.488513e-03 3 1  ON 7
ci_009                -1.386526e-02 3 1  ON 8
ci_010                -1.004313e-02 3 1  ON 9
ci_011                -1.125117e-02 3 1  ON 10
ci_012                -9.779425e-03 3 1  ON 11
ci_013                -1.986164e-02 3 1  ON 12
ci_014                 1.228625e-02 3 1  ON 13
ci_015                 1.198042e-02 3 1  ON 14
ci_016                 1.744472e-02 3 1  ON 15
ci_017                 1.636432e-02 3 1  ON 16
ci_018                 1.024221e-02 3 1  ON 17
ci_019                 1.012329e-02 3 1  ON 18
ci_020                 1.779034e-02 3 1  ON 19
ci_021                 1.747206e-02 3 1  ON 20
ci_022                 9.163477e-03 3 1  ON 21
ci_023                 9.196974e-03 3 1  ON 22
ci_024                 9.619493e-03 3 1  ON 23
ci_025                 1.014411e-02 3 1  ON 24
ci_026                 1.159190e-02 3 1  ON 25
ci_027                 1.166002e-02 3 1  ON 26
ci_028                -1.476894e-02 3 1  ON 27
ci_029                -1.645350e-02 3 1  ON 28
ci_030                -9.542799e-03 3 1  ON 29
ci_031                -9.001900e-03 3 1  ON 30
ci_032                -1.473237e-02 3 1  ON 31
ci_033                 5.288567e-03 3 1  ON 32
ci_034                 5.584734e-03 3 1  ON 33
ci_035                -5.091396e-03 3 1  ON 34
ci_036                -1.273732e-02 3 1  ON 35
ci_037                -1.241028e-02 3 1  ON 36
ci_038                 2.040931e-03 3 1  ON 37
ci_039                 1.746059e-03 3 1  ON 38
ci_040                -3.184341e-03 3 1  ON 39
ci_041                 9.421076e-03 3 1  ON 40
ci_042                 8.205715e-03 3 1  ON 41
ci_043                -4.068356e-03 3 1  ON 42
ci_044                -3.903583e-03 3 1  ON 43
ci_045                -3.570241e-03 3 1  ON 44
ci_046                 5.631858e-03 3 1  ON 45
ci_047                 5.549509e-03 3 1  ON 46
ci_048                -1.268167e-02 3 1  ON 47
ci_049                -1.440199e-02 3 1  ON 48
ci_050                 3.146000e-03 3 1  ON 49
ci_051                 2.816652e-03 3 1  ON 50
ci_052                -2.335730e-03 3 1  ON 51
ci_053                -2.441635e-03 3 1  ON 52
ci_054                -3.362990e-03 3 1  ON 53
ci_055                -2.954234e-03 3 1  ON 54
ci_056                 5.570284e-03 3 1  ON 55
ci_057                 5.316919e-03 3 1  ON 56
ci_058                -1.110748e-03 3 1  ON 57
ci_059                -2.164443e-03 3 1  ON 58
ci_060                 4.642743e-03 3 1  ON 59
ci_061                 5.614726e-03 3 1  ON 60
ci_062                -3.750778e-03 3 1  ON 61
ci_063                -4.015003e-03 3 1  ON 62
ci_064                -2.644571e-03 3 1  ON 63
ci_065                -4.358160e-03 3 1  ON 64
ci_066                 4.478176e-03 3 1  ON 65
ci_067                 4.338370e-03 3 1  ON 66
ci_068                -4.206680e-03 3 1  ON 67
ci_069                -5.000917e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.2581
    reference variance = 0.39865
====================================================
  Execution time = 1.3900e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8041e-01
  Total weights = 1.9572e+06
  Execution time = 1.8126e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269439412086
                                         uncertainty =       0.001721993644

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269439412086
                                         uncertainty =       0.001721993644

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367041384
  error estimate for blocks of size 2^( 2) =       0.000380620572
  error estimate for blocks of size 2^( 3) =       0.000392649211
  error estimate for blocks of size 2^( 4) =       0.000400980875
  error estimate for blocks of size 2^( 5) =       0.000407095050
  error estimate for blocks of size 2^( 6) =       0.000408486767
  error estimate for blocks of size 2^( 7) =       0.000408619316

      target function =      -0.944234469898
              le_mean =     -17.213025839948
             les_mean =     296.568650621070
             stat err =       0.000406295502
             autocorr =       1.225332527083
   target nu stat err =       0.000406295502
   target dn stat err =       0.002229231512
      target stat err =       0.003816391345
              std dev =       0.519074902588
             le_variance =       0.269438754496

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269438434753
                                         uncertainty =       0.001722081999

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269438434753
                                         uncertainty =       0.001722081999

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367040711
  error estimate for blocks of size 2^( 2) =       0.000380620077
  error estimate for blocks of size 2^( 3) =       0.000392648911
  error estimate for blocks of size 2^( 4) =       0.000400980911
  error estimate for blocks of size 2^( 5) =       0.000407095119
  error estimate for blocks of size 2^( 6) =       0.000408487103
  error estimate for blocks of size 2^( 7) =       0.000408619735

      target function =      -0.944074175145
              le_mean =     -17.213025745499
             les_mean =     296.568742513715
             stat err =       0.000406295717
             autocorr =       1.225338312490
   target nu stat err =       0.000406295717
   target dn stat err =       0.002258541392
      target stat err =       0.003863489971
              std dev =       0.519073951768
             le_variance =       0.269437767404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269438918658
                                         uncertainty =       0.001722037942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269438918658
                                         uncertainty =       0.001722037942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367041044
  error estimate for blocks of size 2^( 2) =       0.000380620321
  error estimate for blocks of size 2^( 3) =       0.000392649058
  error estimate for blocks of size 2^( 4) =       0.000400980891
  error estimate for blocks of size 2^( 5) =       0.000407095082
  error estimate for blocks of size 2^( 6) =       0.000408486933
  error estimate for blocks of size 2^( 7) =       0.000408619523

      target function =      -0.944159020215
              le_mean =     -17.213025792079
             les_mean =     296.568693756092
             stat err =       0.000406295607
             autocorr =       1.225335428720
   target nu stat err =       0.000406295607
   target dn stat err =       0.002242661304
      target stat err =       0.003837957255
              std dev =       0.519074422575
             le_variance =       0.269438256171

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269439350028
                                         uncertainty =       0.001721999180

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269439350028
                                         uncertainty =       0.001721999180

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367041341
  error estimate for blocks of size 2^( 2) =       0.000380620540
  error estimate for blocks of size 2^( 3) =       0.000392649191
  error estimate for blocks of size 2^( 4) =       0.000400980876
  error estimate for blocks of size 2^( 5) =       0.000407095054
  error estimate for blocks of size 2^( 6) =       0.000408486788
  error estimate for blocks of size 2^( 7) =       0.000408619342

      target function =      -0.944225532979
              le_mean =     -17.213025833906
             les_mean =     296.568655717500
             stat err =       0.000406295515
             autocorr =       1.225332890015
   target nu stat err =       0.000406295515
   target dn stat err =       0.002230788188
      target stat err =       0.003818889694
              std dev =       0.519074842220
             le_variance =       0.269438691826


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.944234469898        initial  <--
     1.4552e+01     1.4552e+02             7.4596e-06        -0.944074175145
     5.8208e+01     5.8208e+02             1.8726e-06        -0.944159020215
     2.3283e+02     2.3283e+03             4.6864e-07        -0.944225532979

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0649
  </log>
  <optVariables href="H2O.s051.opt.xml">
ci_001                -4.189726e-02 3 1  ON 0
ci_002                -3.205259e-02 3 1  ON 1
ci_003                -2.638459e-02 3 1  ON 2
ci_004                 2.370233e-02 3 1  ON 3
ci_005                 2.406757e-02 3 1  ON 4
ci_006                -2.137316e-02 3 1  ON 5
ci_007                -2.098352e-02 3 1  ON 6
ci_008                -8.488498e-03 3 1  ON 7
ci_009                -1.386347e-02 3 1  ON 8
ci_010                -1.004342e-02 3 1  ON 9
ci_011                -1.125037e-02 3 1  ON 10
ci_012                -9.780089e-03 3 1  ON 11
ci_013                -1.986207e-02 3 1  ON 12
ci_014                 1.228545e-02 3 1  ON 13
ci_015                 1.198036e-02 3 1  ON 14
ci_016                 1.744594e-02 3 1  ON 15
ci_017                 1.636412e-02 3 1  ON 16
ci_018                 1.024137e-02 3 1  ON 17
ci_019                 1.012382e-02 3 1  ON 18
ci_020                 1.779110e-02 3 1  ON 19
ci_021                 1.747321e-02 3 1  ON 20
ci_022                 9.162905e-03 3 1  ON 21
ci_023                 9.196703e-03 3 1  ON 22
ci_024                 9.619856e-03 3 1  ON 23
ci_025                 1.014435e-02 3 1  ON 24
ci_026                 1.159272e-02 3 1  ON 25
ci_027                 1.165814e-02 3 1  ON 26
ci_028                -1.476990e-02 3 1  ON 27
ci_029                -1.645500e-02 3 1  ON 28
ci_030                -9.544149e-03 3 1  ON 29
ci_031                -9.001442e-03 3 1  ON 30
ci_032                -1.473149e-02 3 1  ON 31
ci_033                 5.288542e-03 3 1  ON 32
ci_034                 5.586192e-03 3 1  ON 33
ci_035                -5.092433e-03 3 1  ON 34
ci_036                -1.273772e-02 3 1  ON 35
ci_037                -1.241128e-02 3 1  ON 36
ci_038                 2.040600e-03 3 1  ON 37
ci_039                 1.745765e-03 3 1  ON 38
ci_040                -3.184762e-03 3 1  ON 39
ci_041                 9.421823e-03 3 1  ON 40
ci_042                 8.205315e-03 3 1  ON 41
ci_043                -4.068149e-03 3 1  ON 42
ci_044                -3.902699e-03 3 1  ON 43
ci_045                -3.570580e-03 3 1  ON 44
ci_046                 5.631645e-03 3 1  ON 45
ci_047                 5.549479e-03 3 1  ON 46
ci_048                -1.268178e-02 3 1  ON 47
ci_049                -1.440385e-02 3 1  ON 48
ci_050                 3.145751e-03 3 1  ON 49
ci_051                 2.816523e-03 3 1  ON 50
ci_052                -2.336533e-03 3 1  ON 51
ci_053                -2.441242e-03 3 1  ON 52
ci_054                -3.364243e-03 3 1  ON 53
ci_055                -2.954647e-03 3 1  ON 54
ci_056                 5.570060e-03 3 1  ON 55
ci_057                 5.317019e-03 3 1  ON 56
ci_058                -1.111481e-03 3 1  ON 57
ci_059                -2.164354e-03 3 1  ON 58
ci_060                 4.642463e-03 3 1  ON 59
ci_061                 5.615431e-03 3 1  ON 60
ci_062                -3.751248e-03 3 1  ON 61
ci_063                -4.015157e-03 3 1  ON 62
ci_064                -2.643936e-03 3 1  ON 63
ci_065                -4.357965e-03 3 1  ON 64
ci_066                 4.478109e-03 3 1  ON 65
ci_067                 4.338532e-03 3 1  ON 66
ci_068                -4.207543e-03 3 1  ON 67
ci_069                -5.000971e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9982e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.2558
    reference variance = 0.299438
====================================================
  Execution time = 1.4276e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5307e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7847e-01
  Total weights = 1.957260415e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5102e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267743195967
                                         uncertainty =       0.001508021514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267743195967
                                         uncertainty =       0.001508021514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365882353
  error estimate for blocks of size 2^( 2) =       0.000379981002
  error estimate for blocks of size 2^( 3) =       0.000392331560
  error estimate for blocks of size 2^( 4) =       0.000401604192
  error estimate for blocks of size 2^( 5) =       0.000407959503
  error estimate for blocks of size 2^( 6) =       0.000410287418
  error estimate for blocks of size 2^( 7) =       0.000411958271

      target function =      -0.947466571194
              le_mean =     -17.212364629678
             les_mean =     296.543968431579
             stat err =       0.000407952346
             autocorr =       1.243185520801
   target nu stat err =       0.000407952346
   target dn stat err =       0.002158848149
      target stat err =       0.003721119303
              std dev =       0.517435785680
             le_variance =       0.267739792302


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721236462968e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947480382790       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947480670750       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947480713197       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947480725967       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947480727284       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947480727714       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947480727850       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947480727966       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947480727937       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947480727945       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+02 is 8.165871e-07

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947480382790       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947480454810       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947480465425       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947480468619       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947480468948       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947480469055       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947480469089       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947480469118       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947480469111       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947480469112       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+02 is 2.042161e-07

solving harmonic davidson linear method for identity shift 2.3283e+03, overlap shift 2.3283e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947480382790       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947480400797       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947480403451       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947480404250       residual = 4.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947480404330       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947480404356       residual = 2.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947480404362       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947480404373       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947480404374       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.947480404372       residual = 3.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.3283e+03 is 5.105835e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.199481 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6797e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_001                -4.189711e-02 3 1  ON 0
ci_002                -3.205239e-02 3 1  ON 1
ci_003                -2.638461e-02 3 1  ON 2
ci_004                 2.370236e-02 3 1  ON 3
ci_005                 2.406758e-02 3 1  ON 4
ci_006                -2.137318e-02 3 1  ON 5
ci_007                -2.098347e-02 3 1  ON 6
ci_008                -8.488529e-03 3 1  ON 7
ci_009                -1.386354e-02 3 1  ON 8
ci_010                -1.004325e-02 3 1  ON 9
ci_011                -1.125026e-02 3 1  ON 10
ci_012                -9.780218e-03 3 1  ON 11
ci_013                -1.986203e-02 3 1  ON 12
ci_014                 1.228546e-02 3 1  ON 13
ci_015                 1.198045e-02 3 1  ON 14
ci_016                 1.744575e-02 3 1  ON 15
ci_017                 1.636409e-02 3 1  ON 16
ci_018                 1.024149e-02 3 1  ON 17
ci_019                 1.012385e-02 3 1  ON 18
ci_020                 1.779098e-02 3 1  ON 19
ci_021                 1.747320e-02 3 1  ON 20
ci_022                 9.162908e-03 3 1  ON 21
ci_023                 9.196620e-03 3 1  ON 22
ci_024                 9.619872e-03 3 1  ON 23
ci_025                 1.014434e-02 3 1  ON 24
ci_026                 1.159255e-02 3 1  ON 25
ci_027                 1.165812e-02 3 1  ON 26
ci_028                -1.476989e-02 3 1  ON 27
ci_029                -1.645491e-02 3 1  ON 28
ci_030                -9.544094e-03 3 1  ON 29
ci_031                -9.001558e-03 3 1  ON 30
ci_032                -1.473157e-02 3 1  ON 31
ci_033                 5.288585e-03 3 1  ON 32
ci_034                 5.586223e-03 3 1  ON 33
ci_035                -5.092323e-03 3 1  ON 34
ci_036                -1.273770e-02 3 1  ON 35
ci_037                -1.241131e-02 3 1  ON 36
ci_038                 2.040551e-03 3 1  ON 37
ci_039                 1.745746e-03 3 1  ON 38
ci_040                -3.184749e-03 3 1  ON 39
ci_041                 9.421791e-03 3 1  ON 40
ci_042                 8.205386e-03 3 1  ON 41
ci_043                -4.068121e-03 3 1  ON 42
ci_044                -3.902656e-03 3 1  ON 43
ci_045                -3.570493e-03 3 1  ON 44
ci_046                 5.631652e-03 3 1  ON 45
ci_047                 5.549526e-03 3 1  ON 46
ci_048                -1.268174e-02 3 1  ON 47
ci_049                -1.440365e-02 3 1  ON 48
ci_050                 3.145809e-03 3 1  ON 49
ci_051                 2.816666e-03 3 1  ON 50
ci_052                -2.336399e-03 3 1  ON 51
ci_053                -2.441256e-03 3 1  ON 52
ci_054                -3.364096e-03 3 1  ON 53
ci_055                -2.954609e-03 3 1  ON 54
ci_056                 5.570042e-03 3 1  ON 55
ci_057                 5.317010e-03 3 1  ON 56
ci_058                -1.111478e-03 3 1  ON 57
ci_059                -2.164351e-03 3 1  ON 58
ci_060                 4.642407e-03 3 1  ON 59
ci_061                 5.615479e-03 3 1  ON 60
ci_062                -3.751204e-03 3 1  ON 61
ci_063                -4.015172e-03 3 1  ON 62
ci_064                -2.644019e-03 3 1  ON 63
ci_065                -4.357957e-03 3 1  ON 64
ci_066                 4.478176e-03 3 1  ON 65
ci_067                 4.338490e-03 3 1  ON 66
ci_068                -4.207681e-03 3 1  ON 67
ci_069                -5.000947e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.291
    reference variance = 0.221069
====================================================
  Execution time = 1.3814e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7726e-01
  Total weights = 1.9574e+06
  Execution time = 1.8145e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266358242934
                                         uncertainty =       0.001527219630

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266358242934
                                         uncertainty =       0.001527219630

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364936199
  error estimate for blocks of size 2^( 2) =       0.000379088482
  error estimate for blocks of size 2^( 3) =       0.000392436195
  error estimate for blocks of size 2^( 4) =       0.000401465558
  error estimate for blocks of size 2^( 5) =       0.000406415230
  error estimate for blocks of size 2^( 6) =       0.000408938304
  error estimate for blocks of size 2^( 7) =       0.000411947170

      target function =      -0.949516203638
              le_mean =     -17.212149645215
             les_mean =     296.535356560182
             stat err =       0.000407191565
             autocorr =       1.244983679015
   target nu stat err =       0.000407191565
   target dn stat err =       0.002082473300
      target stat err =       0.003608109858
              std dev =       0.516097722117
             le_variance =       0.266356858774

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266358069084
                                         uncertainty =       0.001527235811

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266358069084
                                         uncertainty =       0.001527235811

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364936080
  error estimate for blocks of size 2^( 2) =       0.000379088380
  error estimate for blocks of size 2^( 3) =       0.000392436113
  error estimate for blocks of size 2^( 4) =       0.000401465501
  error estimate for blocks of size 2^( 5) =       0.000406415174
  error estimate for blocks of size 2^( 6) =       0.000408938282
  error estimate for blocks of size 2^( 7) =       0.000411947135

      target function =      -0.949521232616
              le_mean =     -17.212149647253
             les_mean =     296.535353668141
             stat err =       0.000407191523
             autocorr =       1.244984234078
   target nu stat err =       0.000407191523
   target dn stat err =       0.002082300850
      target stat err =       0.003607860655
              std dev =       0.516097553303
             le_variance =       0.266356684525

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266358155938
                                         uncertainty =       0.001527227723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266358155938
                                         uncertainty =       0.001527227723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364936139
  error estimate for blocks of size 2^( 2) =       0.000379088431
  error estimate for blocks of size 2^( 3) =       0.000392436154
  error estimate for blocks of size 2^( 4) =       0.000401465529
  error estimate for blocks of size 2^( 5) =       0.000406415202
  error estimate for blocks of size 2^( 6) =       0.000408938293
  error estimate for blocks of size 2^( 7) =       0.000411947153

      target function =      -0.949518738964
              le_mean =     -17.212149646229
             les_mean =     296.535355101702
             stat err =       0.000407191544
             autocorr =       1.244983956651
   target nu stat err =       0.000407191544
   target dn stat err =       0.002082386677
      target stat err =       0.003607984750
              std dev =       0.516097637641
             le_variance =       0.266356771578

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266358232055
                                         uncertainty =       0.001527220641

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266358232055
                                         uncertainty =       0.001527220641

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364936192
  error estimate for blocks of size 2^( 2) =       0.000379088476
  error estimate for blocks of size 2^( 3) =       0.000392436190
  error estimate for blocks of size 2^( 4) =       0.000401465554
  error estimate for blocks of size 2^( 5) =       0.000406415226
  error estimate for blocks of size 2^( 6) =       0.000408938303
  error estimate for blocks of size 2^( 7) =       0.000411947168

      target function =      -0.949516522815
              le_mean =     -17.212149645341
             les_mean =     296.535356376517
             stat err =       0.000407191563
             autocorr =       1.244983713730
   target nu stat err =       0.000407191563
   target dn stat err =       0.002082462430
      target stat err =       0.003608094166
              std dev =       0.516097711552
             le_variance =       0.266356847870


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949516203638        initial
     1.4552e+02     1.4552e+03             8.1659e-07        -0.949521232616  <--
     5.8208e+02     5.8208e+03             2.0422e-07        -0.949518738964
     2.3283e+03     2.3283e+04             5.1058e-08        -0.949516522815

*****************************************************************************
Applying the update for shift_i =   1.4552e+02     and shift_s =   1.4552e+03
*****************************************************************************

  Execution time = 2.3010e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
ci_001                -4.189666e-02 3 1  ON 0
ci_002                -3.205177e-02 3 1  ON 1
ci_003                -2.638466e-02 3 1  ON 2
ci_004                 2.370245e-02 3 1  ON 3
ci_005                 2.406759e-02 3 1  ON 4
ci_006                -2.137325e-02 3 1  ON 5
ci_007                -2.098333e-02 3 1  ON 6
ci_008                -8.488622e-03 3 1  ON 7
ci_009                -1.386373e-02 3 1  ON 8
ci_010                -1.004275e-02 3 1  ON 9
ci_011                -1.124992e-02 3 1  ON 10
ci_012                -9.780603e-03 3 1  ON 11
ci_013                -1.986191e-02 3 1  ON 12
ci_014                 1.228547e-02 3 1  ON 13
ci_015                 1.198072e-02 3 1  ON 14
ci_016                 1.744515e-02 3 1  ON 15
ci_017                 1.636401e-02 3 1  ON 16
ci_018                 1.024185e-02 3 1  ON 17
ci_019                 1.012396e-02 3 1  ON 18
ci_020                 1.779062e-02 3 1  ON 19
ci_021                 1.747315e-02 3 1  ON 20
ci_022                 9.162918e-03 3 1  ON 21
ci_023                 9.196368e-03 3 1  ON 22
ci_024                 9.619923e-03 3 1  ON 23
ci_025                 1.014430e-02 3 1  ON 24
ci_026                 1.159207e-02 3 1  ON 25
ci_027                 1.165803e-02 3 1  ON 26
ci_028                -1.476987e-02 3 1  ON 27
ci_029                -1.645465e-02 3 1  ON 28
ci_030                -9.543927e-03 3 1  ON 29
ci_031                -9.001908e-03 3 1  ON 30
ci_032                -1.473182e-02 3 1  ON 31
ci_033                 5.288716e-03 3 1  ON 32
ci_034                 5.586317e-03 3 1  ON 33
ci_035                -5.091993e-03 3 1  ON 34
ci_036                -1.273762e-02 3 1  ON 35
ci_037                -1.241141e-02 3 1  ON 36
ci_038                 2.040403e-03 3 1  ON 37
ci_039                 1.745689e-03 3 1  ON 38
ci_040                -3.184711e-03 3 1  ON 39
ci_041                 9.421692e-03 3 1  ON 40
ci_042                 8.205598e-03 3 1  ON 41
ci_043                -4.068034e-03 3 1  ON 42
ci_044                -3.902530e-03 3 1  ON 43
ci_045                -3.570231e-03 3 1  ON 44
ci_046                 5.631672e-03 3 1  ON 45
ci_047                 5.549668e-03 3 1  ON 46
ci_048                -1.268163e-02 3 1  ON 47
ci_049                -1.440305e-02 3 1  ON 48
ci_050                 3.145983e-03 3 1  ON 49
ci_051                 2.817093e-03 3 1  ON 50
ci_052                -2.335996e-03 3 1  ON 51
ci_053                -2.441299e-03 3 1  ON 52
ci_054                -3.363655e-03 3 1  ON 53
ci_055                -2.954496e-03 3 1  ON 54
ci_056                 5.569990e-03 3 1  ON 55
ci_057                 5.316982e-03 3 1  ON 56
ci_058                -1.111467e-03 3 1  ON 57
ci_059                -2.164344e-03 3 1  ON 58
ci_060                 4.642238e-03 3 1  ON 59
ci_061                 5.615621e-03 3 1  ON 60
ci_062                -3.751072e-03 3 1  ON 61
ci_063                -4.015215e-03 3 1  ON 62
ci_064                -2.644271e-03 3 1  ON 63
ci_065                -4.357935e-03 3 1  ON 64
ci_066                 4.478379e-03 3 1  ON 65
ci_067                 4.338366e-03 3 1  ON 66
ci_068                -4.208095e-03 3 1  ON 67
ci_069                -5.000875e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9813e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.1965
    reference variance = 0.138745
====================================================
  Execution time = 1.4284e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5296e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7740e-01
  Total weights = 1.957360036e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4925e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266595068708
                                         uncertainty =       0.001407932097

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266595068708
                                         uncertainty =       0.001407932097

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365119739
  error estimate for blocks of size 2^( 2) =       0.000379265438
  error estimate for blocks of size 2^( 3) =       0.000391602925
  error estimate for blocks of size 2^( 4) =       0.000400748231
  error estimate for blocks of size 2^( 5) =       0.000405988704
  error estimate for blocks of size 2^( 6) =       0.000408538951
  error estimate for blocks of size 2^( 7) =       0.000408981765

      target function =      -0.949294590598
              le_mean =     -17.212569198379
             les_mean =     296.549934911692
             stat err =       0.000406064413
             autocorr =       1.236856268158
   target nu stat err =       0.000406064413
   target dn stat err =       0.001921425105
      target stat err =       0.003341554698
              std dev =       0.516357287166
             le_variance =       0.266624848010


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721256919838e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+01, overlap shift 3.6380e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949305340408       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949306894263       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949307117253       residual = 5.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949307182940       residual = 7.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949307194138       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949307199908       residual = 4.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949307199774       residual = 8.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949307200637       residual = 2.49e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949307200372       residual = 2.87e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949307200412       residual = 6.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+01 is 4.117122e-06

solving harmonic davidson linear method for identity shift 1.4552e+02, overlap shift 1.4552e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949305340408       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949305729522       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949305785339       residual = 5.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949305801775       residual = 7.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949305804575       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949305806019       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949305805985       residual = 8.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949305806201       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949305806135       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949305806145       residual = 6.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+02 is 1.030807e-06

solving harmonic davidson linear method for identity shift 5.8208e+02, overlap shift 5.8208e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949305340408       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949305437727       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949305451686       residual = 5.27e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949305455796       residual = 7.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949305456496       residual = 1.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949305456857       residual = 4.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949305456848       residual = 8.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949305456902       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949305456886       residual = 2.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949305456888       residual = 6.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+02 is 2.577973e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.202921 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6785e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_001                -4.189625e-02 3 1  ON 0
ci_002                -3.205110e-02 3 1  ON 1
ci_003                -2.638441e-02 3 1  ON 2
ci_004                 2.370307e-02 3 1  ON 3
ci_005                 2.406743e-02 3 1  ON 4
ci_006                -2.137261e-02 3 1  ON 5
ci_007                -2.098321e-02 3 1  ON 6
ci_008                -8.488740e-03 3 1  ON 7
ci_009                -1.386400e-02 3 1  ON 8
ci_010                -1.004231e-02 3 1  ON 9
ci_011                -1.124971e-02 3 1  ON 10
ci_012                -9.781190e-03 3 1  ON 11
ci_013                -1.986104e-02 3 1  ON 12
ci_014                 1.228541e-02 3 1  ON 13
ci_015                 1.198066e-02 3 1  ON 14
ci_016                 1.744468e-02 3 1  ON 15
ci_017                 1.636393e-02 3 1  ON 16
ci_018                 1.024130e-02 3 1  ON 17
ci_019                 1.012418e-02 3 1  ON 18
ci_020                 1.779039e-02 3 1  ON 19
ci_021                 1.747264e-02 3 1  ON 20
ci_022                 9.163301e-03 3 1  ON 21
ci_023                 9.196638e-03 3 1  ON 22
ci_024                 9.620020e-03 3 1  ON 23
ci_025                 1.014432e-02 3 1  ON 24
ci_026                 1.159136e-02 3 1  ON 25
ci_027                 1.165773e-02 3 1  ON 26
ci_028                -1.476996e-02 3 1  ON 27
ci_029                -1.645403e-02 3 1  ON 28
ci_030                -9.543646e-03 3 1  ON 29
ci_031                -9.002226e-03 3 1  ON 30
ci_032                -1.473207e-02 3 1  ON 31
ci_033                 5.289010e-03 3 1  ON 32
ci_034                 5.586869e-03 3 1  ON 33
ci_035                -5.091746e-03 3 1  ON 34
ci_036                -1.273707e-02 3 1  ON 35
ci_037                -1.241126e-02 3 1  ON 36
ci_038                 2.040103e-03 3 1  ON 37
ci_039                 1.745750e-03 3 1  ON 38
ci_040                -3.184613e-03 3 1  ON 39
ci_041                 9.421462e-03 3 1  ON 40
ci_042                 8.205693e-03 3 1  ON 41
ci_043                -4.067811e-03 3 1  ON 42
ci_044                -3.902225e-03 3 1  ON 43
ci_045                -3.569780e-03 3 1  ON 44
ci_046                 5.631763e-03 3 1  ON 45
ci_047                 5.549668e-03 3 1  ON 46
ci_048                -1.268195e-02 3 1  ON 47
ci_049                -1.440255e-02 3 1  ON 48
ci_050                 3.145625e-03 3 1  ON 49
ci_051                 2.817342e-03 3 1  ON 50
ci_052                -2.336372e-03 3 1  ON 51
ci_053                -2.441005e-03 3 1  ON 52
ci_054                -3.363093e-03 3 1  ON 53
ci_055                -2.954309e-03 3 1  ON 54
ci_056                 5.569734e-03 3 1  ON 55
ci_057                 5.316972e-03 3 1  ON 56
ci_058                -1.112263e-03 3 1  ON 57
ci_059                -2.164068e-03 3 1  ON 58
ci_060                 4.642448e-03 3 1  ON 59
ci_061                 5.615860e-03 3 1  ON 60
ci_062                -3.751333e-03 3 1  ON 61
ci_063                -4.014926e-03 3 1  ON 62
ci_064                -2.644658e-03 3 1  ON 63
ci_065                -4.358000e-03 3 1  ON 64
ci_066                 4.478109e-03 3 1  ON 65
ci_067                 4.338889e-03 3 1  ON 66
ci_068                -4.208769e-03 3 1  ON 67
ci_069                -4.999844e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.2215
    reference variance = 0.310808
====================================================
  Execution time = 1.4061e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8280e-01
  Total weights = 1.9572e+06
  Execution time = 1.8204e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269877914083
                                         uncertainty =       0.001941736598

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269877914083
                                         uncertainty =       0.001941736598

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367353864
  error estimate for blocks of size 2^( 2) =       0.000381528556
  error estimate for blocks of size 2^( 3) =       0.000394077775
  error estimate for blocks of size 2^( 4) =       0.000403207277
  error estimate for blocks of size 2^( 5) =       0.000408492939
  error estimate for blocks of size 2^( 6) =       0.000411729299
  error estimate for blocks of size 2^( 7) =       0.000414212253

      target function =      -0.940177872797
              le_mean =     -17.212365820575
             les_mean =     296.548341967544
             stat err =       0.000409410442
             autocorr =       1.242077246780
   target nu stat err =       0.000409410442
   target dn stat err =       0.003461488679
      target stat err =       0.005807065835
              std dev =       0.519516816397
             le_variance =       0.269897722519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269877087495
                                         uncertainty =       0.001941808881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269877087495
                                         uncertainty =       0.001941808881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367353296
  error estimate for blocks of size 2^( 2) =       0.000381528079
  error estimate for blocks of size 2^( 3) =       0.000394077421
  error estimate for blocks of size 2^( 4) =       0.000403207044
  error estimate for blocks of size 2^( 5) =       0.000408492837
  error estimate for blocks of size 2^( 6) =       0.000411729381
  error estimate for blocks of size 2^( 7) =       0.000414212403

      target function =      -0.940176979402
              le_mean =     -17.212365786713
             les_mean =     296.548341328040
             stat err =       0.000409410416
             autocorr =       1.242080926318
   target nu stat err =       0.000409410416
   target dn stat err =       0.003462357604
      target stat err =       0.005808489633
              std dev =       0.519516014091
             le_variance =       0.269896888897

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269877499215
                                         uncertainty =       0.001941772766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269877499215
                                         uncertainty =       0.001941772766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367353579
  error estimate for blocks of size 2^( 2) =       0.000381528316
  error estimate for blocks of size 2^( 3) =       0.000394077597
  error estimate for blocks of size 2^( 4) =       0.000403207159
  error estimate for blocks of size 2^( 5) =       0.000408492887
  error estimate for blocks of size 2^( 6) =       0.000411729340
  error estimate for blocks of size 2^( 7) =       0.000414212327

      target function =      -0.940177498790
              le_mean =     -17.212365803520
             les_mean =     296.548341599858
             stat err =       0.000409410428
             autocorr =       1.242079089506
   target nu stat err =       0.000409410428
   target dn stat err =       0.003461923140
      target stat err =       0.005807778621
              std dev =       0.519516413723
             le_variance =       0.269897304127

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269877862099
                                         uncertainty =       0.001941741117

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269877862099
                                         uncertainty =       0.001941741117

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367353828
  error estimate for blocks of size 2^( 2) =       0.000381528526
  error estimate for blocks of size 2^( 3) =       0.000394077753
  error estimate for blocks of size 2^( 4) =       0.000403207262
  error estimate for blocks of size 2^( 5) =       0.000408492932
  error estimate for blocks of size 2^( 6) =       0.000411729304
  error estimate for blocks of size 2^( 7) =       0.000414212262

      target function =      -0.940177834100
              le_mean =     -17.212365818431
             les_mean =     296.548341916333
             stat err =       0.000409410440
             autocorr =       1.242077477234
   target nu stat err =       0.000409410440
   target dn stat err =       0.003461542922
      target stat err =       0.005807154924
              std dev =       0.519516765942
             le_variance =       0.269897670095


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940177872797        initial  <--
     3.6380e+01     3.6380e+02             4.1171e-06        -0.940176979402
     1.4552e+02     1.4552e+03             1.0308e-06        -0.940177498790
     5.8208e+02     5.8208e+03             2.5780e-07        -0.940177834100

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.2365
  </log>
  <optVariables href="H2O.s053.opt.xml">
ci_001                -4.189666e-02 3 1  ON 0
ci_002                -3.205177e-02 3 1  ON 1
ci_003                -2.638466e-02 3 1  ON 2
ci_004                 2.370245e-02 3 1  ON 3
ci_005                 2.406759e-02 3 1  ON 4
ci_006                -2.137325e-02 3 1  ON 5
ci_007                -2.098333e-02 3 1  ON 6
ci_008                -8.488622e-03 3 1  ON 7
ci_009                -1.386373e-02 3 1  ON 8
ci_010                -1.004275e-02 3 1  ON 9
ci_011                -1.124992e-02 3 1  ON 10
ci_012                -9.780603e-03 3 1  ON 11
ci_013                -1.986191e-02 3 1  ON 12
ci_014                 1.228547e-02 3 1  ON 13
ci_015                 1.198072e-02 3 1  ON 14
ci_016                 1.744515e-02 3 1  ON 15
ci_017                 1.636401e-02 3 1  ON 16
ci_018                 1.024185e-02 3 1  ON 17
ci_019                 1.012396e-02 3 1  ON 18
ci_020                 1.779062e-02 3 1  ON 19
ci_021                 1.747315e-02 3 1  ON 20
ci_022                 9.162918e-03 3 1  ON 21
ci_023                 9.196368e-03 3 1  ON 22
ci_024                 9.619923e-03 3 1  ON 23
ci_025                 1.014430e-02 3 1  ON 24
ci_026                 1.159207e-02 3 1  ON 25
ci_027                 1.165803e-02 3 1  ON 26
ci_028                -1.476987e-02 3 1  ON 27
ci_029                -1.645465e-02 3 1  ON 28
ci_030                -9.543927e-03 3 1  ON 29
ci_031                -9.001908e-03 3 1  ON 30
ci_032                -1.473182e-02 3 1  ON 31
ci_033                 5.288716e-03 3 1  ON 32
ci_034                 5.586317e-03 3 1  ON 33
ci_035                -5.091993e-03 3 1  ON 34
ci_036                -1.273762e-02 3 1  ON 35
ci_037                -1.241141e-02 3 1  ON 36
ci_038                 2.040403e-03 3 1  ON 37
ci_039                 1.745689e-03 3 1  ON 38
ci_040                -3.184711e-03 3 1  ON 39
ci_041                 9.421692e-03 3 1  ON 40
ci_042                 8.205598e-03 3 1  ON 41
ci_043                -4.068034e-03 3 1  ON 42
ci_044                -3.902530e-03 3 1  ON 43
ci_045                -3.570231e-03 3 1  ON 44
ci_046                 5.631672e-03 3 1  ON 45
ci_047                 5.549668e-03 3 1  ON 46
ci_048                -1.268163e-02 3 1  ON 47
ci_049                -1.440305e-02 3 1  ON 48
ci_050                 3.145983e-03 3 1  ON 49
ci_051                 2.817093e-03 3 1  ON 50
ci_052                -2.335996e-03 3 1  ON 51
ci_053                -2.441299e-03 3 1  ON 52
ci_054                -3.363655e-03 3 1  ON 53
ci_055                -2.954496e-03 3 1  ON 54
ci_056                 5.569990e-03 3 1  ON 55
ci_057                 5.316982e-03 3 1  ON 56
ci_058                -1.111467e-03 3 1  ON 57
ci_059                -2.164344e-03 3 1  ON 58
ci_060                 4.642238e-03 3 1  ON 59
ci_061                 5.615621e-03 3 1  ON 60
ci_062                -3.751072e-03 3 1  ON 61
ci_063                -4.015215e-03 3 1  ON 62
ci_064                -2.644271e-03 3 1  ON 63
ci_065                -4.357935e-03 3 1  ON 64
ci_066                 4.478379e-03 3 1  ON 65
ci_067                 4.338366e-03 3 1  ON 66
ci_068                -4.208095e-03 3 1  ON 67
ci_069                -5.000875e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0028e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.2468
    reference variance = 0.196878
====================================================
  Execution time = 1.6320e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5306e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8047e-01
  Total weights = 1.957391145e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4918e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267614765132
                                         uncertainty =       0.001397894536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267614765132
                                         uncertainty =       0.001397894536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365821497
  error estimate for blocks of size 2^( 2) =       0.000379608895
  error estimate for blocks of size 2^( 3) =       0.000392358194
  error estimate for blocks of size 2^( 4) =       0.000401452967
  error estimate for blocks of size 2^( 5) =       0.000407106801
  error estimate for blocks of size 2^( 6) =       0.000409796456
  error estimate for blocks of size 2^( 7) =       0.000410459313

      target function =      -0.944095853844
              le_mean =     -17.212433327163
             les_mean =     296.548329679804
             stat err =       0.000407203884
             autocorr =       1.239040145343
   target nu stat err =       0.000407203884
   target dn stat err =       0.002757909183
      target stat err =       0.004685681226
              std dev =       0.517349722807
             le_variance =       0.267650735689


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721243332716e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944118072209       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944118260926       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944118289542       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944118295919       residual = 9.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944118297763       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944118297692       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944118297539       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944118297618       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944118297563       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944118297557       residual = 8.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+02 is 4.808381e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944118072209       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944118119396       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944118126551       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944118128146       residual = 9.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944118128607       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944118128589       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944118128550       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944118128570       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944118128557       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944118128555       residual = 8.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+03 is 1.202282e-07

solving harmonic davidson linear method for identity shift 5.8208e+03, overlap shift 5.8208e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944118072209       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944118084007       residual = 2.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944118085795       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944118086195       residual = 9.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944118086309       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944118086315       residual = 4.25e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944118086288       residual = 8.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944118086300       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944118086297       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944118086302       residual = 8.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.8208e+03 is 3.005822e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.206408 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8821e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_001                -4.189666e-02 3 1  ON 0
ci_002                -3.205179e-02 3 1  ON 1
ci_003                -2.638463e-02 3 1  ON 2
ci_004                 2.370247e-02 3 1  ON 3
ci_005                 2.406754e-02 3 1  ON 4
ci_006                -2.137318e-02 3 1  ON 5
ci_007                -2.098326e-02 3 1  ON 6
ci_008                -8.488641e-03 3 1  ON 7
ci_009                -1.386385e-02 3 1  ON 8
ci_010                -1.004267e-02 3 1  ON 9
ci_011                -1.124988e-02 3 1  ON 10
ci_012                -9.780637e-03 3 1  ON 11
ci_013                -1.986189e-02 3 1  ON 12
ci_014                 1.228542e-02 3 1  ON 13
ci_015                 1.198075e-02 3 1  ON 14
ci_016                 1.744514e-02 3 1  ON 15
ci_017                 1.636408e-02 3 1  ON 16
ci_018                 1.024190e-02 3 1  ON 17
ci_019                 1.012392e-02 3 1  ON 18
ci_020                 1.779057e-02 3 1  ON 19
ci_021                 1.747316e-02 3 1  ON 20
ci_022                 9.162899e-03 3 1  ON 21
ci_023                 9.196366e-03 3 1  ON 22
ci_024                 9.619950e-03 3 1  ON 23
ci_025                 1.014428e-02 3 1  ON 24
ci_026                 1.159199e-02 3 1  ON 25
ci_027                 1.165796e-02 3 1  ON 26
ci_028                -1.476989e-02 3 1  ON 27
ci_029                -1.645459e-02 3 1  ON 28
ci_030                -9.543951e-03 3 1  ON 29
ci_031                -9.001962e-03 3 1  ON 30
ci_032                -1.473186e-02 3 1  ON 31
ci_033                 5.288736e-03 3 1  ON 32
ci_034                 5.586356e-03 3 1  ON 33
ci_035                -5.091960e-03 3 1  ON 34
ci_036                -1.273763e-02 3 1  ON 35
ci_037                -1.241137e-02 3 1  ON 36
ci_038                 2.040394e-03 3 1  ON 37
ci_039                 1.745670e-03 3 1  ON 38
ci_040                -3.184699e-03 3 1  ON 39
ci_041                 9.421632e-03 3 1  ON 40
ci_042                 8.205630e-03 3 1  ON 41
ci_043                -4.068019e-03 3 1  ON 42
ci_044                -3.902463e-03 3 1  ON 43
ci_045                -3.570157e-03 3 1  ON 44
ci_046                 5.631695e-03 3 1  ON 45
ci_047                 5.549650e-03 3 1  ON 46
ci_048                -1.268164e-02 3 1  ON 47
ci_049                -1.440296e-02 3 1  ON 48
ci_050                 3.145959e-03 3 1  ON 49
ci_051                 2.817125e-03 3 1  ON 50
ci_052                -2.336014e-03 3 1  ON 51
ci_053                -2.441314e-03 3 1  ON 52
ci_054                -3.363630e-03 3 1  ON 53
ci_055                -2.954470e-03 3 1  ON 54
ci_056                 5.569984e-03 3 1  ON 55
ci_057                 5.317005e-03 3 1  ON 56
ci_058                -1.111462e-03 3 1  ON 57
ci_059                -2.164289e-03 3 1  ON 58
ci_060                 4.642309e-03 3 1  ON 59
ci_061                 5.615677e-03 3 1  ON 60
ci_062                -3.751061e-03 3 1  ON 61
ci_063                -4.015202e-03 3 1  ON 62
ci_064                -2.644294e-03 3 1  ON 63
ci_065                -4.357935e-03 3 1  ON 64
ci_066                 4.478388e-03 3 1  ON 65
ci_067                 4.338345e-03 3 1  ON 66
ci_068                -4.208057e-03 3 1  ON 67
ci_069                -5.000919e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.2424
    reference variance = 0.186628
====================================================
  Execution time = 1.3919e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7809e-01
  Total weights = 1.9574e+06
  Execution time = 1.8198e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267590909119
                                         uncertainty =       0.001574414096

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267590909119
                                         uncertainty =       0.001574414096

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365778764
  error estimate for blocks of size 2^( 2) =       0.000379663733
  error estimate for blocks of size 2^( 3) =       0.000392431934
  error estimate for blocks of size 2^( 4) =       0.000401697024
  error estimate for blocks of size 2^( 5) =       0.000407347282
  error estimate for blocks of size 2^( 6) =       0.000411719525
  error estimate for blocks of size 2^( 7) =       0.000411562872

      target function =      -0.948111972812
              le_mean =     -17.211652553525
             les_mean =     296.519070569972
             stat err =       0.000408081676
             autocorr =       1.244678567806
   target nu stat err =       0.000408081676
   target dn stat err =       0.001903383344
      target stat err =       0.003298714457
              std dev =       0.517289288990
             le_variance =       0.267588208504

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267590819814
                                         uncertainty =       0.001574417352

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267590819814
                                         uncertainty =       0.001574417352

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365778703
  error estimate for blocks of size 2^( 2) =       0.000379663675
  error estimate for blocks of size 2^( 3) =       0.000392431882
  error estimate for blocks of size 2^( 4) =       0.000401696973
  error estimate for blocks of size 2^( 5) =       0.000407347235
  error estimate for blocks of size 2^( 6) =       0.000411719492
  error estimate for blocks of size 2^( 7) =       0.000411562833

      target function =      -0.948113244769
              le_mean =     -17.211652562835
             les_mean =     296.519070138699
             stat err =       0.000408081633
             autocorr =       1.244678727779
   target nu stat err =       0.000408081633
   target dn stat err =       0.001903291910
      target stat err =       0.003298572375
              std dev =       0.517289201919
             le_variance =       0.267588118422

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267590864450
                                         uncertainty =       0.001574415724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267590864450
                                         uncertainty =       0.001574415724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365778733
  error estimate for blocks of size 2^( 2) =       0.000379663704
  error estimate for blocks of size 2^( 3) =       0.000392431908
  error estimate for blocks of size 2^( 4) =       0.000401696998
  error estimate for blocks of size 2^( 5) =       0.000407347258
  error estimate for blocks of size 2^( 6) =       0.000411719509
  error estimate for blocks of size 2^( 7) =       0.000411562853

      target function =      -0.948112610823
              le_mean =     -17.211652558180
             les_mean =     296.519070353123
             stat err =       0.000408081654
             autocorr =       1.244678647814
   target nu stat err =       0.000408081654
   target dn stat err =       0.001903337506
      target stat err =       0.003298643230
              std dev =       0.517289245438
             le_variance =       0.267588163446

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267590903534
                                         uncertainty =       0.001574414299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267590903534
                                         uncertainty =       0.001574414299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365778760
  error estimate for blocks of size 2^( 2) =       0.000379663730
  error estimate for blocks of size 2^( 3) =       0.000392431931
  error estimate for blocks of size 2^( 4) =       0.000401697020
  error estimate for blocks of size 2^( 5) =       0.000407347279
  error estimate for blocks of size 2^( 6) =       0.000411719523
  error estimate for blocks of size 2^( 7) =       0.000411562870

      target function =      -0.948112052777
              le_mean =     -17.211652554107
             les_mean =     296.519070542737
             stat err =       0.000408081673
             autocorr =       1.244678577805
   target nu stat err =       0.000408081673
   target dn stat err =       0.001903377602
      target stat err =       0.003298705534
              std dev =       0.517289283545
             le_variance =       0.267588202871


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948111972812        initial
     3.6380e+02     3.6380e+03             4.8084e-07        -0.948113244769  <--
     1.4552e+03     1.4552e+04             1.2023e-07        -0.948112610823
     5.8208e+03     5.8208e+04             3.0058e-08        -0.948112052777

*****************************************************************************
Applying the update for shift_i =   3.6380e+02     and shift_s =   3.6380e+03
*****************************************************************************

  Execution time = 2.3110e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
ci_001                -4.189665e-02 3 1  ON 0
ci_002                -3.205183e-02 3 1  ON 1
ci_003                -2.638456e-02 3 1  ON 2
ci_004                 2.370254e-02 3 1  ON 3
ci_005                 2.406736e-02 3 1  ON 4
ci_006                -2.137300e-02 3 1  ON 5
ci_007                -2.098308e-02 3 1  ON 6
ci_008                -8.488698e-03 3 1  ON 7
ci_009                -1.386421e-02 3 1  ON 8
ci_010                -1.004245e-02 3 1  ON 9
ci_011                -1.124976e-02 3 1  ON 10
ci_012                -9.780738e-03 3 1  ON 11
ci_013                -1.986184e-02 3 1  ON 12
ci_014                 1.228527e-02 3 1  ON 13
ci_015                 1.198084e-02 3 1  ON 14
ci_016                 1.744510e-02 3 1  ON 15
ci_017                 1.636430e-02 3 1  ON 16
ci_018                 1.024206e-02 3 1  ON 17
ci_019                 1.012381e-02 3 1  ON 18
ci_020                 1.779043e-02 3 1  ON 19
ci_021                 1.747321e-02 3 1  ON 20
ci_022                 9.162840e-03 3 1  ON 21
ci_023                 9.196361e-03 3 1  ON 22
ci_024                 9.620032e-03 3 1  ON 23
ci_025                 1.014422e-02 3 1  ON 24
ci_026                 1.159176e-02 3 1  ON 25
ci_027                 1.165775e-02 3 1  ON 26
ci_028                -1.476995e-02 3 1  ON 27
ci_029                -1.645443e-02 3 1  ON 28
ci_030                -9.544021e-03 3 1  ON 29
ci_031                -9.002123e-03 3 1  ON 30
ci_032                -1.473199e-02 3 1  ON 31
ci_033                 5.288797e-03 3 1  ON 32
ci_034                 5.586472e-03 3 1  ON 33
ci_035                -5.091860e-03 3 1  ON 34
ci_036                -1.273767e-02 3 1  ON 35
ci_037                -1.241127e-02 3 1  ON 36
ci_038                 2.040368e-03 3 1  ON 37
ci_039                 1.745611e-03 3 1  ON 38
ci_040                -3.184664e-03 3 1  ON 39
ci_041                 9.421449e-03 3 1  ON 40
ci_042                 8.205729e-03 3 1  ON 41
ci_043                -4.067973e-03 3 1  ON 42
ci_044                -3.902260e-03 3 1  ON 43
ci_045                -3.569934e-03 3 1  ON 44
ci_046                 5.631764e-03 3 1  ON 45
ci_047                 5.549598e-03 3 1  ON 46
ci_048                -1.268168e-02 3 1  ON 47
ci_049                -1.440271e-02 3 1  ON 48
ci_050                 3.145887e-03 3 1  ON 49
ci_051                 2.817222e-03 3 1  ON 50
ci_052                -2.336069e-03 3 1  ON 51
ci_053                -2.441360e-03 3 1  ON 52
ci_054                -3.363553e-03 3 1  ON 53
ci_055                -2.954392e-03 3 1  ON 54
ci_056                 5.569966e-03 3 1  ON 55
ci_057                 5.317073e-03 3 1  ON 56
ci_058                -1.111446e-03 3 1  ON 57
ci_059                -2.164123e-03 3 1  ON 58
ci_060                 4.642521e-03 3 1  ON 59
ci_061                 5.615845e-03 3 1  ON 60
ci_062                -3.751025e-03 3 1  ON 61
ci_063                -4.015160e-03 3 1  ON 62
ci_064                -2.644365e-03 3 1  ON 63
ci_065                -4.357936e-03 3 1  ON 64
ci_066                 4.478417e-03 3 1  ON 65
ci_067                 4.338281e-03 3 1  ON 66
ci_068                -4.207945e-03 3 1  ON 67
ci_069                -5.001050e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1937e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.1965
    reference variance = 0.163638
====================================================
  Execution time = 1.4210e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5313e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7921e-01
  Total weights = 1.957256848e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4818e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268480899482
                                         uncertainty =       0.001403858385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268480899482
                                         uncertainty =       0.001403858385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366439276
  error estimate for blocks of size 2^( 2) =       0.000380607008
  error estimate for blocks of size 2^( 3) =       0.000393049509
  error estimate for blocks of size 2^( 4) =       0.000402094520
  error estimate for blocks of size 2^( 5) =       0.000408384684
  error estimate for blocks of size 2^( 6) =       0.000411734687
  error estimate for blocks of size 2^( 7) =       0.000414569680

      target function =      -0.946208759515
              le_mean =     -17.211601457060
             les_mean =     296.518439290298
             stat err =       0.000409195893
             autocorr =       1.246977163410
   target nu stat err =       0.000409195893
   target dn stat err =       0.001951018245
      target stat err =       0.003364175381
              std dev =       0.518223393445
             le_variance =       0.268555485514


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721160145706e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+01, overlap shift 9.0949e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946219477708       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946219999007       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946220112759       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946220137788       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946220137749       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946220140167       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946220138795       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946220138560       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946220138465       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946220138390       residual = 5.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+01 is 1.819619e-06

solving harmonic davidson linear method for identity shift 3.6380e+02, overlap shift 3.6380e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946219477708       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946219608119       residual = 2.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946219636572       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946219642831       residual = 6.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946219642821       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946219643426       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946219643083       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946219643024       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946219643000       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946219642981       residual = 5.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+02 is 4.551394e-07

solving harmonic davidson linear method for identity shift 1.4552e+03, overlap shift 1.4552e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946219477708       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946219510316       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946219517430       residual = 4.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946219518994       residual = 6.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946219518992       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946219519145       residual = 3.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946219519057       residual = 5.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946219519043       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946219519038       residual = 2.15e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946219519032       residual = 5.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+03 is 1.137995e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.209887 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6700e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_001                -4.189661e-02 3 1  ON 0
ci_002                -3.205169e-02 3 1  ON 1
ci_003                -2.638411e-02 3 1  ON 2
ci_004                 2.370260e-02 3 1  ON 3
ci_005                 2.406728e-02 3 1  ON 4
ci_006                -2.137275e-02 3 1  ON 5
ci_007                -2.098263e-02 3 1  ON 6
ci_008                -8.488873e-03 3 1  ON 7
ci_009                -1.386442e-02 3 1  ON 8
ci_010                -1.004225e-02 3 1  ON 9
ci_011                -1.124934e-02 3 1  ON 10
ci_012                -9.780804e-03 3 1  ON 11
ci_013                -1.986184e-02 3 1  ON 12
ci_014                 1.228525e-02 3 1  ON 13
ci_015                 1.198110e-02 3 1  ON 14
ci_016                 1.744487e-02 3 1  ON 15
ci_017                 1.636450e-02 3 1  ON 16
ci_018                 1.024200e-02 3 1  ON 17
ci_019                 1.012382e-02 3 1  ON 18
ci_020                 1.779035e-02 3 1  ON 19
ci_021                 1.747303e-02 3 1  ON 20
ci_022                 9.162772e-03 3 1  ON 21
ci_023                 9.196262e-03 3 1  ON 22
ci_024                 9.620098e-03 3 1  ON 23
ci_025                 1.014419e-02 3 1  ON 24
ci_026                 1.159156e-02 3 1  ON 25
ci_027                 1.165757e-02 3 1  ON 26
ci_028                -1.477010e-02 3 1  ON 27
ci_029                -1.645426e-02 3 1  ON 28
ci_030                -9.543904e-03 3 1  ON 29
ci_031                -9.002214e-03 3 1  ON 30
ci_032                -1.473190e-02 3 1  ON 31
ci_033                 5.288885e-03 3 1  ON 32
ci_034                 5.586633e-03 3 1  ON 33
ci_035                -5.091778e-03 3 1  ON 34
ci_036                -1.273772e-02 3 1  ON 35
ci_037                -1.241131e-02 3 1  ON 36
ci_038                 2.040303e-03 3 1  ON 37
ci_039                 1.745602e-03 3 1  ON 38
ci_040                -3.184684e-03 3 1  ON 39
ci_041                 9.421279e-03 3 1  ON 40
ci_042                 8.205678e-03 3 1  ON 41
ci_043                -4.067837e-03 3 1  ON 42
ci_044                -3.902249e-03 3 1  ON 43
ci_045                -3.569847e-03 3 1  ON 44
ci_046                 5.631773e-03 3 1  ON 45
ci_047                 5.549611e-03 3 1  ON 46
ci_048                -1.268173e-02 3 1  ON 47
ci_049                -1.440283e-02 3 1  ON 48
ci_050                 3.146009e-03 3 1  ON 49
ci_051                 2.817163e-03 3 1  ON 50
ci_052                -2.336245e-03 3 1  ON 51
ci_053                -2.441446e-03 3 1  ON 52
ci_054                -3.363435e-03 3 1  ON 53
ci_055                -2.954308e-03 3 1  ON 54
ci_056                 5.569949e-03 3 1  ON 55
ci_057                 5.316823e-03 3 1  ON 56
ci_058                -1.111490e-03 3 1  ON 57
ci_059                -2.163929e-03 3 1  ON 58
ci_060                 4.642588e-03 3 1  ON 59
ci_061                 5.615661e-03 3 1  ON 60
ci_062                -3.751030e-03 3 1  ON 61
ci_063                -4.015172e-03 3 1  ON 62
ci_064                -2.644617e-03 3 1  ON 63
ci_065                -4.357956e-03 3 1  ON 64
ci_066                 4.478500e-03 3 1  ON 65
ci_067                 4.338448e-03 3 1  ON 66
ci_068                -4.208041e-03 3 1  ON 67
ci_069                -5.001170e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.2409
    reference variance = 0.187033
====================================================
  Execution time = 1.3701e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7923e-01
  Total weights = 1.9575e+06
  Execution time = 1.8120e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268106134473
                                         uncertainty =       0.001386451188

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268106134473
                                         uncertainty =       0.001386451188

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366110375
  error estimate for blocks of size 2^( 2) =       0.000380031092
  error estimate for blocks of size 2^( 3) =       0.000392618570
  error estimate for blocks of size 2^( 4) =       0.000402318125
  error estimate for blocks of size 2^( 5) =       0.000407657483
  error estimate for blocks of size 2^( 6) =       0.000411604699
  error estimate for blocks of size 2^( 7) =       0.000414252986

      target function =      -0.946187513543
              le_mean =     -17.211545141110
             les_mean =     296.516512244370
             stat err =       0.000408958323
             autocorr =       1.247768540717
   target nu stat err =       0.000408958323
   target dn stat err =       0.002028297248
      target stat err =       0.003490695242
              std dev =       0.517758257139
             le_variance =       0.268073612836

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268105671563
                                         uncertainty =       0.001386450085

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268105671563
                                         uncertainty =       0.001386450085

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366110057
  error estimate for blocks of size 2^( 2) =       0.000380030790
  error estimate for blocks of size 2^( 3) =       0.000392618300
  error estimate for blocks of size 2^( 4) =       0.000402317923
  error estimate for blocks of size 2^( 5) =       0.000407657307
  error estimate for blocks of size 2^( 6) =       0.000411604502
  error estimate for blocks of size 2^( 7) =       0.000414252800

      target function =      -0.946181754429
              le_mean =     -17.211545146363
             les_mean =     296.516515842945
             stat err =       0.000408958133
             autocorr =       1.247769543221
   target nu stat err =       0.000408958133
   target dn stat err =       0.002028834120
      target stat err =       0.003491537475
              std dev =       0.517757807965
             le_variance =       0.268073147709

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268105902760
                                         uncertainty =       0.001386450635

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268105902760
                                         uncertainty =       0.001386450635

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366110216
  error estimate for blocks of size 2^( 2) =       0.000380030941
  error estimate for blocks of size 2^( 3) =       0.000392618435
  error estimate for blocks of size 2^( 4) =       0.000402318024
  error estimate for blocks of size 2^( 5) =       0.000407657395
  error estimate for blocks of size 2^( 6) =       0.000411604601
  error estimate for blocks of size 2^( 7) =       0.000414252893

      target function =      -0.946184666421
              le_mean =     -17.211545143719
             les_mean =     296.516514023795
             stat err =       0.000408958228
             autocorr =       1.247769042344
   target nu stat err =       0.000408958228
   target dn stat err =       0.002028565244
      target stat err =       0.003491115871
              std dev =       0.517758032302
             le_variance =       0.268073380014

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268106105492
                                         uncertainty =       0.001386451119

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268106105492
                                         uncertainty =       0.001386451119

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366110355
  error estimate for blocks of size 2^( 2) =       0.000380031073
  error estimate for blocks of size 2^( 3) =       0.000392618553
  error estimate for blocks of size 2^( 4) =       0.000402318112
  error estimate for blocks of size 2^( 5) =       0.000407657472
  error estimate for blocks of size 2^( 6) =       0.000411604687
  error estimate for blocks of size 2^( 7) =       0.000414252975

      target function =      -0.946187161231
              le_mean =     -17.211545141434
             les_mean =     296.516512464606
             stat err =       0.000408958312
             autocorr =       1.247768603444
   target nu stat err =       0.000408958312
   target dn stat err =       0.002028330688
      target stat err =       0.003490747748
              std dev =       0.517758229018
             le_variance =       0.268073583716


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946187513543        initial  <--
     9.0949e+01     9.0949e+02             1.8196e-06        -0.946181754429
     3.6380e+02     3.6380e+03             4.5514e-07        -0.946184666421
     1.4552e+03     1.4552e+04             1.1380e-07        -0.946187161231

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8727
  </log>
  <optVariables href="H2O.s055.opt.xml">
ci_001                -4.189665e-02 3 1  ON 0
ci_002                -3.205183e-02 3 1  ON 1
ci_003                -2.638456e-02 3 1  ON 2
ci_004                 2.370254e-02 3 1  ON 3
ci_005                 2.406736e-02 3 1  ON 4
ci_006                -2.137300e-02 3 1  ON 5
ci_007                -2.098308e-02 3 1  ON 6
ci_008                -8.488698e-03 3 1  ON 7
ci_009                -1.386421e-02 3 1  ON 8
ci_010                -1.004245e-02 3 1  ON 9
ci_011                -1.124976e-02 3 1  ON 10
ci_012                -9.780738e-03 3 1  ON 11
ci_013                -1.986184e-02 3 1  ON 12
ci_014                 1.228527e-02 3 1  ON 13
ci_015                 1.198084e-02 3 1  ON 14
ci_016                 1.744510e-02 3 1  ON 15
ci_017                 1.636430e-02 3 1  ON 16
ci_018                 1.024206e-02 3 1  ON 17
ci_019                 1.012381e-02 3 1  ON 18
ci_020                 1.779043e-02 3 1  ON 19
ci_021                 1.747321e-02 3 1  ON 20
ci_022                 9.162840e-03 3 1  ON 21
ci_023                 9.196361e-03 3 1  ON 22
ci_024                 9.620032e-03 3 1  ON 23
ci_025                 1.014422e-02 3 1  ON 24
ci_026                 1.159176e-02 3 1  ON 25
ci_027                 1.165775e-02 3 1  ON 26
ci_028                -1.476995e-02 3 1  ON 27
ci_029                -1.645443e-02 3 1  ON 28
ci_030                -9.544021e-03 3 1  ON 29
ci_031                -9.002123e-03 3 1  ON 30
ci_032                -1.473199e-02 3 1  ON 31
ci_033                 5.288797e-03 3 1  ON 32
ci_034                 5.586472e-03 3 1  ON 33
ci_035                -5.091860e-03 3 1  ON 34
ci_036                -1.273767e-02 3 1  ON 35
ci_037                -1.241127e-02 3 1  ON 36
ci_038                 2.040368e-03 3 1  ON 37
ci_039                 1.745611e-03 3 1  ON 38
ci_040                -3.184664e-03 3 1  ON 39
ci_041                 9.421449e-03 3 1  ON 40
ci_042                 8.205729e-03 3 1  ON 41
ci_043                -4.067973e-03 3 1  ON 42
ci_044                -3.902260e-03 3 1  ON 43
ci_045                -3.569934e-03 3 1  ON 44
ci_046                 5.631764e-03 3 1  ON 45
ci_047                 5.549598e-03 3 1  ON 46
ci_048                -1.268168e-02 3 1  ON 47
ci_049                -1.440271e-02 3 1  ON 48
ci_050                 3.145887e-03 3 1  ON 49
ci_051                 2.817222e-03 3 1  ON 50
ci_052                -2.336069e-03 3 1  ON 51
ci_053                -2.441360e-03 3 1  ON 52
ci_054                -3.363553e-03 3 1  ON 53
ci_055                -2.954392e-03 3 1  ON 54
ci_056                 5.569966e-03 3 1  ON 55
ci_057                 5.317073e-03 3 1  ON 56
ci_058                -1.111446e-03 3 1  ON 57
ci_059                -2.164123e-03 3 1  ON 58
ci_060                 4.642521e-03 3 1  ON 59
ci_061                 5.615845e-03 3 1  ON 60
ci_062                -3.751025e-03 3 1  ON 61
ci_063                -4.015160e-03 3 1  ON 62
ci_064                -2.644365e-03 3 1  ON 63
ci_065                -4.357936e-03 3 1  ON 64
ci_066                 4.478417e-03 3 1  ON 65
ci_067                 4.338281e-03 3 1  ON 66
ci_068                -4.207945e-03 3 1  ON 67
ci_069                -5.001050e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9579e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.1983
    reference variance = 0.181436
====================================================
  Execution time = 1.4311e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5277e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8162e-01
  Total weights = 1.957225484e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4827e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269992555455
                                         uncertainty =       0.001553597879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269992555455
                                         uncertainty =       0.001553597879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367418735
  error estimate for blocks of size 2^( 2) =       0.000381074535
  error estimate for blocks of size 2^( 3) =       0.000393470344
  error estimate for blocks of size 2^( 4) =       0.000402711513
  error estimate for blocks of size 2^( 5) =       0.000408705159
  error estimate for blocks of size 2^( 6) =       0.000411541522
  error estimate for blocks of size 2^( 7) =       0.000412475597

      target function =      -0.942167901560
              le_mean =     -17.212244231058
             les_mean =     296.542974669956
             stat err =       0.000408858448
             autocorr =       1.238292821033
   target nu stat err =       0.000408858448
   target dn stat err =       0.002327158299
      target stat err =       0.003956041312
              std dev =       0.519608558804
             le_variance =       0.269993054382


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721224423106e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942183693081       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942183754750       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942183763494       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942183766279       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942183766674       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942183766837       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942183766833       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942183766802       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942183766805       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942183766800       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+02 is 1.894189e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942183693081       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942183708499       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942183710685       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942183711380       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942183711482       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942183711515       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942183711521       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942183711514       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942183711515       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942183711515       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+03 is 4.735789e-08

solving harmonic davidson linear method for identity shift 1.4552e+04, overlap shift 1.4552e+05 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942183693081       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942183696936       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942183697482       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942183697656       residual = 4.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942183697682       residual = 1.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942183697676       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942183697701       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942183697682       residual = 1.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942183697712       residual = 1.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942183697664       residual = 3.94e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4552e+04 is 1.183967e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.213281 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6802e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_001                -4.189665e-02 3 1  ON 0
ci_002                -3.205180e-02 3 1  ON 1
ci_003                -2.638453e-02 3 1  ON 2
ci_004                 2.370255e-02 3 1  ON 3
ci_005                 2.406735e-02 3 1  ON 4
ci_006                -2.137298e-02 3 1  ON 5
ci_007                -2.098308e-02 3 1  ON 6
ci_008                -8.488705e-03 3 1  ON 7
ci_009                -1.386422e-02 3 1  ON 8
ci_010                -1.004245e-02 3 1  ON 9
ci_011                -1.124974e-02 3 1  ON 10
ci_012                -9.780717e-03 3 1  ON 11
ci_013                -1.986183e-02 3 1  ON 12
ci_014                 1.228528e-02 3 1  ON 13
ci_015                 1.198086e-02 3 1  ON 14
ci_016                 1.744508e-02 3 1  ON 15
ci_017                 1.636428e-02 3 1  ON 16
ci_018                 1.024205e-02 3 1  ON 17
ci_019                 1.012383e-02 3 1  ON 18
ci_020                 1.779042e-02 3 1  ON 19
ci_021                 1.747321e-02 3 1  ON 20
ci_022                 9.162835e-03 3 1  ON 21
ci_023                 9.196359e-03 3 1  ON 22
ci_024                 9.620048e-03 3 1  ON 23
ci_025                 1.014422e-02 3 1  ON 24
ci_026                 1.159175e-02 3 1  ON 25
ci_027                 1.165773e-02 3 1  ON 26
ci_028                -1.476996e-02 3 1  ON 27
ci_029                -1.645440e-02 3 1  ON 28
ci_030                -9.544016e-03 3 1  ON 29
ci_031                -9.002117e-03 3 1  ON 30
ci_032                -1.473201e-02 3 1  ON 31
ci_033                 5.288827e-03 3 1  ON 32
ci_034                 5.586482e-03 3 1  ON 33
ci_035                -5.091864e-03 3 1  ON 34
ci_036                -1.273767e-02 3 1  ON 35
ci_037                -1.241128e-02 3 1  ON 36
ci_038                 2.040362e-03 3 1  ON 37
ci_039                 1.745607e-03 3 1  ON 38
ci_040                -3.184666e-03 3 1  ON 39
ci_041                 9.421401e-03 3 1  ON 40
ci_042                 8.205717e-03 3 1  ON 41
ci_043                -4.067968e-03 3 1  ON 42
ci_044                -3.902245e-03 3 1  ON 43
ci_045                -3.569918e-03 3 1  ON 44
ci_046                 5.631769e-03 3 1  ON 45
ci_047                 5.549601e-03 3 1  ON 46
ci_048                -1.268167e-02 3 1  ON 47
ci_049                -1.440269e-02 3 1  ON 48
ci_050                 3.145892e-03 3 1  ON 49
ci_051                 2.817209e-03 3 1  ON 50
ci_052                -2.336060e-03 3 1  ON 51
ci_053                -2.441360e-03 3 1  ON 52
ci_054                -3.363534e-03 3 1  ON 53
ci_055                -2.954383e-03 3 1  ON 54
ci_056                 5.569962e-03 3 1  ON 55
ci_057                 5.317081e-03 3 1  ON 56
ci_058                -1.111472e-03 3 1  ON 57
ci_059                -2.164132e-03 3 1  ON 58
ci_060                 4.642528e-03 3 1  ON 59
ci_061                 5.615831e-03 3 1  ON 60
ci_062                -3.751016e-03 3 1  ON 61
ci_063                -4.015155e-03 3 1  ON 62
ci_064                -2.644380e-03 3 1  ON 63
ci_065                -4.357930e-03 3 1  ON 64
ci_066                 4.478416e-03 3 1  ON 65
ci_067                 4.338294e-03 3 1  ON 66
ci_068                -4.207981e-03 3 1  ON 67
ci_069                -5.001038e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.2124
    reference variance = 0.212103
====================================================
  Execution time = 1.3783e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7858e-01
  Total weights = 1.9572e+06
  Execution time = 1.8234e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267594745523
                                         uncertainty =       0.001749567656

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267594745523
                                         uncertainty =       0.001749567656

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365816189
  error estimate for blocks of size 2^( 2) =       0.000379506581
  error estimate for blocks of size 2^( 3) =       0.000392270806
  error estimate for blocks of size 2^( 4) =       0.000401622232
  error estimate for blocks of size 2^( 5) =       0.000407315755
  error estimate for blocks of size 2^( 6) =       0.000409592707
  error estimate for blocks of size 2^( 7) =       0.000412121892

      target function =      -0.947283381427
              le_mean =     -17.211931462274
             les_mean =     296.529161331515
             stat err =       0.000407663147
             autocorr =       1.241872647725
   target nu stat err =       0.000407663147
   target dn stat err =       0.002299287056
      target stat err =       0.003949387895
              std dev =       0.517342216368
             le_variance =       0.267642968837

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267594682723
                                         uncertainty =       0.001749564881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267594682723
                                         uncertainty =       0.001749564881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365816148
  error estimate for blocks of size 2^( 2) =       0.000379506542
  error estimate for blocks of size 2^( 3) =       0.000392270772
  error estimate for blocks of size 2^( 4) =       0.000401622199
  error estimate for blocks of size 2^( 5) =       0.000407315724
  error estimate for blocks of size 2^( 6) =       0.000409592669
  error estimate for blocks of size 2^( 7) =       0.000412121849

      target function =      -0.947283502477
              le_mean =     -17.211931461210
             les_mean =     296.529161223276
             stat err =       0.000407663111
             autocorr =       1.241872711210
   target nu stat err =       0.000407663111
   target dn stat err =       0.002299277160
      target stat err =       0.003949372445
              std dev =       0.517342157335
             le_variance =       0.267642907756

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267594714120
                                         uncertainty =       0.001749566268

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267594714120
                                         uncertainty =       0.001749566268

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365816169
  error estimate for blocks of size 2^( 2) =       0.000379506561
  error estimate for blocks of size 2^( 3) =       0.000392270789
  error estimate for blocks of size 2^( 4) =       0.000401622216
  error estimate for blocks of size 2^( 5) =       0.000407315740
  error estimate for blocks of size 2^( 6) =       0.000409592688
  error estimate for blocks of size 2^( 7) =       0.000412121871

      target function =      -0.947283442035
              le_mean =     -17.211931461742
             les_mean =     296.529161277341
             stat err =       0.000407663129
             autocorr =       1.241872679466
   target nu stat err =       0.000407663129
   target dn stat err =       0.002299282107
      target stat err =       0.003949380169
              std dev =       0.517342186849
             le_variance =       0.267642938294

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267594741597
                                         uncertainty =       0.001749567482

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267594741597
                                         uncertainty =       0.001749567482

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365816187
  error estimate for blocks of size 2^( 2) =       0.000379506578
  error estimate for blocks of size 2^( 3) =       0.000392270804
  error estimate for blocks of size 2^( 4) =       0.000401622230
  error estimate for blocks of size 2^( 5) =       0.000407315753
  error estimate for blocks of size 2^( 6) =       0.000409592705
  error estimate for blocks of size 2^( 7) =       0.000412121889

      target function =      -0.947283389011
              le_mean =     -17.211931462208
             les_mean =     296.529161324737
             stat err =       0.000407663144
             autocorr =       1.241872651691
   target nu stat err =       0.000407663144
   target dn stat err =       0.002299286437
      target stat err =       0.003949386930
              std dev =       0.517342212678
             le_variance =       0.267642965019


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947283381427        initial
     9.0949e+02     9.0949e+03             1.8942e-07        -0.947283502477  <--
     3.6380e+03     3.6380e+04             4.7358e-08        -0.947283442035
     1.4552e+04     1.4552e+05             1.1840e-08        -0.947283389011

*****************************************************************************
Applying the update for shift_i =   9.0949e+02     and shift_s =   9.0949e+03
*****************************************************************************

  Execution time = 2.2954e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
ci_001                -4.189663e-02 3 1  ON 0
ci_002                -3.205173e-02 3 1  ON 1
ci_003                -2.638445e-02 3 1  ON 2
ci_004                 2.370259e-02 3 1  ON 3
ci_005                 2.406734e-02 3 1  ON 4
ci_006                -2.137291e-02 3 1  ON 5
ci_007                -2.098306e-02 3 1  ON 6
ci_008                -8.488724e-03 3 1  ON 7
ci_009                -1.386426e-02 3 1  ON 8
ci_010                -1.004245e-02 3 1  ON 9
ci_011                -1.124968e-02 3 1  ON 10
ci_012                -9.780654e-03 3 1  ON 11
ci_013                -1.986183e-02 3 1  ON 12
ci_014                 1.228530e-02 3 1  ON 13
ci_015                 1.198094e-02 3 1  ON 14
ci_016                 1.744502e-02 3 1  ON 15
ci_017                 1.636422e-02 3 1  ON 16
ci_018                 1.024201e-02 3 1  ON 17
ci_019                 1.012388e-02 3 1  ON 18
ci_020                 1.779038e-02 3 1  ON 19
ci_021                 1.747322e-02 3 1  ON 20
ci_022                 9.162819e-03 3 1  ON 21
ci_023                 9.196355e-03 3 1  ON 22
ci_024                 9.620096e-03 3 1  ON 23
ci_025                 1.014422e-02 3 1  ON 24
ci_026                 1.159172e-02 3 1  ON 25
ci_027                 1.165768e-02 3 1  ON 26
ci_028                -1.477000e-02 3 1  ON 27
ci_029                -1.645432e-02 3 1  ON 28
ci_030                -9.544000e-03 3 1  ON 29
ci_031                -9.002101e-03 3 1  ON 30
ci_032                -1.473205e-02 3 1  ON 31
ci_033                 5.288919e-03 3 1  ON 32
ci_034                 5.586514e-03 3 1  ON 33
ci_035                -5.091878e-03 3 1  ON 34
ci_036                -1.273769e-02 3 1  ON 35
ci_037                -1.241133e-02 3 1  ON 36
ci_038                 2.040343e-03 3 1  ON 37
ci_039                 1.745598e-03 3 1  ON 38
ci_040                -3.184673e-03 3 1  ON 39
ci_041                 9.421259e-03 3 1  ON 40
ci_042                 8.205680e-03 3 1  ON 41
ci_043                -4.067952e-03 3 1  ON 42
ci_044                -3.902198e-03 3 1  ON 43
ci_045                -3.569868e-03 3 1  ON 44
ci_046                 5.631782e-03 3 1  ON 45
ci_047                 5.549611e-03 3 1  ON 46
ci_048                -1.268165e-02 3 1  ON 47
ci_049                -1.440261e-02 3 1  ON 48
ci_050                 3.145909e-03 3 1  ON 49
ci_051                 2.817170e-03 3 1  ON 50
ci_052                -2.336032e-03 3 1  ON 51
ci_053                -2.441360e-03 3 1  ON 52
ci_054                -3.363478e-03 3 1  ON 53
ci_055                -2.954357e-03 3 1  ON 54
ci_056                 5.569951e-03 3 1  ON 55
ci_057                 5.317105e-03 3 1  ON 56
ci_058                -1.111551e-03 3 1  ON 57
ci_059                -2.164161e-03 3 1  ON 58
ci_060                 4.642549e-03 3 1  ON 59
ci_061                 5.615790e-03 3 1  ON 60
ci_062                -3.750987e-03 3 1  ON 61
ci_063                -4.015140e-03 3 1  ON 62
ci_064                -2.644424e-03 3 1  ON 63
ci_065                -4.357915e-03 3 1  ON 64
ci_066                 4.478416e-03 3 1  ON 65
ci_067                 4.338334e-03 3 1  ON 66
ci_068                -4.208090e-03 3 1  ON 67
ci_069                -5.001001e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9763e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.2849
    reference variance = 0.431749
====================================================
  Execution time = 1.4340e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5289e+04
  VMC Eavg = -1.7210e+01
  VMC Evar = 2.7931e-01
  Total weights = 1.957001070e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4742e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266593045073
                                         uncertainty =       0.001236126874

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266593045073
                                         uncertainty =       0.001236126874

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365075274
  error estimate for blocks of size 2^( 2) =       0.000378619567
  error estimate for blocks of size 2^( 3) =       0.000390754719
  error estimate for blocks of size 2^( 4) =       0.000399912728
  error estimate for blocks of size 2^( 5) =       0.000404842166
  error estimate for blocks of size 2^( 6) =       0.000408486028
  error estimate for blocks of size 2^( 7) =       0.000410227862

      target function =      -0.946026942465
              le_mean =     -17.210464438111
             les_mean =     296.479395707794
             stat err =       0.000405867196
             autocorr =       1.235956145541
   target nu stat err =       0.000405867196
   target dn stat err =       0.002478880572
      target stat err =       0.004224501632
              std dev =       0.516294404339
             le_variance =       0.266559911952


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721046443811e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946044767979       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946045027028       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946045058722       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946045069585       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946045071900       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946045072629       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946045072613       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946045072633       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946045072670       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946045072650       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+02 is 7.228646e-07

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946044767979       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946044832759       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946044840684       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946044843400       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946044843979       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946044844161       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946044844156       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946044844162       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946044844170       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946044844166       residual = 3.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+02 is 1.807612e-07

solving harmonic davidson linear method for identity shift 3.6380e+03, overlap shift 3.6380e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946044767979       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946044784175       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946044786156       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946044786835       residual = 7.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946044786980       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946044787026       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946044787025       residual = 5.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946044787020       residual = 1.00e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946044787032       residual = 2.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946044787023       residual = 3.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.6380e+03 is 4.519313e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.216726 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6823e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_001                -4.189661e-02 3 1  ON 0
ci_002                -3.205170e-02 3 1  ON 1
ci_003                -2.638435e-02 3 1  ON 2
ci_004                 2.370257e-02 3 1  ON 3
ci_005                 2.406724e-02 3 1  ON 4
ci_006                -2.137289e-02 3 1  ON 5
ci_007                -2.098303e-02 3 1  ON 6
ci_008                -8.488705e-03 3 1  ON 7
ci_009                -1.386444e-02 3 1  ON 8
ci_010                -1.004245e-02 3 1  ON 9
ci_011                -1.124959e-02 3 1  ON 10
ci_012                -9.780690e-03 3 1  ON 11
ci_013                -1.986182e-02 3 1  ON 12
ci_014                 1.228542e-02 3 1  ON 13
ci_015                 1.198099e-02 3 1  ON 14
ci_016                 1.744496e-02 3 1  ON 15
ci_017                 1.636426e-02 3 1  ON 16
ci_018                 1.024207e-02 3 1  ON 17
ci_019                 1.012390e-02 3 1  ON 18
ci_020                 1.779027e-02 3 1  ON 19
ci_021                 1.747311e-02 3 1  ON 20
ci_022                 9.162795e-03 3 1  ON 21
ci_023                 9.196360e-03 3 1  ON 22
ci_024                 9.620096e-03 3 1  ON 23
ci_025                 1.014404e-02 3 1  ON 24
ci_026                 1.159168e-02 3 1  ON 25
ci_027                 1.165772e-02 3 1  ON 26
ci_028                -1.476996e-02 3 1  ON 27
ci_029                -1.645426e-02 3 1  ON 28
ci_030                -9.543955e-03 3 1  ON 29
ci_031                -9.002070e-03 3 1  ON 30
ci_032                -1.473210e-02 3 1  ON 31
ci_033                 5.288911e-03 3 1  ON 32
ci_034                 5.586503e-03 3 1  ON 33
ci_035                -5.091839e-03 3 1  ON 34
ci_036                -1.273768e-02 3 1  ON 35
ci_037                -1.241144e-02 3 1  ON 36
ci_038                 2.040289e-03 3 1  ON 37
ci_039                 1.745577e-03 3 1  ON 38
ci_040                -3.184662e-03 3 1  ON 39
ci_041                 9.421209e-03 3 1  ON 40
ci_042                 8.205741e-03 3 1  ON 41
ci_043                -4.067947e-03 3 1  ON 42
ci_044                -3.902101e-03 3 1  ON 43
ci_045                -3.569787e-03 3 1  ON 44
ci_046                 5.631718e-03 3 1  ON 45
ci_047                 5.549693e-03 3 1  ON 46
ci_048                -1.268172e-02 3 1  ON 47
ci_049                -1.440258e-02 3 1  ON 48
ci_050                 3.145897e-03 3 1  ON 49
ci_051                 2.817223e-03 3 1  ON 50
ci_052                -2.336024e-03 3 1  ON 51
ci_053                -2.441428e-03 3 1  ON 52
ci_054                -3.363401e-03 3 1  ON 53
ci_055                -2.954333e-03 3 1  ON 54
ci_056                 5.569940e-03 3 1  ON 55
ci_057                 5.317109e-03 3 1  ON 56
ci_058                -1.111659e-03 3 1  ON 57
ci_059                -2.164223e-03 3 1  ON 58
ci_060                 4.642462e-03 3 1  ON 59
ci_061                 5.615856e-03 3 1  ON 60
ci_062                -3.750996e-03 3 1  ON 61
ci_063                -4.015103e-03 3 1  ON 62
ci_064                -2.644456e-03 3 1  ON 63
ci_065                -4.357906e-03 3 1  ON 64
ci_066                 4.478363e-03 3 1  ON 65
ci_067                 4.338396e-03 3 1  ON 66
ci_068                -4.208180e-03 3 1  ON 67
ci_069                -5.000945e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.1502
    reference variance = 0.177271
====================================================
  Execution time = 1.6097e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7929e-01
  Total weights = 1.9570e+06
  Execution time = 1.8118e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267902462025
                                         uncertainty =       0.001352796356

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267902462025
                                         uncertainty =       0.001352796356

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365988537
  error estimate for blocks of size 2^( 2) =       0.000379676533
  error estimate for blocks of size 2^( 3) =       0.000392054086
  error estimate for blocks of size 2^( 4) =       0.000400222070
  error estimate for blocks of size 2^( 5) =       0.000405893027
  error estimate for blocks of size 2^( 6) =       0.000408226734
  error estimate for blocks of size 2^( 7) =       0.000411592431

      target function =      -0.946074995298
              le_mean =     -17.211825751256
             les_mean =     296.526239762424
             stat err =       0.000406483566
             autocorr =       1.233533691569
   target nu stat err =       0.000406483566
   target dn stat err =       0.002131722596
      target stat err =       0.003661348880
              std dev =       0.517585953067
             le_variance =       0.267895218812

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267902300147
                                         uncertainty =       0.001352798887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267902300147
                                         uncertainty =       0.001352798887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365988426
  error estimate for blocks of size 2^( 2) =       0.000379676410
  error estimate for blocks of size 2^( 3) =       0.000392053957
  error estimate for blocks of size 2^( 4) =       0.000400221942
  error estimate for blocks of size 2^( 5) =       0.000405892908
  error estimate for blocks of size 2^( 6) =       0.000408226593
  error estimate for blocks of size 2^( 7) =       0.000411592316

      target function =      -0.946076556088
              le_mean =     -17.211825755857
             les_mean =     296.526238993860
             stat err =       0.000406483440
             autocorr =       1.233533675303
   target nu stat err =       0.000406483440
   target dn stat err =       0.002131718390
      target stat err =       0.003661353771
              std dev =       0.517585796238
             le_variance =       0.267895056467

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267902381044
                                         uncertainty =       0.001352797621

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267902381044
                                         uncertainty =       0.001352797621

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365988482
  error estimate for blocks of size 2^( 2) =       0.000379676471
  error estimate for blocks of size 2^( 3) =       0.000392054021
  error estimate for blocks of size 2^( 4) =       0.000400222006
  error estimate for blocks of size 2^( 5) =       0.000405892968
  error estimate for blocks of size 2^( 6) =       0.000408226664
  error estimate for blocks of size 2^( 7) =       0.000411592373

      target function =      -0.946075781142
              le_mean =     -17.211825753553
             les_mean =     296.526239374789
             stat err =       0.000406483503
             autocorr =       1.233533683433
   target nu stat err =       0.000406483503
   target dn stat err =       0.002131720454
      target stat err =       0.003661351302
              std dev =       0.517585874613
             le_variance =       0.267895137598

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267902451899
                                         uncertainty =       0.001352796514

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267902451899
                                         uncertainty =       0.001352796514

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365988530
  error estimate for blocks of size 2^( 2) =       0.000379676525
  error estimate for blocks of size 2^( 3) =       0.000392054078
  error estimate for blocks of size 2^( 4) =       0.000400222062
  error estimate for blocks of size 2^( 5) =       0.000405893020
  error estimate for blocks of size 2^( 6) =       0.000408226725
  error estimate for blocks of size 2^( 7) =       0.000411592424

      target function =      -0.946075094114
              le_mean =     -17.211825751543
             les_mean =     296.526239713608
             stat err =       0.000406483558
             autocorr =       1.233533690546
   target nu stat err =       0.000406483558
   target dn stat err =       0.002131722324
      target stat err =       0.003661349181
              std dev =       0.517585943257
             le_variance =       0.267895208658


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946074995298        initial
     2.2737e+02     2.2737e+03             7.2286e-07        -0.946076556088  <--
     9.0949e+02     9.0949e+03             1.8076e-07        -0.946075781142
     3.6380e+03     3.6380e+04             4.5193e-08        -0.946075094114

*****************************************************************************
Applying the update for shift_i =   2.2737e+02     and shift_s =   2.2737e+03
*****************************************************************************

  Execution time = 2.5254e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
ci_001                -4.189655e-02 3 1  ON 0
ci_002                -3.205161e-02 3 1  ON 1
ci_003                -2.638407e-02 3 1  ON 2
ci_004                 2.370249e-02 3 1  ON 3
ci_005                 2.406697e-02 3 1  ON 4
ci_006                -2.137284e-02 3 1  ON 5
ci_007                -2.098295e-02 3 1  ON 6
ci_008                -8.488648e-03 3 1  ON 7
ci_009                -1.386498e-02 3 1  ON 8
ci_010                -1.004245e-02 3 1  ON 9
ci_011                -1.124933e-02 3 1  ON 10
ci_012                -9.780799e-03 3 1  ON 11
ci_013                -1.986179e-02 3 1  ON 12
ci_014                 1.228578e-02 3 1  ON 13
ci_015                 1.198114e-02 3 1  ON 14
ci_016                 1.744478e-02 3 1  ON 15
ci_017                 1.636437e-02 3 1  ON 16
ci_018                 1.024226e-02 3 1  ON 17
ci_019                 1.012396e-02 3 1  ON 18
ci_020                 1.778994e-02 3 1  ON 19
ci_021                 1.747278e-02 3 1  ON 20
ci_022                 9.162724e-03 3 1  ON 21
ci_023                 9.196374e-03 3 1  ON 22
ci_024                 9.620095e-03 3 1  ON 23
ci_025                 1.014352e-02 3 1  ON 24
ci_026                 1.159156e-02 3 1  ON 25
ci_027                 1.165782e-02 3 1  ON 26
ci_028                -1.476986e-02 3 1  ON 27
ci_029                -1.645406e-02 3 1  ON 28
ci_030                -9.543819e-03 3 1  ON 29
ci_031                -9.001979e-03 3 1  ON 30
ci_032                -1.473223e-02 3 1  ON 31
ci_033                 5.288889e-03 3 1  ON 32
ci_034                 5.586473e-03 3 1  ON 33
ci_035                -5.091722e-03 3 1  ON 34
ci_036                -1.273765e-02 3 1  ON 35
ci_037                -1.241180e-02 3 1  ON 36
ci_038                 2.040126e-03 3 1  ON 37
ci_039                 1.745516e-03 3 1  ON 38
ci_040                -3.184626e-03 3 1  ON 39
ci_041                 9.421056e-03 3 1  ON 40
ci_042                 8.205926e-03 3 1  ON 41
ci_043                -4.067930e-03 3 1  ON 42
ci_044                -3.901809e-03 3 1  ON 43
ci_045                -3.569545e-03 3 1  ON 44
ci_046                 5.631524e-03 3 1  ON 45
ci_047                 5.549940e-03 3 1  ON 46
ci_048                -1.268192e-02 3 1  ON 47
ci_049                -1.440248e-02 3 1  ON 48
ci_050                 3.145864e-03 3 1  ON 49
ci_051                 2.817384e-03 3 1  ON 50
ci_052                -2.335998e-03 3 1  ON 51
ci_053                -2.441632e-03 3 1  ON 52
ci_054                -3.363170e-03 3 1  ON 53
ci_055                -2.954260e-03 3 1  ON 54
ci_056                 5.569906e-03 3 1  ON 55
ci_057                 5.317120e-03 3 1  ON 56
ci_058                -1.111983e-03 3 1  ON 57
ci_059                -2.164408e-03 3 1  ON 58
ci_060                 4.642198e-03 3 1  ON 59
ci_061                 5.616053e-03 3 1  ON 60
ci_062                -3.751025e-03 3 1  ON 61
ci_063                -4.014992e-03 3 1  ON 62
ci_064                -2.644551e-03 3 1  ON 63
ci_065                -4.357877e-03 3 1  ON 64
ci_066                 4.478204e-03 3 1  ON 65
ci_067                 4.338584e-03 3 1  ON 66
ci_068                -4.208451e-03 3 1  ON 67
ci_069                -5.000778e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2083e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2141
    reference variance = 0.52416
====================================================
  Execution time = 1.4303e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5292e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7951e-01
  Total weights = 1.956959945e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5002e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267715256684
                                         uncertainty =       0.001766098822

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267715256684
                                         uncertainty =       0.001766098822

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365856632
  error estimate for blocks of size 2^( 2) =       0.000379592635
  error estimate for blocks of size 2^( 3) =       0.000392219736
  error estimate for blocks of size 2^( 4) =       0.000401218067
  error estimate for blocks of size 2^( 5) =       0.000406377221
  error estimate for blocks of size 2^( 6) =       0.000408576479
  error estimate for blocks of size 2^( 7) =       0.000409152168

      target function =      -0.945721213922
              le_mean =     -17.212783474558
             les_mean =     296.559423697485
             stat err =       0.000406330984
             autocorr =       1.233496766845
   target nu stat err =       0.000406330984
   target dn stat err =       0.002144889619
      target stat err =       0.003686972999
              std dev =       0.517399410760
             le_variance =       0.267702150255


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721278347456e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945734640595       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945735937343       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945736079685       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945736126406       residual = 8.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945736133203       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945736134545       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945736132916       residual = 8.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945736132584       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945736132538       residual = 2.41e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945736132597       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+01 is 2.796562e-06

solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945734640595       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945734965131       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945735000747       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945735012433       residual = 8.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945735014133       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945735014469       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945735014061       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945735013978       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945735013967       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945735013981       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+02 is 6.998992e-07

solving harmonic davidson linear method for identity shift 9.0949e+02, overlap shift 9.0949e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945734640595       residual = 2.04e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945734721751       residual = 2.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945734730657       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945734733578       residual = 8.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945734734003       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945734734087       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945734733986       residual = 8.50e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945734733965       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945734733964       residual = 2.40e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945734733967       residual = 4.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 9.0949e+02 is 1.750223e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.220229 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6812e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_001                -4.189603e-02 3 1  ON 0
ci_002                -3.205117e-02 3 1  ON 1
ci_003                -2.638380e-02 3 1  ON 2
ci_004                 2.370250e-02 3 1  ON 3
ci_005                 2.406670e-02 3 1  ON 4
ci_006                -2.137261e-02 3 1  ON 5
ci_007                -2.098267e-02 3 1  ON 6
ci_008                -8.488782e-03 3 1  ON 7
ci_009                -1.386523e-02 3 1  ON 8
ci_010                -1.004227e-02 3 1  ON 9
ci_011                -1.124914e-02 3 1  ON 10
ci_012                -9.780873e-03 3 1  ON 11
ci_013                -1.986189e-02 3 1  ON 12
ci_014                 1.228593e-02 3 1  ON 13
ci_015                 1.198104e-02 3 1  ON 14
ci_016                 1.744449e-02 3 1  ON 15
ci_017                 1.636462e-02 3 1  ON 16
ci_018                 1.024208e-02 3 1  ON 17
ci_019                 1.012393e-02 3 1  ON 18
ci_020                 1.778941e-02 3 1  ON 19
ci_021                 1.747253e-02 3 1  ON 20
ci_022                 9.162751e-03 3 1  ON 21
ci_023                 9.196275e-03 3 1  ON 22
ci_024                 9.619793e-03 3 1  ON 23
ci_025                 1.014336e-02 3 1  ON 24
ci_026                 1.159137e-02 3 1  ON 25
ci_027                 1.165778e-02 3 1  ON 26
ci_028                -1.477008e-02 3 1  ON 27
ci_029                -1.645362e-02 3 1  ON 28
ci_030                -9.543803e-03 3 1  ON 29
ci_031                -9.002173e-03 3 1  ON 30
ci_032                -1.473225e-02 3 1  ON 31
ci_033                 5.289069e-03 3 1  ON 32
ci_034                 5.586299e-03 3 1  ON 33
ci_035                -5.091599e-03 3 1  ON 34
ci_036                -1.273754e-02 3 1  ON 35
ci_037                -1.241187e-02 3 1  ON 36
ci_038                 2.040047e-03 3 1  ON 37
ci_039                 1.745463e-03 3 1  ON 38
ci_040                -3.184718e-03 3 1  ON 39
ci_041                 9.420476e-03 3 1  ON 40
ci_042                 8.206625e-03 3 1  ON 41
ci_043                -4.067984e-03 3 1  ON 42
ci_044                -3.902113e-03 3 1  ON 43
ci_045                -3.569303e-03 3 1  ON 44
ci_046                 5.631655e-03 3 1  ON 45
ci_047                 5.550103e-03 3 1  ON 46
ci_048                -1.268191e-02 3 1  ON 47
ci_049                -1.440241e-02 3 1  ON 48
ci_050                 3.146218e-03 3 1  ON 49
ci_051                 2.817640e-03 3 1  ON 50
ci_052                -2.335895e-03 3 1  ON 51
ci_053                -2.440973e-03 3 1  ON 52
ci_054                -3.362978e-03 3 1  ON 53
ci_055                -2.954040e-03 3 1  ON 54
ci_056                 5.569967e-03 3 1  ON 55
ci_057                 5.316957e-03 3 1  ON 56
ci_058                -1.112015e-03 3 1  ON 57
ci_059                -2.163801e-03 3 1  ON 58
ci_060                 4.642607e-03 3 1  ON 59
ci_061                 5.616099e-03 3 1  ON 60
ci_062                -3.751333e-03 3 1  ON 61
ci_063                -4.014829e-03 3 1  ON 62
ci_064                -2.644884e-03 3 1  ON 63
ci_065                -4.357934e-03 3 1  ON 64
ci_066                 4.478162e-03 3 1  ON 65
ci_067                 4.338694e-03 3 1  ON 66
ci_068                -4.208595e-03 3 1  ON 67
ci_069                -5.000858e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.1755
    reference variance = 0.364425
====================================================
  Execution time = 1.3718e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8587e-01
  Total weights = 1.9573e+06
  Execution time = 1.8202e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272371607817
                                         uncertainty =       0.003071357125

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272371607817
                                         uncertainty =       0.003071357125

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368993836
  error estimate for blocks of size 2^( 2) =       0.000382788883
  error estimate for blocks of size 2^( 3) =       0.000395333346
  error estimate for blocks of size 2^( 4) =       0.000404882069
  error estimate for blocks of size 2^( 5) =       0.000410428872
  error estimate for blocks of size 2^( 6) =       0.000411736157
  error estimate for blocks of size 2^( 7) =       0.000415101879

      target function =      -0.935068880315
              le_mean =     -17.211268693706
             les_mean =     296.513645335363
             stat err =       0.000410537244
             autocorr =       1.237846813854
   target nu stat err =       0.000410537244
   target dn stat err =       0.005006720936
      target stat err =       0.008258268134
              std dev =       0.521836086971
             le_variance =       0.272312901665

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272364471704
                                         uncertainty =       0.003068255526

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272364471704
                                         uncertainty =       0.003068255526

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368989002
  error estimate for blocks of size 2^( 2) =       0.000382784232
  error estimate for blocks of size 2^( 3) =       0.000395328899
  error estimate for blocks of size 2^( 4) =       0.000404877825
  error estimate for blocks of size 2^( 5) =       0.000410424638
  error estimate for blocks of size 2^( 6) =       0.000411731945
  error estimate for blocks of size 2^( 7) =       0.000415097877

      target function =      -0.935091361864
              le_mean =     -17.211268640530
             les_mean =     296.513629895245
             stat err =       0.000410533071
             autocorr =       1.237854078401
   target nu stat err =       0.000410533071
   target dn stat err =       0.005002544326
      target stat err =       0.008251824427
              std dev =       0.521829251680
             le_variance =       0.272305767909

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272368032318
                                         uncertainty =       0.003069802129

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272368032318
                                         uncertainty =       0.003069802129

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368991414
  error estimate for blocks of size 2^( 2) =       0.000382786552
  error estimate for blocks of size 2^( 3) =       0.000395331118
  error estimate for blocks of size 2^( 4) =       0.000404879942
  error estimate for blocks of size 2^( 5) =       0.000410426750
  error estimate for blocks of size 2^( 6) =       0.000411734046
  error estimate for blocks of size 2^( 7) =       0.000415099874

      target function =      -0.935080719793
              le_mean =     -17.211268667020
             les_mean =     296.513637247557
             stat err =       0.000410535153
             autocorr =       1.237850452680
   target nu stat err =       0.000410535153
   target dn stat err =       0.005004626841
      target stat err =       0.008255047405
              std dev =       0.521832662209
             le_variance =       0.272309327348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272371160325
                                         uncertainty =       0.003071162404

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272371160325
                                         uncertainty =       0.003071162404

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368993533
  error estimate for blocks of size 2^( 2) =       0.000382788591
  error estimate for blocks of size 2^( 3) =       0.000395333067
  error estimate for blocks of size 2^( 4) =       0.000404881803
  error estimate for blocks of size 2^( 5) =       0.000410428606
  error estimate for blocks of size 2^( 6) =       0.000411735892
  error estimate for blocks of size 2^( 7) =       0.000415101628

      target function =      -0.935070605936
              le_mean =     -17.211268690361
             les_mean =     296.513644174518
             stat err =       0.000410536982
             autocorr =       1.237847269175
   target nu stat err =       0.000410536982
   target dn stat err =       0.005006458685
      target stat err =       0.008257869073
              std dev =       0.521835658346
             le_variance =       0.272312454321


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.935068880315        initial
     5.6843e+01     5.6843e+02             2.7966e-06        -0.935091361864  <--
     2.2737e+02     2.2737e+03             6.9990e-07        -0.935080719793
     9.0949e+02     9.0949e+03             1.7502e-07        -0.935070605936

*****************************************************************************
Applying the update for shift_i =   5.6843e+01     and shift_s =   5.6843e+02
*****************************************************************************

  Execution time = 2.2923e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
ci_001                -4.189448e-02 3 1  ON 0
ci_002                -3.204983e-02 3 1  ON 1
ci_003                -2.638301e-02 3 1  ON 2
ci_004                 2.370254e-02 3 1  ON 3
ci_005                 2.406589e-02 3 1  ON 4
ci_006                -2.137195e-02 3 1  ON 5
ci_007                -2.098183e-02 3 1  ON 6
ci_008                -8.489184e-03 3 1  ON 7
ci_009                -1.386596e-02 3 1  ON 8
ci_010                -1.004175e-02 3 1  ON 9
ci_011                -1.124860e-02 3 1  ON 10
ci_012                -9.781094e-03 3 1  ON 11
ci_013                -1.986217e-02 3 1  ON 12
ci_014                 1.228636e-02 3 1  ON 13
ci_015                 1.198071e-02 3 1  ON 14
ci_016                 1.744359e-02 3 1  ON 15
ci_017                 1.636536e-02 3 1  ON 16
ci_018                 1.024155e-02 3 1  ON 17
ci_019                 1.012381e-02 3 1  ON 18
ci_020                 1.778783e-02 3 1  ON 19
ci_021                 1.747179e-02 3 1  ON 20
ci_022                 9.162832e-03 3 1  ON 21
ci_023                 9.195978e-03 3 1  ON 22
ci_024                 9.618886e-03 3 1  ON 23
ci_025                 1.014287e-02 3 1  ON 24
ci_026                 1.159079e-02 3 1  ON 25
ci_027                 1.165764e-02 3 1  ON 26
ci_028                -1.477077e-02 3 1  ON 27
ci_029                -1.645231e-02 3 1  ON 28
ci_030                -9.543755e-03 3 1  ON 29
ci_031                -9.002755e-03 3 1  ON 30
ci_032                -1.473230e-02 3 1  ON 31
ci_033                 5.289610e-03 3 1  ON 32
ci_034                 5.585780e-03 3 1  ON 33
ci_035                -5.091230e-03 3 1  ON 34
ci_036                -1.273721e-02 3 1  ON 35
ci_037                -1.241209e-02 3 1  ON 36
ci_038                 2.039810e-03 3 1  ON 37
ci_039                 1.745303e-03 3 1  ON 38
ci_040                -3.184993e-03 3 1  ON 39
ci_041                 9.418739e-03 3 1  ON 40
ci_042                 8.208722e-03 3 1  ON 41
ci_043                -4.068148e-03 3 1  ON 42
ci_044                -3.903024e-03 3 1  ON 43
ci_045                -3.568577e-03 3 1  ON 44
ci_046                 5.632046e-03 3 1  ON 45
ci_047                 5.550589e-03 3 1  ON 46
ci_048                -1.268187e-02 3 1  ON 47
ci_049                -1.440219e-02 3 1  ON 48
ci_050                 3.147280e-03 3 1  ON 49
ci_051                 2.818406e-03 3 1  ON 50
ci_052                -2.335588e-03 3 1  ON 51
ci_053                -2.438998e-03 3 1  ON 52
ci_054                -3.362401e-03 3 1  ON 53
ci_055                -2.953379e-03 3 1  ON 54
ci_056                 5.570149e-03 3 1  ON 55
ci_057                 5.316471e-03 3 1  ON 56
ci_058                -1.112110e-03 3 1  ON 57
ci_059                -2.161982e-03 3 1  ON 58
ci_060                 4.643830e-03 3 1  ON 59
ci_061                 5.616237e-03 3 1  ON 60
ci_062                -3.752258e-03 3 1  ON 61
ci_063                -4.014338e-03 3 1  ON 62
ci_064                -2.645880e-03 3 1  ON 63
ci_065                -4.358104e-03 3 1  ON 64
ci_066                 4.478035e-03 3 1  ON 65
ci_067                 4.339022e-03 3 1  ON 66
ci_068                -4.209029e-03 3 1  ON 67
ci_069                -5.001096e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9741e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.2046
    reference variance = 0.137696
====================================================
  Execution time = 1.4355e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5262e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8158e-01
  Total weights = 1.957128192e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4765e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268658217299
                                         uncertainty =       0.002191308313

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268658217299
                                         uncertainty =       0.002191308313

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366475884
  error estimate for blocks of size 2^( 2) =       0.000380155730
  error estimate for blocks of size 2^( 3) =       0.000392485499
  error estimate for blocks of size 2^( 4) =       0.000401255511
  error estimate for blocks of size 2^( 5) =       0.000406474852
  error estimate for blocks of size 2^( 6) =       0.000408727562
  error estimate for blocks of size 2^( 7) =       0.000409829030

      target function =      -0.942210965080
              le_mean =     -17.212073306449
             les_mean =     296.537051321509
             stat err =       0.000406571739
             autocorr =       1.230788900466
   target nu stat err =       0.000406571739
   target dn stat err =       0.003616627310
      target stat err =       0.006085494452
              std dev =       0.518275165853
             le_variance =       0.268609147540


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721207330645e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4211e+01, overlap shift 1.4211e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942249155155       residual = 3.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942257458679       residual = 3.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942258659912       residual = 6.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942258843617       residual = 1.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942258885977       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942258893800       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942258895370       residual = 9.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942258896624       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942258896340       residual = 4.48e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942258896610       residual = 7.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+01 is 2.241006e-05

solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942249155155       residual = 3.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942251240190       residual = 3.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942251541493       residual = 6.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942251587526       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942251598128       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942251600078       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942251600470       residual = 9.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942251600784       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942251600713       residual = 4.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942251600780       residual = 7.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+01 is 5.624801e-06

solving harmonic davidson linear method for identity shift 2.2737e+02, overlap shift 2.2737e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942249155155       residual = 3.80e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942249676989       residual = 3.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942249752377       residual = 6.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942249763892       residual = 1.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942249766544       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942249767031       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942249767129       residual = 9.83e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942249767207       residual = 1.95e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942249767190       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942249767206       residual = 7.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2737e+02 is 1.407600e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.223670 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6840e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_001                -4.189427e-02 3 1  ON 0
ci_002                -3.204943e-02 3 1  ON 1
ci_003                -2.638205e-02 3 1  ON 2
ci_004                 2.370244e-02 3 1  ON 3
ci_005                 2.406501e-02 3 1  ON 4
ci_006                -2.137057e-02 3 1  ON 5
ci_007                -2.098174e-02 3 1  ON 6
ci_008                -8.488956e-03 3 1  ON 7
ci_009                -1.386840e-02 3 1  ON 8
ci_010                -1.004105e-02 3 1  ON 9
ci_011                -1.124297e-02 3 1  ON 10
ci_012                -9.780947e-03 3 1  ON 11
ci_013                -1.985988e-02 3 1  ON 12
ci_014                 1.228673e-02 3 1  ON 13
ci_015                 1.198114e-02 3 1  ON 14
ci_016                 1.744353e-02 3 1  ON 15
ci_017                 1.636540e-02 3 1  ON 16
ci_018                 1.023896e-02 3 1  ON 17
ci_019                 1.012444e-02 3 1  ON 18
ci_020                 1.778716e-02 3 1  ON 19
ci_021                 1.747325e-02 3 1  ON 20
ci_022                 9.162382e-03 3 1  ON 21
ci_023                 9.196134e-03 3 1  ON 22
ci_024                 9.617158e-03 3 1  ON 23
ci_025                 1.014201e-02 3 1  ON 24
ci_026                 1.159002e-02 3 1  ON 25
ci_027                 1.165856e-02 3 1  ON 26
ci_028                -1.477149e-02 3 1  ON 27
ci_029                -1.645258e-02 3 1  ON 28
ci_030                -9.544023e-03 3 1  ON 29
ci_031                -9.002521e-03 3 1  ON 30
ci_032                -1.473260e-02 3 1  ON 31
ci_033                 5.290002e-03 3 1  ON 32
ci_034                 5.585892e-03 3 1  ON 33
ci_035                -5.091370e-03 3 1  ON 34
ci_036                -1.273718e-02 3 1  ON 35
ci_037                -1.241089e-02 3 1  ON 36
ci_038                 2.039928e-03 3 1  ON 37
ci_039                 1.745730e-03 3 1  ON 38
ci_040                -3.185138e-03 3 1  ON 39
ci_041                 9.418216e-03 3 1  ON 40
ci_042                 8.204367e-03 3 1  ON 41
ci_043                -4.068071e-03 3 1  ON 42
ci_044                -3.902501e-03 3 1  ON 43
ci_045                -3.569055e-03 3 1  ON 44
ci_046                 5.632265e-03 3 1  ON 45
ci_047                 5.550601e-03 3 1  ON 46
ci_048                -1.268252e-02 3 1  ON 47
ci_049                -1.440042e-02 3 1  ON 48
ci_050                 3.148220e-03 3 1  ON 49
ci_051                 2.820536e-03 3 1  ON 50
ci_052                -2.334939e-03 3 1  ON 51
ci_053                -2.438041e-03 3 1  ON 52
ci_054                -3.362157e-03 3 1  ON 53
ci_055                -2.952978e-03 3 1  ON 54
ci_056                 5.569913e-03 3 1  ON 55
ci_057                 5.316216e-03 3 1  ON 56
ci_058                -1.112020e-03 3 1  ON 57
ci_059                -2.160155e-03 3 1  ON 58
ci_060                 4.644823e-03 3 1  ON 59
ci_061                 5.616624e-03 3 1  ON 60
ci_062                -3.753225e-03 3 1  ON 61
ci_063                -4.014733e-03 3 1  ON 62
ci_064                -2.646560e-03 3 1  ON 63
ci_065                -4.358171e-03 3 1  ON 64
ci_066                 4.477664e-03 3 1  ON 65
ci_067                 4.339325e-03 3 1  ON 66
ci_068                -4.210356e-03 3 1  ON 67
ci_069                -4.998735e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.2033
    reference variance = 0.141499
====================================================
  Execution time = 1.3997e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7733e-01
  Total weights = 1.9573e+06
  Execution time = 1.8135e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267188701800
                                         uncertainty =       0.001417981804

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267188701800
                                         uncertainty =       0.001417981804

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365530504
  error estimate for blocks of size 2^( 2) =       0.000379595320
  error estimate for blocks of size 2^( 3) =       0.000392719599
  error estimate for blocks of size 2^( 4) =       0.000402035112
  error estimate for blocks of size 2^( 5) =       0.000408036967
  error estimate for blocks of size 2^( 6) =       0.000412572645
  error estimate for blocks of size 2^( 7) =       0.000414325229

      target function =      -0.949390751199
              le_mean =     -17.211996438149
             les_mean =     296.530156600964
             stat err =       0.000409242488
             autocorr =       1.253470685509
   target nu stat err =       0.000409242488
   target dn stat err =       0.001850937962
      target stat err =       0.003223304273
              std dev =       0.516938196561
             le_variance =       0.267225099064

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267187072657
                                         uncertainty =       0.001417938559

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267187072657
                                         uncertainty =       0.001417938559

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365529384
  error estimate for blocks of size 2^( 2) =       0.000379594804
  error estimate for blocks of size 2^( 3) =       0.000392719695
  error estimate for blocks of size 2^( 4) =       0.000402035875
  error estimate for blocks of size 2^( 5) =       0.000408038303
  error estimate for blocks of size 2^( 6) =       0.000412573511
  error estimate for blocks of size 2^( 7) =       0.000414325938

      target function =      -0.949401868978
              le_mean =     -17.211996210574
             les_mean =     296.530142220911
             stat err =       0.000409243407
             autocorr =       1.253483993754
   target nu stat err =       0.000409243407
   target dn stat err =       0.001849229002
      target stat err =       0.003220553801
              std dev =       0.516936612670
             le_variance =       0.267223461519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267187875862
                                         uncertainty =       0.001417959979

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267187875862
                                         uncertainty =       0.001417959979

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365529936
  error estimate for blocks of size 2^( 2) =       0.000379595056
  error estimate for blocks of size 2^( 3) =       0.000392719642
  error estimate for blocks of size 2^( 4) =       0.000402035490
  error estimate for blocks of size 2^( 5) =       0.000408037632
  error estimate for blocks of size 2^( 6) =       0.000412573074
  error estimate for blocks of size 2^( 7) =       0.000414325581

      target function =      -0.949398242286
              le_mean =     -17.211996322673
             les_mean =     296.530148213662
             stat err =       0.000409242944
             autocorr =       1.253477373809
   target nu stat err =       0.000409242944
   target dn stat err =       0.001850061479
      target stat err =       0.003221905456
              std dev =       0.516937393602
             le_variance =       0.267224268904

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267188597554
                                         uncertainty =       0.001417979061

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267188597554
                                         uncertainty =       0.001417979061

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365530433
  error estimate for blocks of size 2^( 2) =       0.000379595286
  error estimate for blocks of size 2^( 3) =       0.000392719604
  error estimate for blocks of size 2^( 4) =       0.000402035158
  error estimate for blocks of size 2^( 5) =       0.000408037050
  error estimate for blocks of size 2^( 6) =       0.000412572698
  error estimate for blocks of size 2^( 7) =       0.000414325273

      target function =      -0.949391804946
              le_mean =     -17.211996423573
             les_mean =     296.530155478478
             stat err =       0.000409242545
             autocorr =       1.253471523176
   target nu stat err =       0.000409242545
   target dn stat err =       0.001850826375
      target stat err =       0.003223126849
              std dev =       0.516938095221
             le_variance =       0.267224994291


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949390751199        initial
     1.4211e+01     1.4211e+02             2.2410e-05        -0.949401868978  <--
     5.6843e+01     5.6843e+02             5.6248e-06        -0.949398242286
     2.2737e+02     2.2737e+03             1.4076e-06        -0.949391804946

*****************************************************************************
Applying the update for shift_i =   1.4211e+01     and shift_s =   1.4211e+02
*****************************************************************************

  Execution time = 2.3182e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
ci_001                -4.189364e-02 3 1  ON 0
ci_002                -3.204824e-02 3 1  ON 1
ci_003                -2.637917e-02 3 1  ON 2
ci_004                 2.370213e-02 3 1  ON 3
ci_005                 2.406238e-02 3 1  ON 4
ci_006                -2.136644e-02 3 1  ON 5
ci_007                -2.098148e-02 3 1  ON 6
ci_008                -8.488275e-03 3 1  ON 7
ci_009                -1.387568e-02 3 1  ON 8
ci_010                -1.003899e-02 3 1  ON 9
ci_011                -1.122619e-02 3 1  ON 10
ci_012                -9.780509e-03 3 1  ON 11
ci_013                -1.985303e-02 3 1  ON 12
ci_014                 1.228786e-02 3 1  ON 13
ci_015                 1.198242e-02 3 1  ON 14
ci_016                 1.744334e-02 3 1  ON 15
ci_017                 1.636553e-02 3 1  ON 16
ci_018                 1.023124e-02 3 1  ON 17
ci_019                 1.012632e-02 3 1  ON 18
ci_020                 1.778517e-02 3 1  ON 19
ci_021                 1.747762e-02 3 1  ON 20
ci_022                 9.161039e-03 3 1  ON 21
ci_023                 9.196602e-03 3 1  ON 22
ci_024                 9.612000e-03 3 1  ON 23
ci_025                 1.013946e-02 3 1  ON 24
ci_026                 1.158774e-02 3 1  ON 25
ci_027                 1.166133e-02 3 1  ON 26
ci_028                -1.477366e-02 3 1  ON 27
ci_029                -1.645337e-02 3 1  ON 28
ci_030                -9.544825e-03 3 1  ON 29
ci_031                -9.001820e-03 3 1  ON 30
ci_032                -1.473347e-02 3 1  ON 31
ci_033                 5.291174e-03 3 1  ON 32
ci_034                 5.586228e-03 3 1  ON 33
ci_035                -5.091789e-03 3 1  ON 34
ci_036                -1.273708e-02 3 1  ON 35
ci_037                -1.240730e-02 3 1  ON 36
ci_038                 2.040281e-03 3 1  ON 37
ci_039                 1.747001e-03 3 1  ON 38
ci_040                -3.185568e-03 3 1  ON 39
ci_041                 9.416659e-03 3 1  ON 40
ci_042                 8.191375e-03 3 1  ON 41
ci_043                -4.067844e-03 3 1  ON 42
ci_044                -3.900941e-03 3 1  ON 43
ci_045                -3.570480e-03 3 1  ON 44
ci_046                 5.632917e-03 3 1  ON 45
ci_047                 5.550636e-03 3 1  ON 46
ci_048                -1.268446e-02 3 1  ON 47
ci_049                -1.439514e-02 3 1  ON 48
ci_050                 3.151020e-03 3 1  ON 49
ci_051                 2.826887e-03 3 1  ON 50
ci_052                -2.333003e-03 3 1  ON 51
ci_053                -2.435186e-03 3 1  ON 52
ci_054                -3.361428e-03 3 1  ON 53
ci_055                -2.951780e-03 3 1  ON 54
ci_056                 5.569209e-03 3 1  ON 55
ci_057                 5.315454e-03 3 1  ON 56
ci_058                -1.111753e-03 3 1  ON 57
ci_059                -2.154703e-03 3 1  ON 58
ci_060                 4.647785e-03 3 1  ON 59
ci_061                 5.617776e-03 3 1  ON 60
ci_062                -3.756107e-03 3 1  ON 61
ci_063                -4.015909e-03 3 1  ON 62
ci_064                -2.648587e-03 3 1  ON 63
ci_065                -4.358369e-03 3 1  ON 64
ci_066                 4.476558e-03 3 1  ON 65
ci_067                 4.340228e-03 3 1  ON 66
ci_068                -4.214318e-03 3 1  ON 67
ci_069                -4.991687e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0029e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s060 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s060 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=60  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.1929
    reference variance = 0.222299
====================================================
  Execution time = 1.4263e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s060
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5273e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8037e-01
  Total weights = 1.957550825e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4826e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268261214476
                                         uncertainty =       0.001452048449

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268261214476
                                         uncertainty =       0.001452048449

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366214295
  error estimate for blocks of size 2^( 2) =       0.000380129498
  error estimate for blocks of size 2^( 3) =       0.000393234265
  error estimate for blocks of size 2^( 4) =       0.000402590327
  error estimate for blocks of size 2^( 5) =       0.000409090356
  error estimate for blocks of size 2^( 6) =       0.000412498399
  error estimate for blocks of size 2^( 7) =       0.000414102758

      target function =      -0.944269964713
              le_mean =     -17.211662386519
             les_mean =     296.521689550765
             stat err =       0.000409570460
             autocorr =       1.250796522136
   target nu stat err =       0.000409570460
   target dn stat err =       0.002131209169
      target stat err =       0.003646788445
              std dev =       0.517905223347
             le_variance =       0.268225820370


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721166238652e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+00, overlap shift 3.5527e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944283089345       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944296739138       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944298329600       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944298724134       residual = 6.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944298799304       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944298819060       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944298837120       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944298835055       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944298839327       residual = 1.56e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944298838695       residual = 3.21e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+00 is 4.665673e-05

solving harmonic davidson linear method for identity shift 1.4211e+01, overlap shift 1.4211e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944283089345       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944286558884       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944286961543       residual = 3.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944287060877       residual = 6.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944287079798       residual = 1.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944287084722       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944287089263       residual = 6.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944287088741       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944287089805       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944287089648       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+01 is 1.184512e-05

solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944283089345       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944283960373       residual = 1.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944284061358       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944284086235       residual = 6.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944284090973       residual = 1.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944284092203       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944284093340       residual = 6.05e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944284093209       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944284093475       residual = 1.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944284093436       residual = 3.05e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+01 is 2.972808e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.227139 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6754e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
ci_001                -4.189103e-02 3 1  ON 0
ci_002                -3.204483e-02 3 1  ON 1
ci_003                -2.637183e-02 3 1  ON 2
ci_004                 2.370539e-02 3 1  ON 3
ci_005                 2.406353e-02 3 1  ON 4
ci_006                -2.136154e-02 3 1  ON 5
ci_007                -2.097759e-02 3 1  ON 6
ci_008                -8.491527e-03 3 1  ON 7
ci_009                -1.388223e-02 3 1  ON 8
ci_010                -1.003409e-02 3 1  ON 9
ci_011                -1.121434e-02 3 1  ON 10
ci_012                -9.783050e-03 3 1  ON 11
ci_013                -1.985380e-02 3 1  ON 12
ci_014                 1.228998e-02 3 1  ON 13
ci_015                 1.198409e-02 3 1  ON 14
ci_016                 1.743897e-02 3 1  ON 15
ci_017                 1.636735e-02 3 1  ON 16
ci_018                 1.022980e-02 3 1  ON 17
ci_019                 1.012560e-02 3 1  ON 18
ci_020                 1.777841e-02 3 1  ON 19
ci_021                 1.746914e-02 3 1  ON 20
ci_022                 9.159684e-03 3 1  ON 21
ci_023                 9.200520e-03 3 1  ON 22
ci_024                 9.604298e-03 3 1  ON 23
ci_025                 1.013620e-02 3 1  ON 24
ci_026                 1.158729e-02 3 1  ON 25
ci_027                 1.165866e-02 3 1  ON 26
ci_028                -1.477698e-02 3 1  ON 27
ci_029                -1.645006e-02 3 1  ON 28
ci_030                -9.542396e-03 3 1  ON 29
ci_031                -9.007300e-03 3 1  ON 30
ci_032                -1.473348e-02 3 1  ON 31
ci_033                 5.296142e-03 3 1  ON 32
ci_034                 5.590317e-03 3 1  ON 33
ci_035                -5.089657e-03 3 1  ON 34
ci_036                -1.273643e-02 3 1  ON 35
ci_037                -1.241182e-02 3 1  ON 36
ci_038                 2.038647e-03 3 1  ON 37
ci_039                 1.748183e-03 3 1  ON 38
ci_040                -3.186485e-03 3 1  ON 39
ci_041                 9.415627e-03 3 1  ON 40
ci_042                 8.198008e-03 3 1  ON 41
ci_043                -4.067191e-03 3 1  ON 42
ci_044                -3.909904e-03 3 1  ON 43
ci_045                -3.565483e-03 3 1  ON 44
ci_046                 5.632092e-03 3 1  ON 45
ci_047                 5.551860e-03 3 1  ON 46
ci_048                -1.268694e-02 3 1  ON 47
ci_049                -1.438914e-02 3 1  ON 48
ci_050                 3.153474e-03 3 1  ON 49
ci_051                 2.828648e-03 3 1  ON 50
ci_052                -2.334004e-03 3 1  ON 51
ci_053                -2.437145e-03 3 1  ON 52
ci_054                -3.356409e-03 3 1  ON 53
ci_055                -2.949143e-03 3 1  ON 54
ci_056                 5.566937e-03 3 1  ON 55
ci_057                 5.314682e-03 3 1  ON 56
ci_058                -1.110299e-03 3 1  ON 57
ci_059                -2.153245e-03 3 1  ON 58
ci_060                 4.655824e-03 3 1  ON 59
ci_061                 5.616006e-03 3 1  ON 60
ci_062                -3.758478e-03 3 1  ON 61
ci_063                -4.012162e-03 3 1  ON 62
ci_064                -2.650739e-03 3 1  ON 63
ci_065                -4.356251e-03 3 1  ON 64
ci_066                 4.476395e-03 3 1  ON 65
ci_067                 4.343441e-03 3 1  ON 66
ci_068                -4.215604e-03 3 1  ON 67
ci_069                -4.991278e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 60
    time step          = 0.05
    reference energy   = -17.1864
    reference variance = 0.289545
====================================================
  Execution time = 1.3720e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s060
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8042e-01
  Total weights = 1.9574e+06
  Execution time = 1.8124e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268157156177
                                         uncertainty =       0.001741697918

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268157156177
                                         uncertainty =       0.001741697918

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366135960
  error estimate for blocks of size 2^( 2) =       0.000379984581
  error estimate for blocks of size 2^( 3) =       0.000392570115
  error estimate for blocks of size 2^( 4) =       0.000402310855
  error estimate for blocks of size 2^( 5) =       0.000407829008
  error estimate for blocks of size 2^( 6) =       0.000410221101
  error estimate for blocks of size 2^( 7) =       0.000409177348

      target function =      -0.944144530725
              le_mean =     -17.211803202302
             les_mean =     296.526607919307
             stat err =       0.000407384578
             autocorr =       1.238010704289
   target nu stat err =       0.000407384578
   target dn stat err =       0.002651457440
      target stat err =       0.004504379801
              std dev =       0.517794439805
             le_variance =       0.268111081893

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268147617586
                                         uncertainty =       0.001742143210

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268147617586
                                         uncertainty =       0.001742143210

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366129464
  error estimate for blocks of size 2^( 2) =       0.000379977835
  error estimate for blocks of size 2^( 3) =       0.000392563786
  error estimate for blocks of size 2^( 4) =       0.000402305563
  error estimate for blocks of size 2^( 5) =       0.000407824529
  error estimate for blocks of size 2^( 6) =       0.000410217353
  error estimate for blocks of size 2^( 7) =       0.000409173332

      target function =      -0.921243327358
              le_mean =     -17.211803126773
             les_mean =     296.540276160335
             stat err =       0.000407380194
             autocorr =       1.238027989738
   target nu stat err =       0.000407380194
   target dn stat err =       0.013997234796
      target stat err =       0.022369223252
              std dev =       0.517785252945
             le_variance =       0.268101568167

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268152237739
                                         uncertainty =       0.001741922623

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268152237739
                                         uncertainty =       0.001741922623

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366132610
  error estimate for blocks of size 2^( 2) =       0.000379981100
  error estimate for blocks of size 2^( 3) =       0.000392566922
  error estimate for blocks of size 2^( 4) =       0.000402308163
  error estimate for blocks of size 2^( 5) =       0.000407826701
  error estimate for blocks of size 2^( 6) =       0.000410219192
  error estimate for blocks of size 2^( 7) =       0.000409175190

      target function =      -0.944188270814
              le_mean =     -17.211803182734
             les_mean =     296.526581239701
             stat err =       0.000407382311
             autocorr =       1.238019578693
   target nu stat err =       0.000407382311
   target dn stat err =       0.002643022859
      target stat err =       0.004490830352
              std dev =       0.517789702608
             le_variance =       0.268106176127

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268156530459
                                         uncertainty =       0.001741726020

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268156530459
                                         uncertainty =       0.001741726020

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366135533
  error estimate for blocks of size 2^( 2) =       0.000379984138
  error estimate for blocks of size 2^( 3) =       0.000392569709
  error estimate for blocks of size 2^( 4) =       0.000402310512
  error estimate for blocks of size 2^( 5) =       0.000407828713
  error estimate for blocks of size 2^( 6) =       0.000410220856
  error estimate for blocks of size 2^( 7) =       0.000409177071

      target function =      -0.944152224013
              le_mean =     -17.211803198649
             les_mean =     296.526603215474
             stat err =       0.000407384288
             autocorr =       1.238011821265
   target nu stat err =       0.000407384288
   target dn stat err =       0.002650374624
      target stat err =       0.004502659984
              std dev =       0.517793837129
             le_variance =       0.268110457769


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.944144530725        initial
     3.5527e+00     3.5527e+01             4.6657e-05        -0.921243327358
     1.4211e+01     1.4211e+02             1.1845e-05        -0.944188270814  <--
     5.6843e+01     5.6843e+02             2.9728e-06        -0.944152224013

*****************************************************************************
Applying the update for shift_i =   1.4211e+01     and shift_s =   1.4211e+02
*****************************************************************************

  Execution time = 2.2919e+01
  </log>
  <optVariables href="H2O.s060.opt.xml">
ci_001                -4.189103e-02 3 1  ON 0
ci_002                -3.204483e-02 3 1  ON 1
ci_003                -2.637183e-02 3 1  ON 2
ci_004                 2.370539e-02 3 1  ON 3
ci_005                 2.406353e-02 3 1  ON 4
ci_006                -2.136154e-02 3 1  ON 5
ci_007                -2.097759e-02 3 1  ON 6
ci_008                -8.491527e-03 3 1  ON 7
ci_009                -1.388223e-02 3 1  ON 8
ci_010                -1.003409e-02 3 1  ON 9
ci_011                -1.121434e-02 3 1  ON 10
ci_012                -9.783050e-03 3 1  ON 11
ci_013                -1.985380e-02 3 1  ON 12
ci_014                 1.228998e-02 3 1  ON 13
ci_015                 1.198409e-02 3 1  ON 14
ci_016                 1.743897e-02 3 1  ON 15
ci_017                 1.636735e-02 3 1  ON 16
ci_018                 1.022980e-02 3 1  ON 17
ci_019                 1.012560e-02 3 1  ON 18
ci_020                 1.777841e-02 3 1  ON 19
ci_021                 1.746914e-02 3 1  ON 20
ci_022                 9.159684e-03 3 1  ON 21
ci_023                 9.200520e-03 3 1  ON 22
ci_024                 9.604298e-03 3 1  ON 23
ci_025                 1.013620e-02 3 1  ON 24
ci_026                 1.158729e-02 3 1  ON 25
ci_027                 1.165866e-02 3 1  ON 26
ci_028                -1.477698e-02 3 1  ON 27
ci_029                -1.645006e-02 3 1  ON 28
ci_030                -9.542396e-03 3 1  ON 29
ci_031                -9.007300e-03 3 1  ON 30
ci_032                -1.473348e-02 3 1  ON 31
ci_033                 5.296142e-03 3 1  ON 32
ci_034                 5.590317e-03 3 1  ON 33
ci_035                -5.089657e-03 3 1  ON 34
ci_036                -1.273643e-02 3 1  ON 35
ci_037                -1.241182e-02 3 1  ON 36
ci_038                 2.038647e-03 3 1  ON 37
ci_039                 1.748183e-03 3 1  ON 38
ci_040                -3.186485e-03 3 1  ON 39
ci_041                 9.415627e-03 3 1  ON 40
ci_042                 8.198008e-03 3 1  ON 41
ci_043                -4.067191e-03 3 1  ON 42
ci_044                -3.909904e-03 3 1  ON 43
ci_045                -3.565483e-03 3 1  ON 44
ci_046                 5.632092e-03 3 1  ON 45
ci_047                 5.551860e-03 3 1  ON 46
ci_048                -1.268694e-02 3 1  ON 47
ci_049                -1.438914e-02 3 1  ON 48
ci_050                 3.153474e-03 3 1  ON 49
ci_051                 2.828648e-03 3 1  ON 50
ci_052                -2.334004e-03 3 1  ON 51
ci_053                -2.437145e-03 3 1  ON 52
ci_054                -3.356409e-03 3 1  ON 53
ci_055                -2.949143e-03 3 1  ON 54
ci_056                 5.566937e-03 3 1  ON 55
ci_057                 5.314682e-03 3 1  ON 56
ci_058                -1.110299e-03 3 1  ON 57
ci_059                -2.153245e-03 3 1  ON 58
ci_060                 4.655824e-03 3 1  ON 59
ci_061                 5.616006e-03 3 1  ON 60
ci_062                -3.758478e-03 3 1  ON 61
ci_063                -4.012162e-03 3 1  ON 62
ci_064                -2.650739e-03 3 1  ON 63
ci_065                -4.356251e-03 3 1  ON 64
ci_066                 4.476395e-03 3 1  ON 65
ci_067                 4.343441e-03 3 1  ON 66
ci_068                -4.215604e-03 3 1  ON 67
ci_069                -4.991278e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9684e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s061 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s061 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=61  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.1662
    reference variance = 0.146061
====================================================
  Execution time = 1.4262e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s061
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5281e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7689e-01
  Total weights = 1.957216798e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4807e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266366372370
                                         uncertainty =       0.001578471838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266366372370
                                         uncertainty =       0.001578471838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364977155
  error estimate for blocks of size 2^( 2) =       0.000378818030
  error estimate for blocks of size 2^( 3) =       0.000391684675
  error estimate for blocks of size 2^( 4) =       0.000401213631
  error estimate for blocks of size 2^( 5) =       0.000405822756
  error estimate for blocks of size 2^( 6) =       0.000408840111
  error estimate for blocks of size 2^( 7) =       0.000411028953

      target function =      -0.950148214106
              le_mean =     -17.212496391150
             les_mean =     296.546924296747
             stat err =       0.000406726363
             autocorr =       1.241861839240
   target nu stat err =       0.000406726363
   target dn stat err =       0.002080144185
      target stat err =       0.003611129998
              std dev =       0.516155642961
             le_variance =       0.266416647761


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721249639115e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+00, overlap shift 3.5527e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950160903491       residual = 1.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950178066061       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950179535611       residual = 3.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.950180256768       residual = 6.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950180398393       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.950180399839       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.950180384283       residual = 4.54e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.950180378167       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.950180373719       residual = 1.64e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.950180373396       residual = 3.37e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+00 is 4.192015e-05

solving harmonic davidson linear method for identity shift 1.4211e+01, overlap shift 1.4211e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950160903491       residual = 1.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950165268570       residual = 1.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950165640706       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.950165822790       residual = 6.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950165858425       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.950165858730       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.950165854801       residual = 4.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.950165853268       residual = 1.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.950165852159       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.950165852082       residual = 3.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+01 is 1.065542e-05

solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950160903491       residual = 1.65e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950161999514       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950162092849       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.950162138484       residual = 6.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950162147407       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.950162147479       residual = 3.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.950162146495       residual = 4.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.950162146111       residual = 1.18e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.950162145834       residual = 1.57e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.950162145815       residual = 3.19e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+01 is 2.675050e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.230602 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6751e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
ci_001                -4.188288e-02 3 1  ON 0
ci_002                -3.204755e-02 3 1  ON 1
ci_003                -2.636117e-02 3 1  ON 2
ci_004                 2.370590e-02 3 1  ON 3
ci_005                 2.406337e-02 3 1  ON 4
ci_006                -2.136264e-02 3 1  ON 5
ci_007                -2.097593e-02 3 1  ON 6
ci_008                -8.496493e-03 3 1  ON 7
ci_009                -1.388756e-02 3 1  ON 8
ci_010                -1.002903e-02 3 1  ON 9
ci_011                -1.120491e-02 3 1  ON 10
ci_012                -9.786201e-03 3 1  ON 11
ci_013                -1.984941e-02 3 1  ON 12
ci_014                 1.229135e-02 3 1  ON 13
ci_015                 1.198661e-02 3 1  ON 14
ci_016                 1.743917e-02 3 1  ON 15
ci_017                 1.636808e-02 3 1  ON 16
ci_018                 1.022768e-02 3 1  ON 17
ci_019                 1.012187e-02 3 1  ON 18
ci_020                 1.777627e-02 3 1  ON 19
ci_021                 1.746775e-02 3 1  ON 20
ci_022                 9.163441e-03 3 1  ON 21
ci_023                 9.199815e-03 3 1  ON 22
ci_024                 9.603521e-03 3 1  ON 23
ci_025                 1.013107e-02 3 1  ON 24
ci_026                 1.158415e-02 3 1  ON 25
ci_027                 1.165158e-02 3 1  ON 26
ci_028                -1.478138e-02 3 1  ON 27
ci_029                -1.644751e-02 3 1  ON 28
ci_030                -9.544027e-03 3 1  ON 29
ci_031                -9.012724e-03 3 1  ON 30
ci_032                -1.473317e-02 3 1  ON 31
ci_033                 5.301252e-03 3 1  ON 32
ci_034                 5.597799e-03 3 1  ON 33
ci_035                -5.089532e-03 3 1  ON 34
ci_036                -1.274589e-02 3 1  ON 35
ci_037                -1.241187e-02 3 1  ON 36
ci_038                 2.036478e-03 3 1  ON 37
ci_039                 1.750265e-03 3 1  ON 38
ci_040                -3.185530e-03 3 1  ON 39
ci_041                 9.410446e-03 3 1  ON 40
ci_042                 8.203170e-03 3 1  ON 41
ci_043                -4.065152e-03 3 1  ON 42
ci_044                -3.910968e-03 3 1  ON 43
ci_045                -3.564117e-03 3 1  ON 44
ci_046                 5.634033e-03 3 1  ON 45
ci_047                 5.552461e-03 3 1  ON 46
ci_048                -1.268675e-02 3 1  ON 47
ci_049                -1.438425e-02 3 1  ON 48
ci_050                 3.153542e-03 3 1  ON 49
ci_051                 2.829705e-03 3 1  ON 50
ci_052                -2.333144e-03 3 1  ON 51
ci_053                -2.438004e-03 3 1  ON 52
ci_054                -3.349655e-03 3 1  ON 53
ci_055                -2.948657e-03 3 1  ON 54
ci_056                 5.566523e-03 3 1  ON 55
ci_057                 5.313641e-03 3 1  ON 56
ci_058                -1.113941e-03 3 1  ON 57
ci_059                -2.150473e-03 3 1  ON 58
ci_060                 4.658030e-03 3 1  ON 59
ci_061                 5.613280e-03 3 1  ON 60
ci_062                -3.757001e-03 3 1  ON 61
ci_063                -4.008600e-03 3 1  ON 62
ci_064                -2.654627e-03 3 1  ON 63
ci_065                -4.354491e-03 3 1  ON 64
ci_066                 4.472817e-03 3 1  ON 65
ci_067                 4.344273e-03 3 1  ON 66
ci_068                -4.217247e-03 3 1  ON 67
ci_069                -4.991521e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 61
    time step          = 0.05
    reference energy   = -17.2958
    reference variance = 0.420064
====================================================
  Execution time = 1.5780e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s061
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8018e-01
  Total weights = 1.9574e+06
  Execution time = 1.8198e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268623559007
                                         uncertainty =       0.001593163153

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268623559007
                                         uncertainty =       0.001593163153

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366496149
  error estimate for blocks of size 2^( 2) =       0.000380041656
  error estimate for blocks of size 2^( 3) =       0.000392161259
  error estimate for blocks of size 2^( 4) =       0.000401145674
  error estimate for blocks of size 2^( 5) =       0.000407356745
  error estimate for blocks of size 2^( 6) =       0.000409520448
  error estimate for blocks of size 2^( 7) =       0.000413161345

      target function =      -0.944565288130
              le_mean =     -17.211884902410
             les_mean =     296.529174110210
             stat err =       0.000407796053
             autocorr =       1.238075713305
   target nu stat err =       0.000407796053
   target dn stat err =       0.002159306749
      target stat err =       0.003696161132
              std dev =       0.518303824859
             le_variance =       0.268638854863

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268616627443
                                         uncertainty =       0.001593631057

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268616627443
                                         uncertainty =       0.001593631057

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366491344
  error estimate for blocks of size 2^( 2) =       0.000380036598
  error estimate for blocks of size 2^( 3) =       0.000392156297
  error estimate for blocks of size 2^( 4) =       0.000401141264
  error estimate for blocks of size 2^( 5) =       0.000407353290
  error estimate for blocks of size 2^( 6) =       0.000409517289
  error estimate for blocks of size 2^( 7) =       0.000413157804

      target function =      -0.944611757462
              le_mean =     -17.211884522583
             les_mean =     296.529133355313
             stat err =       0.000407792412
             autocorr =       1.238086067727
   target nu stat err =       0.000407792412
   target dn stat err =       0.002158549194
      target stat err =       0.003695266878
              std dev =       0.518297029613
             le_variance =       0.268631810905

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268619964636
                                         uncertainty =       0.001593399205

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268619964636
                                         uncertainty =       0.001593399205

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366493658
  error estimate for blocks of size 2^( 2) =       0.000380039037
  error estimate for blocks of size 2^( 3) =       0.000392158688
  error estimate for blocks of size 2^( 4) =       0.000401143382
  error estimate for blocks of size 2^( 5) =       0.000407354935
  error estimate for blocks of size 2^( 6) =       0.000409518792
  error estimate for blocks of size 2^( 7) =       0.000413159492

      target function =      -0.944596975151
              le_mean =     -17.211884699588
             les_mean =     296.529148253574
             stat err =       0.000407794150
             autocorr =       1.238080986944
   target nu stat err =       0.000407794150
   target dn stat err =       0.002158796987
      target stat err =       0.003695563172
              std dev =       0.518300302333
             le_variance =       0.268635203398

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268623099118
                                         uncertainty =       0.001593192538

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268623099118
                                         uncertainty =       0.001593192538

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366495831
  error estimate for blocks of size 2^( 2) =       0.000380041322
  error estimate for blocks of size 2^( 3) =       0.000392160931
  error estimate for blocks of size 2^( 4) =       0.000401145380
  error estimate for blocks of size 2^( 5) =       0.000407356512
  error estimate for blocks of size 2^( 6) =       0.000409520235
  error estimate for blocks of size 2^( 7) =       0.000413161106

      target function =      -0.944570273328
              le_mean =     -17.211884875914
             les_mean =     296.529170228536
             stat err =       0.000407795808
             autocorr =       1.238076379756
   target nu stat err =       0.000407795808
   target dn stat err =       0.002159229191
      target stat err =       0.003696071467
              std dev =       0.518303374296
             le_variance =       0.268638387806


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.944565288130        initial
     3.5527e+00     3.5527e+01             4.1920e-05        -0.944611757462  <--
     1.4211e+01     1.4211e+02             1.0655e-05        -0.944596975151
     5.6843e+01     5.6843e+02             2.6750e-06        -0.944570273328

*****************************************************************************
Applying the update for shift_i =   3.5527e+00     and shift_s =   3.5527e+01
*****************************************************************************

  Execution time = 2.4998e+01
  </log>
  <optVariables href="H2O.s061.opt.xml">
ci_001                -4.185885e-02 3 1  ON 0
ci_002                -3.205557e-02 3 1  ON 1
ci_003                -2.632991e-02 3 1  ON 2
ci_004                 2.370737e-02 3 1  ON 3
ci_005                 2.406285e-02 3 1  ON 4
ci_006                -2.136589e-02 3 1  ON 5
ci_007                -2.097105e-02 3 1  ON 6
ci_008                -8.511048e-03 3 1  ON 7
ci_009                -1.390320e-02 3 1  ON 8
ci_010                -1.001420e-02 3 1  ON 9
ci_011                -1.117719e-02 3 1  ON 10
ci_012                -9.795459e-03 3 1  ON 11
ci_013                -1.983646e-02 3 1  ON 12
ci_014                 1.229539e-02 3 1  ON 13
ci_015                 1.199402e-02 3 1  ON 14
ci_016                 1.743976e-02 3 1  ON 15
ci_017                 1.637021e-02 3 1  ON 16
ci_018                 1.022145e-02 3 1  ON 17
ci_019                 1.011092e-02 3 1  ON 18
ci_020                 1.776990e-02 3 1  ON 19
ci_021                 1.746360e-02 3 1  ON 20
ci_022                 9.174494e-03 3 1  ON 21
ci_023                 9.197738e-03 3 1  ON 22
ci_024                 9.601206e-03 3 1  ON 23
ci_025                 1.011589e-02 3 1  ON 24
ci_026                 1.157493e-02 3 1  ON 25
ci_027                 1.163080e-02 3 1  ON 26
ci_028                -1.479433e-02 3 1  ON 27
ci_029                -1.644005e-02 3 1  ON 28
ci_030                -9.548815e-03 3 1  ON 29
ci_031                -9.028599e-03 3 1  ON 30
ci_032                -1.473227e-02 3 1  ON 31
ci_033                 5.316303e-03 3 1  ON 32
ci_034                 5.619807e-03 3 1  ON 33
ci_035                -5.089168e-03 3 1  ON 34
ci_036                -1.277360e-02 3 1  ON 35
ci_037                -1.241202e-02 3 1  ON 36
ci_038                 2.030115e-03 3 1  ON 37
ci_039                 1.756375e-03 3 1  ON 38
ci_040                -3.182730e-03 3 1  ON 39
ci_041                 9.395269e-03 3 1  ON 40
ci_042                 8.218309e-03 3 1  ON 41
ci_043                -4.059168e-03 3 1  ON 42
ci_044                -3.914093e-03 3 1  ON 43
ci_045                -3.560105e-03 3 1  ON 44
ci_046                 5.639745e-03 3 1  ON 45
ci_047                 5.554235e-03 3 1  ON 46
ci_048                -1.268621e-02 3 1  ON 47
ci_049                -1.436990e-02 3 1  ON 48
ci_050                 3.153739e-03 3 1  ON 49
ci_051                 2.832800e-03 3 1  ON 50
ci_052                -2.330623e-03 3 1  ON 51
ci_053                -2.440510e-03 3 1  ON 52
ci_054                -3.329834e-03 3 1  ON 53
ci_055                -2.947243e-03 3 1  ON 54
ci_056                 5.565309e-03 3 1  ON 55
ci_057                 5.310583e-03 3 1  ON 56
ci_058                -1.124620e-03 3 1  ON 57
ci_059                -2.142342e-03 3 1  ON 58
ci_060                 4.664520e-03 3 1  ON 59
ci_061                 5.605262e-03 3 1  ON 60
ci_062                -3.752657e-03 3 1  ON 61
ci_063                -3.998122e-03 3 1  ON 62
ci_064                -2.666025e-03 3 1  ON 63
ci_065                -4.349329e-03 3 1  ON 64
ci_066                 4.462305e-03 3 1  ON 65
ci_067                 4.346699e-03 3 1  ON 66
ci_068                -4.222074e-03 3 1  ON 67
ci_069                -4.992235e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1755e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s062 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s062 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=62  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.1524
    reference variance = 0.395937
====================================================
  Execution time = 1.4140e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s062
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5285e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8131e-01
  Total weights = 1.957533627e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4752e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268965316808
                                         uncertainty =       0.001830564629

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268965316808
                                         uncertainty =       0.001830564629

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366724899
  error estimate for blocks of size 2^( 2) =       0.000380436394
  error estimate for blocks of size 2^( 3) =       0.000392617139
  error estimate for blocks of size 2^( 4) =       0.000401256977
  error estimate for blocks of size 2^( 5) =       0.000406199151
  error estimate for blocks of size 2^( 6) =       0.000408870888
  error estimate for blocks of size 2^( 7) =       0.000409092639

      target function =      -0.942674574757
              le_mean =     -17.212074436451
             les_mean =     296.536819945488
             stat err =       0.000406354914
             autocorr =       1.227807372335
   target nu stat err =       0.000406354914
   target dn stat err =       0.003003167369
      target stat err =       0.005074034569
              std dev =       0.518627325534
             le_variance =       0.268974302791


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721207443645e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e-01, overlap shift 8.8818e+00 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942700968787       residual = 9.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942741438463       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942748508003       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942750832389       residual = 6.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942751346762       residual = 1.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942751410140       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942751462954       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942751448272       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942751451628       residual = 3.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942751449518       residual = 6.87e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e-01 is 1.254042e-04

solving harmonic davidson linear method for identity shift 3.5527e+00, overlap shift 3.5527e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942700968787       residual = 9.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942711750997       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942713604660       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942714202954       residual = 5.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942714334964       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942714350260       residual = 3.30e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942714363651       residual = 5.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942714359951       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942714360759       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942714360246       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+00 is 3.283104e-05

solving harmonic davidson linear method for identity shift 1.4211e+01, overlap shift 1.4211e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942700968787       residual = 9.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942703709356       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942704178474       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942704329130       residual = 5.80e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942704362347       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942704366131       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942704369490       residual = 5.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942704368564       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942704368763       residual = 2.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942704368636       residual = 5.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+01 is 8.305761e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.234057 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6624e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
ci_001                -4.184687e-02 3 1  ON 0
ci_002                -3.202914e-02 3 1  ON 1
ci_003                -2.630973e-02 3 1  ON 2
ci_004                 2.369457e-02 3 1  ON 3
ci_005                 2.405178e-02 3 1  ON 4
ci_006                -2.133549e-02 3 1  ON 5
ci_007                -2.093933e-02 3 1  ON 6
ci_008                -8.514528e-03 3 1  ON 7
ci_009                -1.391461e-02 3 1  ON 8
ci_010                -9.999402e-03 3 1  ON 9
ci_011                -1.115584e-02 3 1  ON 10
ci_012                -9.811592e-03 3 1  ON 11
ci_013                -1.986929e-02 3 1  ON 12
ci_014                 1.230294e-02 3 1  ON 13
ci_015                 1.200343e-02 3 1  ON 14
ci_016                 1.742051e-02 3 1  ON 15
ci_017                 1.638578e-02 3 1  ON 16
ci_018                 1.023221e-02 3 1  ON 17
ci_019                 1.010105e-02 3 1  ON 18
ci_020                 1.777214e-02 3 1  ON 19
ci_021                 1.746144e-02 3 1  ON 20
ci_022                 9.178385e-03 3 1  ON 21
ci_023                 9.210383e-03 3 1  ON 22
ci_024                 9.583444e-03 3 1  ON 23
ci_025                 1.010321e-02 3 1  ON 24
ci_026                 1.155182e-02 3 1  ON 25
ci_027                 1.163009e-02 3 1  ON 26
ci_028                -1.480726e-02 3 1  ON 27
ci_029                -1.643344e-02 3 1  ON 28
ci_030                -9.549677e-03 3 1  ON 29
ci_031                -9.014358e-03 3 1  ON 30
ci_032                -1.474427e-02 3 1  ON 31
ci_033                 5.314631e-03 3 1  ON 32
ci_034                 5.629181e-03 3 1  ON 33
ci_035                -5.078012e-03 3 1  ON 34
ci_036                -1.276572e-02 3 1  ON 35
ci_037                -1.242776e-02 3 1  ON 36
ci_038                 2.022771e-03 3 1  ON 37
ci_039                 1.761302e-03 3 1  ON 38
ci_040                -3.179910e-03 3 1  ON 39
ci_041                 9.382441e-03 3 1  ON 40
ci_042                 8.218605e-03 3 1  ON 41
ci_043                -4.055494e-03 3 1  ON 42
ci_044                -3.914754e-03 3 1  ON 43
ci_045                -3.549502e-03 3 1  ON 44
ci_046                 5.643899e-03 3 1  ON 45
ci_047                 5.540400e-03 3 1  ON 46
ci_048                -1.268835e-02 3 1  ON 47
ci_049                -1.435160e-02 3 1  ON 48
ci_050                 3.167098e-03 3 1  ON 49
ci_051                 2.829727e-03 3 1  ON 50
ci_052                -2.346536e-03 3 1  ON 51
ci_053                -2.414984e-03 3 1  ON 52
ci_054                -3.316317e-03 3 1  ON 53
ci_055                -2.934766e-03 3 1  ON 54
ci_056                 5.556443e-03 3 1  ON 55
ci_057                 5.315115e-03 3 1  ON 56
ci_058                -1.148157e-03 3 1  ON 57
ci_059                -2.126591e-03 3 1  ON 58
ci_060                 4.692644e-03 3 1  ON 59
ci_061                 5.622751e-03 3 1  ON 60
ci_062                -3.755621e-03 3 1  ON 61
ci_063                -4.000132e-03 3 1  ON 62
ci_064                -2.676632e-03 3 1  ON 63
ci_065                -4.344322e-03 3 1  ON 64
ci_066                 4.454273e-03 3 1  ON 65
ci_067                 4.349456e-03 3 1  ON 66
ci_068                -4.240790e-03 3 1  ON 67
ci_069                -4.995540e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 62
    time step          = 0.05
    reference energy   = -17.1538
    reference variance = 0.180204
====================================================
  Execution time = 1.3765e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s062
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7695e-01
  Total weights = 1.9570e+06
  Execution time = 1.8141e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266432972204
                                         uncertainty =       0.001560349126

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266432972204
                                         uncertainty =       0.001560349126

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364926512
  error estimate for blocks of size 2^( 2) =       0.000378829759
  error estimate for blocks of size 2^( 3) =       0.000391972597
  error estimate for blocks of size 2^( 4) =       0.000401552604
  error estimate for blocks of size 2^( 5) =       0.000406357023
  error estimate for blocks of size 2^( 6) =       0.000409910759
  error estimate for blocks of size 2^( 7) =       0.000411776068

      target function =      -0.949992499961
              le_mean =     -17.211713496625
             les_mean =     296.520058744651
             stat err =       0.000407399113
             autocorr =       1.246319320206
   target nu stat err =       0.000407399113
   target dn stat err =       0.001912975535
      target stat err =       0.003327490886
              std dev =       0.516084021924
             le_variance =       0.266342717686

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266400879565
                                         uncertainty =       0.001561215230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266400879565
                                         uncertainty =       0.001561215230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364904486
  error estimate for blocks of size 2^( 2) =       0.000378811035
  error estimate for blocks of size 2^( 3) =       0.000391959668
  error estimate for blocks of size 2^( 4) =       0.000401544827
  error estimate for blocks of size 2^( 5) =       0.000406350711
  error estimate for blocks of size 2^( 6) =       0.000409899418
  error estimate for blocks of size 2^( 7) =       0.000411765919

      target function =      -0.937279304692
              le_mean =     -17.211714816934
             les_mean =     296.527599557723
             stat err =       0.000407390219
             autocorr =       1.246415352649
   target nu stat err =       0.000407390219
   target dn stat err =       0.007646826138
      target stat err =       0.012656519750
              std dev =       0.516052873374
             le_variance =       0.266310568118

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266414751977
                                         uncertainty =       0.001560733649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266414751977
                                         uncertainty =       0.001560733649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364914010
  error estimate for blocks of size 2^( 2) =       0.000378818845
  error estimate for blocks of size 2^( 3) =       0.000391964691
  error estimate for blocks of size 2^( 4) =       0.000401546990
  error estimate for blocks of size 2^( 5) =       0.000406352059
  error estimate for blocks of size 2^( 6) =       0.000409903163
  error estimate for blocks of size 2^( 7) =       0.000411769638

      target function =      -0.950010351899
              le_mean =     -17.211713756277
             les_mean =     296.520057143161
             stat err =       0.000407392963
             autocorr =       1.246367086117
   target nu stat err =       0.000407392963
   target dn stat err =       0.001916578272
      target stat err =       0.003333579678
              std dev =       0.516066341350
             le_variance =       0.266324468674

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266430556937
                                         uncertainty =       0.001560396474

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266430556937
                                         uncertainty =       0.001560396474

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364924854
  error estimate for blocks of size 2^( 2) =       0.000378828305
  error estimate for blocks of size 2^( 3) =       0.000391971524
  error estimate for blocks of size 2^( 4) =       0.000401551822
  error estimate for blocks of size 2^( 5) =       0.000406356314
  error estimate for blocks of size 2^( 6) =       0.000409909712
  error estimate for blocks of size 2^( 7) =       0.000411775163

      target function =      -0.950023451358
              le_mean =     -17.211713513708
             les_mean =     296.520041095666
             stat err =       0.000407398253
             autocorr =       1.246325374152
   target nu stat err =       0.000407398253
   target dn stat err =       0.001913246815
      target stat err =       0.003328151636
              std dev =       0.516081678424
             le_variance =       0.266340298805


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949992499961        initial
     8.8818e-01     8.8818e+00             1.2540e-04        -0.937279304692
     3.5527e+00     3.5527e+01             3.2831e-05        -0.950010351899
     1.4211e+01     1.4211e+02             8.3058e-06        -0.950023451358  <--

*****************************************************************************
Applying the update for shift_i =   1.4211e+01     and shift_s =   1.4211e+02
*****************************************************************************

  Execution time = 2.2951e+01
  </log>
  <optVariables href="H2O.s062.opt.xml">
ci_001                -4.185582e-02 3 1  ON 0
ci_002                -3.204887e-02 3 1  ON 1
ci_003                -2.632479e-02 3 1  ON 2
ci_004                 2.370414e-02 3 1  ON 3
ci_005                 2.406004e-02 3 1  ON 4
ci_006                -2.135819e-02 3 1  ON 5
ci_007                -2.096302e-02 3 1  ON 6
ci_008                -8.511933e-03 3 1  ON 7
ci_009                -1.390610e-02 3 1  ON 8
ci_010                -1.001045e-02 3 1  ON 9
ci_011                -1.117177e-02 3 1  ON 10
ci_012                -9.799555e-03 3 1  ON 11
ci_013                -1.984476e-02 3 1  ON 12
ci_014                 1.229730e-02 3 1  ON 13
ci_015                 1.199641e-02 3 1  ON 14
ci_016                 1.743488e-02 3 1  ON 15
ci_017                 1.637415e-02 3 1  ON 16
ci_018                 1.022419e-02 3 1  ON 17
ci_019                 1.010841e-02 3 1  ON 18
ci_020                 1.777047e-02 3 1  ON 19
ci_021                 1.746304e-02 3 1  ON 20
ci_022                 9.175475e-03 3 1  ON 21
ci_023                 9.200951e-03 3 1  ON 22
ci_024                 9.596703e-03 3 1  ON 23
ci_025                 1.011268e-02 3 1  ON 24
ci_026                 1.156907e-02 3 1  ON 25
ci_027                 1.163062e-02 3 1  ON 26
ci_028                -1.479761e-02 3 1  ON 27
ci_029                -1.643837e-02 3 1  ON 28
ci_030                -9.549034e-03 3 1  ON 29
ci_031                -9.024988e-03 3 1  ON 30
ci_032                -1.473532e-02 3 1  ON 31
ci_033                 5.315877e-03 3 1  ON 32
ci_034                 5.622185e-03 3 1  ON 33
ci_035                -5.086334e-03 3 1  ON 34
ci_036                -1.277160e-02 3 1  ON 35
ci_037                -1.241602e-02 3 1  ON 36
ci_038                 2.028248e-03 3 1  ON 37
ci_039                 1.757627e-03 3 1  ON 38
ci_040                -3.182013e-03 3 1  ON 39
ci_041                 9.392004e-03 3 1  ON 40
ci_042                 8.218383e-03 3 1  ON 41
ci_043                -4.058235e-03 3 1  ON 42
ci_044                -3.914262e-03 3 1  ON 43
ci_045                -3.557410e-03 3 1  ON 44
ci_046                 5.640798e-03 3 1  ON 45
ci_047                 5.550725e-03 3 1  ON 46
ci_048                -1.268675e-02 3 1  ON 47
ci_049                -1.436526e-02 3 1  ON 48
ci_050                 3.157138e-03 3 1  ON 49
ci_051                 2.832018e-03 3 1  ON 50
ci_052                -2.334670e-03 3 1  ON 51
ci_053                -2.434023e-03 3 1  ON 52
ci_054                -3.326403e-03 3 1  ON 53
ci_055                -2.944075e-03 3 1  ON 54
ci_056                 5.563057e-03 3 1  ON 55
ci_057                 5.311734e-03 3 1  ON 56
ci_058                -1.130604e-03 3 1  ON 57
ci_059                -2.138341e-03 3 1  ON 58
ci_060                 4.671655e-03 3 1  ON 59
ci_061                 5.609700e-03 3 1  ON 60
ci_062                -3.753413e-03 3 1  ON 61
ci_063                -3.998635e-03 3 1  ON 62
ci_064                -2.668722e-03 3 1  ON 63
ci_065                -4.348056e-03 3 1  ON 64
ci_066                 4.460264e-03 3 1  ON 65
ci_067                 4.347400e-03 3 1  ON 66
ci_068                -4.226822e-03 3 1  ON 67
ci_069                -4.993073e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9582e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s063 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s063 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=63  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.2432
    reference variance = 0.504446
====================================================
  Execution time = 1.4284e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s063
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8204e-01
  Total weights = 1.957387130e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4807e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268777669044
                                         uncertainty =       0.001494819385

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268777669044
                                         uncertainty =       0.001494819385

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366605944
  error estimate for blocks of size 2^( 2) =       0.000380241080
  error estimate for blocks of size 2^( 3) =       0.000392732765
  error estimate for blocks of size 2^( 4) =       0.000401766421
  error estimate for blocks of size 2^( 5) =       0.000406602087
  error estimate for blocks of size 2^( 6) =       0.000409739276
  error estimate for blocks of size 2^( 7) =       0.000411116770

      target function =      -0.941473676524
              le_mean =     -17.211668196728
             les_mean =     296.523559288417
             stat err =       0.000407306138
             autocorr =       1.234363033789
   target nu stat err =       0.000407306138
   target dn stat err =       0.002501013946
      target stat err =       0.004230783402
              std dev =       0.518459097589
             le_variance =       0.268799835873


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721166819673e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+00, overlap shift 3.5527e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941491596524       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941507296690       residual = 2.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941509557617       residual = 4.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941510403543       residual = 8.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941510469702       residual = 2.02e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941510461345       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941510469250       residual = 7.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941510469179       residual = 1.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941510469069       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941510468693       residual = 5.53e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+00 is 4.093195e-05

solving harmonic davidson linear method for identity shift 1.4211e+01, overlap shift 1.4211e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941491596524       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941495589028       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941496161763       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941496375274       residual = 8.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941496391610       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941496389534       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941496391516       residual = 7.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941496391487       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941496391457       residual = 2.16e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941496391367       residual = 5.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+01 is 1.039243e-05

solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941491596524       residual = 1.63e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941492598958       residual = 2.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941492742618       residual = 4.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941492796123       residual = 8.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941492800194       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941492799676       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941492800172       residual = 7.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941492800164       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941492800156       residual = 2.14e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941492800134       residual = 5.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+01 is 2.608269e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.237566 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6774e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
ci_001                -4.184766e-02 3 1  ON 0
ci_002                -3.204395e-02 3 1  ON 1
ci_003                -2.632471e-02 3 1  ON 2
ci_004                 2.370368e-02 3 1  ON 3
ci_005                 2.405797e-02 3 1  ON 4
ci_006                -2.135205e-02 3 1  ON 5
ci_007                -2.095985e-02 3 1  ON 6
ci_008                -8.507638e-03 3 1  ON 7
ci_009                -1.391431e-02 3 1  ON 8
ci_010                -1.000614e-02 3 1  ON 9
ci_011                -1.116138e-02 3 1  ON 10
ci_012                -9.806923e-03 3 1  ON 11
ci_013                -1.984511e-02 3 1  ON 12
ci_014                 1.229967e-02 3 1  ON 13
ci_015                 1.199635e-02 3 1  ON 14
ci_016                 1.743253e-02 3 1  ON 15
ci_017                 1.637583e-02 3 1  ON 16
ci_018                 1.022536e-02 3 1  ON 17
ci_019                 1.011035e-02 3 1  ON 18
ci_020                 1.776725e-02 3 1  ON 19
ci_021                 1.746132e-02 3 1  ON 20
ci_022                 9.174286e-03 3 1  ON 21
ci_023                 9.200685e-03 3 1  ON 22
ci_024                 9.595517e-03 3 1  ON 23
ci_025                 1.010334e-02 3 1  ON 24
ci_026                 1.157095e-02 3 1  ON 25
ci_027                 1.162430e-02 3 1  ON 26
ci_028                -1.479661e-02 3 1  ON 27
ci_029                -1.642915e-02 3 1  ON 28
ci_030                -9.556667e-03 3 1  ON 29
ci_031                -9.023615e-03 3 1  ON 30
ci_032                -1.473497e-02 3 1  ON 31
ci_033                 5.317344e-03 3 1  ON 32
ci_034                 5.625111e-03 3 1  ON 33
ci_035                -5.085498e-03 3 1  ON 34
ci_036                -1.276483e-02 3 1  ON 35
ci_037                -1.242203e-02 3 1  ON 36
ci_038                 2.028230e-03 3 1  ON 37
ci_039                 1.762091e-03 3 1  ON 38
ci_040                -3.180152e-03 3 1  ON 39
ci_041                 9.389999e-03 3 1  ON 40
ci_042                 8.223723e-03 3 1  ON 41
ci_043                -4.057536e-03 3 1  ON 42
ci_044                -3.914230e-03 3 1  ON 43
ci_045                -3.555271e-03 3 1  ON 44
ci_046                 5.641990e-03 3 1  ON 45
ci_047                 5.549301e-03 3 1  ON 46
ci_048                -1.268805e-02 3 1  ON 47
ci_049                -1.435980e-02 3 1  ON 48
ci_050                 3.153417e-03 3 1  ON 49
ci_051                 2.834529e-03 3 1  ON 50
ci_052                -2.334754e-03 3 1  ON 51
ci_053                -2.434494e-03 3 1  ON 52
ci_054                -3.321208e-03 3 1  ON 53
ci_055                -2.939681e-03 3 1  ON 54
ci_056                 5.560450e-03 3 1  ON 55
ci_057                 5.309854e-03 3 1  ON 56
ci_058                -1.132647e-03 3 1  ON 57
ci_059                -2.135551e-03 3 1  ON 58
ci_060                 4.673487e-03 3 1  ON 59
ci_061                 5.612624e-03 3 1  ON 60
ci_062                -3.752446e-03 3 1  ON 61
ci_063                -3.998220e-03 3 1  ON 62
ci_064                -2.673363e-03 3 1  ON 63
ci_065                -4.345941e-03 3 1  ON 64
ci_066                 4.460592e-03 3 1  ON 65
ci_067                 4.349150e-03 3 1  ON 66
ci_068                -4.228405e-03 3 1  ON 67
ci_069                -4.994021e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 63
    time step          = 0.05
    reference energy   = -17.2691
    reference variance = 0.237091
====================================================
  Execution time = 1.3721e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s063
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8075e-01
  Total weights = 1.9574e+06
  Execution time = 1.8160e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267707621198
                                         uncertainty =       0.001679473222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267707621198
                                         uncertainty =       0.001679473222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365840375
  error estimate for blocks of size 2^( 2) =       0.000379687979
  error estimate for blocks of size 2^( 3) =       0.000392245476
  error estimate for blocks of size 2^( 4) =       0.000400701964
  error estimate for blocks of size 2^( 5) =       0.000406478166
  error estimate for blocks of size 2^( 6) =       0.000410556725
  error estimate for blocks of size 2^( 7) =       0.000414566448

      target function =      -0.943608632740
              le_mean =     -17.211873488112
             les_mean =     296.529347483117
             stat err =       0.000408075826
             autocorr =       1.244223699704
   target nu stat err =       0.000408075826
   target dn stat err =       0.002655014386
      target stat err =       0.004506006375
              std dev =       0.517376419979
             le_variance =       0.267678359951

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267697715574
                                         uncertainty =       0.001679322758

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267697715574
                                         uncertainty =       0.001679322758

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365833694
  error estimate for blocks of size 2^( 2) =       0.000379682850
  error estimate for blocks of size 2^( 3) =       0.000392242051
  error estimate for blocks of size 2^( 4) =       0.000400700228
  error estimate for blocks of size 2^( 5) =       0.000406476913
  error estimate for blocks of size 2^( 6) =       0.000410556774
  error estimate for blocks of size 2^( 7) =       0.000414568399

      target function =      -0.943587230721
              le_mean =     -17.211873452461
             les_mean =     296.529359009114
             stat err =       0.000408075579
             autocorr =       1.244267637789
   target nu stat err =       0.000408075579
   target dn stat err =       0.002657538052
      target stat err =       0.004509976677
              std dev =       0.517366971462
             le_variance =       0.267668583159

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267702514750
                                         uncertainty =       0.001679394312

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267702514750
                                         uncertainty =       0.001679394312

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365836930
  error estimate for blocks of size 2^( 2) =       0.000379685321
  error estimate for blocks of size 2^( 3) =       0.000392243683
  error estimate for blocks of size 2^( 4) =       0.000400701028
  error estimate for blocks of size 2^( 5) =       0.000406477479
  error estimate for blocks of size 2^( 6) =       0.000410556700
  error estimate for blocks of size 2^( 7) =       0.000414567383

      target function =      -0.943624879427
              le_mean =     -17.211873459129
             les_mean =     296.529336777529
             stat err =       0.000408075648
             autocorr =       1.244246044685
   target nu stat err =       0.000408075648
   target dn stat err =       0.002655901681
      target stat err =       0.004507626336
              std dev =       0.517371548189
             le_variance =       0.267673318876

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267706971725
                                         uncertainty =       0.001679463115

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267706971725
                                         uncertainty =       0.001679463115

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365839937
  error estimate for blocks of size 2^( 2) =       0.000379687639
  error estimate for blocks of size 2^( 3) =       0.000392245245
  error estimate for blocks of size 2^( 4) =       0.000400701840
  error estimate for blocks of size 2^( 5) =       0.000406478075
  error estimate for blocks of size 2^( 6) =       0.000410556717
  error estimate for blocks of size 2^( 7) =       0.000414566560

      target function =      -0.943613302672
              le_mean =     -17.211873483324
             les_mean =     296.529344529660
             stat err =       0.000408075798
             autocorr =       1.244226510951
   target nu stat err =       0.000408075798
   target dn stat err =       0.002655079806
      target stat err =       0.004506158516
              std dev =       0.517375800235
             le_variance =       0.267677718669


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943608632740        initial
     3.5527e+00     3.5527e+01             4.0932e-05        -0.943587230721
     1.4211e+01     1.4211e+02             1.0392e-05        -0.943624879427  <--
     5.6843e+01     5.6843e+02             2.6083e-06        -0.943613302672

*****************************************************************************
Applying the update for shift_i =   1.4211e+01     and shift_s =   1.4211e+02
*****************************************************************************

  Execution time = 2.2901e+01
  </log>
  <optVariables href="H2O.s063.opt.xml">
ci_001                -4.184766e-02 3 1  ON 0
ci_002                -3.204395e-02 3 1  ON 1
ci_003                -2.632471e-02 3 1  ON 2
ci_004                 2.370368e-02 3 1  ON 3
ci_005                 2.405797e-02 3 1  ON 4
ci_006                -2.135205e-02 3 1  ON 5
ci_007                -2.095985e-02 3 1  ON 6
ci_008                -8.507638e-03 3 1  ON 7
ci_009                -1.391431e-02 3 1  ON 8
ci_010                -1.000614e-02 3 1  ON 9
ci_011                -1.116138e-02 3 1  ON 10
ci_012                -9.806923e-03 3 1  ON 11
ci_013                -1.984511e-02 3 1  ON 12
ci_014                 1.229967e-02 3 1  ON 13
ci_015                 1.199635e-02 3 1  ON 14
ci_016                 1.743253e-02 3 1  ON 15
ci_017                 1.637583e-02 3 1  ON 16
ci_018                 1.022536e-02 3 1  ON 17
ci_019                 1.011035e-02 3 1  ON 18
ci_020                 1.776725e-02 3 1  ON 19
ci_021                 1.746132e-02 3 1  ON 20
ci_022                 9.174286e-03 3 1  ON 21
ci_023                 9.200685e-03 3 1  ON 22
ci_024                 9.595517e-03 3 1  ON 23
ci_025                 1.010334e-02 3 1  ON 24
ci_026                 1.157095e-02 3 1  ON 25
ci_027                 1.162430e-02 3 1  ON 26
ci_028                -1.479661e-02 3 1  ON 27
ci_029                -1.642915e-02 3 1  ON 28
ci_030                -9.556667e-03 3 1  ON 29
ci_031                -9.023615e-03 3 1  ON 30
ci_032                -1.473497e-02 3 1  ON 31
ci_033                 5.317344e-03 3 1  ON 32
ci_034                 5.625111e-03 3 1  ON 33
ci_035                -5.085498e-03 3 1  ON 34
ci_036                -1.276483e-02 3 1  ON 35
ci_037                -1.242203e-02 3 1  ON 36
ci_038                 2.028230e-03 3 1  ON 37
ci_039                 1.762091e-03 3 1  ON 38
ci_040                -3.180152e-03 3 1  ON 39
ci_041                 9.389999e-03 3 1  ON 40
ci_042                 8.223723e-03 3 1  ON 41
ci_043                -4.057536e-03 3 1  ON 42
ci_044                -3.914230e-03 3 1  ON 43
ci_045                -3.555271e-03 3 1  ON 44
ci_046                 5.641990e-03 3 1  ON 45
ci_047                 5.549301e-03 3 1  ON 46
ci_048                -1.268805e-02 3 1  ON 47
ci_049                -1.435980e-02 3 1  ON 48
ci_050                 3.153417e-03 3 1  ON 49
ci_051                 2.834529e-03 3 1  ON 50
ci_052                -2.334754e-03 3 1  ON 51
ci_053                -2.434494e-03 3 1  ON 52
ci_054                -3.321208e-03 3 1  ON 53
ci_055                -2.939681e-03 3 1  ON 54
ci_056                 5.560450e-03 3 1  ON 55
ci_057                 5.309854e-03 3 1  ON 56
ci_058                -1.132647e-03 3 1  ON 57
ci_059                -2.135551e-03 3 1  ON 58
ci_060                 4.673487e-03 3 1  ON 59
ci_061                 5.612624e-03 3 1  ON 60
ci_062                -3.752446e-03 3 1  ON 61
ci_063                -3.998220e-03 3 1  ON 62
ci_064                -2.673363e-03 3 1  ON 63
ci_065                -4.345941e-03 3 1  ON 64
ci_066                 4.460592e-03 3 1  ON 65
ci_067                 4.349150e-03 3 1  ON 66
ci_068                -4.228405e-03 3 1  ON 67
ci_069                -4.994021e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9681e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s064 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s064 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=64  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7213e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.1225
    reference variance = 0.150136
====================================================
  Execution time = 1.4090e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s064
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7430e-01
  Total weights = 1.957361252e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4939e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264291078383
                                         uncertainty =       0.001543390359

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264291078383
                                         uncertainty =       0.001543390359

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363560996
  error estimate for blocks of size 2^( 2) =       0.000377083643
  error estimate for blocks of size 2^( 3) =       0.000389850988
  error estimate for blocks of size 2^( 4) =       0.000398815030
  error estimate for blocks of size 2^( 5) =       0.000404358290
  error estimate for blocks of size 2^( 6) =       0.000408583588
  error estimate for blocks of size 2^( 7) =       0.000410428556

      target function =      -0.954569514107
              le_mean =     -17.211838850797
             les_mean =     296.521693392258
             stat err =       0.000405546366
             autocorr =       1.244303894333
   target nu stat err =       0.000405546366
   target dn stat err =       0.001713416290
      target stat err =       0.003025904542
              std dev =       0.514152890654
             le_variance =       0.264353194968


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721183885080e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+00, overlap shift 3.5527e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.954578019840       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.954599608289       residual = 2.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.954601900371       residual = 4.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.954602997878       residual = 6.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.954603069875       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.954603103937       residual = 2.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.954603116643       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.954603118235       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.954603123931       residual = 2.30e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.954603125838       residual = 3.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+00 is 4.239788e-05

solving harmonic davidson linear method for identity shift 1.4211e+01, overlap shift 1.4211e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.954578019840       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.954583510004       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.954584091515       residual = 4.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.954584368646       residual = 6.22e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.954584386619       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.954584395155       residual = 2.75e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.954584398351       residual = 5.43e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.954584398739       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.954584400161       residual = 2.22e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.954584400638       residual = 3.60e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+01 is 1.075825e-05

solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.954578019840       residual = 2.09e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.954579398323       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.954579544241       residual = 4.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.954579613697       residual = 6.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.954579618188       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.954579620324       residual = 2.74e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.954579621124       residual = 5.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.954579621220       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.954579621576       residual = 2.20e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.954579621695       residual = 3.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+01 is 2.699676e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.241038 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6593e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
ci_001                -4.184423e-02 3 1  ON 0
ci_002                -3.204454e-02 3 1  ON 1
ci_003                -2.632398e-02 3 1  ON 2
ci_004                 2.369798e-02 3 1  ON 3
ci_005                 2.405932e-02 3 1  ON 4
ci_006                -2.134626e-02 3 1  ON 5
ci_007                -2.096176e-02 3 1  ON 6
ci_008                -8.510950e-03 3 1  ON 7
ci_009                -1.391902e-02 3 1  ON 8
ci_010                -1.000533e-02 3 1  ON 9
ci_011                -1.115668e-02 3 1  ON 10
ci_012                -9.811068e-03 3 1  ON 11
ci_013                -1.984097e-02 3 1  ON 12
ci_014                 1.230350e-02 3 1  ON 13
ci_015                 1.199989e-02 3 1  ON 14
ci_016                 1.742435e-02 3 1  ON 15
ci_017                 1.637418e-02 3 1  ON 16
ci_018                 1.021924e-02 3 1  ON 17
ci_019                 1.011729e-02 3 1  ON 18
ci_020                 1.776052e-02 3 1  ON 19
ci_021                 1.745721e-02 3 1  ON 20
ci_022                 9.169241e-03 3 1  ON 21
ci_023                 9.202786e-03 3 1  ON 22
ci_024                 9.592572e-03 3 1  ON 23
ci_025                 1.010570e-02 3 1  ON 24
ci_026                 1.157417e-02 3 1  ON 25
ci_027                 1.161751e-02 3 1  ON 26
ci_028                -1.480158e-02 3 1  ON 27
ci_029                -1.642651e-02 3 1  ON 28
ci_030                -9.556902e-03 3 1  ON 29
ci_031                -9.029239e-03 3 1  ON 30
ci_032                -1.473490e-02 3 1  ON 31
ci_033                 5.317770e-03 3 1  ON 32
ci_034                 5.628121e-03 3 1  ON 33
ci_035                -5.083139e-03 3 1  ON 34
ci_036                -1.276690e-02 3 1  ON 35
ci_037                -1.242788e-02 3 1  ON 36
ci_038                 2.024199e-03 3 1  ON 37
ci_039                 1.763252e-03 3 1  ON 38
ci_040                -3.178318e-03 3 1  ON 39
ci_041                 9.379546e-03 3 1  ON 40
ci_042                 8.226844e-03 3 1  ON 41
ci_043                -4.056835e-03 3 1  ON 42
ci_044                -3.914990e-03 3 1  ON 43
ci_045                -3.551250e-03 3 1  ON 44
ci_046                 5.639100e-03 3 1  ON 45
ci_047                 5.545816e-03 3 1  ON 46
ci_048                -1.268508e-02 3 1  ON 47
ci_049                -1.434904e-02 3 1  ON 48
ci_050                 3.152966e-03 3 1  ON 49
ci_051                 2.835242e-03 3 1  ON 50
ci_052                -2.341573e-03 3 1  ON 51
ci_053                -2.435012e-03 3 1  ON 52
ci_054                -3.313313e-03 3 1  ON 53
ci_055                -2.936107e-03 3 1  ON 54
ci_056                 5.557636e-03 3 1  ON 55
ci_057                 5.310246e-03 3 1  ON 56
ci_058                -1.135601e-03 3 1  ON 57
ci_059                -2.138146e-03 3 1  ON 58
ci_060                 4.679486e-03 3 1  ON 59
ci_061                 5.615570e-03 3 1  ON 60
ci_062                -3.754799e-03 3 1  ON 61
ci_063                -3.996723e-03 3 1  ON 62
ci_064                -2.679919e-03 3 1  ON 63
ci_065                -4.346661e-03 3 1  ON 64
ci_066                 4.460917e-03 3 1  ON 65
ci_067                 4.348419e-03 3 1  ON 66
ci_068                -4.233354e-03 3 1  ON 67
ci_069                -4.992854e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 64
    time step          = 0.05
    reference energy   = -17.2151
    reference variance = 0.482882
====================================================
  Execution time = 1.3852e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s064
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8123e-01
  Total weights = 1.9572e+06
  Execution time = 1.8272e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266050280670
                                         uncertainty =       0.001472979782

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266050280670
                                         uncertainty =       0.001472979782

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364766026
  error estimate for blocks of size 2^( 2) =       0.000378671660
  error estimate for blocks of size 2^( 3) =       0.000391534770
  error estimate for blocks of size 2^( 4) =       0.000400905853
  error estimate for blocks of size 2^( 5) =       0.000405856502
  error estimate for blocks of size 2^( 6) =       0.000409254835
  error estimate for blocks of size 2^( 7) =       0.000409883153

      target function =      -0.942789088515
              le_mean =     -17.212325843194
             les_mean =     296.545398528018
             stat err =       0.000406475086
             autocorr =       1.241764098326
   target nu stat err =       0.000406475086
   target dn stat err =       0.003683713057
      target stat err =       0.006207300879
              std dev =       0.515857061179
             le_variance =       0.266108507568

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266036693424
                                         uncertainty =       0.001471593884

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266036693424
                                         uncertainty =       0.001471593884

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364756890
  error estimate for blocks of size 2^( 2) =       0.000378661290
  error estimate for blocks of size 2^( 3) =       0.000391523920
  error estimate for blocks of size 2^( 4) =       0.000400895527
  error estimate for blocks of size 2^( 5) =       0.000405846274
  error estimate for blocks of size 2^( 6) =       0.000409243240
  error estimate for blocks of size 2^( 7) =       0.000409872815

      target function =      -0.938834132100
              le_mean =     -17.212326045644
             les_mean =     296.547770903998
             stat err =       0.000406464464
             autocorr =       1.241761404648
   target nu stat err =       0.000406464464
   target dn stat err =       0.004242411063
      target stat err =       0.007077499667
              std dev =       0.515844140312
             le_variance =       0.266095177094

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266043263919
                                         uncertainty =       0.001472270459

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266043263919
                                         uncertainty =       0.001472270459

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364761306
  error estimate for blocks of size 2^( 2) =       0.000378666305
  error estimate for blocks of size 2^( 3) =       0.000391529169
  error estimate for blocks of size 2^( 4) =       0.000400900525
  error estimate for blocks of size 2^( 5) =       0.000405851229
  error estimate for blocks of size 2^( 6) =       0.000409248945
  error estimate for blocks of size 2^( 7) =       0.000409877893

      target function =      -0.942800192139
              le_mean =     -17.212325918290
             les_mean =     296.545394519045
             stat err =       0.000406469648
             autocorr =       1.241763006680
   target nu stat err =       0.000406469648
   target dn stat err =       0.003680612663
      target stat err =       0.006202291552
              std dev =       0.515850386607
             le_variance =       0.266101621363

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266049387649
                                         uncertainty =       0.001472890246

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266049387649
                                         uncertainty =       0.001472890246

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364765425
  error estimate for blocks of size 2^( 2) =       0.000378670979
  error estimate for blocks of size 2^( 3) =       0.000391534058
  error estimate for blocks of size 2^( 4) =       0.000400905176
  error estimate for blocks of size 2^( 5) =       0.000405855832
  error estimate for blocks of size 2^( 6) =       0.000409254088
  error estimate for blocks of size 2^( 7) =       0.000409882485

      target function =      -0.942791779235
              le_mean =     -17.212325851261
             les_mean =     296.545397203092
             stat err =       0.000406474395
             autocorr =       1.241763967857
   target nu stat err =       0.000406474395
   target dn stat err =       0.003683318103
      target stat err =       0.006206679434
              std dev =       0.515856211496
             le_variance =       0.266107630939


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942789088515        initial
     3.5527e+00     3.5527e+01             4.2398e-05        -0.938834132100
     1.4211e+01     1.4211e+02             1.0758e-05        -0.942800192139  <--
     5.6843e+01     5.6843e+02             2.6997e-06        -0.942791779235

*****************************************************************************
Applying the update for shift_i =   1.4211e+01     and shift_s =   1.4211e+02
*****************************************************************************

  Execution time = 2.7130e+01
  </log>
  <optVariables href="H2O.s064.opt.xml">
ci_001                -4.184423e-02 3 1  ON 0
ci_002                -3.204454e-02 3 1  ON 1
ci_003                -2.632398e-02 3 1  ON 2
ci_004                 2.369798e-02 3 1  ON 3
ci_005                 2.405932e-02 3 1  ON 4
ci_006                -2.134626e-02 3 1  ON 5
ci_007                -2.096176e-02 3 1  ON 6
ci_008                -8.510950e-03 3 1  ON 7
ci_009                -1.391902e-02 3 1  ON 8
ci_010                -1.000533e-02 3 1  ON 9
ci_011                -1.115668e-02 3 1  ON 10
ci_012                -9.811068e-03 3 1  ON 11
ci_013                -1.984097e-02 3 1  ON 12
ci_014                 1.230350e-02 3 1  ON 13
ci_015                 1.199989e-02 3 1  ON 14
ci_016                 1.742435e-02 3 1  ON 15
ci_017                 1.637418e-02 3 1  ON 16
ci_018                 1.021924e-02 3 1  ON 17
ci_019                 1.011729e-02 3 1  ON 18
ci_020                 1.776052e-02 3 1  ON 19
ci_021                 1.745721e-02 3 1  ON 20
ci_022                 9.169241e-03 3 1  ON 21
ci_023                 9.202786e-03 3 1  ON 22
ci_024                 9.592572e-03 3 1  ON 23
ci_025                 1.010570e-02 3 1  ON 24
ci_026                 1.157417e-02 3 1  ON 25
ci_027                 1.161751e-02 3 1  ON 26
ci_028                -1.480158e-02 3 1  ON 27
ci_029                -1.642651e-02 3 1  ON 28
ci_030                -9.556902e-03 3 1  ON 29
ci_031                -9.029239e-03 3 1  ON 30
ci_032                -1.473490e-02 3 1  ON 31
ci_033                 5.317770e-03 3 1  ON 32
ci_034                 5.628121e-03 3 1  ON 33
ci_035                -5.083139e-03 3 1  ON 34
ci_036                -1.276690e-02 3 1  ON 35
ci_037                -1.242788e-02 3 1  ON 36
ci_038                 2.024199e-03 3 1  ON 37
ci_039                 1.763252e-03 3 1  ON 38
ci_040                -3.178318e-03 3 1  ON 39
ci_041                 9.379546e-03 3 1  ON 40
ci_042                 8.226844e-03 3 1  ON 41
ci_043                -4.056835e-03 3 1  ON 42
ci_044                -3.914990e-03 3 1  ON 43
ci_045                -3.551250e-03 3 1  ON 44
ci_046                 5.639100e-03 3 1  ON 45
ci_047                 5.545816e-03 3 1  ON 46
ci_048                -1.268508e-02 3 1  ON 47
ci_049                -1.434904e-02 3 1  ON 48
ci_050                 3.152966e-03 3 1  ON 49
ci_051                 2.835242e-03 3 1  ON 50
ci_052                -2.341573e-03 3 1  ON 51
ci_053                -2.435012e-03 3 1  ON 52
ci_054                -3.313313e-03 3 1  ON 53
ci_055                -2.936107e-03 3 1  ON 54
ci_056                 5.557636e-03 3 1  ON 55
ci_057                 5.310246e-03 3 1  ON 56
ci_058                -1.135601e-03 3 1  ON 57
ci_059                -2.138146e-03 3 1  ON 58
ci_060                 4.679486e-03 3 1  ON 59
ci_061                 5.615570e-03 3 1  ON 60
ci_062                -3.754799e-03 3 1  ON 61
ci_063                -3.996723e-03 3 1  ON 62
ci_064                -2.679919e-03 3 1  ON 63
ci_065                -4.346661e-03 3 1  ON 64
ci_066                 4.460917e-03 3 1  ON 65
ci_067                 4.348419e-03 3 1  ON 66
ci_068                -4.233354e-03 3 1  ON 67
ci_069                -4.992854e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.3729e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s065 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s065 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=65  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.171
    reference variance = 0.182453
====================================================
  Execution time = 1.4014e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s065
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8027e-01
  Total weights = 1.957392927e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4888e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269536553168
                                         uncertainty =       0.001369247388

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269536553168
                                         uncertainty =       0.001369247388

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367067333
  error estimate for blocks of size 2^( 2) =       0.000380893049
  error estimate for blocks of size 2^( 3) =       0.000393518853
  error estimate for blocks of size 2^( 4) =       0.000401903303
  error estimate for blocks of size 2^( 5) =       0.000407131144
  error estimate for blocks of size 2^( 6) =       0.000410996805
  error estimate for blocks of size 2^( 7) =       0.000413278594

      target function =      -0.944434464561
              le_mean =     -17.211109053893
             les_mean =     296.502541552151
             stat err =       0.000408327461
             autocorr =       1.237444431106
   target nu stat err =       0.000408327461
   target dn stat err =       0.002116168600
      target stat err =       0.003619105788
              std dev =       0.519111600153
             le_variance =       0.269476853413


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721110905389e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.5527e+00, overlap shift 3.5527e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944447166698       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944460846204       residual = 2.93e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944464370695       residual = 5.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944465281836       residual = 6.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944465388168       residual = 2.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944465393365       residual = 3.71e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944465389373       residual = 8.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944465395476       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944465397383       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944465398263       residual = 5.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+00 is 5.313799e-05

solving harmonic davidson linear method for identity shift 1.4211e+01, overlap shift 1.4211e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944447166698       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944450645428       residual = 2.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944451538539       residual = 5.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944451768187       residual = 6.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944451794945       residual = 1.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944451796067       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944451795123       residual = 8.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944451796626       residual = 2.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944451797100       residual = 3.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944451797318       residual = 5.35e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+01 is 1.349328e-05

solving harmonic davidson linear method for identity shift 5.6843e+01, overlap shift 5.6843e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944447166698       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944448040138       residual = 2.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944448264178       residual = 5.42e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944448321707       residual = 6.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944448328407       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944448328676       residual = 3.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944448328444       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944448328818       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944448328936       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944448328991       residual = 5.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.6843e+01 is 3.386626e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.244483 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6511e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
ci_001                -4.183872e-02 3 1  ON 0
ci_002                -3.203945e-02 3 1  ON 1
ci_003                -2.632058e-02 3 1  ON 2
ci_004                 2.369501e-02 3 1  ON 3
ci_005                 2.405151e-02 3 1  ON 4
ci_006                -2.134496e-02 3 1  ON 5
ci_007                -2.096312e-02 3 1  ON 6
ci_008                -8.510061e-03 3 1  ON 7
ci_009                -1.392495e-02 3 1  ON 8
ci_010                -1.000169e-02 3 1  ON 9
ci_011                -1.114318e-02 3 1  ON 10
ci_012                -9.811868e-03 3 1  ON 11
ci_013                -1.984178e-02 3 1  ON 12
ci_014                 1.230870e-02 3 1  ON 13
ci_015                 1.200550e-02 3 1  ON 14
ci_016                 1.741809e-02 3 1  ON 15
ci_017                 1.637095e-02 3 1  ON 16
ci_018                 1.021577e-02 3 1  ON 17
ci_019                 1.011447e-02 3 1  ON 18
ci_020                 1.775365e-02 3 1  ON 19
ci_021                 1.745255e-02 3 1  ON 20
ci_022                 9.170651e-03 3 1  ON 21
ci_023                 9.199700e-03 3 1  ON 22
ci_024                 9.596121e-03 3 1  ON 23
ci_025                 1.010397e-02 3 1  ON 24
ci_026                 1.156891e-02 3 1  ON 25
ci_027                 1.161966e-02 3 1  ON 26
ci_028                -1.480396e-02 3 1  ON 27
ci_029                -1.642220e-02 3 1  ON 28
ci_030                -9.555844e-03 3 1  ON 29
ci_031                -9.030364e-03 3 1  ON 30
ci_032                -1.473117e-02 3 1  ON 31
ci_033                 5.317154e-03 3 1  ON 32
ci_034                 5.631544e-03 3 1  ON 33
ci_035                -5.082859e-03 3 1  ON 34
ci_036                -1.276414e-02 3 1  ON 35
ci_037                -1.242661e-02 3 1  ON 36
ci_038                 2.023833e-03 3 1  ON 37
ci_039                 1.761788e-03 3 1  ON 38
ci_040                -3.177367e-03 3 1  ON 39
ci_041                 9.373267e-03 3 1  ON 40
ci_042                 8.230006e-03 3 1  ON 41
ci_043                -4.057029e-03 3 1  ON 42
ci_044                -3.920599e-03 3 1  ON 43
ci_045                -3.546784e-03 3 1  ON 44
ci_046                 5.638154e-03 3 1  ON 45
ci_047                 5.548450e-03 3 1  ON 46
ci_048                -1.269042e-02 3 1  ON 47
ci_049                -1.434184e-02 3 1  ON 48
ci_050                 3.146516e-03 3 1  ON 49
ci_051                 2.838926e-03 3 1  ON 50
ci_052                -2.339459e-03 3 1  ON 51
ci_053                -2.435481e-03 3 1  ON 52
ci_054                -3.309012e-03 3 1  ON 53
ci_055                -2.935698e-03 3 1  ON 54
ci_056                 5.554590e-03 3 1  ON 55
ci_057                 5.308069e-03 3 1  ON 56
ci_058                -1.140763e-03 3 1  ON 57
ci_059                -2.136377e-03 3 1  ON 58
ci_060                 4.677630e-03 3 1  ON 59
ci_061                 5.608942e-03 3 1  ON 60
ci_062                -3.753682e-03 3 1  ON 61
ci_063                -3.995718e-03 3 1  ON 62
ci_064                -2.683919e-03 3 1  ON 63
ci_065                -4.348509e-03 3 1  ON 64
ci_066                 4.461579e-03 3 1  ON 65
ci_067                 4.347682e-03 3 1  ON 66
ci_068                -4.240906e-03 3 1  ON 67
ci_069                -4.996657e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 65
    time step          = 0.05
    reference energy   = -17.1882
    reference variance = 0.134217
====================================================
  Execution time = 1.4099e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s065
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7932e-01
  Total weights = 1.9573e+06
  Execution time = 1.8207e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268762348108
                                         uncertainty =       0.001850413827

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268762348108
                                         uncertainty =       0.001850413827

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366602670
  error estimate for blocks of size 2^( 2) =       0.000380525897
  error estimate for blocks of size 2^( 3) =       0.000393178083
  error estimate for blocks of size 2^( 4) =       0.000402506129
  error estimate for blocks of size 2^( 5) =       0.000407295988
  error estimate for blocks of size 2^( 6) =       0.000409489867
  error estimate for blocks of size 2^( 7) =       0.000410551273

      target function =      -0.946032809310
              le_mean =     -17.212732718539
             les_mean =     296.557487944664
             stat err =       0.000407460814
             autocorr =       1.235322778679
   target nu stat err =       0.000407460814
   target dn stat err =       0.002560263096
      target stat err =       0.004378384330
              std dev =       0.518454468297
             le_variance =       0.268795035697

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268750790628
                                         uncertainty =       0.001851031505

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268750790628
                                         uncertainty =       0.001851031505

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366594805
  error estimate for blocks of size 2^( 2) =       0.000380520213
  error estimate for blocks of size 2^( 3) =       0.000393174657
  error estimate for blocks of size 2^( 4) =       0.000402505117
  error estimate for blocks of size 2^( 5) =       0.000407296016
  error estimate for blocks of size 2^( 6) =       0.000409488866
  error estimate for blocks of size 2^( 7) =       0.000410548429

      target function =      -0.946038819406
              le_mean =     -17.212733010947
             les_mean =     296.557494449753
             stat err =       0.000407459607
             autocorr =       1.235368466199
   target nu stat err =       0.000407459607
   target dn stat err =       0.002560084617
      target stat err =       0.004378144415
              std dev =       0.518443345336
             le_variance =       0.268783502324

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268756397377
                                         uncertainty =       0.001850726198

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268756397377
                                         uncertainty =       0.001850726198

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366598621
  error estimate for blocks of size 2^( 2) =       0.000380522956
  error estimate for blocks of size 2^( 3) =       0.000393176281
  error estimate for blocks of size 2^( 4) =       0.000402505565
  error estimate for blocks of size 2^( 5) =       0.000407295968
  error estimate for blocks of size 2^( 6) =       0.000409489308
  error estimate for blocks of size 2^( 7) =       0.000410549752

      target function =      -0.945529697310
              le_mean =     -17.212732853227
             les_mean =     296.557790912962
             stat err =       0.000407460148
             autocorr =       1.235346031621
   target nu stat err =       0.000407460148
   target dn stat err =       0.002578578574
      target stat err =       0.004404224805
              std dev =       0.518448741195
             le_variance =       0.268789097246

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268761592040
                                         uncertainty =       0.001850452869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268761592040
                                         uncertainty =       0.001850452869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366602156
  error estimate for blocks of size 2^( 2) =       0.000380525522
  error estimate for blocks of size 2^( 3) =       0.000393177852
  error estimate for blocks of size 2^( 4) =       0.000402506052
  error estimate for blocks of size 2^( 5) =       0.000407295976
  error estimate for blocks of size 2^( 6) =       0.000409489790
  error estimate for blocks of size 2^( 7) =       0.000410551078

      target function =      -0.946035565933
              le_mean =     -17.212732735429
             les_mean =     296.557486891710
             stat err =       0.000407460724
             autocorr =       1.235325700447
   target nu stat err =       0.000407460724
   target dn stat err =       0.002560242717
      target stat err =       0.004378375716
              std dev =       0.518453740627
             le_variance =       0.268794281170


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946032809310        initial
     3.5527e+00     3.5527e+01             5.3138e-05        -0.946038819406  <--
     1.4211e+01     1.4211e+02             1.3493e-05        -0.945529697310
     5.6843e+01     5.6843e+02             3.3866e-06        -0.946035565933

*****************************************************************************
Applying the update for shift_i =   3.5527e+00     and shift_s =   3.5527e+01
*****************************************************************************

  Execution time = 2.3272e+01
  </log>
  <optVariables href="H2O.s065.opt.xml">
ci_001                -4.182251e-02 3 1  ON 0
ci_002                -3.202447e-02 3 1  ON 1
ci_003                -2.631053e-02 3 1  ON 2
ci_004                 2.368623e-02 3 1  ON 3
ci_005                 2.402853e-02 3 1  ON 4
ci_006                -2.134115e-02 3 1  ON 5
ci_007                -2.096714e-02 3 1  ON 6
ci_008                -8.507443e-03 3 1  ON 7
ci_009                -1.394238e-02 3 1  ON 8
ci_010                -9.990990e-03 3 1  ON 9
ci_011                -1.110354e-02 3 1  ON 10
ci_012                -9.814214e-03 3 1  ON 11
ci_013                -1.984418e-02 3 1  ON 12
ci_014                 1.232403e-02 3 1  ON 13
ci_015                 1.202201e-02 3 1  ON 14
ci_016                 1.739965e-02 3 1  ON 15
ci_017                 1.636145e-02 3 1  ON 16
ci_018                 1.020557e-02 3 1  ON 17
ci_019                 1.010618e-02 3 1  ON 18
ci_020                 1.773340e-02 3 1  ON 19
ci_021                 1.743881e-02 3 1  ON 20
ci_022                 9.174798e-03 3 1  ON 21
ci_023                 9.190628e-03 3 1  ON 22
ci_024                 9.606566e-03 3 1  ON 23
ci_025                 1.009889e-02 3 1  ON 24
ci_026                 1.155347e-02 3 1  ON 25
ci_027                 1.162594e-02 3 1  ON 26
ci_028                -1.481098e-02 3 1  ON 27
ci_029                -1.640952e-02 3 1  ON 28
ci_030                -9.552780e-03 3 1  ON 29
ci_031                -9.033626e-03 3 1  ON 30
ci_032                -1.472019e-02 3 1  ON 31
ci_033                 5.315331e-03 3 1  ON 32
ci_034                 5.641615e-03 3 1  ON 33
ci_035                -5.082036e-03 3 1  ON 34
ci_036                -1.275601e-02 3 1  ON 35
ci_037                -1.242285e-02 3 1  ON 36
ci_038                 2.022758e-03 3 1  ON 37
ci_039                 1.757491e-03 3 1  ON 38
ci_040                -3.174579e-03 3 1  ON 39
ci_041                 9.354862e-03 3 1  ON 40
ci_042                 8.239272e-03 3 1  ON 41
ci_043                -4.057602e-03 3 1  ON 42
ci_044                -3.937086e-03 3 1  ON 43
ci_045                -3.533680e-03 3 1  ON 44
ci_046                 5.635368e-03 3 1  ON 45
ci_047                 5.556196e-03 3 1  ON 46
ci_048                -1.270617e-02 3 1  ON 47
ci_049                -1.432067e-02 3 1  ON 48
ci_050                 3.127628e-03 3 1  ON 49
ci_051                 2.849721e-03 3 1  ON 50
ci_052                -2.333273e-03 3 1  ON 51
ci_053                -2.436853e-03 3 1  ON 52
ci_054                -3.296387e-03 3 1  ON 53
ci_055                -2.934482e-03 3 1  ON 54
ci_056                 5.545642e-03 3 1  ON 55
ci_057                 5.301673e-03 3 1  ON 56
ci_058                -1.155885e-03 3 1  ON 57
ci_059                -2.131166e-03 3 1  ON 58
ci_060                 4.672179e-03 3 1  ON 59
ci_061                 5.589448e-03 3 1  ON 60
ci_062                -3.750409e-03 3 1  ON 61
ci_063                -3.992762e-03 3 1  ON 62
ci_064                -2.695647e-03 3 1  ON 63
ci_065                -4.353930e-03 3 1  ON 64
ci_066                 4.463526e-03 3 1  ON 65
ci_067                 4.345512e-03 3 1  ON 66
ci_068                -4.263119e-03 3 1  ON 67
ci_069                -5.007846e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9790e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s066 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s066 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=66  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.2016
    reference variance = 0.213358
====================================================
  Execution time = 1.4295e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s066
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7696e-01
  Total weights = 1.957343284e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5107e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265127946771
                                         uncertainty =       0.001242618882

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265127946771
                                         uncertainty =       0.001242618882

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364089431
  error estimate for blocks of size 2^( 2) =       0.000377936563
  error estimate for blocks of size 2^( 3) =       0.000390378664
  error estimate for blocks of size 2^( 4) =       0.000400019756
  error estimate for blocks of size 2^( 5) =       0.000405061577
  error estimate for blocks of size 2^( 6) =       0.000407155057
  error estimate for blocks of size 2^( 7) =       0.000409673707

      target function =      -0.950004000070
              le_mean =     -17.211734598211
             les_mean =     296.520772362865
             stat err =       0.000405477524
             autocorr =       1.240273393682
   target nu stat err =       0.000405477524
   target dn stat err =       0.002672229032
      target stat err =       0.004593424131
              std dev =       0.514900211434
             le_variance =       0.265122227735


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721173459821e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e-01, overlap shift 8.8818e+00 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950025148165       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950078332622       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950087351782       residual = 4.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.950089586229       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950089601165       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.950089625283       residual = 3.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.950089623210       residual = 6.26e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.950089627040       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.950089623378       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.950089620722       residual = 6.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e-01 is 1.388439e-04

solving harmonic davidson linear method for identity shift 3.5527e+00, overlap shift 3.5527e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950025148165       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950039357657       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950041733379       residual = 4.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.950042306827       residual = 5.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950042309516       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.950042314911       residual = 3.60e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.950042314312       residual = 5.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.950042315174       residual = 1.56e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.950042314257       residual = 2.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.950042313600       residual = 5.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+00 is 3.665782e-05

solving harmonic davidson linear method for identity shift 1.4211e+01, overlap shift 1.4211e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950025148165       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950028762608       residual = 1.89e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950029364583       residual = 4.71e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.950029508863       residual = 5.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950029509462       residual = 1.69e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.950029510766       residual = 3.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.950029510611       residual = 5.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.950029510819       residual = 1.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.950029510590       residual = 2.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.950029510427       residual = 5.27e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+01 is 9.295024e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.247949 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6814e+01
  </log>
  <optVariables href="H2O.s066.opt.xml">
ci_001                -4.181834e-02 3 1  ON 0
ci_002                -3.201673e-02 3 1  ON 1
ci_003                -2.628645e-02 3 1  ON 2
ci_004                 2.366990e-02 3 1  ON 3
ci_005                 2.402691e-02 3 1  ON 4
ci_006                -2.132767e-02 3 1  ON 5
ci_007                -2.095266e-02 3 1  ON 6
ci_008                -8.523932e-03 3 1  ON 7
ci_009                -1.394820e-02 3 1  ON 8
ci_010                -9.966464e-03 3 1  ON 9
ci_011                -1.108452e-02 3 1  ON 10
ci_012                -9.817311e-03 3 1  ON 11
ci_013                -1.983096e-02 3 1  ON 12
ci_014                 1.233658e-02 3 1  ON 13
ci_015                 1.205350e-02 3 1  ON 14
ci_016                 1.738392e-02 3 1  ON 15
ci_017                 1.635879e-02 3 1  ON 16
ci_018                 1.019397e-02 3 1  ON 17
ci_019                 1.009231e-02 3 1  ON 18
ci_020                 1.772135e-02 3 1  ON 19
ci_021                 1.743181e-02 3 1  ON 20
ci_022                 9.189290e-03 3 1  ON 21
ci_023                 9.162592e-03 3 1  ON 22
ci_024                 9.603044e-03 3 1  ON 23
ci_025                 1.007979e-02 3 1  ON 24
ci_026                 1.155012e-02 3 1  ON 25
ci_027                 1.162256e-02 3 1  ON 26
ci_028                -1.483487e-02 3 1  ON 27
ci_029                -1.637555e-02 3 1  ON 28
ci_030                -9.522778e-03 3 1  ON 29
ci_031                -9.043196e-03 3 1  ON 30
ci_032                -1.472684e-02 3 1  ON 31
ci_033                 5.329417e-03 3 1  ON 32
ci_034                 5.647202e-03 3 1  ON 33
ci_035                -5.069483e-03 3 1  ON 34
ci_036                -1.273672e-02 3 1  ON 35
ci_037                -1.239616e-02 3 1  ON 36
ci_038                 2.016073e-03 3 1  ON 37
ci_039                 1.750238e-03 3 1  ON 38
ci_040                -3.171982e-03 3 1  ON 39
ci_041                 9.347236e-03 3 1  ON 40
ci_042                 8.245541e-03 3 1  ON 41
ci_043                -4.059650e-03 3 1  ON 42
ci_044                -3.926507e-03 3 1  ON 43
ci_045                -3.516146e-03 3 1  ON 44
ci_046                 5.632114e-03 3 1  ON 45
ci_047                 5.562224e-03 3 1  ON 46
ci_048                -1.274283e-02 3 1  ON 47
ci_049                -1.430696e-02 3 1  ON 48
ci_050                 3.135686e-03 3 1  ON 49
ci_051                 2.875686e-03 3 1  ON 50
ci_052                -2.320085e-03 3 1  ON 51
ci_053                -2.448945e-03 3 1  ON 52
ci_054                -3.274591e-03 3 1  ON 53
ci_055                -2.926708e-03 3 1  ON 54
ci_056                 5.539671e-03 3 1  ON 55
ci_057                 5.311781e-03 3 1  ON 56
ci_058                -1.169148e-03 3 1  ON 57
ci_059                -2.129166e-03 3 1  ON 58
ci_060                 4.686046e-03 3 1  ON 59
ci_061                 5.580581e-03 3 1  ON 60
ci_062                -3.755651e-03 3 1  ON 61
ci_063                -3.990583e-03 3 1  ON 62
ci_064                -2.703591e-03 3 1  ON 63
ci_065                -4.345439e-03 3 1  ON 64
ci_066                 4.461812e-03 3 1  ON 65
ci_067                 4.344693e-03 3 1  ON 66
ci_068                -4.257087e-03 3 1  ON 67
ci_069                -4.998755e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 66
    time step          = 0.05
    reference energy   = -17.1909
    reference variance = 0.133481
====================================================
  Execution time = 1.3821e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s066
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7954e-01
  Total weights = 1.9572e+06
  Execution time = 1.8121e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269065940487
                                         uncertainty =       0.001703335454

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269065940487
                                         uncertainty =       0.001703335454

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366798197
  error estimate for blocks of size 2^( 2) =       0.000380555525
  error estimate for blocks of size 2^( 3) =       0.000393315909
  error estimate for blocks of size 2^( 4) =       0.000402546218
  error estimate for blocks of size 2^( 5) =       0.000407917162
  error estimate for blocks of size 2^( 6) =       0.000410806860
  error estimate for blocks of size 2^( 7) =       0.000413748578

      target function =      -0.945655278668
              le_mean =     -17.211652865714
             les_mean =     296.520536671914
             stat err =       0.000408754704
             autocorr =       1.241855727893
   target nu stat err =       0.000408754704
   target dn stat err =       0.002148641742
      target stat err =       0.003685665429
              std dev =       0.518730984171
             le_variance =       0.269081833939

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269020202113
                                         uncertainty =       0.001703097680

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269020202113
                                         uncertainty =       0.001703097680

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366766272
  error estimate for blocks of size 2^( 2) =       0.000380526046
  error estimate for blocks of size 2^( 3) =       0.000393287253
  error estimate for blocks of size 2^( 4) =       0.000402519645
  error estimate for blocks of size 2^( 5) =       0.000407892077
  error estimate for blocks of size 2^( 6) =       0.000410786702
  error estimate for blocks of size 2^( 7) =       0.000413731020

      target function =      -0.945499886552
              le_mean =     -17.211652385061
             les_mean =     296.520612539139
             stat err =       0.000408732361
             autocorr =       1.241936140575
   target nu stat err =       0.000408732361
   target dn stat err =       0.002149498312
      target stat err =       0.003685878373
              std dev =       0.518685836405
             le_variance =       0.269034996887

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269040682142
                                         uncertainty =       0.001703195258

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269040682142
                                         uncertainty =       0.001703195258

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366780582
  error estimate for blocks of size 2^( 2) =       0.000380539172
  error estimate for blocks of size 2^( 3) =       0.000393299967
  error estimate for blocks of size 2^( 4) =       0.000402531371
  error estimate for blocks of size 2^( 5) =       0.000407903125
  error estimate for blocks of size 2^( 6) =       0.000410795515
  error estimate for blocks of size 2^( 7) =       0.000413738692

      target function =      -0.944839445351
              le_mean =     -17.211652492787
             les_mean =     296.521009109599
             stat err =       0.000408742176
             autocorr =       1.241898879146
   target nu stat err =       0.000408742176
   target dn stat err =       0.002181331524
      target stat err =       0.003733241516
              std dev =       0.518706072854
             le_variance =       0.269055990016

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269062611167
                                         uncertainty =       0.001703316326

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269062611167
                                         uncertainty =       0.001703316326

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366795876
  error estimate for blocks of size 2^( 2) =       0.000380553364
  error estimate for blocks of size 2^( 3) =       0.000393313801
  error estimate for blocks of size 2^( 4) =       0.000402544252
  error estimate for blocks of size 2^( 5) =       0.000407915299
  error estimate for blocks of size 2^( 6) =       0.000410805337
  error estimate for blocks of size 2^( 7) =       0.000413747240

      target function =      -0.945642480464
              le_mean =     -17.211652802835
             les_mean =     296.520542118179
             stat err =       0.000408753032
             autocorr =       1.241861278294
   target nu stat err =       0.000408753032
   target dn stat err =       0.002148589218
      target stat err =       0.003685479992
              std dev =       0.518727702973
             le_variance =       0.269078429831


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945655278668        initial  <--
     8.8818e-01     8.8818e+00             1.3884e-04        -0.945499886552
     3.5527e+00     3.5527e+01             3.6658e-05        -0.944839445351
     1.4211e+01     1.4211e+02             9.2950e-06        -0.945642480464

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9857
  </log>
  <optVariables href="H2O.s066.opt.xml">
ci_001                -4.182251e-02 3 1  ON 0
ci_002                -3.202447e-02 3 1  ON 1
ci_003                -2.631053e-02 3 1  ON 2
ci_004                 2.368623e-02 3 1  ON 3
ci_005                 2.402853e-02 3 1  ON 4
ci_006                -2.134115e-02 3 1  ON 5
ci_007                -2.096714e-02 3 1  ON 6
ci_008                -8.507443e-03 3 1  ON 7
ci_009                -1.394238e-02 3 1  ON 8
ci_010                -9.990990e-03 3 1  ON 9
ci_011                -1.110354e-02 3 1  ON 10
ci_012                -9.814214e-03 3 1  ON 11
ci_013                -1.984418e-02 3 1  ON 12
ci_014                 1.232403e-02 3 1  ON 13
ci_015                 1.202201e-02 3 1  ON 14
ci_016                 1.739965e-02 3 1  ON 15
ci_017                 1.636145e-02 3 1  ON 16
ci_018                 1.020557e-02 3 1  ON 17
ci_019                 1.010618e-02 3 1  ON 18
ci_020                 1.773340e-02 3 1  ON 19
ci_021                 1.743881e-02 3 1  ON 20
ci_022                 9.174798e-03 3 1  ON 21
ci_023                 9.190628e-03 3 1  ON 22
ci_024                 9.606566e-03 3 1  ON 23
ci_025                 1.009889e-02 3 1  ON 24
ci_026                 1.155347e-02 3 1  ON 25
ci_027                 1.162594e-02 3 1  ON 26
ci_028                -1.481098e-02 3 1  ON 27
ci_029                -1.640952e-02 3 1  ON 28
ci_030                -9.552780e-03 3 1  ON 29
ci_031                -9.033626e-03 3 1  ON 30
ci_032                -1.472019e-02 3 1  ON 31
ci_033                 5.315331e-03 3 1  ON 32
ci_034                 5.641615e-03 3 1  ON 33
ci_035                -5.082036e-03 3 1  ON 34
ci_036                -1.275601e-02 3 1  ON 35
ci_037                -1.242285e-02 3 1  ON 36
ci_038                 2.022758e-03 3 1  ON 37
ci_039                 1.757491e-03 3 1  ON 38
ci_040                -3.174579e-03 3 1  ON 39
ci_041                 9.354862e-03 3 1  ON 40
ci_042                 8.239272e-03 3 1  ON 41
ci_043                -4.057602e-03 3 1  ON 42
ci_044                -3.937086e-03 3 1  ON 43
ci_045                -3.533680e-03 3 1  ON 44
ci_046                 5.635368e-03 3 1  ON 45
ci_047                 5.556196e-03 3 1  ON 46
ci_048                -1.270617e-02 3 1  ON 47
ci_049                -1.432067e-02 3 1  ON 48
ci_050                 3.127628e-03 3 1  ON 49
ci_051                 2.849721e-03 3 1  ON 50
ci_052                -2.333273e-03 3 1  ON 51
ci_053                -2.436853e-03 3 1  ON 52
ci_054                -3.296387e-03 3 1  ON 53
ci_055                -2.934482e-03 3 1  ON 54
ci_056                 5.545642e-03 3 1  ON 55
ci_057                 5.301673e-03 3 1  ON 56
ci_058                -1.155885e-03 3 1  ON 57
ci_059                -2.131166e-03 3 1  ON 58
ci_060                 4.672179e-03 3 1  ON 59
ci_061                 5.589448e-03 3 1  ON 60
ci_062                -3.750409e-03 3 1  ON 61
ci_063                -3.992762e-03 3 1  ON 62
ci_064                -2.695647e-03 3 1  ON 63
ci_065                -4.353930e-03 3 1  ON 64
ci_066                 4.463526e-03 3 1  ON 65
ci_067                 4.345512e-03 3 1  ON 66
ci_068                -4.263119e-03 3 1  ON 67
ci_069                -5.007846e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9806e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s067 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s067 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=67  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.1982
    reference variance = 0.166831
====================================================
  Execution time = 1.4144e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s067
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5313e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7867e-01
  Total weights = 1.957403017e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4832e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268299470222
                                         uncertainty =       0.001287757748

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268299470222
                                         uncertainty =       0.001287757748

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366232068
  error estimate for blocks of size 2^( 2) =       0.000380183014
  error estimate for blocks of size 2^( 3) =       0.000392992309
  error estimate for blocks of size 2^( 4) =       0.000402435568
  error estimate for blocks of size 2^( 5) =       0.000408062326
  error estimate for blocks of size 2^( 6) =       0.000409644163
  error estimate for blocks of size 2^( 7) =       0.000412656243

      target function =      -0.947132308528
              le_mean =     -17.212219026074
             les_mean =     296.539154899058
             stat err =       0.000408199575
             autocorr =       1.242316801081
   target nu stat err =       0.000408199575
   target dn stat err =       0.001916618339
      target stat err =       0.003317425963
              std dev =       0.517930357022
             le_variance =       0.268251854725


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721221902607e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.8818e+00, overlap shift 8.8818e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947142839574       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947148244983       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947148849169       residual = 2.82e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947148997083       residual = 6.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947149001742       residual = 9.09e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947149004768       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947149006140       residual = 3.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947149007064       residual = 7.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947149007426       residual = 9.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+00 is 1.261318e-05

solving harmonic davidson linear method for identity shift 3.5527e+01, overlap shift 3.5527e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947142839574       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947144200049       residual = 1.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947144351898       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947144388993       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947144390140       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947144390892       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947144391236       residual = 3.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947144391467       residual = 7.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947144391557       residual = 9.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+01 is 3.174707e-06

solving harmonic davidson linear method for identity shift 1.4211e+02, overlap shift 1.4211e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947142839574       residual = 1.21e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947143180268       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947143218280       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947143227561       residual = 6.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947143227847       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947143228034       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.947143228121       residual = 3.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.947143228178       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.947143228201       residual = 9.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.4211e+02 is 7.950264e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.250985 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6636e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
ci_001                -4.182162e-02 3 1  ON 0
ci_002                -3.202245e-02 3 1  ON 1
ci_003                -2.630744e-02 3 1  ON 2
ci_004                 2.368531e-02 3 1  ON 3
ci_005                 2.402790e-02 3 1  ON 4
ci_006                -2.134023e-02 3 1  ON 5
ci_007                -2.096638e-02 3 1  ON 6
ci_008                -8.507423e-03 3 1  ON 7
ci_009                -1.394049e-02 3 1  ON 8
ci_010                -9.990218e-03 3 1  ON 9
ci_011                -1.110358e-02 3 1  ON 10
ci_012                -9.813116e-03 3 1  ON 11
ci_013                -1.984373e-02 3 1  ON 12
ci_014                 1.232450e-02 3 1  ON 13
ci_015                 1.202110e-02 3 1  ON 14
ci_016                 1.739696e-02 3 1  ON 15
ci_017                 1.636282e-02 3 1  ON 16
ci_018                 1.020615e-02 3 1  ON 17
ci_019                 1.010553e-02 3 1  ON 18
ci_020                 1.773265e-02 3 1  ON 19
ci_021                 1.743656e-02 3 1  ON 20
ci_022                 9.174143e-03 3 1  ON 21
ci_023                 9.190262e-03 3 1  ON 22
ci_024                 9.604275e-03 3 1  ON 23
ci_025                 1.009644e-02 3 1  ON 24
ci_026                 1.155355e-02 3 1  ON 25
ci_027                 1.162547e-02 3 1  ON 26
ci_028                -1.481114e-02 3 1  ON 27
ci_029                -1.640646e-02 3 1  ON 28
ci_030                -9.551430e-03 3 1  ON 29
ci_031                -9.031376e-03 3 1  ON 30
ci_032                -1.472132e-02 3 1  ON 31
ci_033                 5.317291e-03 3 1  ON 32
ci_034                 5.642282e-03 3 1  ON 33
ci_035                -5.081591e-03 3 1  ON 34
ci_036                -1.275382e-02 3 1  ON 35
ci_037                -1.242590e-02 3 1  ON 36
ci_038                 2.021524e-03 3 1  ON 37
ci_039                 1.757776e-03 3 1  ON 38
ci_040                -3.172834e-03 3 1  ON 39
ci_041                 9.352193e-03 3 1  ON 40
ci_042                 8.240062e-03 3 1  ON 41
ci_043                -4.057399e-03 3 1  ON 42
ci_044                -3.937436e-03 3 1  ON 43
ci_045                -3.530505e-03 3 1  ON 44
ci_046                 5.636119e-03 3 1  ON 45
ci_047                 5.556983e-03 3 1  ON 46
ci_048                -1.270630e-02 3 1  ON 47
ci_049                -1.431948e-02 3 1  ON 48
ci_050                 3.128290e-03 3 1  ON 49
ci_051                 2.848549e-03 3 1  ON 50
ci_052                -2.331857e-03 3 1  ON 51
ci_053                -2.437556e-03 3 1  ON 52
ci_054                -3.293321e-03 3 1  ON 53
ci_055                -2.935111e-03 3 1  ON 54
ci_056                 5.545579e-03 3 1  ON 55
ci_057                 5.300536e-03 3 1  ON 56
ci_058                -1.157008e-03 3 1  ON 57
ci_059                -2.130157e-03 3 1  ON 58
ci_060                 4.671820e-03 3 1  ON 59
ci_061                 5.589490e-03 3 1  ON 60
ci_062                -3.750238e-03 3 1  ON 61
ci_063                -3.992621e-03 3 1  ON 62
ci_064                -2.696169e-03 3 1  ON 63
ci_065                -4.353553e-03 3 1  ON 64
ci_066                 4.466219e-03 3 1  ON 65
ci_067                 4.346673e-03 3 1  ON 66
ci_068                -4.263155e-03 3 1  ON 67
ci_069                -5.006993e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 67
    time step          = 0.05
    reference energy   = -17.1445
    reference variance = 0.207782
====================================================
  Execution time = 1.3711e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s067
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8319e-01
  Total weights = 1.9572e+06
  Execution time = 1.8151e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265976696040
                                         uncertainty =       0.001298976232

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265976696040
                                         uncertainty =       0.001298976232

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364875143
  error estimate for blocks of size 2^( 2) =       0.000378916977
  error estimate for blocks of size 2^( 3) =       0.000392036703
  error estimate for blocks of size 2^( 4) =       0.000401386444
  error estimate for blocks of size 2^( 5) =       0.000406658384
  error estimate for blocks of size 2^( 6) =       0.000409231093
  error estimate for blocks of size 2^( 7) =       0.000411442875

      target function =      -0.939331444315
              le_mean =     -17.211117007088
             les_mean =     296.505834081649
             stat err =       0.000407179699
             autocorr =       1.245327784470
   target nu stat err =       0.000407179699
   target dn stat err =       0.005383763159
      target stat err =       0.008953518856
              std dev =       0.516011375989
             le_variance =       0.266267740150

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265969825644
                                         uncertainty =       0.001299439871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265969825644
                                         uncertainty =       0.001299439871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364870558
  error estimate for blocks of size 2^( 2) =       0.000378913668
  error estimate for blocks of size 2^( 3) =       0.000392034728
  error estimate for blocks of size 2^( 4) =       0.000401386001
  error estimate for blocks of size 2^( 5) =       0.000406658633
  error estimate for blocks of size 2^( 6) =       0.000409231042
  error estimate for blocks of size 2^( 7) =       0.000411442875

      target function =      -0.939976355591
              le_mean =     -17.211117599444
             les_mean =     296.505471031256
             stat err =       0.000407179638
             autocorr =       1.245358706603
   target nu stat err =       0.000407179638
   target dn stat err =       0.005091211939
      target stat err =       0.008481734305
              std dev =       0.516004891844
             le_variance =       0.266261048407

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265973165329
                                         uncertainty =       0.001299211009

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265973165329
                                         uncertainty =       0.001299211009

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364872786
  error estimate for blocks of size 2^( 2) =       0.000378915264
  error estimate for blocks of size 2^( 3) =       0.000392035662
  error estimate for blocks of size 2^( 4) =       0.000401386176
  error estimate for blocks of size 2^( 5) =       0.000406658466
  error estimate for blocks of size 2^( 6) =       0.000409231016
  error estimate for blocks of size 2^( 7) =       0.000411442819

      target function =      -0.939663841435
              le_mean =     -17.211117305474
             les_mean =     296.505646697789
             stat err =       0.000407179619
             autocorr =       1.245343386442
   target nu stat err =       0.000407179619
   target dn stat err =       0.005232643127
      target stat err =       0.008709941257
              std dev =       0.516008042031
             le_variance =       0.266264299440

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265976245386
                                         uncertainty =       0.001299005790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265976245386
                                         uncertainty =       0.001299005790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364874842
  error estimate for blocks of size 2^( 2) =       0.000378916757
  error estimate for blocks of size 2^( 3) =       0.000392036567
  error estimate for blocks of size 2^( 4) =       0.000401386405
  error estimate for blocks of size 2^( 5) =       0.000406658390
  error estimate for blocks of size 2^( 6) =       0.000409231078
  error estimate for blocks of size 2^( 7) =       0.000411442861

      target function =      -0.939373982182
              le_mean =     -17.211117044490
             les_mean =     296.505810071795
             stat err =       0.000407179683
             autocorr =       1.245329742948
   target nu stat err =       0.000407179683
   target dn stat err =       0.005364384122
      target stat err =       0.008922298661
              std dev =       0.516010950252
             le_variance =       0.266267300780


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.939331444315        initial
     8.8818e+00     8.8818e+01             1.2613e-05        -0.939976355591  <--
     3.5527e+01     3.5527e+02             3.1747e-06        -0.939663841435
     1.4211e+02     1.4211e+03             7.9503e-07        -0.939373982182

*****************************************************************************
Applying the update for shift_i =   8.8818e+00     and shift_s =   8.8818e+01
*****************************************************************************

  Execution time = 2.2880e+01
  </log>
  <optVariables href="H2O.s067.opt.xml">
ci_001                -4.181899e-02 3 1  ON 0
ci_002                -3.201647e-02 3 1  ON 1
ci_003                -2.629824e-02 3 1  ON 2
ci_004                 2.368257e-02 3 1  ON 3
ci_005                 2.402603e-02 3 1  ON 4
ci_006                -2.133751e-02 3 1  ON 5
ci_007                -2.096414e-02 3 1  ON 6
ci_008                -8.507365e-03 3 1  ON 7
ci_009                -1.393486e-02 3 1  ON 8
ci_010                -9.987921e-03 3 1  ON 9
ci_011                -1.110370e-02 3 1  ON 10
ci_012                -9.809850e-03 3 1  ON 11
ci_013                -1.984241e-02 3 1  ON 12
ci_014                 1.232590e-02 3 1  ON 13
ci_015                 1.201840e-02 3 1  ON 14
ci_016                 1.738897e-02 3 1  ON 15
ci_017                 1.636690e-02 3 1  ON 16
ci_018                 1.020788e-02 3 1  ON 17
ci_019                 1.010357e-02 3 1  ON 18
ci_020                 1.773042e-02 3 1  ON 19
ci_021                 1.742987e-02 3 1  ON 20
ci_022                 9.172193e-03 3 1  ON 21
ci_023                 9.189177e-03 3 1  ON 22
ci_024                 9.597454e-03 3 1  ON 23
ci_025                 1.008915e-02 3 1  ON 24
ci_026                 1.155378e-02 3 1  ON 25
ci_027                 1.162407e-02 3 1  ON 26
ci_028                -1.481162e-02 3 1  ON 27
ci_029                -1.639735e-02 3 1  ON 28
ci_030                -9.547416e-03 3 1  ON 29
ci_031                -9.024680e-03 3 1  ON 30
ci_032                -1.472468e-02 3 1  ON 31
ci_033                 5.323122e-03 3 1  ON 32
ci_034                 5.644266e-03 3 1  ON 33
ci_035                -5.080269e-03 3 1  ON 34
ci_036                -1.274731e-02 3 1  ON 35
ci_037                -1.243494e-02 3 1  ON 36
ci_038                 2.017853e-03 3 1  ON 37
ci_039                 1.758622e-03 3 1  ON 38
ci_040                -3.167646e-03 3 1  ON 39
ci_041                 9.344258e-03 3 1  ON 40
ci_042                 8.242408e-03 3 1  ON 41
ci_043                -4.056795e-03 3 1  ON 42
ci_044                -3.938479e-03 3 1  ON 43
ci_045                -3.521066e-03 3 1  ON 44
ci_046                 5.638355e-03 3 1  ON 45
ci_047                 5.559327e-03 3 1  ON 46
ci_048                -1.270669e-02 3 1  ON 47
ci_049                -1.431594e-02 3 1  ON 48
ci_050                 3.130255e-03 3 1  ON 49
ci_051                 2.845064e-03 3 1  ON 50
ci_052                -2.327648e-03 3 1  ON 51
ci_053                -2.439648e-03 3 1  ON 52
ci_054                -3.284199e-03 3 1  ON 53
ci_055                -2.936981e-03 3 1  ON 54
ci_056                 5.545390e-03 3 1  ON 55
ci_057                 5.297154e-03 3 1  ON 56
ci_058                -1.160349e-03 3 1  ON 57
ci_059                -2.127155e-03 3 1  ON 58
ci_060                 4.670752e-03 3 1  ON 59
ci_061                 5.589613e-03 3 1  ON 60
ci_062                -3.749729e-03 3 1  ON 61
ci_063                -3.992200e-03 3 1  ON 62
ci_064                -2.697721e-03 3 1  ON 63
ci_065                -4.352430e-03 3 1  ON 64
ci_066                 4.474226e-03 3 1  ON 65
ci_067                 4.350127e-03 3 1  ON 66
ci_068                -4.263263e-03 3 1  ON 67
ci_069                -5.004455e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9521e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s068 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s068 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=68  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.199
    reference variance = 0.368195
====================================================
  Execution time = 1.4041e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s068
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7528e-01
  Total weights = 1.957121826e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5027e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264858054274
                                         uncertainty =       0.001616930150

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264858054274
                                         uncertainty =       0.001616930150

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363961296
  error estimate for blocks of size 2^( 2) =       0.000378219310
  error estimate for blocks of size 2^( 3) =       0.000390613258
  error estimate for blocks of size 2^( 4) =       0.000399467970
  error estimate for blocks of size 2^( 5) =       0.000404872775
  error estimate for blocks of size 2^( 6) =       0.000408653131
  error estimate for blocks of size 2^( 7) =       0.000408207373

      target function =      -0.952891081921
              le_mean =     -17.212223973495
             les_mean =     296.535935996874
             stat err =       0.000405300312
             autocorr =       1.240062208491
   target nu stat err =       0.000405300312
   target dn stat err =       0.001855423490
      target stat err =       0.003253776799
              std dev =       0.514719000392
             le_variance =       0.264935649365


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721222397349e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+00, overlap shift 2.2204e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952901199616       residual = 2.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952932029572       residual = 2.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952936578964       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.952937403026       residual = 6.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.952937605638       residual = 1.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.952937656263       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.952937652318       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.952937661399       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.952937666206       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.952937669304       residual = 6.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+00 is 6.930571e-05

solving harmonic davidson linear method for identity shift 8.8818e+00, overlap shift 8.8818e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952901199616       residual = 2.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952909122205       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952910283848       residual = 3.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.952910492211       residual = 6.81e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.952910543309       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.952910555950       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.952910554926       residual = 6.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.952910557210       residual = 1.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.952910558402       residual = 2.21e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.952910559175       residual = 6.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+00 is 1.782080e-05

solving harmonic davidson linear method for identity shift 3.5527e+01, overlap shift 3.5527e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952901199616       residual = 2.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952903194179       residual = 2.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952903486147       residual = 3.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.952903538384       residual = 6.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.952903551186       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.952903554344       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.952903554086       residual = 6.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.952903554658       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.952903554955       residual = 2.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.952903555148       residual = 6.29e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+01 is 4.487208e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.254439 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6554e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
ci_001                -4.181337e-02 3 1  ON 0
ci_002                -3.200972e-02 3 1  ON 1
ci_003                -2.628761e-02 3 1  ON 2
ci_004                 2.368281e-02 3 1  ON 3
ci_005                 2.401974e-02 3 1  ON 4
ci_006                -2.133576e-02 3 1  ON 5
ci_007                -2.095201e-02 3 1  ON 6
ci_008                -8.515632e-03 3 1  ON 7
ci_009                -1.394941e-02 3 1  ON 8
ci_010                -9.985333e-03 3 1  ON 9
ci_011                -1.109780e-02 3 1  ON 10
ci_012                -9.824451e-03 3 1  ON 11
ci_013                -1.983702e-02 3 1  ON 12
ci_014                 1.232586e-02 3 1  ON 13
ci_015                 1.203324e-02 3 1  ON 14
ci_016                 1.737764e-02 3 1  ON 15
ci_017                 1.636652e-02 3 1  ON 16
ci_018                 1.020506e-02 3 1  ON 17
ci_019                 1.009256e-02 3 1  ON 18
ci_020                 1.772675e-02 3 1  ON 19
ci_021                 1.742964e-02 3 1  ON 20
ci_022                 9.179622e-03 3 1  ON 21
ci_023                 9.192563e-03 3 1  ON 22
ci_024                 9.593266e-03 3 1  ON 23
ci_025                 1.008021e-02 3 1  ON 24
ci_026                 1.155560e-02 3 1  ON 25
ci_027                 1.161286e-02 3 1  ON 26
ci_028                -1.481217e-02 3 1  ON 27
ci_029                -1.639773e-02 3 1  ON 28
ci_030                -9.547147e-03 3 1  ON 29
ci_031                -9.027589e-03 3 1  ON 30
ci_032                -1.472304e-02 3 1  ON 31
ci_033                 5.327515e-03 3 1  ON 32
ci_034                 5.654298e-03 3 1  ON 33
ci_035                -5.078482e-03 3 1  ON 34
ci_036                -1.275286e-02 3 1  ON 35
ci_037                -1.242869e-02 3 1  ON 36
ci_038                 2.014417e-03 3 1  ON 37
ci_039                 1.760499e-03 3 1  ON 38
ci_040                -3.166268e-03 3 1  ON 39
ci_041                 9.336320e-03 3 1  ON 40
ci_042                 8.243343e-03 3 1  ON 41
ci_043                -4.055316e-03 3 1  ON 42
ci_044                -3.943043e-03 3 1  ON 43
ci_045                -3.520300e-03 3 1  ON 44
ci_046                 5.636559e-03 3 1  ON 45
ci_047                 5.559108e-03 3 1  ON 46
ci_048                -1.270173e-02 3 1  ON 47
ci_049                -1.431119e-02 3 1  ON 48
ci_050                 3.134899e-03 3 1  ON 49
ci_051                 2.862885e-03 3 1  ON 50
ci_052                -2.317635e-03 3 1  ON 51
ci_053                -2.441469e-03 3 1  ON 52
ci_054                -3.275604e-03 3 1  ON 53
ci_055                -2.935277e-03 3 1  ON 54
ci_056                 5.542347e-03 3 1  ON 55
ci_057                 5.293820e-03 3 1  ON 56
ci_058                -1.173724e-03 3 1  ON 57
ci_059                -2.130833e-03 3 1  ON 58
ci_060                 4.668854e-03 3 1  ON 59
ci_061                 5.586956e-03 3 1  ON 60
ci_062                -3.752411e-03 3 1  ON 61
ci_063                -3.991147e-03 3 1  ON 62
ci_064                -2.696904e-03 3 1  ON 63
ci_065                -4.352436e-03 3 1  ON 64
ci_066                 4.473595e-03 3 1  ON 65
ci_067                 4.350598e-03 3 1  ON 66
ci_068                -4.263775e-03 3 1  ON 67
ci_069                -4.997600e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 68
    time step          = 0.05
    reference energy   = -17.1811
    reference variance = 0.324176
====================================================
  Execution time = 1.3753e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s068
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7697e-01
  Total weights = 1.9575e+06
  Execution time = 1.8119e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266110850081
                                         uncertainty =       0.001464531603

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266110850081
                                         uncertainty =       0.001464531603

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364838344
  error estimate for blocks of size 2^( 2) =       0.000378598396
  error estimate for blocks of size 2^( 3) =       0.000391683289
  error estimate for blocks of size 2^( 4) =       0.000401247980
  error estimate for blocks of size 2^( 5) =       0.000407117422
  error estimate for blocks of size 2^( 6) =       0.000410978873
  error estimate for blocks of size 2^( 7) =       0.000412768818

      target function =      -0.949331213153
              le_mean =     -17.211028357346
             les_mean =     296.496855293808
             stat err =       0.000408028273
             autocorr =       1.250776073276
   target nu stat err =       0.000408028273
   target dn stat err =       0.002129780434
      target stat err =       0.003677903162
              std dev =       0.515959333492
             le_variance =       0.266214033817

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266094659224
                                         uncertainty =       0.001464451527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266094659224
                                         uncertainty =       0.001464451527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364827270
  error estimate for blocks of size 2^( 2) =       0.000378586456
  error estimate for blocks of size 2^( 3) =       0.000391671344
  error estimate for blocks of size 2^( 4) =       0.000401234431
  error estimate for blocks of size 2^( 5) =       0.000407101507
  error estimate for blocks of size 2^( 6) =       0.000410964139
  error estimate for blocks of size 2^( 7) =       0.000412754421

      target function =      -0.950473611799
              le_mean =     -17.211029049715
             les_mean =     296.496205894238
             stat err =       0.000408013625
             autocorr =       1.250762190485
   target nu stat err =       0.000408013625
   target dn stat err =       0.002016117129
      target stat err =       0.003497722238
              std dev =       0.515943673078
             le_variance =       0.266197873790

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266102309711
                                         uncertainty =       0.001464486267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266102309711
                                         uncertainty =       0.001464486267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364832502
  error estimate for blocks of size 2^( 2) =       0.000378592102
  error estimate for blocks of size 2^( 3) =       0.000391676984
  error estimate for blocks of size 2^( 4) =       0.000401240863
  error estimate for blocks of size 2^( 5) =       0.000407109094
  error estimate for blocks of size 2^( 6) =       0.000410971146
  error estimate for blocks of size 2^( 7) =       0.000412761253

      target function =      -0.950250963830
              le_mean =     -17.211028677273
             les_mean =     296.496324263938
             stat err =       0.000408020589
             autocorr =       1.250769012766
   target nu stat err =       0.000408020589
   target dn stat err =       0.002023440684
      target stat err =       0.003508269316
              std dev =       0.515951072585
             le_variance =       0.266205509302

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266109748344
                                         uncertainty =       0.001464525383

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266109748344
                                         uncertainty =       0.001464525383

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364837590
  error estimate for blocks of size 2^( 2) =       0.000378597584
  error estimate for blocks of size 2^( 3) =       0.000391682475
  error estimate for blocks of size 2^( 4) =       0.000401247069
  error estimate for blocks of size 2^( 5) =       0.000407116361
  error estimate for blocks of size 2^( 6) =       0.000410977887
  error estimate for blocks of size 2^( 7) =       0.000412767852

      target function =      -0.949568078348
              le_mean =     -17.211028392335
             les_mean =     296.496716896035
             stat err =       0.000408027292
             autocorr =       1.250775223419
   target nu stat err =       0.000408027292
   target dn stat err =       0.002090534421
      target stat err =       0.003614570081
              std dev =       0.515958267772
             le_variance =       0.266212934082


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949331213153        initial
     2.2204e+00     2.2204e+01             6.9306e-05        -0.950473611799  <--
     8.8818e+00     8.8818e+01             1.7821e-05        -0.950250963830
     3.5527e+01     3.5527e+02             4.4872e-06        -0.949568078348

*****************************************************************************
Applying the update for shift_i =   2.2204e+00     and shift_s =   2.2204e+01
*****************************************************************************

  Execution time = 2.3047e+01
  </log>
  <optVariables href="H2O.s068.opt.xml">
ci_001                -4.179701e-02 3 1  ON 0
ci_002                -3.199009e-02 3 1  ON 1
ci_003                -2.625672e-02 3 1  ON 2
ci_004                 2.368356e-02 3 1  ON 3
ci_005                 2.400128e-02 3 1  ON 4
ci_006                -2.133070e-02 3 1  ON 5
ci_007                -2.091668e-02 3 1  ON 6
ci_008                -8.539494e-03 3 1  ON 7
ci_009                -1.399160e-02 3 1  ON 8
ci_010                -9.977818e-03 3 1  ON 9
ci_011                -1.108068e-02 3 1  ON 10
ci_012                -9.866813e-03 3 1  ON 11
ci_013                -1.982126e-02 3 1  ON 12
ci_014                 1.232572e-02 3 1  ON 13
ci_015                 1.207633e-02 3 1  ON 14
ci_016                 1.734463e-02 3 1  ON 15
ci_017                 1.636544e-02 3 1  ON 16
ci_018                 1.019691e-02 3 1  ON 17
ci_019                 1.006069e-02 3 1  ON 18
ci_020                 1.771601e-02 3 1  ON 19
ci_021                 1.742895e-02 3 1  ON 20
ci_022                 9.201222e-03 3 1  ON 21
ci_023                 9.202489e-03 3 1  ON 22
ci_024                 9.581115e-03 3 1  ON 23
ci_025                 1.005415e-02 3 1  ON 24
ci_026                 1.156089e-02 3 1  ON 25
ci_027                 1.158036e-02 3 1  ON 26
ci_028                -1.481373e-02 3 1  ON 27
ci_029                -1.639888e-02 3 1  ON 28
ci_030                -9.546338e-03 3 1  ON 29
ci_031                -9.035927e-03 3 1  ON 30
ci_032                -1.471827e-02 3 1  ON 31
ci_033                 5.340293e-03 3 1  ON 32
ci_034                 5.683461e-03 3 1  ON 33
ci_035                -5.073307e-03 3 1  ON 34
ci_036                -1.276882e-02 3 1  ON 35
ci_037                -1.241058e-02 3 1  ON 36
ci_038                 2.004466e-03 3 1  ON 37
ci_039                 1.765942e-03 3 1  ON 38
ci_040                -3.162281e-03 3 1  ON 39
ci_041                 9.313349e-03 3 1  ON 40
ci_042                 8.246076e-03 3 1  ON 41
ci_043                -4.051031e-03 3 1  ON 42
ci_044                -3.956296e-03 3 1  ON 43
ci_045                -3.518085e-03 3 1  ON 44
ci_046                 5.631335e-03 3 1  ON 45
ci_047                 5.558471e-03 3 1  ON 46
ci_048                -1.268734e-02 3 1  ON 47
ci_049                -1.429741e-02 3 1  ON 48
ci_050                 3.148308e-03 3 1  ON 49
ci_051                 2.914370e-03 3 1  ON 50
ci_052                -2.288639e-03 3 1  ON 51
ci_053                -2.446696e-03 3 1  ON 52
ci_054                -3.250689e-03 3 1  ON 53
ci_055                -2.930338e-03 3 1  ON 54
ci_056                 5.533520e-03 3 1  ON 55
ci_057                 5.284144e-03 3 1  ON 56
ci_058                -1.212355e-03 3 1  ON 57
ci_059                -2.141487e-03 3 1  ON 58
ci_060                 4.663344e-03 3 1  ON 59
ci_061                 5.579233e-03 3 1  ON 60
ci_062                -3.760179e-03 3 1  ON 61
ci_063                -3.988056e-03 3 1  ON 62
ci_064                -2.694541e-03 3 1  ON 63
ci_065                -4.352450e-03 3 1  ON 64
ci_066                 4.471755e-03 3 1  ON 65
ci_067                 4.351929e-03 3 1  ON 66
ci_068                -4.265245e-03 3 1  ON 67
ci_069                -4.977683e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9607e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s069 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s069 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=69  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.2253
    reference variance = 0.172384
====================================================
  Execution time = 1.6205e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s069
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5280e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8045e-01
  Total weights = 1.957394153e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5205e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266013525898
                                         uncertainty =       0.001405167241

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266013525898
                                         uncertainty =       0.001405167241

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364664807
  error estimate for blocks of size 2^( 2) =       0.000378434601
  error estimate for blocks of size 2^( 3) =       0.000390727774
  error estimate for blocks of size 2^( 4) =       0.000400654380
  error estimate for blocks of size 2^( 5) =       0.000405080033
  error estimate for blocks of size 2^( 6) =       0.000407994604
  error estimate for blocks of size 2^( 7) =       0.000408820145

      target function =      -0.944090014463
              le_mean =     -17.211591930167
             les_mean =     296.519351235430
             stat err =       0.000405637291
             autocorr =       1.237337118968
   target nu stat err =       0.000405637291
   target dn stat err =       0.003985256801
      target stat err =       0.006717838909
              std dev =       0.515713915639
             le_variance =       0.265960842783


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721159193017e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e-01, overlap shift 5.5511e+00 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944136667855       residual = 2.97e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944355493744       residual = 5.38e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944401273798       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944411633919       residual = 1.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944412606482       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944412922925       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944413098464       residual = 1.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944413084243       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944413088477       residual = 9.32e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944413092892       residual = 1.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944413093906       residual = 4.93e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e-01 is 5.441145e-04

solving harmonic davidson linear method for identity shift 2.2204e+00, overlap shift 2.2204e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944136667855       residual = 2.97e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944197018505       residual = 5.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944209304156       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944212029819       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944212270859       residual = 4.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944212346937       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944212390645       residual = 9.48e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944212385762       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944212388523       residual = 6.52e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944212388642       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944212389141       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+00 is 1.487555e-04

solving harmonic davidson linear method for identity shift 8.8818e+00, overlap shift 8.8818e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944136667855       residual = 2.97e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944152154876       residual = 5.21e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944155283163       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944155973326       residual = 1.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944156033307       residual = 4.26e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944156052073       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944156062961       residual = 8.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944156061690       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944156062491       residual = 5.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944156062407       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944156062607       residual = 3.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+00 is 3.808081e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.258547 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8735e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
ci_001                -4.170277e-02 3 1  ON 0
ci_002                -3.199851e-02 3 1  ON 1
ci_003                -2.624413e-02 3 1  ON 2
ci_004                 2.370578e-02 3 1  ON 3
ci_005                 2.396248e-02 3 1  ON 4
ci_006                -2.128257e-02 3 1  ON 5
ci_007                -2.085947e-02 3 1  ON 6
ci_008                -8.548450e-03 3 1  ON 7
ci_009                -1.399062e-02 3 1  ON 8
ci_010                -9.929268e-03 3 1  ON 9
ci_011                -1.105555e-02 3 1  ON 10
ci_012                -9.839693e-03 3 1  ON 11
ci_013                -1.988294e-02 3 1  ON 12
ci_014                 1.235050e-02 3 1  ON 13
ci_015                 1.222509e-02 3 1  ON 14
ci_016                 1.736654e-02 3 1  ON 15
ci_017                 1.636828e-02 3 1  ON 16
ci_018                 1.017475e-02 3 1  ON 17
ci_019                 1.008776e-02 3 1  ON 18
ci_020                 1.768244e-02 3 1  ON 19
ci_021                 1.738803e-02 3 1  ON 20
ci_022                 9.221921e-03 3 1  ON 21
ci_023                 9.266212e-03 3 1  ON 22
ci_024                 9.551441e-03 3 1  ON 23
ci_025                 1.017308e-02 3 1  ON 24
ci_026                 1.157228e-02 3 1  ON 25
ci_027                 1.154270e-02 3 1  ON 26
ci_028                -1.482154e-02 3 1  ON 27
ci_029                -1.634576e-02 3 1  ON 28
ci_030                -9.506700e-03 3 1  ON 29
ci_031                -9.042815e-03 3 1  ON 30
ci_032                -1.466857e-02 3 1  ON 31
ci_033                 5.427931e-03 3 1  ON 32
ci_034                 5.655499e-03 3 1  ON 33
ci_035                -5.062952e-03 3 1  ON 34
ci_036                -1.274352e-02 3 1  ON 35
ci_037                -1.241886e-02 3 1  ON 36
ci_038                 1.986431e-03 3 1  ON 37
ci_039                 1.770053e-03 3 1  ON 38
ci_040                -3.165737e-03 3 1  ON 39
ci_041                 9.297362e-03 3 1  ON 40
ci_042                 8.300438e-03 3 1  ON 41
ci_043                -4.039563e-03 3 1  ON 42
ci_044                -3.984736e-03 3 1  ON 43
ci_045                -3.509243e-03 3 1  ON 44
ci_046                 5.661874e-03 3 1  ON 45
ci_047                 5.549168e-03 3 1  ON 46
ci_048                -1.259082e-02 3 1  ON 47
ci_049                -1.425377e-02 3 1  ON 48
ci_050                 3.174174e-03 3 1  ON 49
ci_051                 2.936556e-03 3 1  ON 50
ci_052                -2.306078e-03 3 1  ON 51
ci_053                -2.445288e-03 3 1  ON 52
ci_054                -3.187775e-03 3 1  ON 53
ci_055                -2.905365e-03 3 1  ON 54
ci_056                 5.528379e-03 3 1  ON 55
ci_057                 5.260815e-03 3 1  ON 56
ci_058                -1.221223e-03 3 1  ON 57
ci_059                -2.134543e-03 3 1  ON 58
ci_060                 4.696462e-03 3 1  ON 59
ci_061                 5.579733e-03 3 1  ON 60
ci_062                -3.776673e-03 3 1  ON 61
ci_063                -3.971075e-03 3 1  ON 62
ci_064                -2.721870e-03 3 1  ON 63
ci_065                -4.347691e-03 3 1  ON 64
ci_066                 4.472182e-03 3 1  ON 65
ci_067                 4.356751e-03 3 1  ON 66
ci_068                -4.265848e-03 3 1  ON 67
ci_069                -4.970143e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 69
    time step          = 0.05
    reference energy   = -17.2372
    reference variance = 0.174895
====================================================
  Execution time = 1.3849e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s069
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7569e-01
  Total weights = 1.9573e+06
  Execution time = 1.8129e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265065782414
                                         uncertainty =       0.001528880961

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265065782414
                                         uncertainty =       0.001528880961

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364010152
  error estimate for blocks of size 2^( 2) =       0.000377878524
  error estimate for blocks of size 2^( 3) =       0.000390838762
  error estimate for blocks of size 2^( 4) =       0.000399199563
  error estimate for blocks of size 2^( 5) =       0.000403800652
  error estimate for blocks of size 2^( 6) =       0.000407179635
  error estimate for blocks of size 2^( 7) =       0.000409149703

      target function =      -0.951807242961
              le_mean =     -17.211907153566
             les_mean =     296.525660314590
             stat err =       0.000404832388
             autocorr =       1.236868445801
   target nu stat err =       0.000404832388
   target dn stat err =       0.001919091061
      target stat err =       0.003350303964
              std dev =       0.514788093230
             le_variance =       0.265006780931

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265054489971
                                         uncertainty =       0.001540618155

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265054489971
                                         uncertainty =       0.001540618155

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364002113
  error estimate for blocks of size 2^( 2) =       0.000377862989
  error estimate for blocks of size 2^( 3) =       0.000390818611
  error estimate for blocks of size 2^( 4) =       0.000399179029
  error estimate for blocks of size 2^( 5) =       0.000403767496
  error estimate for blocks of size 2^( 6) =       0.000407138710
  error estimate for blocks of size 2^( 7) =       0.000409067870

      target function =      -0.952141434277
              le_mean =     -17.211912628305
             les_mean =     296.525652844970
             stat err =       0.000404788276
             autocorr =       1.236653527304
   target nu stat err =       0.000404788276
   target dn stat err =       0.001918374315
      target stat err =       0.003351425818
              std dev =       0.514776725436
             le_variance =       0.264995077051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265053016087
                                         uncertainty =       0.001535038876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265053016087
                                         uncertainty =       0.001535038876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364001232
  error estimate for blocks of size 2^( 2) =       0.000377865529
  error estimate for blocks of size 2^( 3) =       0.000390823668
  error estimate for blocks of size 2^( 4) =       0.000399183598
  error estimate for blocks of size 2^( 5) =       0.000403778620
  error estimate for blocks of size 2^( 6) =       0.000407153655
  error estimate for blocks of size 2^( 7) =       0.000409103271

      target function =      -0.949528774646
              le_mean =     -17.211909711259
             les_mean =     296.527085067571
             stat err =       0.000404804786
             autocorr =       1.236760397312
   target nu stat err =       0.000404804786
   target dn stat err =       0.002357111095
      target stat err =       0.004063204464
              std dev =       0.514775479088
             le_variance =       0.264993793870

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265063215668
                                         uncertainty =       0.001529616824

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265063215668
                                         uncertainty =       0.001529616824

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364008370
  error estimate for blocks of size 2^( 2) =       0.000377876228
  error estimate for blocks of size 2^( 3) =       0.000390836148
  error estimate for blocks of size 2^( 4) =       0.000399196892
  error estimate for blocks of size 2^( 5) =       0.000403797107
  error estimate for blocks of size 2^( 6) =       0.000407175505
  error estimate for blocks of size 2^( 7) =       0.000409142600

      target function =      -0.951996054342
              le_mean =     -17.211907313905
             les_mean =     296.525555099170
             stat err =       0.000404828026
             autocorr =       1.236853895911
   target nu stat err =       0.000404828026
   target dn stat err =       0.001916088571
      target stat err =       0.003346603286
              std dev =       0.514785573572
             le_variance =       0.265004186758


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.951807242961        initial
     5.5511e-01     5.5511e+00             5.4411e-04        -0.952141434277  <--
     2.2204e+00     2.2204e+01             1.4876e-04        -0.949528774646
     8.8818e+00     8.8818e+01             3.8081e-05        -0.951996054342

*****************************************************************************
Applying the update for shift_i =   5.5511e-01     and shift_s =   5.5511e+00
*****************************************************************************

  Execution time = 2.3124e+01
  </log>
  <optVariables href="H2O.s069.opt.xml">
ci_001                -4.144909e-02 3 1  ON 0
ci_002                -3.202122e-02 3 1  ON 1
ci_003                -2.621053e-02 3 1  ON 2
ci_004                 2.376750e-02 3 1  ON 3
ci_005                 2.385750e-02 3 1  ON 4
ci_006                -2.115288e-02 3 1  ON 5
ci_007                -2.070558e-02 3 1  ON 6
ci_008                -8.571696e-03 3 1  ON 7
ci_009                -1.398863e-02 3 1  ON 8
ci_010                -9.801555e-03 3 1  ON 9
ci_011                -1.098912e-02 3 1  ON 10
ci_012                -9.768919e-03 3 1  ON 11
ci_013                -2.004974e-02 3 1  ON 12
ci_014                 1.241672e-02 3 1  ON 13
ci_015                 1.262045e-02 3 1  ON 14
ci_016                 1.742593e-02 3 1  ON 15
ci_017                 1.637722e-02 3 1  ON 16
ci_018                 1.011550e-02 3 1  ON 17
ci_019                 1.015804e-02 3 1  ON 18
ci_020                 1.759387e-02 3 1  ON 19
ci_021                 1.727787e-02 3 1  ON 20
ci_022                 9.277236e-03 3 1  ON 21
ci_023                 9.434606e-03 3 1  ON 22
ci_024                 9.472247e-03 3 1  ON 23
ci_025                 1.048907e-02 3 1  ON 24
ci_026                 1.160373e-02 3 1  ON 25
ci_027                 1.144263e-02 3 1  ON 26
ci_028                -1.484271e-02 3 1  ON 27
ci_029                -1.620570e-02 3 1  ON 28
ci_030                -9.399297e-03 3 1  ON 29
ci_031                -9.058827e-03 3 1  ON 30
ci_032                -1.453660e-02 3 1  ON 31
ci_033                 5.660036e-03 3 1  ON 32
ci_034                 5.580145e-03 3 1  ON 33
ci_035                -5.035739e-03 3 1  ON 34
ci_036                -1.267741e-02 3 1  ON 35
ci_037                -1.244062e-02 3 1  ON 36
ci_038                 1.939066e-03 3 1  ON 37
ci_039                 1.780777e-03 3 1  ON 38
ci_040                -3.174913e-03 3 1  ON 39
ci_041                 9.255844e-03 3 1  ON 40
ci_042                 8.441953e-03 3 1  ON 41
ci_043                -4.009349e-03 3 1  ON 42
ci_044                -4.059993e-03 3 1  ON 43
ci_045                -3.485924e-03 3 1  ON 44
ci_046                 5.743022e-03 3 1  ON 45
ci_047                 5.524519e-03 3 1  ON 46
ci_048                -1.233207e-02 3 1  ON 47
ci_049                -1.413853e-02 3 1  ON 48
ci_050                 3.241424e-03 3 1  ON 49
ci_051                 2.994387e-03 3 1  ON 50
ci_052                -2.350482e-03 3 1  ON 51
ci_053                -2.441069e-03 3 1  ON 52
ci_054                -3.021865e-03 3 1  ON 53
ci_055                -2.839647e-03 3 1  ON 54
ci_056                 5.514899e-03 3 1  ON 55
ci_057                 5.198968e-03 3 1  ON 56
ci_058                -1.241732e-03 3 1  ON 57
ci_059                -2.116111e-03 3 1  ON 58
ci_060                 4.784609e-03 3 1  ON 59
ci_061                 5.580965e-03 3 1  ON 60
ci_062                -3.819847e-03 3 1  ON 61
ci_063                -3.928088e-03 3 1  ON 62
ci_064                -2.793266e-03 3 1  ON 63
ci_065                -4.335254e-03 3 1  ON 64
ci_066                 4.472303e-03 3 1  ON 65
ci_067                 4.369810e-03 3 1  ON 66
ci_068                -4.267099e-03 3 1  ON 67
ci_069                -4.950031e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1865e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s070 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s070 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=70  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.238
    reference variance = 0.174843
====================================================
  Execution time = 1.4164e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s070
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8155e-01
  Total weights = 1.957360269e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4839e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269959762394
                                         uncertainty =       0.001543742019

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269959762394
                                         uncertainty =       0.001543742019

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367443698
  error estimate for blocks of size 2^( 2) =       0.000381381405
  error estimate for blocks of size 2^( 3) =       0.000393870953
  error estimate for blocks of size 2^( 4) =       0.000403252825
  error estimate for blocks of size 2^( 5) =       0.000408989484
  error estimate for blocks of size 2^( 6) =       0.000411871624
  error estimate for blocks of size 2^( 7) =       0.000413969980

      target function =      -0.942292150833
              le_mean =     -17.211308645101
             les_mean =     296.510694449640
             stat err =       0.000409520978
             autocorr =       1.242140443977
   target nu stat err =       0.000409520978
   target dn stat err =       0.002054600183
      target stat err =       0.003504233719
              std dev =       0.519643860549
             le_variance =       0.270029741806


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721130864510e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e-01, overlap shift 1.3878e+00 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942304152815       residual = 2.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942575391290       residual = 1.96e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942613204521       residual = 4.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942621400458       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942625982442       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942626543156       residual = 6.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942626707388       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942626616706       residual = 3.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942626553268       residual = 9.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942626509304       residual = 2.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.942626499955       residual = 5.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e-01 is 9.082125e-04

solving harmonic davidson linear method for identity shift 5.5511e-01, overlap shift 5.5511e+00 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942304152815       residual = 2.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942398822776       residual = 1.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942411215777       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942413724935       residual = 1.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942415095308       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942415233311       residual = 5.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942415264016       residual = 8.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942415232707       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942415209608       residual = 6.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942415197290       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.942415194351       residual = 2.49e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e-01 is 3.074286e-04

solving harmonic davidson linear method for identity shift 2.2204e+00, overlap shift 2.2204e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942304152815       residual = 2.11e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942330420946       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942333776611       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942334438029       residual = 1.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942334796290       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942334829337       residual = 4.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942334835559       residual = 7.40e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942334826977       residual = 2.06e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942334820537       residual = 5.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942334817426       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.942334816627       residual = 1.74e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+00 is 8.434838e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.262631 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6658e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
ci_001                -4.146854e-02 3 1  ON 0
ci_002                -3.190027e-02 3 1  ON 1
ci_003                -2.627380e-02 3 1  ON 2
ci_004                 2.380026e-02 3 1  ON 3
ci_005                 2.388273e-02 3 1  ON 4
ci_006                -2.113542e-02 3 1  ON 5
ci_007                -2.062654e-02 3 1  ON 6
ci_008                -8.577991e-03 3 1  ON 7
ci_009                -1.412750e-02 3 1  ON 8
ci_010                -9.831389e-03 3 1  ON 9
ci_011                -1.084585e-02 3 1  ON 10
ci_012                -9.833762e-03 3 1  ON 11
ci_013                -2.004854e-02 3 1  ON 12
ci_014                 1.243184e-02 3 1  ON 13
ci_015                 1.260396e-02 3 1  ON 14
ci_016                 1.735310e-02 3 1  ON 15
ci_017                 1.633290e-02 3 1  ON 16
ci_018                 9.974439e-03 3 1  ON 17
ci_019                 1.018993e-02 3 1  ON 18
ci_020                 1.745702e-02 3 1  ON 19
ci_021                 1.724390e-02 3 1  ON 20
ci_022                 9.289473e-03 3 1  ON 21
ci_023                 9.496180e-03 3 1  ON 22
ci_024                 9.576312e-03 3 1  ON 23
ci_025                 1.018165e-02 3 1  ON 24
ci_026                 1.143554e-02 3 1  ON 25
ci_027                 1.156947e-02 3 1  ON 26
ci_028                -1.479884e-02 3 1  ON 27
ci_029                -1.597106e-02 3 1  ON 28
ci_030                -9.390918e-03 3 1  ON 29
ci_031                -8.959618e-03 3 1  ON 30
ci_032                -1.466390e-02 3 1  ON 31
ci_033                 5.751103e-03 3 1  ON 32
ci_034                 5.594805e-03 3 1  ON 33
ci_035                -5.030071e-03 3 1  ON 34
ci_036                -1.257186e-02 3 1  ON 35
ci_037                -1.245013e-02 3 1  ON 36
ci_038                 1.896337e-03 3 1  ON 37
ci_039                 1.765799e-03 3 1  ON 38
ci_040                -3.136918e-03 3 1  ON 39
ci_041                 9.208658e-03 3 1  ON 40
ci_042                 8.601696e-03 3 1  ON 41
ci_043                -4.003996e-03 3 1  ON 42
ci_044                -4.009470e-03 3 1  ON 43
ci_045                -3.369458e-03 3 1  ON 44
ci_046                 5.719191e-03 3 1  ON 45
ci_047                 5.560980e-03 3 1  ON 46
ci_048                -1.234463e-02 3 1  ON 47
ci_049                -1.411833e-02 3 1  ON 48
ci_050                 3.265965e-03 3 1  ON 49
ci_051                 3.046465e-03 3 1  ON 50
ci_052                -2.383838e-03 3 1  ON 51
ci_053                -2.476820e-03 3 1  ON 52
ci_054                -3.022173e-03 3 1  ON 53
ci_055                -2.880414e-03 3 1  ON 54
ci_056                 5.488832e-03 3 1  ON 55
ci_057                 5.125481e-03 3 1  ON 56
ci_058                -1.391323e-03 3 1  ON 57
ci_059                -2.092769e-03 3 1  ON 58
ci_060                 4.784870e-03 3 1  ON 59
ci_061                 5.554486e-03 3 1  ON 60
ci_062                -3.726515e-03 3 1  ON 61
ci_063                -4.030812e-03 3 1  ON 62
ci_064                -2.821294e-03 3 1  ON 63
ci_065                -4.341894e-03 3 1  ON 64
ci_066                 4.507052e-03 3 1  ON 65
ci_067                 4.357354e-03 3 1  ON 66
ci_068                -4.249085e-03 3 1  ON 67
ci_069                -4.879558e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 70
    time step          = 0.05
    reference energy   = -17.1867
    reference variance = 0.177797
====================================================
  Execution time = 1.3584e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s070
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7777e-01
  Total weights = 1.9574e+06
  Execution time = 1.8102e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268111796842
                                         uncertainty =       0.001613413087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268111796842
                                         uncertainty =       0.001613413087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366114190
  error estimate for blocks of size 2^( 2) =       0.000379976414
  error estimate for blocks of size 2^( 3) =       0.000392534083
  error estimate for blocks of size 2^( 4) =       0.000401681146
  error estimate for blocks of size 2^( 5) =       0.000406326505
  error estimate for blocks of size 2^( 6) =       0.000410576607
  error estimate for blocks of size 2^( 7) =       0.000411289407

      target function =      -0.946926846274
              le_mean =     -17.211585732236
             les_mean =     296.517470137382
             stat err =       0.000407468416
             autocorr =       1.238667602380
   target nu stat err =       0.000407468416
   target dn stat err =       0.002128215877
      target stat err =       0.003660713166
              std dev =       0.517763653152
             le_variance =       0.268079200525

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268085130822
                                         uncertainty =       0.001615071143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268085130822
                                         uncertainty =       0.001615071143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366095671
  error estimate for blocks of size 2^( 2) =       0.000379958252
  error estimate for blocks of size 2^( 3) =       0.000392517844
  error estimate for blocks of size 2^( 4) =       0.000401661548
  error estimate for blocks of size 2^( 5) =       0.000406305167
  error estimate for blocks of size 2^( 6) =       0.000410558298
  error estimate for blocks of size 2^( 7) =       0.000411242561

      target function =      -0.948496145950
              le_mean =     -17.211589744567
             les_mean =     296.516679754781
             stat err =       0.000407441894
             autocorr =       1.238631656779
   target nu stat err =       0.000407441894
   target dn stat err =       0.002028378585
      target stat err =       0.003507247586
              std dev =       0.517737463529
             le_variance =       0.268052081142

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268076147560
                                         uncertainty =       0.001613945593

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268076147560
                                         uncertainty =       0.001613945593

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366089629
  error estimate for blocks of size 2^( 2) =       0.000379951902
  error estimate for blocks of size 2^( 3) =       0.000392510642
  error estimate for blocks of size 2^( 4) =       0.000401655499
  error estimate for blocks of size 2^( 5) =       0.000406299371
  error estimate for blocks of size 2^( 6) =       0.000410551198
  error estimate for blocks of size 2^( 7) =       0.000411244795

      target function =      -0.947670681761
              le_mean =     -17.211586119157
             les_mean =     296.517043150680
             stat err =       0.000407437716
             autocorr =       1.238647140506
   target nu stat err =       0.000407437716
   target dn stat err =       0.002055743411
      target stat err =       0.003546469704
              std dev =       0.517728918433
             le_variance =       0.268043232982

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268102548159
                                         uncertainty =       0.001613415777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268102548159
                                         uncertainty =       0.001613415777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366107845
  error estimate for blocks of size 2^( 2) =       0.000379970178
  error estimate for blocks of size 2^( 3) =       0.000392527962
  error estimate for blocks of size 2^( 4) =       0.000401674571
  error estimate for blocks of size 2^( 5) =       0.000406319735
  error estimate for blocks of size 2^( 6) =       0.000410570040
  error estimate for blocks of size 2^( 7) =       0.000411279691

      target function =      -0.946388028348
              le_mean =     -17.211585083892
             les_mean =     296.517766579947
             stat err =       0.000407461009
             autocorr =       1.238665503014
   target nu stat err =       0.000407461009
   target dn stat err =       0.002257691184
      target stat err =       0.003870584706
              std dev =       0.517754680014
             le_variance =       0.268069908676


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946926846274        initial
     1.3878e-01     1.3878e+00             9.0821e-04        -0.948496145950  <--
     5.5511e-01     5.5511e+00             3.0743e-04        -0.947670681761
     2.2204e+00     2.2204e+01             8.4348e-05        -0.946388028348

*****************************************************************************
Applying the update for shift_i =   1.3878e-01     and shift_s =   1.3878e+00
*****************************************************************************

  Execution time = 2.2726e+01
  </log>
  <optVariables href="H2O.s070.opt.xml">
ci_001                -4.151019e-02 3 1  ON 0
ci_002                -3.165566e-02 3 1  ON 1
ci_003                -2.638636e-02 3 1  ON 2
ci_004                 2.384172e-02 3 1  ON 3
ci_005                 2.394832e-02 3 1  ON 4
ci_006                -2.110328e-02 3 1  ON 5
ci_007                -2.047215e-02 3 1  ON 6
ci_008                -8.593174e-03 3 1  ON 7
ci_009                -1.439786e-02 3 1  ON 8
ci_010                -9.887122e-03 3 1  ON 9
ci_011                -1.056793e-02 3 1  ON 10
ci_012                -9.967003e-03 3 1  ON 11
ci_013                -2.005716e-02 3 1  ON 12
ci_014                 1.246831e-02 3 1  ON 13
ci_015                 1.256119e-02 3 1  ON 14
ci_016                 1.720411e-02 3 1  ON 15
ci_017                 1.624445e-02 3 1  ON 16
ci_018                 9.704473e-03 3 1  ON 17
ci_019                 1.023909e-02 3 1  ON 18
ci_020                 1.718849e-02 3 1  ON 19
ci_021                 1.716766e-02 3 1  ON 20
ci_022                 9.314923e-03 3 1  ON 21
ci_023                 9.616906e-03 3 1  ON 22
ci_024                 9.782554e-03 3 1  ON 23
ci_025                 9.580862e-03 3 1  ON 24
ci_026                 1.111905e-02 3 1  ON 25
ci_027                 1.181580e-02 3 1  ON 26
ci_028                -1.470833e-02 3 1  ON 27
ci_029                -1.550988e-02 3 1  ON 28
ci_030                -9.378553e-03 3 1  ON 29
ci_031                -8.768263e-03 3 1  ON 30
ci_032                -1.492007e-02 3 1  ON 31
ci_033                 5.929752e-03 3 1  ON 32
ci_034                 5.626646e-03 3 1  ON 33
ci_035                -5.019226e-03 3 1  ON 34
ci_036                -1.238307e-02 3 1  ON 35
ci_037                -1.246947e-02 3 1  ON 36
ci_038                 1.814579e-03 3 1  ON 37
ci_039                 1.737122e-03 3 1  ON 38
ci_040                -3.064454e-03 3 1  ON 39
ci_041                 9.116778e-03 3 1  ON 40
ci_042                 8.895451e-03 3 1  ON 41
ci_043                -3.994188e-03 3 1  ON 42
ci_044                -3.906674e-03 3 1  ON 43
ci_045                -3.148903e-03 3 1  ON 44
ci_046                 5.667828e-03 3 1  ON 45
ci_047                 5.633292e-03 3 1  ON 46
ci_048                -1.237021e-02 3 1  ON 47
ci_049                -1.406713e-02 3 1  ON 48
ci_050                 3.312594e-03 3 1  ON 49
ci_051                 3.143352e-03 3 1  ON 50
ci_052                -2.442159e-03 3 1  ON 51
ci_053                -2.545440e-03 3 1  ON 52
ci_054                -3.019386e-03 3 1  ON 53
ci_055                -2.960036e-03 3 1  ON 54
ci_056                 5.439273e-03 3 1  ON 55
ci_057                 4.982473e-03 3 1  ON 56
ci_058                -1.677680e-03 3 1  ON 57
ci_059                -2.049026e-03 3 1  ON 58
ci_060                 4.783393e-03 3 1  ON 59
ci_061                 5.499585e-03 3 1  ON 60
ci_062                -3.546119e-03 3 1  ON 61
ci_063                -4.216307e-03 3 1  ON 62
ci_064                -2.874144e-03 3 1  ON 63
ci_065                -4.354502e-03 3 1  ON 64
ci_066                 4.571522e-03 3 1  ON 65
ci_067                 4.332605e-03 3 1  ON 66
ci_068                -4.213885e-03 3 1  ON 67
ci_069                -4.739175e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9390e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s071 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s071 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=71  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.1511
    reference variance = 0.163653
====================================================
  Execution time = 1.3984e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s071
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5309e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8232e-01
  Total weights = 1.957062546e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4646e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269895161080
                                         uncertainty =       0.001877950896

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269895161080
                                         uncertainty =       0.001877950896

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367436725
  error estimate for blocks of size 2^( 2) =       0.000381417239
  error estimate for blocks of size 2^( 3) =       0.000394223826
  error estimate for blocks of size 2^( 4) =       0.000403478841
  error estimate for blocks of size 2^( 5) =       0.000408878400
  error estimate for blocks of size 2^( 6) =       0.000412039339
  error estimate for blocks of size 2^( 7) =       0.000412337109

      target function =      -0.940990583872
              le_mean =     -17.211870468443
             les_mean =     296.530809881192
             stat err =       0.000409183422
             autocorr =       1.240140631723
   target nu stat err =       0.000409183422
   target dn stat err =       0.002739812779
      target stat err =       0.004621114725
              std dev =       0.519634000326
             le_variance =       0.270019494295


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721187046844e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e-02, overlap shift 3.4694e-01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941012516660       residual = 3.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942018432272       residual = 2.63e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942104239240       residual = 7.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942139137480       residual = 1.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942151921088       residual = 4.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942151475545       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942152119095       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942152139746       residual = 5.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942152128281       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942151986969       residual = 4.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.942151950296       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.942152012532       residual = 2.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         11 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e-02 is 2.097115e-03

solving harmonic davidson linear method for identity shift 1.3878e-01, overlap shift 1.3878e+00 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941012516660       residual = 3.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941545055942       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941587828955       residual = 6.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941603270931       residual = 1.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941609006666       residual = 3.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941608726356       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941608923566       residual = 1.40e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941608903338       residual = 3.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941608900152       residual = 7.91e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941608855882       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941608844665       residual = 4.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e-01 is 1.044494e-03

solving harmonic davidson linear method for identity shift 5.5511e-01, overlap shift 5.5511e+00 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941012516660       residual = 3.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941197229444       residual = 2.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941211429409       residual = 6.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941216120478       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941217894431       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941217796721       residual = 7.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941217841540       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941217830487       residual = 1.99e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941217829749       residual = 4.60e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941217819488       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941217817096       residual = 2.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e-01 is 3.480769e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.267047 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6458e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
ci_001                -4.146599e-02 3 1  ON 0
ci_002                -3.154761e-02 3 1  ON 1
ci_003                -2.622532e-02 3 1  ON 2
ci_004                 2.343180e-02 3 1  ON 3
ci_005                 2.384465e-02 3 1  ON 4
ci_006                -2.089074e-02 3 1  ON 5
ci_007                -2.034366e-02 3 1  ON 6
ci_008                -8.629625e-03 3 1  ON 7
ci_009                -1.420244e-02 3 1  ON 8
ci_010                -9.334927e-03 3 1  ON 9
ci_011                -1.086295e-02 3 1  ON 10
ci_012                -9.613601e-03 3 1  ON 11
ci_013                -1.975284e-02 3 1  ON 12
ci_014                 1.281802e-02 3 1  ON 13
ci_015                 1.237673e-02 3 1  ON 14
ci_016                 1.707768e-02 3 1  ON 15
ci_017                 1.625810e-02 3 1  ON 16
ci_018                 1.019966e-02 3 1  ON 17
ci_019                 9.584533e-03 3 1  ON 18
ci_020                 1.738369e-02 3 1  ON 19
ci_021                 1.681865e-02 3 1  ON 20
ci_022                 8.989439e-03 3 1  ON 21
ci_023                 9.142601e-03 3 1  ON 22
ci_024                 9.619600e-03 3 1  ON 23
ci_025                 9.488425e-03 3 1  ON 24
ci_026                 1.102209e-02 3 1  ON 25
ci_027                 1.125865e-02 3 1  ON 26
ci_028                -1.532987e-02 3 1  ON 27
ci_029                -1.562193e-02 3 1  ON 28
ci_030                -9.560354e-03 3 1  ON 29
ci_031                -9.338083e-03 3 1  ON 30
ci_032                -1.463398e-02 3 1  ON 31
ci_033                 5.670214e-03 3 1  ON 32
ci_034                 5.549949e-03 3 1  ON 33
ci_035                -5.169300e-03 3 1  ON 34
ci_036                -1.279640e-02 3 1  ON 35
ci_037                -1.244955e-02 3 1  ON 36
ci_038                 1.758491e-03 3 1  ON 37
ci_039                 1.703171e-03 3 1  ON 38
ci_040                -2.971820e-03 3 1  ON 39
ci_041                 8.260336e-03 3 1  ON 40
ci_042                 8.848876e-03 3 1  ON 41
ci_043                -4.008041e-03 3 1  ON 42
ci_044                -4.330910e-03 3 1  ON 43
ci_045                -3.504036e-03 3 1  ON 44
ci_046                 5.827428e-03 3 1  ON 45
ci_047                 5.563781e-03 3 1  ON 46
ci_048                -1.281689e-02 3 1  ON 47
ci_049                -1.302264e-02 3 1  ON 48
ci_050                 3.554602e-03 3 1  ON 49
ci_051                 3.234685e-03 3 1  ON 50
ci_052                -1.900005e-03 3 1  ON 51
ci_053                -2.184982e-03 3 1  ON 52
ci_054                -2.869559e-03 3 1  ON 53
ci_055                -2.879123e-03 3 1  ON 54
ci_056                 5.157383e-03 3 1  ON 55
ci_057                 5.456917e-03 3 1  ON 56
ci_058                -1.565044e-03 3 1  ON 57
ci_059                -2.014920e-03 3 1  ON 58
ci_060                 5.261606e-03 3 1  ON 59
ci_061                 5.674879e-03 3 1  ON 60
ci_062                -3.605251e-03 3 1  ON 61
ci_063                -4.034077e-03 3 1  ON 62
ci_064                -3.224017e-03 3 1  ON 63
ci_065                -4.371170e-03 3 1  ON 64
ci_066                 4.625394e-03 3 1  ON 65
ci_067                 4.269727e-03 3 1  ON 66
ci_068                -4.460470e-03 3 1  ON 67
ci_069                -4.968853e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 71
    time step          = 0.05
    reference energy   = -17.0946
    reference variance = 0.196584
====================================================
  Execution time = 1.3731e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s071
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7737e-01
  Total weights = 1.9573e+06
  Execution time = 1.8173e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267673345334
                                         uncertainty =       0.002146594673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267673345334
                                         uncertainty =       0.002146594673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365828710
  error estimate for blocks of size 2^( 2) =       0.000379692301
  error estimate for blocks of size 2^( 3) =       0.000392715617
  error estimate for blocks of size 2^( 4) =       0.000402105098
  error estimate for blocks of size 2^( 5) =       0.000407854494
  error estimate for blocks of size 2^( 6) =       0.000411341826
  error estimate for blocks of size 2^( 7) =       0.000414238336

      target function =      -0.242355750706
              le_mean =     -17.211403847109
             les_mean =     297.511485091671
             stat err =       0.000408884939
             autocorr =       1.249242229880
   target nu stat err =       0.000408884939
   target dn stat err =       0.994972728512
      target stat err =       0.154365490373
              std dev =       0.517359922617
             le_variance =       0.267661289531

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267170507062
                                         uncertainty =       0.001796722930

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267170507062
                                         uncertainty =       0.001796722930

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365487112
  error estimate for blocks of size 2^( 2) =       0.000379461760
  error estimate for blocks of size 2^( 3) =       0.000392580941
  error estimate for blocks of size 2^( 4) =       0.000402074177
  error estimate for blocks of size 2^( 5) =       0.000407879765
  error estimate for blocks of size 2^( 6) =       0.000411349372
  error estimate for blocks of size 2^( 7) =       0.000413996367

      target function =      -0.944758276374
              le_mean =     -17.211407128496
             les_mean =     296.512602306360
             stat err =       0.000408824920
             autocorr =       1.251211097273
   target nu stat err =       0.000408824920
   target dn stat err =       0.002999824063
      target stat err =       0.005084944919
              std dev =       0.516876830207
             le_variance =       0.267161657605

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267216431088
                                         uncertainty =       0.001798234344

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267216431088
                                         uncertainty =       0.001798234344

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365518571
  error estimate for blocks of size 2^( 2) =       0.000379495488
  error estimate for blocks of size 2^( 3) =       0.000392617312
  error estimate for blocks of size 2^( 4) =       0.000402112194
  error estimate for blocks of size 2^( 5) =       0.000407916235
  error estimate for blocks of size 2^( 6) =       0.000411393566
  error estimate for blocks of size 2^( 7) =       0.000414048204

      target function =      -0.935076078150
              le_mean =     -17.211408217763
             les_mean =     296.518422013172
             stat err =       0.000408867550
             autocorr =       1.251256634691
   target nu stat err =       0.000408867550
   target dn stat err =       0.006070035609
      target stat err =       0.010002853299
              std dev =       0.516921320302
             le_variance =       0.267207651382

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267031739285
                                         uncertainty =       0.001790973945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267031739285
                                         uncertainty =       0.001790973945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365390976
  error estimate for blocks of size 2^( 2) =       0.000379287694
  error estimate for blocks of size 2^( 3) =       0.000392337350
  error estimate for blocks of size 2^( 4) =       0.000401758692
  error estimate for blocks of size 2^( 5) =       0.000407545046
  error estimate for blocks of size 2^( 6) =       0.000410979156
  error estimate for blocks of size 2^( 7) =       0.000413625509

      target function =      -0.948444915976
              le_mean =     -17.211409386899
             les_mean =     296.510492135971
             stat err =       0.000408477101
             autocorr =       1.249740361064
   target nu stat err =       0.000408477101
   target dn stat err =       0.002898674035
      target stat err =       0.004954994093
              std dev =       0.516740873456
             le_variance =       0.267021130300


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.242355750706        initial
     3.4694e-02     3.4694e-01             2.0971e-03        -0.944758276374
     1.3878e-01     1.3878e+00             1.0445e-03        -0.935076078150
     5.5511e-01     5.5511e+00             3.4808e-04        -0.948444915976  <--

*****************************************************************************
Applying the update for shift_i =   5.5511e-01     and shift_s =   5.5511e+00
*****************************************************************************

  Execution time = 2.2890e+01
  </log>
  <optVariables href="H2O.s071.opt.xml">
ci_001                -4.149426e-02 3 1  ON 0
ci_002                -3.161943e-02 3 1  ON 1
ci_003                -2.632931e-02 3 1  ON 2
ci_004                 2.370902e-02 3 1  ON 3
ci_005                 2.392029e-02 3 1  ON 4
ci_006                -2.103311e-02 3 1  ON 5
ci_007                -2.043052e-02 3 1  ON 6
ci_008                -8.604698e-03 3 1  ON 7
ci_009                -1.433083e-02 3 1  ON 8
ci_010                -9.700807e-03 3 1  ON 9
ci_011                -1.066762e-02 3 1  ON 10
ci_012                -9.847291e-03 3 1  ON 11
ci_013                -1.995941e-02 3 1  ON 12
ci_014                 1.258443e-02 3 1  ON 13
ci_015                 1.249857e-02 3 1  ON 14
ci_016                 1.716108e-02 3 1  ON 15
ci_017                 1.624809e-02 3 1  ON 16
ci_018                 9.877274e-03 3 1  ON 17
ci_019                 1.001298e-02 3 1  ON 18
ci_020                 1.725853e-02 3 1  ON 19
ci_021                 1.704741e-02 3 1  ON 20
ci_022                 9.204673e-03 3 1  ON 21
ci_023                 9.455746e-03 3 1  ON 22
ci_024                 9.727939e-03 3 1  ON 23
ci_025                 9.551325e-03 3 1  ON 24
ci_026                 1.108931e-02 3 1  ON 25
ci_027                 1.162522e-02 3 1  ON 26
ci_028                -1.491970e-02 3 1  ON 27
ci_029                -1.554545e-02 3 1  ON 28
ci_030                -9.437657e-03 3 1  ON 29
ci_031                -8.971694e-03 3 1  ON 30
ci_032                -1.482430e-02 3 1  ON 31
ci_033                 5.842707e-03 3 1  ON 32
ci_034                 5.600935e-03 3 1  ON 33
ci_035                -5.070315e-03 3 1  ON 34
ci_036                -1.252606e-02 3 1  ON 35
ci_037                -1.246199e-02 3 1  ON 36
ci_038                 1.795463e-03 3 1  ON 37
ci_039                 1.725815e-03 3 1  ON 38
ci_040                -3.032547e-03 3 1  ON 39
ci_041                 8.817866e-03 3 1  ON 40
ci_042                 8.877805e-03 3 1  ON 41
ci_043                -3.998872e-03 3 1  ON 42
ci_044                -4.049768e-03 3 1  ON 43
ci_045                -3.271729e-03 3 1  ON 44
ci_046                 5.721708e-03 3 1  ON 45
ci_047                 5.610273e-03 3 1  ON 46
ci_048                -1.251285e-02 3 1  ON 47
ci_049                -1.371905e-02 3 1  ON 48
ci_050                 3.397776e-03 3 1  ON 49
ci_051                 3.175236e-03 3 1  ON 50
ci_052                -2.252239e-03 3 1  ON 51
ci_053                -2.418772e-03 3 1  ON 52
ci_054                -2.964548e-03 3 1  ON 53
ci_055                -2.932443e-03 3 1  ON 54
ci_056                 5.343472e-03 3 1  ON 55
ci_057                 5.144183e-03 3 1  ON 56
ci_058                -1.637300e-03 3 1  ON 57
ci_059                -2.039105e-03 3 1  ON 58
ci_060                 4.942565e-03 3 1  ON 59
ci_061                 5.558224e-03 3 1  ON 60
ci_062                -3.566474e-03 3 1  ON 61
ci_063                -4.155334e-03 3 1  ON 62
ci_064                -2.995540e-03 3 1  ON 63
ci_065                -4.360219e-03 3 1  ON 64
ci_066                 4.588493e-03 3 1  ON 65
ci_067                 4.310824e-03 3 1  ON 66
ci_068                -4.295180e-03 3 1  ON 67
ci_069                -4.815770e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9355e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s072 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s072 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=72  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.1915
    reference variance = 0.163869
====================================================
  Execution time = 1.5698e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s072
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5306e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8189e-01
  Total weights = 1.957342681e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.5777e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268572871544
                                         uncertainty =       0.001937925521

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268572871544
                                         uncertainty =       0.001937925521

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366425099
  error estimate for blocks of size 2^( 2) =       0.000380289735
  error estimate for blocks of size 2^( 3) =       0.000392927386
  error estimate for blocks of size 2^( 4) =       0.000401955038
  error estimate for blocks of size 2^( 5) =       0.000406678864
  error estimate for blocks of size 2^( 6) =       0.000409927664
  error estimate for blocks of size 2^( 7) =       0.000411623727

      target function =      -0.941708330093
              le_mean =     -17.212332173470
             les_mean =     296.546266005350
             stat err =       0.000407546323
             autocorr =       1.237039400244
   target nu stat err =       0.000407546323
   target dn stat err =       0.003428750092
      target stat err =       0.005770815279
              std dev =       0.518203344014
             le_variance =       0.268534705748


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721233217347e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e-01, overlap shift 1.3878e+00 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941742848680       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941935757574       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941973162328       residual = 5.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941986286666       residual = 6.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941987843870       residual = 1.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941988961041       residual = 3.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941988861293       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941988785884       residual = 1.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941988799284       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941988798618       residual = 7.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e-01 is 6.492769e-04

solving harmonic davidson linear method for identity shift 5.5511e-01, overlap shift 5.5511e+00 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941742848680       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941809529070       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941821864234       residual = 4.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941825812418       residual = 5.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941826239430       residual = 1.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941826566431       residual = 2.66e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941826529074       residual = 3.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941826509691       residual = 8.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941826512447       residual = 1.95e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941826514717       residual = 5.43e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e-01 is 2.159681e-04

solving harmonic davidson linear method for identity shift 2.2204e+00, overlap shift 2.2204e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941742848680       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941761281703       residual = 1.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941764630523       residual = 4.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941765665440       residual = 4.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941765773528       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941765858477       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941765848258       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941765843387       residual = 7.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941765843991       residual = 1.84e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941765844709       residual = 4.75e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+00 is 5.886750e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.270570 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8285e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
ci_001                -4.155591e-02 3 1  ON 0
ci_002                -3.159509e-02 3 1  ON 1
ci_003                -2.619783e-02 3 1  ON 2
ci_004                 2.362467e-02 3 1  ON 3
ci_005                 2.374648e-02 3 1  ON 4
ci_006                -2.087962e-02 3 1  ON 5
ci_007                -2.037712e-02 3 1  ON 6
ci_008                -8.609415e-03 3 1  ON 7
ci_009                -1.429532e-02 3 1  ON 8
ci_010                -9.813476e-03 3 1  ON 9
ci_011                -1.067410e-02 3 1  ON 10
ci_012                -9.812832e-03 3 1  ON 11
ci_013                -1.996297e-02 3 1  ON 12
ci_014                 1.250078e-02 3 1  ON 13
ci_015                 1.261457e-02 3 1  ON 14
ci_016                 1.713102e-02 3 1  ON 15
ci_017                 1.633205e-02 3 1  ON 16
ci_018                 9.798751e-03 3 1  ON 17
ci_019                 1.001948e-02 3 1  ON 18
ci_020                 1.720932e-02 3 1  ON 19
ci_021                 1.692936e-02 3 1  ON 20
ci_022                 9.057977e-03 3 1  ON 21
ci_023                 9.569716e-03 3 1  ON 22
ci_024                 9.600393e-03 3 1  ON 23
ci_025                 9.335357e-03 3 1  ON 24
ci_026                 1.113050e-02 3 1  ON 25
ci_027                 1.154558e-02 3 1  ON 26
ci_028                -1.501181e-02 3 1  ON 27
ci_029                -1.559250e-02 3 1  ON 28
ci_030                -9.425266e-03 3 1  ON 29
ci_031                -9.096251e-03 3 1  ON 30
ci_032                -1.482243e-02 3 1  ON 31
ci_033                 5.659526e-03 3 1  ON 32
ci_034                 5.644464e-03 3 1  ON 33
ci_035                -5.005400e-03 3 1  ON 34
ci_036                -1.251330e-02 3 1  ON 35
ci_037                -1.251317e-02 3 1  ON 36
ci_038                 1.762818e-03 3 1  ON 37
ci_039                 1.671004e-03 3 1  ON 38
ci_040                -2.974362e-03 3 1  ON 39
ci_041                 8.748041e-03 3 1  ON 40
ci_042                 8.868496e-03 3 1  ON 41
ci_043                -4.024385e-03 3 1  ON 42
ci_044                -3.876606e-03 3 1  ON 43
ci_045                -3.273977e-03 3 1  ON 44
ci_046                 5.725622e-03 3 1  ON 45
ci_047                 5.653695e-03 3 1  ON 46
ci_048                -1.251125e-02 3 1  ON 47
ci_049                -1.361518e-02 3 1  ON 48
ci_050                 3.408810e-03 3 1  ON 49
ci_051                 3.264057e-03 3 1  ON 50
ci_052                -2.269083e-03 3 1  ON 51
ci_053                -2.316096e-03 3 1  ON 52
ci_054                -2.962765e-03 3 1  ON 53
ci_055                -2.982268e-03 3 1  ON 54
ci_056                 5.323959e-03 3 1  ON 55
ci_057                 5.166731e-03 3 1  ON 56
ci_058                -1.757197e-03 3 1  ON 57
ci_059                -1.893667e-03 3 1  ON 58
ci_060                 4.916751e-03 3 1  ON 59
ci_061                 5.528204e-03 3 1  ON 60
ci_062                -3.546180e-03 3 1  ON 61
ci_063                -4.152618e-03 3 1  ON 62
ci_064                -3.015221e-03 3 1  ON 63
ci_065                -4.286006e-03 3 1  ON 64
ci_066                 4.513853e-03 3 1  ON 65
ci_067                 4.243585e-03 3 1  ON 66
ci_068                -4.411192e-03 3 1  ON 67
ci_069                -4.736740e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 72
    time step          = 0.05
    reference energy   = -17.2485
    reference variance = 0.548874
====================================================
  Execution time = 1.3854e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s072
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8225e-01
  Total weights = 1.9573e+06
  Execution time = 1.8277e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269019708938
                                         uncertainty =       0.001688924806

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269019708938
                                         uncertainty =       0.001688924806

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366762838
  error estimate for blocks of size 2^( 2) =       0.000380933066
  error estimate for blocks of size 2^( 3) =       0.000393803999
  error estimate for blocks of size 2^( 4) =       0.000403678964
  error estimate for blocks of size 2^( 5) =       0.000409746842
  error estimate for blocks of size 2^( 6) =       0.000413176768
  error estimate for blocks of size 2^( 7) =       0.000416215003

      target function =      -0.940804080164
              le_mean =     -17.211156191440
             les_mean =     296.506335382680
             stat err =       0.000410704394
             autocorr =       1.253972607410
   target nu stat err =       0.000410704394
   target dn stat err =       0.002581572281
      target stat err =       0.004353850844
              std dev =       0.518680980023
             le_variance =       0.269029959038

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268929668227
                                         uncertainty =       0.001680072306

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268929668227
                                         uncertainty =       0.001680072306

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366701305
  error estimate for blocks of size 2^( 2) =       0.000380912574
  error estimate for blocks of size 2^( 3) =       0.000393824731
  error estimate for blocks of size 2^( 4) =       0.000403731405
  error estimate for blocks of size 2^( 5) =       0.000409823351
  error estimate for blocks of size 2^( 6) =       0.000413258103
  error estimate for blocks of size 2^( 7) =       0.000416298509

      target function =      -0.937318498858
              le_mean =     -17.211173179894
             les_mean =     296.509010151069
             stat err =       0.000410777842
             autocorr =       1.254842174818
   target nu stat err =       0.000410777842
   target dn stat err =       0.003817523327
      target stat err =       0.006342963571
              std dev =       0.518593959196
             le_variance =       0.268939694514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268936165991
                                         uncertainty =       0.001682747995

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268936165991
                                         uncertainty =       0.001682747995

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366705799
  error estimate for blocks of size 2^( 2) =       0.000380903952
  error estimate for blocks of size 2^( 3) =       0.000393803045
  error estimate for blocks of size 2^( 4) =       0.000403699956
  error estimate for blocks of size 2^( 5) =       0.000409781115
  error estimate for blocks of size 2^( 6) =       0.000413213226
  error estimate for blocks of size 2^( 7) =       0.000416258011

      target function =      -0.938770961514
              le_mean =     -17.211164882790
             les_mean =     296.507856624637
             stat err =       0.000410738077
             autocorr =       1.254568487678
   target nu stat err =       0.000410738077
   target dn stat err =       0.002917360604
      target stat err =       0.004884471556
              std dev =       0.518600314774
             le_variance =       0.268946286483

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269003505882
                                         uncertainty =       0.001688044632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269003505882
                                         uncertainty =       0.001688044632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366751783
  error estimate for blocks of size 2^( 2) =       0.000380925915
  error estimate for blocks of size 2^( 3) =       0.000393800732
  error estimate for blocks of size 2^( 4) =       0.000403678526
  error estimate for blocks of size 2^( 5) =       0.000409747978
  error estimate for blocks of size 2^( 6) =       0.000413178321
  error estimate for blocks of size 2^( 7) =       0.000416216922

      target function =      -0.941026134145
              le_mean =     -17.211156732203
             les_mean =     296.506220465011
             stat err =       0.000410705437
             autocorr =       1.254054575018
   target nu stat err =       0.000410705437
   target dn stat err =       0.002584377170
      target stat err =       0.004360483970
              std dev =       0.518665344995
             le_variance =       0.269013740099


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940804080164        initial
     1.3878e-01     1.3878e+00             6.4928e-04        -0.937318498858
     5.5511e-01     5.5511e+00             2.1597e-04        -0.938770961514
     2.2204e+00     2.2204e+01             5.8867e-05        -0.941026134145  <--

*****************************************************************************
Applying the update for shift_i =   2.2204e+00     and shift_s =   2.2204e+01
*****************************************************************************

  Execution time = 2.3063e+01
  </log>
  <optVariables href="H2O.s072.opt.xml">
ci_001                -4.151084e-02 3 1  ON 0
ci_002                -3.161281e-02 3 1  ON 1
ci_003                -2.629330e-02 3 1  ON 2
ci_004                 2.368602e-02 3 1  ON 3
ci_005                 2.387338e-02 3 1  ON 4
ci_006                -2.099165e-02 3 1  ON 5
ci_007                -2.041611e-02 3 1  ON 6
ci_008                -8.606014e-03 3 1  ON 7
ci_009                -1.432105e-02 3 1  ON 8
ci_010                -9.731770e-03 3 1  ON 9
ci_011                -1.066934e-02 3 1  ON 10
ci_012                -9.837800e-03 3 1  ON 11
ci_013                -1.996042e-02 3 1  ON 12
ci_014                 1.256132e-02 3 1  ON 13
ci_015                 1.253038e-02 3 1  ON 14
ci_016                 1.715287e-02 3 1  ON 15
ci_017                 1.627061e-02 3 1  ON 16
ci_018                 9.855830e-03 3 1  ON 17
ci_019                 1.001486e-02 3 1  ON 18
ci_020                 1.724514e-02 3 1  ON 19
ci_021                 1.701559e-02 3 1  ON 20
ci_022                 9.164495e-03 3 1  ON 21
ci_023                 9.486833e-03 3 1  ON 22
ci_024                 9.693262e-03 3 1  ON 23
ci_025                 9.492458e-03 3 1  ON 24
ci_026                 1.110086e-02 3 1  ON 25
ci_027                 1.160364e-02 3 1  ON 26
ci_028                -1.494466e-02 3 1  ON 27
ci_029                -1.555809e-02 3 1  ON 28
ci_030                -9.434131e-03 3 1  ON 29
ci_031                -9.006115e-03 3 1  ON 30
ci_032                -1.482383e-02 3 1  ON 31
ci_033                 5.792605e-03 3 1  ON 32
ci_034                 5.612755e-03 3 1  ON 33
ci_035                -5.052454e-03 3 1  ON 34
ci_036                -1.252276e-02 3 1  ON 35
ci_037                -1.247638e-02 3 1  ON 36
ci_038                 1.786470e-03 3 1  ON 37
ci_039                 1.710702e-03 3 1  ON 38
ci_040                -3.016442e-03 3 1  ON 39
ci_041                 8.798356e-03 3 1  ON 40
ci_042                 8.875083e-03 3 1  ON 41
ci_043                -4.005878e-03 3 1  ON 42
ci_044                -4.002225e-03 3 1  ON 43
ci_045                -3.272355e-03 3 1  ON 44
ci_046                 5.722765e-03 3 1  ON 45
ci_047                 5.622134e-03 3 1  ON 46
ci_048                -1.251239e-02 3 1  ON 47
ci_049                -1.369051e-02 3 1  ON 48
ci_050                 3.400818e-03 3 1  ON 49
ci_051                 3.199899e-03 3 1  ON 50
ci_052                -2.257026e-03 3 1  ON 51
ci_053                -2.390199e-03 3 1  ON 52
ci_054                -2.963836e-03 3 1  ON 53
ci_055                -2.946098e-03 3 1  ON 54
ci_056                 5.338084e-03 3 1  ON 55
ci_057                 5.150354e-03 3 1  ON 56
ci_058                -1.670624e-03 3 1  ON 57
ci_059                -1.998838e-03 3 1  ON 58
ci_060                 4.935551e-03 3 1  ON 59
ci_061                 5.550006e-03 3 1  ON 60
ci_062                -3.561045e-03 3 1  ON 61
ci_063                -4.154957e-03 3 1  ON 62
ci_064                -3.000984e-03 3 1  ON 63
ci_065                -4.339758e-03 3 1  ON 64
ci_066                 4.567775e-03 3 1  ON 65
ci_067                 4.292391e-03 3 1  ON 66
ci_068                -4.326817e-03 3 1  ON 67
ci_069                -4.794137e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1354e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s073 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s073 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=73  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.2137
    reference variance = 0.272985
====================================================
  Execution time = 1.4296e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s073
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7670e-01
  Total weights = 1.957164443e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264654011969
                                         uncertainty =       0.001459371736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264654011969
                                         uncertainty =       0.001459371736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363816727
  error estimate for blocks of size 2^( 2) =       0.000378002914
  error estimate for blocks of size 2^( 3) =       0.000390963107
  error estimate for blocks of size 2^( 4) =       0.000400073355
  error estimate for blocks of size 2^( 5) =       0.000405290097
  error estimate for blocks of size 2^( 6) =       0.000408379672
  error estimate for blocks of size 2^( 7) =       0.000408974249

      target function =      -0.950459771755
              le_mean =     -17.211737549817
             les_mean =     296.520611460354
             stat err =       0.000405679343
             autocorr =       1.243370228480
   target nu stat err =       0.000405679343
   target dn stat err =       0.001955819437
      target stat err =       0.003401252900
              std dev =       0.514514549348
             le_variance =       0.264725221491


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721173754982e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e-01, overlap shift 5.5511e+00 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950471011971       residual = 7.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950523460085       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950531722490       residual = 3.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.950534198000       residual = 5.37e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950534618633       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.950534635179       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.950534668610       residual = 3.86e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.950534672948       residual = 9.44e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.950534667893       residual = 2.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.950534669154       residual = 3.50e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e-01 is 2.586961e-04

solving harmonic davidson linear method for identity shift 2.2204e+00, overlap shift 2.2204e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950471011971       residual = 7.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950485501123       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950487724119       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.950488370871       residual = 4.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950488477652       residual = 1.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.950488481746       residual = 2.08e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.950488490071       residual = 3.36e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.950488491461       residual = 8.05e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.950488490134       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.950488490436       residual = 2.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+00 is 7.034333e-05

solving harmonic davidson linear method for identity shift 8.8818e+00, overlap shift 8.8818e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950471011971       residual = 7.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950474731928       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950475298379       residual = 3.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.950475461808       residual = 4.85e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950475488571       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.950475489594       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.950475491669       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.950475492038       residual = 7.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.950475491703       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.950475491777       residual = 2.54e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+00 is 1.798034e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.274096 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6780e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
ci_001                -4.149107e-02 3 1  ON 0
ci_002                -3.161419e-02 3 1  ON 1
ci_003                -2.626973e-02 3 1  ON 2
ci_004                 2.371258e-02 3 1  ON 3
ci_005                 2.384367e-02 3 1  ON 4
ci_006                -2.096429e-02 3 1  ON 5
ci_007                -2.042804e-02 3 1  ON 6
ci_008                -8.594203e-03 3 1  ON 7
ci_009                -1.432833e-02 3 1  ON 8
ci_010                -9.746027e-03 3 1  ON 9
ci_011                -1.064330e-02 3 1  ON 10
ci_012                -9.840942e-03 3 1  ON 11
ci_013                -1.994769e-02 3 1  ON 12
ci_014                 1.258178e-02 3 1  ON 13
ci_015                 1.251060e-02 3 1  ON 14
ci_016                 1.713768e-02 3 1  ON 15
ci_017                 1.629138e-02 3 1  ON 16
ci_018                 9.871449e-03 3 1  ON 17
ci_019                 1.003446e-02 3 1  ON 18
ci_020                 1.719218e-02 3 1  ON 19
ci_021                 1.700419e-02 3 1  ON 20
ci_022                 9.187885e-03 3 1  ON 21
ci_023                 9.501600e-03 3 1  ON 22
ci_024                 9.661612e-03 3 1  ON 23
ci_025                 9.530431e-03 3 1  ON 24
ci_026                 1.110079e-02 3 1  ON 25
ci_027                 1.162139e-02 3 1  ON 26
ci_028                -1.496464e-02 3 1  ON 27
ci_029                -1.548774e-02 3 1  ON 28
ci_030                -9.435403e-03 3 1  ON 29
ci_031                -8.965669e-03 3 1  ON 30
ci_032                -1.485806e-02 3 1  ON 31
ci_033                 5.821545e-03 3 1  ON 32
ci_034                 5.626960e-03 3 1  ON 33
ci_035                -5.045598e-03 3 1  ON 34
ci_036                -1.251586e-02 3 1  ON 35
ci_037                -1.247574e-02 3 1  ON 36
ci_038                 1.775065e-03 3 1  ON 37
ci_039                 1.725076e-03 3 1  ON 38
ci_040                -3.020086e-03 3 1  ON 39
ci_041                 8.792428e-03 3 1  ON 40
ci_042                 8.878220e-03 3 1  ON 41
ci_043                -4.000575e-03 3 1  ON 42
ci_044                -3.994368e-03 3 1  ON 43
ci_045                -3.265983e-03 3 1  ON 44
ci_046                 5.715298e-03 3 1  ON 45
ci_047                 5.629699e-03 3 1  ON 46
ci_048                -1.252929e-02 3 1  ON 47
ci_049                -1.367469e-02 3 1  ON 48
ci_050                 3.396367e-03 3 1  ON 49
ci_051                 3.186680e-03 3 1  ON 50
ci_052                -2.257501e-03 3 1  ON 51
ci_053                -2.396585e-03 3 1  ON 52
ci_054                -2.952595e-03 3 1  ON 53
ci_055                -2.951760e-03 3 1  ON 54
ci_056                 5.363434e-03 3 1  ON 55
ci_057                 5.150458e-03 3 1  ON 56
ci_058                -1.675591e-03 3 1  ON 57
ci_059                -2.014937e-03 3 1  ON 58
ci_060                 4.958710e-03 3 1  ON 59
ci_061                 5.499781e-03 3 1  ON 60
ci_062                -3.581817e-03 3 1  ON 61
ci_063                -4.129884e-03 3 1  ON 62
ci_064                -2.996576e-03 3 1  ON 63
ci_065                -4.336552e-03 3 1  ON 64
ci_066                 4.569049e-03 3 1  ON 65
ci_067                 4.304552e-03 3 1  ON 66
ci_068                -4.329161e-03 3 1  ON 67
ci_069                -4.811733e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 73
    time step          = 0.05
    reference energy   = -17.2606
    reference variance = 0.234537
====================================================
  Execution time = 1.3627e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s073
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8131e-01
  Total weights = 1.9571e+06
  Execution time = 1.8270e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268693294896
                                         uncertainty =       0.001679351891

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268693294896
                                         uncertainty =       0.001679351891

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366517699
  error estimate for blocks of size 2^( 2) =       0.000380441884
  error estimate for blocks of size 2^( 3) =       0.000393219289
  error estimate for blocks of size 2^( 4) =       0.000401745120
  error estimate for blocks of size 2^( 5) =       0.000406544019
  error estimate for blocks of size 2^( 6) =       0.000409602371
  error estimate for blocks of size 2^( 7) =       0.000413663879

      target function =      -0.942451096190
              le_mean =     -17.212057088030
             les_mean =     296.536362729643
             stat err =       0.000407888847
             autocorr =       1.238493572929
   target nu stat err =       0.000407888847
   target dn stat err =       0.002344817643
      target stat err =       0.003985695504
              std dev =       0.518334301442
             le_variance =       0.268670448051

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268692077831
                                         uncertainty =       0.001679307086

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268692077831
                                         uncertainty =       0.001679307086

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366516875
  error estimate for blocks of size 2^( 2) =       0.000380439652
  error estimate for blocks of size 2^( 3) =       0.000393215472
  error estimate for blocks of size 2^( 4) =       0.000401742697
  error estimate for blocks of size 2^( 5) =       0.000406536894
  error estimate for blocks of size 2^( 6) =       0.000409603501
  error estimate for blocks of size 2^( 7) =       0.000413667099

      target function =      -0.942717545699
              le_mean =     -17.212055521502
             les_mean =     296.536149663580
             stat err =       0.000407887548
             autocorr =       1.238491255384
   target nu stat err =       0.000407887548
   target dn stat err =       0.002317683578
      target stat err =       0.003943279075
              std dev =       0.518333135226
             le_variance =       0.268669239073

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268691228069
                                         uncertainty =       0.001679298361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268691228069
                                         uncertainty =       0.001679298361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366516293
  error estimate for blocks of size 2^( 2) =       0.000380439699
  error estimate for blocks of size 2^( 3) =       0.000393215955
  error estimate for blocks of size 2^( 4) =       0.000401742693
  error estimate for blocks of size 2^( 5) =       0.000406539165
  error estimate for blocks of size 2^( 6) =       0.000409601508
  error estimate for blocks of size 2^( 7) =       0.000413663952

      target function =      -0.933746171152
              le_mean =     -17.212055800806
             les_mean =     296.541522900571
             stat err =       0.000407886830
             autocorr =       1.238490827638
   target nu stat err =       0.000407886830
   target dn stat err =       0.005922111786
      target stat err =       0.009744370722
              std dev =       0.518332312046
             le_variance =       0.268668385711

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268692809611
                                         uncertainty =       0.001679340322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268692809611
                                         uncertainty =       0.001679340322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366517369
  error estimate for blocks of size 2^( 2) =       0.000380441456
  error estimate for blocks of size 2^( 3) =       0.000393218826
  error estimate for blocks of size 2^( 4) =       0.000401744730
  error estimate for blocks of size 2^( 5) =       0.000406543228
  error estimate for blocks of size 2^( 6) =       0.000409602070
  error estimate for blocks of size 2^( 7) =       0.000413663717

      target function =      -0.942763950897
              le_mean =     -17.212056954983
             les_mean =     296.536171126568
             stat err =       0.000407888436
             autocorr =       1.238493311723
   target nu stat err =       0.000407888436
   target dn stat err =       0.002334536079
      target stat err =       0.003971385940
              std dev =       0.518333833993
             le_variance =       0.268669963462


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942451096190        initial
     5.5511e-01     5.5511e+00             2.5870e-04        -0.942717545699
     2.2204e+00     2.2204e+01             7.0343e-05        -0.933746171152
     8.8818e+00     8.8818e+01             1.7980e-05        -0.942763950897  <--

*****************************************************************************
Applying the update for shift_i =   8.8818e+00     and shift_s =   8.8818e+01
*****************************************************************************

  Execution time = 2.2850e+01
  </log>
  <optVariables href="H2O.s073.opt.xml">
ci_001                -4.150580e-02 3 1  ON 0
ci_002                -3.161316e-02 3 1  ON 1
ci_003                -2.628727e-02 3 1  ON 2
ci_004                 2.369280e-02 3 1  ON 3
ci_005                 2.386578e-02 3 1  ON 4
ci_006                -2.098466e-02 3 1  ON 5
ci_007                -2.041915e-02 3 1  ON 6
ci_008                -8.602980e-03 3 1  ON 7
ci_009                -1.432292e-02 3 1  ON 8
ci_010                -9.735420e-03 3 1  ON 9
ci_011                -1.066267e-02 3 1  ON 10
ci_012                -9.838604e-03 3 1  ON 11
ci_013                -1.995718e-02 3 1  ON 12
ci_014                 1.256657e-02 3 1  ON 13
ci_015                 1.252532e-02 3 1  ON 14
ci_016                 1.714898e-02 3 1  ON 15
ci_017                 1.627591e-02 3 1  ON 16
ci_018                 9.859842e-03 3 1  ON 17
ci_019                 1.001992e-02 3 1  ON 18
ci_020                 1.723159e-02 3 1  ON 19
ci_021                 1.701266e-02 3 1  ON 20
ci_022                 9.170484e-03 3 1  ON 21
ci_023                 9.490609e-03 3 1  ON 22
ci_024                 9.685164e-03 3 1  ON 23
ci_025                 9.502181e-03 3 1  ON 24
ci_026                 1.110083e-02 3 1  ON 25
ci_027                 1.160821e-02 3 1  ON 26
ci_028                -1.494976e-02 3 1  ON 27
ci_029                -1.554011e-02 3 1  ON 28
ci_030                -9.434443e-03 3 1  ON 29
ci_031                -8.995746e-03 3 1  ON 30
ci_032                -1.483258e-02 3 1  ON 31
ci_033                 5.800009e-03 3 1  ON 32
ci_034                 5.616392e-03 3 1  ON 33
ci_035                -5.050695e-03 3 1  ON 34
ci_036                -1.252100e-02 3 1  ON 35
ci_037                -1.247623e-02 3 1  ON 36
ci_038                 1.783543e-03 3 1  ON 37
ci_039                 1.714392e-03 3 1  ON 38
ci_040                -3.017377e-03 3 1  ON 39
ci_041                 8.796822e-03 3 1  ON 40
ci_042                 8.875927e-03 3 1  ON 41
ci_043                -4.004517e-03 3 1  ON 42
ci_044                -4.000210e-03 3 1  ON 43
ci_045                -3.270718e-03 3 1  ON 44
ci_046                 5.720854e-03 3 1  ON 45
ci_047                 5.624070e-03 3 1  ON 46
ci_048                -1.251671e-02 3 1  ON 47
ci_049                -1.368649e-02 3 1  ON 48
ci_050                 3.399674e-03 3 1  ON 49
ci_051                 3.196497e-03 3 1  ON 50
ci_052                -2.257150e-03 3 1  ON 51
ci_053                -2.391849e-03 3 1  ON 52
ci_054                -2.960965e-03 3 1  ON 53
ci_055                -2.947553e-03 3 1  ON 54
ci_056                 5.344586e-03 3 1  ON 55
ci_057                 5.150380e-03 3 1  ON 56
ci_058                -1.671881e-03 3 1  ON 57
ci_059                -2.002977e-03 3 1  ON 58
ci_060                 4.941480e-03 3 1  ON 59
ci_061                 5.537147e-03 3 1  ON 60
ci_062                -3.566378e-03 3 1  ON 61
ci_063                -4.148519e-03 3 1  ON 62
ci_064                -2.999852e-03 3 1  ON 63
ci_065                -4.338935e-03 3 1  ON 64
ci_066                 4.568110e-03 3 1  ON 65
ci_067                 4.295512e-03 3 1  ON 66
ci_068                -4.327413e-03 3 1  ON 67
ci_069                -4.798642e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9636e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s074 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s074 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=74  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.1661
    reference variance = 1.30094
====================================================
  Execution time = 1.4287e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s074
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5286e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8237e-01
  Total weights = 1.957414548e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4734e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267295053127
                                         uncertainty =       0.001465304168

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267295053127
                                         uncertainty =       0.001465304168

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365610296
  error estimate for blocks of size 2^( 2) =       0.000379293068
  error estimate for blocks of size 2^( 3) =       0.000391573357
  error estimate for blocks of size 2^( 4) =       0.000400782226
  error estimate for blocks of size 2^( 5) =       0.000407082078
  error estimate for blocks of size 2^( 6) =       0.000409735465
  error estimate for blocks of size 2^( 7) =       0.000411218725

      target function =      -0.940902077654
              le_mean =     -17.211745836938
             les_mean =     296.526568148832
             stat err =       0.000407204623
             autocorr =       1.240476570636
   target nu stat err =       0.000407204623
   target dn stat err =       0.003188908588
      target stat err =       0.005358570035
              std dev =       0.517051038965
             le_variance =       0.267341776895


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721174583694e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.2204e+00, overlap shift 2.2204e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940931570697       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940963605579       residual = 1.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940967831714       residual = 5.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940968766158       residual = 8.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940968997689       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940969063476       residual = 3.12e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940969076141       residual = 3.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940969078950       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940969079412       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940969078145       residual = 3.08e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+00 is 9.778984e-05

solving harmonic davidson linear method for identity shift 8.8818e+00, overlap shift 8.8818e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940931570697       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940939792012       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940940869240       residual = 5.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940941105968       residual = 8.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940941164390       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940941180879       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940941184051       residual = 3.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940941184755       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940941184883       residual = 1.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940941184568       residual = 2.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+00 is 2.505842e-05

solving harmonic davidson linear method for identity shift 3.5527e+01, overlap shift 3.5527e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940931570697       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940933639756       residual = 1.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940933910386       residual = 5.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940933969764       residual = 8.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940933984403       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940933988528       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940933989321       residual = 3.16e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940933989497       residual = 1.01e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940933989530       residual = 1.00e-08           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.5527e+01 is 6.301451e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.277388 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6769e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
ci_001                -4.149666e-02 3 1  ON 0
ci_002                -3.160788e-02 3 1  ON 1
ci_003                -2.627137e-02 3 1  ON 2
ci_004                 2.368754e-02 3 1  ON 3
ci_005                 2.386130e-02 3 1  ON 4
ci_006                -2.097767e-02 3 1  ON 5
ci_007                -2.042567e-02 3 1  ON 6
ci_008                -8.604576e-03 3 1  ON 7
ci_009                -1.432042e-02 3 1  ON 8
ci_010                -9.710362e-03 3 1  ON 9
ci_011                -1.065348e-02 3 1  ON 10
ci_012                -9.836004e-03 3 1  ON 11
ci_013                -1.995648e-02 3 1  ON 12
ci_014                 1.256732e-02 3 1  ON 13
ci_015                 1.252473e-02 3 1  ON 14
ci_016                 1.715282e-02 3 1  ON 15
ci_017                 1.628438e-02 3 1  ON 16
ci_018                 9.857862e-03 3 1  ON 17
ci_019                 1.001754e-02 3 1  ON 18
ci_020                 1.722040e-02 3 1  ON 19
ci_021                 1.701152e-02 3 1  ON 20
ci_022                 9.172626e-03 3 1  ON 21
ci_023                 9.483561e-03 3 1  ON 22
ci_024                 9.677484e-03 3 1  ON 23
ci_025                 9.491509e-03 3 1  ON 24
ci_026                 1.109642e-02 3 1  ON 25
ci_027                 1.159944e-02 3 1  ON 26
ci_028                -1.495195e-02 3 1  ON 27
ci_029                -1.553763e-02 3 1  ON 28
ci_030                -9.437282e-03 3 1  ON 29
ci_031                -9.001630e-03 3 1  ON 30
ci_032                -1.483902e-02 3 1  ON 31
ci_033                 5.779431e-03 3 1  ON 32
ci_034                 5.615075e-03 3 1  ON 33
ci_035                -5.050443e-03 3 1  ON 34
ci_036                -1.252130e-02 3 1  ON 35
ci_037                -1.248298e-02 3 1  ON 36
ci_038                 1.781228e-03 3 1  ON 37
ci_039                 1.714559e-03 3 1  ON 38
ci_040                -3.019683e-03 3 1  ON 39
ci_041                 8.802145e-03 3 1  ON 40
ci_042                 8.883220e-03 3 1  ON 41
ci_043                -4.005807e-03 3 1  ON 42
ci_044                -4.022468e-03 3 1  ON 43
ci_045                -3.263237e-03 3 1  ON 44
ci_046                 5.720673e-03 3 1  ON 45
ci_047                 5.625506e-03 3 1  ON 46
ci_048                -1.251359e-02 3 1  ON 47
ci_049                -1.367657e-02 3 1  ON 48
ci_050                 3.405022e-03 3 1  ON 49
ci_051                 3.199801e-03 3 1  ON 50
ci_052                -2.258669e-03 3 1  ON 51
ci_053                -2.395473e-03 3 1  ON 52
ci_054                -2.946861e-03 3 1  ON 53
ci_055                -2.942798e-03 3 1  ON 54
ci_056                 5.340710e-03 3 1  ON 55
ci_057                 5.149012e-03 3 1  ON 56
ci_058                -1.672439e-03 3 1  ON 57
ci_059                -2.001820e-03 3 1  ON 58
ci_060                 4.944451e-03 3 1  ON 59
ci_061                 5.533834e-03 3 1  ON 60
ci_062                -3.569532e-03 3 1  ON 61
ci_063                -4.145509e-03 3 1  ON 62
ci_064                -3.002311e-03 3 1  ON 63
ci_065                -4.340276e-03 3 1  ON 64
ci_066                 4.551720e-03 3 1  ON 65
ci_067                 4.300128e-03 3 1  ON 66
ci_068                -4.319678e-03 3 1  ON 67
ci_069                -4.811191e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 74
    time step          = 0.05
    reference energy   = -17.2104
    reference variance = 0.172687
====================================================
  Execution time = 1.3621e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s074
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7803e-01
  Total weights = 1.9571e+06
  Execution time = 1.8220e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267350827620
                                         uncertainty =       0.001596248493

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267350827620
                                         uncertainty =       0.001596248493

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365630995
  error estimate for blocks of size 2^( 2) =       0.000379667664
  error estimate for blocks of size 2^( 3) =       0.000392538259
  error estimate for blocks of size 2^( 4) =       0.000400964957
  error estimate for blocks of size 2^( 5) =       0.000406435070
  error estimate for blocks of size 2^( 6) =       0.000409132186
  error estimate for blocks of size 2^( 7) =       0.000411563596

      target function =      -0.948186706420
              le_mean =     -17.211669192690
             les_mean =     296.519599617781
             stat err =       0.000407023952
             autocorr =       1.239235724217
   target nu stat err =       0.000407023952
   target dn stat err =       0.001850680240
      target stat err =       0.003212044656
              std dev =       0.517080312574
             le_variance =       0.267372049652

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267341675530
                                         uncertainty =       0.001596710042

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267341675530
                                         uncertainty =       0.001596710042

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365624748
  error estimate for blocks of size 2^( 2) =       0.000379665876
  error estimate for blocks of size 2^( 3) =       0.000392541613
  error estimate for blocks of size 2^( 4) =       0.000400972355
  error estimate for blocks of size 2^( 5) =       0.000406445402
  error estimate for blocks of size 2^( 6) =       0.000409142617
  error estimate for blocks of size 2^( 7) =       0.000411569878

      target function =      -0.948231212656
              le_mean =     -17.211669007053
             les_mean =     296.519566909579
             stat err =       0.000407032563
             autocorr =       1.239330507677
   target nu stat err =       0.000407032563
   target dn stat err =       0.001849708037
      target stat err =       0.003210739472
              std dev =       0.517071477710
             le_variance =       0.267362913061

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267345901512
                                         uncertainty =       0.001596480688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267345901512
                                         uncertainty =       0.001596480688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365627633
  error estimate for blocks of size 2^( 2) =       0.000379666578
  error estimate for blocks of size 2^( 3) =       0.000392539804
  error estimate for blocks of size 2^( 4) =       0.000400968572
  error estimate for blocks of size 2^( 5) =       0.000406440186
  error estimate for blocks of size 2^( 6) =       0.000409137334
  error estimate for blocks of size 2^( 7) =       0.000411566609

      target function =      -0.948226111518
              le_mean =     -17.211669062864
             les_mean =     296.519571845783
             stat err =       0.000407028175
             autocorr =       1.239284234281
   target nu stat err =       0.000407028175
   target dn stat err =       0.001850046022
      target stat err =       0.003211261084
              std dev =       0.517075556938
             le_variance =       0.267367131583

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267350180245
                                         uncertainty =       0.001596277201

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267350180245
                                         uncertainty =       0.001596277201

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365630553
  error estimate for blocks of size 2^( 2) =       0.000379667508
  error estimate for blocks of size 2^( 3) =       0.000392538434
  error estimate for blocks of size 2^( 4) =       0.000400965389
  error estimate for blocks of size 2^( 5) =       0.000406435688
  error estimate for blocks of size 2^( 6) =       0.000409132808
  error estimate for blocks of size 2^( 7) =       0.000411563941

      target function =      -0.948096720817
              le_mean =     -17.211669176922
             les_mean =     296.519652298670
             stat err =       0.000407024457
             autocorr =       1.239241790957
   target nu stat err =       0.000407024457
   target dn stat err =       0.001851499780
      target stat err =       0.003212800244
              std dev =       0.517079687577
             le_variance =       0.267371403305


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948186706420        initial
     2.2204e+00     2.2204e+01             9.7790e-05        -0.948231212656  <--
     8.8818e+00     8.8818e+01             2.5058e-05        -0.948226111518
     3.5527e+01     3.5527e+02             6.3015e-06        -0.948096720817

*****************************************************************************
Applying the update for shift_i =   2.2204e+00     and shift_s =   2.2204e+01
*****************************************************************************

  Execution time = 2.2849e+01
  </log>
  <optVariables href="H2O.s074.opt.xml">
ci_001                -4.146997e-02 3 1  ON 0
ci_002                -3.159248e-02 3 1  ON 1
ci_003                -2.622515e-02 3 1  ON 2
ci_004                 2.367214e-02 3 1  ON 3
ci_005                 2.384819e-02 3 1  ON 4
ci_006                -2.095725e-02 3 1  ON 5
ci_007                -2.044468e-02 3 1  ON 6
ci_008                -8.609178e-03 3 1  ON 7
ci_009                -1.431315e-02 3 1  ON 8
ci_010                -9.637631e-03 3 1  ON 9
ci_011                -1.062680e-02 3 1  ON 10
ci_012                -9.828472e-03 3 1  ON 11
ci_013                -1.995446e-02 3 1  ON 12
ci_014                 1.256951e-02 3 1  ON 13
ci_015                 1.252305e-02 3 1  ON 14
ci_016                 1.716406e-02 3 1  ON 15
ci_017                 1.630910e-02 3 1  ON 16
ci_018                 9.852138e-03 3 1  ON 17
ci_019                 1.001056e-02 3 1  ON 18
ci_020                 1.718777e-02 3 1  ON 19
ci_021                 1.700819e-02 3 1  ON 20
ci_022                 9.178829e-03 3 1  ON 21
ci_023                 9.463042e-03 3 1  ON 22
ci_024                 9.655145e-03 3 1  ON 23
ci_025                 9.460374e-03 3 1  ON 24
ci_026                 1.108360e-02 3 1  ON 25
ci_027                 1.157402e-02 3 1  ON 26
ci_028                -1.495843e-02 3 1  ON 27
ci_029                -1.553053e-02 3 1  ON 28
ci_030                -9.445444e-03 3 1  ON 29
ci_031                -9.018544e-03 3 1  ON 30
ci_032                -1.485776e-02 3 1  ON 31
ci_033                 5.719665e-03 3 1  ON 32
ci_034                 5.611214e-03 3 1  ON 33
ci_035                -5.049717e-03 3 1  ON 34
ci_036                -1.252209e-02 3 1  ON 35
ci_037                -1.250244e-02 3 1  ON 36
ci_038                 1.774522e-03 3 1  ON 37
ci_039                 1.715054e-03 3 1  ON 38
ci_040                -3.026363e-03 3 1  ON 39
ci_041                 8.817613e-03 3 1  ON 40
ci_042                 8.904340e-03 3 1  ON 41
ci_043                -4.009549e-03 3 1  ON 42
ci_044                -4.087106e-03 3 1  ON 43
ci_045                -3.241578e-03 3 1  ON 44
ci_046                 5.720147e-03 3 1  ON 45
ci_047                 5.629677e-03 3 1  ON 46
ci_048                -1.250460e-02 3 1  ON 47
ci_049                -1.364777e-02 3 1  ON 48
ci_050                 3.420480e-03 3 1  ON 49
ci_051                 3.209363e-03 3 1  ON 50
ci_052                -2.263111e-03 3 1  ON 51
ci_053                -2.405970e-03 3 1  ON 52
ci_054                -2.905950e-03 3 1  ON 53
ci_055                -2.929021e-03 3 1  ON 54
ci_056                 5.329466e-03 3 1  ON 55
ci_057                 5.145050e-03 3 1  ON 56
ci_058                -1.674035e-03 3 1  ON 57
ci_059                -1.998473e-03 3 1  ON 58
ci_060                 4.953093e-03 3 1  ON 59
ci_061                 5.524195e-03 3 1  ON 60
ci_062                -3.578649e-03 3 1  ON 61
ci_063                -4.136714e-03 3 1  ON 62
ci_064                -3.009426e-03 3 1  ON 63
ci_065                -4.344157e-03 3 1  ON 64
ci_066                 4.504275e-03 3 1  ON 65
ci_067                 4.313523e-03 3 1  ON 66
ci_068                -4.297221e-03 3 1  ON 67
ci_069                -4.847677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9624e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s075 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s075 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=75  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.1877
    reference variance = 0.350918
====================================================
  Execution time = 1.4177e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s075
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5311e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7567e-01
  Total weights = 1.957316098e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4628e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264383818826
                                         uncertainty =       0.001636019941

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264383818826
                                         uncertainty =       0.001636019941

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363607693
  error estimate for blocks of size 2^( 2) =       0.000377464831
  error estimate for blocks of size 2^( 3) =       0.000389820375
  error estimate for blocks of size 2^( 4) =       0.000399096421
  error estimate for blocks of size 2^( 5) =       0.000404317577
  error estimate for blocks of size 2^( 6) =       0.000407803913
  error estimate for blocks of size 2^( 7) =       0.000408818918

      target function =      -0.952218954892
              le_mean =     -17.211963492422
             les_mean =     296.527357816263
             stat err =       0.000405009207
             autocorr =       1.240691093880
   target nu stat err =       0.000405009207
   target dn stat err =       0.002087116226
      target stat err =       0.003633968009
              std dev =       0.514218931433
             le_variance =       0.264421109444


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721196349242e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e-01, overlap shift 5.5511e+00 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952231728967       residual = 8.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952280283218       residual = 7.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952286181098       residual = 2.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.952287673602       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.952287861998       residual = 8.72e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.952287787831       residual = 2.77e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.952287775021       residual = 4.82e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.952287813815       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.952287807744       residual = 2.43e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.952287803574       residual = 8.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e-01 is 1.971631e-04

solving harmonic davidson linear method for identity shift 2.2204e+00, overlap shift 2.2204e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952231728967       residual = 8.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952245164369       residual = 7.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952246761079       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.952247151452       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.952247200253       residual = 7.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.952247180215       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.952247176837       residual = 4.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.952247186564       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.952247184998       residual = 1.93e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.952247183970       residual = 6.28e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+00 is 5.405230e-05

solving harmonic davidson linear method for identity shift 8.8818e+00, overlap shift 8.8818e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952231728967       residual = 8.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952235179986       residual = 7.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952235587568       residual = 2.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.952235686243       residual = 3.08e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.952235698549       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.952235693440       residual = 2.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.952235692585       residual = 3.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.952235695014       residual = 8.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.952235694620       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.952235694364       residual = 5.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+00 is 1.384751e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.280844 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6648e+01
  </log>
  <optVariables href="H2O.s075.opt.xml">
ci_001                -4.144456e-02 3 1  ON 0
ci_002                -3.158897e-02 3 1  ON 1
ci_003                -2.619508e-02 3 1  ON 2
ci_004                 2.367331e-02 3 1  ON 3
ci_005                 2.384191e-02 3 1  ON 4
ci_006                -2.094612e-02 3 1  ON 5
ci_007                -2.046739e-02 3 1  ON 6
ci_008                -8.611598e-03 3 1  ON 7
ci_009                -1.430631e-02 3 1  ON 8
ci_010                -9.691683e-03 3 1  ON 9
ci_011                -1.062648e-02 3 1  ON 10
ci_012                -9.814873e-03 3 1  ON 11
ci_013                -1.996016e-02 3 1  ON 12
ci_014                 1.256095e-02 3 1  ON 13
ci_015                 1.250933e-02 3 1  ON 14
ci_016                 1.716090e-02 3 1  ON 15
ci_017                 1.628452e-02 3 1  ON 16
ci_018                 9.869162e-03 3 1  ON 17
ci_019                 9.989023e-03 3 1  ON 18
ci_020                 1.720472e-02 3 1  ON 19
ci_021                 1.700037e-02 3 1  ON 20
ci_022                 9.187694e-03 3 1  ON 21
ci_023                 9.461257e-03 3 1  ON 22
ci_024                 9.650169e-03 3 1  ON 23
ci_025                 9.493702e-03 3 1  ON 24
ci_026                 1.106176e-02 3 1  ON 25
ci_027                 1.155196e-02 3 1  ON 26
ci_028                -1.497020e-02 3 1  ON 27
ci_029                -1.552784e-02 3 1  ON 28
ci_030                -9.478322e-03 3 1  ON 29
ci_031                -9.056726e-03 3 1  ON 30
ci_032                -1.486742e-02 3 1  ON 31
ci_033                 5.716834e-03 3 1  ON 32
ci_034                 5.633731e-03 3 1  ON 33
ci_035                -5.041675e-03 3 1  ON 34
ci_036                -1.249954e-02 3 1  ON 35
ci_037                -1.251720e-02 3 1  ON 36
ci_038                 1.794000e-03 3 1  ON 37
ci_039                 1.702040e-03 3 1  ON 38
ci_040                -3.023681e-03 3 1  ON 39
ci_041                 8.806265e-03 3 1  ON 40
ci_042                 8.893840e-03 3 1  ON 41
ci_043                -4.007195e-03 3 1  ON 42
ci_044                -4.098347e-03 3 1  ON 43
ci_045                -3.227540e-03 3 1  ON 44
ci_046                 5.719946e-03 3 1  ON 45
ci_047                 5.642586e-03 3 1  ON 46
ci_048                -1.251971e-02 3 1  ON 47
ci_049                -1.363369e-02 3 1  ON 48
ci_050                 3.403894e-03 3 1  ON 49
ci_051                 3.190649e-03 3 1  ON 50
ci_052                -2.305911e-03 3 1  ON 51
ci_053                -2.411818e-03 3 1  ON 52
ci_054                -2.891052e-03 3 1  ON 53
ci_055                -2.906389e-03 3 1  ON 54
ci_056                 5.315040e-03 3 1  ON 55
ci_057                 5.139220e-03 3 1  ON 56
ci_058                -1.659467e-03 3 1  ON 57
ci_059                -2.009684e-03 3 1  ON 58
ci_060                 4.929213e-03 3 1  ON 59
ci_061                 5.523751e-03 3 1  ON 60
ci_062                -3.593487e-03 3 1  ON 61
ci_063                -4.111741e-03 3 1  ON 62
ci_064                -3.008399e-03 3 1  ON 63
ci_065                -4.353623e-03 3 1  ON 64
ci_066                 4.511187e-03 3 1  ON 65
ci_067                 4.313772e-03 3 1  ON 66
ci_068                -4.326939e-03 3 1  ON 67
ci_069                -4.868681e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 75
    time step          = 0.05
    reference energy   = -17.2104
    reference variance = 0.307329
====================================================
  Execution time = 1.3956e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s075
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7745e-01
  Total weights = 1.9569e+06
  Execution time = 1.8175e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266885636394
                                         uncertainty =       0.001514356066

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266885636394
                                         uncertainty =       0.001514356066

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365287573
  error estimate for blocks of size 2^( 2) =       0.000379401529
  error estimate for blocks of size 2^( 3) =       0.000392430426
  error estimate for blocks of size 2^( 4) =       0.000402076862
  error estimate for blocks of size 2^( 5) =       0.000407313917
  error estimate for blocks of size 2^( 6) =       0.000409364622
  error estimate for blocks of size 2^( 7) =       0.000412137571

      target function =      -0.949324104317
              le_mean =     -17.211909166691
             les_mean =     296.527190271112
             stat err =       0.000407723243
             autocorr =       1.245836769600
   target nu stat err =       0.000407723243
   target dn stat err =       0.001927392205
      target stat err =       0.003348127776
              std dev =       0.516594639991
             le_variance =       0.266870022068

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266884421256
                                         uncertainty =       0.001517560022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266884421256
                                         uncertainty =       0.001517560022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365286731
  error estimate for blocks of size 2^( 2) =       0.000379397143
  error estimate for blocks of size 2^( 3) =       0.000392424428
  error estimate for blocks of size 2^( 4) =       0.000402070036
  error estimate for blocks of size 2^( 5) =       0.000407314444
  error estimate for blocks of size 2^( 6) =       0.000409366533
  error estimate for blocks of size 2^( 7) =       0.000412134469

      target function =      -0.945132502386
              le_mean =     -17.211910176078
             les_mean =     296.529697530387
             stat err =       0.000407721370
             autocorr =       1.245831069547
   target nu stat err =       0.000407721370
   target dn stat err =       0.003114922560
      target stat err =       0.005285021025
              std dev =       0.516593448913
             le_variance =       0.266868791460

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266883529723
                                         uncertainty =       0.001516114986

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266883529723
                                         uncertainty =       0.001516114986

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365286125
  error estimate for blocks of size 2^( 2) =       0.000379398328
  error estimate for blocks of size 2^( 3) =       0.000392426275
  error estimate for blocks of size 2^( 4) =       0.000402072387
  error estimate for blocks of size 2^( 5) =       0.000407313495
  error estimate for blocks of size 2^( 6) =       0.000409365151
  error estimate for blocks of size 2^( 7) =       0.000412135132

      target function =      -0.949146680295
              le_mean =     -17.211909402170
             les_mean =     296.527302995468
             stat err =       0.000407721541
             autocorr =       1.245836243172
   target nu stat err =       0.000407721541
   target dn stat err =       0.001934141409
      target stat err =       0.003358073348
              std dev =       0.516592592627
             le_variance =       0.266867906757

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266885180905
                                         uncertainty =       0.001514579451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266885180905
                                         uncertainty =       0.001514579451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365287261
  error estimate for blocks of size 2^( 2) =       0.000379400994
  error estimate for blocks of size 2^( 3) =       0.000392429769
  error estimate for blocks of size 2^( 4) =       0.000402076167
  error estimate for blocks of size 2^( 5) =       0.000407313741
  error estimate for blocks of size 2^( 6) =       0.000409364575
  error estimate for blocks of size 2^( 7) =       0.000412137141

      target function =      -0.949320349675
              le_mean =     -17.211909171441
             les_mean =     296.527192644959
             stat err =       0.000407722906
             autocorr =       1.245836840092
   target nu stat err =       0.000407722906
   target dn stat err =       0.001927986911
      target stat err =       0.003349086052
              std dev =       0.516594198085
             le_variance =       0.266869565495


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949324104317        initial  <--
     5.5511e-01     5.5511e+00             1.9716e-04        -0.945132502386
     2.2204e+00     2.2204e+01             5.4052e-05        -0.949146680295
     8.8818e+00     8.8818e+01             1.3848e-05        -0.949320349675

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1125
  </log>
  <optVariables href="H2O.s075.opt.xml">
ci_001                -4.146997e-02 3 1  ON 0
ci_002                -3.159248e-02 3 1  ON 1
ci_003                -2.622515e-02 3 1  ON 2
ci_004                 2.367214e-02 3 1  ON 3
ci_005                 2.384819e-02 3 1  ON 4
ci_006                -2.095725e-02 3 1  ON 5
ci_007                -2.044468e-02 3 1  ON 6
ci_008                -8.609178e-03 3 1  ON 7
ci_009                -1.431315e-02 3 1  ON 8
ci_010                -9.637631e-03 3 1  ON 9
ci_011                -1.062680e-02 3 1  ON 10
ci_012                -9.828472e-03 3 1  ON 11
ci_013                -1.995446e-02 3 1  ON 12
ci_014                 1.256951e-02 3 1  ON 13
ci_015                 1.252305e-02 3 1  ON 14
ci_016                 1.716406e-02 3 1  ON 15
ci_017                 1.630910e-02 3 1  ON 16
ci_018                 9.852138e-03 3 1  ON 17
ci_019                 1.001056e-02 3 1  ON 18
ci_020                 1.718777e-02 3 1  ON 19
ci_021                 1.700819e-02 3 1  ON 20
ci_022                 9.178829e-03 3 1  ON 21
ci_023                 9.463042e-03 3 1  ON 22
ci_024                 9.655145e-03 3 1  ON 23
ci_025                 9.460374e-03 3 1  ON 24
ci_026                 1.108360e-02 3 1  ON 25
ci_027                 1.157402e-02 3 1  ON 26
ci_028                -1.495843e-02 3 1  ON 27
ci_029                -1.553053e-02 3 1  ON 28
ci_030                -9.445444e-03 3 1  ON 29
ci_031                -9.018544e-03 3 1  ON 30
ci_032                -1.485776e-02 3 1  ON 31
ci_033                 5.719665e-03 3 1  ON 32
ci_034                 5.611214e-03 3 1  ON 33
ci_035                -5.049717e-03 3 1  ON 34
ci_036                -1.252209e-02 3 1  ON 35
ci_037                -1.250244e-02 3 1  ON 36
ci_038                 1.774522e-03 3 1  ON 37
ci_039                 1.715054e-03 3 1  ON 38
ci_040                -3.026363e-03 3 1  ON 39
ci_041                 8.817613e-03 3 1  ON 40
ci_042                 8.904340e-03 3 1  ON 41
ci_043                -4.009549e-03 3 1  ON 42
ci_044                -4.087106e-03 3 1  ON 43
ci_045                -3.241578e-03 3 1  ON 44
ci_046                 5.720147e-03 3 1  ON 45
ci_047                 5.629677e-03 3 1  ON 46
ci_048                -1.250460e-02 3 1  ON 47
ci_049                -1.364777e-02 3 1  ON 48
ci_050                 3.420480e-03 3 1  ON 49
ci_051                 3.209363e-03 3 1  ON 50
ci_052                -2.263111e-03 3 1  ON 51
ci_053                -2.405970e-03 3 1  ON 52
ci_054                -2.905950e-03 3 1  ON 53
ci_055                -2.929021e-03 3 1  ON 54
ci_056                 5.329466e-03 3 1  ON 55
ci_057                 5.145050e-03 3 1  ON 56
ci_058                -1.674035e-03 3 1  ON 57
ci_059                -1.998473e-03 3 1  ON 58
ci_060                 4.953093e-03 3 1  ON 59
ci_061                 5.524195e-03 3 1  ON 60
ci_062                -3.578649e-03 3 1  ON 61
ci_063                -4.136714e-03 3 1  ON 62
ci_064                -3.009426e-03 3 1  ON 63
ci_065                -4.344157e-03 3 1  ON 64
ci_066                 4.504275e-03 3 1  ON 65
ci_067                 4.313523e-03 3 1  ON 66
ci_068                -4.297221e-03 3 1  ON 67
ci_069                -4.847677e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9767e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s076 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s076 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=76  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.237
    reference variance = 0.174641
====================================================
  Execution time = 1.4013e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s076
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5295e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7537e-01
  Total weights = 1.957522272e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4746e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265932210598
                                         uncertainty =       0.001393420037

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265932210598
                                         uncertainty =       0.001393420037

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364634610
  error estimate for blocks of size 2^( 2) =       0.000378486885
  error estimate for blocks of size 2^( 3) =       0.000391504168
  error estimate for blocks of size 2^( 4) =       0.000401043788
  error estimate for blocks of size 2^( 5) =       0.000407191886
  error estimate for blocks of size 2^( 6) =       0.000410947285
  error estimate for blocks of size 2^( 7) =       0.000413856133

      target function =      -0.952752493285
              le_mean =     -17.212557447651
             les_mean =     296.547501488244
             stat err =       0.000408259773
             autocorr =       1.253595436850
   target nu stat err =       0.000408259773
   target dn stat err =       0.001785402852
      target stat err =       0.003139544116
              std dev =       0.515671211118
             le_variance =       0.265916797976


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721255744765e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+00, overlap shift 5.5511e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952761833430       residual = 5.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952765734742       residual = 9.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952766389244       residual = 1.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.952766604202       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.952766637975       residual = 9.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.952766630950       residual = 1.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.952766643327       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.952766643005       residual = 5.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.952766643071       residual = 1.31e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.952766643485       residual = 2.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+00 is 1.477277e-05

solving harmonic davidson linear method for identity shift 2.2204e+01, overlap shift 2.2204e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952761833430       residual = 5.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952762819288       residual = 9.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952762984246       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.952763038278       residual = 3.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.952763046730       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.952763044947       residual = 1.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.952763048054       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.952763047967       residual = 4.86e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.952763047989       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.952763048090       residual = 2.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+01 is 3.728766e-06

solving harmonic davidson linear method for identity shift 8.8818e+01, overlap shift 8.8818e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952761833430       residual = 5.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952762080561       residual = 9.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952762121885       residual = 1.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.952762135411       residual = 3.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.952762137525       residual = 9.00e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.952762137078       residual = 1.51e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.952762137855       residual = 1.90e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.952762137833       residual = 4.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.952762137839       residual = 1.25e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.952762137864       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+01 is 9.344416e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.284308 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6497e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
ci_001                -4.146825e-02 3 1  ON 0
ci_002                -3.159199e-02 3 1  ON 1
ci_003                -2.622224e-02 3 1  ON 2
ci_004                 2.367372e-02 3 1  ON 3
ci_005                 2.384917e-02 3 1  ON 4
ci_006                -2.095457e-02 3 1  ON 5
ci_007                -2.044466e-02 3 1  ON 6
ci_008                -8.609984e-03 3 1  ON 7
ci_009                -1.431255e-02 3 1  ON 8
ci_010                -9.634926e-03 3 1  ON 9
ci_011                -1.062425e-02 3 1  ON 10
ci_012                -9.825450e-03 3 1  ON 11
ci_013                -1.995271e-02 3 1  ON 12
ci_014                 1.257141e-02 3 1  ON 13
ci_015                 1.252193e-02 3 1  ON 14
ci_016                 1.716072e-02 3 1  ON 15
ci_017                 1.630813e-02 3 1  ON 16
ci_018                 9.855143e-03 3 1  ON 17
ci_019                 1.001048e-02 3 1  ON 18
ci_020                 1.718812e-02 3 1  ON 19
ci_021                 1.701128e-02 3 1  ON 20
ci_022                 9.182383e-03 3 1  ON 21
ci_023                 9.461275e-03 3 1  ON 22
ci_024                 9.652204e-03 3 1  ON 23
ci_025                 9.459614e-03 3 1  ON 24
ci_026                 1.108407e-02 3 1  ON 25
ci_027                 1.157039e-02 3 1  ON 26
ci_028                -1.496065e-02 3 1  ON 27
ci_029                -1.552968e-02 3 1  ON 28
ci_030                -9.445152e-03 3 1  ON 29
ci_031                -9.018518e-03 3 1  ON 30
ci_032                -1.485684e-02 3 1  ON 31
ci_033                 5.719704e-03 3 1  ON 32
ci_034                 5.610301e-03 3 1  ON 33
ci_035                -5.049932e-03 3 1  ON 34
ci_036                -1.252343e-02 3 1  ON 35
ci_037                -1.250395e-02 3 1  ON 36
ci_038                 1.773648e-03 3 1  ON 37
ci_039                 1.715773e-03 3 1  ON 38
ci_040                -3.025977e-03 3 1  ON 39
ci_041                 8.818381e-03 3 1  ON 40
ci_042                 8.903081e-03 3 1  ON 41
ci_043                -4.008270e-03 3 1  ON 42
ci_044                -4.086421e-03 3 1  ON 43
ci_045                -3.240844e-03 3 1  ON 44
ci_046                 5.721666e-03 3 1  ON 45
ci_047                 5.629122e-03 3 1  ON 46
ci_048                -1.250458e-02 3 1  ON 47
ci_049                -1.364855e-02 3 1  ON 48
ci_050                 3.421870e-03 3 1  ON 49
ci_051                 3.209304e-03 3 1  ON 50
ci_052                -2.264388e-03 3 1  ON 51
ci_053                -2.407512e-03 3 1  ON 52
ci_054                -2.904812e-03 3 1  ON 53
ci_055                -2.929045e-03 3 1  ON 54
ci_056                 5.327580e-03 3 1  ON 55
ci_057                 5.144614e-03 3 1  ON 56
ci_058                -1.676032e-03 3 1  ON 57
ci_059                -1.998461e-03 3 1  ON 58
ci_060                 4.952020e-03 3 1  ON 59
ci_061                 5.523277e-03 3 1  ON 60
ci_062                -3.581282e-03 3 1  ON 61
ci_063                -4.133927e-03 3 1  ON 62
ci_064                -3.010464e-03 3 1  ON 63
ci_065                -4.343988e-03 3 1  ON 64
ci_066                 4.506238e-03 3 1  ON 65
ci_067                 4.314952e-03 3 1  ON 66
ci_068                -4.300950e-03 3 1  ON 67
ci_069                -4.849975e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 76
    time step          = 0.05
    reference energy   = -17.1544
    reference variance = 0.203501
====================================================
  Execution time = 1.6144e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s076
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8106e-01
  Total weights = 1.9575e+06
  Execution time = 1.8201e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268639017165
                                         uncertainty =       0.001483628972

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268639017165
                                         uncertainty =       0.001483628972

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366433265
  error estimate for blocks of size 2^( 2) =       0.000379997823
  error estimate for blocks of size 2^( 3) =       0.000392264253
  error estimate for blocks of size 2^( 4) =       0.000401481225
  error estimate for blocks of size 2^( 5) =       0.000407648298
  error estimate for blocks of size 2^( 6) =       0.000411434984
  error estimate for blocks of size 2^( 7) =       0.000413269439

      target function =      -0.943104406037
              le_mean =     -17.211996939038
             les_mean =     296.533902556303
             stat err =       0.000408458486
             autocorr =       1.242527650701
   target nu stat err =       0.000408458486
   target dn stat err =       0.002205188935
      target stat err =       0.003761288956
              std dev =       0.518214893246
             le_variance =       0.268546675582

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268638836518
                                         uncertainty =       0.001483716966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268638836518
                                         uncertainty =       0.001483716966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366433150
  error estimate for blocks of size 2^( 2) =       0.000379997873
  error estimate for blocks of size 2^( 3) =       0.000392264543
  error estimate for blocks of size 2^( 4) =       0.000401481881
  error estimate for blocks of size 2^( 5) =       0.000407649546
  error estimate for blocks of size 2^( 6) =       0.000411436971
  error estimate for blocks of size 2^( 7) =       0.000413271465

      target function =      -0.943109164599
              le_mean =     -17.211997020448
             les_mean =     296.533902517688
             stat err =       0.000408459966
             autocorr =       1.242537434098
   target nu stat err =       0.000408459966
   target dn stat err =       0.002204948403
      target stat err =       0.003760932248
              std dev =       0.518214730094
             le_variance =       0.268546506487

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268638912223
                                         uncertainty =       0.001483673185

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268638912223
                                         uncertainty =       0.001483673185

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366433198
  error estimate for blocks of size 2^( 2) =       0.000379997838
  error estimate for blocks of size 2^( 3) =       0.000392264389
  error estimate for blocks of size 2^( 4) =       0.000401481546
  error estimate for blocks of size 2^( 5) =       0.000407648917
  error estimate for blocks of size 2^( 6) =       0.000411435978
  error estimate for blocks of size 2^( 7) =       0.000413270453

      target function =      -0.943107778443
              le_mean =     -17.211996978265
             les_mean =     296.533901892843
             stat err =       0.000408459223
             autocorr =       1.242532593759
   target nu stat err =       0.000408459223
   target dn stat err =       0.002205054990
      target stat err =       0.003761095899
              std dev =       0.518214797629
             le_variance =       0.268546576482

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268639002478
                                         uncertainty =       0.001483634488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268639002478
                                         uncertainty =       0.001483634488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366433256
  error estimate for blocks of size 2^( 2) =       0.000379997824
  error estimate for blocks of size 2^( 3) =       0.000392264268
  error estimate for blocks of size 2^( 4) =       0.000401481264
  error estimate for blocks of size 2^( 5) =       0.000407648374
  error estimate for blocks of size 2^( 6) =       0.000411435108
  error estimate for blocks of size 2^( 7) =       0.000413269565

      target function =      -0.943104928091
              le_mean =     -17.211996943731
             les_mean =     296.533902406118
             stat err =       0.000408458578
             autocorr =       1.242528271057
   target nu stat err =       0.000408458578
   target dn stat err =       0.002205170722
      target stat err =       0.003761263195
              std dev =       0.518214879782
             le_variance =       0.268546661628


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943104406037        initial
     5.5511e+00     5.5511e+01             1.4773e-05        -0.943109164599  <--
     2.2204e+01     2.2204e+02             3.7288e-06        -0.943107778443
     8.8818e+01     8.8818e+02             9.3444e-07        -0.943104928091

*****************************************************************************
Applying the update for shift_i =   5.5511e+00     and shift_s =   5.5511e+01
*****************************************************************************

  Execution time = 2.5346e+01
  </log>
  <optVariables href="H2O.s076.opt.xml">
ci_001                -4.146316e-02 3 1  ON 0
ci_002                -3.159055e-02 3 1  ON 1
ci_003                -2.621364e-02 3 1  ON 2
ci_004                 2.367841e-02 3 1  ON 3
ci_005                 2.385205e-02 3 1  ON 4
ci_006                -2.094659e-02 3 1  ON 5
ci_007                -2.044460e-02 3 1  ON 6
ci_008                -8.612369e-03 3 1  ON 7
ci_009                -1.431078e-02 3 1  ON 8
ci_010                -9.626919e-03 3 1  ON 9
ci_011                -1.061671e-02 3 1  ON 10
ci_012                -9.816507e-03 3 1  ON 11
ci_013                -1.994750e-02 3 1  ON 12
ci_014                 1.257702e-02 3 1  ON 13
ci_015                 1.251861e-02 3 1  ON 14
ci_016                 1.715083e-02 3 1  ON 15
ci_017                 1.630526e-02 3 1  ON 16
ci_018                 9.864039e-03 3 1  ON 17
ci_019                 1.001025e-02 3 1  ON 18
ci_020                 1.718915e-02 3 1  ON 19
ci_021                 1.702046e-02 3 1  ON 20
ci_022                 9.192905e-03 3 1  ON 21
ci_023                 9.456036e-03 3 1  ON 22
ci_024                 9.643488e-03 3 1  ON 23
ci_025                 9.457350e-03 3 1  ON 24
ci_026                 1.108548e-02 3 1  ON 25
ci_027                 1.155967e-02 3 1  ON 26
ci_028                -1.496724e-02 3 1  ON 27
ci_029                -1.552715e-02 3 1  ON 28
ci_030                -9.444289e-03 3 1  ON 29
ci_031                -9.018444e-03 3 1  ON 30
ci_032                -1.485412e-02 3 1  ON 31
ci_033                 5.719815e-03 3 1  ON 32
ci_034                 5.607589e-03 3 1  ON 33
ci_035                -5.050569e-03 3 1  ON 34
ci_036                -1.252739e-02 3 1  ON 35
ci_037                -1.250839e-02 3 1  ON 36
ci_038                 1.771062e-03 3 1  ON 37
ci_039                 1.717900e-03 3 1  ON 38
ci_040                -3.024835e-03 3 1  ON 39
ci_041                 8.820662e-03 3 1  ON 40
ci_042                 8.899356e-03 3 1  ON 41
ci_043                -4.004487e-03 3 1  ON 42
ci_044                -4.084395e-03 3 1  ON 43
ci_045                -3.238675e-03 3 1  ON 44
ci_046                 5.726164e-03 3 1  ON 45
ci_047                 5.627476e-03 3 1  ON 46
ci_048                -1.250454e-02 3 1  ON 47
ci_049                -1.365086e-02 3 1  ON 48
ci_050                 3.425980e-03 3 1  ON 49
ci_051                 3.209128e-03 3 1  ON 50
ci_052                -2.268168e-03 3 1  ON 51
ci_053                -2.412064e-03 3 1  ON 52
ci_054                -2.901445e-03 3 1  ON 53
ci_055                -2.929113e-03 3 1  ON 54
ci_056                 5.321997e-03 3 1  ON 55
ci_057                 5.143323e-03 3 1  ON 56
ci_058                -1.681942e-03 3 1  ON 57
ci_059                -1.998421e-03 3 1  ON 58
ci_060                 4.948842e-03 3 1  ON 59
ci_061                 5.520558e-03 3 1  ON 60
ci_062                -3.589070e-03 3 1  ON 61
ci_063                -4.125676e-03 3 1  ON 62
ci_064                -3.013531e-03 3 1  ON 63
ci_065                -4.343487e-03 3 1  ON 64
ci_066                 4.512047e-03 3 1  ON 65
ci_067                 4.319180e-03 3 1  ON 66
ci_068                -4.311994e-03 3 1  ON 67
ci_069                -4.856782e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1849e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s077 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s077 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=77  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.2507
    reference variance = 0.173473
====================================================
  Execution time = 1.4174e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s077
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5282e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7951e-01
  Total weights = 1.957132450e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4720e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268126454514
                                         uncertainty =       0.001418457678

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268126454514
                                         uncertainty =       0.001418457678

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366126287
  error estimate for blocks of size 2^( 2) =       0.000380310007
  error estimate for blocks of size 2^( 3) =       0.000392630342
  error estimate for blocks of size 2^( 4) =       0.000401972517
  error estimate for blocks of size 2^( 5) =       0.000407016143
  error estimate for blocks of size 2^( 6) =       0.000408139328
  error estimate for blocks of size 2^( 7) =       0.000408942375

      target function =      -0.945709277985
              le_mean =     -17.212014599049
             les_mean =     296.532958027954
             stat err =       0.000406517591
             autocorr =       1.232812027640
   target nu stat err =       0.000406517591
   target dn stat err =       0.002252699614
      target stat err =       0.003859688598
              std dev =       0.517780760925
             le_variance =       0.268096916385


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721201459905e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+00, overlap shift 1.3878e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945723997124       residual = 7.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945744260416       residual = 8.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945747471002       residual = 2.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945748307108       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945748572793       residual = 8.89e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945748522874       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945748519101       residual = 4.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945748544803       residual = 1.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945748550051       residual = 1.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945748547943       residual = 5.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+00 is 7.540718e-05

solving harmonic davidson linear method for identity shift 5.5511e+00, overlap shift 5.5511e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945723997124       residual = 7.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945729280043       residual = 8.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945730107715       residual = 2.38e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945730320728       residual = 3.97e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945730387561       residual = 8.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945730374721       residual = 2.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945730373540       residual = 4.35e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945730380019       residual = 9.98e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945730381356       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945730380832       residual = 4.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+00 is 1.963782e-05

solving harmonic davidson linear method for identity shift 2.2204e+01, overlap shift 2.2204e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945723997124       residual = 7.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945725332156       residual = 8.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945725540694       residual = 2.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945725594197       residual = 3.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945725610928       residual = 8.43e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945725607695       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945725607384       residual = 4.28e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945725609007       residual = 9.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945725609342       residual = 1.76e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945725609212       residual = 4.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+01 is 4.961152e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.287743 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6654e+01
  </log>
  <optVariables href="H2O.s077.opt.xml">
ci_001                -4.145489e-02 3 1  ON 0
ci_002                -3.158448e-02 3 1  ON 1
ci_003                -2.620398e-02 3 1  ON 2
ci_004                 2.366458e-02 3 1  ON 3
ci_005                 2.384082e-02 3 1  ON 4
ci_006                -2.094308e-02 3 1  ON 5
ci_007                -2.044813e-02 3 1  ON 6
ci_008                -8.616390e-03 3 1  ON 7
ci_009                -1.430760e-02 3 1  ON 8
ci_010                -9.620709e-03 3 1  ON 9
ci_011                -1.060631e-02 3 1  ON 10
ci_012                -9.804246e-03 3 1  ON 11
ci_013                -1.993744e-02 3 1  ON 12
ci_014                 1.258139e-02 3 1  ON 13
ci_015                 1.250764e-02 3 1  ON 14
ci_016                 1.713626e-02 3 1  ON 15
ci_017                 1.631013e-02 3 1  ON 16
ci_018                 9.862621e-03 3 1  ON 17
ci_019                 1.002004e-02 3 1  ON 18
ci_020                 1.719096e-02 3 1  ON 19
ci_021                 1.702405e-02 3 1  ON 20
ci_022                 9.194830e-03 3 1  ON 21
ci_023                 9.461972e-03 3 1  ON 22
ci_024                 9.630002e-03 3 1  ON 23
ci_025                 9.476166e-03 3 1  ON 24
ci_026                 1.108585e-02 3 1  ON 25
ci_027                 1.155180e-02 3 1  ON 26
ci_028                -1.496358e-02 3 1  ON 27
ci_029                -1.551584e-02 3 1  ON 28
ci_030                -9.432589e-03 3 1  ON 29
ci_031                -9.022292e-03 3 1  ON 30
ci_032                -1.485517e-02 3 1  ON 31
ci_033                 5.701302e-03 3 1  ON 32
ci_034                 5.613449e-03 3 1  ON 33
ci_035                -5.051303e-03 3 1  ON 34
ci_036                -1.253034e-02 3 1  ON 35
ci_037                -1.252607e-02 3 1  ON 36
ci_038                 1.770110e-03 3 1  ON 37
ci_039                 1.715576e-03 3 1  ON 38
ci_040                -3.022882e-03 3 1  ON 39
ci_041                 8.819063e-03 3 1  ON 40
ci_042                 8.893355e-03 3 1  ON 41
ci_043                -4.004304e-03 3 1  ON 42
ci_044                -4.104033e-03 3 1  ON 43
ci_045                -3.247922e-03 3 1  ON 44
ci_046                 5.721269e-03 3 1  ON 45
ci_047                 5.627316e-03 3 1  ON 46
ci_048                -1.250638e-02 3 1  ON 47
ci_049                -1.364919e-02 3 1  ON 48
ci_050                 3.425001e-03 3 1  ON 49
ci_051                 3.205296e-03 3 1  ON 50
ci_052                -2.273164e-03 3 1  ON 51
ci_053                -2.418752e-03 3 1  ON 52
ci_054                -2.895103e-03 3 1  ON 53
ci_055                -2.936260e-03 3 1  ON 54
ci_056                 5.325170e-03 3 1  ON 55
ci_057                 5.143447e-03 3 1  ON 56
ci_058                -1.676969e-03 3 1  ON 57
ci_059                -1.998932e-03 3 1  ON 58
ci_060                 4.948983e-03 3 1  ON 59
ci_061                 5.522793e-03 3 1  ON 60
ci_062                -3.598157e-03 3 1  ON 61
ci_063                -4.116015e-03 3 1  ON 62
ci_064                -3.015797e-03 3 1  ON 63
ci_065                -4.342763e-03 3 1  ON 64
ci_066                 4.506616e-03 3 1  ON 65
ci_067                 4.324730e-03 3 1  ON 66
ci_068                -4.315922e-03 3 1  ON 67
ci_069                -4.861770e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 77
    time step          = 0.05
    reference energy   = -17.145
    reference variance = 0.195287
====================================================
  Execution time = 1.4050e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s077
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7992e-01
  Total weights = 1.9573e+06
  Execution time = 1.8278e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266229792218
                                         uncertainty =       0.001577524308

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266229792218
                                         uncertainty =       0.001577524308

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364871745
  error estimate for blocks of size 2^( 2) =       0.000379033756
  error estimate for blocks of size 2^( 3) =       0.000391790195
  error estimate for blocks of size 2^( 4) =       0.000400751385
  error estimate for blocks of size 2^( 5) =       0.000406409239
  error estimate for blocks of size 2^( 6) =       0.000410322031
  error estimate for blocks of size 2^( 7) =       0.000411842052

      target function =      -0.945100668221
              le_mean =     -17.211209995765
             les_mean =     296.505611867561
             stat err =       0.000407331177
             autocorr =       1.246277733921
   target nu stat err =       0.000407331177
   target dn stat err =       0.002961171696
      target stat err =       0.005022122750
              std dev =       0.516006570715
             le_variance =       0.266262781021

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266234516095
                                         uncertainty =       0.001577468677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266234516095
                                         uncertainty =       0.001577468677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364874992
  error estimate for blocks of size 2^( 2) =       0.000379040228
  error estimate for blocks of size 2^( 3) =       0.000391801086
  error estimate for blocks of size 2^( 4) =       0.000400764790
  error estimate for blocks of size 2^( 5) =       0.000406424467
  error estimate for blocks of size 2^( 6) =       0.000410338510
  error estimate for blocks of size 2^( 7) =       0.000411860981

      target function =      -0.944592360487
              le_mean =     -17.211209842374
             les_mean =     296.505906926938
             stat err =       0.000407347187
             autocorr =       1.246353525497
   target nu stat err =       0.000407347187
   target dn stat err =       0.003208919565
      target stat err =       0.005428151006
              std dev =       0.516011161705
             le_variance =       0.266267519004

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266231721355
                                         uncertainty =       0.001577484736

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266231721355
                                         uncertainty =       0.001577484736

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364873073
  error estimate for blocks of size 2^( 2) =       0.000379036762
  error estimate for blocks of size 2^( 3) =       0.000391795496
  error estimate for blocks of size 2^( 4) =       0.000400757993
  error estimate for blocks of size 2^( 5) =       0.000406416780
  error estimate for blocks of size 2^( 6) =       0.000410330242
  error estimate for blocks of size 2^( 7) =       0.000411851504

      target function =      -0.944803682931
              le_mean =     -17.211209884006
             les_mean =     296.505783790478
             stat err =       0.000407339130
             autocorr =       1.246317330878
   target nu stat err =       0.000407339130
   target dn stat err =       0.003077989381
      target stat err =       0.005212977139
              std dev =       0.516008447821
             le_variance =       0.266264718223

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266229978702
                                         uncertainty =       0.001577518111

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266229978702
                                         uncertainty =       0.001577518111

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364871874
  error estimate for blocks of size 2^( 2) =       0.000379034098
  error estimate for blocks of size 2^( 3) =       0.000391790826
  error estimate for blocks of size 2^( 4) =       0.000400752181
  error estimate for blocks of size 2^( 5) =       0.000406410153
  error estimate for blocks of size 2^( 6) =       0.000410323024
  error estimate for blocks of size 2^( 7) =       0.000411843194

      target function =      -0.945077829696
              le_mean =     -17.211209980127
             les_mean =     296.505624796941
             stat err =       0.000407332138
             autocorr =       1.246282738179
   target nu stat err =       0.000407332138
   target dn stat err =       0.002974608986
      target stat err =       0.005044200631
              std dev =       0.516006752468
             le_variance =       0.266262968593


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945100668221        initial  <--
     1.3878e+00     1.3878e+01             7.5407e-05        -0.944592360487
     5.5511e+00     5.5511e+01             1.9638e-05        -0.944803682931
     2.2204e+01     2.2204e+02             4.9612e-06        -0.945077829696

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.2422
  </log>
  <optVariables href="H2O.s077.opt.xml">
ci_001                -4.146316e-02 3 1  ON 0
ci_002                -3.159055e-02 3 1  ON 1
ci_003                -2.621364e-02 3 1  ON 2
ci_004                 2.367841e-02 3 1  ON 3
ci_005                 2.385205e-02 3 1  ON 4
ci_006                -2.094659e-02 3 1  ON 5
ci_007                -2.044460e-02 3 1  ON 6
ci_008                -8.612369e-03 3 1  ON 7
ci_009                -1.431078e-02 3 1  ON 8
ci_010                -9.626919e-03 3 1  ON 9
ci_011                -1.061671e-02 3 1  ON 10
ci_012                -9.816507e-03 3 1  ON 11
ci_013                -1.994750e-02 3 1  ON 12
ci_014                 1.257702e-02 3 1  ON 13
ci_015                 1.251861e-02 3 1  ON 14
ci_016                 1.715083e-02 3 1  ON 15
ci_017                 1.630526e-02 3 1  ON 16
ci_018                 9.864039e-03 3 1  ON 17
ci_019                 1.001025e-02 3 1  ON 18
ci_020                 1.718915e-02 3 1  ON 19
ci_021                 1.702046e-02 3 1  ON 20
ci_022                 9.192905e-03 3 1  ON 21
ci_023                 9.456036e-03 3 1  ON 22
ci_024                 9.643488e-03 3 1  ON 23
ci_025                 9.457350e-03 3 1  ON 24
ci_026                 1.108548e-02 3 1  ON 25
ci_027                 1.155967e-02 3 1  ON 26
ci_028                -1.496724e-02 3 1  ON 27
ci_029                -1.552715e-02 3 1  ON 28
ci_030                -9.444289e-03 3 1  ON 29
ci_031                -9.018444e-03 3 1  ON 30
ci_032                -1.485412e-02 3 1  ON 31
ci_033                 5.719815e-03 3 1  ON 32
ci_034                 5.607589e-03 3 1  ON 33
ci_035                -5.050569e-03 3 1  ON 34
ci_036                -1.252739e-02 3 1  ON 35
ci_037                -1.250839e-02 3 1  ON 36
ci_038                 1.771062e-03 3 1  ON 37
ci_039                 1.717900e-03 3 1  ON 38
ci_040                -3.024835e-03 3 1  ON 39
ci_041                 8.820662e-03 3 1  ON 40
ci_042                 8.899356e-03 3 1  ON 41
ci_043                -4.004487e-03 3 1  ON 42
ci_044                -4.084395e-03 3 1  ON 43
ci_045                -3.238675e-03 3 1  ON 44
ci_046                 5.726164e-03 3 1  ON 45
ci_047                 5.627476e-03 3 1  ON 46
ci_048                -1.250454e-02 3 1  ON 47
ci_049                -1.365086e-02 3 1  ON 48
ci_050                 3.425980e-03 3 1  ON 49
ci_051                 3.209128e-03 3 1  ON 50
ci_052                -2.268168e-03 3 1  ON 51
ci_053                -2.412064e-03 3 1  ON 52
ci_054                -2.901445e-03 3 1  ON 53
ci_055                -2.929113e-03 3 1  ON 54
ci_056                 5.321997e-03 3 1  ON 55
ci_057                 5.143323e-03 3 1  ON 56
ci_058                -1.681942e-03 3 1  ON 57
ci_059                -1.998421e-03 3 1  ON 58
ci_060                 4.948842e-03 3 1  ON 59
ci_061                 5.520558e-03 3 1  ON 60
ci_062                -3.589070e-03 3 1  ON 61
ci_063                -4.125676e-03 3 1  ON 62
ci_064                -3.013531e-03 3 1  ON 63
ci_065                -4.343487e-03 3 1  ON 64
ci_066                 4.512047e-03 3 1  ON 65
ci_067                 4.319180e-03 3 1  ON 66
ci_068                -4.311994e-03 3 1  ON 67
ci_069                -4.856782e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9903e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s078 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s078 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=78  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.1594
    reference variance = 0.45573
====================================================
  Execution time = 1.4386e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s078
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5318e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8339e-01
  Total weights = 1.957237477e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4803e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270429085016
                                         uncertainty =       0.001515327869

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270429085016
                                         uncertainty =       0.001515327869

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367742607
  error estimate for blocks of size 2^( 2) =       0.000381529611
  error estimate for blocks of size 2^( 3) =       0.000393997313
  error estimate for blocks of size 2^( 4) =       0.000403565445
  error estimate for blocks of size 2^( 5) =       0.000408981066
  error estimate for blocks of size 2^( 6) =       0.000411632367
  error estimate for blocks of size 2^( 7) =       0.000413604944

      target function =      -0.939226589100
              le_mean =     -17.211900837405
             les_mean =     296.532916703558
             stat err =       0.000409445955
             autocorr =       1.239667655138
   target nu stat err =       0.000409445955
   target dn stat err =       0.002671118718
      target stat err =       0.004491793107
              std dev =       0.520066581947
             le_variance =       0.270469249658


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721190083741e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+01, overlap shift 1.3878e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939247613009       residual = 9.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939250169192       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939250622704       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939250748100       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939250780777       residual = 8.37e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939250786996       residual = 1.35e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939250787120       residual = 2.53e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939250787216       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939250787325       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939250787478       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+01 is 1.052528e-05

solving harmonic davidson linear method for identity shift 5.5511e+01, overlap shift 5.5511e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939247613009       residual = 9.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939248254868       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939248368615       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939248400028       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939248408212       residual = 8.33e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939248409764       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939248409796       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939248409819       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939248409847       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939248409885       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+01 is 2.641407e-06

solving harmonic davidson linear method for identity shift 2.2204e+02, overlap shift 2.2204e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.939247613009       residual = 9.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.939247773650       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.939247802110       residual = 2.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.939247809967       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.939247812014       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.939247812402       residual = 1.34e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.939247812410       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.939247812416       residual = 4.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.939247812423       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.939247812432       residual = 1.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+02 is 6.609852e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.291232 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6875e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
ci_001                -4.146245e-02 3 1  ON 0
ci_002                -3.159050e-02 3 1  ON 1
ci_003                -2.621353e-02 3 1  ON 2
ci_004                 2.367786e-02 3 1  ON 3
ci_005                 2.385214e-02 3 1  ON 4
ci_006                -2.094541e-02 3 1  ON 5
ci_007                -2.044575e-02 3 1  ON 6
ci_008                -8.610885e-03 3 1  ON 7
ci_009                -1.431233e-02 3 1  ON 8
ci_010                -9.625396e-03 3 1  ON 9
ci_011                -1.061568e-02 3 1  ON 10
ci_012                -9.817362e-03 3 1  ON 11
ci_013                -1.994673e-02 3 1  ON 12
ci_014                 1.257705e-02 3 1  ON 13
ci_015                 1.251850e-02 3 1  ON 14
ci_016                 1.714890e-02 3 1  ON 15
ci_017                 1.630529e-02 3 1  ON 16
ci_018                 9.864499e-03 3 1  ON 17
ci_019                 1.001029e-02 3 1  ON 18
ci_020                 1.718930e-02 3 1  ON 19
ci_021                 1.701918e-02 3 1  ON 20
ci_022                 9.192905e-03 3 1  ON 21
ci_023                 9.455853e-03 3 1  ON 22
ci_024                 9.642337e-03 3 1  ON 23
ci_025                 9.455698e-03 3 1  ON 24
ci_026                 1.108524e-02 3 1  ON 25
ci_027                 1.155932e-02 3 1  ON 26
ci_028                -1.496763e-02 3 1  ON 27
ci_029                -1.552738e-02 3 1  ON 28
ci_030                -9.443401e-03 3 1  ON 29
ci_031                -9.018394e-03 3 1  ON 30
ci_032                -1.485431e-02 3 1  ON 31
ci_033                 5.719837e-03 3 1  ON 32
ci_034                 5.608150e-03 3 1  ON 33
ci_035                -5.050567e-03 3 1  ON 34
ci_036                -1.252623e-02 3 1  ON 35
ci_037                -1.250878e-02 3 1  ON 36
ci_038                 1.771033e-03 3 1  ON 37
ci_039                 1.716974e-03 3 1  ON 38
ci_040                -3.025023e-03 3 1  ON 39
ci_041                 8.819749e-03 3 1  ON 40
ci_042                 8.897648e-03 3 1  ON 41
ci_043                -4.004104e-03 3 1  ON 42
ci_044                -4.083282e-03 3 1  ON 43
ci_045                -3.238800e-03 3 1  ON 44
ci_046                 5.725893e-03 3 1  ON 45
ci_047                 5.628044e-03 3 1  ON 46
ci_048                -1.250546e-02 3 1  ON 47
ci_049                -1.365100e-02 3 1  ON 48
ci_050                 3.425709e-03 3 1  ON 49
ci_051                 3.208194e-03 3 1  ON 50
ci_052                -2.267630e-03 3 1  ON 51
ci_053                -2.411971e-03 3 1  ON 52
ci_054                -2.901437e-03 3 1  ON 53
ci_055                -2.928867e-03 3 1  ON 54
ci_056                 5.322561e-03 3 1  ON 55
ci_057                 5.143694e-03 3 1  ON 56
ci_058                -1.681822e-03 3 1  ON 57
ci_059                -1.996866e-03 3 1  ON 58
ci_060                 4.949614e-03 3 1  ON 59
ci_061                 5.519785e-03 3 1  ON 60
ci_062                -3.589263e-03 3 1  ON 61
ci_063                -4.125320e-03 3 1  ON 62
ci_064                -3.014043e-03 3 1  ON 63
ci_065                -4.343568e-03 3 1  ON 64
ci_066                 4.512373e-03 3 1  ON 65
ci_067                 4.319621e-03 3 1  ON 66
ci_068                -4.314636e-03 3 1  ON 67
ci_069                -4.857783e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 78
    time step          = 0.05
    reference energy   = -17.2345
    reference variance = 0.152761
====================================================
  Execution time = 1.3833e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s078
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8107e-01
  Total weights = 1.9572e+06
  Execution time = 1.8242e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268445454380
                                         uncertainty =       0.001564449413

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268445454380
                                         uncertainty =       0.001564449413

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366346832
  error estimate for blocks of size 2^( 2) =       0.000380482257
  error estimate for blocks of size 2^( 3) =       0.000392919854
  error estimate for blocks of size 2^( 4) =       0.000402189038
  error estimate for blocks of size 2^( 5) =       0.000408064735
  error estimate for blocks of size 2^( 6) =       0.000410317797
  error estimate for blocks of size 2^( 7) =       0.000413516877

      target function =      -0.943101676813
              le_mean =     -17.212665029595
             les_mean =     296.556903802175
             stat err =       0.000408522112
             autocorr =       1.243501337925
   target nu stat err =       0.000408522112
   target dn stat err =       0.002249474921
      target stat err =       0.003838875186
              std dev =       0.518092657895
             le_variance =       0.268420002165

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268444554971
                                         uncertainty =       0.001564386363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268444554971
                                         uncertainty =       0.001564386363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366346235
  error estimate for blocks of size 2^( 2) =       0.000380482101
  error estimate for blocks of size 2^( 3) =       0.000392920090
  error estimate for blocks of size 2^( 4) =       0.000402189433
  error estimate for blocks of size 2^( 5) =       0.000408065253
  error estimate for blocks of size 2^( 6) =       0.000410318741
  error estimate for blocks of size 2^( 7) =       0.000413517756

      target function =      -0.943098595912
              le_mean =     -17.212664958357
             les_mean =     296.556903184762
             stat err =       0.000408522796
             autocorr =       1.243509553437
   target nu stat err =       0.000408522796
   target dn stat err =       0.002249931410
      target stat err =       0.003839601461
              std dev =       0.518091813651
             le_variance =       0.268419127373

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268444999418
                                         uncertainty =       0.001564417673

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268444999418
                                         uncertainty =       0.001564417673

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366346530
  error estimate for blocks of size 2^( 2) =       0.000380482176
  error estimate for blocks of size 2^( 3) =       0.000392919970
  error estimate for blocks of size 2^( 4) =       0.000402189234
  error estimate for blocks of size 2^( 5) =       0.000408064993
  error estimate for blocks of size 2^( 6) =       0.000410318269
  error estimate for blocks of size 2^( 7) =       0.000413517317

      target function =      -0.943100951283
              le_mean =     -17.212664993386
             les_mean =     296.556902987293
             stat err =       0.000408522453
             autocorr =       1.243505465564
   target nu stat err =       0.000408522453
   target dn stat err =       0.002249649096
      target stat err =       0.003839155859
              std dev =       0.518092230750
             le_variance =       0.268419559564

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268445397060
                                         uncertainty =       0.001564445430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268445397060
                                         uncertainty =       0.001564445430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366346794
  error estimate for blocks of size 2^( 2) =       0.000380482246
  error estimate for blocks of size 2^( 3) =       0.000392919869
  error estimate for blocks of size 2^( 4) =       0.000402189062
  error estimate for blocks of size 2^( 5) =       0.000408064767
  error estimate for blocks of size 2^( 6) =       0.000410317856
  error estimate for blocks of size 2^( 7) =       0.000413516932

      target function =      -0.943101686373
              le_mean =     -17.212665025014
             les_mean =     296.556903638646
             stat err =       0.000408522154
             autocorr =       1.243501854691
   target nu stat err =       0.000408522154
   target dn stat err =       0.002249490708
      target stat err =       0.003838901222
              std dev =       0.518092604069
             le_variance =       0.268419946391


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943101676813        initial
     1.3878e+01     1.3878e+02             1.0525e-05        -0.943098595912
     5.5511e+01     5.5511e+02             2.6414e-06        -0.943100951283
     2.2204e+02     2.2204e+03             6.6099e-07        -0.943101686373  <--

*****************************************************************************
Applying the update for shift_i =   2.2204e+02     and shift_s =   2.2204e+03
*****************************************************************************

  Execution time = 2.3037e+01
  </log>
  <optVariables href="H2O.s078.opt.xml">
ci_001                -4.146299e-02 3 1  ON 0
ci_002                -3.159054e-02 3 1  ON 1
ci_003                -2.621361e-02 3 1  ON 2
ci_004                 2.367827e-02 3 1  ON 3
ci_005                 2.385208e-02 3 1  ON 4
ci_006                -2.094630e-02 3 1  ON 5
ci_007                -2.044489e-02 3 1  ON 6
ci_008                -8.611998e-03 3 1  ON 7
ci_009                -1.431117e-02 3 1  ON 8
ci_010                -9.626538e-03 3 1  ON 9
ci_011                -1.061646e-02 3 1  ON 10
ci_012                -9.816721e-03 3 1  ON 11
ci_013                -1.994731e-02 3 1  ON 12
ci_014                 1.257703e-02 3 1  ON 13
ci_015                 1.251858e-02 3 1  ON 14
ci_016                 1.715035e-02 3 1  ON 15
ci_017                 1.630527e-02 3 1  ON 16
ci_018                 9.864154e-03 3 1  ON 17
ci_019                 1.001026e-02 3 1  ON 18
ci_020                 1.718919e-02 3 1  ON 19
ci_021                 1.702014e-02 3 1  ON 20
ci_022                 9.192905e-03 3 1  ON 21
ci_023                 9.455990e-03 3 1  ON 22
ci_024                 9.643200e-03 3 1  ON 23
ci_025                 9.456937e-03 3 1  ON 24
ci_026                 1.108542e-02 3 1  ON 25
ci_027                 1.155958e-02 3 1  ON 26
ci_028                -1.496734e-02 3 1  ON 27
ci_029                -1.552721e-02 3 1  ON 28
ci_030                -9.444067e-03 3 1  ON 29
ci_031                -9.018432e-03 3 1  ON 30
ci_032                -1.485416e-02 3 1  ON 31
ci_033                 5.719820e-03 3 1  ON 32
ci_034                 5.607730e-03 3 1  ON 33
ci_035                -5.050568e-03 3 1  ON 34
ci_036                -1.252710e-02 3 1  ON 35
ci_037                -1.250849e-02 3 1  ON 36
ci_038                 1.771055e-03 3 1  ON 37
ci_039                 1.717668e-03 3 1  ON 38
ci_040                -3.024882e-03 3 1  ON 39
ci_041                 8.820434e-03 3 1  ON 40
ci_042                 8.898928e-03 3 1  ON 41
ci_043                -4.004392e-03 3 1  ON 42
ci_044                -4.084117e-03 3 1  ON 43
ci_045                -3.238706e-03 3 1  ON 44
ci_046                 5.726096e-03 3 1  ON 45
ci_047                 5.627618e-03 3 1  ON 46
ci_048                -1.250477e-02 3 1  ON 47
ci_049                -1.365090e-02 3 1  ON 48
ci_050                 3.425912e-03 3 1  ON 49
ci_051                 3.208895e-03 3 1  ON 50
ci_052                -2.268034e-03 3 1  ON 51
ci_053                -2.412041e-03 3 1  ON 52
ci_054                -2.901443e-03 3 1  ON 53
ci_055                -2.929052e-03 3 1  ON 54
ci_056                 5.322138e-03 3 1  ON 55
ci_057                 5.143416e-03 3 1  ON 56
ci_058                -1.681912e-03 3 1  ON 57
ci_059                -1.998032e-03 3 1  ON 58
ci_060                 4.949035e-03 3 1  ON 59
ci_061                 5.520364e-03 3 1  ON 60
ci_062                -3.589118e-03 3 1  ON 61
ci_063                -4.125587e-03 3 1  ON 62
ci_064                -3.013659e-03 3 1  ON 63
ci_065                -4.343507e-03 3 1  ON 64
ci_066                 4.512129e-03 3 1  ON 65
ci_067                 4.319290e-03 3 1  ON 66
ci_068                -4.312655e-03 3 1  ON 67
ci_069                -4.857032e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9919e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s079 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s079 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=79  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.1879
    reference variance = 0.300891
====================================================
  Execution time = 1.4343e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s079
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5291e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7724e-01
  Total weights = 1.957651452e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4638e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266932764699
                                         uncertainty =       0.001440285322

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266932764699
                                         uncertainty =       0.001440285322

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365355903
  error estimate for blocks of size 2^( 2) =       0.000379325110
  error estimate for blocks of size 2^( 3) =       0.000391739252
  error estimate for blocks of size 2^( 4) =       0.000400638492
  error estimate for blocks of size 2^( 5) =       0.000407140733
  error estimate for blocks of size 2^( 6) =       0.000410292426
  error estimate for blocks of size 2^( 7) =       0.000411685638

      target function =      -0.949541337872
              le_mean =     -17.211580457996
             les_mean =     296.515742867494
             stat err =       0.000407439322
             autocorr =       1.243636969742
   target nu stat err =       0.000407439322
   target dn stat err =       0.002029528083
      target stat err =       0.003516659164
              std dev =       0.516691273592
             le_variance =       0.266969872206


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721158045800e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.5511e+01, overlap shift 5.5511e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949553267136       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949554100744       residual = 9.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949554188604       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949554209433       residual = 6.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949554219842       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949554220824       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949554220775       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949554220827       residual = 8.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949554220723       residual = 9.83e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+01 is 2.897496e-06

solving harmonic davidson linear method for identity shift 2.2204e+02, overlap shift 2.2204e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949553267136       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949553475769       residual = 9.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949553497751       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949553502961       residual = 6.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949553505564       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949553505809       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949553505797       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949553505810       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949553505784       residual = 9.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+02 is 7.250835e-07

solving harmonic davidson linear method for identity shift 8.8818e+02, overlap shift 8.8818e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949553267136       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949553319308       residual = 9.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949553324805       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949553326108       residual = 6.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949553326758       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949553326819       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949553326817       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949553326820       residual = 8.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949553326813       residual = 9.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.8818e+02 is 1.813153e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.294286 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6815e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
ci_001                -4.146328e-02 3 1  ON 0
ci_002                -3.159048e-02 3 1  ON 1
ci_003                -2.621346e-02 3 1  ON 2
ci_004                 2.367820e-02 3 1  ON 3
ci_005                 2.385233e-02 3 1  ON 4
ci_006                -2.094609e-02 3 1  ON 5
ci_007                -2.044520e-02 3 1  ON 6
ci_008                -8.612049e-03 3 1  ON 7
ci_009                -1.431137e-02 3 1  ON 8
ci_010                -9.626335e-03 3 1  ON 9
ci_011                -1.061630e-02 3 1  ON 10
ci_012                -9.816953e-03 3 1  ON 11
ci_013                -1.994741e-02 3 1  ON 12
ci_014                 1.257711e-02 3 1  ON 13
ci_015                 1.251911e-02 3 1  ON 14
ci_016                 1.714982e-02 3 1  ON 15
ci_017                 1.630553e-02 3 1  ON 16
ci_018                 9.864309e-03 3 1  ON 17
ci_019                 1.001056e-02 3 1  ON 18
ci_020                 1.718908e-02 3 1  ON 19
ci_021                 1.702022e-02 3 1  ON 20
ci_022                 9.193011e-03 3 1  ON 21
ci_023                 9.455966e-03 3 1  ON 22
ci_024                 9.643021e-03 3 1  ON 23
ci_025                 9.456922e-03 3 1  ON 24
ci_026                 1.108554e-02 3 1  ON 25
ci_027                 1.155923e-02 3 1  ON 26
ci_028                -1.496806e-02 3 1  ON 27
ci_029                -1.552713e-02 3 1  ON 28
ci_030                -9.443602e-03 3 1  ON 29
ci_031                -9.018456e-03 3 1  ON 30
ci_032                -1.485427e-02 3 1  ON 31
ci_033                 5.719720e-03 3 1  ON 32
ci_034                 5.607716e-03 3 1  ON 33
ci_035                -5.050563e-03 3 1  ON 34
ci_036                -1.252703e-02 3 1  ON 35
ci_037                -1.250851e-02 3 1  ON 36
ci_038                 1.771034e-03 3 1  ON 37
ci_039                 1.717732e-03 3 1  ON 38
ci_040                -3.024922e-03 3 1  ON 39
ci_041                 8.819951e-03 3 1  ON 40
ci_042                 8.898731e-03 3 1  ON 41
ci_043                -4.004358e-03 3 1  ON 42
ci_044                -4.083995e-03 3 1  ON 43
ci_045                -3.238582e-03 3 1  ON 44
ci_046                 5.726062e-03 3 1  ON 45
ci_047                 5.627566e-03 3 1  ON 46
ci_048                -1.250484e-02 3 1  ON 47
ci_049                -1.365114e-02 3 1  ON 48
ci_050                 3.425917e-03 3 1  ON 49
ci_051                 3.208956e-03 3 1  ON 50
ci_052                -2.268320e-03 3 1  ON 51
ci_053                -2.411786e-03 3 1  ON 52
ci_054                -2.901284e-03 3 1  ON 53
ci_055                -2.928950e-03 3 1  ON 54
ci_056                 5.322133e-03 3 1  ON 55
ci_057                 5.143446e-03 3 1  ON 56
ci_058                -1.682269e-03 3 1  ON 57
ci_059                -1.997964e-03 3 1  ON 58
ci_060                 4.949007e-03 3 1  ON 59
ci_061                 5.520302e-03 3 1  ON 60
ci_062                -3.589124e-03 3 1  ON 61
ci_063                -4.125507e-03 3 1  ON 62
ci_064                -3.013639e-03 3 1  ON 63
ci_065                -4.343428e-03 3 1  ON 64
ci_066                 4.512240e-03 3 1  ON 65
ci_067                 4.319265e-03 3 1  ON 66
ci_068                -4.313254e-03 3 1  ON 67
ci_069                -4.856830e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 79
    time step          = 0.05
    reference energy   = -17.2443
    reference variance = 0.312854
====================================================
  Execution time = 1.3956e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s079
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7646e-01
  Total weights = 1.9574e+06
  Execution time = 2.1980e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266040159664
                                         uncertainty =       0.001455965563

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266040159664
                                         uncertainty =       0.001455965563

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364683064
  error estimate for blocks of size 2^( 2) =       0.000378756919
  error estimate for blocks of size 2^( 3) =       0.000391250693
  error estimate for blocks of size 2^( 4) =       0.000399789515
  error estimate for blocks of size 2^( 5) =       0.000405345706
  error estimate for blocks of size 2^( 6) =       0.000409094239
  error estimate for blocks of size 2^( 7) =       0.000411383625

      target function =      -0.950875863844
              le_mean =     -17.211720678503
             les_mean =     296.519785838670
             stat err =       0.000406403271
             autocorr =       1.241890203416
   target nu stat err =       0.000406403271
   target dn stat err =       0.001958239075
      target stat err =       0.003408351018
              std dev =       0.515739734430
             le_variance =       0.265987473670

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266040249329
                                         uncertainty =       0.001455978320

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266040249329
                                         uncertainty =       0.001455978320

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364683128
  error estimate for blocks of size 2^( 2) =       0.000378756892
  error estimate for blocks of size 2^( 3) =       0.000391250574
  error estimate for blocks of size 2^( 4) =       0.000399789371
  error estimate for blocks of size 2^( 5) =       0.000405345505
  error estimate for blocks of size 2^( 6) =       0.000409094016
  error estimate for blocks of size 2^( 7) =       0.000411383454

      target function =      -0.950880580246
              le_mean =     -17.211720688563
             les_mean =     296.519783409291
             stat err =       0.000406403087
             autocorr =       1.241888638552
   target nu stat err =       0.000406403087
   target dn stat err =       0.001958554108
      target stat err =       0.003408907464
              std dev =       0.515739824988
             le_variance =       0.265987567078

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266040204282
                                         uncertainty =       0.001455971945

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266040204282
                                         uncertainty =       0.001455971945

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364683095
  error estimate for blocks of size 2^( 2) =       0.000378756905
  error estimate for blocks of size 2^( 3) =       0.000391250633
  error estimate for blocks of size 2^( 4) =       0.000399789443
  error estimate for blocks of size 2^( 5) =       0.000405345605
  error estimate for blocks of size 2^( 6) =       0.000409094127
  error estimate for blocks of size 2^( 7) =       0.000411383539

      target function =      -0.950878520409
              le_mean =     -17.211720683506
             les_mean =     296.519784447612
             stat err =       0.000406403179
             autocorr =       1.241889420318
   target nu stat err =       0.000406403179
   target dn stat err =       0.001958394105
      target stat err =       0.003408627199
              std dev =       0.515739779502
             le_variance =       0.265987520161

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266040165214
                                         uncertainty =       0.001455966361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266040165214
                                         uncertainty =       0.001455966361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364683068
  error estimate for blocks of size 2^( 2) =       0.000378756917
  error estimate for blocks of size 2^( 3) =       0.000391250685
  error estimate for blocks of size 2^( 4) =       0.000399789506
  error estimate for blocks of size 2^( 5) =       0.000405345693
  error estimate for blocks of size 2^( 6) =       0.000409094225
  error estimate for blocks of size 2^( 7) =       0.000411383614

      target function =      -0.950876233027
              le_mean =     -17.211720679125
             les_mean =     296.519785642855
             stat err =       0.000406403260
             autocorr =       1.241890105525
   target nu stat err =       0.000406403260
   target dn stat err =       0.001958258133
      target stat err =       0.003408385268
              std dev =       0.515739740038
             le_variance =       0.265987479455


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.950875863844        initial
     5.5511e+01     5.5511e+02             2.8975e-06        -0.950880580246  <--
     2.2204e+02     2.2204e+03             7.2508e-07        -0.950878520409
     8.8818e+02     8.8818e+03             1.8132e-07        -0.950876233027

*****************************************************************************
Applying the update for shift_i =   5.5511e+01     and shift_s =   5.5511e+02
*****************************************************************************

  Execution time = 2.3966e+01
  </log>
  <optVariables href="H2O.s079.opt.xml">
ci_001                -4.146415e-02 3 1  ON 0
ci_002                -3.159030e-02 3 1  ON 1
ci_003                -2.621303e-02 3 1  ON 2
ci_004                 2.367797e-02 3 1  ON 3
ci_005                 2.385309e-02 3 1  ON 4
ci_006                -2.094549e-02 3 1  ON 5
ci_007                -2.044613e-02 3 1  ON 6
ci_008                -8.612205e-03 3 1  ON 7
ci_009                -1.431197e-02 3 1  ON 8
ci_010                -9.625729e-03 3 1  ON 9
ci_011                -1.061583e-02 3 1  ON 10
ci_012                -9.817650e-03 3 1  ON 11
ci_013                -1.994769e-02 3 1  ON 12
ci_014                 1.257734e-02 3 1  ON 13
ci_015                 1.252071e-02 3 1  ON 14
ci_016                 1.714824e-02 3 1  ON 15
ci_017                 1.630633e-02 3 1  ON 16
ci_018                 9.864772e-03 3 1  ON 17
ci_019                 1.001144e-02 3 1  ON 18
ci_020                 1.718877e-02 3 1  ON 19
ci_021                 1.702046e-02 3 1  ON 20
ci_022                 9.193328e-03 3 1  ON 21
ci_023                 9.455894e-03 3 1  ON 22
ci_024                 9.642483e-03 3 1  ON 23
ci_025                 9.456877e-03 3 1  ON 24
ci_026                 1.108591e-02 3 1  ON 25
ci_027                 1.155817e-02 3 1  ON 26
ci_028                -1.497023e-02 3 1  ON 27
ci_029                -1.552688e-02 3 1  ON 28
ci_030                -9.442209e-03 3 1  ON 29
ci_031                -9.018530e-03 3 1  ON 30
ci_032                -1.485460e-02 3 1  ON 31
ci_033                 5.719421e-03 3 1  ON 32
ci_034                 5.607674e-03 3 1  ON 33
ci_035                -5.050547e-03 3 1  ON 34
ci_036                -1.252681e-02 3 1  ON 35
ci_037                -1.250857e-02 3 1  ON 36
ci_038                 1.770973e-03 3 1  ON 37
ci_039                 1.717923e-03 3 1  ON 38
ci_040                -3.025042e-03 3 1  ON 39
ci_041                 8.818504e-03 3 1  ON 40
ci_042                 8.898138e-03 3 1  ON 41
ci_043                -4.004257e-03 3 1  ON 42
ci_044                -4.083629e-03 3 1  ON 43
ci_045                -3.238208e-03 3 1  ON 44
ci_046                 5.725961e-03 3 1  ON 45
ci_047                 5.627410e-03 3 1  ON 46
ci_048                -1.250505e-02 3 1  ON 47
ci_049                -1.365187e-02 3 1  ON 48
ci_050                 3.425933e-03 3 1  ON 49
ci_051                 3.209139e-03 3 1  ON 50
ci_052                -2.269176e-03 3 1  ON 51
ci_053                -2.411023e-03 3 1  ON 52
ci_054                -2.900807e-03 3 1  ON 53
ci_055                -2.928645e-03 3 1  ON 54
ci_056                 5.322116e-03 3 1  ON 55
ci_057                 5.143538e-03 3 1  ON 56
ci_058                -1.683338e-03 3 1  ON 57
ci_059                -1.997761e-03 3 1  ON 58
ci_060                 4.948923e-03 3 1  ON 59
ci_061                 5.520113e-03 3 1  ON 60
ci_062                -3.589142e-03 3 1  ON 61
ci_063                -4.125266e-03 3 1  ON 62
ci_064                -3.013580e-03 3 1  ON 63
ci_065                -4.343191e-03 3 1  ON 64
ci_066                 4.512572e-03 3 1  ON 65
ci_067                 4.319188e-03 3 1  ON 66
ci_068                -4.315049e-03 3 1  ON 67
ci_069                -4.856225e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0788e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s080 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s080 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=80  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.2173
    reference variance = 0.243042
====================================================
  Execution time = 1.4274e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s080
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5306e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7926e-01
  Total weights = 1.957252727e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4636e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268223353937
                                         uncertainty =       0.001430046966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268223353937
                                         uncertainty =       0.001430046966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366212891
  error estimate for blocks of size 2^( 2) =       0.000380280691
  error estimate for blocks of size 2^( 3) =       0.000393212344
  error estimate for blocks of size 2^( 4) =       0.000402346929
  error estimate for blocks of size 2^( 5) =       0.000407534379
  error estimate for blocks of size 2^( 6) =       0.000411461205
  error estimate for blocks of size 2^( 7) =       0.000414418522

      target function =      -0.946146129469
              le_mean =     -17.212828426920
             les_mean =     296.560721408733
             stat err =       0.000408940259
             autocorr =       1.246959874161
   target nu stat err =       0.000408940259
   target dn stat err =       0.001879406599
      target stat err =       0.003253564737
              std dev =       0.517903237623
             le_variance =       0.268223763540


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721282842692e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+01, overlap shift 1.3878e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946156198704       residual = 9.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946159205154       residual = 8.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946159479284       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946159591781       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946159610727       residual = 6.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946159610885       residual = 1.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946159610298       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946159610621       residual = 5.23e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946159611100       residual = 9.01e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+01 is 7.789407e-06

solving harmonic davidson linear method for identity shift 5.5511e+01, overlap shift 5.5511e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946156198704       residual = 9.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946156953592       residual = 8.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946157022342       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946157050531       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946157055274       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946157055311       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946157055163       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946157055244       residual = 5.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946157055364       residual = 8.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+01 is 1.956006e-06

solving harmonic davidson linear method for identity shift 2.2204e+02, overlap shift 2.2204e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946156198704       residual = 9.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946156387632       residual = 8.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946156404833       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946156411885       residual = 2.92e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946156413070       residual = 6.64e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946156413080       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946156413043       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946156413063       residual = 5.18e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946156413092       residual = 8.90e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+02 is 4.895453e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.297273 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6746e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
ci_001                -4.146466e-02 3 1  ON 0
ci_002                -3.159106e-02 3 1  ON 1
ci_003                -2.621163e-02 3 1  ON 2
ci_004                 2.367733e-02 3 1  ON 3
ci_005                 2.385271e-02 3 1  ON 4
ci_006                -2.094588e-02 3 1  ON 5
ci_007                -2.044579e-02 3 1  ON 6
ci_008                -8.611858e-03 3 1  ON 7
ci_009                -1.431068e-02 3 1  ON 8
ci_010                -9.626977e-03 3 1  ON 9
ci_011                -1.061716e-02 3 1  ON 10
ci_012                -9.817442e-03 3 1  ON 11
ci_013                -1.994761e-02 3 1  ON 12
ci_014                 1.257740e-02 3 1  ON 13
ci_015                 1.251997e-02 3 1  ON 14
ci_016                 1.714747e-02 3 1  ON 15
ci_017                 1.630645e-02 3 1  ON 16
ci_018                 9.866728e-03 3 1  ON 17
ci_019                 1.001166e-02 3 1  ON 18
ci_020                 1.718830e-02 3 1  ON 19
ci_021                 1.701941e-02 3 1  ON 20
ci_022                 9.192865e-03 3 1  ON 21
ci_023                 9.456453e-03 3 1  ON 22
ci_024                 9.641065e-03 3 1  ON 23
ci_025                 9.455887e-03 3 1  ON 24
ci_026                 1.108689e-02 3 1  ON 25
ci_027                 1.155820e-02 3 1  ON 26
ci_028                -1.497153e-02 3 1  ON 27
ci_029                -1.552653e-02 3 1  ON 28
ci_030                -9.440909e-03 3 1  ON 29
ci_031                -9.018713e-03 3 1  ON 30
ci_032                -1.485634e-02 3 1  ON 31
ci_033                 5.720074e-03 3 1  ON 32
ci_034                 5.606682e-03 3 1  ON 33
ci_035                -5.050144e-03 3 1  ON 34
ci_036                -1.252799e-02 3 1  ON 35
ci_037                -1.250735e-02 3 1  ON 36
ci_038                 1.770788e-03 3 1  ON 37
ci_039                 1.717193e-03 3 1  ON 38
ci_040                -3.025256e-03 3 1  ON 39
ci_041                 8.816748e-03 3 1  ON 40
ci_042                 8.897884e-03 3 1  ON 41
ci_043                -4.004102e-03 3 1  ON 42
ci_044                -4.084412e-03 3 1  ON 43
ci_045                -3.237747e-03 3 1  ON 44
ci_046                 5.725162e-03 3 1  ON 45
ci_047                 5.627151e-03 3 1  ON 46
ci_048                -1.250495e-02 3 1  ON 47
ci_049                -1.365212e-02 3 1  ON 48
ci_050                 3.425978e-03 3 1  ON 49
ci_051                 3.208696e-03 3 1  ON 50
ci_052                -2.269556e-03 3 1  ON 51
ci_053                -2.411410e-03 3 1  ON 52
ci_054                -2.900675e-03 3 1  ON 53
ci_055                -2.929217e-03 3 1  ON 54
ci_056                 5.322409e-03 3 1  ON 55
ci_057                 5.144045e-03 3 1  ON 56
ci_058                -1.682996e-03 3 1  ON 57
ci_059                -1.998981e-03 3 1  ON 58
ci_060                 4.948362e-03 3 1  ON 59
ci_061                 5.519009e-03 3 1  ON 60
ci_062                -3.590656e-03 3 1  ON 61
ci_063                -4.124591e-03 3 1  ON 62
ci_064                -3.013802e-03 3 1  ON 63
ci_065                -4.343599e-03 3 1  ON 64
ci_066                 4.512465e-03 3 1  ON 65
ci_067                 4.319476e-03 3 1  ON 66
ci_068                -4.315261e-03 3 1  ON 67
ci_069                -4.855286e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 80
    time step          = 0.05
    reference energy   = -17.1983
    reference variance = 0.232516
====================================================
  Execution time = 1.3826e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s080
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7839e-01
  Total weights = 1.9574e+06
  Execution time = 1.8240e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266947968628
                                         uncertainty =       0.001379917531

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266947968628
                                         uncertainty =       0.001379917531

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365326488
  error estimate for blocks of size 2^( 2) =       0.000379109833
  error estimate for blocks of size 2^( 3) =       0.000391408052
  error estimate for blocks of size 2^( 4) =       0.000400137278
  error estimate for blocks of size 2^( 5) =       0.000405290154
  error estimate for blocks of size 2^( 6) =       0.000406942739
  error estimate for blocks of size 2^( 7) =       0.000408601990

      target function =      -0.947607783403
              le_mean =     -17.212123228626
             les_mean =     296.535574229412
             stat err =       0.000405243040
             autocorr =       1.230463702216
   target nu stat err =       0.000405243040
   target dn stat err =       0.002030122447
      target stat err =       0.003506409141
              std dev =       0.516649673685
             le_variance =       0.266926885319

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266947325391
                                         uncertainty =       0.001379989733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266947325391
                                         uncertainty =       0.001379989733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365326045
  error estimate for blocks of size 2^( 2) =       0.000379109449
  error estimate for blocks of size 2^( 3) =       0.000391407681
  error estimate for blocks of size 2^( 4) =       0.000400136882
  error estimate for blocks of size 2^( 5) =       0.000405289742
  error estimate for blocks of size 2^( 6) =       0.000406942459
  error estimate for blocks of size 2^( 7) =       0.000408601523

      target function =      -0.947607972745
              le_mean =     -17.212123237232
             les_mean =     296.535574404032
             stat err =       0.000405242652
             autocorr =       1.230464324927
   target nu stat err =       0.000405242652
   target dn stat err =       0.002031446917
      target stat err =       0.003508600932
              std dev =       0.516649047350
             le_variance =       0.266926238128

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266947641932
                                         uncertainty =       0.001379953723

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266947641932
                                         uncertainty =       0.001379953723

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365326263
  error estimate for blocks of size 2^( 2) =       0.000379109637
  error estimate for blocks of size 2^( 3) =       0.000391407863
  error estimate for blocks of size 2^( 4) =       0.000400137077
  error estimate for blocks of size 2^( 5) =       0.000405289944
  error estimate for blocks of size 2^( 6) =       0.000406942596
  error estimate for blocks of size 2^( 7) =       0.000408601754

      target function =      -0.947608441083
              le_mean =     -17.212123232635
             les_mean =     296.535573973603
             stat err =       0.000405242843
             autocorr =       1.230464016397
   target nu stat err =       0.000405242843
   target dn stat err =       0.002030769106
      target stat err =       0.003507483344
              std dev =       0.516649355600
             le_variance =       0.266926556642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266947927331
                                         uncertainty =       0.001379922053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266947927331
                                         uncertainty =       0.001379922053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365326459
  error estimate for blocks of size 2^( 2) =       0.000379109808
  error estimate for blocks of size 2^( 3) =       0.000391408028
  error estimate for blocks of size 2^( 4) =       0.000400137252
  error estimate for blocks of size 2^( 5) =       0.000405290127
  error estimate for blocks of size 2^( 6) =       0.000406942721
  error estimate for blocks of size 2^( 7) =       0.000408601960

      target function =      -0.947607934256
              le_mean =     -17.212123229095
             les_mean =     296.535574155727
             stat err =       0.000405243015
             autocorr =       1.230463741757
   target nu stat err =       0.000405243015
   target dn stat err =       0.002030201221
      target stat err =       0.003506540507
              std dev =       0.516649633479
             le_variance =       0.266926843774


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947607783403        initial
     1.3878e+01     1.3878e+02             7.7894e-06        -0.947607972745
     5.5511e+01     5.5511e+02             1.9560e-06        -0.947608441083  <--
     2.2204e+02     2.2204e+03             4.8955e-07        -0.947607934256

*****************************************************************************
Applying the update for shift_i =   5.5511e+01     and shift_s =   5.5511e+02
*****************************************************************************

  Execution time = 2.3033e+01
  </log>
  <optVariables href="H2O.s080.opt.xml">
ci_001                -4.146466e-02 3 1  ON 0
ci_002                -3.159106e-02 3 1  ON 1
ci_003                -2.621163e-02 3 1  ON 2
ci_004                 2.367733e-02 3 1  ON 3
ci_005                 2.385271e-02 3 1  ON 4
ci_006                -2.094588e-02 3 1  ON 5
ci_007                -2.044579e-02 3 1  ON 6
ci_008                -8.611858e-03 3 1  ON 7
ci_009                -1.431068e-02 3 1  ON 8
ci_010                -9.626977e-03 3 1  ON 9
ci_011                -1.061716e-02 3 1  ON 10
ci_012                -9.817442e-03 3 1  ON 11
ci_013                -1.994761e-02 3 1  ON 12
ci_014                 1.257740e-02 3 1  ON 13
ci_015                 1.251997e-02 3 1  ON 14
ci_016                 1.714747e-02 3 1  ON 15
ci_017                 1.630645e-02 3 1  ON 16
ci_018                 9.866728e-03 3 1  ON 17
ci_019                 1.001166e-02 3 1  ON 18
ci_020                 1.718830e-02 3 1  ON 19
ci_021                 1.701941e-02 3 1  ON 20
ci_022                 9.192865e-03 3 1  ON 21
ci_023                 9.456453e-03 3 1  ON 22
ci_024                 9.641065e-03 3 1  ON 23
ci_025                 9.455887e-03 3 1  ON 24
ci_026                 1.108689e-02 3 1  ON 25
ci_027                 1.155820e-02 3 1  ON 26
ci_028                -1.497153e-02 3 1  ON 27
ci_029                -1.552653e-02 3 1  ON 28
ci_030                -9.440909e-03 3 1  ON 29
ci_031                -9.018713e-03 3 1  ON 30
ci_032                -1.485634e-02 3 1  ON 31
ci_033                 5.720074e-03 3 1  ON 32
ci_034                 5.606682e-03 3 1  ON 33
ci_035                -5.050144e-03 3 1  ON 34
ci_036                -1.252799e-02 3 1  ON 35
ci_037                -1.250735e-02 3 1  ON 36
ci_038                 1.770788e-03 3 1  ON 37
ci_039                 1.717193e-03 3 1  ON 38
ci_040                -3.025256e-03 3 1  ON 39
ci_041                 8.816748e-03 3 1  ON 40
ci_042                 8.897884e-03 3 1  ON 41
ci_043                -4.004102e-03 3 1  ON 42
ci_044                -4.084412e-03 3 1  ON 43
ci_045                -3.237747e-03 3 1  ON 44
ci_046                 5.725162e-03 3 1  ON 45
ci_047                 5.627151e-03 3 1  ON 46
ci_048                -1.250495e-02 3 1  ON 47
ci_049                -1.365212e-02 3 1  ON 48
ci_050                 3.425978e-03 3 1  ON 49
ci_051                 3.208696e-03 3 1  ON 50
ci_052                -2.269556e-03 3 1  ON 51
ci_053                -2.411410e-03 3 1  ON 52
ci_054                -2.900675e-03 3 1  ON 53
ci_055                -2.929217e-03 3 1  ON 54
ci_056                 5.322409e-03 3 1  ON 55
ci_057                 5.144045e-03 3 1  ON 56
ci_058                -1.682996e-03 3 1  ON 57
ci_059                -1.998981e-03 3 1  ON 58
ci_060                 4.948362e-03 3 1  ON 59
ci_061                 5.519009e-03 3 1  ON 60
ci_062                -3.590656e-03 3 1  ON 61
ci_063                -4.124591e-03 3 1  ON 62
ci_064                -3.013802e-03 3 1  ON 63
ci_065                -4.343599e-03 3 1  ON 64
ci_066                 4.512465e-03 3 1  ON 65
ci_067                 4.319476e-03 3 1  ON 66
ci_068                -4.315261e-03 3 1  ON 67
ci_069                -4.855286e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9785e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s081 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s081 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=81  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.1898
    reference variance = 0.146936
====================================================
  Execution time = 1.4444e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s081
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5326e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7578e-01
  Total weights = 1.957320268e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4721e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265935927603
                                         uncertainty =       0.001306942408

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265935927603
                                         uncertainty =       0.001306942408

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364652617
  error estimate for blocks of size 2^( 2) =       0.000378480519
  error estimate for blocks of size 2^( 3) =       0.000390877019
  error estimate for blocks of size 2^( 4) =       0.000400090856
  error estimate for blocks of size 2^( 5) =       0.000407228059
  error estimate for blocks of size 2^( 6) =       0.000411700200
  error estimate for blocks of size 2^( 7) =       0.000412777982

      target function =      -0.952030367027
              le_mean =     -17.212080625233
             les_mean =     296.531503051149
             stat err =       0.000407949274
             autocorr =       1.251565719905
   target nu stat err =       0.000407949274
   target dn stat err =       0.001939248682
      target stat err =       0.003387712056
              std dev =       0.515696676945
             le_variance =       0.265943062612


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721208062523e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+01, overlap shift 1.3878e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952041382485       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952044747476       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952045253482       residual = 2.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.952045358557       residual = 5.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.952045379995       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.952045373267       residual = 2.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.952045371339       residual = 3.94e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.952045370592       residual = 8.90e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.952045371006       residual = 2.06e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.952045371040       residual = 5.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+01 is 8.905642e-06

solving harmonic davidson linear method for identity shift 5.5511e+01, overlap shift 5.5511e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952041382485       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952042227519       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952042354470       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.952042380782       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.952042386146       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.952042384458       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.952042383975       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.952042383788       residual = 8.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.952042383892       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.952042383900       residual = 5.58e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+01 is 2.236212e-06

solving harmonic davidson linear method for identity shift 2.2204e+02, overlap shift 2.2204e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.952041382485       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.952041593981       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.952041625747       residual = 2.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.952041632328       residual = 5.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.952041633669       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.952041633246       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.952041633126       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.952041633079       residual = 8.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.952041633105       residual = 2.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.952041633107       residual = 5.56e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+02 is 5.596689e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.300755 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6925e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
ci_001                -4.146461e-02 3 1  ON 0
ci_002                -3.159151e-02 3 1  ON 1
ci_003                -2.621082e-02 3 1  ON 2
ci_004                 2.367609e-02 3 1  ON 3
ci_005                 2.385268e-02 3 1  ON 4
ci_006                -2.094446e-02 3 1  ON 5
ci_007                -2.044598e-02 3 1  ON 6
ci_008                -8.609867e-03 3 1  ON 7
ci_009                -1.431229e-02 3 1  ON 8
ci_010                -9.626420e-03 3 1  ON 9
ci_011                -1.061873e-02 3 1  ON 10
ci_012                -9.818543e-03 3 1  ON 11
ci_013                -1.994713e-02 3 1  ON 12
ci_014                 1.257755e-02 3 1  ON 13
ci_015                 1.251974e-02 3 1  ON 14
ci_016                 1.714742e-02 3 1  ON 15
ci_017                 1.630646e-02 3 1  ON 16
ci_018                 9.867500e-03 3 1  ON 17
ci_019                 1.001182e-02 3 1  ON 18
ci_020                 1.718802e-02 3 1  ON 19
ci_021                 1.701801e-02 3 1  ON 20
ci_022                 9.192557e-03 3 1  ON 21
ci_023                 9.454998e-03 3 1  ON 22
ci_024                 9.642512e-03 3 1  ON 23
ci_025                 9.454713e-03 3 1  ON 24
ci_026                 1.108762e-02 3 1  ON 25
ci_027                 1.155668e-02 3 1  ON 26
ci_028                -1.497182e-02 3 1  ON 27
ci_029                -1.552558e-02 3 1  ON 28
ci_030                -9.439854e-03 3 1  ON 29
ci_031                -9.018690e-03 3 1  ON 30
ci_032                -1.485725e-02 3 1  ON 31
ci_033                 5.720752e-03 3 1  ON 32
ci_034                 5.606360e-03 3 1  ON 33
ci_035                -5.050040e-03 3 1  ON 34
ci_036                -1.252777e-02 3 1  ON 35
ci_037                -1.250749e-02 3 1  ON 36
ci_038                 1.770430e-03 3 1  ON 37
ci_039                 1.717406e-03 3 1  ON 38
ci_040                -3.025301e-03 3 1  ON 39
ci_041                 8.814512e-03 3 1  ON 40
ci_042                 8.899381e-03 3 1  ON 41
ci_043                -4.004045e-03 3 1  ON 42
ci_044                -4.084160e-03 3 1  ON 43
ci_045                -3.236332e-03 3 1  ON 44
ci_046                 5.725062e-03 3 1  ON 45
ci_047                 5.627160e-03 3 1  ON 46
ci_048                -1.250569e-02 3 1  ON 47
ci_049                -1.365223e-02 3 1  ON 48
ci_050                 3.425921e-03 3 1  ON 49
ci_051                 3.208760e-03 3 1  ON 50
ci_052                -2.268953e-03 3 1  ON 51
ci_053                -2.411415e-03 3 1  ON 52
ci_054                -2.901383e-03 3 1  ON 53
ci_055                -2.928745e-03 3 1  ON 54
ci_056                 5.322549e-03 3 1  ON 55
ci_057                 5.144432e-03 3 1  ON 56
ci_058                -1.683559e-03 3 1  ON 57
ci_059                -1.997944e-03 3 1  ON 58
ci_060                 4.949193e-03 3 1  ON 59
ci_061                 5.518381e-03 3 1  ON 60
ci_062                -3.590805e-03 3 1  ON 61
ci_063                -4.123654e-03 3 1  ON 62
ci_064                -3.013912e-03 3 1  ON 63
ci_065                -4.343197e-03 3 1  ON 64
ci_066                 4.511387e-03 3 1  ON 65
ci_067                 4.319262e-03 3 1  ON 66
ci_068                -4.316881e-03 3 1  ON 67
ci_069                -4.854566e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 81
    time step          = 0.05
    reference energy   = -17.2306
    reference variance = 0.174491
====================================================
  Execution time = 1.4023e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s081
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8209e-01
  Total weights = 1.9572e+06
  Execution time = 1.8483e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270008320397
                                         uncertainty =       0.002008175245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270008320397
                                         uncertainty =       0.002008175245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367459401
  error estimate for blocks of size 2^( 2) =       0.000381231517
  error estimate for blocks of size 2^( 3) =       0.000393708536
  error estimate for blocks of size 2^( 4) =       0.000403458232
  error estimate for blocks of size 2^( 5) =       0.000409688540
  error estimate for blocks of size 2^( 6) =       0.000412465947
  error estimate for blocks of size 2^( 7) =       0.000412131833

      target function =      -0.941372701878
              le_mean =     -17.212667311200
             les_mean =     296.558015296293
             stat err =       0.000409436138
             autocorr =       1.241519709750
   target nu stat err =       0.000409436138
   target dn stat err =       0.002335652714
      target stat err =       0.003966756744
              std dev =       0.519666068306
             le_variance =       0.270052822549

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270007756315
                                         uncertainty =       0.002008134679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270007756315
                                         uncertainty =       0.002008134679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367459025
  error estimate for blocks of size 2^( 2) =       0.000381231441
  error estimate for blocks of size 2^( 3) =       0.000393708668
  error estimate for blocks of size 2^( 4) =       0.000403458784
  error estimate for blocks of size 2^( 5) =       0.000409689351
  error estimate for blocks of size 2^( 6) =       0.000412466784
  error estimate for blocks of size 2^( 7) =       0.000412132554

      target function =      -0.941407743465
              le_mean =     -17.212667214658
             les_mean =     296.557990979968
             stat err =       0.000409436868
             autocorr =       1.241526678788
   target nu stat err =       0.000409436868
   target dn stat err =       0.002336367202
      target stat err =       0.003968219555
              std dev =       0.519665536743
             le_variance =       0.270052270079

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270008032974
                                         uncertainty =       0.002008154789

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270008032974
                                         uncertainty =       0.002008154789

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367459209
  error estimate for blocks of size 2^( 2) =       0.000381231476
  error estimate for blocks of size 2^( 3) =       0.000393708599
  error estimate for blocks of size 2^( 4) =       0.000403458506
  error estimate for blocks of size 2^( 5) =       0.000409688944
  error estimate for blocks of size 2^( 6) =       0.000412466364
  error estimate for blocks of size 2^( 7) =       0.000412132193

      target function =      -0.941393728585
              le_mean =     -17.212667262237
             les_mean =     296.558001015360
             stat err =       0.000409436502
             autocorr =       1.241523213442
   target nu stat err =       0.000409436502
   target dn stat err =       0.002335888898
      target stat err =       0.003967318447
              std dev =       0.519665797378
             le_variance =       0.270052540965

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270008283960
                                         uncertainty =       0.002008172679

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270008283960
                                         uncertainty =       0.002008172679

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367459377
  error estimate for blocks of size 2^( 2) =       0.000381231512
  error estimate for blocks of size 2^( 3) =       0.000393708543
  error estimate for blocks of size 2^( 4) =       0.000403458266
  error estimate for blocks of size 2^( 5) =       0.000409688590
  error estimate for blocks of size 2^( 6) =       0.000412465999
  error estimate for blocks of size 2^( 7) =       0.000412131878

      target function =      -0.941375773215
              le_mean =     -17.212667305021
             les_mean =     296.558013243945
             stat err =       0.000409436183
             autocorr =       1.241520148646
   target nu stat err =       0.000409436183
   target dn stat err =       0.002335664671
      target stat err =       0.003966801791
              std dev =       0.519666033952
             le_variance =       0.270052786843


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.941372701878        initial
     1.3878e+01     1.3878e+02             8.9056e-06        -0.941407743465  <--
     5.5511e+01     5.5511e+02             2.2362e-06        -0.941393728585
     2.2204e+02     2.2204e+03             5.5967e-07        -0.941375773215

*****************************************************************************
Applying the update for shift_i =   1.3878e+01     and shift_s =   1.3878e+02
*****************************************************************************

  Execution time = 2.3252e+01
  </log>
  <optVariables href="H2O.s081.opt.xml">
ci_001                -4.146444e-02 3 1  ON 0
ci_002                -3.159287e-02 3 1  ON 1
ci_003                -2.620838e-02 3 1  ON 2
ci_004                 2.367236e-02 3 1  ON 3
ci_005                 2.385257e-02 3 1  ON 4
ci_006                -2.094022e-02 3 1  ON 5
ci_007                -2.044655e-02 3 1  ON 6
ci_008                -8.603928e-03 3 1  ON 7
ci_009                -1.431709e-02 3 1  ON 8
ci_010                -9.624759e-03 3 1  ON 9
ci_011                -1.062344e-02 3 1  ON 10
ci_012                -9.821829e-03 3 1  ON 11
ci_013                -1.994568e-02 3 1  ON 12
ci_014                 1.257802e-02 3 1  ON 13
ci_015                 1.251907e-02 3 1  ON 14
ci_016                 1.714730e-02 3 1  ON 15
ci_017                 1.630649e-02 3 1  ON 16
ci_018                 9.869801e-03 3 1  ON 17
ci_019                 1.001229e-02 3 1  ON 18
ci_020                 1.718719e-02 3 1  ON 19
ci_021                 1.701383e-02 3 1  ON 20
ci_022                 9.191637e-03 3 1  ON 21
ci_023                 9.450656e-03 3 1  ON 22
ci_024                 9.646831e-03 3 1  ON 23
ci_025                 9.451206e-03 3 1  ON 24
ci_026                 1.108981e-02 3 1  ON 25
ci_027                 1.155215e-02 3 1  ON 26
ci_028                -1.497269e-02 3 1  ON 27
ci_029                -1.552273e-02 3 1  ON 28
ci_030                -9.436709e-03 3 1  ON 29
ci_031                -9.018623e-03 3 1  ON 30
ci_032                -1.485996e-02 3 1  ON 31
ci_033                 5.722778e-03 3 1  ON 32
ci_034                 5.605399e-03 3 1  ON 33
ci_035                -5.049728e-03 3 1  ON 34
ci_036                -1.252711e-02 3 1  ON 35
ci_037                -1.250788e-02 3 1  ON 36
ci_038                 1.769362e-03 3 1  ON 37
ci_039                 1.718043e-03 3 1  ON 38
ci_040                -3.025435e-03 3 1  ON 39
ci_041                 8.807842e-03 3 1  ON 40
ci_042                 8.903846e-03 3 1  ON 41
ci_043                -4.003876e-03 3 1  ON 42
ci_044                -4.083409e-03 3 1  ON 43
ci_045                -3.232112e-03 3 1  ON 44
ci_046                 5.724760e-03 3 1  ON 45
ci_047                 5.627185e-03 3 1  ON 46
ci_048                -1.250790e-02 3 1  ON 47
ci_049                -1.365257e-02 3 1  ON 48
ci_050                 3.425751e-03 3 1  ON 49
ci_051                 3.208950e-03 3 1  ON 50
ci_052                -2.267157e-03 3 1  ON 51
ci_053                -2.411431e-03 3 1  ON 52
ci_054                -2.903495e-03 3 1  ON 53
ci_055                -2.927337e-03 3 1  ON 54
ci_056                 5.322969e-03 3 1  ON 55
ci_057                 5.145585e-03 3 1  ON 56
ci_058                -1.685240e-03 3 1  ON 57
ci_059                -1.994850e-03 3 1  ON 58
ci_060                 4.951675e-03 3 1  ON 59
ci_061                 5.516506e-03 3 1  ON 60
ci_062                -3.591250e-03 3 1  ON 61
ci_063                -4.120858e-03 3 1  ON 62
ci_064                -3.014240e-03 3 1  ON 63
ci_065                -4.341998e-03 3 1  ON 64
ci_066                 4.508170e-03 3 1  ON 65
ci_067                 4.318624e-03 3 1  ON 66
ci_068                -4.321716e-03 3 1  ON 67
ci_069                -4.852416e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0183e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s082 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s082 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=82  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.1564
    reference variance = 0.520633
====================================================
  Execution time = 1.4219e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s082
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5311e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7805e-01
  Total weights = 1.957353299e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4650e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267838892146
                                         uncertainty =       0.001410814702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267838892146
                                         uncertainty =       0.001410814702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365937234
  error estimate for blocks of size 2^( 2) =       0.000380026531
  error estimate for blocks of size 2^( 3) =       0.000393044234
  error estimate for blocks of size 2^( 4) =       0.000401892470
  error estimate for blocks of size 2^( 5) =       0.000406239671
  error estimate for blocks of size 2^( 6) =       0.000409562263
  error estimate for blocks of size 2^( 7) =       0.000409989614

      target function =      -0.948162023989
              le_mean =     -17.211215852502
             les_mean =     296.504004383219
             stat err =       0.000406921004
             autocorr =       1.236536711833
   target nu stat err =       0.000406921004
   target dn stat err =       0.001899061520
      target stat err =       0.003288770659
              std dev =       0.517513398623
             le_variance =       0.267820117755


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721121585250e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+00, overlap shift 3.4694e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948172444970       residual = 7.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948180314921       residual = 8.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948181495979       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948181882284       residual = 3.46e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948181986748       residual = 6.81e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948182012794       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948182014446       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948182014354       residual = 4.19e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948182016160       residual = 7.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+00 is 2.884670e-05

solving harmonic davidson linear method for identity shift 1.3878e+01, overlap shift 1.3878e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948172444970       residual = 7.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948174446892       residual = 8.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948174746107       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948174843428       residual = 3.41e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948174869682       residual = 6.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948174876187       residual = 1.14e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948174876594       residual = 1.39e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948174876570       residual = 4.04e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948174877023       residual = 7.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+01 is 7.323375e-06

solving harmonic davidson linear method for identity shift 5.5511e+01, overlap shift 5.5511e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948172444970       residual = 7.40e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948172947650       residual = 8.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948173022704       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948173047081       residual = 3.39e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948173053653       residual = 6.65e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948173055279       residual = 1.13e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948173055380       residual = 1.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948173055374       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948173055488       residual = 7.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+01 is 1.837960e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.303773 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6692e+01
  </log>
  <optVariables href="H2O.s082.opt.xml">
ci_001                -4.146409e-02 3 1  ON 0
ci_002                -3.159478e-02 3 1  ON 1
ci_003                -2.620341e-02 3 1  ON 2
ci_004                 2.366870e-02 3 1  ON 3
ci_005                 2.384650e-02 3 1  ON 4
ci_006                -2.093930e-02 3 1  ON 5
ci_007                -2.044613e-02 3 1  ON 6
ci_008                -8.603253e-03 3 1  ON 7
ci_009                -1.431456e-02 3 1  ON 8
ci_010                -9.625422e-03 3 1  ON 9
ci_011                -1.062404e-02 3 1  ON 10
ci_012                -9.822450e-03 3 1  ON 11
ci_013                -1.994595e-02 3 1  ON 12
ci_014                 1.258025e-02 3 1  ON 13
ci_015                 1.251908e-02 3 1  ON 14
ci_016                 1.714706e-02 3 1  ON 15
ci_017                 1.630389e-02 3 1  ON 16
ci_018                 9.874603e-03 3 1  ON 17
ci_019                 1.001677e-02 3 1  ON 18
ci_020                 1.718410e-02 3 1  ON 19
ci_021                 1.701746e-02 3 1  ON 20
ci_022                 9.189242e-03 3 1  ON 21
ci_023                 9.451915e-03 3 1  ON 22
ci_024                 9.653168e-03 3 1  ON 23
ci_025                 9.449715e-03 3 1  ON 24
ci_026                 1.109080e-02 3 1  ON 25
ci_027                 1.154829e-02 3 1  ON 26
ci_028                -1.497316e-02 3 1  ON 27
ci_029                -1.552055e-02 3 1  ON 28
ci_030                -9.429599e-03 3 1  ON 29
ci_031                -9.020308e-03 3 1  ON 30
ci_032                -1.486315e-02 3 1  ON 31
ci_033                 5.719067e-03 3 1  ON 32
ci_034                 5.604127e-03 3 1  ON 33
ci_035                -5.049411e-03 3 1  ON 34
ci_036                -1.253370e-02 3 1  ON 35
ci_037                -1.250640e-02 3 1  ON 36
ci_038                 1.766980e-03 3 1  ON 37
ci_039                 1.718229e-03 3 1  ON 38
ci_040                -3.027639e-03 3 1  ON 39
ci_041                 8.807836e-03 3 1  ON 40
ci_042                 8.899417e-03 3 1  ON 41
ci_043                -4.000821e-03 3 1  ON 42
ci_044                -4.088643e-03 3 1  ON 43
ci_045                -3.232916e-03 3 1  ON 44
ci_046                 5.721958e-03 3 1  ON 45
ci_047                 5.626827e-03 3 1  ON 46
ci_048                -1.250812e-02 3 1  ON 47
ci_049                -1.364814e-02 3 1  ON 48
ci_050                 3.425093e-03 3 1  ON 49
ci_051                 3.209900e-03 3 1  ON 50
ci_052                -2.265131e-03 3 1  ON 51
ci_053                -2.413242e-03 3 1  ON 52
ci_054                -2.901158e-03 3 1  ON 53
ci_055                -2.928773e-03 3 1  ON 54
ci_056                 5.320070e-03 3 1  ON 55
ci_057                 5.143404e-03 3 1  ON 56
ci_058                -1.684026e-03 3 1  ON 57
ci_059                -1.988757e-03 3 1  ON 58
ci_060                 4.952543e-03 3 1  ON 59
ci_061                 5.518922e-03 3 1  ON 60
ci_062                -3.590361e-03 3 1  ON 61
ci_063                -4.118115e-03 3 1  ON 62
ci_064                -3.014473e-03 3 1  ON 63
ci_065                -4.341507e-03 3 1  ON 64
ci_066                 4.507082e-03 3 1  ON 65
ci_067                 4.320386e-03 3 1  ON 66
ci_068                -4.329040e-03 3 1  ON 67
ci_069                -4.848116e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 82
    time step          = 0.05
    reference energy   = -17.2182
    reference variance = 0.19943
====================================================
  Execution time = 1.3942e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s082
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8256e-01
  Total weights = 1.9573e+06
  Execution time = 1.8268e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270419414180
                                         uncertainty =       0.001822446173

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270419414180
                                         uncertainty =       0.001822446173

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367711876
  error estimate for blocks of size 2^( 2) =       0.000381649296
  error estimate for blocks of size 2^( 3) =       0.000394235985
  error estimate for blocks of size 2^( 4) =       0.000403381609
  error estimate for blocks of size 2^( 5) =       0.000409038805
  error estimate for blocks of size 2^( 6) =       0.000414294911
  error estimate for blocks of size 2^( 7) =       0.000415723320

      target function =      -0.940599399295
              le_mean =     -17.212029355280
             les_mean =     296.536516330762
             stat err =       0.000410609662
             autocorr =       1.246932704041
   target nu stat err =       0.000410609662
   target dn stat err =       0.002536635392
      target stat err =       0.004285353217
              std dev =       0.520023121759
             le_variance =       0.270424047164

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270412079084
                                         uncertainty =       0.001821133183

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270412079084
                                         uncertainty =       0.001821133183

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367706863
  error estimate for blocks of size 2^( 2) =       0.000381644722
  error estimate for blocks of size 2^( 3) =       0.000394232251
  error estimate for blocks of size 2^( 4) =       0.000403378306
  error estimate for blocks of size 2^( 5) =       0.000409035717
  error estimate for blocks of size 2^( 6) =       0.000414291850
  error estimate for blocks of size 2^( 7) =       0.000415719878

      target function =      -0.940576939127
              le_mean =     -17.212028986263
             les_mean =     296.536517156514
             stat err =       0.000410606438
             autocorr =       1.246947124031
   target nu stat err =       0.000410606438
   target dn stat err =       0.002532500157
      target stat err =       0.004278362712
              std dev =       0.520016032274
             le_variance =       0.270416673822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270415633210
                                         uncertainty =       0.001821777003

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270415633210
                                         uncertainty =       0.001821777003

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367709292
  error estimate for blocks of size 2^( 2) =       0.000381646936
  error estimate for blocks of size 2^( 3) =       0.000394234053
  error estimate for blocks of size 2^( 4) =       0.000403379896
  error estimate for blocks of size 2^( 5) =       0.000409037202
  error estimate for blocks of size 2^( 6) =       0.000414293323
  error estimate for blocks of size 2^( 7) =       0.000415721537

      target function =      -0.940592995912
              le_mean =     -17.212029162046
             les_mean =     296.536513545355
             stat err =       0.000410607989
             autocorr =       1.246940071772
   target nu stat err =       0.000410607989
   target dn stat err =       0.002534412845
      target stat err =       0.004281646857
              std dev =       0.520019467734
             le_variance =       0.270420246822

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270418934019
                                         uncertainty =       0.001822362028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270418934019
                                         uncertainty =       0.001822362028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367711548
  error estimate for blocks of size 2^( 2) =       0.000381648996
  error estimate for blocks of size 2^( 3) =       0.000394235739
  error estimate for blocks of size 2^( 4) =       0.000403381391
  error estimate for blocks of size 2^( 5) =       0.000409038600
  error estimate for blocks of size 2^( 6) =       0.000414294708
  error estimate for blocks of size 2^( 7) =       0.000415723093

      target function =      -0.940599105297
              le_mean =     -17.212029330354
             les_mean =     296.536515651935
             stat err =       0.000410609448
             autocorr =       1.246933633049
   target nu stat err =       0.000410609448
   target dn stat err =       0.002536344985
      target stat err =       0.004284873795
              std dev =       0.520022657753
             le_variance =       0.270423564577


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940599399295        initial  <--
     3.4694e+00     3.4694e+01             2.8847e-05        -0.940576939127
     1.3878e+01     1.3878e+02             7.3234e-06        -0.940592995912
     5.5511e+01     5.5511e+02             1.8380e-06        -0.940599105297

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1477
  </log>
  <optVariables href="H2O.s082.opt.xml">
ci_001                -4.146444e-02 3 1  ON 0
ci_002                -3.159287e-02 3 1  ON 1
ci_003                -2.620838e-02 3 1  ON 2
ci_004                 2.367236e-02 3 1  ON 3
ci_005                 2.385257e-02 3 1  ON 4
ci_006                -2.094022e-02 3 1  ON 5
ci_007                -2.044655e-02 3 1  ON 6
ci_008                -8.603928e-03 3 1  ON 7
ci_009                -1.431709e-02 3 1  ON 8
ci_010                -9.624759e-03 3 1  ON 9
ci_011                -1.062344e-02 3 1  ON 10
ci_012                -9.821829e-03 3 1  ON 11
ci_013                -1.994568e-02 3 1  ON 12
ci_014                 1.257802e-02 3 1  ON 13
ci_015                 1.251907e-02 3 1  ON 14
ci_016                 1.714730e-02 3 1  ON 15
ci_017                 1.630649e-02 3 1  ON 16
ci_018                 9.869801e-03 3 1  ON 17
ci_019                 1.001229e-02 3 1  ON 18
ci_020                 1.718719e-02 3 1  ON 19
ci_021                 1.701383e-02 3 1  ON 20
ci_022                 9.191637e-03 3 1  ON 21
ci_023                 9.450656e-03 3 1  ON 22
ci_024                 9.646831e-03 3 1  ON 23
ci_025                 9.451206e-03 3 1  ON 24
ci_026                 1.108981e-02 3 1  ON 25
ci_027                 1.155215e-02 3 1  ON 26
ci_028                -1.497269e-02 3 1  ON 27
ci_029                -1.552273e-02 3 1  ON 28
ci_030                -9.436709e-03 3 1  ON 29
ci_031                -9.018623e-03 3 1  ON 30
ci_032                -1.485996e-02 3 1  ON 31
ci_033                 5.722778e-03 3 1  ON 32
ci_034                 5.605399e-03 3 1  ON 33
ci_035                -5.049728e-03 3 1  ON 34
ci_036                -1.252711e-02 3 1  ON 35
ci_037                -1.250788e-02 3 1  ON 36
ci_038                 1.769362e-03 3 1  ON 37
ci_039                 1.718043e-03 3 1  ON 38
ci_040                -3.025435e-03 3 1  ON 39
ci_041                 8.807842e-03 3 1  ON 40
ci_042                 8.903846e-03 3 1  ON 41
ci_043                -4.003876e-03 3 1  ON 42
ci_044                -4.083409e-03 3 1  ON 43
ci_045                -3.232112e-03 3 1  ON 44
ci_046                 5.724760e-03 3 1  ON 45
ci_047                 5.627185e-03 3 1  ON 46
ci_048                -1.250790e-02 3 1  ON 47
ci_049                -1.365257e-02 3 1  ON 48
ci_050                 3.425751e-03 3 1  ON 49
ci_051                 3.208950e-03 3 1  ON 50
ci_052                -2.267157e-03 3 1  ON 51
ci_053                -2.411431e-03 3 1  ON 52
ci_054                -2.903495e-03 3 1  ON 53
ci_055                -2.927337e-03 3 1  ON 54
ci_056                 5.322969e-03 3 1  ON 55
ci_057                 5.145585e-03 3 1  ON 56
ci_058                -1.685240e-03 3 1  ON 57
ci_059                -1.994850e-03 3 1  ON 58
ci_060                 4.951675e-03 3 1  ON 59
ci_061                 5.516506e-03 3 1  ON 60
ci_062                -3.591250e-03 3 1  ON 61
ci_063                -4.120858e-03 3 1  ON 62
ci_064                -3.014240e-03 3 1  ON 63
ci_065                -4.341998e-03 3 1  ON 64
ci_066                 4.508170e-03 3 1  ON 65
ci_067                 4.318624e-03 3 1  ON 66
ci_068                -4.321716e-03 3 1  ON 67
ci_069                -4.852416e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9846e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s083 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s083 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=83  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.2972
    reference variance = 0.382169
====================================================
  Execution time = 1.4283e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s083
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8188e-01
  Total weights = 1.957341993e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4660e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269787613905
                                         uncertainty =       0.002078472248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269787613905
                                         uncertainty =       0.002078472248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367353116
  error estimate for blocks of size 2^( 2) =       0.000381274091
  error estimate for blocks of size 2^( 3) =       0.000394092828
  error estimate for blocks of size 2^( 4) =       0.000403965021
  error estimate for blocks of size 2^( 5) =       0.000410676899
  error estimate for blocks of size 2^( 6) =       0.000413364806
  error estimate for blocks of size 2^( 7) =       0.000413968394

      target function =      -0.941738807560
              le_mean =     -17.211660184967
             les_mean =     296.523122428919
             stat err =       0.000410493780
             autocorr =       1.248664330938
   target nu stat err =       0.000410493780
   target dn stat err =       0.002711013406
      target stat err =       0.004579478402
              std dev =       0.519515758562
             le_variance =       0.269896623395


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721166018497e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+01, overlap shift 3.4694e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941760136604       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941761357714       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941761483135       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941761528488       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941761536124       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941761535305       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941761535383       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941761535126       residual = 5.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941761535069       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941761535076       residual = 1.77e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+01 is 3.390544e-06

solving harmonic davidson linear method for identity shift 1.3878e+02, overlap shift 1.3878e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941760136604       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941760442413       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941760473806       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941760485153       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941760487063       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941760486858       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941760486877       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941760486813       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941760486799       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941760486801       residual = 1.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+02 is 8.489870e-07

solving harmonic davidson linear method for identity shift 5.5511e+02, overlap shift 5.5511e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941760136604       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941760213090       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941760220940       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941760223777       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941760224255       residual = 1.20e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941760224205       residual = 1.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941760224209       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941760224193       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941760224189       residual = 1.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941760224190       residual = 1.76e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+02 is 2.123314e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.307240 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6758e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
ci_001                -4.146407e-02 3 1  ON 0
ci_002                -3.159259e-02 3 1  ON 1
ci_003                -2.620810e-02 3 1  ON 2
ci_004                 2.367240e-02 3 1  ON 3
ci_005                 2.385232e-02 3 1  ON 4
ci_006                -2.093977e-02 3 1  ON 5
ci_007                -2.044664e-02 3 1  ON 6
ci_008                -8.604350e-03 3 1  ON 7
ci_009                -1.431717e-02 3 1  ON 8
ci_010                -9.624707e-03 3 1  ON 9
ci_011                -1.062311e-02 3 1  ON 10
ci_012                -9.820980e-03 3 1  ON 11
ci_013                -1.994559e-02 3 1  ON 12
ci_014                 1.257777e-02 3 1  ON 13
ci_015                 1.251902e-02 3 1  ON 14
ci_016                 1.714665e-02 3 1  ON 15
ci_017                 1.630673e-02 3 1  ON 16
ci_018                 9.870175e-03 3 1  ON 17
ci_019                 1.001289e-02 3 1  ON 18
ci_020                 1.718654e-02 3 1  ON 19
ci_021                 1.701373e-02 3 1  ON 20
ci_022                 9.191789e-03 3 1  ON 21
ci_023                 9.449976e-03 3 1  ON 22
ci_024                 9.646389e-03 3 1  ON 23
ci_025                 9.451304e-03 3 1  ON 24
ci_026                 1.108957e-02 3 1  ON 25
ci_027                 1.155131e-02 3 1  ON 26
ci_028                -1.497330e-02 3 1  ON 27
ci_029                -1.552281e-02 3 1  ON 28
ci_030                -9.436944e-03 3 1  ON 29
ci_031                -9.018530e-03 3 1  ON 30
ci_032                -1.486040e-02 3 1  ON 31
ci_033                 5.722913e-03 3 1  ON 32
ci_034                 5.605609e-03 3 1  ON 33
ci_035                -5.049668e-03 3 1  ON 34
ci_036                -1.252747e-02 3 1  ON 35
ci_037                -1.250764e-02 3 1  ON 36
ci_038                 1.769336e-03 3 1  ON 37
ci_039                 1.718314e-03 3 1  ON 38
ci_040                -3.025506e-03 3 1  ON 39
ci_041                 8.807854e-03 3 1  ON 40
ci_042                 8.903717e-03 3 1  ON 41
ci_043                -4.003900e-03 3 1  ON 42
ci_044                -4.083661e-03 3 1  ON 43
ci_045                -3.231960e-03 3 1  ON 44
ci_046                 5.724247e-03 3 1  ON 45
ci_047                 5.627407e-03 3 1  ON 46
ci_048                -1.250803e-02 3 1  ON 47
ci_049                -1.365217e-02 3 1  ON 48
ci_050                 3.425757e-03 3 1  ON 49
ci_051                 3.208630e-03 3 1  ON 50
ci_052                -2.266686e-03 3 1  ON 51
ci_053                -2.411273e-03 3 1  ON 52
ci_054                -2.902976e-03 3 1  ON 53
ci_055                -2.927324e-03 3 1  ON 54
ci_056                 5.323264e-03 3 1  ON 55
ci_057                 5.145678e-03 3 1  ON 56
ci_058                -1.684959e-03 3 1  ON 57
ci_059                -1.994766e-03 3 1  ON 58
ci_060                 4.950977e-03 3 1  ON 59
ci_061                 5.516410e-03 3 1  ON 60
ci_062                -3.591543e-03 3 1  ON 61
ci_063                -4.120397e-03 3 1  ON 62
ci_064                -3.014411e-03 3 1  ON 63
ci_065                -4.342057e-03 3 1  ON 64
ci_066                 4.508188e-03 3 1  ON 65
ci_067                 4.318662e-03 3 1  ON 66
ci_068                -4.322444e-03 3 1  ON 67
ci_069                -4.852396e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 83
    time step          = 0.05
    reference energy   = -17.1409
    reference variance = 0.18984
====================================================
  Execution time = 1.4262e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s083
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7896e-01
  Total weights = 1.9575e+06
  Execution time = 1.8443e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266714805481
                                         uncertainty =       0.001458127317

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266714805481
                                         uncertainty =       0.001458127317

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365168143
  error estimate for blocks of size 2^( 2) =       0.000379359312
  error estimate for blocks of size 2^( 3) =       0.000392423279
  error estimate for blocks of size 2^( 4) =       0.000401600676
  error estimate for blocks of size 2^( 5) =       0.000407377993
  error estimate for blocks of size 2^( 6) =       0.000410418418
  error estimate for blocks of size 2^( 7) =       0.000411787260

      target function =      -0.946634923861
              le_mean =     -17.212681218488
             les_mean =     296.555358378772
             stat err =       0.000407796087
             autocorr =       1.247097308984
   target nu stat err =       0.000407796087
   target dn stat err =       0.002485202426
      target stat err =       0.004258628276
              std dev =       0.516425740354
             le_variance =       0.266695545300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266714460039
                                         uncertainty =       0.001458041487

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266714460039
                                         uncertainty =       0.001458041487

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365167904
  error estimate for blocks of size 2^( 2) =       0.000379359157
  error estimate for blocks of size 2^( 3) =       0.000392423264
  error estimate for blocks of size 2^( 4) =       0.000401600765
  error estimate for blocks of size 2^( 5) =       0.000407378140
  error estimate for blocks of size 2^( 6) =       0.000410418550
  error estimate for blocks of size 2^( 7) =       0.000411787628

      target function =      -0.946634507258
              le_mean =     -17.212681184377
             les_mean =     296.555357452539
             stat err =       0.000407796271
             autocorr =       1.247100066100
   target nu stat err =       0.000407796271
   target dn stat err =       0.002485061695
      target stat err =       0.004258390232
              std dev =       0.516425402501
             le_variance =       0.266695196348

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266714631946
                                         uncertainty =       0.001458084325

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266714631946
                                         uncertainty =       0.001458084325

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365168023
  error estimate for blocks of size 2^( 2) =       0.000379359234
  error estimate for blocks of size 2^( 3) =       0.000392423271
  error estimate for blocks of size 2^( 4) =       0.000401600720
  error estimate for blocks of size 2^( 5) =       0.000407378066
  error estimate for blocks of size 2^( 6) =       0.000410418484
  error estimate for blocks of size 2^( 7) =       0.000411787444

      target function =      -0.946634839368
              le_mean =     -17.212681201319
             les_mean =     296.555357838410
             stat err =       0.000407796179
             autocorr =       1.247098689808
   target nu stat err =       0.000407796179
   target dn stat err =       0.002485131680
      target stat err =       0.004258509718
              std dev =       0.516425570637
             le_variance =       0.266695370007

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266714783714
                                         uncertainty =       0.001458121939

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266714783714
                                         uncertainty =       0.001458121939

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365168128
  error estimate for blocks of size 2^( 2) =       0.000379359302
  error estimate for blocks of size 2^( 3) =       0.000392423278
  error estimate for blocks of size 2^( 4) =       0.000401600682
  error estimate for blocks of size 2^( 5) =       0.000407378002
  error estimate for blocks of size 2^( 6) =       0.000410418426
  error estimate for blocks of size 2^( 7) =       0.000411787283

      target function =      -0.946634927667
              le_mean =     -17.212681216332
             les_mean =     296.555358302366
             stat err =       0.000407796098
             autocorr =       1.247097481682
   target nu stat err =       0.000407796098
   target dn stat err =       0.002485193545
      target stat err =       0.004258613521
              std dev =       0.516425719067
             le_variance =       0.266695523313


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946634923861        initial
     3.4694e+01     3.4694e+02             3.3905e-06        -0.946634507258
     1.3878e+02     1.3878e+03             8.4899e-07        -0.946634839368
     5.5511e+02     5.5511e+03             2.1233e-07        -0.946634927667  <--

*****************************************************************************
Applying the update for shift_i =   5.5511e+02     and shift_s =   5.5511e+03
*****************************************************************************

  Execution time = 2.4987e+01
  </log>
  <optVariables href="H2O.s083.opt.xml">
ci_001                -4.146434e-02 3 1  ON 0
ci_002                -3.159280e-02 3 1  ON 1
ci_003                -2.620831e-02 3 1  ON 2
ci_004                 2.367237e-02 3 1  ON 3
ci_005                 2.385251e-02 3 1  ON 4
ci_006                -2.094010e-02 3 1  ON 5
ci_007                -2.044658e-02 3 1  ON 6
ci_008                -8.604033e-03 3 1  ON 7
ci_009                -1.431711e-02 3 1  ON 8
ci_010                -9.624746e-03 3 1  ON 9
ci_011                -1.062336e-02 3 1  ON 10
ci_012                -9.821617e-03 3 1  ON 11
ci_013                -1.994565e-02 3 1  ON 12
ci_014                 1.257795e-02 3 1  ON 13
ci_015                 1.251906e-02 3 1  ON 14
ci_016                 1.714713e-02 3 1  ON 15
ci_017                 1.630655e-02 3 1  ON 16
ci_018                 9.869895e-03 3 1  ON 17
ci_019                 1.001244e-02 3 1  ON 18
ci_020                 1.718702e-02 3 1  ON 19
ci_021                 1.701380e-02 3 1  ON 20
ci_022                 9.191675e-03 3 1  ON 21
ci_023                 9.450486e-03 3 1  ON 22
ci_024                 9.646721e-03 3 1  ON 23
ci_025                 9.451230e-03 3 1  ON 24
ci_026                 1.108975e-02 3 1  ON 25
ci_027                 1.155194e-02 3 1  ON 26
ci_028                -1.497284e-02 3 1  ON 27
ci_029                -1.552275e-02 3 1  ON 28
ci_030                -9.436768e-03 3 1  ON 29
ci_031                -9.018600e-03 3 1  ON 30
ci_032                -1.486007e-02 3 1  ON 31
ci_033                 5.722812e-03 3 1  ON 32
ci_034                 5.605451e-03 3 1  ON 33
ci_035                -5.049713e-03 3 1  ON 34
ci_036                -1.252720e-02 3 1  ON 35
ci_037                -1.250782e-02 3 1  ON 36
ci_038                 1.769356e-03 3 1  ON 37
ci_039                 1.718111e-03 3 1  ON 38
ci_040                -3.025453e-03 3 1  ON 39
ci_041                 8.807845e-03 3 1  ON 40
ci_042                 8.903814e-03 3 1  ON 41
ci_043                -4.003882e-03 3 1  ON 42
ci_044                -4.083472e-03 3 1  ON 43
ci_045                -3.232074e-03 3 1  ON 44
ci_046                 5.724632e-03 3 1  ON 45
ci_047                 5.627240e-03 3 1  ON 46
ci_048                -1.250793e-02 3 1  ON 47
ci_049                -1.365247e-02 3 1  ON 48
ci_050                 3.425753e-03 3 1  ON 49
ci_051                 3.208870e-03 3 1  ON 50
ci_052                -2.267039e-03 3 1  ON 51
ci_053                -2.411391e-03 3 1  ON 52
ci_054                -2.903365e-03 3 1  ON 53
ci_055                -2.927334e-03 3 1  ON 54
ci_056                 5.323042e-03 3 1  ON 55
ci_057                 5.145608e-03 3 1  ON 56
ci_058                -1.685170e-03 3 1  ON 57
ci_059                -1.994829e-03 3 1  ON 58
ci_060                 4.951501e-03 3 1  ON 59
ci_061                 5.516482e-03 3 1  ON 60
ci_062                -3.591323e-03 3 1  ON 61
ci_063                -4.120743e-03 3 1  ON 62
ci_064                -3.014283e-03 3 1  ON 63
ci_065                -4.342012e-03 3 1  ON 64
ci_066                 4.508175e-03 3 1  ON 65
ci_067                 4.318634e-03 3 1  ON 66
ci_068                -4.321898e-03 3 1  ON 67
ci_069                -4.852411e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1772e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s084 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s084 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=84  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.1807
    reference variance = 0.185077
====================================================
  Execution time = 1.5411e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s084
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5318e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8385e-01
  Total weights = 1.957281863e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4830e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269087182963
                                         uncertainty =       0.001659219089

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269087182963
                                         uncertainty =       0.001659219089

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366779648
  error estimate for blocks of size 2^( 2) =       0.000380795973
  error estimate for blocks of size 2^( 3) =       0.000393368914
  error estimate for blocks of size 2^( 4) =       0.000402840591
  error estimate for blocks of size 2^( 5) =       0.000408354490
  error estimate for blocks of size 2^( 6) =       0.000411144106
  error estimate for blocks of size 2^( 7) =       0.000411970693

      target function =      -0.938449220999
              le_mean =     -17.211926989690
             les_mean =     296.534278864695
             stat err =       0.000408577470
             autocorr =       1.240904532079
   target nu stat err =       0.000408577470
   target dn stat err =       0.003340362475
      target stat err =       0.005581838082
              std dev =       0.518704752748
             le_variance =       0.269054620524


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721192698969e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3878e+02, overlap shift 1.3878e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938481515859       residual = 8.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938481736669       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938481781053       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938481793035       residual = 6.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938481794851       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938481795115       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938481795394       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938481795391       residual = 9.47e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938481795474       residual = 1.69e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938481795495       residual = 3.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+02 is 7.298306e-07

solving harmonic davidson linear method for identity shift 5.5511e+02, overlap shift 5.5511e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938481515859       residual = 8.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938481571085       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938481582185       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938481585181       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938481585635       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938481585701       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938481585771       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938481585770       residual = 9.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938481585791       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938481585796       residual = 3.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+02 is 1.825190e-07

solving harmonic davidson linear method for identity shift 2.2204e+03, overlap shift 2.2204e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938481515859       residual = 8.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938481529667       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938481532442       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938481533191       residual = 6.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938481533304       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938481533321       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938481533339       residual = 4.38e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938481533338       residual = 9.46e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938481533344       residual = 1.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938481533346       residual = 3.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.2204e+03 is 4.563358e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.310737 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.7903e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
ci_001                -4.146449e-02 3 1  ON 0
ci_002                -3.159268e-02 3 1  ON 1
ci_003                -2.620831e-02 3 1  ON 2
ci_004                 2.367226e-02 3 1  ON 3
ci_005                 2.385246e-02 3 1  ON 4
ci_006                -2.093994e-02 3 1  ON 5
ci_007                -2.044654e-02 3 1  ON 6
ci_008                -8.604098e-03 3 1  ON 7
ci_009                -1.431712e-02 3 1  ON 8
ci_010                -9.624619e-03 3 1  ON 9
ci_011                -1.062324e-02 3 1  ON 10
ci_012                -9.821759e-03 3 1  ON 11
ci_013                -1.994564e-02 3 1  ON 12
ci_014                 1.257790e-02 3 1  ON 13
ci_015                 1.251889e-02 3 1  ON 14
ci_016                 1.714708e-02 3 1  ON 15
ci_017                 1.630637e-02 3 1  ON 16
ci_018                 9.869956e-03 3 1  ON 17
ci_019                 1.001245e-02 3 1  ON 18
ci_020                 1.718688e-02 3 1  ON 19
ci_021                 1.701382e-02 3 1  ON 20
ci_022                 9.191755e-03 3 1  ON 21
ci_023                 9.450484e-03 3 1  ON 22
ci_024                 9.646652e-03 3 1  ON 23
ci_025                 9.451126e-03 3 1  ON 24
ci_026                 1.108982e-02 3 1  ON 25
ci_027                 1.155191e-02 3 1  ON 26
ci_028                -1.497296e-02 3 1  ON 27
ci_029                -1.552284e-02 3 1  ON 28
ci_030                -9.436631e-03 3 1  ON 29
ci_031                -9.018616e-03 3 1  ON 30
ci_032                -1.486013e-02 3 1  ON 31
ci_033                 5.722814e-03 3 1  ON 32
ci_034                 5.605562e-03 3 1  ON 33
ci_035                -5.049697e-03 3 1  ON 34
ci_036                -1.252725e-02 3 1  ON 35
ci_037                -1.250789e-02 3 1  ON 36
ci_038                 1.769313e-03 3 1  ON 37
ci_039                 1.718130e-03 3 1  ON 38
ci_040                -3.025368e-03 3 1  ON 39
ci_041                 8.807898e-03 3 1  ON 40
ci_042                 8.903779e-03 3 1  ON 41
ci_043                -4.003843e-03 3 1  ON 42
ci_044                -4.083358e-03 3 1  ON 43
ci_045                -3.231976e-03 3 1  ON 44
ci_046                 5.724695e-03 3 1  ON 45
ci_047                 5.627259e-03 3 1  ON 46
ci_048                -1.250811e-02 3 1  ON 47
ci_049                -1.365237e-02 3 1  ON 48
ci_050                 3.425826e-03 3 1  ON 49
ci_051                 3.208846e-03 3 1  ON 50
ci_052                -2.267032e-03 3 1  ON 51
ci_053                -2.411391e-03 3 1  ON 52
ci_054                -2.903264e-03 3 1  ON 53
ci_055                -2.927403e-03 3 1  ON 54
ci_056                 5.323065e-03 3 1  ON 55
ci_057                 5.145678e-03 3 1  ON 56
ci_058                -1.685120e-03 3 1  ON 57
ci_059                -1.994781e-03 3 1  ON 58
ci_060                 4.951402e-03 3 1  ON 59
ci_061                 5.516570e-03 3 1  ON 60
ci_062                -3.591380e-03 3 1  ON 61
ci_063                -4.120694e-03 3 1  ON 62
ci_064                -3.014354e-03 3 1  ON 63
ci_065                -4.341994e-03 3 1  ON 64
ci_066                 4.508162e-03 3 1  ON 65
ci_067                 4.318615e-03 3 1  ON 66
ci_068                -4.322073e-03 3 1  ON 67
ci_069                -4.852398e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 84
    time step          = 0.05
    reference energy   = -17.2684
    reference variance = 0.311887
====================================================
  Execution time = 1.3664e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s084
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8008e-01
  Total weights = 1.9576e+06
  Execution time = 1.8215e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267698180991
                                         uncertainty =       0.001584478691

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267698180991
                                         uncertainty =       0.001584478691

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365862158
  error estimate for blocks of size 2^( 2) =       0.000379671746
  error estimate for blocks of size 2^( 3) =       0.000391924787
  error estimate for blocks of size 2^( 4) =       0.000400531523
  error estimate for blocks of size 2^( 5) =       0.000405818402
  error estimate for blocks of size 2^( 6) =       0.000409381257
  error estimate for blocks of size 2^( 7) =       0.000410060194

      target function =      -0.944731094970
              le_mean =     -17.212072981774
             les_mean =     296.535541138033
             stat err =       0.000406447844
             autocorr =       1.234169088749
   target nu stat err =       0.000406447844
   target dn stat err =       0.003162159907
      target stat err =       0.005360497784
              std dev =       0.517407225997
             le_variance =       0.267710237514

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267697994812
                                         uncertainty =       0.001584462989

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267697994812
                                         uncertainty =       0.001584462989

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365862030
  error estimate for blocks of size 2^( 2) =       0.000379671639
  error estimate for blocks of size 2^( 3) =       0.000391924701
  error estimate for blocks of size 2^( 4) =       0.000400531465
  error estimate for blocks of size 2^( 5) =       0.000405818338
  error estimate for blocks of size 2^( 6) =       0.000409381206
  error estimate for blocks of size 2^( 7) =       0.000410060137

      target function =      -0.944732126044
              le_mean =     -17.212072989760
             les_mean =     296.535540801873
             stat err =       0.000406447786
             autocorr =       1.234169601054
   target nu stat err =       0.000406447786
   target dn stat err =       0.003161915723
      target stat err =       0.005360103001
              std dev =       0.517407045263
             le_variance =       0.267710050488

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267698087829
                                         uncertainty =       0.001584470836

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267698087829
                                         uncertainty =       0.001584470836

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365862094
  error estimate for blocks of size 2^( 2) =       0.000379671692
  error estimate for blocks of size 2^( 3) =       0.000391924744
  error estimate for blocks of size 2^( 4) =       0.000400531494
  error estimate for blocks of size 2^( 5) =       0.000405818370
  error estimate for blocks of size 2^( 6) =       0.000409381231
  error estimate for blocks of size 2^( 7) =       0.000410060166

      target function =      -0.944731612973
              le_mean =     -17.212072985764
             les_mean =     296.535540968381
             stat err =       0.000406447815
             autocorr =       1.234169345027
   target nu stat err =       0.000406447815
   target dn stat err =       0.003162037714
      target stat err =       0.005360300252
              std dev =       0.517407135560
             le_variance =       0.267710143928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267698169341
                                         uncertainty =       0.001584477709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267698169341
                                         uncertainty =       0.001584477709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365862150
  error estimate for blocks of size 2^( 2) =       0.000379671739
  error estimate for blocks of size 2^( 3) =       0.000391924782
  error estimate for blocks of size 2^( 4) =       0.000400531520
  error estimate for blocks of size 2^( 5) =       0.000405818398
  error estimate for blocks of size 2^( 6) =       0.000409381254
  error estimate for blocks of size 2^( 7) =       0.000410060191

      target function =      -0.944731159973
              le_mean =     -17.212072982272
             les_mean =     296.535541116660
             stat err =       0.000406447840
             autocorr =       1.234169120797
   target nu stat err =       0.000406447840
   target dn stat err =       0.003162144629
      target stat err =       0.005360473088
              std dev =       0.517407214688
             le_variance =       0.267710225811


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.944731094970        initial
     1.3878e+02     1.3878e+03             7.2983e-07        -0.944732126044  <--
     5.5511e+02     5.5511e+03             1.8252e-07        -0.944731612973
     2.2204e+03     2.2204e+04             4.5634e-08        -0.944731159973

*****************************************************************************
Applying the update for shift_i =   1.3878e+02     and shift_s =   1.3878e+03
*****************************************************************************

  Execution time = 2.2930e+01
  </log>
  <optVariables href="H2O.s084.opt.xml">
ci_001                -4.146492e-02 3 1  ON 0
ci_002                -3.159233e-02 3 1  ON 1
ci_003                -2.620828e-02 3 1  ON 2
ci_004                 2.367191e-02 3 1  ON 3
ci_005                 2.385232e-02 3 1  ON 4
ci_006                -2.093946e-02 3 1  ON 5
ci_007                -2.044644e-02 3 1  ON 6
ci_008                -8.604293e-03 3 1  ON 7
ci_009                -1.431717e-02 3 1  ON 8
ci_010                -9.624237e-03 3 1  ON 9
ci_011                -1.062290e-02 3 1  ON 10
ci_012                -9.822184e-03 3 1  ON 11
ci_013                -1.994561e-02 3 1  ON 12
ci_014                 1.257774e-02 3 1  ON 13
ci_015                 1.251840e-02 3 1  ON 14
ci_016                 1.714692e-02 3 1  ON 15
ci_017                 1.630582e-02 3 1  ON 16
ci_018                 9.870140e-03 3 1  ON 17
ci_019                 1.001248e-02 3 1  ON 18
ci_020                 1.718645e-02 3 1  ON 19
ci_021                 1.701388e-02 3 1  ON 20
ci_022                 9.191992e-03 3 1  ON 21
ci_023                 9.450477e-03 3 1  ON 22
ci_024                 9.646446e-03 3 1  ON 23
ci_025                 9.450813e-03 3 1  ON 24
ci_026                 1.109004e-02 3 1  ON 25
ci_027                 1.155184e-02 3 1  ON 26
ci_028                -1.497329e-02 3 1  ON 27
ci_029                -1.552310e-02 3 1  ON 28
ci_030                -9.436222e-03 3 1  ON 29
ci_031                -9.018667e-03 3 1  ON 30
ci_032                -1.486030e-02 3 1  ON 31
ci_033                 5.722823e-03 3 1  ON 32
ci_034                 5.605896e-03 3 1  ON 33
ci_035                -5.049648e-03 3 1  ON 34
ci_036                -1.252738e-02 3 1  ON 35
ci_037                -1.250808e-02 3 1  ON 36
ci_038                 1.769187e-03 3 1  ON 37
ci_039                 1.718187e-03 3 1  ON 38
ci_040                -3.025114e-03 3 1  ON 39
ci_041                 8.808055e-03 3 1  ON 40
ci_042                 8.903676e-03 3 1  ON 41
ci_043                -4.003727e-03 3 1  ON 42
ci_044                -4.083015e-03 3 1  ON 43
ci_045                -3.231683e-03 3 1  ON 44
ci_046                 5.724883e-03 3 1  ON 45
ci_047                 5.627317e-03 3 1  ON 46
ci_048                -1.250864e-02 3 1  ON 47
ci_049                -1.365205e-02 3 1  ON 48
ci_050                 3.426048e-03 3 1  ON 49
ci_051                 3.208773e-03 3 1  ON 50
ci_052                -2.267012e-03 3 1  ON 51
ci_053                -2.411389e-03 3 1  ON 52
ci_054                -2.902962e-03 3 1  ON 53
ci_055                -2.927611e-03 3 1  ON 54
ci_056                 5.323135e-03 3 1  ON 55
ci_057                 5.145889e-03 3 1  ON 56
ci_058                -1.684972e-03 3 1  ON 57
ci_059                -1.994639e-03 3 1  ON 58
ci_060                 4.951107e-03 3 1  ON 59
ci_061                 5.516835e-03 3 1  ON 60
ci_062                -3.591552e-03 3 1  ON 61
ci_063                -4.120548e-03 3 1  ON 62
ci_064                -3.014570e-03 3 1  ON 63
ci_065                -4.341939e-03 3 1  ON 64
ci_066                 4.508125e-03 3 1  ON 65
ci_067                 4.318560e-03 3 1  ON 66
ci_068                -4.322599e-03 3 1  ON 67
ci_069                -4.852357e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.0840e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s085 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s085 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=85  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.2067
    reference variance = 0.142606
====================================================
  Execution time = 1.4099e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s085
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5311e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7746e-01
  Total weights = 1.957171418e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4694e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265069311018
                                         uncertainty =       0.001328808740

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265069311018
                                         uncertainty =       0.001328808740

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364054744
  error estimate for blocks of size 2^( 2) =       0.000377990681
  error estimate for blocks of size 2^( 3) =       0.000390709818
  error estimate for blocks of size 2^( 4) =       0.000399879607
  error estimate for blocks of size 2^( 5) =       0.000406115574
  error estimate for blocks of size 2^( 6) =       0.000408942603
  error estimate for blocks of size 2^( 7) =       0.000411145731

      target function =      -0.949157694543
              le_mean =     -17.211431958313
             les_mean =     296.510854131991
             stat err =       0.000406520879
             autocorr =       1.246902001740
   target nu stat err =       0.000406520879
   target dn stat err =       0.002266147181
      target stat err =       0.003905510937
              std dev =       0.514851156112
             le_variance =       0.265071712950


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721143195831e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.4694e+01, overlap shift 3.4694e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949172651458       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949173266314       residual = 5.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949173361066       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949173377710       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949173385220       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949173388414       residual = 9.27e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949173389596       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949173389414       residual = 3.36e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949173389379       residual = 4.70e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+01 is 2.330997e-06

solving harmonic davidson linear method for identity shift 1.3878e+02, overlap shift 1.3878e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949172651458       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949172805437       residual = 5.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949172829153       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949172833317       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949172835196       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949172835994       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949172836290       residual = 1.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949172836244       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949172836236       residual = 4.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+02 is 5.837903e-07

solving harmonic davidson linear method for identity shift 5.5511e+02, overlap shift 5.5511e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949172651458       residual = 4.86e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949172689970       residual = 5.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949172695900       residual = 1.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949172696942       residual = 2.21e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949172697411       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949172697611       residual = 9.25e-07           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949172697685       residual = 1.74e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949172697673       residual = 3.35e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949172697671       residual = 4.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.5511e+02 is 1.460128e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.313791 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6577e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
ci_001                -4.146519e-02 3 1  ON 0
ci_002                -3.159223e-02 3 1  ON 1
ci_003                -2.620779e-02 3 1  ON 2
ci_004                 2.367203e-02 3 1  ON 3
ci_005                 2.385234e-02 3 1  ON 4
ci_006                -2.093907e-02 3 1  ON 5
ci_007                -2.044662e-02 3 1  ON 6
ci_008                -8.604233e-03 3 1  ON 7
ci_009                -1.431733e-02 3 1  ON 8
ci_010                -9.624660e-03 3 1  ON 9
ci_011                -1.062309e-02 3 1  ON 10
ci_012                -9.822585e-03 3 1  ON 11
ci_013                -1.994564e-02 3 1  ON 12
ci_014                 1.257812e-02 3 1  ON 13
ci_015                 1.251852e-02 3 1  ON 14
ci_016                 1.714636e-02 3 1  ON 15
ci_017                 1.630526e-02 3 1  ON 16
ci_018                 9.870210e-03 3 1  ON 17
ci_019                 1.001246e-02 3 1  ON 18
ci_020                 1.718675e-02 3 1  ON 19
ci_021                 1.701402e-02 3 1  ON 20
ci_022                 9.191830e-03 3 1  ON 21
ci_023                 9.450288e-03 3 1  ON 22
ci_024                 9.646206e-03 3 1  ON 23
ci_025                 9.450958e-03 3 1  ON 24
ci_026                 1.108971e-02 3 1  ON 25
ci_027                 1.155178e-02 3 1  ON 26
ci_028                -1.497300e-02 3 1  ON 27
ci_029                -1.552327e-02 3 1  ON 28
ci_030                -9.436047e-03 3 1  ON 29
ci_031                -9.018773e-03 3 1  ON 30
ci_032                -1.486060e-02 3 1  ON 31
ci_033                 5.723121e-03 3 1  ON 32
ci_034                 5.605965e-03 3 1  ON 33
ci_035                -5.049281e-03 3 1  ON 34
ci_036                -1.252715e-02 3 1  ON 35
ci_037                -1.250801e-02 3 1  ON 36
ci_038                 1.769054e-03 3 1  ON 37
ci_039                 1.718485e-03 3 1  ON 38
ci_040                -3.025143e-03 3 1  ON 39
ci_041                 8.808639e-03 3 1  ON 40
ci_042                 8.903285e-03 3 1  ON 41
ci_043                -4.003960e-03 3 1  ON 42
ci_044                -4.083195e-03 3 1  ON 43
ci_045                -3.231934e-03 3 1  ON 44
ci_046                 5.724812e-03 3 1  ON 45
ci_047                 5.627350e-03 3 1  ON 46
ci_048                -1.250904e-02 3 1  ON 47
ci_049                -1.365169e-02 3 1  ON 48
ci_050                 3.426005e-03 3 1  ON 49
ci_051                 3.208928e-03 3 1  ON 50
ci_052                -2.267240e-03 3 1  ON 51
ci_053                -2.411585e-03 3 1  ON 52
ci_054                -2.902932e-03 3 1  ON 53
ci_055                -2.927387e-03 3 1  ON 54
ci_056                 5.323350e-03 3 1  ON 55
ci_057                 5.145943e-03 3 1  ON 56
ci_058                -1.685029e-03 3 1  ON 57
ci_059                -1.994278e-03 3 1  ON 58
ci_060                 4.950655e-03 3 1  ON 59
ci_061                 5.517167e-03 3 1  ON 60
ci_062                -3.591860e-03 3 1  ON 61
ci_063                -4.120289e-03 3 1  ON 62
ci_064                -3.014549e-03 3 1  ON 63
ci_065                -4.342026e-03 3 1  ON 64
ci_066                 4.508185e-03 3 1  ON 65
ci_067                 4.318581e-03 3 1  ON 66
ci_068                -4.322938e-03 3 1  ON 67
ci_069                -4.851939e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 85
    time step          = 0.05
    reference energy   = -17.2018
    reference variance = 0.27309
====================================================
  Execution time = 1.3717e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s085
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8706e-01
  Total weights = 1.9572e+06
  Execution time = 1.8249e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267566685049
                                         uncertainty =       0.001820132041

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267566685049
                                         uncertainty =       0.001820132041

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365770399
  error estimate for blocks of size 2^( 2) =       0.000379351145
  error estimate for blocks of size 2^( 3) =       0.000391455750
  error estimate for blocks of size 2^( 4) =       0.000401138353
  error estimate for blocks of size 2^( 5) =       0.000407595369
  error estimate for blocks of size 2^( 6) =       0.000411313390
  error estimate for blocks of size 2^( 7) =       0.000412380455

      target function =      -0.933061167591
              le_mean =     -17.211667493840
             les_mean =     296.528557384708
             stat err =       0.000408106892
             autocorr =       1.244889334678
   target nu stat err =       0.000408106892
   target dn stat err =       0.006805292751
      target stat err =       0.011166090054
              std dev =       0.517277458488
             le_variance =       0.267575969060

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267566386814
                                         uncertainty =       0.001819984649

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267566386814
                                         uncertainty =       0.001819984649

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365770195
  error estimate for blocks of size 2^( 2) =       0.000379350857
  error estimate for blocks of size 2^( 3) =       0.000391455361
  error estimate for blocks of size 2^( 4) =       0.000401137861
  error estimate for blocks of size 2^( 5) =       0.000407594844
  error estimate for blocks of size 2^( 6) =       0.000411312852
  error estimate for blocks of size 2^( 7) =       0.000412380009

      target function =      -0.933084505811
              le_mean =     -17.211667495604
             les_mean =     296.528543380654
             stat err =       0.000408106392
             autocorr =       1.244887671176
   target nu stat err =       0.000408106392
   target dn stat err =       0.006797248298
      target stat err =       0.011153498173
              std dev =       0.517277170163
             le_variance =       0.267575670772

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267566535315
                                         uncertainty =       0.001820058195

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267566535315
                                         uncertainty =       0.001820058195

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365770296
  error estimate for blocks of size 2^( 2) =       0.000379351000
  error estimate for blocks of size 2^( 3) =       0.000391455555
  error estimate for blocks of size 2^( 4) =       0.000401138106
  error estimate for blocks of size 2^( 5) =       0.000407595106
  error estimate for blocks of size 2^( 6) =       0.000411313121
  error estimate for blocks of size 2^( 7) =       0.000412380231

      target function =      -0.933072976601
              le_mean =     -17.211667494670
             les_mean =     296.528550295616
             stat err =       0.000408106641
             autocorr =       1.244888501949
   target nu stat err =       0.000408106641
   target dn stat err =       0.006801260330
      target stat err =       0.011159780942
              std dev =       0.517277313730
             le_variance =       0.267575819300

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267566666284
                                         uncertainty =       0.001820122803

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267566666284
                                         uncertainty =       0.001820122803

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365770386
  error estimate for blocks of size 2^( 2) =       0.000379351127
  error estimate for blocks of size 2^( 3) =       0.000391455726
  error estimate for blocks of size 2^( 4) =       0.000401138322
  error estimate for blocks of size 2^( 5) =       0.000407595336
  error estimate for blocks of size 2^( 6) =       0.000411313357
  error estimate for blocks of size 2^( 7) =       0.000412380427

      target function =      -0.933062658977
              le_mean =     -17.211667493937
             les_mean =     296.528556489048
             stat err =       0.000408106860
             autocorr =       1.244889230578
   target nu stat err =       0.000408106860
   target dn stat err =       0.006804788062
      target stat err =       0.011165300757
              std dev =       0.517277440347
             le_variance =       0.267575950292


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.933061167591        initial
     3.4694e+01     3.4694e+02             2.3310e-06        -0.933084505811  <--
     1.3878e+02     1.3878e+03             5.8379e-07        -0.933072976601
     5.5511e+02     5.5511e+03             1.4601e-07        -0.933062658977

*****************************************************************************
Applying the update for shift_i =   3.4694e+01     and shift_s =   3.4694e+02
*****************************************************************************

  Execution time = 2.2899e+01
  </log>
  <optVariables href="H2O.s085.opt.xml">
ci_001                -4.146600e-02 3 1  ON 0
ci_002                -3.159194e-02 3 1  ON 1
ci_003                -2.620629e-02 3 1  ON 2
ci_004                 2.367238e-02 3 1  ON 3
ci_005                 2.385239e-02 3 1  ON 4
ci_006                -2.093790e-02 3 1  ON 5
ci_007                -2.044716e-02 3 1  ON 6
ci_008                -8.604055e-03 3 1  ON 7
ci_009                -1.431782e-02 3 1  ON 8
ci_010                -9.625927e-03 3 1  ON 9
ci_011                -1.062366e-02 3 1  ON 10
ci_012                -9.823787e-03 3 1  ON 11
ci_013                -1.994571e-02 3 1  ON 12
ci_014                 1.257927e-02 3 1  ON 13
ci_015                 1.251888e-02 3 1  ON 14
ci_016                 1.714470e-02 3 1  ON 15
ci_017                 1.630357e-02 3 1  ON 16
ci_018                 9.870420e-03 3 1  ON 17
ci_019                 1.001239e-02 3 1  ON 18
ci_020                 1.718762e-02 3 1  ON 19
ci_021                 1.701443e-02 3 1  ON 20
ci_022                 9.191342e-03 3 1  ON 21
ci_023                 9.449720e-03 3 1  ON 22
ci_024                 9.645488e-03 3 1  ON 23
ci_025                 9.451390e-03 3 1  ON 24
ci_026                 1.108873e-02 3 1  ON 25
ci_027                 1.155161e-02 3 1  ON 26
ci_028                -1.497212e-02 3 1  ON 27
ci_029                -1.552380e-02 3 1  ON 28
ci_030                -9.435521e-03 3 1  ON 29
ci_031                -9.019091e-03 3 1  ON 30
ci_032                -1.486151e-02 3 1  ON 31
ci_033                 5.724013e-03 3 1  ON 32
ci_034                 5.606174e-03 3 1  ON 33
ci_035                -5.048184e-03 3 1  ON 34
ci_036                -1.252647e-02 3 1  ON 35
ci_037                -1.250779e-02 3 1  ON 36
ci_038                 1.768654e-03 3 1  ON 37
ci_039                 1.719375e-03 3 1  ON 38
ci_040                -3.025230e-03 3 1  ON 39
ci_041                 8.810386e-03 3 1  ON 40
ci_042                 8.902114e-03 3 1  ON 41
ci_043                -4.004658e-03 3 1  ON 42
ci_044                -4.083735e-03 3 1  ON 43
ci_045                -3.232687e-03 3 1  ON 44
ci_046                 5.724598e-03 3 1  ON 45
ci_047                 5.627449e-03 3 1  ON 46
ci_048                -1.251023e-02 3 1  ON 47
ci_049                -1.365061e-02 3 1  ON 48
ci_050                 3.425876e-03 3 1  ON 49
ci_051                 3.209394e-03 3 1  ON 50
ci_052                -2.267925e-03 3 1  ON 51
ci_053                -2.412170e-03 3 1  ON 52
ci_054                -2.902844e-03 3 1  ON 53
ci_055                -2.926718e-03 3 1  ON 54
ci_056                 5.323995e-03 3 1  ON 55
ci_057                 5.146103e-03 3 1  ON 56
ci_058                -1.685200e-03 3 1  ON 57
ci_059                -1.993199e-03 3 1  ON 58
ci_060                 4.949304e-03 3 1  ON 59
ci_061                 5.518162e-03 3 1  ON 60
ci_062                -3.592784e-03 3 1  ON 61
ci_063                -4.119512e-03 3 1  ON 62
ci_064                -3.014487e-03 3 1  ON 63
ci_065                -4.342288e-03 3 1  ON 64
ci_066                 4.508366e-03 3 1  ON 65
ci_067                 4.318643e-03 3 1  ON 66
ci_068                -4.323955e-03 3 1  ON 67
ci_069                -4.850688e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9482e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s086 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s086 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=86  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.2256
    reference variance = 0.173018
====================================================
  Execution time = 1.4232e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s086
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5296e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8122e-01
  Total weights = 1.957281411e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4760e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269862248913
                                         uncertainty =       0.001833969654

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269862248913
                                         uncertainty =       0.001833969654

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367348972
  error estimate for blocks of size 2^( 2) =       0.000381163700
  error estimate for blocks of size 2^( 3) =       0.000393471744
  error estimate for blocks of size 2^( 4) =       0.000402460312
  error estimate for blocks of size 2^( 5) =       0.000408305653
  error estimate for blocks of size 2^( 6) =       0.000411452192
  error estimate for blocks of size 2^( 7) =       0.000413242569

      target function =      -0.942840690219
              le_mean =     -17.212793458177
             les_mean =     296.561480184170
             stat err =       0.000408865181
             autocorr =       1.238803999254
   target nu stat err =       0.000408865181
   target dn stat err =       0.002352091836
      target stat err =       0.004006771541
              std dev =       0.519509898087
             le_variance =       0.269890534211


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721279345818e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.6736e+00, overlap shift 8.6736e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942856524400       residual = 8.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942860642133       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942861166977       residual = 3.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942861298619       residual = 3.96e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942861324271       residual = 1.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942861329086       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942861321727       residual = 3.45e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942861323775       residual = 7.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942861323037       residual = 1.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942861322431       residual = 3.07e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+00 is 1.350816e-05

solving harmonic davidson linear method for identity shift 3.4694e+01, overlap shift 3.4694e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942856524400       residual = 8.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942857560776       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942857692651       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942857725623       residual = 3.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942857732079       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942857733274       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942857731428       residual = 3.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942857731943       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942857731757       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942857731607       residual = 3.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+01 is 3.398098e-06

solving harmonic davidson linear method for identity shift 1.3878e+02, overlap shift 1.3878e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942856524400       residual = 8.88e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942856783932       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942856816942       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942856825189       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942856826805       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942856827104       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942856826641       residual = 3.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942856826770       residual = 6.99e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942856826724       residual = 1.80e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942856826687       residual = 3.03e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3878e+02 is 8.508507e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.317193 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6717e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
ci_001                -4.146572e-02 3 1  ON 0
ci_002                -3.159259e-02 3 1  ON 1
ci_003                -2.620555e-02 3 1  ON 2
ci_004                 2.367527e-02 3 1  ON 3
ci_005                 2.385256e-02 3 1  ON 4
ci_006                -2.093679e-02 3 1  ON 5
ci_007                -2.044671e-02 3 1  ON 6
ci_008                -8.601985e-03 3 1  ON 7
ci_009                -1.431930e-02 3 1  ON 8
ci_010                -9.624090e-03 3 1  ON 9
ci_011                -1.062310e-02 3 1  ON 10
ci_012                -9.822841e-03 3 1  ON 11
ci_013                -1.994469e-02 3 1  ON 12
ci_014                 1.258043e-02 3 1  ON 13
ci_015                 1.252029e-02 3 1  ON 14
ci_016                 1.714475e-02 3 1  ON 15
ci_017                 1.630554e-02 3 1  ON 16
ci_018                 9.870980e-03 3 1  ON 17
ci_019                 1.001189e-02 3 1  ON 18
ci_020                 1.718567e-02 3 1  ON 19
ci_021                 1.701431e-02 3 1  ON 20
ci_022                 9.193177e-03 3 1  ON 21
ci_023                 9.448153e-03 3 1  ON 22
ci_024                 9.644561e-03 3 1  ON 23
ci_025                 9.448814e-03 3 1  ON 24
ci_026                 1.108884e-02 3 1  ON 25
ci_027                 1.155130e-02 3 1  ON 26
ci_028                -1.497143e-02 3 1  ON 27
ci_029                -1.552442e-02 3 1  ON 28
ci_030                -9.434198e-03 3 1  ON 29
ci_031                -9.019025e-03 3 1  ON 30
ci_032                -1.486191e-02 3 1  ON 31
ci_033                 5.722846e-03 3 1  ON 32
ci_034                 5.607752e-03 3 1  ON 33
ci_035                -5.047147e-03 3 1  ON 34
ci_036                -1.252548e-02 3 1  ON 35
ci_037                -1.250726e-02 3 1  ON 36
ci_038                 1.768289e-03 3 1  ON 37
ci_039                 1.720115e-03 3 1  ON 38
ci_040                -3.025354e-03 3 1  ON 39
ci_041                 8.808847e-03 3 1  ON 40
ci_042                 8.899537e-03 3 1  ON 41
ci_043                -4.005282e-03 3 1  ON 42
ci_044                -4.082026e-03 3 1  ON 43
ci_045                -3.232993e-03 3 1  ON 44
ci_046                 5.725807e-03 3 1  ON 45
ci_047                 5.626427e-03 3 1  ON 46
ci_048                -1.250842e-02 3 1  ON 47
ci_049                -1.364964e-02 3 1  ON 48
ci_050                 3.424693e-03 3 1  ON 49
ci_051                 3.210323e-03 3 1  ON 50
ci_052                -2.267878e-03 3 1  ON 51
ci_053                -2.412067e-03 3 1  ON 52
ci_054                -2.902507e-03 3 1  ON 53
ci_055                -2.925818e-03 3 1  ON 54
ci_056                 5.322771e-03 3 1  ON 55
ci_057                 5.147554e-03 3 1  ON 56
ci_058                -1.686800e-03 3 1  ON 57
ci_059                -1.992775e-03 3 1  ON 58
ci_060                 4.945906e-03 3 1  ON 59
ci_061                 5.519500e-03 3 1  ON 60
ci_062                -3.592479e-03 3 1  ON 61
ci_063                -4.120085e-03 3 1  ON 62
ci_064                -3.015240e-03 3 1  ON 63
ci_065                -4.342007e-03 3 1  ON 64
ci_066                 4.508142e-03 3 1  ON 65
ci_067                 4.318265e-03 3 1  ON 66
ci_068                -4.323646e-03 3 1  ON 67
ci_069                -4.848659e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 86
    time step          = 0.05
    reference energy   = -17.1925
    reference variance = 0.186464
====================================================
  Execution time = 1.3681e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s086
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8109e-01
  Total weights = 1.9575e+06
  Execution time = 1.8271e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268625520341
                                         uncertainty =       0.001808672455

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268625520341
                                         uncertainty =       0.001808672455

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366457403
  error estimate for blocks of size 2^( 2) =       0.000380665954
  error estimate for blocks of size 2^( 3) =       0.000393486979
  error estimate for blocks of size 2^( 4) =       0.000402723754
  error estimate for blocks of size 2^( 5) =       0.000408162389
  error estimate for blocks of size 2^( 6) =       0.000410979854
  error estimate for blocks of size 2^( 7) =       0.000413587054

      target function =      -0.943054115339
              le_mean =     -17.211591163008
             les_mean =     296.519960116008
             stat err =       0.000408863263
             autocorr =       1.244827519846
   target nu stat err =       0.000408863263
   target dn stat err =       0.002569114569
      target stat err =       0.004356903739
              std dev =       0.518249029344
             le_variance =       0.268582056416

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268623994070
                                         uncertainty =       0.001808339669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268623994070
                                         uncertainty =       0.001808339669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366456362
  error estimate for blocks of size 2^( 2) =       0.000380665575
  error estimate for blocks of size 2^( 3) =       0.000393487363
  error estimate for blocks of size 2^( 4) =       0.000402724634
  error estimate for blocks of size 2^( 5) =       0.000408163541
  error estimate for blocks of size 2^( 6) =       0.000410981034
  error estimate for blocks of size 2^( 7) =       0.000413588332

      target function =      -0.943065939822
              le_mean =     -17.211591077625
             les_mean =     296.519950120127
             stat err =       0.000408864386
             autocorr =       1.244841430692
   target nu stat err =       0.000408864386
   target dn stat err =       0.002567470335
      target stat err =       0.004354299753
              std dev =       0.518247556961
             le_variance =       0.268580530296

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268624744928
                                         uncertainty =       0.001808505035

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268624744928
                                         uncertainty =       0.001808505035

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366456874
  error estimate for blocks of size 2^( 2) =       0.000380665758
  error estimate for blocks of size 2^( 3) =       0.000393487167
  error estimate for blocks of size 2^( 4) =       0.000402724192
  error estimate for blocks of size 2^( 5) =       0.000408162964
  error estimate for blocks of size 2^( 6) =       0.000410980443
  error estimate for blocks of size 2^( 7) =       0.000413587693

      target function =      -0.943061256425
              le_mean =     -17.211591119095
             les_mean =     296.519954341322
             stat err =       0.000408863823
             autocorr =       1.244834526997
   target nu stat err =       0.000408863823
   target dn stat err =       0.002568272397
      target stat err =       0.004355579870
              std dev =       0.518248281307
             le_variance =       0.268581281077

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268625422427
                                         uncertainty =       0.001808651488

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268625422427
                                         uncertainty =       0.001808651488

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366457336
  error estimate for blocks of size 2^( 2) =       0.000380665929
  error estimate for blocks of size 2^( 3) =       0.000393487002
  error estimate for blocks of size 2^( 4) =       0.000402723808
  error estimate for blocks of size 2^( 5) =       0.000408162460
  error estimate for blocks of size 2^( 6) =       0.000410979928
  error estimate for blocks of size 2^( 7) =       0.000413587133

      target function =      -0.943055119675
              le_mean =     -17.211591157411
             les_mean =     296.519959323687
             stat err =       0.000408863332
             autocorr =       1.244828397894
   target nu stat err =       0.000408863332
   target dn stat err =       0.002569007535
      target stat err =       0.004356736368
              std dev =       0.518248934887
             le_variance =       0.268581958512


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943054115339        initial
     8.6736e+00     8.6736e+01             1.3508e-05        -0.943065939822  <--
     3.4694e+01     3.4694e+02             3.3981e-06        -0.943061256425
     1.3878e+02     1.3878e+03             8.5085e-07        -0.943055119675

*****************************************************************************
Applying the update for shift_i =   8.6736e+00     and shift_s =   8.6736e+01
*****************************************************************************

  Execution time = 2.2888e+01
  </log>
  <optVariables href="H2O.s086.opt.xml">
ci_001                -4.146490e-02 3 1  ON 0
ci_002                -3.159450e-02 3 1  ON 1
ci_003                -2.620336e-02 3 1  ON 2
ci_004                 2.368387e-02 3 1  ON 3
ci_005                 2.385306e-02 3 1  ON 4
ci_006                -2.093347e-02 3 1  ON 5
ci_007                -2.044537e-02 3 1  ON 6
ci_008                -8.595833e-03 3 1  ON 7
ci_009                -1.432370e-02 3 1  ON 8
ci_010                -9.618625e-03 3 1  ON 9
ci_011                -1.062141e-02 3 1  ON 10
ci_012                -9.820026e-03 3 1  ON 11
ci_013                -1.994166e-02 3 1  ON 12
ci_014                 1.258386e-02 3 1  ON 13
ci_015                 1.252447e-02 3 1  ON 14
ci_016                 1.714488e-02 3 1  ON 15
ci_017                 1.631141e-02 3 1  ON 16
ci_018                 9.872644e-03 3 1  ON 17
ci_019                 1.001040e-02 3 1  ON 18
ci_020                 1.717984e-02 3 1  ON 19
ci_021                 1.701398e-02 3 1  ON 20
ci_022                 9.198638e-03 3 1  ON 21
ci_023                 9.443490e-03 3 1  ON 22
ci_024                 9.641804e-03 3 1  ON 23
ci_025                 9.441142e-03 3 1  ON 24
ci_026                 1.108921e-02 3 1  ON 25
ci_027                 1.155037e-02 3 1  ON 26
ci_028                -1.496936e-02 3 1  ON 27
ci_029                -1.552624e-02 3 1  ON 28
ci_030                -9.430257e-03 3 1  ON 29
ci_031                -9.018823e-03 3 1  ON 30
ci_032                -1.486310e-02 3 1  ON 31
ci_033                 5.719372e-03 3 1  ON 32
ci_034                 5.612451e-03 3 1  ON 33
ci_035                -5.044065e-03 3 1  ON 34
ci_036                -1.252254e-02 3 1  ON 35
ci_037                -1.250569e-02 3 1  ON 36
ci_038                 1.767203e-03 3 1  ON 37
ci_039                 1.722317e-03 3 1  ON 38
ci_040                -3.025723e-03 3 1  ON 39
ci_041                 8.804268e-03 3 1  ON 40
ci_042                 8.891878e-03 3 1  ON 41
ci_043                -4.007138e-03 3 1  ON 42
ci_044                -4.076940e-03 3 1  ON 43
ci_045                -3.233903e-03 3 1  ON 44
ci_046                 5.729405e-03 3 1  ON 45
ci_047                 5.623386e-03 3 1  ON 46
ci_048                -1.250302e-02 3 1  ON 47
ci_049                -1.364677e-02 3 1  ON 48
ci_050                 3.421177e-03 3 1  ON 49
ci_051                 3.213083e-03 3 1  ON 50
ci_052                -2.267739e-03 3 1  ON 51
ci_053                -2.411757e-03 3 1  ON 52
ci_054                -2.901508e-03 3 1  ON 53
ci_055                -2.923140e-03 3 1  ON 54
ci_056                 5.319130e-03 3 1  ON 55
ci_057                 5.151869e-03 3 1  ON 56
ci_058                -1.691554e-03 3 1  ON 57
ci_059                -1.991513e-03 3 1  ON 58
ci_060                 4.935796e-03 3 1  ON 59
ci_061                 5.523483e-03 3 1  ON 60
ci_062                -3.591572e-03 3 1  ON 61
ci_063                -4.121787e-03 3 1  ON 62
ci_064                -3.017478e-03 3 1  ON 63
ci_065                -4.341169e-03 3 1  ON 64
ci_066                 4.507478e-03 3 1  ON 65
ci_067                 4.317140e-03 3 1  ON 66
ci_068                -4.322725e-03 3 1  ON 67
ci_069                -4.842622e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9611e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s087 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s087 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=87  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.2065
    reference variance = 0.414551
====================================================
  Execution time = 1.6275e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s087
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7943e-01
  Total weights = 1.957201243e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4718e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268157864319
                                         uncertainty =       0.001672676819

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268157864319
                                         uncertainty =       0.001672676819

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366187698
  error estimate for blocks of size 2^( 2) =       0.000380101026
  error estimate for blocks of size 2^( 3) =       0.000392547022
  error estimate for blocks of size 2^( 4) =       0.000401057867
  error estimate for blocks of size 2^( 5) =       0.000407373442
  error estimate for blocks of size 2^( 6) =       0.000411035278
  error estimate for blocks of size 2^( 7) =       0.000413547014

      target function =      -0.945832358708
              le_mean =     -17.211197411292
             les_mean =     296.504750663355
             stat err =       0.000408253400
             autocorr =       1.242945600002
   target nu stat err =       0.000408253400
   target dn stat err =       0.002102896827
      target stat err =       0.003608333521
              std dev =       0.517867608665
             le_variance =       0.268186860104


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721119741129e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+00, overlap shift 2.1684e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945845028585       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945852348404       residual = 7.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945853986401       residual = 1.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945854395012       residual = 3.66e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945854407683       residual = 8.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945854412626       residual = 1.44e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945854432578       residual = 2.30e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945854445491       residual = 4.24e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945854448278       residual = 8.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+00 is 4.101064e-05

solving harmonic davidson linear method for identity shift 8.6736e+00, overlap shift 8.6736e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945845028585       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945846909665       residual = 6.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945847327606       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945847430994       residual = 3.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945847434045       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945847435215       residual = 1.39e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945847440241       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945847443488       residual = 4.00e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945847444178       residual = 7.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+00 is 1.046587e-05

solving harmonic davidson linear method for identity shift 3.4694e+01, overlap shift 3.4694e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945845028585       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945845502163       residual = 6.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945845607188       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945845633113       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945845633868       residual = 8.55e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945845634156       residual = 1.38e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945845635415       residual = 2.17e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945845636227       residual = 3.94e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945845636399       residual = 7.57e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+01 is 2.630145e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.320217 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.8755e+01
  </log>
  <optVariables href="H2O.s087.opt.xml">
ci_001                -4.146629e-02 3 1  ON 0
ci_002                -3.159562e-02 3 1  ON 1
ci_003                -2.620056e-02 3 1  ON 2
ci_004                 2.367694e-02 3 1  ON 3
ci_005                 2.385364e-02 3 1  ON 4
ci_006                -2.093217e-02 3 1  ON 5
ci_007                -2.043994e-02 3 1  ON 6
ci_008                -8.589173e-03 3 1  ON 7
ci_009                -1.432978e-02 3 1  ON 8
ci_010                -9.619847e-03 3 1  ON 9
ci_011                -1.062183e-02 3 1  ON 10
ci_012                -9.827357e-03 3 1  ON 11
ci_013                -1.994108e-02 3 1  ON 12
ci_014                 1.258737e-02 3 1  ON 13
ci_015                 1.252041e-02 3 1  ON 14
ci_016                 1.714677e-02 3 1  ON 15
ci_017                 1.631179e-02 3 1  ON 16
ci_018                 9.873946e-03 3 1  ON 17
ci_019                 1.001370e-02 3 1  ON 18
ci_020                 1.717643e-02 3 1  ON 19
ci_021                 1.700955e-02 3 1  ON 20
ci_022                 9.197830e-03 3 1  ON 21
ci_023                 9.441763e-03 3 1  ON 22
ci_024                 9.639622e-03 3 1  ON 23
ci_025                 9.440387e-03 3 1  ON 24
ci_026                 1.108367e-02 3 1  ON 25
ci_027                 1.154808e-02 3 1  ON 26
ci_028                -1.497178e-02 3 1  ON 27
ci_029                -1.552645e-02 3 1  ON 28
ci_030                -9.429351e-03 3 1  ON 29
ci_031                -9.017140e-03 3 1  ON 30
ci_032                -1.486816e-02 3 1  ON 31
ci_033                 5.722119e-03 3 1  ON 32
ci_034                 5.610571e-03 3 1  ON 33
ci_035                -5.046364e-03 3 1  ON 34
ci_036                -1.252202e-02 3 1  ON 35
ci_037                -1.250325e-02 3 1  ON 36
ci_038                 1.768131e-03 3 1  ON 37
ci_039                 1.721999e-03 3 1  ON 38
ci_040                -3.027949e-03 3 1  ON 39
ci_041                 8.805892e-03 3 1  ON 40
ci_042                 8.896738e-03 3 1  ON 41
ci_043                -4.003346e-03 3 1  ON 42
ci_044                -4.076765e-03 3 1  ON 43
ci_045                -3.230185e-03 3 1  ON 44
ci_046                 5.732584e-03 3 1  ON 45
ci_047                 5.624795e-03 3 1  ON 46
ci_048                -1.251349e-02 3 1  ON 47
ci_049                -1.363730e-02 3 1  ON 48
ci_050                 3.415476e-03 3 1  ON 49
ci_051                 3.217633e-03 3 1  ON 50
ci_052                -2.269751e-03 3 1  ON 51
ci_053                -2.414850e-03 3 1  ON 52
ci_054                -2.898079e-03 3 1  ON 53
ci_055                -2.916985e-03 3 1  ON 54
ci_056                 5.320886e-03 3 1  ON 55
ci_057                 5.145392e-03 3 1  ON 56
ci_058                -1.690499e-03 3 1  ON 57
ci_059                -1.989092e-03 3 1  ON 58
ci_060                 4.937251e-03 3 1  ON 59
ci_061                 5.528457e-03 3 1  ON 60
ci_062                -3.593833e-03 3 1  ON 61
ci_063                -4.122004e-03 3 1  ON 62
ci_064                -3.020553e-03 3 1  ON 63
ci_065                -4.340838e-03 3 1  ON 64
ci_066                 4.511633e-03 3 1  ON 65
ci_067                 4.320195e-03 3 1  ON 66
ci_068                -4.325225e-03 3 1  ON 67
ci_069                -4.845784e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 87
    time step          = 0.05
    reference energy   = -17.2052
    reference variance = 0.266265
====================================================
  Execution time = 1.3725e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s087
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7893e-01
  Total weights = 1.9574e+06
  Execution time = 1.8294e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267005856376
                                         uncertainty =       0.002539648671

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267005856376
                                         uncertainty =       0.002539648671

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365382369
  error estimate for blocks of size 2^( 2) =       0.000379207772
  error estimate for blocks of size 2^( 3) =       0.000392023043
  error estimate for blocks of size 2^( 4) =       0.000401034588
  error estimate for blocks of size 2^( 5) =       0.000406848505
  error estimate for blocks of size 2^( 6) =       0.000409449706
  error estimate for blocks of size 2^( 7) =       0.000409488639

      target function =      -0.946682937141
              le_mean =     -17.212066964751
             les_mean =     296.534172968613
             stat err =       0.000406705360
             autocorr =       1.238980916430
   target nu stat err =       0.000406705360
   target dn stat err =       0.003264700120
      target stat err =       0.005553908008
              std dev =       0.516728701361
             le_variance =       0.267008550810

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267000484924
                                         uncertainty =       0.002537420724

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267000484924
                                         uncertainty =       0.002537420724

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365378676
  error estimate for blocks of size 2^( 2) =       0.000379203855
  error estimate for blocks of size 2^( 3) =       0.000392019308
  error estimate for blocks of size 2^( 4) =       0.000401030945
  error estimate for blocks of size 2^( 5) =       0.000406845410
  error estimate for blocks of size 2^( 6) =       0.000409447157
  error estimate for blocks of size 2^( 7) =       0.000409487274

      target function =      -0.946590707982
              le_mean =     -17.212067542212
             les_mean =     296.534247520264
             stat err =       0.000406702697
             autocorr =       1.238989732136
   target nu stat err =       0.000406702697
   target dn stat err =       0.003266419627
      target stat err =       0.005555715579
              std dev =       0.516723479616
             le_variance =       0.267003154386

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267003035783
                                         uncertainty =       0.002538504541

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267003035783
                                         uncertainty =       0.002538504541

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365380430
  error estimate for blocks of size 2^( 2) =       0.000379205718
  error estimate for blocks of size 2^( 3) =       0.000392021081
  error estimate for blocks of size 2^( 4) =       0.000401032675
  error estimate for blocks of size 2^( 5) =       0.000406846872
  error estimate for blocks of size 2^( 6) =       0.000409448355
  error estimate for blocks of size 2^( 7) =       0.000409487897

      target function =      -0.946642671545
              le_mean =     -17.212067251637
             les_mean =     296.534206715569
             stat err =       0.000406703950
             autocorr =       1.238985474123
   target nu stat err =       0.000406703950
   target dn stat err =       0.003265188080
      target stat err =       0.005554258222
              std dev =       0.516725959609
             le_variance =       0.267005717334

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267005493862
                                         uncertainty =       0.002539504554

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267005493862
                                         uncertainty =       0.002539504554

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365382120
  error estimate for blocks of size 2^( 2) =       0.000379207508
  error estimate for blocks of size 2^( 3) =       0.000392022791
  error estimate for blocks of size 2^( 4) =       0.000401034343
  error estimate for blocks of size 2^( 5) =       0.000406848295
  error estimate for blocks of size 2^( 6) =       0.000409449531
  error estimate for blocks of size 2^( 7) =       0.000409488541

      target function =      -0.946678564215
              le_mean =     -17.212066999794
             les_mean =     296.534176767611
             stat err =       0.000406705177
             autocorr =       1.238981495589
   target nu stat err =       0.000406705177
   target dn stat err =       0.003264726597
      target stat err =       0.005553901736
              std dev =       0.516728349014
             le_variance =       0.267008186675


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946682937141        initial  <--
     2.1684e+00     2.1684e+01             4.1011e-05        -0.946590707982
     8.6736e+00     8.6736e+01             1.0466e-05        -0.946642671545
     3.4694e+01     3.4694e+02             2.6301e-06        -0.946678564215

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.9666
  </log>
  <optVariables href="H2O.s087.opt.xml">
ci_001                -4.146490e-02 3 1  ON 0
ci_002                -3.159450e-02 3 1  ON 1
ci_003                -2.620336e-02 3 1  ON 2
ci_004                 2.368387e-02 3 1  ON 3
ci_005                 2.385306e-02 3 1  ON 4
ci_006                -2.093347e-02 3 1  ON 5
ci_007                -2.044537e-02 3 1  ON 6
ci_008                -8.595833e-03 3 1  ON 7
ci_009                -1.432370e-02 3 1  ON 8
ci_010                -9.618625e-03 3 1  ON 9
ci_011                -1.062141e-02 3 1  ON 10
ci_012                -9.820026e-03 3 1  ON 11
ci_013                -1.994166e-02 3 1  ON 12
ci_014                 1.258386e-02 3 1  ON 13
ci_015                 1.252447e-02 3 1  ON 14
ci_016                 1.714488e-02 3 1  ON 15
ci_017                 1.631141e-02 3 1  ON 16
ci_018                 9.872644e-03 3 1  ON 17
ci_019                 1.001040e-02 3 1  ON 18
ci_020                 1.717984e-02 3 1  ON 19
ci_021                 1.701398e-02 3 1  ON 20
ci_022                 9.198638e-03 3 1  ON 21
ci_023                 9.443490e-03 3 1  ON 22
ci_024                 9.641804e-03 3 1  ON 23
ci_025                 9.441142e-03 3 1  ON 24
ci_026                 1.108921e-02 3 1  ON 25
ci_027                 1.155037e-02 3 1  ON 26
ci_028                -1.496936e-02 3 1  ON 27
ci_029                -1.552624e-02 3 1  ON 28
ci_030                -9.430257e-03 3 1  ON 29
ci_031                -9.018823e-03 3 1  ON 30
ci_032                -1.486310e-02 3 1  ON 31
ci_033                 5.719372e-03 3 1  ON 32
ci_034                 5.612451e-03 3 1  ON 33
ci_035                -5.044065e-03 3 1  ON 34
ci_036                -1.252254e-02 3 1  ON 35
ci_037                -1.250569e-02 3 1  ON 36
ci_038                 1.767203e-03 3 1  ON 37
ci_039                 1.722317e-03 3 1  ON 38
ci_040                -3.025723e-03 3 1  ON 39
ci_041                 8.804268e-03 3 1  ON 40
ci_042                 8.891878e-03 3 1  ON 41
ci_043                -4.007138e-03 3 1  ON 42
ci_044                -4.076940e-03 3 1  ON 43
ci_045                -3.233903e-03 3 1  ON 44
ci_046                 5.729405e-03 3 1  ON 45
ci_047                 5.623386e-03 3 1  ON 46
ci_048                -1.250302e-02 3 1  ON 47
ci_049                -1.364677e-02 3 1  ON 48
ci_050                 3.421177e-03 3 1  ON 49
ci_051                 3.213083e-03 3 1  ON 50
ci_052                -2.267739e-03 3 1  ON 51
ci_053                -2.411757e-03 3 1  ON 52
ci_054                -2.901508e-03 3 1  ON 53
ci_055                -2.923140e-03 3 1  ON 54
ci_056                 5.319130e-03 3 1  ON 55
ci_057                 5.151869e-03 3 1  ON 56
ci_058                -1.691554e-03 3 1  ON 57
ci_059                -1.991513e-03 3 1  ON 58
ci_060                 4.935796e-03 3 1  ON 59
ci_061                 5.523483e-03 3 1  ON 60
ci_062                -3.591572e-03 3 1  ON 61
ci_063                -4.121787e-03 3 1  ON 62
ci_064                -3.017478e-03 3 1  ON 63
ci_065                -4.341169e-03 3 1  ON 64
ci_066                 4.507478e-03 3 1  ON 65
ci_067                 4.317140e-03 3 1  ON 66
ci_068                -4.322725e-03 3 1  ON 67
ci_069                -4.842622e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1728e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s088 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s088 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=88  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7209e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.2722
    reference variance = 0.220657
====================================================
  Execution time = 1.4099e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s088
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5284e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8570e-01
  Total weights = 1.957324624e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4674e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267681311309
                                         uncertainty =       0.002126629290

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267681311309
                                         uncertainty =       0.002126629290

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365861909
  error estimate for blocks of size 2^( 2) =       0.000379903868
  error estimate for blocks of size 2^( 3) =       0.000392600605
  error estimate for blocks of size 2^( 4) =       0.000401483280
  error estimate for blocks of size 2^( 5) =       0.000406407608
  error estimate for blocks of size 2^( 6) =       0.000410100123
  error estimate for blocks of size 2^( 7) =       0.000412399447

      target function =      -0.935316073668
              le_mean =     -17.212389963331
             les_mean =     296.552067978201
             stat err =       0.000407597615
             autocorr =       1.241163159198
   target nu stat err =       0.000407597615
   target dn stat err =       0.005940026580
      target stat err =       0.009812643327
              std dev =       0.517406873066
             le_variance =       0.267709872296


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721238996333e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+01, overlap shift 2.1684e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935418399430       residual = 9.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935428114274       residual = 4.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935429016425       residual = 5.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935429182667       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.935429223951       residual = 2.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.935429232441       residual = 6.21e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.935429230979       residual = 1.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.935429231009       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.935429230814       residual = 4.75e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.935429231134       residual = 1.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.935429231346       residual = 2.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+01 is 1.422784e-05

solving harmonic davidson linear method for identity shift 8.6736e+01, overlap shift 8.6736e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935418399430       residual = 9.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935420835263       residual = 4.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935421061311       residual = 5.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935421102927       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.935421113259       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.935421115383       residual = 6.19e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.935421115016       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.935421115023       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.935421114975       residual = 4.73e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.935421115055       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.935421115108       residual = 2.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+01 is 3.567577e-06

solving harmonic davidson linear method for identity shift 3.4694e+02, overlap shift 3.4694e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935418399430       residual = 9.20e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935419008835       residual = 4.51e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935419065379       residual = 5.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935419075786       residual = 1.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.935419078370       residual = 2.54e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.935419078901       residual = 6.18e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.935419078809       residual = 1.17e-06           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.935419078811       residual = 2.07e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.935419078799       residual = 4.72e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.935419078819       residual = 1.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.935419078832       residual = 2.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         10 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+02 is 8.925601e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.324267 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6575e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
ci_001                -4.146514e-02 3 1  ON 0
ci_002                -3.159485e-02 3 1  ON 1
ci_003                -2.620301e-02 3 1  ON 2
ci_004                 2.368426e-02 3 1  ON 3
ci_005                 2.385241e-02 3 1  ON 4
ci_006                -2.093250e-02 3 1  ON 5
ci_007                -2.044419e-02 3 1  ON 6
ci_008                -8.595096e-03 3 1  ON 7
ci_009                -1.432431e-02 3 1  ON 8
ci_010                -9.618545e-03 3 1  ON 9
ci_011                -1.062072e-02 3 1  ON 10
ci_012                -9.819523e-03 3 1  ON 11
ci_013                -1.994134e-02 3 1  ON 12
ci_014                 1.258341e-02 3 1  ON 13
ci_015                 1.252427e-02 3 1  ON 14
ci_016                 1.714505e-02 3 1  ON 15
ci_017                 1.631135e-02 3 1  ON 16
ci_018                 9.870939e-03 3 1  ON 17
ci_019                 1.001179e-02 3 1  ON 18
ci_020                 1.717912e-02 3 1  ON 19
ci_021                 1.701537e-02 3 1  ON 20
ci_022                 9.197552e-03 3 1  ON 21
ci_023                 9.443004e-03 3 1  ON 22
ci_024                 9.641410e-03 3 1  ON 23
ci_025                 9.440456e-03 3 1  ON 24
ci_026                 1.108886e-02 3 1  ON 25
ci_027                 1.154959e-02 3 1  ON 26
ci_028                -1.497013e-02 3 1  ON 27
ci_029                -1.552608e-02 3 1  ON 28
ci_030                -9.429646e-03 3 1  ON 29
ci_031                -9.018404e-03 3 1  ON 30
ci_032                -1.486286e-02 3 1  ON 31
ci_033                 5.718111e-03 3 1  ON 32
ci_034                 5.612306e-03 3 1  ON 33
ci_035                -5.045682e-03 3 1  ON 34
ci_036                -1.252385e-02 3 1  ON 35
ci_037                -1.250505e-02 3 1  ON 36
ci_038                 1.766623e-03 3 1  ON 37
ci_039                 1.722378e-03 3 1  ON 38
ci_040                -3.025873e-03 3 1  ON 39
ci_041                 8.803040e-03 3 1  ON 40
ci_042                 8.891633e-03 3 1  ON 41
ci_043                -4.006761e-03 3 1  ON 42
ci_044                -4.075886e-03 3 1  ON 43
ci_045                -3.233722e-03 3 1  ON 44
ci_046                 5.729172e-03 3 1  ON 45
ci_047                 5.623209e-03 3 1  ON 46
ci_048                -1.250329e-02 3 1  ON 47
ci_049                -1.364566e-02 3 1  ON 48
ci_050                 3.420741e-03 3 1  ON 49
ci_051                 3.216651e-03 3 1  ON 50
ci_052                -2.266132e-03 3 1  ON 51
ci_053                -2.411121e-03 3 1  ON 52
ci_054                -2.901005e-03 3 1  ON 53
ci_055                -2.923044e-03 3 1  ON 54
ci_056                 5.319989e-03 3 1  ON 55
ci_057                 5.151178e-03 3 1  ON 56
ci_058                -1.691517e-03 3 1  ON 57
ci_059                -1.992060e-03 3 1  ON 58
ci_060                 4.936319e-03 3 1  ON 59
ci_061                 5.525437e-03 3 1  ON 60
ci_062                -3.591921e-03 3 1  ON 61
ci_063                -4.120788e-03 3 1  ON 62
ci_064                -3.016599e-03 3 1  ON 63
ci_065                -4.340705e-03 3 1  ON 64
ci_066                 4.506992e-03 3 1  ON 65
ci_067                 4.316515e-03 3 1  ON 66
ci_068                -4.323921e-03 3 1  ON 67
ci_069                -4.842492e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 88
    time step          = 0.05
    reference energy   = -17.2388
    reference variance = 0.240865
====================================================
  Execution time = 1.4105e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s088
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8154e-01
  Total weights = 1.9571e+06
  Execution time = 1.8268e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269098091260
                                         uncertainty =       0.001799140684

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269098091260
                                         uncertainty =       0.001799140684

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366835379
  error estimate for blocks of size 2^( 2) =       0.000380990330
  error estimate for blocks of size 2^( 3) =       0.000393243842
  error estimate for blocks of size 2^( 4) =       0.000402000125
  error estimate for blocks of size 2^( 5) =       0.000406960939
  error estimate for blocks of size 2^( 6) =       0.000408532703
  error estimate for blocks of size 2^( 7) =       0.000408847897

      target function =      -0.942292087456
              le_mean =     -17.212012625137
             les_mean =     296.534922792357
             stat err =       0.000406585416
             autocorr =       1.228460409925
   target nu stat err =       0.000406585416
   target dn stat err =       0.002824093295
      target stat err =       0.004773432957
              std dev =       0.518783568483
             le_variance =       0.269136390928

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269097888372
                                         uncertainty =       0.001799252229

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269097888372
                                         uncertainty =       0.001799252229

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366835178
  error estimate for blocks of size 2^( 2) =       0.000380990398
  error estimate for blocks of size 2^( 3) =       0.000393243996
  error estimate for blocks of size 2^( 4) =       0.000402000682
  error estimate for blocks of size 2^( 5) =       0.000406961646
  error estimate for blocks of size 2^( 6) =       0.000408533591
  error estimate for blocks of size 2^( 7) =       0.000408849788

      target function =      -0.942298966617
              le_mean =     -17.212012664015
             les_mean =     296.534920018808
             stat err =       0.000406586427
             autocorr =       1.228467866142
   target nu stat err =       0.000406586427
   target dn stat err =       0.002823558478
      target stat err =       0.004772619069
              std dev =       0.518783283625
             le_variance =       0.269136095369

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269097983842
                                         uncertainty =       0.001799196334

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269097983842
                                         uncertainty =       0.001799196334

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366835274
  error estimate for blocks of size 2^( 2) =       0.000380990360
  error estimate for blocks of size 2^( 3) =       0.000393243915
  error estimate for blocks of size 2^( 4) =       0.000402000400
  error estimate for blocks of size 2^( 5) =       0.000406961290
  error estimate for blocks of size 2^( 6) =       0.000408533144
  error estimate for blocks of size 2^( 7) =       0.000408848842

      target function =      -0.942295872689
              le_mean =     -17.212012644047
             les_mean =     296.534921180543
             stat err =       0.000406585919
             autocorr =       1.228464150756
   target nu stat err =       0.000406585919
   target dn stat err =       0.002823821076
      target stat err =       0.004773021526
              std dev =       0.518783420162
             le_variance =       0.269136237035

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269098077217
                                         uncertainty =       0.001799147620

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.269098077217
                                         uncertainty =       0.001799147620

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366835366
  error estimate for blocks of size 2^( 2) =       0.000380990333
  error estimate for blocks of size 2^( 3) =       0.000393243850
  error estimate for blocks of size 2^( 4) =       0.000402000159
  error estimate for blocks of size 2^( 5) =       0.000406960982
  error estimate for blocks of size 2^( 6) =       0.000408532758
  error estimate for blocks of size 2^( 7) =       0.000408848015

      target function =      -0.942292603830
              le_mean =     -17.212012627438
             les_mean =     296.534922562860
             stat err =       0.000406585479
             autocorr =       1.228460878123
   target nu stat err =       0.000406585479
   target dn stat err =       0.002824058783
      target stat err =       0.004773381160
              std dev =       0.518783549345
             le_variance =       0.269136371071


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942292087456        initial
     2.1684e+01     2.1684e+02             1.4228e-05        -0.942298966617  <--
     8.6736e+01     8.6736e+02             3.5676e-06        -0.942295872689
     3.4694e+02     3.4694e+03             8.9256e-07        -0.942292603830

*****************************************************************************
Applying the update for shift_i =   2.1684e+01     and shift_s =   2.1684e+02
*****************************************************************************

  Execution time = 2.3311e+01
  </log>
  <optVariables href="H2O.s088.opt.xml">
ci_001                -4.146586e-02 3 1  ON 0
ci_002                -3.159591e-02 3 1  ON 1
ci_003                -2.620194e-02 3 1  ON 2
ci_004                 2.368542e-02 3 1  ON 3
ci_005                 2.385045e-02 3 1  ON 4
ci_006                -2.092958e-02 3 1  ON 5
ci_007                -2.044066e-02 3 1  ON 6
ci_008                -8.592894e-03 3 1  ON 7
ci_009                -1.432616e-02 3 1  ON 8
ci_010                -9.618305e-03 3 1  ON 9
ci_011                -1.061867e-02 3 1  ON 10
ci_012                -9.818018e-03 3 1  ON 11
ci_013                -1.994037e-02 3 1  ON 12
ci_014                 1.258206e-02 3 1  ON 13
ci_015                 1.252368e-02 3 1  ON 14
ci_016                 1.714553e-02 3 1  ON 15
ci_017                 1.631120e-02 3 1  ON 16
ci_018                 9.865846e-03 3 1  ON 17
ci_019                 1.001596e-02 3 1  ON 18
ci_020                 1.717697e-02 3 1  ON 19
ci_021                 1.701952e-02 3 1  ON 20
ci_022                 9.194304e-03 3 1  ON 21
ci_023                 9.441552e-03 3 1  ON 22
ci_024                 9.640234e-03 3 1  ON 23
ci_025                 9.438404e-03 3 1  ON 24
ci_026                 1.108783e-02 3 1  ON 25
ci_027                 1.154725e-02 3 1  ON 26
ci_028                -1.497243e-02 3 1  ON 27
ci_029                -1.552560e-02 3 1  ON 28
ci_030                -9.427818e-03 3 1  ON 29
ci_031                -9.017151e-03 3 1  ON 30
ci_032                -1.486215e-02 3 1  ON 31
ci_033                 5.714343e-03 3 1  ON 32
ci_034                 5.611875e-03 3 1  ON 33
ci_035                -5.050517e-03 3 1  ON 34
ci_036                -1.252777e-02 3 1  ON 35
ci_037                -1.250314e-02 3 1  ON 36
ci_038                 1.764890e-03 3 1  ON 37
ci_039                 1.722563e-03 3 1  ON 38
ci_040                -3.026322e-03 3 1  ON 39
ci_041                 8.799370e-03 3 1  ON 40
ci_042                 8.890899e-03 3 1  ON 41
ci_043                -4.005636e-03 3 1  ON 42
ci_044                -4.072732e-03 3 1  ON 43
ci_045                -3.233180e-03 3 1  ON 44
ci_046                 5.728475e-03 3 1  ON 45
ci_047                 5.622678e-03 3 1  ON 46
ci_048                -1.250410e-02 3 1  ON 47
ci_049                -1.364232e-02 3 1  ON 48
ci_050                 3.419436e-03 3 1  ON 49
ci_051                 3.227311e-03 3 1  ON 50
ci_052                -2.261329e-03 3 1  ON 51
ci_053                -2.409223e-03 3 1  ON 52
ci_054                -2.899503e-03 3 1  ON 53
ci_055                -2.922756e-03 3 1  ON 54
ci_056                 5.322557e-03 3 1  ON 55
ci_057                 5.149110e-03 3 1  ON 56
ci_058                -1.691407e-03 3 1  ON 57
ci_059                -1.993695e-03 3 1  ON 58
ci_060                 4.937886e-03 3 1  ON 59
ci_061                 5.531281e-03 3 1  ON 60
ci_062                -3.592964e-03 3 1  ON 61
ci_063                -4.117802e-03 3 1  ON 62
ci_064                -3.013972e-03 3 1  ON 63
ci_065                -4.339319e-03 3 1  ON 64
ci_066                 4.505537e-03 3 1  ON 65
ci_067                 4.314648e-03 3 1  ON 66
ci_068                -4.327497e-03 3 1  ON 67
ci_069                -4.842103e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9893e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s089 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s089 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=89  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.2422
    reference variance = 0.224265
====================================================
  Execution time = 1.4308e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s089
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8118e-01
  Total weights = 1.957323037e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4777e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268706689915
                                         uncertainty =       0.001761676704

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268706689915
                                         uncertainty =       0.001761676704

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366565570
  error estimate for blocks of size 2^( 2) =       0.000380604448
  error estimate for blocks of size 2^( 3) =       0.000393059563
  error estimate for blocks of size 2^( 4) =       0.000402530888
  error estimate for blocks of size 2^( 5) =       0.000408399936
  error estimate for blocks of size 2^( 6) =       0.000411769835
  error estimate for blocks of size 2^( 7) =       0.000413953574

      target function =      -0.942899274212
              le_mean =     -17.212050936871
             les_mean =     296.535881753259
             stat err =       0.000409163558
             autocorr =       1.245921128698
   target nu stat err =       0.000409163558
   target dn stat err =       0.002473790582
      target stat err =       0.004202166949
              std dev =       0.518402000593
             le_variance =       0.268740634219


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721205093687e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+00, overlap shift 5.4210e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942917080770       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942923622687       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942924694691       residual = 3.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942924888410       residual = 6.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942924882429       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942924908405       residual = 5.06e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942924908255       residual = 8.03e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942924905461       residual = 1.72e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942924907068       residual = 2.58e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942924906627       residual = 5.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+00 is 1.912442e-05

solving harmonic davidson linear method for identity shift 2.1684e+01, overlap shift 2.1684e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942917080770       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942918734460       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942919004845       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942919053454       residual = 6.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942919051879       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942919058383       residual = 4.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942919058341       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942919057643       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942919058046       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942919057936       residual = 5.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+01 is 4.819290e-06

solving harmonic davidson linear method for identity shift 8.6736e+01, overlap shift 8.6736e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942917080770       residual = 1.03e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942917495346       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942917563093       residual = 3.61e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942917575257       residual = 6.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942917574858       residual = 1.86e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942917576485       residual = 4.96e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942917576474       residual = 7.85e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942917576299       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942917576400       residual = 2.49e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942917576373       residual = 5.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+01 is 1.207233e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.327702 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6795e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
ci_001                -4.146265e-02 3 1  ON 0
ci_002                -3.159519e-02 3 1  ON 1
ci_003                -2.620151e-02 3 1  ON 2
ci_004                 2.368305e-02 3 1  ON 3
ci_005                 2.384563e-02 3 1  ON 4
ci_006                -2.092672e-02 3 1  ON 5
ci_007                -2.044021e-02 3 1  ON 6
ci_008                -8.593302e-03 3 1  ON 7
ci_009                -1.432817e-02 3 1  ON 8
ci_010                -9.616078e-03 3 1  ON 9
ci_011                -1.062249e-02 3 1  ON 10
ci_012                -9.817436e-03 3 1  ON 11
ci_013                -1.993776e-02 3 1  ON 12
ci_014                 1.258240e-02 3 1  ON 13
ci_015                 1.252504e-02 3 1  ON 14
ci_016                 1.714372e-02 3 1  ON 15
ci_017                 1.630937e-02 3 1  ON 16
ci_018                 9.869759e-03 3 1  ON 17
ci_019                 1.001717e-02 3 1  ON 18
ci_020                 1.717350e-02 3 1  ON 19
ci_021                 1.701616e-02 3 1  ON 20
ci_022                 9.197267e-03 3 1  ON 21
ci_023                 9.439911e-03 3 1  ON 22
ci_024                 9.640553e-03 3 1  ON 23
ci_025                 9.439878e-03 3 1  ON 24
ci_026                 1.108655e-02 3 1  ON 25
ci_027                 1.154428e-02 3 1  ON 26
ci_028                -1.497234e-02 3 1  ON 27
ci_029                -1.552559e-02 3 1  ON 28
ci_030                -9.429515e-03 3 1  ON 29
ci_031                -9.020062e-03 3 1  ON 30
ci_032                -1.486168e-02 3 1  ON 31
ci_033                 5.715467e-03 3 1  ON 32
ci_034                 5.614606e-03 3 1  ON 33
ci_035                -5.049606e-03 3 1  ON 34
ci_036                -1.252615e-02 3 1  ON 35
ci_037                -1.250401e-02 3 1  ON 36
ci_038                 1.763975e-03 3 1  ON 37
ci_039                 1.723865e-03 3 1  ON 38
ci_040                -3.025039e-03 3 1  ON 39
ci_041                 8.796441e-03 3 1  ON 40
ci_042                 8.888948e-03 3 1  ON 41
ci_043                -4.006233e-03 3 1  ON 42
ci_044                -4.076375e-03 3 1  ON 43
ci_045                -3.230863e-03 3 1  ON 44
ci_046                 5.727223e-03 3 1  ON 45
ci_047                 5.621205e-03 3 1  ON 46
ci_048                -1.250493e-02 3 1  ON 47
ci_049                -1.364603e-02 3 1  ON 48
ci_050                 3.419952e-03 3 1  ON 49
ci_051                 3.224711e-03 3 1  ON 50
ci_052                -2.263825e-03 3 1  ON 51
ci_053                -2.411449e-03 3 1  ON 52
ci_054                -2.897084e-03 3 1  ON 53
ci_055                -2.920681e-03 3 1  ON 54
ci_056                 5.321475e-03 3 1  ON 55
ci_057                 5.148187e-03 3 1  ON 56
ci_058                -1.690658e-03 3 1  ON 57
ci_059                -1.997088e-03 3 1  ON 58
ci_060                 4.942150e-03 3 1  ON 59
ci_061                 5.532797e-03 3 1  ON 60
ci_062                -3.591299e-03 3 1  ON 61
ci_063                -4.118136e-03 3 1  ON 62
ci_064                -3.016419e-03 3 1  ON 63
ci_065                -4.341409e-03 3 1  ON 64
ci_066                 4.505829e-03 3 1  ON 65
ci_067                 4.316765e-03 3 1  ON 66
ci_068                -4.327110e-03 3 1  ON 67
ci_069                -4.841823e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 89
    time step          = 0.05
    reference energy   = -17.2245
    reference variance = 0.160885
====================================================
  Execution time = 1.3648e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s089
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8059e-01
  Total weights = 1.9570e+06
  Execution time = 1.8250e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268985896755
                                         uncertainty =       0.001399947833

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268985896755
                                         uncertainty =       0.001399947833

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366687299
  error estimate for blocks of size 2^( 2) =       0.000380710718
  error estimate for blocks of size 2^( 3) =       0.000393366204
  error estimate for blocks of size 2^( 4) =       0.000402696190
  error estimate for blocks of size 2^( 5) =       0.000408957521
  error estimate for blocks of size 2^( 6) =       0.000413089815
  error estimate for blocks of size 2^( 7) =       0.000414461372

      target function =      -0.943899694836
              le_mean =     -17.211810666902
             les_mean =     296.527016044067
             stat err =       0.000409801225
             autocorr =       1.248977939999
   target nu stat err =       0.000409801225
   target dn stat err =       0.002040198335
      target stat err =       0.003495755750
              std dev =       0.518574151854
             le_variance =       0.268919150971

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268985807793
                                         uncertainty =       0.001400531332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268985807793
                                         uncertainty =       0.001400531332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366687229
  error estimate for blocks of size 2^( 2) =       0.000380710182
  error estimate for blocks of size 2^( 3) =       0.000393365611
  error estimate for blocks of size 2^( 4) =       0.000402695493
  error estimate for blocks of size 2^( 5) =       0.000408956662
  error estimate for blocks of size 2^( 6) =       0.000413088519
  error estimate for blocks of size 2^( 7) =       0.000414461113

      target function =      -0.943899598104
              le_mean =     -17.211810423344
             les_mean =     296.527007707620
             stat err =       0.000409800447
             autocorr =       1.248973676737
   target nu stat err =       0.000409800447
   target dn stat err =       0.002041451994
      target stat err =       0.003497808251
              std dev =       0.518574052701
             le_variance =       0.268919048135

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268985828292
                                         uncertainty =       0.001400241777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268985828292
                                         uncertainty =       0.001400241777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366687248
  error estimate for blocks of size 2^( 2) =       0.000380710430
  error estimate for blocks of size 2^( 3) =       0.000393365886
  error estimate for blocks of size 2^( 4) =       0.000402695820
  error estimate for blocks of size 2^( 5) =       0.000408957069
  error estimate for blocks of size 2^( 6) =       0.000413089143
  error estimate for blocks of size 2^( 7) =       0.000414461228

      target function =      -0.934061852473
              le_mean =     -17.211810540391
             les_mean =     296.532883170484
             stat err =       0.000409800815
             autocorr =       1.248975792496
   target nu stat err =       0.000409800815
   target dn stat err =       0.006221550514
      target stat err =       0.010237002679
              std dev =       0.518574079103
             le_variance =       0.268919075518

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268985885490
                                         uncertainty =       0.001399984592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268985885490
                                         uncertainty =       0.001399984592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366687291
  error estimate for blocks of size 2^( 2) =       0.000380710680
  error estimate for blocks of size 2^( 3) =       0.000393366163
  error estimate for blocks of size 2^( 4) =       0.000402696142
  error estimate for blocks of size 2^( 5) =       0.000408957462
  error estimate for blocks of size 2^( 6) =       0.000413089729
  error estimate for blocks of size 2^( 7) =       0.000414461353

      target function =      -0.943900486868
              le_mean =     -17.211810650810
             les_mean =     296.527015016900
             stat err =       0.000409801171
             autocorr =       1.248977672792
   target nu stat err =       0.000409801171
   target dn stat err =       0.002040275045
      target stat err =       0.003495887112
              std dev =       0.518574140151
             le_variance =       0.268919138833


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943899694836        initial
     5.4210e+00     5.4210e+01             1.9124e-05        -0.943899598104
     2.1684e+01     2.1684e+02             4.8193e-06        -0.934061852473
     8.6736e+01     8.6736e+02             1.2072e-06        -0.943900486868  <--

*****************************************************************************
Applying the update for shift_i =   8.6736e+01     and shift_s =   8.6736e+02
*****************************************************************************

  Execution time = 2.2838e+01
  </log>
  <optVariables href="H2O.s089.opt.xml">
ci_001                -4.146505e-02 3 1  ON 0
ci_002                -3.159573e-02 3 1  ON 1
ci_003                -2.620184e-02 3 1  ON 2
ci_004                 2.368483e-02 3 1  ON 3
ci_005                 2.384924e-02 3 1  ON 4
ci_006                -2.092887e-02 3 1  ON 5
ci_007                -2.044054e-02 3 1  ON 6
ci_008                -8.592996e-03 3 1  ON 7
ci_009                -1.432666e-02 3 1  ON 8
ci_010                -9.617746e-03 3 1  ON 9
ci_011                -1.061963e-02 3 1  ON 10
ci_012                -9.817872e-03 3 1  ON 11
ci_013                -1.993972e-02 3 1  ON 12
ci_014                 1.258215e-02 3 1  ON 13
ci_015                 1.252402e-02 3 1  ON 14
ci_016                 1.714508e-02 3 1  ON 15
ci_017                 1.631074e-02 3 1  ON 16
ci_018                 9.866827e-03 3 1  ON 17
ci_019                 1.001626e-02 3 1  ON 18
ci_020                 1.717610e-02 3 1  ON 19
ci_021                 1.701868e-02 3 1  ON 20
ci_022                 9.195047e-03 3 1  ON 21
ci_023                 9.441141e-03 3 1  ON 22
ci_024                 9.640314e-03 3 1  ON 23
ci_025                 9.438773e-03 3 1  ON 24
ci_026                 1.108751e-02 3 1  ON 25
ci_027                 1.154651e-02 3 1  ON 26
ci_028                -1.497241e-02 3 1  ON 27
ci_029                -1.552560e-02 3 1  ON 28
ci_030                -9.428243e-03 3 1  ON 29
ci_031                -9.017880e-03 3 1  ON 30
ci_032                -1.486203e-02 3 1  ON 31
ci_033                 5.714624e-03 3 1  ON 32
ci_034                 5.612559e-03 3 1  ON 33
ci_035                -5.050288e-03 3 1  ON 34
ci_036                -1.252736e-02 3 1  ON 35
ci_037                -1.250336e-02 3 1  ON 36
ci_038                 1.764661e-03 3 1  ON 37
ci_039                 1.722889e-03 3 1  ON 38
ci_040                -3.026000e-03 3 1  ON 39
ci_041                 8.798636e-03 3 1  ON 40
ci_042                 8.890410e-03 3 1  ON 41
ci_043                -4.005785e-03 3 1  ON 42
ci_044                -4.073645e-03 3 1  ON 43
ci_045                -3.232600e-03 3 1  ON 44
ci_046                 5.728161e-03 3 1  ON 45
ci_047                 5.622309e-03 3 1  ON 46
ci_048                -1.250430e-02 3 1  ON 47
ci_049                -1.364325e-02 3 1  ON 48
ci_050                 3.419565e-03 3 1  ON 49
ci_051                 3.226659e-03 3 1  ON 50
ci_052                -2.261955e-03 3 1  ON 51
ci_053                -2.409781e-03 3 1  ON 52
ci_054                -2.898896e-03 3 1  ON 53
ci_055                -2.922236e-03 3 1  ON 54
ci_056                 5.322286e-03 3 1  ON 55
ci_057                 5.148879e-03 3 1  ON 56
ci_058                -1.691219e-03 3 1  ON 57
ci_059                -1.994546e-03 3 1  ON 58
ci_060                 4.938954e-03 3 1  ON 59
ci_061                 5.531661e-03 3 1  ON 60
ci_062                -3.592547e-03 3 1  ON 61
ci_063                -4.117886e-03 3 1  ON 62
ci_064                -3.014585e-03 3 1  ON 63
ci_065                -4.339843e-03 3 1  ON 64
ci_066                 4.505610e-03 3 1  ON 65
ci_067                 4.315179e-03 3 1  ON 66
ci_068                -4.327400e-03 3 1  ON 67
ci_069                -4.842033e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9639e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s090 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s090 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=90  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.2066
    reference variance = 0.336989
====================================================
  Execution time = 1.4135e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s090
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5300e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7895e-01
  Total weights = 1.957036145e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4714e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268090605579
                                         uncertainty =       0.001562414761

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268090605579
                                         uncertainty =       0.001562414761

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366151162
  error estimate for blocks of size 2^( 2) =       0.000379659525
  error estimate for blocks of size 2^( 3) =       0.000392226291
  error estimate for blocks of size 2^( 4) =       0.000401131479
  error estimate for blocks of size 2^( 5) =       0.000406181497
  error estimate for blocks of size 2^( 6) =       0.000407182347
  error estimate for blocks of size 2^( 7) =       0.000409369794

      target function =      -0.946653824083
              le_mean =     -17.212099437446
             les_mean =     296.535319718601
             stat err =       0.000405966279
             autocorr =       1.229303413441
   target nu stat err =       0.000405966279
   target dn stat err =       0.002073251749
      target stat err =       0.003570818445
              std dev =       0.517815939745
             le_variance =       0.268133347454


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721209943745e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+01, overlap shift 2.1684e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946666318375       residual = 9.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946667635637       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946667920651       residual = 2.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946667996081       residual = 4.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946667997351       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946668001018       residual = 2.68e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946668000621       residual = 3.63e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946668000979       residual = 6.42e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946668001175       residual = 1.63e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946668001077       residual = 2.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+01 is 6.374249e-06

solving harmonic davidson linear method for identity shift 8.6736e+01, overlap shift 8.6736e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946666318375       residual = 9.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946666648636       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946666720038       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946666738923       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946666739237       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946666740153       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946666740054       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946666740144       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946666740193       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946666740168       residual = 2.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+01 is 1.597158e-06

solving harmonic davidson linear method for identity shift 3.4694e+02, overlap shift 3.4694e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946666318375       residual = 9.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946666400999       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946666418859       residual = 2.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946666423582       residual = 4.61e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946666423660       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946666423889       residual = 2.67e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946666423865       residual = 3.61e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946666423887       residual = 6.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946666423900       residual = 1.62e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946666423893       residual = 2.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+02 is 3.995150e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.331192 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6616e+01
  </log>
  <optVariables href="H2O.s090.opt.xml">
ci_001                -4.146560e-02 3 1  ON 0
ci_002                -3.159603e-02 3 1  ON 1
ci_003                -2.620190e-02 3 1  ON 2
ci_004                 2.368457e-02 3 1  ON 3
ci_005                 2.384880e-02 3 1  ON 4
ci_006                -2.092835e-02 3 1  ON 5
ci_007                -2.044039e-02 3 1  ON 6
ci_008                -8.593952e-03 3 1  ON 7
ci_009                -1.432592e-02 3 1  ON 8
ci_010                -9.617476e-03 3 1  ON 9
ci_011                -1.061980e-02 3 1  ON 10
ci_012                -9.818874e-03 3 1  ON 11
ci_013                -1.993991e-02 3 1  ON 12
ci_014                 1.258223e-02 3 1  ON 13
ci_015                 1.252389e-02 3 1  ON 14
ci_016                 1.714497e-02 3 1  ON 15
ci_017                 1.631103e-02 3 1  ON 16
ci_018                 9.867550e-03 3 1  ON 17
ci_019                 1.001631e-02 3 1  ON 18
ci_020                 1.717621e-02 3 1  ON 19
ci_021                 1.701911e-02 3 1  ON 20
ci_022                 9.195014e-03 3 1  ON 21
ci_023                 9.441010e-03 3 1  ON 22
ci_024                 9.639693e-03 3 1  ON 23
ci_025                 9.439513e-03 3 1  ON 24
ci_026                 1.108718e-02 3 1  ON 25
ci_027                 1.154558e-02 3 1  ON 26
ci_028                -1.497244e-02 3 1  ON 27
ci_029                -1.552537e-02 3 1  ON 28
ci_030                -9.428568e-03 3 1  ON 29
ci_031                -9.018007e-03 3 1  ON 30
ci_032                -1.486209e-02 3 1  ON 31
ci_033                 5.715026e-03 3 1  ON 32
ci_034                 5.611620e-03 3 1  ON 33
ci_035                -5.050073e-03 3 1  ON 34
ci_036                -1.252646e-02 3 1  ON 35
ci_037                -1.250312e-02 3 1  ON 36
ci_038                 1.764691e-03 3 1  ON 37
ci_039                 1.723121e-03 3 1  ON 38
ci_040                -3.026222e-03 3 1  ON 39
ci_041                 8.798876e-03 3 1  ON 40
ci_042                 8.890703e-03 3 1  ON 41
ci_043                -4.005854e-03 3 1  ON 42
ci_044                -4.074334e-03 3 1  ON 43
ci_045                -3.232167e-03 3 1  ON 44
ci_046                 5.727915e-03 3 1  ON 45
ci_047                 5.621980e-03 3 1  ON 46
ci_048                -1.250419e-02 3 1  ON 47
ci_049                -1.364166e-02 3 1  ON 48
ci_050                 3.419943e-03 3 1  ON 49
ci_051                 3.227170e-03 3 1  ON 50
ci_052                -2.261515e-03 3 1  ON 51
ci_053                -2.409487e-03 3 1  ON 52
ci_054                -2.898442e-03 3 1  ON 53
ci_055                -2.922161e-03 3 1  ON 54
ci_056                 5.322356e-03 3 1  ON 55
ci_057                 5.149494e-03 3 1  ON 56
ci_058                -1.690961e-03 3 1  ON 57
ci_059                -1.994467e-03 3 1  ON 58
ci_060                 4.938495e-03 3 1  ON 59
ci_061                 5.530344e-03 3 1  ON 60
ci_062                -3.592787e-03 3 1  ON 61
ci_063                -4.117720e-03 3 1  ON 62
ci_064                -3.015019e-03 3 1  ON 63
ci_065                -4.340067e-03 3 1  ON 64
ci_066                 4.505667e-03 3 1  ON 65
ci_067                 4.315091e-03 3 1  ON 66
ci_068                -4.328104e-03 3 1  ON 67
ci_069                -4.842352e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 90
    time step          = 0.05
    reference energy   = -17.244
    reference variance = 0.176741
====================================================
  Execution time = 1.3587e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s090
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7916e-01
  Total weights = 1.9573e+06
  Execution time = 1.8531e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266865077729
                                         uncertainty =       0.001250549283

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266865077729
                                         uncertainty =       0.001250549283

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365249261
  error estimate for blocks of size 2^( 2) =       0.000379338260
  error estimate for blocks of size 2^( 3) =       0.000392584792
  error estimate for blocks of size 2^( 4) =       0.000401937648
  error estimate for blocks of size 2^( 5) =       0.000406910023
  error estimate for blocks of size 2^( 6) =       0.000410741829
  error estimate for blocks of size 2^( 7) =       0.000414299104

      target function =      -0.946305635035
              le_mean =     -17.212773492843
             les_mean =     296.558731180750
             stat err =       0.000408472151
             autocorr =       1.250680022959
   target nu stat err =       0.000408472151
   target dn stat err =       0.002432743066
      target stat err =       0.004169456701
              std dev =       0.516540458511
             le_variance =       0.266814045279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266865113179
                                         uncertainty =       0.001250570617

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266865113179
                                         uncertainty =       0.001250570617

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365249284
  error estimate for blocks of size 2^( 2) =       0.000379338142
  error estimate for blocks of size 2^( 3) =       0.000392584550
  error estimate for blocks of size 2^( 4) =       0.000401937426
  error estimate for blocks of size 2^( 5) =       0.000406909748
  error estimate for blocks of size 2^( 6) =       0.000410741500
  error estimate for blocks of size 2^( 7) =       0.000414298740

      target function =      -0.946301492916
              le_mean =     -17.212773454033
             les_mean =     296.558732321854
             stat err =       0.000408471853
             autocorr =       1.250678041736
   target nu stat err =       0.000408471853
   target dn stat err =       0.002430123894
      target stat err =       0.004165068337
              std dev =       0.516540491422
             le_variance =       0.266814079279

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266865094175
                                         uncertainty =       0.001250559965

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266865094175
                                         uncertainty =       0.001250559965

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365249272
  error estimate for blocks of size 2^( 2) =       0.000379338200
  error estimate for blocks of size 2^( 3) =       0.000392584669
  error estimate for blocks of size 2^( 4) =       0.000401937536
  error estimate for blocks of size 2^( 5) =       0.000406909884
  error estimate for blocks of size 2^( 6) =       0.000410741663
  error estimate for blocks of size 2^( 7) =       0.000414298921

      target function =      -0.946303904889
              le_mean =     -17.212773473216
             les_mean =     296.558731541685
             stat err =       0.000408472001
             autocorr =       1.250679030580
   target nu stat err =       0.000408472001
   target dn stat err =       0.002431426378
      target stat err =       0.004167253646
              std dev =       0.516540473728
             le_variance =       0.266814060999

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266865079640
                                         uncertainty =       0.001250550618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266865079640
                                         uncertainty =       0.001250550618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365249262
  error estimate for blocks of size 2^( 2) =       0.000379338253
  error estimate for blocks of size 2^( 3) =       0.000392584776
  error estimate for blocks of size 2^( 4) =       0.000401937634
  error estimate for blocks of size 2^( 5) =       0.000406910006
  error estimate for blocks of size 2^( 6) =       0.000410741808
  error estimate for blocks of size 2^( 7) =       0.000414299081

      target function =      -0.946305454038
              le_mean =     -17.212773490370
             les_mean =     296.558731204288
             stat err =       0.000408472132
             autocorr =       1.250679898950
   target nu stat err =       0.000408472132
   target dn stat err =       0.002432577914
      target stat err =       0.004169180682
              std dev =       0.516540460273
             le_variance =       0.266814047099


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946305635035        initial  <--
     2.1684e+01     2.1684e+02             6.3742e-06        -0.946301492916
     8.6736e+01     8.6736e+02             1.5972e-06        -0.946303904889
     3.4694e+02     3.4694e+03             3.9951e-07        -0.946305454038

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 22.8077
  </log>
  <optVariables href="H2O.s090.opt.xml">
ci_001                -4.146505e-02 3 1  ON 0
ci_002                -3.159573e-02 3 1  ON 1
ci_003                -2.620184e-02 3 1  ON 2
ci_004                 2.368483e-02 3 1  ON 3
ci_005                 2.384924e-02 3 1  ON 4
ci_006                -2.092887e-02 3 1  ON 5
ci_007                -2.044054e-02 3 1  ON 6
ci_008                -8.592996e-03 3 1  ON 7
ci_009                -1.432666e-02 3 1  ON 8
ci_010                -9.617746e-03 3 1  ON 9
ci_011                -1.061963e-02 3 1  ON 10
ci_012                -9.817872e-03 3 1  ON 11
ci_013                -1.993972e-02 3 1  ON 12
ci_014                 1.258215e-02 3 1  ON 13
ci_015                 1.252402e-02 3 1  ON 14
ci_016                 1.714508e-02 3 1  ON 15
ci_017                 1.631074e-02 3 1  ON 16
ci_018                 9.866827e-03 3 1  ON 17
ci_019                 1.001626e-02 3 1  ON 18
ci_020                 1.717610e-02 3 1  ON 19
ci_021                 1.701868e-02 3 1  ON 20
ci_022                 9.195047e-03 3 1  ON 21
ci_023                 9.441141e-03 3 1  ON 22
ci_024                 9.640314e-03 3 1  ON 23
ci_025                 9.438773e-03 3 1  ON 24
ci_026                 1.108751e-02 3 1  ON 25
ci_027                 1.154651e-02 3 1  ON 26
ci_028                -1.497241e-02 3 1  ON 27
ci_029                -1.552560e-02 3 1  ON 28
ci_030                -9.428243e-03 3 1  ON 29
ci_031                -9.017880e-03 3 1  ON 30
ci_032                -1.486203e-02 3 1  ON 31
ci_033                 5.714624e-03 3 1  ON 32
ci_034                 5.612559e-03 3 1  ON 33
ci_035                -5.050288e-03 3 1  ON 34
ci_036                -1.252736e-02 3 1  ON 35
ci_037                -1.250336e-02 3 1  ON 36
ci_038                 1.764661e-03 3 1  ON 37
ci_039                 1.722889e-03 3 1  ON 38
ci_040                -3.026000e-03 3 1  ON 39
ci_041                 8.798636e-03 3 1  ON 40
ci_042                 8.890410e-03 3 1  ON 41
ci_043                -4.005785e-03 3 1  ON 42
ci_044                -4.073645e-03 3 1  ON 43
ci_045                -3.232600e-03 3 1  ON 44
ci_046                 5.728161e-03 3 1  ON 45
ci_047                 5.622309e-03 3 1  ON 46
ci_048                -1.250430e-02 3 1  ON 47
ci_049                -1.364325e-02 3 1  ON 48
ci_050                 3.419565e-03 3 1  ON 49
ci_051                 3.226659e-03 3 1  ON 50
ci_052                -2.261955e-03 3 1  ON 51
ci_053                -2.409781e-03 3 1  ON 52
ci_054                -2.898896e-03 3 1  ON 53
ci_055                -2.922236e-03 3 1  ON 54
ci_056                 5.322286e-03 3 1  ON 55
ci_057                 5.148879e-03 3 1  ON 56
ci_058                -1.691219e-03 3 1  ON 57
ci_059                -1.994546e-03 3 1  ON 58
ci_060                 4.938954e-03 3 1  ON 59
ci_061                 5.531661e-03 3 1  ON 60
ci_062                -3.592547e-03 3 1  ON 61
ci_063                -4.117886e-03 3 1  ON 62
ci_064                -3.014585e-03 3 1  ON 63
ci_065                -4.339843e-03 3 1  ON 64
ci_066                 4.505610e-03 3 1  ON 65
ci_067                 4.315179e-03 3 1  ON 66
ci_068                -4.327400e-03 3 1  ON 67
ci_069                -4.842033e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9429e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s091 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s091 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=91  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.2584
    reference variance = 0.281114
====================================================
  Execution time = 1.4337e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s091
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5305e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7445e-01
  Total weights = 1.957263183e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4894e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264402569638
                                         uncertainty =       0.001233871071

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264402569638
                                         uncertainty =       0.001233871071

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363572670
  error estimate for blocks of size 2^( 2) =       0.000377526580
  error estimate for blocks of size 2^( 3) =       0.000390080667
  error estimate for blocks of size 2^( 4) =       0.000398976552
  error estimate for blocks of size 2^( 5) =       0.000405006497
  error estimate for blocks of size 2^( 6) =       0.000407656707
  error estimate for blocks of size 2^( 7) =       0.000408945023

      target function =      -0.954327934926
              le_mean =     -17.212681490563
             les_mean =     296.550853691177
             stat err =       0.000405146195
             autocorr =       1.241769732424
   target nu stat err =       0.000405146195
   target dn stat err =       0.001753669351
      target stat err =       0.003096137612
              std dev =       0.514169400389
             le_variance =       0.264370172296


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721268149056e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1684e+02, overlap shift 2.1684e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.954337062329       residual = 7.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.954337217668       residual = 5.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.954337228243       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.954337233028       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.954337234510       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.954337234698       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.954337234609       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.954337234535       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.954337234526       residual = 7.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+02 is 6.866468e-07

solving harmonic davidson linear method for identity shift 8.6736e+02, overlap shift 8.6736e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.954337062329       residual = 7.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.954337101175       residual = 5.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.954337103819       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.954337105014       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.954337105386       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.954337105433       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.954337105411       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.954337105391       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.954337105390       residual = 7.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+02 is 1.717072e-07

solving harmonic davidson linear method for identity shift 3.4694e+03, overlap shift 3.4694e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.954337062329       residual = 7.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.954337072041       residual = 5.96e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.954337072702       residual = 1.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.954337073002       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.954337073090       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.954337073110       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.954337073101       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.954337073097       residual = 4.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.954337073103       residual = 7.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          8 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.4694e+03 is 4.292963e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.334238 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6837e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
ci_001                -4.146505e-02 3 1  ON 0
ci_002                -3.159575e-02 3 1  ON 1
ci_003                -2.620173e-02 3 1  ON 2
ci_004                 2.368475e-02 3 1  ON 3
ci_005                 2.384924e-02 3 1  ON 4
ci_006                -2.092883e-02 3 1  ON 5
ci_007                -2.044052e-02 3 1  ON 6
ci_008                -8.592965e-03 3 1  ON 7
ci_009                -1.432670e-02 3 1  ON 8
ci_010                -9.617740e-03 3 1  ON 9
ci_011                -1.061956e-02 3 1  ON 10
ci_012                -9.817932e-03 3 1  ON 11
ci_013                -1.993969e-02 3 1  ON 12
ci_014                 1.258211e-02 3 1  ON 13
ci_015                 1.252412e-02 3 1  ON 14
ci_016                 1.714505e-02 3 1  ON 15
ci_017                 1.631074e-02 3 1  ON 16
ci_018                 9.866824e-03 3 1  ON 17
ci_019                 1.001625e-02 3 1  ON 18
ci_020                 1.717614e-02 3 1  ON 19
ci_021                 1.701869e-02 3 1  ON 20
ci_022                 9.195053e-03 3 1  ON 21
ci_023                 9.441123e-03 3 1  ON 22
ci_024                 9.640286e-03 3 1  ON 23
ci_025                 9.438757e-03 3 1  ON 24
ci_026                 1.108749e-02 3 1  ON 25
ci_027                 1.154646e-02 3 1  ON 26
ci_028                -1.497247e-02 3 1  ON 27
ci_029                -1.552561e-02 3 1  ON 28
ci_030                -9.428232e-03 3 1  ON 29
ci_031                -9.017895e-03 3 1  ON 30
ci_032                -1.486198e-02 3 1  ON 31
ci_033                 5.714620e-03 3 1  ON 32
ci_034                 5.612634e-03 3 1  ON 33
ci_035                -5.050270e-03 3 1  ON 34
ci_036                -1.252738e-02 3 1  ON 35
ci_037                -1.250319e-02 3 1  ON 36
ci_038                 1.764632e-03 3 1  ON 37
ci_039                 1.722942e-03 3 1  ON 38
ci_040                -3.025975e-03 3 1  ON 39
ci_041                 8.798612e-03 3 1  ON 40
ci_042                 8.890244e-03 3 1  ON 41
ci_043                -4.005781e-03 3 1  ON 42
ci_044                -4.073630e-03 3 1  ON 43
ci_045                -3.232577e-03 3 1  ON 44
ci_046                 5.728189e-03 3 1  ON 45
ci_047                 5.622329e-03 3 1  ON 46
ci_048                -1.250434e-02 3 1  ON 47
ci_049                -1.364320e-02 3 1  ON 48
ci_050                 3.419534e-03 3 1  ON 49
ci_051                 3.226679e-03 3 1  ON 50
ci_052                -2.261962e-03 3 1  ON 51
ci_053                -2.409783e-03 3 1  ON 52
ci_054                -2.898835e-03 3 1  ON 53
ci_055                -2.922216e-03 3 1  ON 54
ci_056                 5.322313e-03 3 1  ON 55
ci_057                 5.148897e-03 3 1  ON 56
ci_058                -1.691235e-03 3 1  ON 57
ci_059                -1.994496e-03 3 1  ON 58
ci_060                 4.938975e-03 3 1  ON 59
ci_061                 5.531608e-03 3 1  ON 60
ci_062                -3.592604e-03 3 1  ON 61
ci_063                -4.117882e-03 3 1  ON 62
ci_064                -3.014584e-03 3 1  ON 63
ci_065                -4.339824e-03 3 1  ON 64
ci_066                 4.505581e-03 3 1  ON 65
ci_067                 4.315190e-03 3 1  ON 66
ci_068                -4.327501e-03 3 1  ON 67
ci_069                -4.841939e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 91
    time step          = 0.05
    reference energy   = -17.2309
    reference variance = 0.259364
====================================================
  Execution time = 1.6079e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s091
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7955e-01
  Total weights = 1.9575e+06
  Execution time = 1.8222e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268913235699
                                         uncertainty =       0.001633316855

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268913235699
                                         uncertainty =       0.001633316855

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366668385
  error estimate for blocks of size 2^( 2) =       0.000380127651
  error estimate for blocks of size 2^( 3) =       0.000392218829
  error estimate for blocks of size 2^( 4) =       0.000400823606
  error estimate for blocks of size 2^( 5) =       0.000406929739
  error estimate for blocks of size 2^( 6) =       0.000409872882
  error estimate for blocks of size 2^( 7) =       0.000408720402

      target function =      -0.945644870356
              le_mean =     -17.212328730771
             les_mean =     296.543813666349
             stat err =       0.000406586657
             autocorr =       1.229587145934
   target nu stat err =       0.000406586657
   target dn stat err =       0.001983006651
      target stat err =       0.003416479680
              std dev =       0.518547402652
             le_variance =       0.268891408797

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268913152327
                                         uncertainty =       0.001633311607

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268913152327
                                         uncertainty =       0.001633311607

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366668328
  error estimate for blocks of size 2^( 2) =       0.000380127610
  error estimate for blocks of size 2^( 3) =       0.000392218801
  error estimate for blocks of size 2^( 4) =       0.000400823595
  error estimate for blocks of size 2^( 5) =       0.000406929730
  error estimate for blocks of size 2^( 6) =       0.000409872862
  error estimate for blocks of size 2^( 7) =       0.000408720364

      target function =      -0.945645506268
              le_mean =     -17.212328725525
             les_mean =     296.543813108300
             stat err =       0.000406586638
             autocorr =       1.229587405440
   target nu stat err =       0.000406586638
   target dn stat err =       0.001982974126
      target stat err =       0.003416430608
              std dev =       0.518547323043
             le_variance =       0.268891326235

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268913193990
                                         uncertainty =       0.001633314230

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268913193990
                                         uncertainty =       0.001633314230

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366668357
  error estimate for blocks of size 2^( 2) =       0.000380127631
  error estimate for blocks of size 2^( 3) =       0.000392218815
  error estimate for blocks of size 2^( 4) =       0.000400823600
  error estimate for blocks of size 2^( 5) =       0.000406929735
  error estimate for blocks of size 2^( 6) =       0.000409872872
  error estimate for blocks of size 2^( 7) =       0.000408720383

      target function =      -0.945645188936
              le_mean =     -17.212328728146
             les_mean =     296.543813386877
             stat err =       0.000406586648
             autocorr =       1.229587275715
   target nu stat err =       0.000406586648
   target dn stat err =       0.001982990375
      target stat err =       0.003416455125
              std dev =       0.518547362825
             le_variance =       0.268891367493

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268913230484
                                         uncertainty =       0.001633316527

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268913230484
                                         uncertainty =       0.001633316527

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366668381
  error estimate for blocks of size 2^( 2) =       0.000380127648
  error estimate for blocks of size 2^( 3) =       0.000392218828
  error estimate for blocks of size 2^( 4) =       0.000400823605
  error estimate for blocks of size 2^( 5) =       0.000406929739
  error estimate for blocks of size 2^( 6) =       0.000409872881
  error estimate for blocks of size 2^( 7) =       0.000408720400

      target function =      -0.945644910241
              le_mean =     -17.212328730443
             les_mean =     296.543813631371
             stat err =       0.000406586656
             autocorr =       1.229587162156
   target nu stat err =       0.000406586656
   target dn stat err =       0.001983004616
      target stat err =       0.003416476609
              std dev =       0.518547397672
             le_variance =       0.268891403632


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945644870356        initial
     2.1684e+02     2.1684e+03             6.8665e-07        -0.945645506268  <--
     8.6736e+02     8.6736e+03             1.7171e-07        -0.945645188936
     3.4694e+03     3.4694e+04             4.2930e-08        -0.945644910241

*****************************************************************************
Applying the update for shift_i =   2.1684e+02     and shift_s =   2.1684e+03
*****************************************************************************

  Execution time = 2.5262e+01
  </log>
  <optVariables href="H2O.s091.opt.xml">
ci_001                -4.146504e-02 3 1  ON 0
ci_002                -3.159582e-02 3 1  ON 1
ci_003                -2.620143e-02 3 1  ON 2
ci_004                 2.368451e-02 3 1  ON 3
ci_005                 2.384924e-02 3 1  ON 4
ci_006                -2.092874e-02 3 1  ON 5
ci_007                -2.044045e-02 3 1  ON 6
ci_008                -8.592872e-03 3 1  ON 7
ci_009                -1.432683e-02 3 1  ON 8
ci_010                -9.617720e-03 3 1  ON 9
ci_011                -1.061933e-02 3 1  ON 10
ci_012                -9.818114e-03 3 1  ON 11
ci_013                -1.993959e-02 3 1  ON 12
ci_014                 1.258198e-02 3 1  ON 13
ci_015                 1.252439e-02 3 1  ON 14
ci_016                 1.714498e-02 3 1  ON 15
ci_017                 1.631075e-02 3 1  ON 16
ci_018                 9.866816e-03 3 1  ON 17
ci_019                 1.001622e-02 3 1  ON 18
ci_020                 1.717628e-02 3 1  ON 19
ci_021                 1.701875e-02 3 1  ON 20
ci_022                 9.195071e-03 3 1  ON 21
ci_023                 9.441071e-03 3 1  ON 22
ci_024                 9.640203e-03 3 1  ON 23
ci_025                 9.438708e-03 3 1  ON 24
ci_026                 1.108745e-02 3 1  ON 25
ci_027                 1.154632e-02 3 1  ON 26
ci_028                -1.497265e-02 3 1  ON 27
ci_029                -1.552563e-02 3 1  ON 28
ci_030                -9.428197e-03 3 1  ON 29
ci_031                -9.017940e-03 3 1  ON 30
ci_032                -1.486184e-02 3 1  ON 31
ci_033                 5.714605e-03 3 1  ON 32
ci_034                 5.612860e-03 3 1  ON 33
ci_035                -5.050214e-03 3 1  ON 34
ci_036                -1.252744e-02 3 1  ON 35
ci_037                -1.250267e-02 3 1  ON 36
ci_038                 1.764544e-03 3 1  ON 37
ci_039                 1.723100e-03 3 1  ON 38
ci_040                -3.025898e-03 3 1  ON 39
ci_041                 8.798542e-03 3 1  ON 40
ci_042                 8.889745e-03 3 1  ON 41
ci_043                -4.005767e-03 3 1  ON 42
ci_044                -4.073583e-03 3 1  ON 43
ci_045                -3.232510e-03 3 1  ON 44
ci_046                 5.728273e-03 3 1  ON 45
ci_047                 5.622390e-03 3 1  ON 46
ci_048                -1.250444e-02 3 1  ON 47
ci_049                -1.364306e-02 3 1  ON 48
ci_050                 3.419440e-03 3 1  ON 49
ci_051                 3.226738e-03 3 1  ON 50
ci_052                -2.261983e-03 3 1  ON 51
ci_053                -2.409788e-03 3 1  ON 52
ci_054                -2.898652e-03 3 1  ON 53
ci_055                -2.922157e-03 3 1  ON 54
ci_056                 5.322395e-03 3 1  ON 55
ci_057                 5.148951e-03 3 1  ON 56
ci_058                -1.691284e-03 3 1  ON 57
ci_059                -1.994348e-03 3 1  ON 58
ci_060                 4.939037e-03 3 1  ON 59
ci_061                 5.531449e-03 3 1  ON 60
ci_062                -3.592776e-03 3 1  ON 61
ci_063                -4.117870e-03 3 1  ON 62
ci_064                -3.014581e-03 3 1  ON 63
ci_065                -4.339766e-03 3 1  ON 64
ci_066                 4.505494e-03 3 1  ON 65
ci_067                 4.315226e-03 3 1  ON 66
ci_068                -4.327803e-03 3 1  ON 67
ci_069                -4.841657e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2105e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s092 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s092 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=92  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7210e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.247
    reference variance = 0.658525
====================================================
  Execution time = 1.4138e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s092
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5297e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7607e-01
  Total weights = 1.957374706e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4666e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264341774415
                                         uncertainty =       0.001460340006

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.264341774415
                                         uncertainty =       0.001460340006

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000363560245
  error estimate for blocks of size 2^( 2) =       0.000376996684
  error estimate for blocks of size 2^( 3) =       0.000389700664
  error estimate for blocks of size 2^( 4) =       0.000398876485
  error estimate for blocks of size 2^( 5) =       0.000403891611
  error estimate for blocks of size 2^( 6) =       0.000406912650
  error estimate for blocks of size 2^( 7) =       0.000410340025

      target function =      -0.951526115142
              le_mean =     -17.211342167300
             les_mean =     296.506366991817
             stat err =       0.000405005193
             autocorr =       1.240990362493
   target nu stat err =       0.000405005193
   target dn stat err =       0.002256251628
      target stat err =       0.003906978128
              std dev =       0.514151828958
             le_variance =       0.264352103221


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721134216730e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+01, overlap shift 5.4210e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951541100019       residual = 9.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951541826004       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951541933133       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.951541969144       residual = 4.95e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.951541972814       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.951541971488       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.951541972304       residual = 4.23e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.951541972272       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.951541972254       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.951541972339       residual = 5.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+01 is 2.435429e-06

solving harmonic davidson linear method for identity shift 2.1684e+02, overlap shift 2.1684e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951541100019       residual = 9.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951541281719       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951541308523       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.951541317531       residual = 4.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.951541318448       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.951541318116       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.951541318320       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.951541318312       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.951541318307       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.951541318329       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+02 is 6.093590e-07

solving harmonic davidson linear method for identity shift 8.6736e+02, overlap shift 8.6736e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951541100019       residual = 9.78e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951541145457       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951541152159       residual = 3.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.951541154411       residual = 4.94e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.951541154641       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.951541154557       residual = 2.61e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.951541154609       residual = 4.22e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.951541154606       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.951541154605       residual = 2.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.951541154609       residual = 5.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+02 is 1.523711e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.337618 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6613e+01
  </log>
  <optVariables href="H2O.s092.opt.xml">
ci_001                -4.146503e-02 3 1  ON 0
ci_002                -3.159594e-02 3 1  ON 1
ci_003                -2.620101e-02 3 1  ON 2
ci_004                 2.368440e-02 3 1  ON 3
ci_005                 2.384863e-02 3 1  ON 4
ci_006                -2.092832e-02 3 1  ON 5
ci_007                -2.044048e-02 3 1  ON 6
ci_008                -8.592911e-03 3 1  ON 7
ci_009                -1.432696e-02 3 1  ON 8
ci_010                -9.618061e-03 3 1  ON 9
ci_011                -1.061934e-02 3 1  ON 10
ci_012                -9.818388e-03 3 1  ON 11
ci_013                -1.993938e-02 3 1  ON 12
ci_014                 1.258206e-02 3 1  ON 13
ci_015                 1.252431e-02 3 1  ON 14
ci_016                 1.714474e-02 3 1  ON 15
ci_017                 1.631064e-02 3 1  ON 16
ci_018                 9.866952e-03 3 1  ON 17
ci_019                 1.001667e-02 3 1  ON 18
ci_020                 1.717633e-02 3 1  ON 19
ci_021                 1.701826e-02 3 1  ON 20
ci_022                 9.195362e-03 3 1  ON 21
ci_023                 9.441134e-03 3 1  ON 22
ci_024                 9.639998e-03 3 1  ON 23
ci_025                 9.438393e-03 3 1  ON 24
ci_026                 1.108718e-02 3 1  ON 25
ci_027                 1.154594e-02 3 1  ON 26
ci_028                -1.497280e-02 3 1  ON 27
ci_029                -1.552553e-02 3 1  ON 28
ci_030                -9.427975e-03 3 1  ON 29
ci_031                -9.018302e-03 3 1  ON 30
ci_032                -1.486144e-02 3 1  ON 31
ci_033                 5.714428e-03 3 1  ON 32
ci_034                 5.613191e-03 3 1  ON 33
ci_035                -5.050072e-03 3 1  ON 34
ci_036                -1.252760e-02 3 1  ON 35
ci_037                -1.250267e-02 3 1  ON 36
ci_038                 1.764287e-03 3 1  ON 37
ci_039                 1.723137e-03 3 1  ON 38
ci_040                -3.025962e-03 3 1  ON 39
ci_041                 8.798728e-03 3 1  ON 40
ci_042                 8.889963e-03 3 1  ON 41
ci_043                -4.005707e-03 3 1  ON 42
ci_044                -4.073241e-03 3 1  ON 43
ci_045                -3.232463e-03 3 1  ON 44
ci_046                 5.728032e-03 3 1  ON 45
ci_047                 5.622407e-03 3 1  ON 46
ci_048                -1.250471e-02 3 1  ON 47
ci_049                -1.364251e-02 3 1  ON 48
ci_050                 3.419565e-03 3 1  ON 49
ci_051                 3.226694e-03 3 1  ON 50
ci_052                -2.262421e-03 3 1  ON 51
ci_053                -2.409788e-03 3 1  ON 52
ci_054                -2.898379e-03 3 1  ON 53
ci_055                -2.922178e-03 3 1  ON 54
ci_056                 5.322357e-03 3 1  ON 55
ci_057                 5.148757e-03 3 1  ON 56
ci_058                -1.691300e-03 3 1  ON 57
ci_059                -1.994291e-03 3 1  ON 58
ci_060                 4.939356e-03 3 1  ON 59
ci_061                 5.531502e-03 3 1  ON 60
ci_062                -3.592737e-03 3 1  ON 61
ci_063                -4.117682e-03 3 1  ON 62
ci_064                -3.014636e-03 3 1  ON 63
ci_065                -4.339657e-03 3 1  ON 64
ci_066                 4.505512e-03 3 1  ON 65
ci_067                 4.315352e-03 3 1  ON 66
ci_068                -4.327728e-03 3 1  ON 67
ci_069                -4.841387e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 92
    time step          = 0.05
    reference energy   = -17.2992
    reference variance = 0.4717
====================================================
  Execution time = 1.3993e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s092
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7871e-01
  Total weights = 1.9573e+06
  Execution time = 1.8392e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266325033601
                                         uncertainty =       0.001640099401

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266325033601
                                         uncertainty =       0.001640099401

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364910480
  error estimate for blocks of size 2^( 2) =       0.000378831914
  error estimate for blocks of size 2^( 3) =       0.000391438370
  error estimate for blocks of size 2^( 4) =       0.000401464488
  error estimate for blocks of size 2^( 5) =       0.000407054320
  error estimate for blocks of size 2^( 6) =       0.000409891799
  error estimate for blocks of size 2^( 7) =       0.000410241599

      target function =      -0.947057710310
              le_mean =     -17.212204386253
             les_mean =     296.538689005399
             stat err =       0.000407163051
             autocorr =       1.244984799956
   target nu stat err =       0.000407163051
   target dn stat err =       0.002658564071
      target stat err =       0.004547064546
              std dev =       0.516061349352
             le_variance =       0.266319316295

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266324758492
                                         uncertainty =       0.001640125859

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266324758492
                                         uncertainty =       0.001640125859

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364910291
  error estimate for blocks of size 2^( 2) =       0.000378831680
  error estimate for blocks of size 2^( 3) =       0.000391438105
  error estimate for blocks of size 2^( 4) =       0.000401464242
  error estimate for blocks of size 2^( 5) =       0.000407054108
  error estimate for blocks of size 2^( 6) =       0.000409891572
  error estimate for blocks of size 2^( 7) =       0.000410241267

      target function =      -0.947056335300
              le_mean =     -17.212204429547
             les_mean =     296.538691306322
             stat err =       0.000407162797
             autocorr =       1.244984533371
   target nu stat err =       0.000407162797
   target dn stat err =       0.002659006707
      target stat err =       0.004547789610
              std dev =       0.516061082694
             le_variance =       0.266319041071

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266324895634
                                         uncertainty =       0.001640112639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266324895634
                                         uncertainty =       0.001640112639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364910385
  error estimate for blocks of size 2^( 2) =       0.000378831797
  error estimate for blocks of size 2^( 3) =       0.000391438237
  error estimate for blocks of size 2^( 4) =       0.000401464365
  error estimate for blocks of size 2^( 5) =       0.000407054213
  error estimate for blocks of size 2^( 6) =       0.000409891685
  error estimate for blocks of size 2^( 7) =       0.000410241432

      target function =      -0.947057031521
              le_mean =     -17.212204407888
             les_mean =     296.538690150287
             stat err =       0.000407162924
             autocorr =       1.244984666480
   target nu stat err =       0.000407162924
   target dn stat err =       0.002658785419
      target stat err =       0.004547427210
              std dev =       0.516061215623
             le_variance =       0.266319178270

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266325016322
                                         uncertainty =       0.001640101055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.266325016322
                                         uncertainty =       0.001640101055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364910468
  error estimate for blocks of size 2^( 2) =       0.000378831899
  error estimate for blocks of size 2^( 3) =       0.000391438353
  error estimate for blocks of size 2^( 4) =       0.000401464473
  error estimate for blocks of size 2^( 5) =       0.000407054306
  error estimate for blocks of size 2^( 6) =       0.000409891785
  error estimate for blocks of size 2^( 7) =       0.000410241578

      target function =      -0.947057626481
              le_mean =     -17.212204388954
             les_mean =     296.538689147795
             stat err =       0.000407163035
             autocorr =       1.244984783282
   target nu stat err =       0.000407163035
   target dn stat err =       0.002658591726
      target stat err =       0.004547109867
              std dev =       0.516061332603
             le_variance =       0.266319299008


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947057710310        initial  <--
     5.4210e+01     5.4210e+02             2.4354e-06        -0.947056335300
     2.1684e+02     2.1684e+03             6.0936e-07        -0.947057031521
     8.6736e+02     8.6736e+03             1.5237e-07        -0.947057626481

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.2428
  </log>
  <optVariables href="H2O.s092.opt.xml">
ci_001                -4.146504e-02 3 1  ON 0
ci_002                -3.159582e-02 3 1  ON 1
ci_003                -2.620143e-02 3 1  ON 2
ci_004                 2.368451e-02 3 1  ON 3
ci_005                 2.384924e-02 3 1  ON 4
ci_006                -2.092874e-02 3 1  ON 5
ci_007                -2.044045e-02 3 1  ON 6
ci_008                -8.592872e-03 3 1  ON 7
ci_009                -1.432683e-02 3 1  ON 8
ci_010                -9.617720e-03 3 1  ON 9
ci_011                -1.061933e-02 3 1  ON 10
ci_012                -9.818114e-03 3 1  ON 11
ci_013                -1.993959e-02 3 1  ON 12
ci_014                 1.258198e-02 3 1  ON 13
ci_015                 1.252439e-02 3 1  ON 14
ci_016                 1.714498e-02 3 1  ON 15
ci_017                 1.631075e-02 3 1  ON 16
ci_018                 9.866816e-03 3 1  ON 17
ci_019                 1.001622e-02 3 1  ON 18
ci_020                 1.717628e-02 3 1  ON 19
ci_021                 1.701875e-02 3 1  ON 20
ci_022                 9.195071e-03 3 1  ON 21
ci_023                 9.441071e-03 3 1  ON 22
ci_024                 9.640203e-03 3 1  ON 23
ci_025                 9.438708e-03 3 1  ON 24
ci_026                 1.108745e-02 3 1  ON 25
ci_027                 1.154632e-02 3 1  ON 26
ci_028                -1.497265e-02 3 1  ON 27
ci_029                -1.552563e-02 3 1  ON 28
ci_030                -9.428197e-03 3 1  ON 29
ci_031                -9.017940e-03 3 1  ON 30
ci_032                -1.486184e-02 3 1  ON 31
ci_033                 5.714605e-03 3 1  ON 32
ci_034                 5.612860e-03 3 1  ON 33
ci_035                -5.050214e-03 3 1  ON 34
ci_036                -1.252744e-02 3 1  ON 35
ci_037                -1.250267e-02 3 1  ON 36
ci_038                 1.764544e-03 3 1  ON 37
ci_039                 1.723100e-03 3 1  ON 38
ci_040                -3.025898e-03 3 1  ON 39
ci_041                 8.798542e-03 3 1  ON 40
ci_042                 8.889745e-03 3 1  ON 41
ci_043                -4.005767e-03 3 1  ON 42
ci_044                -4.073583e-03 3 1  ON 43
ci_045                -3.232510e-03 3 1  ON 44
ci_046                 5.728273e-03 3 1  ON 45
ci_047                 5.622390e-03 3 1  ON 46
ci_048                -1.250444e-02 3 1  ON 47
ci_049                -1.364306e-02 3 1  ON 48
ci_050                 3.419440e-03 3 1  ON 49
ci_051                 3.226738e-03 3 1  ON 50
ci_052                -2.261983e-03 3 1  ON 51
ci_053                -2.409788e-03 3 1  ON 52
ci_054                -2.898652e-03 3 1  ON 53
ci_055                -2.922157e-03 3 1  ON 54
ci_056                 5.322395e-03 3 1  ON 55
ci_057                 5.148951e-03 3 1  ON 56
ci_058                -1.691284e-03 3 1  ON 57
ci_059                -1.994348e-03 3 1  ON 58
ci_060                 4.939037e-03 3 1  ON 59
ci_061                 5.531449e-03 3 1  ON 60
ci_062                -3.592776e-03 3 1  ON 61
ci_063                -4.117870e-03 3 1  ON 62
ci_064                -3.014581e-03 3 1  ON 63
ci_065                -4.339766e-03 3 1  ON 64
ci_066                 4.505494e-03 3 1  ON 65
ci_067                 4.315226e-03 3 1  ON 66
ci_068                -4.327803e-03 3 1  ON 67
ci_069                -4.841657e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9861e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s093 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s093 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=93  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.1987
    reference variance = 0.195543
====================================================
  Execution time = 1.4247e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s093
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5279e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8135e-01
  Total weights = 1.957259757e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4842e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268696089105
                                         uncertainty =       0.001624856536

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268696089105
                                         uncertainty =       0.001624856536

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366502658
  error estimate for blocks of size 2^( 2) =       0.000380461868
  error estimate for blocks of size 2^( 3) =       0.000392853292
  error estimate for blocks of size 2^( 4) =       0.000401704945
  error estimate for blocks of size 2^( 5) =       0.000408555107
  error estimate for blocks of size 2^( 6) =       0.000413551352
  error estimate for blocks of size 2^( 7) =       0.000415472448

      target function =      -0.942620379355
              le_mean =     -17.212295444399
             les_mean =     296.544466505350
             stat err =       0.000409820963
             autocorr =       1.250357154345
   target nu stat err =       0.000409820963
   target dn stat err =       0.002398729032
      target stat err =       0.004078231680
              std dev =       0.518313029016
             le_variance =       0.268648396047


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721229544440e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.4210e+02, overlap shift 5.4210e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942637191111       residual = 9.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942637272167       residual = 6.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942637280296       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942637282558       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942637282719       residual = 9.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942637282612       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942637282676       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942637282647       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942637282644       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942637282653       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+02 is 2.231377e-07

solving harmonic davidson linear method for identity shift 2.1684e+03, overlap shift 2.1684e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942637191111       residual = 9.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942637211377       residual = 6.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942637213409       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942637213976       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942637214013       residual = 9.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942637213987       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942637214003       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942637213997       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942637213995       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942637213998       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+03 is 5.578998e-08

solving harmonic davidson linear method for identity shift 8.6736e+03, overlap shift 8.6736e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942637191111       residual = 9.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942637196177       residual = 6.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942637196685       residual = 2.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942637196827       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942637196817       residual = 9.45e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942637196827       residual = 1.36e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942637196834       residual = 2.67e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942637196828       residual = 7.83e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942637196831       residual = 1.59e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942637196836       residual = 3.18e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.6736e+03 is 1.394784e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.341081 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6740e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
ci_001                -4.146501e-02 3 1  ON 0
ci_002                -3.159583e-02 3 1  ON 1
ci_003                -2.620143e-02 3 1  ON 2
ci_004                 2.368451e-02 3 1  ON 3
ci_005                 2.384922e-02 3 1  ON 4
ci_006                -2.092871e-02 3 1  ON 5
ci_007                -2.044047e-02 3 1  ON 6
ci_008                -8.592858e-03 3 1  ON 7
ci_009                -1.432683e-02 3 1  ON 8
ci_010                -9.617707e-03 3 1  ON 9
ci_011                -1.061930e-02 3 1  ON 10
ci_012                -9.818090e-03 3 1  ON 11
ci_013                -1.993956e-02 3 1  ON 12
ci_014                 1.258195e-02 3 1  ON 13
ci_015                 1.252439e-02 3 1  ON 14
ci_016                 1.714497e-02 3 1  ON 15
ci_017                 1.631073e-02 3 1  ON 16
ci_018                 9.866824e-03 3 1  ON 17
ci_019                 1.001626e-02 3 1  ON 18
ci_020                 1.717623e-02 3 1  ON 19
ci_021                 1.701873e-02 3 1  ON 20
ci_022                 9.195068e-03 3 1  ON 21
ci_023                 9.441082e-03 3 1  ON 22
ci_024                 9.640194e-03 3 1  ON 23
ci_025                 9.438726e-03 3 1  ON 24
ci_026                 1.108742e-02 3 1  ON 25
ci_027                 1.154630e-02 3 1  ON 26
ci_028                -1.497267e-02 3 1  ON 27
ci_029                -1.552560e-02 3 1  ON 28
ci_030                -9.428160e-03 3 1  ON 29
ci_031                -9.017934e-03 3 1  ON 30
ci_032                -1.486186e-02 3 1  ON 31
ci_033                 5.714635e-03 3 1  ON 32
ci_034                 5.612890e-03 3 1  ON 33
ci_035                -5.050222e-03 3 1  ON 34
ci_036                -1.252742e-02 3 1  ON 35
ci_037                -1.250266e-02 3 1  ON 36
ci_038                 1.764519e-03 3 1  ON 37
ci_039                 1.723107e-03 3 1  ON 38
ci_040                -3.025891e-03 3 1  ON 39
ci_041                 8.798518e-03 3 1  ON 40
ci_042                 8.889719e-03 3 1  ON 41
ci_043                -4.005765e-03 3 1  ON 42
ci_044                -4.073591e-03 3 1  ON 43
ci_045                -3.232497e-03 3 1  ON 44
ci_046                 5.728274e-03 3 1  ON 45
ci_047                 5.622374e-03 3 1  ON 46
ci_048                -1.250447e-02 3 1  ON 47
ci_049                -1.364307e-02 3 1  ON 48
ci_050                 3.419444e-03 3 1  ON 49
ci_051                 3.226727e-03 3 1  ON 50
ci_052                -2.261999e-03 3 1  ON 51
ci_053                -2.409785e-03 3 1  ON 52
ci_054                -2.898651e-03 3 1  ON 53
ci_055                -2.922158e-03 3 1  ON 54
ci_056                 5.322380e-03 3 1  ON 55
ci_057                 5.148952e-03 3 1  ON 56
ci_058                -1.691323e-03 3 1  ON 57
ci_059                -1.994320e-03 3 1  ON 58
ci_060                 4.939064e-03 3 1  ON 59
ci_061                 5.531430e-03 3 1  ON 60
ci_062                -3.592782e-03 3 1  ON 61
ci_063                -4.117841e-03 3 1  ON 62
ci_064                -3.014582e-03 3 1  ON 63
ci_065                -4.339759e-03 3 1  ON 64
ci_066                 4.505458e-03 3 1  ON 65
ci_067                 4.315243e-03 3 1  ON 66
ci_068                -4.327792e-03 3 1  ON 67
ci_069                -4.841627e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 93
    time step          = 0.05
    reference energy   = -17.288
    reference variance = 0.306253
====================================================
  Execution time = 1.3930e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s093
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7946e-01
  Total weights = 1.9574e+06
  Execution time = 1.8450e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268831642126
                                         uncertainty =       0.001629441058

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268831642126
                                         uncertainty =       0.001629441058

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366612385
  error estimate for blocks of size 2^( 2) =       0.000380507563
  error estimate for blocks of size 2^( 3) =       0.000392973665
  error estimate for blocks of size 2^( 4) =       0.000402223082
  error estimate for blocks of size 2^( 5) =       0.000408192261
  error estimate for blocks of size 2^( 6) =       0.000409416197
  error estimate for blocks of size 2^( 7) =       0.000412253972

      target function =      -0.945787094528
              le_mean =     -17.212170807634
             les_mean =     296.538287465784
             stat err =       0.000408021378
             autocorr =       1.238658454533
   target nu stat err =       0.000408021378
   target dn stat err =       0.002552838898
      target stat err =       0.004359351188
              std dev =       0.518468207198
             le_variance =       0.268809281875

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268831609501
                                         uncertainty =       0.001629439178

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268831609501
                                         uncertainty =       0.001629439178

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366612363
  error estimate for blocks of size 2^( 2) =       0.000380507549
  error estimate for blocks of size 2^( 3) =       0.000392973662
  error estimate for blocks of size 2^( 4) =       0.000402223091
  error estimate for blocks of size 2^( 5) =       0.000408192268
  error estimate for blocks of size 2^( 6) =       0.000409416208
  error estimate for blocks of size 2^( 7) =       0.000412253989

      target function =      -0.945787649678
              le_mean =     -17.212170808403
             les_mean =     296.538287164168
             stat err =       0.000408021389
             autocorr =       1.238658672820
   target nu stat err =       0.000408021389
   target dn stat err =       0.002552661902
      target stat err =       0.004359062378
              std dev =       0.518468175641
             le_variance =       0.268809249152

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268831625810
                                         uncertainty =       0.001629440118

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268831625810
                                         uncertainty =       0.001629440118

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366612374
  error estimate for blocks of size 2^( 2) =       0.000380507556
  error estimate for blocks of size 2^( 3) =       0.000392973663
  error estimate for blocks of size 2^( 4) =       0.000402223087
  error estimate for blocks of size 2^( 5) =       0.000408192264
  error estimate for blocks of size 2^( 6) =       0.000409416202
  error estimate for blocks of size 2^( 7) =       0.000412253981

      target function =      -0.945787375095
              le_mean =     -17.212170808018
             les_mean =     296.538287313190
             stat err =       0.000408021383
             autocorr =       1.238658563691
   target nu stat err =       0.000408021383
   target dn stat err =       0.002552750375
      target stat err =       0.004359206769
              std dev =       0.518468191415
             le_variance =       0.268809265510

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268831640087
                                         uncertainty =       0.001629440940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268831640087
                                         uncertainty =       0.001629440940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366612384
  error estimate for blocks of size 2^( 2) =       0.000380507562
  error estimate for blocks of size 2^( 3) =       0.000392973664
  error estimate for blocks of size 2^( 4) =       0.000402223083
  error estimate for blocks of size 2^( 5) =       0.000408192261
  error estimate for blocks of size 2^( 6) =       0.000409416197
  error estimate for blocks of size 2^( 7) =       0.000412253973

      target function =      -0.945787129938
              le_mean =     -17.212170807682
             les_mean =     296.538287446508
             stat err =       0.000408021379
             autocorr =       1.238658468178
   target nu stat err =       0.000408021379
   target dn stat err =       0.002552827830
      target stat err =       0.004359333136
              std dev =       0.518468205224
             le_variance =       0.268809279829


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945787094528        initial
     5.4210e+02     5.4210e+03             2.2314e-07        -0.945787649678  <--
     2.1684e+03     2.1684e+04             5.5790e-08        -0.945787375095
     8.6736e+03     8.6736e+04             1.3948e-08        -0.945787129938

*****************************************************************************
Applying the update for shift_i =   5.4210e+02     and shift_s =   5.4210e+03
*****************************************************************************

  Execution time = 2.3161e+01
  </log>
  <optVariables href="H2O.s093.opt.xml">
ci_001                -4.146490e-02 3 1  ON 0
ci_002                -3.159584e-02 3 1  ON 1
ci_003                -2.620144e-02 3 1  ON 2
ci_004                 2.368454e-02 3 1  ON 3
ci_005                 2.384916e-02 3 1  ON 4
ci_006                -2.092861e-02 3 1  ON 5
ci_007                -2.044051e-02 3 1  ON 6
ci_008                -8.592818e-03 3 1  ON 7
ci_009                -1.432685e-02 3 1  ON 8
ci_010                -9.617666e-03 3 1  ON 9
ci_011                -1.061921e-02 3 1  ON 10
ci_012                -9.818020e-03 3 1  ON 11
ci_013                -1.993947e-02 3 1  ON 12
ci_014                 1.258187e-02 3 1  ON 13
ci_015                 1.252438e-02 3 1  ON 14
ci_016                 1.714497e-02 3 1  ON 15
ci_017                 1.631070e-02 3 1  ON 16
ci_018                 9.866849e-03 3 1  ON 17
ci_019                 1.001640e-02 3 1  ON 18
ci_020                 1.717606e-02 3 1  ON 19
ci_021                 1.701869e-02 3 1  ON 20
ci_022                 9.195060e-03 3 1  ON 21
ci_023                 9.441118e-03 3 1  ON 22
ci_024                 9.640167e-03 3 1  ON 23
ci_025                 9.438777e-03 3 1  ON 24
ci_026                 1.108734e-02 3 1  ON 25
ci_027                 1.154627e-02 3 1  ON 26
ci_028                -1.497272e-02 3 1  ON 27
ci_029                -1.552549e-02 3 1  ON 28
ci_030                -9.428050e-03 3 1  ON 29
ci_031                -9.017919e-03 3 1  ON 30
ci_032                -1.486193e-02 3 1  ON 31
ci_033                 5.714722e-03 3 1  ON 32
ci_034                 5.612981e-03 3 1  ON 33
ci_035                -5.050246e-03 3 1  ON 34
ci_036                -1.252735e-02 3 1  ON 35
ci_037                -1.250261e-02 3 1  ON 36
ci_038                 1.764445e-03 3 1  ON 37
ci_039                 1.723128e-03 3 1  ON 38
ci_040                -3.025867e-03 3 1  ON 39
ci_041                 8.798445e-03 3 1  ON 40
ci_042                 8.889639e-03 3 1  ON 41
ci_043                -4.005761e-03 3 1  ON 42
ci_044                -4.073614e-03 3 1  ON 43
ci_045                -3.232458e-03 3 1  ON 44
ci_046                 5.728279e-03 3 1  ON 45
ci_047                 5.622327e-03 3 1  ON 46
ci_048                -1.250456e-02 3 1  ON 47
ci_049                -1.364310e-02 3 1  ON 48
ci_050                 3.419454e-03 3 1  ON 49
ci_051                 3.226695e-03 3 1  ON 50
ci_052                -2.262048e-03 3 1  ON 51
ci_053                -2.409775e-03 3 1  ON 52
ci_054                -2.898649e-03 3 1  ON 53
ci_055                -2.922163e-03 3 1  ON 54
ci_056                 5.322336e-03 3 1  ON 55
ci_057                 5.148955e-03 3 1  ON 56
ci_058                -1.691440e-03 3 1  ON 57
ci_059                -1.994235e-03 3 1  ON 58
ci_060                 4.939146e-03 3 1  ON 59
ci_061                 5.531372e-03 3 1  ON 60
ci_062                -3.592800e-03 3 1  ON 61
ci_063                -4.117754e-03 3 1  ON 62
ci_064                -3.014587e-03 3 1  ON 63
ci_065                -4.339738e-03 3 1  ON 64
ci_066                 4.505349e-03 3 1  ON 65
ci_067                 4.315294e-03 3 1  ON 66
ci_068                -4.327759e-03 3 1  ON 67
ci_069                -4.841535e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9910e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s094 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s094 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=94  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.2664
    reference variance = 0.251374
====================================================
  Execution time = 1.4262e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s094
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5304e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7784e-01
  Total weights = 1.957300954e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4964e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267637697912
                                         uncertainty =       0.001395040147

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267637697912
                                         uncertainty =       0.001395040147

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365785407
  error estimate for blocks of size 2^( 2) =       0.000379527115
  error estimate for blocks of size 2^( 3) =       0.000392333679
  error estimate for blocks of size 2^( 4) =       0.000401164874
  error estimate for blocks of size 2^( 5) =       0.000406534865
  error estimate for blocks of size 2^( 6) =       0.000408931227
  error estimate for blocks of size 2^( 7) =       0.000411128708

      target function =      -0.948553355590
              le_mean =     -17.213022959495
             les_mean =     296.565995622145
             stat err =       0.000406939919
             autocorr =       1.237678473539
   target nu stat err =       0.000406939919
   target dn stat err =       0.001997867492
      target stat err =       0.003466331221
              std dev =       0.517298683161
             le_variance =       0.267597927600


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721302295950e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.3553e+02, overlap shift 1.3553e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948564908219       residual = 7.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948565122468       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948565176666       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948565186788       residual = 5.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948565188956       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948565188837       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948565188624       residual = 3.88e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948565188696       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948565188656       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948565188678       residual = 4.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+02 is 9.409648e-07

solving harmonic davidson linear method for identity shift 5.4210e+02, overlap shift 5.4210e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948564908219       residual = 7.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948564961805       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948564975359       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948564977890       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948564978432       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948564978402       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948564978348       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948564978367       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948564978357       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948564978363       residual = 4.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+02 is 2.353315e-07

solving harmonic davidson linear method for identity shift 2.1684e+03, overlap shift 2.1684e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948564908219       residual = 7.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948564921617       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948564925005       residual = 3.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948564925638       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948564925774       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948564925766       residual = 2.46e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948564925753       residual = 3.87e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948564925755       residual = 1.14e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948564925754       residual = 2.81e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948564925756       residual = 4.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1684e+03 is 5.883852e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.344556 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6767e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
ci_001                -4.146486e-02 3 1  ON 0
ci_002                -3.159596e-02 3 1  ON 1
ci_003                -2.620146e-02 3 1  ON 2
ci_004                 2.368443e-02 3 1  ON 3
ci_005                 2.384908e-02 3 1  ON 4
ci_006                -2.092859e-02 3 1  ON 5
ci_007                -2.044049e-02 3 1  ON 6
ci_008                -8.592830e-03 3 1  ON 7
ci_009                -1.432682e-02 3 1  ON 8
ci_010                -9.617635e-03 3 1  ON 9
ci_011                -1.061931e-02 3 1  ON 10
ci_012                -9.818125e-03 3 1  ON 11
ci_013                -1.993937e-02 3 1  ON 12
ci_014                 1.258185e-02 3 1  ON 13
ci_015                 1.252444e-02 3 1  ON 14
ci_016                 1.714488e-02 3 1  ON 15
ci_017                 1.631075e-02 3 1  ON 16
ci_018                 9.866846e-03 3 1  ON 17
ci_019                 1.001631e-02 3 1  ON 18
ci_020                 1.717612e-02 3 1  ON 19
ci_021                 1.701861e-02 3 1  ON 20
ci_022                 9.195021e-03 3 1  ON 21
ci_023                 9.440961e-03 3 1  ON 22
ci_024                 9.639932e-03 3 1  ON 23
ci_025                 9.438920e-03 3 1  ON 24
ci_026                 1.108726e-02 3 1  ON 25
ci_027                 1.154614e-02 3 1  ON 26
ci_028                -1.497277e-02 3 1  ON 27
ci_029                -1.552550e-02 3 1  ON 28
ci_030                -9.427921e-03 3 1  ON 29
ci_031                -9.017969e-03 3 1  ON 30
ci_032                -1.486199e-02 3 1  ON 31
ci_033                 5.714873e-03 3 1  ON 32
ci_034                 5.613117e-03 3 1  ON 33
ci_035                -5.050208e-03 3 1  ON 34
ci_036                -1.252733e-02 3 1  ON 35
ci_037                -1.250272e-02 3 1  ON 36
ci_038                 1.764340e-03 3 1  ON 37
ci_039                 1.723193e-03 3 1  ON 38
ci_040                -3.025853e-03 3 1  ON 39
ci_041                 8.798389e-03 3 1  ON 40
ci_042                 8.889607e-03 3 1  ON 41
ci_043                -4.005754e-03 3 1  ON 42
ci_044                -4.073389e-03 3 1  ON 43
ci_045                -3.232475e-03 3 1  ON 44
ci_046                 5.728365e-03 3 1  ON 45
ci_047                 5.622315e-03 3 1  ON 46
ci_048                -1.250438e-02 3 1  ON 47
ci_049                -1.364310e-02 3 1  ON 48
ci_050                 3.419570e-03 3 1  ON 49
ci_051                 3.226570e-03 3 1  ON 50
ci_052                -2.262114e-03 3 1  ON 51
ci_053                -2.409761e-03 3 1  ON 52
ci_054                -2.898656e-03 3 1  ON 53
ci_055                -2.922148e-03 3 1  ON 54
ci_056                 5.322261e-03 3 1  ON 55
ci_057                 5.148942e-03 3 1  ON 56
ci_058                -1.691377e-03 3 1  ON 57
ci_059                -1.994217e-03 3 1  ON 58
ci_060                 4.939154e-03 3 1  ON 59
ci_061                 5.531226e-03 3 1  ON 60
ci_062                -3.592886e-03 3 1  ON 61
ci_063                -4.117738e-03 3 1  ON 62
ci_064                -3.014633e-03 3 1  ON 63
ci_065                -4.339732e-03 3 1  ON 64
ci_066                 4.505382e-03 3 1  ON 65
ci_067                 4.315399e-03 3 1  ON 66
ci_068                -4.327773e-03 3 1  ON 67
ci_069                -4.841433e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 94
    time step          = 0.05
    reference energy   = -17.1628
    reference variance = 0.218319
====================================================
  Execution time = 1.5973e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s094
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8150e-01
  Total weights = 1.9574e+06
  Execution time = 1.8257e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268471747819
                                         uncertainty =       0.001611796346

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268471747819
                                         uncertainty =       0.001611796346

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366488636
  error estimate for blocks of size 2^( 2) =       0.000380136596
  error estimate for blocks of size 2^( 3) =       0.000392940979
  error estimate for blocks of size 2^( 4) =       0.000402660830
  error estimate for blocks of size 2^( 5) =       0.000408726321
  error estimate for blocks of size 2^( 6) =       0.000410268757
  error estimate for blocks of size 2^( 7) =       0.000412993242

      target function =      -0.942364669762
              le_mean =     -17.211968850718
             les_mean =     296.533374045923
             stat err =       0.000408662288
             autocorr =       1.243392080358
   target nu stat err =       0.000408662288
   target dn stat err =       0.002658823648
      target stat err =       0.004501542813
              std dev =       0.518293200172
             le_variance =       0.268627841345

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268471834221
                                         uncertainty =       0.001611874431

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268471834221
                                         uncertainty =       0.001611874431

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366488695
  error estimate for blocks of size 2^( 2) =       0.000380136680
  error estimate for blocks of size 2^( 3) =       0.000392941073
  error estimate for blocks of size 2^( 4) =       0.000402660924
  error estimate for blocks of size 2^( 5) =       0.000408726400
  error estimate for blocks of size 2^( 6) =       0.000410268834
  error estimate for blocks of size 2^( 7) =       0.000412993329

      target function =      -0.942365246215
              le_mean =     -17.211968850890
             les_mean =     296.533373706221
             stat err =       0.000408662372
             autocorr =       1.243392194729
   target nu stat err =       0.000408662372
   target dn stat err =       0.002658889763
      target stat err =       0.004501657315
              std dev =       0.518293283263
             le_variance =       0.268627927475

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268471790995
                                         uncertainty =       0.001611835399

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268471790995
                                         uncertainty =       0.001611835399

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366488666
  error estimate for blocks of size 2^( 2) =       0.000380136638
  error estimate for blocks of size 2^( 3) =       0.000392941026
  error estimate for blocks of size 2^( 4) =       0.000402660877
  error estimate for blocks of size 2^( 5) =       0.000408726361
  error estimate for blocks of size 2^( 6) =       0.000410268796
  error estimate for blocks of size 2^( 7) =       0.000412993285

      target function =      -0.942364977550
              le_mean =     -17.211968850799
             les_mean =     296.533373864193
             stat err =       0.000408662330
             autocorr =       1.243392137613
   target nu stat err =       0.000408662330
   target dn stat err =       0.002658856416
      target stat err =       0.004501599771
              std dev =       0.518293241694
             le_variance =       0.268627884385

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268471753211
                                         uncertainty =       0.001611801227

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268471753211
                                         uncertainty =       0.001611801227

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366488640
  error estimate for blocks of size 2^( 2) =       0.000380136601
  error estimate for blocks of size 2^( 3) =       0.000392940985
  error estimate for blocks of size 2^( 4) =       0.000402660836
  error estimate for blocks of size 2^( 5) =       0.000408726326
  error estimate for blocks of size 2^( 6) =       0.000410268762
  error estimate for blocks of size 2^( 7) =       0.000412993247

      target function =      -0.942364710537
              le_mean =     -17.211968850728
             les_mean =     296.533374021811
             stat err =       0.000408662293
             autocorr =       1.243392087525
   target nu stat err =       0.000408662293
   target dn stat err =       0.002658827711
      target stat err =       0.004501549900
              std dev =       0.518293205358
             le_variance =       0.268627846720


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942364669762        initial
     1.3553e+02     1.3553e+03             9.4096e-07        -0.942365246215  <--
     5.4210e+02     5.4210e+03             2.3533e-07        -0.942364977550
     2.1684e+03     2.1684e+04             5.8839e-08        -0.942364710537

*****************************************************************************
Applying the update for shift_i =   1.3553e+02     and shift_s =   1.3553e+03
*****************************************************************************

  Execution time = 2.5182e+01
  </log>
  <optVariables href="H2O.s094.opt.xml">
ci_001                -4.146474e-02 3 1  ON 0
ci_002                -3.159630e-02 3 1  ON 1
ci_003                -2.620155e-02 3 1  ON 2
ci_004                 2.368410e-02 3 1  ON 3
ci_005                 2.384887e-02 3 1  ON 4
ci_006                -2.092853e-02 3 1  ON 5
ci_007                -2.044041e-02 3 1  ON 6
ci_008                -8.592868e-03 3 1  ON 7
ci_009                -1.432671e-02 3 1  ON 8
ci_010                -9.617540e-03 3 1  ON 9
ci_011                -1.061960e-02 3 1  ON 10
ci_012                -9.818441e-03 3 1  ON 11
ci_013                -1.993908e-02 3 1  ON 12
ci_014                 1.258181e-02 3 1  ON 13
ci_015                 1.252465e-02 3 1  ON 14
ci_016                 1.714460e-02 3 1  ON 15
ci_017                 1.631092e-02 3 1  ON 16
ci_018                 9.866837e-03 3 1  ON 17
ci_019                 1.001606e-02 3 1  ON 18
ci_020                 1.717631e-02 3 1  ON 19
ci_021                 1.701837e-02 3 1  ON 20
ci_022                 9.194906e-03 3 1  ON 21
ci_023                 9.440490e-03 3 1  ON 22
ci_024                 9.639226e-03 3 1  ON 23
ci_025                 9.439349e-03 3 1  ON 24
ci_026                 1.108703e-02 3 1  ON 25
ci_027                 1.154577e-02 3 1  ON 26
ci_028                -1.497290e-02 3 1  ON 27
ci_029                -1.552554e-02 3 1  ON 28
ci_030                -9.427536e-03 3 1  ON 29
ci_031                -9.018118e-03 3 1  ON 30
ci_032                -1.486214e-02 3 1  ON 31
ci_033                 5.715328e-03 3 1  ON 32
ci_034                 5.613527e-03 3 1  ON 33
ci_035                -5.050091e-03 3 1  ON 34
ci_036                -1.252728e-02 3 1  ON 35
ci_037                -1.250302e-02 3 1  ON 36
ci_038                 1.764025e-03 3 1  ON 37
ci_039                 1.723390e-03 3 1  ON 38
ci_040                -3.025809e-03 3 1  ON 39
ci_041                 8.798221e-03 3 1  ON 40
ci_042                 8.889511e-03 3 1  ON 41
ci_043                -4.005734e-03 3 1  ON 42
ci_044                -4.072714e-03 3 1  ON 43
ci_045                -3.232523e-03 3 1  ON 44
ci_046                 5.728626e-03 3 1  ON 45
ci_047                 5.622278e-03 3 1  ON 46
ci_048                -1.250381e-02 3 1  ON 47
ci_049                -1.364310e-02 3 1  ON 48
ci_050                 3.419915e-03 3 1  ON 49
ci_051                 3.226194e-03 3 1  ON 50
ci_052                -2.262314e-03 3 1  ON 51
ci_053                -2.409718e-03 3 1  ON 52
ci_054                -2.898677e-03 3 1  ON 53
ci_055                -2.922102e-03 3 1  ON 54
ci_056                 5.322038e-03 3 1  ON 55
ci_057                 5.148904e-03 3 1  ON 56
ci_058                -1.691189e-03 3 1  ON 57
ci_059                -1.994165e-03 3 1  ON 58
ci_060                 4.939176e-03 3 1  ON 59
ci_061                 5.530787e-03 3 1  ON 60
ci_062                -3.593145e-03 3 1  ON 61
ci_063                -4.117690e-03 3 1  ON 62
ci_064                -3.014772e-03 3 1  ON 63
ci_065                -4.339714e-03 3 1  ON 64
ci_066                 4.505479e-03 3 1  ON 65
ci_067                 4.315716e-03 3 1  ON 66
ci_068                -4.327815e-03 3 1  ON 67
ci_069                -4.841128e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.1953e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s095 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s095 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=95  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7212e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.1644
    reference variance = 0.177582
====================================================
  Execution time = 1.4114e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s095
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7705e-01
  Total weights = 1.957433076e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4692e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265639111881
                                         uncertainty =       0.001501361451

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265639111881
                                         uncertainty =       0.001501361451

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364410492
  error estimate for blocks of size 2^( 2) =       0.000378411276
  error estimate for blocks of size 2^( 3) =       0.000391283703
  error estimate for blocks of size 2^( 4) =       0.000400561647
  error estimate for blocks of size 2^( 5) =       0.000405712816
  error estimate for blocks of size 2^( 6) =       0.000409008382
  error estimate for blocks of size 2^( 7) =       0.000410140765

      target function =      -0.949853114812
              le_mean =     -17.211348871997
             les_mean =     296.507583284471
             stat err =       0.000406355903
             autocorr =       1.243458800224
   target nu stat err =       0.000406355903
   target dn stat err =       0.002194526941
      target stat err =       0.003791200150
              std dev =       0.515354259878
             le_variance =       0.265590013175


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721134887200e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.3881e+01, overlap shift 3.3881e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949867218337       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949868438053       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949868645160       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949868691125       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949868693699       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949868692184       residual = 1.88e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949868692890       residual = 4.20e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949868692622       residual = 8.82e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949868692744       residual = 2.11e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949868692756       residual = 4.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+01 is 4.052068e-06

solving harmonic davidson linear method for identity shift 1.3553e+02, overlap shift 1.3553e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949867218337       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949867523832       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949867575679       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949867587179       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949867587823       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949867587442       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949867587619       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949867587552       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949867587583       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949867587586       residual = 4.62e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+02 is 1.014650e-06

solving harmonic davidson linear method for identity shift 5.4210e+02, overlap shift 5.4210e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949867218337       residual = 1.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949867294746       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949867307712       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949867310588       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949867310749       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949867310653       residual = 1.87e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949867310698       residual = 4.19e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949867310681       residual = 8.78e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949867310689       residual = 2.10e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949867310689       residual = 4.61e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 5.4210e+02 is 2.537647e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.348010 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6592e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
ci_001                -4.146423e-02 3 1  ON 0
ci_002                -3.159652e-02 3 1  ON 1
ci_003                -2.620108e-02 3 1  ON 2
ci_004                 2.368378e-02 3 1  ON 3
ci_005                 2.384843e-02 3 1  ON 4
ci_006                -2.092837e-02 3 1  ON 5
ci_007                -2.044042e-02 3 1  ON 6
ci_008                -8.592476e-03 3 1  ON 7
ci_009                -1.432679e-02 3 1  ON 8
ci_010                -9.617541e-03 3 1  ON 9
ci_011                -1.061954e-02 3 1  ON 10
ci_012                -9.817844e-03 3 1  ON 11
ci_013                -1.993880e-02 3 1  ON 12
ci_014                 1.258176e-02 3 1  ON 13
ci_015                 1.252465e-02 3 1  ON 14
ci_016                 1.714415e-02 3 1  ON 15
ci_017                 1.631107e-02 3 1  ON 16
ci_018                 9.866892e-03 3 1  ON 17
ci_019                 1.001604e-02 3 1  ON 18
ci_020                 1.717643e-02 3 1  ON 19
ci_021                 1.701815e-02 3 1  ON 20
ci_022                 9.195120e-03 3 1  ON 21
ci_023                 9.440363e-03 3 1  ON 22
ci_024                 9.638647e-03 3 1  ON 23
ci_025                 9.439645e-03 3 1  ON 24
ci_026                 1.108670e-02 3 1  ON 25
ci_027                 1.154575e-02 3 1  ON 26
ci_028                -1.497301e-02 3 1  ON 27
ci_029                -1.552555e-02 3 1  ON 28
ci_030                -9.427559e-03 3 1  ON 29
ci_031                -9.018068e-03 3 1  ON 30
ci_032                -1.486184e-02 3 1  ON 31
ci_033                 5.715947e-03 3 1  ON 32
ci_034                 5.612512e-03 3 1  ON 33
ci_035                -5.050274e-03 3 1  ON 34
ci_036                -1.252771e-02 3 1  ON 35
ci_037                -1.250326e-02 3 1  ON 36
ci_038                 1.763604e-03 3 1  ON 37
ci_039                 1.723302e-03 3 1  ON 38
ci_040                -3.025627e-03 3 1  ON 39
ci_041                 8.798241e-03 3 1  ON 40
ci_042                 8.889130e-03 3 1  ON 41
ci_043                -4.005701e-03 3 1  ON 42
ci_044                -4.072612e-03 3 1  ON 43
ci_045                -3.232333e-03 3 1  ON 44
ci_046                 5.728742e-03 3 1  ON 45
ci_047                 5.622473e-03 3 1  ON 46
ci_048                -1.250401e-02 3 1  ON 47
ci_049                -1.364296e-02 3 1  ON 48
ci_050                 3.420170e-03 3 1  ON 49
ci_051                 3.226574e-03 3 1  ON 50
ci_052                -2.262513e-03 3 1  ON 51
ci_053                -2.409973e-03 3 1  ON 52
ci_054                -2.898308e-03 3 1  ON 53
ci_055                -2.921860e-03 3 1  ON 54
ci_056                 5.321941e-03 3 1  ON 55
ci_057                 5.149215e-03 3 1  ON 56
ci_058                -1.691876e-03 3 1  ON 57
ci_059                -1.993936e-03 3 1  ON 58
ci_060                 4.938849e-03 3 1  ON 59
ci_061                 5.529994e-03 3 1  ON 60
ci_062                -3.593773e-03 3 1  ON 61
ci_063                -4.117336e-03 3 1  ON 62
ci_064                -3.014924e-03 3 1  ON 63
ci_065                -4.339782e-03 3 1  ON 64
ci_066                 4.505923e-03 3 1  ON 65
ci_067                 4.315536e-03 3 1  ON 66
ci_068                -4.328135e-03 3 1  ON 67
ci_069                -4.840930e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 95
    time step          = 0.05
    reference energy   = -17.1961
    reference variance = 0.202293
====================================================
  Execution time = 1.3743e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s095
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7490e-01
  Total weights = 1.9573e+06
  Execution time = 1.8907e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265224843839
                                         uncertainty =       0.001280308553

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265224843839
                                         uncertainty =       0.001280308553

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364153955
  error estimate for blocks of size 2^( 2) =       0.000378606168
  error estimate for blocks of size 2^( 3) =       0.000391291774
  error estimate for blocks of size 2^( 4) =       0.000400154168
  error estimate for blocks of size 2^( 5) =       0.000404571908
  error estimate for blocks of size 2^( 6) =       0.000407621779
  error estimate for blocks of size 2^( 7) =       0.000408825328

      target function =      -0.953529030506
              le_mean =     -17.212384614400
             les_mean =     296.541096738360
             stat err =       0.000405293296
             autocorr =       1.238707528034
   target nu stat err =       0.000405293296
   target dn stat err =       0.001616079315
      target stat err =       0.002861024404
              std dev =       0.514991462032
             le_variance =       0.265216205966

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265224398826
                                         uncertainty =       0.001280281707

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265224398826
                                         uncertainty =       0.001280281707

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364153648
  error estimate for blocks of size 2^( 2) =       0.000378605995
  error estimate for blocks of size 2^( 3) =       0.000391291720
  error estimate for blocks of size 2^( 4) =       0.000400154229
  error estimate for blocks of size 2^( 5) =       0.000404571956
  error estimate for blocks of size 2^( 6) =       0.000407621774
  error estimate for blocks of size 2^( 7) =       0.000408825568

      target function =      -0.953584929300
              le_mean =     -17.212384632149
             les_mean =     296.541064716146
             stat err =       0.000405293382
             autocorr =       1.238710142202
   target nu stat err =       0.000405293382
   target dn stat err =       0.001613641533
      target stat err =       0.002857312279
              std dev =       0.514991027866
             le_variance =       0.265215758782

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265224620434
                                         uncertainty =       0.001280295105

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265224620434
                                         uncertainty =       0.001280295105

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364153801
  error estimate for blocks of size 2^( 2) =       0.000378606081
  error estimate for blocks of size 2^( 3) =       0.000391291747
  error estimate for blocks of size 2^( 4) =       0.000400154198
  error estimate for blocks of size 2^( 5) =       0.000404571931
  error estimate for blocks of size 2^( 6) =       0.000407621776
  error estimate for blocks of size 2^( 7) =       0.000408825447

      target function =      -0.953559094141
              le_mean =     -17.212384623279
             les_mean =     296.541079492805
             stat err =       0.000405293338
             autocorr =       1.238708836706
   target nu stat err =       0.000405293338
   target dn stat err =       0.001614741356
      target stat err =       0.002858983521
              std dev =       0.514991244075
             le_variance =       0.265215981474

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265224815842
                                         uncertainty =       0.001280306871

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.265224815842
                                         uncertainty =       0.001280306871

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000364153936
  error estimate for blocks of size 2^( 2) =       0.000378606157
  error estimate for blocks of size 2^( 3) =       0.000391291771
  error estimate for blocks of size 2^( 4) =       0.000400154172
  error estimate for blocks of size 2^( 5) =       0.000404571911
  error estimate for blocks of size 2^( 6) =       0.000407621778
  error estimate for blocks of size 2^( 7) =       0.000408825343

      target function =      -0.953533051774
              le_mean =     -17.212384615510
             les_mean =     296.541094428900
             stat err =       0.000405293301
             autocorr =       1.238707691634
   target nu stat err =       0.000405293301
   target dn stat err =       0.001615896775
      target stat err =       0.002860745506
              std dev =       0.514991434718
             le_variance =       0.265216177833


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.953529030506        initial
     3.3881e+01     3.3881e+02             4.0521e-06        -0.953584929300  <--
     1.3553e+02     1.3553e+03             1.0146e-06        -0.953559094141
     5.4210e+02     5.4210e+03             2.5376e-07        -0.953533051774

*****************************************************************************
Applying the update for shift_i =   3.3881e+01     and shift_s =   3.3881e+02
*****************************************************************************

  Execution time = 2.3055e+01
  </log>
  <optVariables href="H2O.s095.opt.xml">
ci_001                -4.146270e-02 3 1  ON 0
ci_002                -3.159718e-02 3 1  ON 1
ci_003                -2.619966e-02 3 1  ON 2
ci_004                 2.368280e-02 3 1  ON 3
ci_005                 2.384713e-02 3 1  ON 4
ci_006                -2.092787e-02 3 1  ON 5
ci_007                -2.044043e-02 3 1  ON 6
ci_008                -8.591303e-03 3 1  ON 7
ci_009                -1.432704e-02 3 1  ON 8
ci_010                -9.617543e-03 3 1  ON 9
ci_011                -1.061936e-02 3 1  ON 10
ci_012                -9.816059e-03 3 1  ON 11
ci_013                -1.993794e-02 3 1  ON 12
ci_014                 1.258161e-02 3 1  ON 13
ci_015                 1.252465e-02 3 1  ON 14
ci_016                 1.714281e-02 3 1  ON 15
ci_017                 1.631152e-02 3 1  ON 16
ci_018                 9.867059e-03 3 1  ON 17
ci_019                 1.001597e-02 3 1  ON 18
ci_020                 1.717679e-02 3 1  ON 19
ci_021                 1.701748e-02 3 1  ON 20
ci_022                 9.195760e-03 3 1  ON 21
ci_023                 9.439983e-03 3 1  ON 22
ci_024                 9.636914e-03 3 1  ON 23
ci_025                 9.440531e-03 3 1  ON 24
ci_026                 1.108571e-02 3 1  ON 25
ci_027                 1.154566e-02 3 1  ON 26
ci_028                -1.497333e-02 3 1  ON 27
ci_029                -1.552559e-02 3 1  ON 28
ci_030                -9.427630e-03 3 1  ON 29
ci_031                -9.017917e-03 3 1  ON 30
ci_032                -1.486093e-02 3 1  ON 31
ci_033                 5.717800e-03 3 1  ON 32
ci_034                 5.609475e-03 3 1  ON 33
ci_035                -5.050823e-03 3 1  ON 34
ci_036                -1.252901e-02 3 1  ON 35
ci_037                -1.250398e-02 3 1  ON 36
ci_038                 1.762344e-03 3 1  ON 37
ci_039                 1.723039e-03 3 1  ON 38
ci_040                -3.025080e-03 3 1  ON 39
ci_041                 8.798301e-03 3 1  ON 40
ci_042                 8.887990e-03 3 1  ON 41
ci_043                -4.005603e-03 3 1  ON 42
ci_044                -4.072309e-03 3 1  ON 43
ci_045                -3.231763e-03 3 1  ON 44
ci_046                 5.729087e-03 3 1  ON 45
ci_047                 5.623058e-03 3 1  ON 46
ci_048                -1.250461e-02 3 1  ON 47
ci_049                -1.364255e-02 3 1  ON 48
ci_050                 3.420935e-03 3 1  ON 49
ci_051                 3.227713e-03 3 1  ON 50
ci_052                -2.263109e-03 3 1  ON 51
ci_053                -2.410738e-03 3 1  ON 52
ci_054                -2.897204e-03 3 1  ON 53
ci_055                -2.921136e-03 3 1  ON 54
ci_056                 5.321653e-03 3 1  ON 55
ci_057                 5.150148e-03 3 1  ON 56
ci_058                -1.693930e-03 3 1  ON 57
ci_059                -1.993250e-03 3 1  ON 58
ci_060                 4.937872e-03 3 1  ON 59
ci_061                 5.527620e-03 3 1  ON 60
ci_062                -3.595652e-03 3 1  ON 61
ci_063                -4.116278e-03 3 1  ON 62
ci_064                -3.015378e-03 3 1  ON 63
ci_065                -4.339987e-03 3 1  ON 64
ci_066                 4.507252e-03 3 1  ON 65
ci_067                 4.314998e-03 3 1  ON 66
ci_068                -4.329095e-03 3 1  ON 67
ci_069                -4.840340e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9652e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s096 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s096 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=96  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.1787
    reference variance = 0.267943
====================================================
  Execution time = 1.4328e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s096
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5290e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7973e-01
  Total weights = 1.957139166e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4624e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267985099151
                                         uncertainty =       0.001865390618

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267985099151
                                         uncertainty =       0.001865390618

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366037536
  error estimate for blocks of size 2^( 2) =       0.000380022976
  error estimate for blocks of size 2^( 3) =       0.000392784904
  error estimate for blocks of size 2^( 4) =       0.000401325427
  error estimate for blocks of size 2^( 5) =       0.000407921491
  error estimate for blocks of size 2^( 6) =       0.000412894779
  error estimate for blocks of size 2^( 7) =       0.000413669719

      target function =      -0.945329792914
              le_mean =     -17.211198027651
             les_mean =     296.505069843552
             stat err =       0.000408952854
             autocorr =       1.248231796042
   target nu stat err =       0.000408952854
   target dn stat err =       0.002251817253
      target stat err =       0.003850087365
              std dev =       0.517655247064
             le_variance =       0.267966954813


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721119802765e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+00, overlap shift 8.4703e+01 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945344462408       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945351452271       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945352319562       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945352522414       residual = 7.71e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945352557480       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945352565844       residual = 4.58e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945352555930       residual = 5.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945352559477       residual = 9.51e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945352559470       residual = 2.07e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945352559405       residual = 4.22e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+00 is 1.942944e-05

solving harmonic davidson linear method for identity shift 3.3881e+01, overlap shift 3.3881e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945344462408       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945346222635       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945346440672       residual = 4.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945346491551       residual = 7.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945346500317       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945346502414       residual = 4.54e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945346499927       residual = 5.31e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945346500814       residual = 9.37e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945346500812       residual = 2.03e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945346500796       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+01 is 4.886381e-06

solving harmonic davidson linear method for identity shift 1.3553e+02, overlap shift 1.3553e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945344462408       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945344903270       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945344957855       residual = 4.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945344970585       residual = 7.67e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945344972777       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945344973302       residual = 4.53e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945344972679       residual = 5.29e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945344972901       residual = 9.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945344972901       residual = 2.02e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945344972896       residual = 4.12e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+02 is 1.223423e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.351624 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6801e+01
  </log>
  <optVariables href="H2O.s096.opt.xml">
ci_001                -4.146336e-02 3 1  ON 0
ci_002                -3.159693e-02 3 1  ON 1
ci_003                -2.619701e-02 3 1  ON 2
ci_004                 2.367972e-02 3 1  ON 3
ci_005                 2.384784e-02 3 1  ON 4
ci_006                -2.092708e-02 3 1  ON 5
ci_007                -2.044090e-02 3 1  ON 6
ci_008                -8.591630e-03 3 1  ON 7
ci_009                -1.432653e-02 3 1  ON 8
ci_010                -9.616089e-03 3 1  ON 9
ci_011                -1.061604e-02 3 1  ON 10
ci_012                -9.816053e-03 3 1  ON 11
ci_013                -1.993737e-02 3 1  ON 12
ci_014                 1.257962e-02 3 1  ON 13
ci_015                 1.252575e-02 3 1  ON 14
ci_016                 1.714273e-02 3 1  ON 15
ci_017                 1.631010e-02 3 1  ON 16
ci_018                 9.868132e-03 3 1  ON 17
ci_019                 1.001741e-02 3 1  ON 18
ci_020                 1.717570e-02 3 1  ON 19
ci_021                 1.701711e-02 3 1  ON 20
ci_022                 9.192964e-03 3 1  ON 21
ci_023                 9.440142e-03 3 1  ON 22
ci_024                 9.636057e-03 3 1  ON 23
ci_025                 9.435645e-03 3 1  ON 24
ci_026                 1.108737e-02 3 1  ON 25
ci_027                 1.154577e-02 3 1  ON 26
ci_028                -1.497229e-02 3 1  ON 27
ci_029                -1.552371e-02 3 1  ON 28
ci_030                -9.427042e-03 3 1  ON 29
ci_031                -9.014433e-03 3 1  ON 30
ci_032                -1.486145e-02 3 1  ON 31
ci_033                 5.715108e-03 3 1  ON 32
ci_034                 5.611636e-03 3 1  ON 33
ci_035                -5.050130e-03 3 1  ON 34
ci_036                -1.252973e-02 3 1  ON 35
ci_037                -1.250595e-02 3 1  ON 36
ci_038                 1.763088e-03 3 1  ON 37
ci_039                 1.722554e-03 3 1  ON 38
ci_040                -3.022919e-03 3 1  ON 39
ci_041                 8.799816e-03 3 1  ON 40
ci_042                 8.888251e-03 3 1  ON 41
ci_043                -4.005147e-03 3 1  ON 42
ci_044                -4.072628e-03 3 1  ON 43
ci_045                -3.231436e-03 3 1  ON 44
ci_046                 5.729252e-03 3 1  ON 45
ci_047                 5.623544e-03 3 1  ON 46
ci_048                -1.250639e-02 3 1  ON 47
ci_049                -1.364157e-02 3 1  ON 48
ci_050                 3.418875e-03 3 1  ON 49
ci_051                 3.229047e-03 3 1  ON 50
ci_052                -2.264277e-03 3 1  ON 51
ci_053                -2.409815e-03 3 1  ON 52
ci_054                -2.896844e-03 3 1  ON 53
ci_055                -2.921370e-03 3 1  ON 54
ci_056                 5.322849e-03 3 1  ON 55
ci_057                 5.149983e-03 3 1  ON 56
ci_058                -1.695854e-03 3 1  ON 57
ci_059                -1.990649e-03 3 1  ON 58
ci_060                 4.938418e-03 3 1  ON 59
ci_061                 5.527837e-03 3 1  ON 60
ci_062                -3.595625e-03 3 1  ON 61
ci_063                -4.117155e-03 3 1  ON 62
ci_064                -3.014415e-03 3 1  ON 63
ci_065                -4.339697e-03 3 1  ON 64
ci_066                 4.506179e-03 3 1  ON 65
ci_067                 4.314734e-03 3 1  ON 66
ci_068                -4.326419e-03 3 1  ON 67
ci_069                -4.843367e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 96
    time step          = 0.05
    reference energy   = -17.2472
    reference variance = 0.248723
====================================================
  Execution time = 1.3828e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s096
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7898e-01
  Total weights = 1.9574e+06
  Execution time = 1.8210e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267382423231
                                         uncertainty =       0.002173620028

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267382423231
                                         uncertainty =       0.002173620028

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365670796
  error estimate for blocks of size 2^( 2) =       0.000379479813
  error estimate for blocks of size 2^( 3) =       0.000391648814
  error estimate for blocks of size 2^( 4) =       0.000401439708
  error estimate for blocks of size 2^( 5) =       0.000407457070
  error estimate for blocks of size 2^( 6) =       0.000410962499
  error estimate for blocks of size 2^( 7) =       0.000413176506

      target function =      -0.946608535231
              le_mean =     -17.211770201156
             les_mean =     296.524008984758
             stat err =       0.000408258945
             autocorr =       1.246495926500
   target nu stat err =       0.000408258945
   target dn stat err =       0.002323408423
      target stat err =       0.003982822443
              std dev =       0.517136599633
             le_variance =       0.267430262680

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267380681565
                                         uncertainty =       0.002173215801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267380681565
                                         uncertainty =       0.002173215801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365669590
  error estimate for blocks of size 2^( 2) =       0.000379479374
  error estimate for blocks of size 2^( 3) =       0.000391649182
  error estimate for blocks of size 2^( 4) =       0.000401440614
  error estimate for blocks of size 2^( 5) =       0.000407458350
  error estimate for blocks of size 2^( 6) =       0.000410964393
  error estimate for blocks of size 2^( 7) =       0.000413178893

      target function =      -0.946587316018
              le_mean =     -17.211770292284
             les_mean =     296.524024693437
             stat err =       0.000408260563
             autocorr =       1.246514024950
   target nu stat err =       0.000408260563
   target dn stat err =       0.002325722519
      target stat err =       0.003986482817
              std dev =       0.517134893787
             le_variance =       0.267428498372

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267381534324
                                         uncertainty =       0.002173416659

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267381534324
                                         uncertainty =       0.002173416659

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365670181
  error estimate for blocks of size 2^( 2) =       0.000379479584
  error estimate for blocks of size 2^( 3) =       0.000391648991
  error estimate for blocks of size 2^( 4) =       0.000401440155
  error estimate for blocks of size 2^( 5) =       0.000407457706
  error estimate for blocks of size 2^( 6) =       0.000410963443
  error estimate for blocks of size 2^( 7) =       0.000413177698

      target function =      -0.946598168689
              le_mean =     -17.211770245448
             les_mean =     296.524016651172
             stat err =       0.000408259750
             autocorr =       1.246505038876
   target nu stat err =       0.000408259750
   target dn stat err =       0.002324546606
      target stat err =       0.003984623397
              std dev =       0.517135729144
             le_variance =       0.267429362357

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267382310537
                                         uncertainty =       0.002173594562

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267382310537
                                         uncertainty =       0.002173594562

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365670718
  error estimate for blocks of size 2^( 2) =       0.000379479783
  error estimate for blocks of size 2^( 3) =       0.000391648835
  error estimate for blocks of size 2^( 4) =       0.000401439763
  error estimate for blocks of size 2^( 5) =       0.000407457148
  error estimate for blocks of size 2^( 6) =       0.000410962616
  error estimate for blocks of size 2^( 7) =       0.000413176654

      target function =      -0.946607280924
              le_mean =     -17.211770206523
             les_mean =     296.524009912603
             stat err =       0.000408259045
             autocorr =       1.246497067852
   target nu stat err =       0.000408259045
   target dn stat err =       0.002323547495
      target stat err =       0.003983042603
              std dev =       0.517136489290
             le_variance =       0.267430148555


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946608535231        initial  <--
     8.4703e+00     8.4703e+01             1.9429e-05        -0.946587316018
     3.3881e+01     3.3881e+02             4.8864e-06        -0.946598168689
     1.3553e+02     1.3553e+03             1.2234e-06        -0.946607280924

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.0169
  </log>
  <optVariables href="H2O.s096.opt.xml">
ci_001                -4.146270e-02 3 1  ON 0
ci_002                -3.159718e-02 3 1  ON 1
ci_003                -2.619966e-02 3 1  ON 2
ci_004                 2.368280e-02 3 1  ON 3
ci_005                 2.384713e-02 3 1  ON 4
ci_006                -2.092787e-02 3 1  ON 5
ci_007                -2.044043e-02 3 1  ON 6
ci_008                -8.591303e-03 3 1  ON 7
ci_009                -1.432704e-02 3 1  ON 8
ci_010                -9.617543e-03 3 1  ON 9
ci_011                -1.061936e-02 3 1  ON 10
ci_012                -9.816059e-03 3 1  ON 11
ci_013                -1.993794e-02 3 1  ON 12
ci_014                 1.258161e-02 3 1  ON 13
ci_015                 1.252465e-02 3 1  ON 14
ci_016                 1.714281e-02 3 1  ON 15
ci_017                 1.631152e-02 3 1  ON 16
ci_018                 9.867059e-03 3 1  ON 17
ci_019                 1.001597e-02 3 1  ON 18
ci_020                 1.717679e-02 3 1  ON 19
ci_021                 1.701748e-02 3 1  ON 20
ci_022                 9.195760e-03 3 1  ON 21
ci_023                 9.439983e-03 3 1  ON 22
ci_024                 9.636914e-03 3 1  ON 23
ci_025                 9.440531e-03 3 1  ON 24
ci_026                 1.108571e-02 3 1  ON 25
ci_027                 1.154566e-02 3 1  ON 26
ci_028                -1.497333e-02 3 1  ON 27
ci_029                -1.552559e-02 3 1  ON 28
ci_030                -9.427630e-03 3 1  ON 29
ci_031                -9.017917e-03 3 1  ON 30
ci_032                -1.486093e-02 3 1  ON 31
ci_033                 5.717800e-03 3 1  ON 32
ci_034                 5.609475e-03 3 1  ON 33
ci_035                -5.050823e-03 3 1  ON 34
ci_036                -1.252901e-02 3 1  ON 35
ci_037                -1.250398e-02 3 1  ON 36
ci_038                 1.762344e-03 3 1  ON 37
ci_039                 1.723039e-03 3 1  ON 38
ci_040                -3.025080e-03 3 1  ON 39
ci_041                 8.798301e-03 3 1  ON 40
ci_042                 8.887990e-03 3 1  ON 41
ci_043                -4.005603e-03 3 1  ON 42
ci_044                -4.072309e-03 3 1  ON 43
ci_045                -3.231763e-03 3 1  ON 44
ci_046                 5.729087e-03 3 1  ON 45
ci_047                 5.623058e-03 3 1  ON 46
ci_048                -1.250461e-02 3 1  ON 47
ci_049                -1.364255e-02 3 1  ON 48
ci_050                 3.420935e-03 3 1  ON 49
ci_051                 3.227713e-03 3 1  ON 50
ci_052                -2.263109e-03 3 1  ON 51
ci_053                -2.410738e-03 3 1  ON 52
ci_054                -2.897204e-03 3 1  ON 53
ci_055                -2.921136e-03 3 1  ON 54
ci_056                 5.321653e-03 3 1  ON 55
ci_057                 5.150148e-03 3 1  ON 56
ci_058                -1.693930e-03 3 1  ON 57
ci_059                -1.993250e-03 3 1  ON 58
ci_060                 4.937872e-03 3 1  ON 59
ci_061                 5.527620e-03 3 1  ON 60
ci_062                -3.595652e-03 3 1  ON 61
ci_063                -4.116278e-03 3 1  ON 62
ci_064                -3.015378e-03 3 1  ON 63
ci_065                -4.339987e-03 3 1  ON 64
ci_066                 4.507252e-03 3 1  ON 65
ci_067                 4.314998e-03 3 1  ON 66
ci_068                -4.329095e-03 3 1  ON 67
ci_069                -4.840340e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9823e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s097 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s097 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=97  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.1563
    reference variance = 0.170182
====================================================
  Execution time = 1.4241e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s097
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5276e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7988e-01
  Total weights = 1.957246148e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4659e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268403236146
                                         uncertainty =       0.002576543572

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268403236146
                                         uncertainty =       0.002576543572

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366319094
  error estimate for blocks of size 2^( 2) =       0.000380050383
  error estimate for blocks of size 2^( 3) =       0.000392936656
  error estimate for blocks of size 2^( 4) =       0.000402314000
  error estimate for blocks of size 2^( 5) =       0.000407769752
  error estimate for blocks of size 2^( 6) =       0.000409850830
  error estimate for blocks of size 2^( 7) =       0.000409770799

      target function =      -0.945064704232
              le_mean =     -17.211153948375
             les_mean =     296.503702625071
             stat err =       0.000407426345
             autocorr =       1.237026783311
   target nu stat err =       0.000407426345
   target dn stat err =       0.003067761054
      target stat err =       0.005198304891
              std dev =       0.518053431189
             le_variance =       0.268379357566


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721115394837e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+01, overlap shift 8.4703e+02 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945092033368       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945092312634       residual = 6.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945092359468       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945092366901       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945092365836       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945092366335       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945092366215       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945092366083       residual = 5.34e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945092366128       residual = 1.29e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945092366132       residual = 2.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+01 is 1.073425e-06

solving harmonic davidson linear method for identity shift 3.3881e+02, overlap shift 3.3881e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945092033368       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945092103234       residual = 6.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945092114949       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945092116807       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945092116541       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945092116665       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945092116635       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945092116603       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945092116614       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945092116615       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+02 is 2.685403e-07

solving harmonic davidson linear method for identity shift 1.3553e+03, overlap shift 1.3553e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945092033368       residual = 4.99e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945092050838       residual = 6.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945092053767       residual = 1.73e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945092054231       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945092054165       residual = 7.59e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945092054197       residual = 1.22e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945092054187       residual = 2.51e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945092054183       residual = 5.33e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945092054185       residual = 1.28e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945092054183       residual = 2.80e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+03 is 6.714659e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.355039 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6716e+01
  </log>
  <optVariables href="H2O.s097.opt.xml">
ci_001                -4.146255e-02 3 1  ON 0
ci_002                -3.159716e-02 3 1  ON 1
ci_003                -2.619958e-02 3 1  ON 2
ci_004                 2.368263e-02 3 1  ON 3
ci_005                 2.384691e-02 3 1  ON 4
ci_006                -2.092776e-02 3 1  ON 5
ci_007                -2.044045e-02 3 1  ON 6
ci_008                -8.591258e-03 3 1  ON 7
ci_009                -1.432725e-02 3 1  ON 8
ci_010                -9.617753e-03 3 1  ON 9
ci_011                -1.061935e-02 3 1  ON 10
ci_012                -9.816003e-03 3 1  ON 11
ci_013                -1.993789e-02 3 1  ON 12
ci_014                 1.258148e-02 3 1  ON 13
ci_015                 1.252468e-02 3 1  ON 14
ci_016                 1.714271e-02 3 1  ON 15
ci_017                 1.631159e-02 3 1  ON 16
ci_018                 9.867109e-03 3 1  ON 17
ci_019                 1.001591e-02 3 1  ON 18
ci_020                 1.717679e-02 3 1  ON 19
ci_021                 1.701742e-02 3 1  ON 20
ci_022                 9.195902e-03 3 1  ON 21
ci_023                 9.439979e-03 3 1  ON 22
ci_024                 9.636995e-03 3 1  ON 23
ci_025                 9.440680e-03 3 1  ON 24
ci_026                 1.108583e-02 3 1  ON 25
ci_027                 1.154554e-02 3 1  ON 26
ci_028                -1.497346e-02 3 1  ON 27
ci_029                -1.552574e-02 3 1  ON 28
ci_030                -9.427573e-03 3 1  ON 29
ci_031                -9.017893e-03 3 1  ON 30
ci_032                -1.486100e-02 3 1  ON 31
ci_033                 5.717840e-03 3 1  ON 32
ci_034                 5.609374e-03 3 1  ON 33
ci_035                -5.050847e-03 3 1  ON 34
ci_036                -1.252905e-02 3 1  ON 35
ci_037                -1.250371e-02 3 1  ON 36
ci_038                 1.762272e-03 3 1  ON 37
ci_039                 1.723066e-03 3 1  ON 38
ci_040                -3.025108e-03 3 1  ON 39
ci_041                 8.798432e-03 3 1  ON 40
ci_042                 8.887821e-03 3 1  ON 41
ci_043                -4.005615e-03 3 1  ON 42
ci_044                -4.072497e-03 3 1  ON 43
ci_045                -3.231641e-03 3 1  ON 44
ci_046                 5.728965e-03 3 1  ON 45
ci_047                 5.623274e-03 3 1  ON 46
ci_048                -1.250469e-02 3 1  ON 47
ci_049                -1.364235e-02 3 1  ON 48
ci_050                 3.421005e-03 3 1  ON 49
ci_051                 3.227712e-03 3 1  ON 50
ci_052                -2.263049e-03 3 1  ON 51
ci_053                -2.410700e-03 3 1  ON 52
ci_054                -2.897130e-03 3 1  ON 53
ci_055                -2.921039e-03 3 1  ON 54
ci_056                 5.321686e-03 3 1  ON 55
ci_057                 5.150172e-03 3 1  ON 56
ci_058                -1.693802e-03 3 1  ON 57
ci_059                -1.993183e-03 3 1  ON 58
ci_060                 4.937866e-03 3 1  ON 59
ci_061                 5.527579e-03 3 1  ON 60
ci_062                -3.595605e-03 3 1  ON 61
ci_063                -4.116111e-03 3 1  ON 62
ci_064                -3.015410e-03 3 1  ON 63
ci_065                -4.339990e-03 3 1  ON 64
ci_066                 4.507297e-03 3 1  ON 65
ci_067                 4.315116e-03 3 1  ON 66
ci_068                -4.329340e-03 3 1  ON 67
ci_069                -4.840497e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 97
    time step          = 0.05
    reference energy   = -17.2014
    reference variance = 0.271687
====================================================
  Execution time = 1.4016e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s097
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7932e-01
  Total weights = 1.9571e+06
  Execution time = 1.8152e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267836998398
                                         uncertainty =       0.001772785040

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267836998398
                                         uncertainty =       0.001772785040

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365926110
  error estimate for blocks of size 2^( 2) =       0.000379805139
  error estimate for blocks of size 2^( 3) =       0.000392250566
  error estimate for blocks of size 2^( 4) =       0.000401689697
  error estimate for blocks of size 2^( 5) =       0.000408143213
  error estimate for blocks of size 2^( 6) =       0.000411337053
  error estimate for blocks of size 2^( 7) =       0.000413508281

      target function =      -0.946035901293
              le_mean =     -17.212210364132
             les_mean =     296.539501394258
             stat err =       0.000408669561
             autocorr =       1.247262270736
   target nu stat err =       0.000408669561
   target dn stat err =       0.002570364382
      target stat err =       0.004391248136
              std dev =       0.517497667109
             le_variance =       0.267803835463

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267836833680
                                         uncertainty =       0.001772766856

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267836833680
                                         uncertainty =       0.001772766856

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365925996
  error estimate for blocks of size 2^( 2) =       0.000379805033
  error estimate for blocks of size 2^( 3) =       0.000392250480
  error estimate for blocks of size 2^( 4) =       0.000401689622
  error estimate for blocks of size 2^( 5) =       0.000408143158
  error estimate for blocks of size 2^( 6) =       0.000411336999
  error estimate for blocks of size 2^( 7) =       0.000413508186

      target function =      -0.946023282946
              le_mean =     -17.212210348635
             les_mean =     296.539508348457
             stat err =       0.000408669492
             autocorr =       1.247262619970
   target nu stat err =       0.000408669492
   target dn stat err =       0.002570605888
      target stat err =       0.004391533719
              std dev =       0.517497506963
             le_variance =       0.267803669713

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267836915927
                                         uncertainty =       0.001772775940

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267836915927
                                         uncertainty =       0.001772775940

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365926053
  error estimate for blocks of size 2^( 2) =       0.000379805086
  error estimate for blocks of size 2^( 3) =       0.000392250523
  error estimate for blocks of size 2^( 4) =       0.000401689660
  error estimate for blocks of size 2^( 5) =       0.000408143185
  error estimate for blocks of size 2^( 6) =       0.000411337026
  error estimate for blocks of size 2^( 7) =       0.000413508234

      target function =      -0.946030060046
              le_mean =     -17.212210356386
             les_mean =     296.539504593702
             stat err =       0.000408669526
             autocorr =       1.247262445482
   target nu stat err =       0.000408669526
   target dn stat err =       0.002570479447
      target stat err =       0.004391385764
              std dev =       0.517497586928
             le_variance =       0.267803752476

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267836988081
                                         uncertainty =       0.001772783902

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267836988081
                                         uncertainty =       0.001772783902

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365926103
  error estimate for blocks of size 2^( 2) =       0.000379805133
  error estimate for blocks of size 2^( 3) =       0.000392250561
  error estimate for blocks of size 2^( 4) =       0.000401689693
  error estimate for blocks of size 2^( 5) =       0.000408143209
  error estimate for blocks of size 2^( 6) =       0.000411337050
  error estimate for blocks of size 2^( 7) =       0.000413508275

      target function =      -0.946035216272
              le_mean =     -17.212210363164
             les_mean =     296.539501767417
             stat err =       0.000408669557
             autocorr =       1.247262292591
   target nu stat err =       0.000408669557
   target dn stat err =       0.002570378252
      target stat err =       0.004391264901
              std dev =       0.517497657078
             le_variance =       0.267803825081


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946035901293        initial  <--
     8.4703e+01     8.4703e+02             1.0734e-06        -0.946023282946
     3.3881e+02     3.3881e+03             2.6854e-07        -0.946030060046
     1.3553e+03     1.3553e+04             6.7147e-08        -0.946035216272

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 23.1721
  </log>
  <optVariables href="H2O.s097.opt.xml">
ci_001                -4.146270e-02 3 1  ON 0
ci_002                -3.159718e-02 3 1  ON 1
ci_003                -2.619966e-02 3 1  ON 2
ci_004                 2.368280e-02 3 1  ON 3
ci_005                 2.384713e-02 3 1  ON 4
ci_006                -2.092787e-02 3 1  ON 5
ci_007                -2.044043e-02 3 1  ON 6
ci_008                -8.591303e-03 3 1  ON 7
ci_009                -1.432704e-02 3 1  ON 8
ci_010                -9.617543e-03 3 1  ON 9
ci_011                -1.061936e-02 3 1  ON 10
ci_012                -9.816059e-03 3 1  ON 11
ci_013                -1.993794e-02 3 1  ON 12
ci_014                 1.258161e-02 3 1  ON 13
ci_015                 1.252465e-02 3 1  ON 14
ci_016                 1.714281e-02 3 1  ON 15
ci_017                 1.631152e-02 3 1  ON 16
ci_018                 9.867059e-03 3 1  ON 17
ci_019                 1.001597e-02 3 1  ON 18
ci_020                 1.717679e-02 3 1  ON 19
ci_021                 1.701748e-02 3 1  ON 20
ci_022                 9.195760e-03 3 1  ON 21
ci_023                 9.439983e-03 3 1  ON 22
ci_024                 9.636914e-03 3 1  ON 23
ci_025                 9.440531e-03 3 1  ON 24
ci_026                 1.108571e-02 3 1  ON 25
ci_027                 1.154566e-02 3 1  ON 26
ci_028                -1.497333e-02 3 1  ON 27
ci_029                -1.552559e-02 3 1  ON 28
ci_030                -9.427630e-03 3 1  ON 29
ci_031                -9.017917e-03 3 1  ON 30
ci_032                -1.486093e-02 3 1  ON 31
ci_033                 5.717800e-03 3 1  ON 32
ci_034                 5.609475e-03 3 1  ON 33
ci_035                -5.050823e-03 3 1  ON 34
ci_036                -1.252901e-02 3 1  ON 35
ci_037                -1.250398e-02 3 1  ON 36
ci_038                 1.762344e-03 3 1  ON 37
ci_039                 1.723039e-03 3 1  ON 38
ci_040                -3.025080e-03 3 1  ON 39
ci_041                 8.798301e-03 3 1  ON 40
ci_042                 8.887990e-03 3 1  ON 41
ci_043                -4.005603e-03 3 1  ON 42
ci_044                -4.072309e-03 3 1  ON 43
ci_045                -3.231763e-03 3 1  ON 44
ci_046                 5.729087e-03 3 1  ON 45
ci_047                 5.623058e-03 3 1  ON 46
ci_048                -1.250461e-02 3 1  ON 47
ci_049                -1.364255e-02 3 1  ON 48
ci_050                 3.420935e-03 3 1  ON 49
ci_051                 3.227713e-03 3 1  ON 50
ci_052                -2.263109e-03 3 1  ON 51
ci_053                -2.410738e-03 3 1  ON 52
ci_054                -2.897204e-03 3 1  ON 53
ci_055                -2.921136e-03 3 1  ON 54
ci_056                 5.321653e-03 3 1  ON 55
ci_057                 5.150148e-03 3 1  ON 56
ci_058                -1.693930e-03 3 1  ON 57
ci_059                -1.993250e-03 3 1  ON 58
ci_060                 4.937872e-03 3 1  ON 59
ci_061                 5.527620e-03 3 1  ON 60
ci_062                -3.595652e-03 3 1  ON 61
ci_063                -4.116278e-03 3 1  ON 62
ci_064                -3.015378e-03 3 1  ON 63
ci_065                -4.339987e-03 3 1  ON 64
ci_066                 4.507252e-03 3 1  ON 65
ci_067                 4.314998e-03 3 1  ON 66
ci_068                -4.329095e-03 3 1  ON 67
ci_069                -4.840340e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9893e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s098 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s098 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=98  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.2552
    reference variance = 0.160313
====================================================
  Execution time = 1.4137e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s098
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5306e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8018e-01
  Total weights = 1.957287217e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4766e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267906888470
                                         uncertainty =       0.001433128790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.267906888470
                                         uncertainty =       0.001433128790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000365995914
  error estimate for blocks of size 2^( 2) =       0.000379646513
  error estimate for blocks of size 2^( 3) =       0.000392409411
  error estimate for blocks of size 2^( 4) =       0.000401637973
  error estimate for blocks of size 2^( 5) =       0.000406639365
  error estimate for blocks of size 2^( 6) =       0.000409192647
  error estimate for blocks of size 2^( 7) =       0.000409766825

      target function =      -0.944588919916
              le_mean =     -17.212405459875
             les_mean =     296.547081986887
             stat err =       0.000406809203
             autocorr =       1.235461064630
   target nu stat err =       0.000406809203
   target dn stat err =       0.002146497131
      target stat err =       0.003678516529
              std dev =       0.517596385789
             le_variance =       0.267906018582


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721240545988e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 8.4703e+02, overlap shift 8.4703e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944602223451       residual = 7.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944602250650       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944602257058       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944602259192       residual = 6.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944602259113       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944602259265       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944602259279       residual = 6.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944602259273       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944602259267       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944602259266       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+02 is 1.204401e-07

solving harmonic davidson linear method for identity shift 3.3881e+03, overlap shift 3.3881e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944602223451       residual = 7.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944602230251       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944602231853       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944602232386       residual = 6.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944602232367       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944602232405       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944602232408       residual = 6.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944602232407       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944602232405       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944602232405       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+03 is 3.011146e-08

solving harmonic davidson linear method for identity shift 1.3553e+04, overlap shift 1.3553e+05 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944602223451       residual = 7.42e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944602225151       residual = 1.43e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944602225551       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944602225685       residual = 6.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944602225680       residual = 2.23e-05           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944602225689       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944602225690       residual = 6.75e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944602225675       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944602225718       residual = 3.09e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944602225689       residual = 6.24e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 1.3553e+04 is 7.527955e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.358425 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6622e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
ci_001                -4.146270e-02 3 1  ON 0
ci_002                -3.159718e-02 3 1  ON 1
ci_003                -2.619964e-02 3 1  ON 2
ci_004                 2.368278e-02 3 1  ON 3
ci_005                 2.384711e-02 3 1  ON 4
ci_006                -2.092785e-02 3 1  ON 5
ci_007                -2.044044e-02 3 1  ON 6
ci_008                -8.591287e-03 3 1  ON 7
ci_009                -1.432705e-02 3 1  ON 8
ci_010                -9.617514e-03 3 1  ON 9
ci_011                -1.061936e-02 3 1  ON 10
ci_012                -9.816066e-03 3 1  ON 11
ci_013                -1.993795e-02 3 1  ON 12
ci_014                 1.258163e-02 3 1  ON 13
ci_015                 1.252464e-02 3 1  ON 14
ci_016                 1.714280e-02 3 1  ON 15
ci_017                 1.631153e-02 3 1  ON 16
ci_018                 9.867069e-03 3 1  ON 17
ci_019                 1.001596e-02 3 1  ON 18
ci_020                 1.717678e-02 3 1  ON 19
ci_021                 1.701748e-02 3 1  ON 20
ci_022                 9.195764e-03 3 1  ON 21
ci_023                 9.439975e-03 3 1  ON 22
ci_024                 9.636918e-03 3 1  ON 23
ci_025                 9.440525e-03 3 1  ON 24
ci_026                 1.108571e-02 3 1  ON 25
ci_027                 1.154567e-02 3 1  ON 26
ci_028                -1.497332e-02 3 1  ON 27
ci_029                -1.552559e-02 3 1  ON 28
ci_030                -9.427648e-03 3 1  ON 29
ci_031                -9.017936e-03 3 1  ON 30
ci_032                -1.486090e-02 3 1  ON 31
ci_033                 5.717796e-03 3 1  ON 32
ci_034                 5.609467e-03 3 1  ON 33
ci_035                -5.050835e-03 3 1  ON 34
ci_036                -1.252903e-02 3 1  ON 35
ci_037                -1.250398e-02 3 1  ON 36
ci_038                 1.762331e-03 3 1  ON 37
ci_039                 1.723049e-03 3 1  ON 38
ci_040                -3.025079e-03 3 1  ON 39
ci_041                 8.798291e-03 3 1  ON 40
ci_042                 8.887985e-03 3 1  ON 41
ci_043                -4.005599e-03 3 1  ON 42
ci_044                -4.072299e-03 3 1  ON 43
ci_045                -3.231758e-03 3 1  ON 44
ci_046                 5.729091e-03 3 1  ON 45
ci_047                 5.623061e-03 3 1  ON 46
ci_048                -1.250460e-02 3 1  ON 47
ci_049                -1.364258e-02 3 1  ON 48
ci_050                 3.420934e-03 3 1  ON 49
ci_051                 3.227702e-03 3 1  ON 50
ci_052                -2.263106e-03 3 1  ON 51
ci_053                -2.410733e-03 3 1  ON 52
ci_054                -2.897195e-03 3 1  ON 53
ci_055                -2.921129e-03 3 1  ON 54
ci_056                 5.321645e-03 3 1  ON 55
ci_057                 5.150147e-03 3 1  ON 56
ci_058                -1.693930e-03 3 1  ON 57
ci_059                -1.993243e-03 3 1  ON 58
ci_060                 4.937891e-03 3 1  ON 59
ci_061                 5.527592e-03 3 1  ON 60
ci_062                -3.595657e-03 3 1  ON 61
ci_063                -4.116269e-03 3 1  ON 62
ci_064                -3.015393e-03 3 1  ON 63
ci_065                -4.339992e-03 3 1  ON 64
ci_066                 4.507254e-03 3 1  ON 65
ci_067                 4.314999e-03 3 1  ON 66
ci_068                -4.329124e-03 3 1  ON 67
ci_069                -4.840353e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 98
    time step          = 0.05
    reference energy   = -17.2579
    reference variance = 0.361723
====================================================
  Execution time = 1.3761e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s098
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.7973e-01
  Total weights = 1.9573e+06
  Execution time = 1.8282e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268244664390
                                         uncertainty =       0.001822836987

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268244664390
                                         uncertainty =       0.001822836987

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366220031
  error estimate for blocks of size 2^( 2) =       0.000380044644
  error estimate for blocks of size 2^( 3) =       0.000393121129
  error estimate for blocks of size 2^( 4) =       0.000402407539
  error estimate for blocks of size 2^( 5) =       0.000407913576
  error estimate for blocks of size 2^( 6) =       0.000410769628
  error estimate for blocks of size 2^( 7) =       0.000414594422

      target function =      -0.945335671498
              le_mean =     -17.211317455784
             les_mean =     296.509177613797
             stat err =       0.000408921291
             autocorr =       1.246795587628
   target nu stat err =       0.000408921291
   target dn stat err =       0.002318945327
      target stat err =       0.003961763565
              std dev =       0.517913334688
             le_variance =       0.268234222248

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268244652726
                                         uncertainty =       0.001822839444

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268244652726
                                         uncertainty =       0.001822839444

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366220023
  error estimate for blocks of size 2^( 2) =       0.000380044642
  error estimate for blocks of size 2^( 3) =       0.000393121134
  error estimate for blocks of size 2^( 4) =       0.000402407549
  error estimate for blocks of size 2^( 5) =       0.000407913581
  error estimate for blocks of size 2^( 6) =       0.000410769639
  error estimate for blocks of size 2^( 7) =       0.000414594433

      target function =      -0.945335795186
              le_mean =     -17.211317457074
             les_mean =     296.509177584543
             stat err =       0.000408921301
             autocorr =       1.246795699406
   target nu stat err =       0.000408921301
   target dn stat err =       0.002318950464
      target stat err =       0.003961773079
              std dev =       0.517913323497
             le_variance =       0.268234210656

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268244658557
                                         uncertainty =       0.001822838216

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268244658557
                                         uncertainty =       0.001822838216

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366220027
  error estimate for blocks of size 2^( 2) =       0.000380044643
  error estimate for blocks of size 2^( 3) =       0.000393121131
  error estimate for blocks of size 2^( 4) =       0.000402407544
  error estimate for blocks of size 2^( 5) =       0.000407913579
  error estimate for blocks of size 2^( 6) =       0.000410769634
  error estimate for blocks of size 2^( 7) =       0.000414594428

      target function =      -0.945335733518
              le_mean =     -17.211317456429
             les_mean =     296.509177599064
             stat err =       0.000408921296
             autocorr =       1.246795643528
   target nu stat err =       0.000408921296
   target dn stat err =       0.002318947895
      target stat err =       0.003961768322
              std dev =       0.517913329091
             le_variance =       0.268234216450

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268244663661
                                         uncertainty =       0.001822837140

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.268244663661
                                         uncertainty =       0.001822837140

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000366220031
  error estimate for blocks of size 2^( 2) =       0.000380044644
  error estimate for blocks of size 2^( 3) =       0.000393121129
  error estimate for blocks of size 2^( 4) =       0.000402407540
  error estimate for blocks of size 2^( 5) =       0.000407913576
  error estimate for blocks of size 2^( 6) =       0.000410769629
  error estimate for blocks of size 2^( 7) =       0.000414594422

      target function =      -0.945335679270
              le_mean =     -17.211317455864
             les_mean =     296.509177611943
             stat err =       0.000408921292
             autocorr =       1.246795594618
   target nu stat err =       0.000408921292
   target dn stat err =       0.002318945648
      target stat err =       0.003961764160
              std dev =       0.517913333988
             le_variance =       0.268234221523


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945335671498        initial
     8.4703e+02     8.4703e+03             1.2044e-07        -0.945335795186  <--
     3.3881e+03     3.3881e+04             3.0111e-08        -0.945335733518
     1.3553e+04     1.3553e+05             7.5280e-09        -0.945335679270

*****************************************************************************
Applying the update for shift_i =   8.4703e+02     and shift_s =   8.4703e+03
*****************************************************************************

  Execution time = 2.5977e+01
  </log>
  <optVariables href="H2O.s098.opt.xml">
ci_001                -4.146268e-02 3 1  ON 0
ci_002                -3.159716e-02 3 1  ON 1
ci_003                -2.619958e-02 3 1  ON 2
ci_004                 2.368272e-02 3 1  ON 3
ci_005                 2.384703e-02 3 1  ON 4
ci_006                -2.092780e-02 3 1  ON 5
ci_007                -2.044045e-02 3 1  ON 6
ci_008                -8.591241e-03 3 1  ON 7
ci_009                -1.432709e-02 3 1  ON 8
ci_010                -9.617424e-03 3 1  ON 9
ci_011                -1.061936e-02 3 1  ON 10
ci_012                -9.816087e-03 3 1  ON 11
ci_013                -1.993800e-02 3 1  ON 12
ci_014                 1.258167e-02 3 1  ON 13
ci_015                 1.252463e-02 3 1  ON 14
ci_016                 1.714276e-02 3 1  ON 15
ci_017                 1.631157e-02 3 1  ON 16
ci_018                 9.867098e-03 3 1  ON 17
ci_019                 1.001594e-02 3 1  ON 18
ci_020                 1.717676e-02 3 1  ON 19
ci_021                 1.701749e-02 3 1  ON 20
ci_022                 9.195774e-03 3 1  ON 21
ci_023                 9.439950e-03 3 1  ON 22
ci_024                 9.636930e-03 3 1  ON 23
ci_025                 9.440508e-03 3 1  ON 24
ci_026                 1.108569e-02 3 1  ON 25
ci_027                 1.154567e-02 3 1  ON 26
ci_028                -1.497329e-02 3 1  ON 27
ci_029                -1.552560e-02 3 1  ON 28
ci_030                -9.427703e-03 3 1  ON 29
ci_031                -9.017995e-03 3 1  ON 30
ci_032                -1.486082e-02 3 1  ON 31
ci_033                 5.717786e-03 3 1  ON 32
ci_034                 5.609442e-03 3 1  ON 33
ci_035                -5.050871e-03 3 1  ON 34
ci_036                -1.252907e-02 3 1  ON 35
ci_037                -1.250398e-02 3 1  ON 36
ci_038                 1.762290e-03 3 1  ON 37
ci_039                 1.723076e-03 3 1  ON 38
ci_040                -3.025074e-03 3 1  ON 39
ci_041                 8.798262e-03 3 1  ON 40
ci_042                 8.887972e-03 3 1  ON 41
ci_043                -4.005586e-03 3 1  ON 42
ci_044                -4.072270e-03 3 1  ON 43
ci_045                -3.231741e-03 3 1  ON 44
ci_046                 5.729102e-03 3 1  ON 45
ci_047                 5.623070e-03 3 1  ON 46
ci_048                -1.250456e-02 3 1  ON 47
ci_049                -1.364267e-02 3 1  ON 48
ci_050                 3.420932e-03 3 1  ON 49
ci_051                 3.227670e-03 3 1  ON 50
ci_052                -2.263098e-03 3 1  ON 51
ci_053                -2.410720e-03 3 1  ON 52
ci_054                -2.897168e-03 3 1  ON 53
ci_055                -2.921109e-03 3 1  ON 54
ci_056                 5.321620e-03 3 1  ON 55
ci_057                 5.150145e-03 3 1  ON 56
ci_058                -1.693930e-03 3 1  ON 57
ci_059                -1.993224e-03 3 1  ON 58
ci_060                 4.937946e-03 3 1  ON 59
ci_061                 5.527508e-03 3 1  ON 60
ci_062                -3.595671e-03 3 1  ON 61
ci_063                -4.116241e-03 3 1  ON 62
ci_064                -3.015437e-03 3 1  ON 63
ci_065                -4.340006e-03 3 1  ON 64
ci_066                 4.507262e-03 3 1  ON 65
ci_067                 4.315002e-03 3 1  ON 66
ci_068                -4.329211e-03 3 1  ON 67
ci_069                -4.840392e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 4.2604e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s099 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s099 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=99  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7211e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.1196
    reference variance = 0.149559
====================================================
  Execution time = 1.4034e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s099
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5271e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8137e-01
  Total weights = 1.956945051e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 2.4624e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270318576204
                                         uncertainty =       0.001918043745

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.270318576204
                                         uncertainty =       0.001918043745

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000367661723
  error estimate for blocks of size 2^( 2) =       0.000381654355
  error estimate for blocks of size 2^( 3) =       0.000394318745
  error estimate for blocks of size 2^( 4) =       0.000403948595
  error estimate for blocks of size 2^( 5) =       0.000409581734
  error estimate for blocks of size 2^( 6) =       0.000411346691
  error estimate for blocks of size 2^( 7) =       0.000411799699

      target function =      -0.942593462287
              le_mean =     -17.212385927463
             les_mean =     296.547598541896
             stat err =       0.000409169180
             autocorr =       1.238537012970
   target nu stat err =       0.000409169180
   target dn stat err =       0.002293683590
      target stat err =       0.003905667636
              std dev =       0.519952195730
             le_variance =       0.270350285845


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721238592746e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 69
Check correct_vf_var_size: 210, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.1176e+02, overlap shift 2.1176e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942608639914       residual = 8.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942608800499       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942608827946       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942608834458       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942608834825       residual = 9.05e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942608834718       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942608834988       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942608834956       residual = 6.68e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942608834948       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942608834947       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 2.1176e+02 is 5.289718e-07

solving harmonic davidson linear method for identity shift 8.4703e+02, overlap shift 8.4703e+03 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942608639914       residual = 8.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942608680072       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942608686935       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942608688563       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942608688655       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942608688628       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942608688696       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942608688688       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942608688685       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942608688685       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 8.4703e+02 is 1.322769e-07

solving harmonic davidson linear method for identity shift 3.3881e+03, overlap shift 3.3881e+04 and omega -1.7743e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942608639914       residual = 8.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942608649954       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942608651670       residual = 2.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942608652077       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942608652100       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942608652093       residual = 1.86e-06           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942608652105       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942608652108       residual = 6.67e-08           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942608652108       residual = 1.27e-08           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942608652104       residual = 3.06e-09           smallest_sin_value = 1.00e+00
davidson solver converged in          9 iterations

On rank 0, check n_tot: 70 and evec_eigen.size(): 70
The largest weight on the derivative vector for shift 3.3881e+03 is 3.307134e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.361878 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 70 and numParams is: 69

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 1.6507e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
ci_001                -4.146271e-02 3 1  ON 0
ci_002                -3.159720e-02 3 1  ON 1
ci_003                -2.619949e-02 3 1  ON 2
ci_004                 2.368269e-02 3 1  ON 3
ci_005                 2.384691e-02 3 1  ON 4
ci_006                -2.092782e-02 3 1  ON 5
ci_007                -2.044052e-02 3 1  ON 6
ci_008                -8.591319e-03 3 1  ON 7
ci_009                -1.432708e-02 3 1  ON 8
ci_010                -9.617329e-03 3 1  ON 9
ci_011                -1.061937e-02 3 1  ON 10
ci_012                -9.816128e-03 3 1  ON 11
ci_013                -1.993796e-02 3 1  ON 12
ci_014                 1.258174e-02 3 1  ON 13
ci_015                 1.252461e-02 3 1  ON 14
ci_016                 1.714284e-02 3 1  ON 15
ci_017                 1.631168e-02 3 1  ON 16
ci_018                 9.867081e-03 3 1  ON 17
ci_019                 1.001591e-02 3 1  ON 18
ci_020                 1.717672e-02 3 1  ON 19
ci_021                 1.701758e-02 3 1  ON 20
ci_022                 9.195786e-03 3 1  ON 21
ci_023                 9.440001e-03 3 1  ON 22
ci_024                 9.636870e-03 3 1  ON 23
ci_025                 9.440492e-03 3 1  ON 24
ci_026                 1.108572e-02 3 1  ON 25
ci_027                 1.154574e-02 3 1  ON 26
ci_028                -1.497335e-02 3 1  ON 27
ci_029                -1.552553e-02 3 1  ON 28
ci_030                -9.427715e-03 3 1  ON 29
ci_031                -9.018019e-03 3 1  ON 30
ci_032                -1.486085e-02 3 1  ON 31
ci_033                 5.717762e-03 3 1  ON 32
ci_034                 5.609474e-03 3 1  ON 33
ci_035                -5.050873e-03 3 1  ON 34
ci_036                -1.252913e-02 3 1  ON 35
ci_037                -1.250391e-02 3 1  ON 36
ci_038                 1.762250e-03 3 1  ON 37
ci_039                 1.723077e-03 3 1  ON 38
ci_040                -3.025019e-03 3 1  ON 39
ci_041                 8.798255e-03 3 1  ON 40
ci_042                 8.887951e-03 3 1  ON 41
ci_043                -4.005585e-03 3 1  ON 42
ci_044                -4.072402e-03 3 1  ON 43
ci_045                -3.231733e-03 3 1  ON 44
ci_046                 5.729138e-03 3 1  ON 45
ci_047                 5.623094e-03 3 1  ON 46
ci_048                -1.250461e-02 3 1  ON 47
ci_049                -1.364257e-02 3 1  ON 48
ci_050                 3.420847e-03 3 1  ON 49
ci_051                 3.227660e-03 3 1  ON 50
ci_052                -2.263133e-03 3 1  ON 51
ci_053                -2.410660e-03 3 1  ON 52
ci_054                -2.897249e-03 3 1  ON 53
ci_055                -2.921154e-03 3 1  ON 54
ci_056                 5.321608e-03 3 1  ON 55
ci_057                 5.150156e-03 3 1  ON 56
ci_058                -1.693952e-03 3 1  ON 57
ci_059                -1.993232e-03 3 1  ON 58
ci_060                 4.937949e-03 3 1  ON 59
ci_061                 5.527531e-03 3 1  ON 60
ci_062                -3.595666e-03 3 1  ON 61
ci_063                -4.116137e-03 3 1  ON 62
ci_064                -3.015431e-03 3 1  ON 63
ci_065                -4.340002e-03 3 1  ON 64
ci_066                 4.507240e-03 3 1  ON 65
ci_067                 4.315098e-03 3 1  ON 66
ci_068                -4.329245e-03 3 1  ON 67
ci_069                -4.840314e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 99
    time step          = 0.05
    reference energy   = -17.2261
    reference variance = 0.204584
====================================================
  Execution time = 1.3997e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s099
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7130e-01
  Total weights = 1.9570e+06
  Execution time = 1.8216e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.261497935363
                                         uncertainty =       0.001383668709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.261497935363
                                         uncertainty =       0.001383668709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000361592232
  error estimate for blocks of size 2^( 2) =       0.000375555839
  error estimate for blocks of size 2^( 3) =       0.000388515380
  error estimate for blocks of size 2^( 4) =       0.000397502132
  error estimate for blocks of size 2^( 5) =       0.000402631454
  error estimate for blocks of size 2^( 6) =       0.000406348366
  error estimate for blocks of size 2^( 7) =       0.000408388398

      target function =      -0.959743004763
              le_mean =     -17.212191584291
             les_mean =     296.530840408134
             stat err =       0.000403717587
             autocorr =       1.246571387421
   target nu stat err =       0.000403717587
   target dn stat err =       0.001843967860
      target stat err =       0.003279363378
              std dev =       0.511368638660
             le_variance =       0.261497884605

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.261497861457
                                         uncertainty =       0.001383662669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.261497861457
                                         uncertainty =       0.001383662669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000361592181
  error estimate for blocks of size 2^( 2) =       0.000375555786
  error estimate for blocks of size 2^( 3) =       0.000388515321
  error estimate for blocks of size 2^( 4) =       0.000397502073
  error estimate for blocks of size 2^( 5) =       0.000402631398
  error estimate for blocks of size 2^( 6) =       0.000406348323
  error estimate for blocks of size 2^( 7) =       0.000408388384

      target function =      -0.959743489191
              le_mean =     -17.212191580044
             les_mean =     296.530839982572
             stat err =       0.000403717544
             autocorr =       1.246571472487
   target nu stat err =       0.000403717544
   target dn stat err =       0.001843950038
      target stat err =       0.003279336435
              std dev =       0.511368566799
             le_variance =       0.261497811110

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.261497898386
                                         uncertainty =       0.001383665688

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.261497898386
                                         uncertainty =       0.001383665688

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000361592207
  error estimate for blocks of size 2^( 2) =       0.000375555813
  error estimate for blocks of size 2^( 3) =       0.000388515351
  error estimate for blocks of size 2^( 4) =       0.000397502102
  error estimate for blocks of size 2^( 5) =       0.000402631426
  error estimate for blocks of size 2^( 6) =       0.000406348345
  error estimate for blocks of size 2^( 7) =       0.000408388391

      target function =      -0.959743254129
              le_mean =     -17.212191582164
             les_mean =     296.530840191123
             stat err =       0.000403717566
             autocorr =       1.246571429979
   target nu stat err =       0.000403717566
   target dn stat err =       0.001843958911
      target stat err =       0.003279349890
              std dev =       0.511368602706
             le_variance =       0.261497847834

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.261497930739
                                         uncertainty =       0.001383668332

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.261497930739
                                         uncertainty =       0.001383668332

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000361592229
  error estimate for blocks of size 2^( 2) =       0.000375555836
  error estimate for blocks of size 2^( 3) =       0.000388515377
  error estimate for blocks of size 2^( 4) =       0.000397502128
  error estimate for blocks of size 2^( 5) =       0.000402631451
  error estimate for blocks of size 2^( 6) =       0.000406348363
  error estimate for blocks of size 2^( 7) =       0.000408388397

      target function =      -0.959743036711
              le_mean =     -17.212191584024
             les_mean =     296.530840380549
             stat err =       0.000403717585
             autocorr =       1.246571392743
   target nu stat err =       0.000403717585
   target dn stat err =       0.001843966738
      target stat err =       0.003279361690
              std dev =       0.511368634164
             le_variance =       0.261497880006


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.959743004763        initial
     2.1176e+02     2.1176e+03             5.2897e-07        -0.959743489191  <--
     8.4703e+02     8.4703e+03             1.3228e-07        -0.959743254129
     3.3881e+03     3.3881e+04             3.3071e-08        -0.959743036711

*****************************************************************************
Applying the update for shift_i =   2.1176e+02     and shift_s =   2.1176e+03
*****************************************************************************

  Execution time = 2.3181e+01
  </log>
  <optVariables href="H2O.s099.opt.xml">
ci_001                -4.146278e-02 3 1  ON 0
ci_002                -3.159731e-02 3 1  ON 1
ci_003                -2.619920e-02 3 1  ON 2
ci_004                 2.368262e-02 3 1  ON 3
ci_005                 2.384656e-02 3 1  ON 4
ci_006                -2.092790e-02 3 1  ON 5
ci_007                -2.044072e-02 3 1  ON 6
ci_008                -8.591551e-03 3 1  ON 7
ci_009                -1.432706e-02 3 1  ON 8
ci_010                -9.617043e-03 3 1  ON 9
ci_011                -1.061938e-02 3 1  ON 10
ci_012                -9.816252e-03 3 1  ON 11
ci_013                -1.993786e-02 3 1  ON 12
ci_014                 1.258194e-02 3 1  ON 13
ci_015                 1.252457e-02 3 1  ON 14
ci_016                 1.714306e-02 3 1  ON 15
ci_017                 1.631200e-02 3 1  ON 16
ci_018                 9.867031e-03 3 1  ON 17
ci_019                 1.001583e-02 3 1  ON 18
ci_020                 1.717661e-02 3 1  ON 19
ci_021                 1.701785e-02 3 1  ON 20
ci_022                 9.195823e-03 3 1  ON 21
ci_023                 9.440154e-03 3 1  ON 22
ci_024                 9.636690e-03 3 1  ON 23
ci_025                 9.440445e-03 3 1  ON 24
ci_026                 1.108578e-02 3 1  ON 25
ci_027                 1.154594e-02 3 1  ON 26
ci_028                -1.497354e-02 3 1  ON 27
ci_029                -1.552531e-02 3 1  ON 28
ci_030                -9.427749e-03 3 1  ON 29
ci_031                -9.018092e-03 3 1  ON 30
ci_032                -1.486095e-02 3 1  ON 31
ci_033                 5.717693e-03 3 1  ON 32
ci_034                 5.609568e-03 3 1  ON 33
ci_035                -5.050879e-03 3 1  ON 34
ci_036                -1.252929e-02 3 1  ON 35
ci_037                -1.250372e-02 3 1  ON 36
ci_038                 1.762128e-03 3 1  ON 37
ci_039                 1.723078e-03 3 1  ON 38
ci_040                -3.024853e-03 3 1  ON 39
ci_041                 8.798233e-03 3 1  ON 40
ci_042                 8.887889e-03 3 1  ON 41
ci_043                -4.005582e-03 3 1  ON 42
ci_044                -4.072799e-03 3 1  ON 43
ci_045                -3.231709e-03 3 1  ON 44
ci_046                 5.729248e-03 3 1  ON 45
ci_047                 5.623168e-03 3 1  ON 46
ci_048                -1.250476e-02 3 1  ON 47
ci_049                -1.364228e-02 3 1  ON 48
ci_050                 3.420589e-03 3 1  ON 49
ci_051                 3.227630e-03 3 1  ON 50
ci_052                -2.263240e-03 3 1  ON 51
ci_053                -2.410481e-03 3 1  ON 52
ci_054                -2.897492e-03 3 1  ON 53
ci_055                -2.921289e-03 3 1  ON 54
ci_056                 5.321571e-03 3 1  ON 55
ci_057                 5.150190e-03 3 1  ON 56
ci_058                -1.694018e-03 3 1  ON 57
ci_059                -1.993256e-03 3 1  ON 58
ci_060                 4.937958e-03 3 1  ON 59
ci_061                 5.527599e-03 3 1  ON 60
ci_062                -3.595649e-03 3 1  ON 61
ci_063                -4.115825e-03 3 1  ON 62
ci_064                -3.015411e-03 3 1  ON 63
ci_065                -4.339990e-03 3 1  ON 64
ci_066                 4.507172e-03 3 1  ON 65
ci_067                 4.315386e-03 3 1  ON 66
ci_068                -4.329348e-03 3 1  ON 67
ci_069                -4.840082e-03 3 1  ON 68
  </optVariables>
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 3.9693e+01 secs
  Total Execution time = 4.0591e+03 secs

=========================================================
  A new xml input file : H2O.s099.cont.xml
