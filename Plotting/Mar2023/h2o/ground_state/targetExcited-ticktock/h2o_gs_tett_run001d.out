Rank =    0  Free Memory = 90550 MB
Rank =    1  Free Memory = 90549 MB
Rank =    2  Free Memory = 90549 MB
Rank =    3  Free Memory = 90549 MB
Rank =    4  Free Memory = 90549 MB
Rank =    5  Free Memory = 90549 MB
Rank =    6  Free Memory = 90549 MB
Rank =    7  Free Memory = 90549 MB
Rank =    8  Free Memory = 90549 MB
Rank =    9  Free Memory = 90549 MB
Rank =   10  Free Memory = 90549 MB
Rank =   11  Free Memory = 90549 MB
Rank =   12  Free Memory = 90549 MB
Rank =   13  Free Memory = 90549 MB
Rank =   14  Free Memory = 90549 MB
Rank =   15  Free Memory = 90535 MB
Rank =   16  Free Memory = 90535 MB
Rank =   17  Free Memory = 90535 MB
Rank =   18  Free Memory = 90535 MB
Rank =   19  Free Memory = 90535 MB
Rank =   20  Free Memory = 90535 MB
Rank =   21  Free Memory = 90535 MB
Rank =   22  Free Memory = 90535 MB
Rank =   23  Free Memory = 90535 MB
Rank =   24  Free Memory = 90535 MB
Rank =   25  Free Memory = 90534 MB
Rank =   26  Free Memory = 90534 MB
Rank =   27  Free Memory = 90534 MB
Rank =   28  Free Memory = 90534 MB
Rank =   29  Free Memory = 90534 MB
Rank =   30  Free Memory = 90534 MB
Rank =   31  Free Memory = 90534 MB
Rank =   32  Free Memory = 88974 MB
Rank =   33  Free Memory = 88974 MB
Rank =   34  Free Memory = 88974 MB
Rank =   35  Free Memory = 88974 MB
Rank =   36  Free Memory = 88974 MB
Rank =   37  Free Memory = 88974 MB
Rank =   38  Free Memory = 88974 MB
Rank =   39  Free Memory = 88974 MB
Rank =   40  Free Memory = 88974 MB
Rank =   41  Free Memory = 88974 MB
Rank =   42  Free Memory = 88974 MB
Rank =   43  Free Memory = 88974 MB
Rank =   44  Free Memory = 88974 MB
Rank =   45  Free Memory = 88974 MB
Rank =   46  Free Memory = 88974 MB
Rank =   47  Free Memory = 88974 MB
Rank =   48  Free Memory = 88974 MB
Rank =   49  Free Memory = 88974 MB
Rank =   50  Free Memory = 88974 MB
Rank =   51  Free Memory = 88974 MB
Rank =   52  Free Memory = 88974 MB
Rank =   53  Free Memory = 88974 MB
Rank =   54  Free Memory = 88974 MB
Rank =   55  Free Memory = 88974 MB
Rank =   56  Free Memory = 88974 MB
Rank =   57  Free Memory = 88974 MB
Rank =   58  Free Memory = 88974 MB
Rank =   59  Free Memory = 88974 MB
Rank =   60  Free Memory = 88974 MB
Rank =   61  Free Memory = 88974 MB
Rank =   62  Free Memory = 88974 MB
Rank =   63  Free Memory = 88974 MB
Rank =   64  Free Memory = 89267 MB
Rank =   65  Free Memory = 89267 MB
Rank =   66  Free Memory = 89267 MB
Rank =   67  Free Memory = 89266 MB
Rank =   68  Free Memory = 89266 MB
Rank =   69  Free Memory = 89266 MB
Rank =   70  Free Memory = 89266 MB
Rank =   71  Free Memory = 89266 MB
Rank =   72  Free Memory = 89266 MB
Rank =   73  Free Memory = 89266 MB
Rank =   74  Free Memory = 89266 MB
Rank =   75  Free Memory = 89266 MB
Rank =   76  Free Memory = 89266 MB
Rank =   77  Free Memory = 89266 MB
Rank =   78  Free Memory = 89266 MB
Rank =   79  Free Memory = 89266 MB
Rank =   80  Free Memory = 89266 MB
Rank =   81  Free Memory = 89266 MB
Rank =   82  Free Memory = 89266 MB
Rank =   83  Free Memory = 89266 MB
Rank =   84  Free Memory = 89266 MB
Rank =   85  Free Memory = 89266 MB
Rank =   86  Free Memory = 89266 MB
Rank =   87  Free Memory = 89266 MB
Rank =   88  Free Memory = 89266 MB
Rank =   89  Free Memory = 89266 MB
Rank =   90  Free Memory = 89266 MB
Rank =   91  Free Memory = 89266 MB
Rank =   92  Free Memory = 89266 MB
Rank =   93  Free Memory = 89266 MB
Rank =   94  Free Memory = 89266 MB
Rank =   95  Free Memory = 89266 MB
Rank =   96  Free Memory = 84992 MB
Rank =   97  Free Memory = 84992 MB
Rank =   98  Free Memory = 84992 MB
Rank =   99  Free Memory = 84992 MB
Rank =  100  Free Memory = 84992 MB
Rank =  101  Free Memory = 84992 MB
Rank =  102  Free Memory = 84992 MB
Rank =  103  Free Memory = 84992 MB
Rank =  104  Free Memory = 84992 MB
Rank =  105  Free Memory = 84992 MB
Rank =  106  Free Memory = 84992 MB
Rank =  107  Free Memory = 84992 MB
Rank =  108  Free Memory = 84992 MB
Rank =  109  Free Memory = 84992 MB
Rank =  110  Free Memory = 84992 MB
Rank =  111  Free Memory = 84992 MB
Rank =  112  Free Memory = 84992 MB
Rank =  113  Free Memory = 84992 MB
Rank =  114  Free Memory = 84992 MB
Rank =  115  Free Memory = 84992 MB
Rank =  116  Free Memory = 84992 MB
Rank =  117  Free Memory = 84992 MB
Rank =  118  Free Memory = 84992 MB
Rank =  119  Free Memory = 84992 MB
Rank =  120  Free Memory = 84992 MB
Rank =  121  Free Memory = 84992 MB
Rank =  122  Free Memory = 84992 MB
Rank =  123  Free Memory = 84992 MB
Rank =  124  Free Memory = 84992 MB
Rank =  125  Free Memory = 84992 MB
Rank =  126  Free Memory = 84992 MB
Rank =  127  Free Memory = 84992 MB
  Input file(s): opt_h2o_gs_tett_run001d.xml 

=====================================================
                    QMCPACK 3.7.9

       (c) Copyright 2003-  QMCPACK developers

                    Please cite:
 J. Kim et al. J. Phys. Cond. Mat. 30 195901 (2018)
      https://doi.org/10.1088/1361-648X/aab9c3

  Git branch: gvp
  Last git commit: a1d851bbe8d902a0d3168a885b757a378aeaab54-dirty
  Last git commit date: Mon Feb 13 11:52:39 2023 -0800
  Last git commit subject: Print param update magnitude and largest update
=====================================================
  Global options 

  Total number of MPI ranks = 128
  Number of MPI groups      = 1
  MPI group ID              = 0
  Number of ranks in group  = 128
  MPI ranks per node        = 32
  OMP 1st level threads     = 1
  OMP nested threading disabled or only 1 thread on the 2nd level

  Precision used in this calculation, see definitions in the manual:
  Base precision      = double
  Full precision      = double

  Structure-of-arrays (SoA) optimization enabled

  Input XML = opt_h2o_gs_tett_run001d.xml

  Project = H2O
  date    = 2023-03-06 23:02:31 PST
  host    = n0020.savio3

 Random Number
 -------------
  Offset for the random number seeds based on time: 391

  Range of prime numbers to use as seeds over processors and threads = 2699-3733


 Particle Set 
 ------------
  Name: e
  All the species have the same mass 1
  Particle set size: 8

 Particle Set 
 ------------
  Name: ion0
  All the species have the same mass 1
  Particle set size: 3

 Wavefunction setup: 
 ------------------- 
  Name: psi0

   Jastrow
   -------
    Name: J2   Type: Two-Body   Function: Bspline

    Radial function for species: u - u
     Number of parameters: 10
     Cusp: -0.25
     Cutoff radius: 10

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     uu_0                 1.976955e-01    1         1  ON     0
     uu_1                 4.326323e-02    1         1  ON     1
     uu_2                -4.191474e-02    1         1  ON     2
     uu_3                -9.236738e-02    1         1  ON     3
     uu_4                -1.237747e-01    1         1  ON     4
     uu_5                -1.319037e-01    1         1  ON     5
     uu_6                -1.106952e-01    1         1  ON     6
     uu_7                -4.244237e-02    1         1  ON     7
     uu_8                 8.655817e-02    1         1  ON     8
     uu_9                 1.220471e-01    1         1  ON     9

    Radial function for species: u - d
     Number of parameters: 10
     Cusp: -5.000000e-01
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     ud_0                 3.028145e-01    1         1  ON     0
     ud_1                 7.596782e-02    1         1  ON     1
     ud_2                -1.839231e-02    1         1  ON     2
     ud_3                -6.881992e-02    1         1  ON     3
     ud_4                -1.085214e-01    1         1  ON     4
     ud_5                -1.357860e-01    1         1  ON     5
     ud_6                -1.370235e-01    1         1  ON     6
     ud_7                -9.613799e-02    1         1  ON     7
     ud_8                 1.435756e-03    1         1  ON     8
     ud_9                 9.067639e-02    1         1  ON     9


   Jastrow
   -------
    Name: J1   Type: One-Body   Function: Bspline

    Radial function for element: O
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

     Name                        Value Type Recompute Use Index
     ---- ---------------------------- ---- --------- --- -----
     eO_0                -6.845788e-01    1         1  ON     0
     eO_1                -4.098270e-01    1         1  ON     1
     eO_2                -4.967682e-02    1         1  ON     2
     eO_3                 1.714303e-01    1         1  ON     3
     eO_4                 2.548431e-01    1         1  ON     4
     eO_5                 2.931036e-01    1         1  ON     5
     eO_6                 2.514037e-01    1         1  ON     6
     eO_7                 1.164447e-01    1         1  ON     7
     eO_8                 2.795919e-02    1         1  ON     8
     eO_9                 1.837528e-02    1         1  ON     9

    Radial function for element: H1
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH1_0                -1.951466e-01    1         1  ON     0
     eH1_1                -9.635501e-02    1         1  ON     1
     eH1_2                -4.934629e-02    1         1  ON     2
     eH1_3                -1.903088e-02    1         1  ON     3
     eH1_4                 1.661999e-02    1         1  ON     4
     eH1_5                 2.426341e-02    1         1  ON     5
     eH1_6                 7.675645e-02    1         1  ON     6
     eH1_7                 1.107465e-01    1         1  ON     7
     eH1_8                 9.199321e-02    1         1  ON     8
     eH1_9                 2.426879e-02    1         1  ON     9

    Radial function for element: H2
     Number of parameters: 10
     Cusp: 0.000000e+00
     Cutoff radius: 1.000000e+01

      Name                        Value Type Recompute Use Index
     ----- ---------------------------- ---- --------- --- -----
     eH2_0                -1.961133e-01    1         1  ON     0
     eH2_1                -9.717268e-02    1         1  ON     1
     eH2_2                -5.034852e-02    1         1  ON     2
     eH2_3                -2.019455e-02    1         1  ON     3
     eH2_4                 1.552415e-02    1         1  ON     4
     eH2_5                 2.429685e-02    1         1  ON     5
     eH2_6                 7.654507e-02    1         1  ON     6
     eH2_7                 1.129438e-01    1         1  ON     7
     eH2_8                 9.604869e-02    1         1  ON     8
     eH2_9                 2.646592e-02    1         1  ON     9

  Created SPOSet builder named 'LCAOBSet' of type molecularorbital
  LCAO: SoaAtomicBasisSet<MultiQuintic,0>
  AO BasisSet for O
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
   R(n,l,m,s) 3 1 0 0
   R(n,l,m,s) 4 2 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
Adding 3 cartesian gaussian orbitals for l= 1
Adding 6 cartesian gaussian orbitals for l= 2
  Setting cutoff radius 1.018591e+01

   Maximum Angular Momentum  = 2
   Number of Radial functors = 5
   Basis size                = 14

  AO BasisSet for H1
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

  AO BasisSet for H2
   Angular momentum expanded in cartesian functions x^lx y^ly z^lz according to Gamess
Using log grid with default values: ri = 1.000000e-06 rf = 1.000000e+02 npts = 1001
   R(n,l,m,s) 0 0 0 0
   R(n,l,m,s) 1 0 0 0
   R(n,l,m,s) 2 1 0 0
Expanding Ylm (angular function) according to Gamess using cartesian gaussians
Adding 1 cartesian gaussian orbitals for l= 0
Adding 1 cartesian gaussian orbitals for l= 0
Adding 3 cartesian gaussian orbitals for l= 1
  Setting cutoff radius 1.270574e+01

   Maximum Angular Momentum  = 1
   Number of Radial functors = 3
   Basis size                = 5

Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-up
  Building SPOSet 'spo-up' with '' basis set.
Creating SPOSet in SlaterDetBuilder::put(xmlNodePtr cur).
spo_name = spo-dn
  Building SPOSet 'spo-dn' with '' basis set.
Using Bryan's algorithm for MultiSlaterDeterminant expansion. 
Creating base determinant (up) for MSD expansion. 
Creating base determinant (down) for MSD expansion. 
Found determinant list. 
Reading CI expansion.
Found 70 terms in the MSD expansion.
Norm of ci vector (sum of ci^2): 9.698206e-01
Norm of qchem ci vector (sum of qchem_ci^2): 0.000000e+00
Found 26 unique up determinants.
Found 26 unique down determinants.
Number of terms in pairs array: 22
Number of terms in pairs array: 22
CI coefficients are not optimizable. 
  FermionWF = MultiSlaterDeterminantFast
  QMCHamiltonian::addOperator Kinetic to H, physical Hamiltonian 
  QMCHamiltonian::addOperator ElecElec to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named ElecElec

  ECPotential builder for pseudopotential 

  Adding pseudopotential for O
   Linear grid  ri=0.000000e+00 rf=1.000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.075000e+00
  Using global grid with delta = 1.000000e-03
   Making L=1 a local potential with a radial cutoff of 9.999000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.075000e+00
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0750000000e+00

  Adding pseudopotential for H1
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03

  Adding pseudopotential for H2
   Linear grid  ri=0.0000000000e+00 rf=1.0000000000e+01 npts = 10001
    ECPComponentBuilder::buildSemiLocalAndLocal 
    Assuming Hartree unit
   Number of angular momentum channels 2
   Maximum angular momentum channel 1
   Creating a Linear Grid Rmax=1.0000000000e-10
  Using global grid with delta = 1.0000000000e-03
   Making L=1 a local potential with a radial cutoff of 9.9990000000e+00
    Non-local pseudopotential parameters
    Maximum angular mementum = 0
    Number of non-local channels = 1
       l(0)=0
    Cutoff radius = 1.0000000000e-03
    Spherical grids and weights: 
         1.0000000000e+00  0.0000000000e+00  0.0000000000e+00    8.3333333333e-02
        -1.0000000000e+00  1.2246467991e-16  0.0000000000e+00    8.3333333333e-02
         4.4721359550e-01  8.9442719100e-01  0.0000000000e+00    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01  8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01  5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -8.9442719100e-01  1.0953573965e-16    8.3333333333e-02
         4.4721359550e-01 -7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
        -4.4721359550e-01 -2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
         4.4721359550e-01  2.7639320225e-01 -8.5065080835e-01    8.3333333333e-02
        -4.4721359550e-01  7.2360679775e-01 -5.2573111212e-01    8.3333333333e-02
    Maximum cutoff radius 1.0000000000e-03
  QMCHamiltonian::addOperator LocalECP to H, physical Hamiltonian 

  Using NonLocalECP potential 
    Maximum grid on a sphere for NonLocalECPotential: 12
  QMCHamiltonian::addOperator NonLocalECP to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type pseudo named NonLocalECP
  QMCHamiltonian::addOperator IonIon to H, physical Hamiltonian 
QMCHamiltonian::addOperatorType added type coulomb named IonIon

  QMCHamiltonian::add2WalkerProperty added
    5 to P::PropertyList 
    0 to P::Collectables 
    starting Index of the observables in P::PropertyList = 10
ParticleSetPool::randomize 
  Initialization Execution time = 1.9899e-01 secs
=========================================================
 Summary of QMC systems 
=========================================================
ParticleSetPool has: 

  ParticleSet 'e' contains 8 particles :  u(4) d(4)

    u -2.1647635618e-01 -6.7439216895e-01  1.9880537318e-01
    u -8.6004520714e-01 -3.1964226924e-01  6.9171823675e-02
    u -1.1165451895e+00 -5.3850544216e-01 -4.9152162246e-01
    u -4.0992137844e-01  2.3431241626e+00  1.4534834924e+00
    d -6.4716027047e-02 -8.0296334917e-01 -7.3676750950e-01
    d -4.9793133381e-01 -5.0450915047e-01 -7.6892777308e-01
    d  1.5908260425e-01  3.7531282770e-01 -1.4289189837e-01
    d -1.4507602779e-01 -1.2740118097e+00  2.0922709319e-01

  Distance table for similar particles (A-A):
    source/target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.

  Distance table for dissimilar particles (A-B):
    source: ion0  target: e
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  ParticleSet 'ion0' contains 3 particles :  O(1) H1(1) H2(1)

    O  0.0000000000e+00  0.0000000000e+00 -1.3209751581e-01
    H1  0.0000000000e+00  1.4315279079e+00  9.7970009311e-01
    H2  0.0000000000e+00 -1.4315279079e+00  9.7970009311e-01

  Distance table for similar particles (A-A):
    source/target: ion0
    Using structure-of-arrays (SoA) data layout
    Distance computations use open boundary conditions in 3D.


  Hamiltonian h0
  Kinetic         Kinetic energy
  ElecElec        CoulombAA source/target e

  LocalECP        LocalECPotential: ion0
  NonLocalECP     NonLocalECPotential: ion0
  IonIon          CoulombAA source/target ion0


Loop execution max-interations = 60
Inside LM engine constructor, num_params is: 0 and _total_num_params is: 0

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s000 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15
  Adding 1 walkers to 0 existing sets
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02

=========================================================
  Start VMC
  File Root H2O.s000 append = no 
=========================================================
Resetting walkers
  Using the current 1 walkers.
  Total number of walkers: 1.2800000000e+02
  Total weight: 1.2800000000e+02
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=0  my_counter=0
  time step      = 5.0000000000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000000000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000000000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000000000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000000000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000000000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000000000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000000000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000000000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625000000e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000000000e-02</parameter>
<parameter name="time_step" condition="au">5.0000000000e-02</parameter>
<parameter name="timestep" condition="au">5.0000000000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000000000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: 0 and ratio_threshold_: 0.0000000000e+00
Allocating full size _hmat_temp and _smat_temp
Inside LM engine's get_param, num_params is: 50
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.1952
    reference variance = 0.238455
====================================================
  Execution time = 2.0880e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s000
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7987e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5726e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279869850374
                                         uncertainty =       0.002526562382

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279869850374
                                         uncertainty =       0.002526562382

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374077955
  error estimate for blocks of size 2^( 2) =       0.000387779263
  error estimate for blocks of size 2^( 3) =       0.000400567393
  error estimate for blocks of size 2^( 4) =       0.000409866896
  error estimate for blocks of size 2^( 5) =       0.000415054144
  error estimate for blocks of size 2^( 6) =       0.000418572805
  error estimate for blocks of size 2^( 7) =       0.000418858466

      target function =      -0.944844677476
              le_mean =     -17.212273212214
             les_mean =     296.542217624906
             stat err =       0.000415588078
             autocorr =       1.234246572657
   target nu stat err =       0.000415588078
   target dn stat err =       0.002552717939
      target stat err =       0.004476685067
              std dev =       0.529026117438
             le_variance =       0.279868632931


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy-1.721227321221e+01 
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e-01, overlap shift 2.5000e+00 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944864943513       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944941654575       residual = 8.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944967519800       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944989811275       residual = 7.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944998576222       residual = 3.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945013383828       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945024044267       residual = 2.54e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945027455702       residual = 1.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945029344994       residual = 3.06e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945030930266       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945033781891       residual = 1.99e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945034918762       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945036768727       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945038122849       residual = 8.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.945038166289       residual = 4.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945038808060       residual = 3.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.945039192809       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945040374776       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945040587130       residual = 8.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945040398593       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945040464465       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945040587530       residual = 4.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945040708759       residual = 8.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945040732506       residual = 2.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.945040719657       residual = 5.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e-01 is 2.151060e-03

solving harmonic davidson linear method for identity shift 1.0000e+00, overlap shift 1.0000e+01 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944864943513       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944888309020       residual = 8.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944896848962       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944902961321       residual = 7.49e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944905422614       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944909825037       residual = 2.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944912845090       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944913964749       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944914530763       residual = 2.77e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944914966830       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944915688885       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944916073680       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944916537382       residual = 9.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944916871369       residual = 6.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944916869559       residual = 3.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944917018215       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944917110644       residual = 2.21e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944917379612       residual = 7.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944917425550       residual = 5.81e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944917367730       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944917379215       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944917424435       residual = 5.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944917429430       residual = 1.30e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944917426289       residual = 2.17e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.944917425595       residual = 2.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+00 is 5.484531e-04

solving harmonic davidson linear method for identity shift 4.0000e+00, overlap shift 4.0000e+01 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944864943513       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944871122161       residual = 8.89e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944873433719       residual = 9.69e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944875003740       residual = 7.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944875631587       residual = 3.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944876787042       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944877570187       residual = 2.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944877869000       residual = 9.91e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944878018035       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944878129654       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944878308652       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944878414061       residual = 1.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944878529446       residual = 8.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944878611706       residual = 5.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944878610596       residual = 3.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944878646480       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944878669470       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944878734382       residual = 6.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944878745258       residual = 5.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944878730132       residual = 1.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944878732736       residual = 7.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944878741416       residual = 1.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944878744192       residual = 3.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944878744003       residual = 7.34e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+00 is 1.370439e-04

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.693012 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7159e+01
  </log>
  <optVariables href="H2O.s000.opt.xml">
uu_0  1.979049e-01                 1 1 ON  0
uu_1  4.348781e-02                 1 1 ON  1
uu_2  -4.177658e-02                1 1 ON  2
uu_3  -9.231340e-02                1 1 ON  3
uu_4  -1.237423e-01                1 1 ON  4
uu_5  -1.318975e-01                1 1 ON  5
uu_6  -1.106823e-01                1 1 ON  6
uu_7  -4.284454e-02                1 1 ON  7
uu_8  8.600972e-02                 1 1 ON  8
uu_9  1.221696e-01                 1 1 ON  9
ud_0  3.025833e-01                 1 1 ON  10
ud_1  7.589824e-02                 1 1 ON  11
ud_2  -1.864542e-02                1 1 ON  12
ud_3  -6.908315e-02                1 1 ON  13
ud_4  -1.086121e-01                1 1 ON  14
ud_5  -1.355330e-01                1 1 ON  15
ud_6  -1.366250e-01                1 1 ON  16
ud_7  -9.579270e-02                1 1 ON  17
ud_8  1.257108e-03                 1 1 ON  18
ud_9  9.059190e-02                 1 1 ON  19
eO_0  -6.846978e-01                1 1 ON  20
eO_1  -4.099369e-01                1 1 ON  21
eO_2  -4.947277e-02                1 1 ON  22
eO_3  1.715428e-01                 1 1 ON  23
eO_4  2.544812e-01                 1 1 ON  24
eO_5  2.929289e-01                 1 1 ON  25
eO_6  2.515444e-01                 1 1 ON  26
eO_7  1.167290e-01                 1 1 ON  27
eO_8  2.798167e-02                 1 1 ON  28
eO_9  1.836838e-02                 1 1 ON  29
eH1_0 -1.956397e-01                1 1 ON  30
eH1_1 -9.644781e-02                1 1 ON  31
eH1_2 -4.918723e-02                1 1 ON  32
eH1_3 -1.891943e-02                1 1 ON  33
eH1_4 1.673694e-02                 1 1 ON  34
eH1_5 2.435798e-02                 1 1 ON  35
eH1_6 7.661574e-02                 1 1 ON  36
eH1_7 1.107822e-01                 1 1 ON  37
eH1_8 9.215843e-02                 1 1 ON  38
eH1_9 2.430804e-02                 1 1 ON  39
eH2_0 -1.963977e-01                1 1 ON  40
eH2_1 -9.713086e-02                1 1 ON  41
eH2_2 -5.011033e-02                1 1 ON  42
eH2_3 -1.997307e-02                1 1 ON  43
eH2_4 1.556772e-02                 1 1 ON  44
eH2_5 2.411397e-02                 1 1 ON  45
eH2_6 7.637520e-02                 1 1 ON  46
eH2_7 1.128797e-01                 1 1 ON  47
eH2_8 9.616235e-02                 1 1 ON  48
eH2_9 2.650300e-02                 1 1 ON  49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 0
    time step          = 0.05
    reference energy   = -17.2612
    reference variance = 0.395842
====================================================
  Execution time = 2.1071e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s000
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8043e-01
  Total weights = 2.0000e+06
  Execution time = 1.8442e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280413137006
                                         uncertainty =       0.003400927628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280413137006
                                         uncertainty =       0.003400927628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374450858
  error estimate for blocks of size 2^( 2) =       0.000388152115
  error estimate for blocks of size 2^( 3) =       0.000399899741
  error estimate for blocks of size 2^( 4) =       0.000408739437
  error estimate for blocks of size 2^( 5) =       0.000413998675
  error estimate for blocks of size 2^( 6) =       0.000416826176
  error estimate for blocks of size 2^( 7) =       0.000419158249

      target function =      -0.943829027179
              le_mean =     -17.213051467740
             les_mean =     296.569567581077
             stat err =       0.000414680634
             autocorr =       1.226416112805
   target nu stat err =       0.000414680634
   target dn stat err =       0.003367438511
      target stat err =       0.005865343321
              std dev =       0.529553481918
             le_variance =       0.280426890211

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280449315380
                                         uncertainty =       0.003404203664

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280449315380
                                         uncertainty =       0.003404203664

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374474849
  error estimate for blocks of size 2^( 2) =       0.000388182792
  error estimate for blocks of size 2^( 3) =       0.000399959541
  error estimate for blocks of size 2^( 4) =       0.000408826444
  error estimate for blocks of size 2^( 5) =       0.000414106760
  error estimate for blocks of size 2^( 6) =       0.000416935157
  error estimate for blocks of size 2^( 7) =       0.000419255863

      target function =      -0.943766632256
              le_mean =     -17.213057661534
             les_mean =     296.569816743486
             stat err =       0.000414781056
             autocorr =       1.226852968462
   target nu stat err =       0.000414781056
   target dn stat err =       0.003369241168
      target stat err =       0.005867755673
              std dev =       0.529587409617
             le_variance =       0.280462824425

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280429795616
                                         uncertainty =       0.003402907876

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280429795616
                                         uncertainty =       0.003402907876

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374461884
  error estimate for blocks of size 2^( 2) =       0.000388166056
  error estimate for blocks of size 2^( 3) =       0.000399929959
  error estimate for blocks of size 2^( 4) =       0.000408784838
  error estimate for blocks of size 2^( 5) =       0.000414055782
  error estimate for blocks of size 2^( 6) =       0.000416883205
  error estimate for blocks of size 2^( 7) =       0.000419208412

      target function =      -0.943800351469
              le_mean =     -17.213054157267
             les_mean =     296.569676686144
             stat err =       0.000414733059
             autocorr =       1.226653985563
   target nu stat err =       0.000414733059
   target dn stat err =       0.003368544302
      target stat err =       0.005866926741
              std dev =       0.529569075144
             le_variance =       0.280443405349

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280414516596
                                         uncertainty =       0.003401193250

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280414516596
                                         uncertainty =       0.003401193250

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374451767
  error estimate for blocks of size 2^( 2) =       0.000388153290
  error estimate for blocks of size 2^( 3) =       0.000399902944
  error estimate for blocks of size 2^( 4) =       0.000408744546
  error estimate for blocks of size 2^( 5) =       0.000414005262
  error estimate for blocks of size 2^( 6) =       0.000416832711
  error estimate for blocks of size 2^( 7) =       0.000419163874

      target function =      -0.943826664337
              le_mean =     -17.213051658572
             les_mean =     296.569575511555
             stat err =       0.000414686598
             autocorr =       1.226445440449
   target nu stat err =       0.000414686598
   target dn stat err =       0.003367589067
      target stat err =       0.005865575647
              std dev =       0.529554766858
             le_variance =       0.280428251102


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943829027179        initial  <--
     2.5000e-01     2.5000e+00             2.1511e-03        -0.943766632256
     1.0000e+00     1.0000e+01             5.4845e-04        -0.943800351469
     4.0000e+00     4.0000e+01             1.3704e-04        -0.943826664337

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.4112
  </log>
  <optVariables href="H2O.s000.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7578e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s001 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s001 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=1  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7228e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.3221
    reference variance = 0.328826
====================================================
  Execution time = 2.0495e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s001
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8248e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6406e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282527694185
                                         uncertainty =       0.002615282215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282527694185
                                         uncertainty =       0.002615282215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375822517
  error estimate for blocks of size 2^( 2) =       0.000389127941
  error estimate for blocks of size 2^( 3) =       0.000401406946
  error estimate for blocks of size 2^( 4) =       0.000411561559
  error estimate for blocks of size 2^( 5) =       0.000417192461
  error estimate for blocks of size 2^( 6) =       0.000420446912
  error estimate for blocks of size 2^( 7) =       0.000422372846

      target function =      -0.940364266445
              le_mean =     -17.211881626085
             les_mean =     296.531354097517
             stat err =       0.000417893445
             autocorr =       1.236418583688
   target nu stat err =       0.000417893445
   target dn stat err =       0.002590618966
      target stat err =       0.004496183913
              std dev =       0.531493300413
             le_variance =       0.282485128384


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721188162609e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+00, overlap shift 2.5000e+01 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940384506797       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940396941713       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940400841197       residual = 8.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940402848612       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940405506636       residual = 5.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940406640056       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940407439576       residual = 3.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940408568880       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940409244394       residual = 3.49e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940409490579       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.940409852677       residual = 4.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.940410375435       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.940410541686       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.940410664574       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.940410751331       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.940410747209       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.940410826927       residual = 2.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.940410825729       residual = 4.99e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.940410868432       residual = 7.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.940410856469       residual = 3.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.940410891939       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.940410893612       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.940410892866       residual = 5.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.940410898286       residual = 7.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+00 is 2.238190e-04

solving harmonic davidson linear method for identity shift 1.0000e+01, overlap shift 1.0000e+02 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940384506797       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940387687389       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940388688656       residual = 8.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940389203000       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940389875529       residual = 5.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940390163789       residual = 2.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940390366753       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940390654980       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940390826622       residual = 3.45e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940390889256       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.940390980778       residual = 4.02e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.940391112140       residual = 1.40e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.940391153528       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.940391184040       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.940391205426       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.940391204180       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.940391224037       residual = 2.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.940391223424       residual = 4.75e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.940391234003       residual = 6.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.940391230965       residual = 3.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.940391239820       residual = 3.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.940391240087       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.940391239858       residual = 4.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.940391241164       residual = 6.59e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+01 is 5.662036e-05

solving harmonic davidson linear method for identity shift 4.0000e+01, overlap shift 4.0000e+02 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940384506797       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940385306567       residual = 1.46e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940385558585       residual = 8.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940385687999       residual = 1.03e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940385856622       residual = 5.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940385928997       residual = 2.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940385979939       residual = 3.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940386052369       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940386095456       residual = 3.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940386111184       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.940386134128       residual = 4.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.940386167009       residual = 1.39e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.940386177344       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.940386184958       residual = 5.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.940386190284       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.940386189960       residual = 2.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.940386194919       residual = 2.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.940386194746       residual = 4.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.940386197384       residual = 6.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.940386196622       residual = 3.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.940386198835       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.940386198892       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.940386198832       residual = 4.82e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.940386199156       residual = 6.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+01 is 1.419729e-05

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.711899 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6166e+01
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.977248e-01 1 1  ON 0
 uu_1                 4.328554e-02 1 1  ON 1
 uu_2                -4.190195e-02 1 1  ON 2
 uu_3                -9.236531e-02 1 1  ON 3
 uu_4                -1.237737e-01 1 1  ON 4
 uu_5                -1.319092e-01 1 1  ON 5
 uu_6                -1.107093e-01 1 1  ON 6
 uu_7                -4.246889e-02 1 1  ON 7
 uu_8                 8.651161e-02 1 1  ON 8
 uu_9                 1.220560e-01 1 1  ON 9
 ud_0                 3.027843e-01 1 1  ON 10
 ud_1                 7.595821e-02 1 1  ON 11
 ud_2                -1.842104e-02 1 1  ON 12
 ud_3                -6.885294e-02 1 1  ON 13
 ud_4                -1.085243e-01 1 1  ON 14
 ud_5                -1.357436e-01 1 1  ON 15
 ud_6                -1.369669e-01 1 1  ON 16
 ud_7                -9.611017e-02 1 1  ON 17
 ud_8                 1.406734e-03 1 1  ON 18
 ud_9                 9.066335e-02 1 1  ON 19
 eO_0                -6.846072e-01 1 1  ON 20
 eO_1                -4.098582e-01 1 1  ON 21
 eO_2                -4.966219e-02 1 1  ON 22
 eO_3                 1.714564e-01 1 1  ON 23
 eO_4                 2.548565e-01 1 1  ON 24
 eO_5                 2.930500e-01 1 1  ON 25
 eO_6                 2.514295e-01 1 1  ON 26
 eO_7                 1.164754e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837632e-02 1 1  ON 29
eH1_0                -1.951788e-01 1 1  ON 30
eH1_1                -9.633720e-02 1 1  ON 31
eH1_2                -4.932274e-02 1 1  ON 32
eH1_3                -1.900522e-02 1 1  ON 33
eH1_4                 1.661417e-02 1 1  ON 34
eH1_5                 2.422971e-02 1 1  ON 35
eH1_6                 7.674046e-02 1 1  ON 36
eH1_7                 1.107466e-01 1 1  ON 37
eH1_8                 9.200856e-02 1 1  ON 38
eH1_9                 2.427252e-02 1 1  ON 39
eH2_0                -1.961434e-01 1 1  ON 40
eH2_1                -9.714981e-02 1 1  ON 41
eH2_2                -5.032269e-02 1 1  ON 42
eH2_3                -2.017241e-02 1 1  ON 43
eH2_4                 1.551192e-02 1 1  ON 44
eH2_5                 2.425732e-02 1 1  ON 45
eH2_6                 7.654349e-02 1 1  ON 46
eH2_7                 1.129394e-01 1 1  ON 47
eH2_8                 9.606067e-02 1 1  ON 48
eH2_9                 2.647071e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 1
    time step          = 0.05
    reference energy   = -17.1212
    reference variance = 0.280328
====================================================
  Execution time = 2.2033e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s001
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8256e-01
  Total weights = 2.0000e+06
  Execution time = 1.8351e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282614165039
                                         uncertainty =       0.002934413447

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282614165039
                                         uncertainty =       0.002934413447

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375872037
  error estimate for blocks of size 2^( 2) =       0.000389579382
  error estimate for blocks of size 2^( 3) =       0.000402125275
  error estimate for blocks of size 2^( 4) =       0.000410497185
  error estimate for blocks of size 2^( 5) =       0.000415376462
  error estimate for blocks of size 2^( 6) =       0.000418574797
  error estimate for blocks of size 2^( 7) =       0.000421285730

      target function =      -0.940234700419
              le_mean =     -17.211746642327
             les_mean =     296.526781915455
             stat err =       0.000416433543
             autocorr =       1.227471372790
   target nu stat err =       0.000416433543
   target dn stat err =       0.003089154003
      target stat err =       0.005335462152
              std dev =       0.531563333074
             le_variance =       0.282559577068

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282619449781
                                         uncertainty =       0.002934021026

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282619449781
                                         uncertainty =       0.002934021026

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375875535
  error estimate for blocks of size 2^( 2) =       0.000389584263
  error estimate for blocks of size 2^( 3) =       0.000402133518
  error estimate for blocks of size 2^( 4) =       0.000410510174
  error estimate for blocks of size 2^( 5) =       0.000415393475
  error estimate for blocks of size 2^( 6) =       0.000418591628
  error estimate for blocks of size 2^( 7) =       0.000421304120

      target function =      -0.940225747608
              le_mean =     -17.211746023581
             les_mean =     296.526765874837
             stat err =       0.000416449849
             autocorr =       1.227544655276
   target nu stat err =       0.000416449849
   target dn stat err =       0.003088805342
      target stat err =       0.005334769302
              std dev =       0.531568279572
             le_variance =       0.282564835847

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282616756552
                                         uncertainty =       0.002934211790

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282616756552
                                         uncertainty =       0.002934211790

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375873752
  error estimate for blocks of size 2^( 2) =       0.000389581787
  error estimate for blocks of size 2^( 3) =       0.000402129375
  error estimate for blocks of size 2^( 4) =       0.000410503690
  error estimate for blocks of size 2^( 5) =       0.000415385010
  error estimate for blocks of size 2^( 6) =       0.000418583251
  error estimate for blocks of size 2^( 7) =       0.000421294981

      target function =      -0.940230313073
              le_mean =     -17.211746303453
             les_mean =     296.526772828433
             stat err =       0.000416441733
             autocorr =       1.227508452297
   target nu stat err =       0.000416441733
   target dn stat err =       0.003088974217
      target stat err =       0.005335107195
              std dev =       0.531565758185
             le_variance =       0.282562155275

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282614478599
                                         uncertainty =       0.002934388055

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282614478599
                                         uncertainty =       0.002934388055

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375872245
  error estimate for blocks of size 2^( 2) =       0.000389579675
  error estimate for blocks of size 2^( 3) =       0.000402125779
  error estimate for blocks of size 2^( 4) =       0.000410497991
  error estimate for blocks of size 2^( 5) =       0.000415377524
  error estimate for blocks of size 2^( 6) =       0.000418575847
  error estimate for blocks of size 2^( 7) =       0.000421286880

      target function =      -0.940234169898
              le_mean =     -17.211746597289
             les_mean =     296.526780676950
             stat err =       0.000416434560
             autocorr =       1.227476012358
   target nu stat err =       0.000416434560
   target dn stat err =       0.003089131344
      target stat err =       0.005335417639
              std dev =       0.531563626441
             le_variance =       0.282559888955


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940234700419        initial  <--
     2.5000e+00     2.5000e+01             2.2382e-04        -0.940225747608
     1.0000e+01     1.0000e+02             5.6620e-05        -0.940230313073
     4.0000e+01     4.0000e+02             1.4197e-05        -0.940234169898

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.3151
  </log>
  <optVariables href="H2O.s001.opt.xml">
 uu_0                 1.976955e-01 1 1  ON 0
 uu_1                 4.326323e-02 1 1  ON 1
 uu_2                -4.191474e-02 1 1  ON 2
 uu_3                -9.236738e-02 1 1  ON 3
 uu_4                -1.237747e-01 1 1  ON 4
 uu_5                -1.319037e-01 1 1  ON 5
 uu_6                -1.106952e-01 1 1  ON 6
 uu_7                -4.244237e-02 1 1  ON 7
 uu_8                 8.655817e-02 1 1  ON 8
 uu_9                 1.220471e-01 1 1  ON 9
 ud_0                 3.028145e-01 1 1  ON 10
 ud_1                 7.596782e-02 1 1  ON 11
 ud_2                -1.839231e-02 1 1  ON 12
 ud_3                -6.881992e-02 1 1  ON 13
 ud_4                -1.085214e-01 1 1  ON 14
 ud_5                -1.357860e-01 1 1  ON 15
 ud_6                -1.370235e-01 1 1  ON 16
 ud_7                -9.613799e-02 1 1  ON 17
 ud_8                 1.435756e-03 1 1  ON 18
 ud_9                 9.067639e-02 1 1  ON 19
 eO_0                -6.845788e-01 1 1  ON 20
 eO_1                -4.098270e-01 1 1  ON 21
 eO_2                -4.967682e-02 1 1  ON 22
 eO_3                 1.714303e-01 1 1  ON 23
 eO_4                 2.548431e-01 1 1  ON 24
 eO_5                 2.931036e-01 1 1  ON 25
 eO_6                 2.514037e-01 1 1  ON 26
 eO_7                 1.164447e-01 1 1  ON 27
 eO_8                 2.795919e-02 1 1  ON 28
 eO_9                 1.837528e-02 1 1  ON 29
eH1_0                -1.951466e-01 1 1  ON 30
eH1_1                -9.635501e-02 1 1  ON 31
eH1_2                -4.934629e-02 1 1  ON 32
eH1_3                -1.903088e-02 1 1  ON 33
eH1_4                 1.661999e-02 1 1  ON 34
eH1_5                 2.426341e-02 1 1  ON 35
eH1_6                 7.675645e-02 1 1  ON 36
eH1_7                 1.107465e-01 1 1  ON 37
eH1_8                 9.199321e-02 1 1  ON 38
eH1_9                 2.426879e-02 1 1  ON 39
eH2_0                -1.961133e-01 1 1  ON 40
eH2_1                -9.717268e-02 1 1  ON 41
eH2_2                -5.034852e-02 1 1  ON 42
eH2_3                -2.019455e-02 1 1  ON 43
eH2_4                 1.552415e-02 1 1  ON 44
eH2_5                 2.429685e-02 1 1  ON 45
eH2_6                 7.654507e-02 1 1  ON 46
eH2_7                 1.129438e-01 1 1  ON 47
eH2_8                 9.604869e-02 1 1  ON 48
eH2_9                 2.646592e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7488e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s002 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s002 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=2  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7225e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.2158
    reference variance = 0.187319
====================================================
  Execution time = 2.0492e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s002
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7786e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6208e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277870406603
                                         uncertainty =       0.002158068144

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277870406603
                                         uncertainty =       0.002158068144

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372735764
  error estimate for blocks of size 2^( 2) =       0.000386302853
  error estimate for blocks of size 2^( 3) =       0.000399148146
  error estimate for blocks of size 2^( 4) =       0.000408478953
  error estimate for blocks of size 2^( 5) =       0.000414080005
  error estimate for blocks of size 2^( 6) =       0.000417098491
  error estimate for blocks of size 2^( 7) =       0.000418177964

      target function =      -0.948341113757
              le_mean =     -17.211832246700
             les_mean =     296.525033048815
             stat err =       0.000414458853
             autocorr =       1.236404883329
   target nu stat err =       0.000414458853
   target dn stat err =       0.002359183359
      target stat err =       0.004173741264
              std dev =       0.527127972322
             le_variance =       0.277863899204


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721183224670e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948358427862       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948359619789       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948360020555       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948360290523       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948360580270       residual = 5.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948360757561       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948360878097       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948360971308       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948361021027       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948361058410       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948361076735       residual = 4.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.948361116234       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.948361166938       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.948361194522       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.948361197416       residual = 4.78e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.948361206160       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.948361204812       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.948361208230       residual = 4.29e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.948361210591       residual = 7.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.948361213967       residual = 1.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.948361213523       residual = 2.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948361215390       residual = 8.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.948361213529       residual = 3.03e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.948361214122       residual = 9.95e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 2.749934e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948358427862       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948358726554       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948358827004       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948358894716       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948358967179       residual = 5.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948359011592       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948359041758       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948359065109       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948359077560       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948359086917       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948359091497       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.948359101378       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.948359114063       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.948359120948       residual = 8.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.948359121667       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.948359123853       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.948359123513       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.948359124364       residual = 4.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.948359124955       residual = 7.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.948359125797       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.948359125685       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948359126150       residual = 8.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.948359125686       residual = 3.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.948359125834       residual = 9.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 6.879903e-06

solving harmonic davidson linear method for identity shift 4.0000e+02, overlap shift 4.0000e+03 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948358427862       residual = 1.51e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948358502580       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948358527708       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948358544651       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948358562768       residual = 5.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948358573876       residual = 2.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948358581419       residual = 3.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948358587261       residual = 1.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948358590375       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948358592715       residual = 3.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948358593860       residual = 4.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.948358596329       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.948358599503       residual = 1.32e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.948358601223       residual = 8.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.948358601402       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.948358601949       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.948358601863       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.948358602077       residual = 4.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.948358602223       residual = 7.82e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.948358602435       residual = 1.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.948358602408       residual = 2.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948358602522       residual = 8.63e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.948358602406       residual = 3.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.948358602443       residual = 9.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 4.0000e+02 is 1.720293e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.730483 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6143e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.976978e-01 1 1  ON 0
 uu_1                 4.326523e-02 1 1  ON 1
 uu_2                -4.191361e-02 1 1  ON 2
 uu_3                -9.236711e-02 1 1  ON 3
 uu_4                -1.237742e-01 1 1  ON 4
 uu_5                -1.319033e-01 1 1  ON 5
 uu_6                -1.106962e-01 1 1  ON 6
 uu_7                -4.244596e-02 1 1  ON 7
 uu_8                 8.655368e-02 1 1  ON 8
 uu_9                 1.220480e-01 1 1  ON 9
 ud_0                 3.028109e-01 1 1  ON 10
 ud_1                 7.596623e-02 1 1  ON 11
 ud_2                -1.839601e-02 1 1  ON 12
 ud_3                -6.882357e-02 1 1  ON 13
 ud_4                -1.085221e-01 1 1  ON 14
 ud_5                -1.357830e-01 1 1  ON 15
 ud_6                -1.370179e-01 1 1  ON 16
 ud_7                -9.613111e-02 1 1  ON 17
 ud_8                 1.433230e-03 1 1  ON 18
 ud_9                 9.067529e-02 1 1  ON 19
 eO_0                -6.845807e-01 1 1  ON 20
 eO_1                -4.098293e-01 1 1  ON 21
 eO_2                -4.967494e-02 1 1  ON 22
 eO_3                 1.714311e-01 1 1  ON 23
 eO_4                 2.548429e-01 1 1  ON 24
 eO_5                 2.931017e-01 1 1  ON 25
 eO_6                 2.514043e-01 1 1  ON 26
 eO_7                 1.164477e-01 1 1  ON 27
 eO_8                 2.795916e-02 1 1  ON 28
 eO_9                 1.837542e-02 1 1  ON 29
eH1_0                -1.951496e-01 1 1  ON 30
eH1_1                -9.635269e-02 1 1  ON 31
eH1_2                -4.934189e-02 1 1  ON 32
eH1_3                -1.902715e-02 1 1  ON 33
eH1_4                 1.662090e-02 1 1  ON 34
eH1_5                 2.425927e-02 1 1  ON 35
eH1_6                 7.675236e-02 1 1  ON 36
eH1_7                 1.107454e-01 1 1  ON 37
eH1_8                 9.199388e-02 1 1  ON 38
eH1_9                 2.426896e-02 1 1  ON 39
eH2_0                -1.961173e-01 1 1  ON 40
eH2_1                -9.717184e-02 1 1  ON 41
eH2_2                -5.034527e-02 1 1  ON 42
eH2_3                -2.019160e-02 1 1  ON 43
eH2_4                 1.552407e-02 1 1  ON 44
eH2_5                 2.429607e-02 1 1  ON 45
eH2_6                 7.654264e-02 1 1  ON 46
eH2_7                 1.129426e-01 1 1  ON 47
eH2_8                 9.605005e-02 1 1  ON 48
eH2_9                 2.646608e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 2
    time step          = 0.05
    reference energy   = -17.1682
    reference variance = 0.302865
====================================================
  Execution time = 2.0362e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s002
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8000e-01
  Total weights = 2.0000e+06
  Execution time = 1.8361e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279973664582
                                         uncertainty =       0.002663150850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279973664582
                                         uncertainty =       0.002663150850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374168478
  error estimate for blocks of size 2^( 2) =       0.000387695195
  error estimate for blocks of size 2^( 3) =       0.000399694710
  error estimate for blocks of size 2^( 4) =       0.000408473294
  error estimate for blocks of size 2^( 5) =       0.000414186461
  error estimate for blocks of size 2^( 6) =       0.000416551383
  error estimate for blocks of size 2^( 7) =       0.000417250680

      target function =      -0.944630525962
              le_mean =     -17.211717755352
             les_mean =     296.523232050175
             stat err =       0.000414115454
             autocorr =       1.224922131239
   target nu stat err =       0.000414115454
   target dn stat err =       0.002814171219
      target stat err =       0.004914687982
              std dev =       0.529154136606
             le_variance =       0.280004100287

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279973605779
                                         uncertainty =       0.002663157675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279973605779
                                         uncertainty =       0.002663157675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374168437
  error estimate for blocks of size 2^( 2) =       0.000387695407
  error estimate for blocks of size 2^( 3) =       0.000399695380
  error estimate for blocks of size 2^( 4) =       0.000408474557
  error estimate for blocks of size 2^( 5) =       0.000414187943
  error estimate for blocks of size 2^( 6) =       0.000416552908
  error estimate for blocks of size 2^( 7) =       0.000417251857

      target function =      -0.944630635913
              le_mean =     -17.211717696726
             les_mean =     296.523229969911
             stat err =       0.000414116816
             autocorr =       1.224930458259
   target nu stat err =       0.000414116816
   target dn stat err =       0.002814157921
      target stat err =       0.004914666263
              std dev =       0.529154077859
             le_variance =       0.280004038114

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279973634013
                                         uncertainty =       0.002663154267

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279973634013
                                         uncertainty =       0.002663154267

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374168457
  error estimate for blocks of size 2^( 2) =       0.000387695300
  error estimate for blocks of size 2^( 3) =       0.000399695045
  error estimate for blocks of size 2^( 4) =       0.000408473925
  error estimate for blocks of size 2^( 5) =       0.000414187202
  error estimate for blocks of size 2^( 6) =       0.000416552145
  error estimate for blocks of size 2^( 7) =       0.000417251268

      target function =      -0.944630582971
              le_mean =     -17.211717725741
             les_mean =     296.523230998627
             stat err =       0.000414116135
             autocorr =       1.224926299117
   target nu stat err =       0.000414116135
   target dn stat err =       0.002814164554
      target stat err =       0.004914677114
              std dev =       0.529154106126
             le_variance =       0.280004068030

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279973660634
                                         uncertainty =       0.002663151278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279973660634
                                         uncertainty =       0.002663151278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374168476
  error estimate for blocks of size 2^( 2) =       0.000387695208
  error estimate for blocks of size 2^( 3) =       0.000399694752
  error estimate for blocks of size 2^( 4) =       0.000408473373
  error estimate for blocks of size 2^( 5) =       0.000414186554
  error estimate for blocks of size 2^( 6) =       0.000416551478
  error estimate for blocks of size 2^( 7) =       0.000417250754

      target function =      -0.944630533309
              le_mean =     -17.211717751622
             les_mean =     296.523231917629
             stat err =       0.000414115539
             autocorr =       1.224922652253
   target nu stat err =       0.000414115539
   target dn stat err =       0.002814170385
      target stat err =       0.004914686625
              std dev =       0.529154132675
             le_variance =       0.280004096128


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.944630525962        initial
     2.5000e+01     2.5000e+02             2.7499e-05        -0.944630635913  <--
     1.0000e+02     1.0000e+03             6.8799e-06        -0.944630582971
     4.0000e+02     4.0000e+03             1.7203e-06        -0.944630533309

*****************************************************************************
Applying the update for shift_i =   2.5000e+01     and shift_s =   2.5000e+02
*****************************************************************************

  Execution time = 2.9650e+01
  </log>
  <optVariables href="H2O.s002.opt.xml">
 uu_0                 1.977050e-01 1 1  ON 0
 uu_1                 4.327121e-02 1 1  ON 1
 uu_2                -4.191020e-02 1 1  ON 2
 uu_3                -9.236629e-02 1 1  ON 3
 uu_4                -1.237726e-01 1 1  ON 4
 uu_5                -1.319021e-01 1 1  ON 5
 uu_6                -1.106994e-01 1 1  ON 6
 uu_7                -4.245674e-02 1 1  ON 7
 uu_8                 8.654024e-02 1 1  ON 8
 uu_9                 1.220507e-01 1 1  ON 9
 ud_0                 3.028002e-01 1 1  ON 10
 ud_1                 7.596145e-02 1 1  ON 11
 ud_2                -1.840707e-02 1 1  ON 12
 ud_3                -6.883452e-02 1 1  ON 13
 ud_4                -1.085243e-01 1 1  ON 14
 ud_5                -1.357739e-01 1 1  ON 15
 ud_6                -1.370010e-01 1 1  ON 16
 ud_7                -9.611049e-02 1 1  ON 17
 ud_8                 1.425664e-03 1 1  ON 18
 ud_9                 9.067199e-02 1 1  ON 19
 eO_0                -6.845864e-01 1 1  ON 20
 eO_1                -4.098360e-01 1 1  ON 21
 eO_2                -4.966934e-02 1 1  ON 22
 eO_3                 1.714337e-01 1 1  ON 23
 eO_4                 2.548422e-01 1 1  ON 24
 eO_5                 2.930959e-01 1 1  ON 25
 eO_6                 2.514059e-01 1 1  ON 26
 eO_7                 1.164564e-01 1 1  ON 27
 eO_8                 2.795905e-02 1 1  ON 28
 eO_9                 1.837583e-02 1 1  ON 29
eH1_0                -1.951587e-01 1 1  ON 30
eH1_1                -9.634576e-02 1 1  ON 31
eH1_2                -4.932872e-02 1 1  ON 32
eH1_3                -1.901597e-02 1 1  ON 33
eH1_4                 1.662363e-02 1 1  ON 34
eH1_5                 2.424689e-02 1 1  ON 35
eH1_6                 7.674010e-02 1 1  ON 36
eH1_7                 1.107424e-01 1 1  ON 37
eH1_8                 9.199589e-02 1 1  ON 38
eH1_9                 2.426948e-02 1 1  ON 39
eH2_0                -1.961293e-01 1 1  ON 40
eH2_1                -9.716932e-02 1 1  ON 41
eH2_2                -5.033556e-02 1 1  ON 42
eH2_3                -2.018279e-02 1 1  ON 43
eH2_4                 1.552384e-02 1 1  ON 44
eH2_5                 2.429372e-02 1 1  ON 45
eH2_6                 7.653533e-02 1 1  ON 46
eH2_7                 1.129388e-01 1 1  ON 47
eH2_8                 9.605413e-02 1 1  ON 48
eH2_9                 2.646653e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5800e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s003 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s003 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=3  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7214e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2164
    reference variance = 0.227502
====================================================
  Execution time = 2.0712e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s003
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7192e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5684e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271928728545
                                         uncertainty =       0.001877093857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.271928728545
                                         uncertainty =       0.001877093857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000368726766
  error estimate for blocks of size 2^( 2) =       0.000382604145
  error estimate for blocks of size 2^( 3) =       0.000395540869
  error estimate for blocks of size 2^( 4) =       0.000405661881
  error estimate for blocks of size 2^( 5) =       0.000410527673
  error estimate for blocks of size 2^( 6) =       0.000413490553
  error estimate for blocks of size 2^( 7) =       0.000413543081

      target function =      -0.958802441109
              le_mean =     -17.211810676875
             les_mean =     296.518345497118
             stat err =       0.000410805797
             autocorr =       1.241262962984
   target nu stat err =       0.000410805797
   target dn stat err =       0.001976271518
      target stat err =       0.003595556196
              std dev =       0.521458393825
             le_variance =       0.271918856490


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721181067687e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+00, overlap shift 6.2500e+01 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.958814682272       residual = 1.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.958819073312       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.958820479289       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.958821631240       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.958822524455       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.958823047923       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.958823636065       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.958824119851       residual = 9.12e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.958824213090       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.958824297726       residual = 2.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.958824335202       residual = 2.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.958824448238       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.958824529007       residual = 1.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.958824525478       residual = 7.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.958824557502       residual = 4.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.958824549241       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.958824574705       residual = 3.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.958824609600       residual = 3.48e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.958824626732       residual = 6.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.958824629114       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.958824629369       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.958824635561       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.958824639524       residual = 4.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.958824642279       residual = 8.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+00 is 9.730023e-05

solving harmonic davidson linear method for identity shift 2.5000e+01, overlap shift 2.5000e+02 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.958814682272       residual = 1.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.958815790496       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.958816145919       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.958816436881       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.958816660897       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.958816792814       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.958816940600       residual = 4.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.958817062727       residual = 9.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.958817086173       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.958817107448       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.958817116779       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.958817145176       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.958817165380       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.958817164479       residual = 6.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.958817172431       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.958817170333       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.958817176748       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.958817185371       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.958817189635       residual = 5.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.958817190207       residual = 1.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.958817190274       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.958817191810       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.958817192768       residual = 4.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.958817193446       residual = 7.99e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+01 is 2.435838e-05

solving harmonic davidson linear method for identity shift 1.0000e+02, overlap shift 1.0000e+03 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.958814682272       residual = 1.33e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.958814959990       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.958815049094       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.958815122025       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.958815178072       residual = 4.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.958815211117       residual = 3.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.958815248111       residual = 4.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.958815278717       residual = 9.09e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.958815284587       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.958815289913       residual = 2.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.958815292244       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.958815299352       residual = 1.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.958815304403       residual = 1.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.958815304177       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.958815306161       residual = 4.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.958815305635       residual = 3.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.958815307242       residual = 2.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.958815309390       residual = 3.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.958815310455       residual = 5.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.958815310597       residual = 1.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.958815310614       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.958815310998       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.958815311235       residual = 4.22e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.958815311403       residual = 7.91e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+02 is 6.091679e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.748652 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6309e+01
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.977176e-01 1 1  ON 0
 uu_1                 4.328157e-02 1 1  ON 1
 uu_2                -4.190461e-02 1 1  ON 2
 uu_3                -9.236399e-02 1 1  ON 3
 uu_4                -1.237687e-01 1 1  ON 4
 uu_5                -1.319010e-01 1 1  ON 5
 uu_6                -1.107030e-01 1 1  ON 6
 uu_7                -4.247144e-02 1 1  ON 7
 uu_8                 8.651588e-02 1 1  ON 8
 uu_9                 1.220529e-01 1 1  ON 9
 ud_0                 3.027912e-01 1 1  ON 10
 ud_1                 7.595823e-02 1 1  ON 11
 ud_2                -1.841947e-02 1 1  ON 12
 ud_3                -6.884817e-02 1 1  ON 13
 ud_4                -1.085275e-01 1 1  ON 14
 ud_5                -1.357588e-01 1 1  ON 15
 ud_6                -1.369798e-01 1 1  ON 16
 ud_7                -9.609331e-02 1 1  ON 17
 ud_8                 1.414276e-03 1 1  ON 18
 ud_9                 9.066758e-02 1 1  ON 19
 eO_0                -6.845916e-01 1 1  ON 20
 eO_1                -4.098384e-01 1 1  ON 21
 eO_2                -4.965429e-02 1 1  ON 22
 eO_3                 1.714439e-01 1 1  ON 23
 eO_4                 2.548265e-01 1 1  ON 24
 eO_5                 2.930820e-01 1 1  ON 25
 eO_6                 2.514075e-01 1 1  ON 26
 eO_7                 1.164655e-01 1 1  ON 27
 eO_8                 2.795990e-02 1 1  ON 28
 eO_9                 1.837567e-02 1 1  ON 29
eH1_0                -1.951697e-01 1 1  ON 30
eH1_1                -9.634382e-02 1 1  ON 31
eH1_2                -4.931850e-02 1 1  ON 32
eH1_3                -1.900664e-02 1 1  ON 33
eH1_4                 1.662293e-02 1 1  ON 34
eH1_5                 2.423790e-02 1 1  ON 35
eH1_6                 7.673551e-02 1 1  ON 36
eH1_7                 1.107404e-01 1 1  ON 37
eH1_8                 9.200029e-02 1 1  ON 38
eH1_9                 2.427069e-02 1 1  ON 39
eH2_0                -1.961446e-01 1 1  ON 40
eH2_1                -9.716555e-02 1 1  ON 41
eH2_2                -5.032371e-02 1 1  ON 42
eH2_3                -2.016987e-02 1 1  ON 43
eH2_4                 1.552635e-02 1 1  ON 44
eH2_5                 2.428408e-02 1 1  ON 45
eH2_6                 7.652690e-02 1 1  ON 46
eH2_7                 1.129361e-01 1 1  ON 47
eH2_8                 9.605870e-02 1 1  ON 48
eH2_9                 2.646670e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 3
    time step          = 0.05
    reference energy   = -17.2288
    reference variance = 0.163797
====================================================
  Execution time = 2.2903e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s003
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8105e-01
  Total weights = 2.0000e+06
  Execution time = 1.8406e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281030702771
                                         uncertainty =       0.003102379734

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281030702771
                                         uncertainty =       0.003102379734

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374863905
  error estimate for blocks of size 2^( 2) =       0.000388372478
  error estimate for blocks of size 2^( 3) =       0.000400665986
  error estimate for blocks of size 2^( 4) =       0.000409379633
  error estimate for blocks of size 2^( 5) =       0.000416261081
  error estimate for blocks of size 2^( 6) =       0.000417382596
  error estimate for blocks of size 2^( 7) =       0.000420904457

      target function =      -0.942834464842
              le_mean =     -17.211701931657
             les_mean =     296.523729137543
             stat err =       0.000415981942
             autocorr =       1.231407251795
   target nu stat err =       0.000415981942
   target dn stat err =       0.002968830973
      target stat err =       0.005159441653
              std dev =       0.530137617863
             le_variance =       0.281045893873

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281034151730
                                         uncertainty =       0.003102646626

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281034151730
                                         uncertainty =       0.003102646626

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374866203
  error estimate for blocks of size 2^( 2) =       0.000388374260
  error estimate for blocks of size 2^( 3) =       0.000400668032
  error estimate for blocks of size 2^( 4) =       0.000409383306
  error estimate for blocks of size 2^( 5) =       0.000416266200
  error estimate for blocks of size 2^( 6) =       0.000417388685
  error estimate for blocks of size 2^( 7) =       0.000420911448

      target function =      -0.942828553965
              le_mean =     -17.211701537602
             les_mean =     296.523719018906
             stat err =       0.000415987409
             autocorr =       1.231424524079
   target nu stat err =       0.000415987409
   target dn stat err =       0.002969112984
      target stat err =       0.005159854723
              std dev =       0.530140868000
             le_variance =       0.281049339924

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281032428106
                                         uncertainty =       0.003102514151

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281032428106
                                         uncertainty =       0.003102514151

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374865054
  error estimate for blocks of size 2^( 2) =       0.000388373364
  error estimate for blocks of size 2^( 3) =       0.000400667001
  error estimate for blocks of size 2^( 4) =       0.000409381467
  error estimate for blocks of size 2^( 5) =       0.000416263643
  error estimate for blocks of size 2^( 6) =       0.000417385646
  error estimate for blocks of size 2^( 7) =       0.000420907961

      target function =      -0.942831508169
              le_mean =     -17.211701729465
             les_mean =     296.523723901264
             stat err =       0.000415984679
             autocorr =       1.231415904392
   target nu stat err =       0.000415984679
   target dn stat err =       0.002968973017
      target stat err =       0.005159649892
              std dev =       0.530139243723
             le_variance =       0.281047617735

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281030917166
                                         uncertainty =       0.003102396564

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281030917166
                                         uncertainty =       0.003102396564

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374864047
  error estimate for blocks of size 2^( 2) =       0.000388372587
  error estimate for blocks of size 2^( 3) =       0.000400666111
  error estimate for blocks of size 2^( 4) =       0.000409379861
  error estimate for blocks of size 2^( 5) =       0.000416261400
  error estimate for blocks of size 2^( 6) =       0.000417382976
  error estimate for blocks of size 2^( 7) =       0.000420904894

      target function =      -0.942834097462
              le_mean =     -17.211701905956
             les_mean =     296.523728467047
             stat err =       0.000415982283
             autocorr =       1.231408332454
   target nu stat err =       0.000415982283
   target dn stat err =       0.002968848758
      target stat err =       0.005159467753
              std dev =       0.530137819896
             le_variance =       0.281046108084


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.942834464842        initial  <--
     6.2500e+00     6.2500e+01             9.7300e-05        -0.942828553965
     2.5000e+01     2.5000e+02             2.4358e-05        -0.942831508169
     1.0000e+02     1.0000e+03             6.0917e-06        -0.942834097462

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.2109
  </log>
  <optVariables href="H2O.s003.opt.xml">
 uu_0                 1.977050e-01 1 1  ON 0
 uu_1                 4.327121e-02 1 1  ON 1
 uu_2                -4.191020e-02 1 1  ON 2
 uu_3                -9.236629e-02 1 1  ON 3
 uu_4                -1.237726e-01 1 1  ON 4
 uu_5                -1.319021e-01 1 1  ON 5
 uu_6                -1.106994e-01 1 1  ON 6
 uu_7                -4.245674e-02 1 1  ON 7
 uu_8                 8.654024e-02 1 1  ON 8
 uu_9                 1.220507e-01 1 1  ON 9
 ud_0                 3.028002e-01 1 1  ON 10
 ud_1                 7.596145e-02 1 1  ON 11
 ud_2                -1.840707e-02 1 1  ON 12
 ud_3                -6.883452e-02 1 1  ON 13
 ud_4                -1.085243e-01 1 1  ON 14
 ud_5                -1.357739e-01 1 1  ON 15
 ud_6                -1.370010e-01 1 1  ON 16
 ud_7                -9.611049e-02 1 1  ON 17
 ud_8                 1.425664e-03 1 1  ON 18
 ud_9                 9.067199e-02 1 1  ON 19
 eO_0                -6.845864e-01 1 1  ON 20
 eO_1                -4.098360e-01 1 1  ON 21
 eO_2                -4.966934e-02 1 1  ON 22
 eO_3                 1.714337e-01 1 1  ON 23
 eO_4                 2.548422e-01 1 1  ON 24
 eO_5                 2.930959e-01 1 1  ON 25
 eO_6                 2.514059e-01 1 1  ON 26
 eO_7                 1.164564e-01 1 1  ON 27
 eO_8                 2.795905e-02 1 1  ON 28
 eO_9                 1.837583e-02 1 1  ON 29
eH1_0                -1.951587e-01 1 1  ON 30
eH1_1                -9.634576e-02 1 1  ON 31
eH1_2                -4.932872e-02 1 1  ON 32
eH1_3                -1.901597e-02 1 1  ON 33
eH1_4                 1.662363e-02 1 1  ON 34
eH1_5                 2.424689e-02 1 1  ON 35
eH1_6                 7.674010e-02 1 1  ON 36
eH1_7                 1.107424e-01 1 1  ON 37
eH1_8                 9.199589e-02 1 1  ON 38
eH1_9                 2.426948e-02 1 1  ON 39
eH2_0                -1.961293e-01 1 1  ON 40
eH2_1                -9.716932e-02 1 1  ON 41
eH2_2                -5.033556e-02 1 1  ON 42
eH2_3                -2.018279e-02 1 1  ON 43
eH2_4                 1.552384e-02 1 1  ON 44
eH2_5                 2.429372e-02 1 1  ON 45
eH2_6                 7.653533e-02 1 1  ON 46
eH2_7                 1.129388e-01 1 1  ON 47
eH2_8                 9.605413e-02 1 1  ON 48
eH2_9                 2.646653e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8527e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s004 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s004 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=4  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7216e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.1327
    reference variance = 0.195598
====================================================
  Execution time = 2.0344e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s004
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8100e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6734e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281076958262
                                         uncertainty =       0.002218256963

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281076958262
                                         uncertainty =       0.002218256963

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374832513
  error estimate for blocks of size 2^( 2) =       0.000388202235
  error estimate for blocks of size 2^( 3) =       0.000400793925
  error estimate for blocks of size 2^( 4) =       0.000409719918
  error estimate for blocks of size 2^( 5) =       0.000415546201
  error estimate for blocks of size 2^( 6) =       0.000418561643
  error estimate for blocks of size 2^( 7) =       0.000418313581

      target function =      -0.942905454951
              le_mean =     -17.212183749691
             les_mean =     296.540268118013
             stat err =       0.000415535336
             autocorr =       1.228970370310
   target nu stat err =       0.000415535336
   target dn stat err =       0.002173426836
      target stat err =       0.003816210981
              std dev =       0.530093223303
             le_variance =       0.280998825392


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721218374969e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942919907084       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942920410373       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942920588467       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942920715249       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942920804289       residual = 4.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942920865175       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942920900723       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942920954708       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942920977664       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942920995220       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.942921004519       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.942921012768       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.942921018583       residual = 8.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.942921021745       residual = 4.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.942921032074       residual = 3.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.942921031783       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.942921034668       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.942921037280       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.942921037904       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.942921037991       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.942921038244       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.942921038840       residual = 8.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.942921038991       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.942921038874       residual = 1.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 8.279066e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942919907084       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942920033023       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942920077596       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942920109322       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942920131591       residual = 4.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942920146823       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942920155717       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942920169222       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942920174965       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942920179356       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.942920181681       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.942920183745       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.942920185198       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.942920185990       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.942920188572       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.942920188498       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.942920189218       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.942920189870       residual = 2.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.942920190026       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.942920190048       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.942920190113       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.942920190261       residual = 8.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.942920190298       residual = 1.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.942920190268       residual = 1.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 2.071423e-06

solving harmonic davidson linear method for identity shift 1.0000e+03, overlap shift 1.0000e+04 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942919907084       residual = 1.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942919938576       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.942919949723       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.942919957656       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.942919963224       residual = 4.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.942919967031       residual = 3.43e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.942919969257       residual = 3.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.942919972632       residual = 1.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.942919974070       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.942919975166       residual = 2.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.942919975748       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.942919976263       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.942919976627       residual = 8.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.942919976825       residual = 4.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.942919977471       residual = 3.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.942919977450       residual = 2.41e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.942919977630       residual = 2.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.942919977794       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.942919977836       residual = 2.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.942919977842       residual = 1.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.942919977854       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.942919977895       residual = 8.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.942919977902       residual = 1.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.942919977896       residual = 1.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.0000e+03 is 5.179595e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.766772 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6047e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.977062e-01 1 1  ON 0
 uu_1                 4.327226e-02 1 1  ON 1
 uu_2                -4.190955e-02 1 1  ON 2
 uu_3                -9.236587e-02 1 1  ON 3
 uu_4                -1.237721e-01 1 1  ON 4
 uu_5                -1.319020e-01 1 1  ON 5
 uu_6                -1.107004e-01 1 1  ON 6
 uu_7                -4.245869e-02 1 1  ON 7
 uu_8                 8.653880e-02 1 1  ON 8
 uu_9                 1.220506e-01 1 1  ON 9
 ud_0                 3.027992e-01 1 1  ON 10
 ud_1                 7.596123e-02 1 1  ON 11
 ud_2                -1.840812e-02 1 1  ON 12
 ud_3                -6.883583e-02 1 1  ON 13
 ud_4                -1.085246e-01 1 1  ON 14
 ud_5                -1.357724e-01 1 1  ON 15
 ud_6                -1.369991e-01 1 1  ON 16
 ud_7                -9.610922e-02 1 1  ON 17
 ud_8                 1.424701e-03 1 1  ON 18
 ud_9                 9.067170e-02 1 1  ON 19
 eO_0                -6.845865e-01 1 1  ON 20
 eO_1                -4.098361e-01 1 1  ON 21
 eO_2                -4.966806e-02 1 1  ON 22
 eO_3                 1.714343e-01 1 1  ON 23
 eO_4                 2.548412e-01 1 1  ON 24
 eO_5                 2.930940e-01 1 1  ON 25
 eO_6                 2.514062e-01 1 1  ON 26
 eO_7                 1.164572e-01 1 1  ON 27
 eO_8                 2.795902e-02 1 1  ON 28
 eO_9                 1.837589e-02 1 1  ON 29
eH1_0                -1.951608e-01 1 1  ON 30
eH1_1                -9.634604e-02 1 1  ON 31
eH1_2                -4.932756e-02 1 1  ON 32
eH1_3                -1.901489e-02 1 1  ON 33
eH1_4                 1.662441e-02 1 1  ON 34
eH1_5                 2.424631e-02 1 1  ON 35
eH1_6                 7.673990e-02 1 1  ON 36
eH1_7                 1.107420e-01 1 1  ON 37
eH1_8                 9.199625e-02 1 1  ON 38
eH1_9                 2.426952e-02 1 1  ON 39
eH2_0                -1.961311e-01 1 1  ON 40
eH2_1                -9.716957e-02 1 1  ON 41
eH2_2                -5.033452e-02 1 1  ON 42
eH2_3                -2.018186e-02 1 1  ON 43
eH2_4                 1.552420e-02 1 1  ON 44
eH2_5                 2.429352e-02 1 1  ON 45
eH2_6                 7.653485e-02 1 1  ON 46
eH2_7                 1.129386e-01 1 1  ON 47
eH2_8                 9.605455e-02 1 1  ON 48
eH2_9                 2.646652e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 4
    time step          = 0.05
    reference energy   = -17.2011
    reference variance = 0.266424
====================================================
  Execution time = 2.0097e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s004
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7740e-01
  Total weights = 2.0000e+06
  Execution time = 1.8350e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277403521067
                                         uncertainty =       0.002180719817

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277403521067
                                         uncertainty =       0.002180719817

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372421519
  error estimate for blocks of size 2^( 2) =       0.000385741167
  error estimate for blocks of size 2^( 3) =       0.000397857047
  error estimate for blocks of size 2^( 4) =       0.000406690025
  error estimate for blocks of size 2^( 5) =       0.000412569313
  error estimate for blocks of size 2^( 6) =       0.000415631099
  error estimate for blocks of size 2^( 7) =       0.000418158117

      target function =      -0.949160149141
              le_mean =     -17.211871487688
             les_mean =     296.525915546307
             stat err =       0.000413262139
             autocorr =       1.231350532033
   target nu stat err =       0.000413262139
   target dn stat err =       0.002000756025
      target stat err =       0.003568280569
              std dev =       0.526683563749
             le_variance =       0.277395576323

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277403472780
                                         uncertainty =       0.002180707452

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277403472780
                                         uncertainty =       0.002180707452

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372421489
  error estimate for blocks of size 2^( 2) =       0.000385741216
  error estimate for blocks of size 2^( 3) =       0.000397857256
  error estimate for blocks of size 2^( 4) =       0.000406690388
  error estimate for blocks of size 2^( 5) =       0.000412569786
  error estimate for blocks of size 2^( 6) =       0.000415631658
  error estimate for blocks of size 2^( 7) =       0.000418158704

      target function =      -0.949160229961
              le_mean =     -17.211871470526
             les_mean =     296.525914909565
             stat err =       0.000413262634
             autocorr =       1.231353687590
   target nu stat err =       0.000413262634
   target dn stat err =       0.002000747148
      target stat err =       0.003568266121
              std dev =       0.526683520096
             le_variance =       0.277395530341

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277403496713
                                         uncertainty =       0.002180713628

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277403496713
                                         uncertainty =       0.002180713628

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372421504
  error estimate for blocks of size 2^( 2) =       0.000385741191
  error estimate for blocks of size 2^( 3) =       0.000397857151
  error estimate for blocks of size 2^( 4) =       0.000406690207
  error estimate for blocks of size 2^( 5) =       0.000412569549
  error estimate for blocks of size 2^( 6) =       0.000415631378
  error estimate for blocks of size 2^( 7) =       0.000418158411

      target function =      -0.949160189917
              le_mean =     -17.211871479063
             les_mean =     296.525915226206
             stat err =       0.000413262386
             autocorr =       1.231352110618
   target nu stat err =       0.000413262386
   target dn stat err =       0.002000751582
      target stat err =       0.003568273339
              std dev =       0.526683541724
             le_variance =       0.277395553123

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277403518001
                                         uncertainty =       0.002180719043

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277403518001
                                         uncertainty =       0.002180719043

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372421518
  error estimate for blocks of size 2^( 2) =       0.000385741170
  error estimate for blocks of size 2^( 3) =       0.000397857060
  error estimate for blocks of size 2^( 4) =       0.000406690048
  error estimate for blocks of size 2^( 5) =       0.000412569342
  error estimate for blocks of size 2^( 6) =       0.000415631134
  error estimate for blocks of size 2^( 7) =       0.000418158154

      target function =      -0.949160154276
              le_mean =     -17.211871486605
             les_mean =     296.525915506123
             stat err =       0.000413262170
             autocorr =       1.231350729361
   target nu stat err =       0.000413262170
   target dn stat err =       0.002000755470
      target stat err =       0.003568279666
              std dev =       0.526683560975
             le_variance =       0.277395573402


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949160149141        initial
     6.2500e+01     6.2500e+02             8.2791e-06        -0.949160229961  <--
     2.5000e+02     2.5000e+03             2.0714e-06        -0.949160189917
     1.0000e+03     1.0000e+04             5.1796e-07        -0.949160154276

*****************************************************************************
Applying the update for shift_i =   6.2500e+01     and shift_s =   6.2500e+02
*****************************************************************************

  Execution time = 2.9380e+01
  </log>
  <optVariables href="H2O.s004.opt.xml">
 uu_0                 1.977097e-01 1 1  ON 0
 uu_1                 4.327543e-02 1 1  ON 1
 uu_2                -4.190761e-02 1 1  ON 2
 uu_3                -9.236461e-02 1 1  ON 3
 uu_4                -1.237708e-01 1 1  ON 4
 uu_5                -1.319018e-01 1 1  ON 5
 uu_6                -1.107037e-01 1 1  ON 6
 uu_7                -4.246456e-02 1 1  ON 7
 uu_8                 8.653448e-02 1 1  ON 8
 uu_9                 1.220504e-01 1 1  ON 9
 ud_0                 3.027961e-01 1 1  ON 10
 ud_1                 7.596057e-02 1 1  ON 11
 ud_2                -1.841128e-02 1 1  ON 12
 ud_3                -6.883975e-02 1 1  ON 13
 ud_4                -1.085257e-01 1 1  ON 14
 ud_5                -1.357680e-01 1 1  ON 15
 ud_6                -1.369934e-01 1 1  ON 16
 ud_7                -9.610542e-02 1 1  ON 17
 ud_8                 1.421812e-03 1 1  ON 18
 ud_9                 9.067083e-02 1 1  ON 19
 eO_0                -6.845867e-01 1 1  ON 20
 eO_1                -4.098363e-01 1 1  ON 21
 eO_2                -4.966423e-02 1 1  ON 22
 eO_3                 1.714360e-01 1 1  ON 23
 eO_4                 2.548381e-01 1 1  ON 24
 eO_5                 2.930884e-01 1 1  ON 25
 eO_6                 2.514071e-01 1 1  ON 26
 eO_7                 1.164594e-01 1 1  ON 27
 eO_8                 2.795892e-02 1 1  ON 28
 eO_9                 1.837607e-02 1 1  ON 29
eH1_0                -1.951670e-01 1 1  ON 30
eH1_1                -9.634688e-02 1 1  ON 31
eH1_2                -4.932408e-02 1 1  ON 32
eH1_3                -1.901165e-02 1 1  ON 33
eH1_4                 1.662674e-02 1 1  ON 34
eH1_5                 2.424460e-02 1 1  ON 35
eH1_6                 7.673931e-02 1 1  ON 36
eH1_7                 1.107408e-01 1 1  ON 37
eH1_8                 9.199731e-02 1 1  ON 38
eH1_9                 2.426964e-02 1 1  ON 39
eH2_0                -1.961362e-01 1 1  ON 40
eH2_1                -9.717034e-02 1 1  ON 41
eH2_2                -5.033139e-02 1 1  ON 42
eH2_3                -2.017907e-02 1 1  ON 43
eH2_4                 1.552527e-02 1 1  ON 44
eH2_5                 2.429292e-02 1 1  ON 45
eH2_6                 7.653344e-02 1 1  ON 46
eH2_7                 1.129382e-01 1 1  ON 47
eH2_8                 9.605579e-02 1 1  ON 48
eH2_9                 2.646650e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5433e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s005 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s005 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=5  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7206e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.1709
    reference variance = 0.232276
====================================================
  Execution time = 2.0297e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s005
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7916e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5433e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279204596214
                                         uncertainty =       0.002520927248

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279204596214
                                         uncertainty =       0.002520927248

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373605286
  error estimate for blocks of size 2^( 2) =       0.000387233638
  error estimate for blocks of size 2^( 3) =       0.000399764887
  error estimate for blocks of size 2^( 4) =       0.000409231224
  error estimate for blocks of size 2^( 5) =       0.000414479623
  error estimate for blocks of size 2^( 6) =       0.000416651864
  error estimate for blocks of size 2^( 7) =       0.000418948785

      target function =      -0.946058028918
              le_mean =     -17.212525184077
             les_mean =     296.550184892375
             stat err =       0.000414827874
             autocorr =       1.232848856929
   target nu stat err =       0.000414827874
   target dn stat err =       0.002521450172
      target stat err =       0.004436563770
              std dev =       0.528357662461
             le_variance =       0.279161819481


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721252518408e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946077559507       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946079304560       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946079718565       residual = 7.70e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946080018952       residual = 7.66e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946080301914       residual = 4.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946080518391       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946080662530       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946080802451       residual = 9.05e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946080889658       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946080931584       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946080966264       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946080997849       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946081025262       residual = 7.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946081059670       residual = 4.83e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946081084061       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946081092668       residual = 2.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946081102055       residual = 2.96e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946081112617       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946081110614       residual = 3.54e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946081109725       residual = 1.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946081110491       residual = 9.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946081110837       residual = 1.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946081113126       residual = 3.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946081113654       residual = 4.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 3.396234e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946077559507       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946077997424       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946078101422       residual = 7.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946078176806       residual = 7.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946078247698       residual = 4.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946078301960       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946078338141       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946078373212       residual = 9.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946078395066       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946078405567       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946078414244       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946078422152       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946078429014       residual = 7.64e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946078437608       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946078443704       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946078445844       residual = 2.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946078448191       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946078450815       residual = 3.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946078450312       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946078450091       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946078450282       residual = 8.86e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946078450372       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946078450939       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946078451069       residual = 4.72e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 8.508645e-06

solving harmonic davidson linear method for identity shift 2.5000e+02, overlap shift 2.5000e+03 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946077559507       residual = 1.29e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946077669090       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946077695121       residual = 7.68e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946077713985       residual = 7.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946077731717       residual = 4.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946077745292       residual = 3.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946077754347       residual = 2.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946077763120       residual = 9.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946077768586       residual = 3.76e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946077771213       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946077773384       residual = 2.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946077775360       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946077777077       residual = 7.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946077779224       residual = 4.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946077780749       residual = 3.59e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946077781284       residual = 2.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946077781870       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946077782524       residual = 3.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946077782398       residual = 3.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946077782343       residual = 1.44e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946077782391       residual = 8.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946077782414       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946077782555       residual = 3.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946077782588       residual = 4.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.5000e+02 is 2.128293e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.784962 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5872e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.977130e-01 1 1  ON 0
 uu_1                 4.327930e-02 1 1  ON 1
 uu_2                -4.190595e-02 1 1  ON 2
 uu_3                -9.236376e-02 1 1  ON 3
 uu_4                -1.237699e-01 1 1  ON 4
 uu_5                -1.319012e-01 1 1  ON 5
 uu_6                -1.107065e-01 1 1  ON 6
 uu_7                -4.247084e-02 1 1  ON 7
 uu_8                 8.652896e-02 1 1  ON 8
 uu_9                 1.220517e-01 1 1  ON 9
 ud_0                 3.027918e-01 1 1  ON 10
 ud_1                 7.595957e-02 1 1  ON 11
 ud_2                -1.841525e-02 1 1  ON 12
 ud_3                -6.884412e-02 1 1  ON 13
 ud_4                -1.085258e-01 1 1  ON 14
 ud_5                -1.357625e-01 1 1  ON 15
 ud_6                -1.369849e-01 1 1  ON 16
 ud_7                -9.610224e-02 1 1  ON 17
 ud_8                 1.417197e-03 1 1  ON 18
 ud_9                 9.067024e-02 1 1  ON 19
 eO_0                -6.845883e-01 1 1  ON 20
 eO_1                -4.098374e-01 1 1  ON 21
 eO_2                -4.965976e-02 1 1  ON 22
 eO_3                 1.714393e-01 1 1  ON 23
 eO_4                 2.548353e-01 1 1  ON 24
 eO_5                 2.930813e-01 1 1  ON 25
 eO_6                 2.514070e-01 1 1  ON 26
 eO_7                 1.164640e-01 1 1  ON 27
 eO_8                 2.795906e-02 1 1  ON 28
 eO_9                 1.837644e-02 1 1  ON 29
eH1_0                -1.951720e-01 1 1  ON 30
eH1_1                -9.634492e-02 1 1  ON 31
eH1_2                -4.931932e-02 1 1  ON 32
eH1_3                -1.900786e-02 1 1  ON 33
eH1_4                 1.662730e-02 1 1  ON 34
eH1_5                 2.424099e-02 1 1  ON 35
eH1_6                 7.673573e-02 1 1  ON 36
eH1_7                 1.107388e-01 1 1  ON 37
eH1_8                 9.199999e-02 1 1  ON 38
eH1_9                 2.427019e-02 1 1  ON 39
eH2_0                -1.961406e-01 1 1  ON 40
eH2_1                -9.716889e-02 1 1  ON 41
eH2_2                -5.032699e-02 1 1  ON 42
eH2_3                -2.017516e-02 1 1  ON 43
eH2_4                 1.552681e-02 1 1  ON 44
eH2_5                 2.428994e-02 1 1  ON 45
eH2_6                 7.652990e-02 1 1  ON 46
eH2_7                 1.129357e-01 1 1  ON 47
eH2_8                 9.605800e-02 1 1  ON 48
eH2_9                 2.646654e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 5
    time step          = 0.05
    reference energy   = -17.2046
    reference variance = 0.147257
====================================================
  Execution time = 1.9965e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s005
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7762e-01
  Total weights = 2.0000e+06
  Execution time = 1.8414e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277653501034
                                         uncertainty =       0.003061868423

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277653501034
                                         uncertainty =       0.003061868423

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372575635
  error estimate for blocks of size 2^( 2) =       0.000386411086
  error estimate for blocks of size 2^( 3) =       0.000398842470
  error estimate for blocks of size 2^( 4) =       0.000407454008
  error estimate for blocks of size 2^( 5) =       0.000413358639
  error estimate for blocks of size 2^( 6) =       0.000417331627
  error estimate for blocks of size 2^( 7) =       0.000419644572

      target function =      -0.948730885279
              le_mean =     -17.212154474345
             les_mean =     296.535886717712
             stat err =       0.000414447212
             autocorr =       1.237398379710
   target nu stat err =       0.000414447212
   target dn stat err =       0.003176167116
      target stat err =       0.005585265941
              std dev =       0.526901516238
             le_variance =       0.277625207814

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277653086266
                                         uncertainty =       0.003061794499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277653086266
                                         uncertainty =       0.003061794499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372575357
  error estimate for blocks of size 2^( 2) =       0.000386410893
  error estimate for blocks of size 2^( 3) =       0.000398842826
  error estimate for blocks of size 2^( 4) =       0.000407455162
  error estimate for blocks of size 2^( 5) =       0.000413360411
  error estimate for blocks of size 2^( 6) =       0.000417333917
  error estimate for blocks of size 2^( 7) =       0.000419646973

      target function =      -0.948731612428
              le_mean =     -17.212154382939
             les_mean =     296.535883156321
             stat err =       0.000414449116
             autocorr =       1.237411599298
   target nu stat err =       0.000414449116
   target dn stat err =       0.003176102949
      target stat err =       0.005585163162
              std dev =       0.526901122595
             le_variance =       0.277624792992

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277653290614
                                         uncertainty =       0.003061831278

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277653290614
                                         uncertainty =       0.003061831278

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372575494
  error estimate for blocks of size 2^( 2) =       0.000386410988
  error estimate for blocks of size 2^( 3) =       0.000398842646
  error estimate for blocks of size 2^( 4) =       0.000407454585
  error estimate for blocks of size 2^( 5) =       0.000413359525
  error estimate for blocks of size 2^( 6) =       0.000417332773
  error estimate for blocks of size 2^( 7) =       0.000419645774

      target function =      -0.948731254166
              le_mean =     -17.212154428013
             les_mean =     296.535884912307
             stat err =       0.000414448164
             autocorr =       1.237405005425
   target nu stat err =       0.000414448164
   target dn stat err =       0.003176134876
      target stat err =       0.005585214337
              std dev =       0.526901316537
             le_variance =       0.277624997368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277653474451
                                         uncertainty =       0.003061863774

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277653474451
                                         uncertainty =       0.003061863774

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372575617
  error estimate for blocks of size 2^( 2) =       0.000386411074
  error estimate for blocks of size 2^( 3) =       0.000398842492
  error estimate for blocks of size 2^( 4) =       0.000407454080
  error estimate for blocks of size 2^( 5) =       0.000413358749
  error estimate for blocks of size 2^( 6) =       0.000417331770
  error estimate for blocks of size 2^( 7) =       0.000419644722

      target function =      -0.948730931881
              le_mean =     -17.212154468500
             les_mean =     296.535886489920
             stat err =       0.000414447330
             autocorr =       1.237399208280
   target nu stat err =       0.000414447330
   target dn stat err =       0.003176163081
      target stat err =       0.005585259487
              std dev =       0.526901491009
             le_variance =       0.277625181227


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948730885279        initial
     1.5625e+01     1.5625e+02             3.3962e-05        -0.948731612428  <--
     6.2500e+01     6.2500e+02             8.5086e-06        -0.948731254166
     2.5000e+02     2.5000e+03             2.1283e-06        -0.948730931881

*****************************************************************************
Applying the update for shift_i =   1.5625e+01     and shift_s =   1.5625e+02
*****************************************************************************

  Execution time = 2.9304e+01
  </log>
  <optVariables href="H2O.s005.opt.xml">
 uu_0                 1.977230e-01 1 1  ON 0
 uu_1                 4.329089e-02 1 1  ON 1
 uu_2                -4.190098e-02 1 1  ON 2
 uu_3                -9.236120e-02 1 1  ON 3
 uu_4                -1.237670e-01 1 1  ON 4
 uu_5                -1.318994e-01 1 1  ON 5
 uu_6                -1.107146e-01 1 1  ON 6
 uu_7                -4.248964e-02 1 1  ON 7
 uu_8                 8.651243e-02 1 1  ON 8
 uu_9                 1.220556e-01 1 1  ON 9
 ud_0                 3.027789e-01 1 1  ON 10
 ud_1                 7.595656e-02 1 1  ON 11
 ud_2                -1.842714e-02 1 1  ON 12
 ud_3                -6.885720e-02 1 1  ON 13
 ud_4                -1.085261e-01 1 1  ON 14
 ud_5                -1.357461e-01 1 1  ON 15
 ud_6                -1.369594e-01 1 1  ON 16
 ud_7                -9.609270e-02 1 1  ON 17
 ud_8                 1.403375e-03 1 1  ON 18
 ud_9                 9.066847e-02 1 1  ON 19
 eO_0                -6.845932e-01 1 1  ON 20
 eO_1                -4.098407e-01 1 1  ON 21
 eO_2                -4.964640e-02 1 1  ON 22
 eO_3                 1.714490e-01 1 1  ON 23
 eO_4                 2.548269e-01 1 1  ON 24
 eO_5                 2.930600e-01 1 1  ON 25
 eO_6                 2.514068e-01 1 1  ON 26
 eO_7                 1.164775e-01 1 1  ON 27
 eO_8                 2.795949e-02 1 1  ON 28
 eO_9                 1.837756e-02 1 1  ON 29
eH1_0                -1.951870e-01 1 1  ON 30
eH1_1                -9.633905e-02 1 1  ON 31
eH1_2                -4.930510e-02 1 1  ON 32
eH1_3                -1.899654e-02 1 1  ON 33
eH1_4                 1.662896e-02 1 1  ON 34
eH1_5                 2.423019e-02 1 1  ON 35
eH1_6                 7.672500e-02 1 1  ON 36
eH1_7                 1.107328e-01 1 1  ON 37
eH1_8                 9.200803e-02 1 1  ON 38
eH1_9                 2.427183e-02 1 1  ON 39
eH2_0                -1.961539e-01 1 1  ON 40
eH2_1                -9.716454e-02 1 1  ON 41
eH2_2                -5.031385e-02 1 1  ON 42
eH2_3                -2.016348e-02 1 1  ON 43
eH2_4                 1.553139e-02 1 1  ON 44
eH2_5                 2.428103e-02 1 1  ON 45
eH2_6                 7.651930e-02 1 1  ON 46
eH2_7                 1.129280e-01 1 1  ON 47
eH2_8                 9.606464e-02 1 1  ON 48
eH2_9                 2.646666e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5183e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s006 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s006 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=6  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.221
    reference variance = 0.275729
====================================================
  Execution time = 2.0306e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s006
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7991e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5854e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279916402259
                                         uncertainty =       0.002851574348

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279916402259
                                         uncertainty =       0.002851574348

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374108843
  error estimate for blocks of size 2^( 2) =       0.000387720000
  error estimate for blocks of size 2^( 3) =       0.000400056325
  error estimate for blocks of size 2^( 4) =       0.000409707163
  error estimate for blocks of size 2^( 5) =       0.000415077982
  error estimate for blocks of size 2^( 6) =       0.000417650762
  error estimate for blocks of size 2^( 7) =       0.000422106458

      target function =      -0.944737473360
              le_mean =     -17.212805869442
             les_mean =     296.560600612337
             stat err =       0.000416135591
             autocorr =       1.237296473210
   target nu stat err =       0.000416135591
   target dn stat err =       0.002781592017
      target stat err =       0.004871057162
              std dev =       0.529069799926
             le_variance =       0.279914853194


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721280586944e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+00, overlap shift 3.9062e+01 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944761267260       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944768678132       residual = 9.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944771133248       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944773518264       residual = 8.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944774712429       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944775696661       residual = 7.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944776863312       residual = 2.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944777466808       residual = 5.60e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944777565340       residual = 2.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944777596504       residual = 2.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944777588920       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944777781728       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944777934710       residual = 1.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944778042772       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944777985329       residual = 4.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944778045505       residual = 3.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944778094985       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944778127540       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944778124532       residual = 2.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944778141580       residual = 8.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944778152835       residual = 1.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944778152305       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944778149075       residual = 2.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944778149802       residual = 4.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+00 is 1.468274e-04

solving harmonic davidson linear method for identity shift 1.5625e+01, overlap shift 1.5625e+02 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944761267260       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944763147696       residual = 9.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944763773311       residual = 1.61e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944764375694       residual = 8.92e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944764677094       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944764923758       residual = 7.86e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944765219579       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944765372995       residual = 5.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944765397924       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944765406087       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944765403812       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944765452121       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944765490786       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944765517605       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944765503099       residual = 4.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944765518279       residual = 3.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944765530440       residual = 3.18e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944765538418       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944765537681       residual = 2.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944765541902       residual = 7.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944765544643       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944765544525       residual = 7.01e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944765543721       residual = 2.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944765543903       residual = 4.11e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+01 is 3.721302e-05

solving harmonic davidson linear method for identity shift 6.2500e+01, overlap shift 6.2500e+02 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944761267260       residual = 1.45e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944761739134       residual = 9.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944761896291       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944762047283       residual = 8.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944762122809       residual = 4.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944762184514       residual = 7.85e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944762258730       residual = 2.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944762297246       residual = 5.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944762303497       residual = 2.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944762305561       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944762304968       residual = 1.98e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944762317052       residual = 1.95e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944762326745       residual = 1.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944762333437       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944762329801       residual = 4.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944762333605       residual = 3.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944762336632       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944762338616       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944762338433       residual = 2.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944762339485       residual = 7.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944762340166       residual = 1.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944762340137       residual = 6.92e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944762339937       residual = 2.28e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944762339982       residual = 4.04e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+01 is 9.335408e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.803237 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5923e+01
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 1.977381e-01 1 1  ON 0
 uu_1                 4.331089e-02 1 1  ON 1
 uu_2                -4.189116e-02 1 1  ON 2
 uu_3                -9.235435e-02 1 1  ON 3
 uu_4                -1.237623e-01 1 1  ON 4
 uu_5                -1.319033e-01 1 1  ON 5
 uu_6                -1.107294e-01 1 1  ON 6
 uu_7                -4.251006e-02 1 1  ON 7
 uu_8                 8.648408e-02 1 1  ON 8
 uu_9                 1.220615e-01 1 1  ON 9
 ud_0                 3.027681e-01 1 1  ON 10
 ud_1                 7.595565e-02 1 1  ON 11
 ud_2                -1.844171e-02 1 1  ON 12
 ud_3                -6.887194e-02 1 1  ON 13
 ud_4                -1.085270e-01 1 1  ON 14
 ud_5                -1.357213e-01 1 1  ON 15
 ud_6                -1.369304e-01 1 1  ON 16
 ud_7                -9.608075e-02 1 1  ON 17
 ud_8                 1.379205e-03 1 1  ON 18
 ud_9                 9.066317e-02 1 1  ON 19
 eO_0                -6.845898e-01 1 1  ON 20
 eO_1                -4.098396e-01 1 1  ON 21
 eO_2                -4.962518e-02 1 1  ON 22
 eO_3                 1.714588e-01 1 1  ON 23
 eO_4                 2.548073e-01 1 1  ON 24
 eO_5                 2.930251e-01 1 1  ON 25
 eO_6                 2.514072e-01 1 1  ON 26
 eO_7                 1.164954e-01 1 1  ON 27
 eO_8                 2.796010e-02 1 1  ON 28
 eO_9                 1.837792e-02 1 1  ON 29
eH1_0                -1.952242e-01 1 1  ON 30
eH1_1                -9.633911e-02 1 1  ON 31
eH1_2                -4.928787e-02 1 1  ON 32
eH1_3                -1.897327e-02 1 1  ON 33
eH1_4                 1.664018e-02 1 1  ON 34
eH1_5                 2.422507e-02 1 1  ON 35
eH1_6                 7.671290e-02 1 1  ON 36
eH1_7                 1.107244e-01 1 1  ON 37
eH1_8                 9.201672e-02 1 1  ON 38
eH1_9                 2.427402e-02 1 1  ON 39
eH2_0                -1.961775e-01 1 1  ON 40
eH2_1                -9.715814e-02 1 1  ON 41
eH2_2                -5.029442e-02 1 1  ON 42
eH2_3                -2.014229e-02 1 1  ON 43
eH2_4                 1.553969e-02 1 1  ON 44
eH2_5                 2.426147e-02 1 1  ON 45
eH2_6                 7.650658e-02 1 1  ON 46
eH2_7                 1.129199e-01 1 1  ON 47
eH2_8                 9.607247e-02 1 1  ON 48
eH2_9                 2.646761e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 6
    time step          = 0.05
    reference energy   = -17.0989
    reference variance = 0.24449
====================================================
  Execution time = 2.0983e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s006
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7837e-01
  Total weights = 2.0000e+06
  Execution time = 2.1253e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278396080379
                                         uncertainty =       0.002492824853

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278396080379
                                         uncertainty =       0.002492824853

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373072508
  error estimate for blocks of size 2^( 2) =       0.000386895571
  error estimate for blocks of size 2^( 3) =       0.000399510060
  error estimate for blocks of size 2^( 4) =       0.000408919330
  error estimate for blocks of size 2^( 5) =       0.000413263133
  error estimate for blocks of size 2^( 6) =       0.000415841887
  error estimate for blocks of size 2^( 7) =       0.000418806772

      target function =      -0.947421704555
              le_mean =     -17.212914581759
             les_mean =     296.562794451567
             stat err =       0.000414207781
             autocorr =       1.232679042748
   target nu stat err =       0.000414207781
   target dn stat err =       0.002604075211
      target stat err =       0.004594052743
              std dev =       0.527604199961
             le_variance =       0.278366191816

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278398982681
                                         uncertainty =       0.002492418159

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278398982681
                                         uncertainty =       0.002492418159

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373074422
  error estimate for blocks of size 2^( 2) =       0.000386898337
  error estimate for blocks of size 2^( 3) =       0.000399515028
  error estimate for blocks of size 2^( 4) =       0.000408926826
  error estimate for blocks of size 2^( 5) =       0.000413271141
  error estimate for blocks of size 2^( 6) =       0.000415850524
  error estimate for blocks of size 2^( 7) =       0.000418817357

      target function =      -0.947416739997
              le_mean =     -17.212914560446
             les_mean =     296.562796575206
             stat err =       0.000414216462
             autocorr =       1.232718062954
   target nu stat err =       0.000414216462
   target dn stat err =       0.002603728567
      target stat err =       0.004593412910
              std dev =       0.527606907834
             le_variance =       0.278369049194

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278397510088
                                         uncertainty =       0.002492618162

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278397510088
                                         uncertainty =       0.002492618162

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373073450
  error estimate for blocks of size 2^( 2) =       0.000386896938
  error estimate for blocks of size 2^( 3) =       0.000399512535
  error estimate for blocks of size 2^( 4) =       0.000408923081
  error estimate for blocks of size 2^( 5) =       0.000413267141
  error estimate for blocks of size 2^( 6) =       0.000415846213
  error estimate for blocks of size 2^( 7) =       0.000418812083

      target function =      -0.947419260637
              le_mean =     -17.212914561812
             les_mean =     296.562795171771
             stat err =       0.000414212129
             autocorr =       1.232698697886
   target nu stat err =       0.000414212129
   target dn stat err =       0.002603898969
      target stat err =       0.004593728102
              std dev =       0.527605533234
             le_variance =       0.278367598699

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278396254860
                                         uncertainty =       0.002492798904

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278396254860
                                         uncertainty =       0.002492798904

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373072623
  error estimate for blocks of size 2^( 2) =       0.000386895739
  error estimate for blocks of size 2^( 3) =       0.000399510366
  error estimate for blocks of size 2^( 4) =       0.000408919795
  error estimate for blocks of size 2^( 5) =       0.000413263631
  error estimate for blocks of size 2^( 6) =       0.000415842424
  error estimate for blocks of size 2^( 7) =       0.000418807433

      target function =      -0.947421406494
              le_mean =     -17.212914578226
             les_mean =     296.562794501541
             stat err =       0.000414208321
             autocorr =       1.232681499666
   target nu stat err =       0.000414208321
   target dn stat err =       0.002604053082
      target stat err =       0.004594012054
              std dev =       0.527604362597
             le_variance =       0.278366363431


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947421704555        initial  <--
     3.9062e+00     3.9062e+01             1.4683e-04        -0.947416739997
     1.5625e+01     1.5625e+02             3.7213e-05        -0.947419260637
     6.2500e+01     6.2500e+02             9.3354e-06        -0.947421406494

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.6266
  </log>
  <optVariables href="H2O.s006.opt.xml">
 uu_0                 1.977230e-01 1 1  ON 0
 uu_1                 4.329089e-02 1 1  ON 1
 uu_2                -4.190098e-02 1 1  ON 2
 uu_3                -9.236120e-02 1 1  ON 3
 uu_4                -1.237670e-01 1 1  ON 4
 uu_5                -1.318994e-01 1 1  ON 5
 uu_6                -1.107146e-01 1 1  ON 6
 uu_7                -4.248964e-02 1 1  ON 7
 uu_8                 8.651243e-02 1 1  ON 8
 uu_9                 1.220556e-01 1 1  ON 9
 ud_0                 3.027789e-01 1 1  ON 10
 ud_1                 7.595656e-02 1 1  ON 11
 ud_2                -1.842714e-02 1 1  ON 12
 ud_3                -6.885720e-02 1 1  ON 13
 ud_4                -1.085261e-01 1 1  ON 14
 ud_5                -1.357461e-01 1 1  ON 15
 ud_6                -1.369594e-01 1 1  ON 16
 ud_7                -9.609270e-02 1 1  ON 17
 ud_8                 1.403375e-03 1 1  ON 18
 ud_9                 9.066847e-02 1 1  ON 19
 eO_0                -6.845932e-01 1 1  ON 20
 eO_1                -4.098407e-01 1 1  ON 21
 eO_2                -4.964640e-02 1 1  ON 22
 eO_3                 1.714490e-01 1 1  ON 23
 eO_4                 2.548269e-01 1 1  ON 24
 eO_5                 2.930600e-01 1 1  ON 25
 eO_6                 2.514068e-01 1 1  ON 26
 eO_7                 1.164775e-01 1 1  ON 27
 eO_8                 2.795949e-02 1 1  ON 28
 eO_9                 1.837756e-02 1 1  ON 29
eH1_0                -1.951870e-01 1 1  ON 30
eH1_1                -9.633905e-02 1 1  ON 31
eH1_2                -4.930510e-02 1 1  ON 32
eH1_3                -1.899654e-02 1 1  ON 33
eH1_4                 1.662896e-02 1 1  ON 34
eH1_5                 2.423019e-02 1 1  ON 35
eH1_6                 7.672500e-02 1 1  ON 36
eH1_7                 1.107328e-01 1 1  ON 37
eH1_8                 9.200803e-02 1 1  ON 38
eH1_9                 2.427183e-02 1 1  ON 39
eH2_0                -1.961539e-01 1 1  ON 40
eH2_1                -9.716454e-02 1 1  ON 41
eH2_2                -5.031385e-02 1 1  ON 42
eH2_3                -2.016348e-02 1 1  ON 43
eH2_4                 1.553139e-02 1 1  ON 44
eH2_5                 2.428103e-02 1 1  ON 45
eH2_6                 7.651930e-02 1 1  ON 46
eH2_7                 1.129280e-01 1 1  ON 47
eH2_8                 9.606464e-02 1 1  ON 48
eH2_9                 2.646666e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6556e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s007 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s007 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=7  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7197e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.1997
    reference variance = 0.176639
====================================================
  Execution time = 2.0711e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s007
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8541e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5624e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285448194697
                                         uncertainty =       0.006532155812

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285448194697
                                         uncertainty =       0.006532155812

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377760140
  error estimate for blocks of size 2^( 2) =       0.000391098706
  error estimate for blocks of size 2^( 3) =       0.000403507769
  error estimate for blocks of size 2^( 4) =       0.000412115103
  error estimate for blocks of size 2^( 5) =       0.000417708217
  error estimate for blocks of size 2^( 6) =       0.000419793289
  error estimate for blocks of size 2^( 7) =       0.000420937816

      target function =      -0.935269811736
              le_mean =     -17.212110668720
             les_mean =     296.542158975922
             stat err =       0.000417638606
             autocorr =       1.222275241874
   target nu stat err =       0.000417638606
   target dn stat err =       0.006601710839
      target stat err =       0.011202542510
              std dev =       0.534233512949
             le_variance =       0.285405446358


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721211066872e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935401653508       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935402390703       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935403032057       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935403387151       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.935403716333       residual = 9.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.935403916129       residual = 9.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.935404130576       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.935404287508       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.935404415285       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.935404486739       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.935404578368       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.935404640488       residual = 5.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.935404689707       residual = 2.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.935404719223       residual = 1.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.935404735643       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.935404749868       residual = 9.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.935404761681       residual = 7.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.935404768419       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.935404772044       residual = 1.77e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.935404773519       residual = 5.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.935404778986       residual = 4.76e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.935404779341       residual = 4.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.935404779394       residual = 6.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.935404779785       residual = 4.46e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.935404777875       residual = 4.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 3.523421e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935401653508       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935401838081       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935401998649       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935402087601       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.935402169914       residual = 9.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.935402219906       residual = 9.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.935402273550       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.935402312836       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.935402344807       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.935402362680       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.935402385597       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.935402401131       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.935402413435       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.935402420809       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.935402424913       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.935402428468       residual = 9.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.935402431417       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.935402433097       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.935402434001       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.935402434369       residual = 5.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.935402435733       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.935402435822       residual = 4.03e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.935402435833       residual = 6.72e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.935402435932       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.935402435454       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 8.816506e-06

solving harmonic davidson linear method for identity shift 6.2500e+02, overlap shift 6.2500e+03 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.935401653508       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.935401699669       residual = 2.95e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.935401739825       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.935401762074       residual = 2.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.935401782653       residual = 9.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.935401795154       residual = 9.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.935401808565       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.935401818392       residual = 4.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.935401826387       residual = 1.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.935401830855       residual = 1.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.935401836585       residual = 1.23e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.935401840469       residual = 5.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.935401843545       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.935401845390       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.935401846414       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.935401847302       residual = 9.79e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.935401848040       residual = 7.74e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.935401848458       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.935401848683       residual = 1.76e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.935401848778       residual = 5.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.935401849117       residual = 4.74e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.935401849143       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.935401849143       residual = 6.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.935401849170       residual = 4.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.935401849050       residual = 4.14e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.2500e+02 is 2.204624e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.823117 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6304e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 1.977246e-01 1 1  ON 0
 uu_1                 4.329285e-02 1 1  ON 1
 uu_2                -4.189952e-02 1 1  ON 2
 uu_3                -9.236021e-02 1 1  ON 3
 uu_4                -1.237657e-01 1 1  ON 4
 uu_5                -1.318997e-01 1 1  ON 5
 uu_6                -1.107169e-01 1 1  ON 6
 uu_7                -4.249227e-02 1 1  ON 7
 uu_8                 8.650920e-02 1 1  ON 8
 uu_9                 1.220560e-01 1 1  ON 9
 ud_0                 3.027739e-01 1 1  ON 10
 ud_1                 7.595297e-02 1 1  ON 11
 ud_2                -1.843143e-02 1 1  ON 12
 ud_3                -6.886106e-02 1 1  ON 13
 ud_4                -1.085273e-01 1 1  ON 14
 ud_5                -1.357427e-01 1 1  ON 15
 ud_6                -1.369506e-01 1 1  ON 16
 ud_7                -9.608628e-02 1 1  ON 17
 ud_8                 1.401746e-03 1 1  ON 18
 ud_9                 9.066825e-02 1 1  ON 19
 eO_0                -6.845929e-01 1 1  ON 20
 eO_1                -4.098414e-01 1 1  ON 21
 eO_2                -4.964561e-02 1 1  ON 22
 eO_3                 1.714467e-01 1 1  ON 23
 eO_4                 2.548229e-01 1 1  ON 24
 eO_5                 2.930614e-01 1 1  ON 25
 eO_6                 2.514091e-01 1 1  ON 26
 eO_7                 1.164797e-01 1 1  ON 27
 eO_8                 2.795971e-02 1 1  ON 28
 eO_9                 1.837749e-02 1 1  ON 29
eH1_0                -1.951877e-01 1 1  ON 30
eH1_1                -9.633644e-02 1 1  ON 31
eH1_2                -4.930070e-02 1 1  ON 32
eH1_3                -1.899318e-02 1 1  ON 33
eH1_4                 1.662876e-02 1 1  ON 34
eH1_5                 2.422473e-02 1 1  ON 35
eH1_6                 7.672055e-02 1 1  ON 36
eH1_7                 1.107322e-01 1 1  ON 37
eH1_8                 9.200888e-02 1 1  ON 38
eH1_9                 2.427206e-02 1 1  ON 39
eH2_0                -1.961565e-01 1 1  ON 40
eH2_1                -9.716489e-02 1 1  ON 41
eH2_2                -5.031189e-02 1 1  ON 42
eH2_3                -2.016147e-02 1 1  ON 43
eH2_4                 1.553222e-02 1 1  ON 44
eH2_5                 2.428124e-02 1 1  ON 45
eH2_6                 7.651754e-02 1 1  ON 46
eH2_7                 1.129265e-01 1 1  ON 47
eH2_8                 9.606571e-02 1 1  ON 48
eH2_9                 2.646676e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 7
    time step          = 0.05
    reference energy   = -17.232
    reference variance = 0.196616
====================================================
  Execution time = 2.0122e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s007
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7622e-01
  Total weights = 2.0000e+06
  Execution time = 1.8441e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276202026577
                                         uncertainty =       0.002012393696

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276202026577
                                         uncertainty =       0.002012393696

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371629154
  error estimate for blocks of size 2^( 2) =       0.000385386118
  error estimate for blocks of size 2^( 3) =       0.000397971690
  error estimate for blocks of size 2^( 4) =       0.000407276473
  error estimate for blocks of size 2^( 5) =       0.000413650678
  error estimate for blocks of size 2^( 6) =       0.000416116564
  error estimate for blocks of size 2^( 7) =       0.000417118194

      target function =      -0.951202570672
              le_mean =     -17.212459253515
             les_mean =     296.544969871285
             stat err =       0.000413540478
             autocorr =       1.238273269007
   target nu stat err =       0.000413540478
   target dn stat err =       0.001886796918
      target stat err =       0.003392629627
              std dev =       0.525562989081
             le_variance =       0.276216455492

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276200958635
                                         uncertainty =       0.002012365340

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276200958635
                                         uncertainty =       0.002012365340

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371628434
  error estimate for blocks of size 2^( 2) =       0.000385385860
  error estimate for blocks of size 2^( 3) =       0.000397972022
  error estimate for blocks of size 2^( 4) =       0.000407277381
  error estimate for blocks of size 2^( 5) =       0.000413651964
  error estimate for blocks of size 2^( 6) =       0.000416117966
  error estimate for blocks of size 2^( 7) =       0.000417119655

      target function =      -0.951204448277
              le_mean =     -17.212459183067
             les_mean =     296.544966376004
             stat err =       0.000413541742
             autocorr =       1.238285635480
   target nu stat err =       0.000413541742
   target dn stat err =       0.001886769032
      target stat err =       0.003392595128
              std dev =       0.525561971012
             le_variance =       0.276215385374

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276201491297
                                         uncertainty =       0.002012379499

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276201491297
                                         uncertainty =       0.002012379499

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371628793
  error estimate for blocks of size 2^( 2) =       0.000385385988
  error estimate for blocks of size 2^( 3) =       0.000397971855
  error estimate for blocks of size 2^( 4) =       0.000407276927
  error estimate for blocks of size 2^( 5) =       0.000413651321
  error estimate for blocks of size 2^( 6) =       0.000416117265
  error estimate for blocks of size 2^( 7) =       0.000417118924

      target function =      -0.951203511779
              le_mean =     -17.212459218038
             les_mean =     296.544968113633
             stat err =       0.000413541109
             autocorr =       1.238279456200
   target nu stat err =       0.000413541109
   target dn stat err =       0.001886782955
      target stat err =       0.003392612358
              std dev =       0.525562478800
             le_variance =       0.276215919122

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276201959574
                                         uncertainty =       0.002012391920

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276201959574
                                         uncertainty =       0.002012391920

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371629108
  error estimate for blocks of size 2^( 2) =       0.000385386102
  error estimate for blocks of size 2^( 3) =       0.000397971711
  error estimate for blocks of size 2^( 4) =       0.000407276530
  error estimate for blocks of size 2^( 5) =       0.000413650759
  error estimate for blocks of size 2^( 6) =       0.000416116652
  error estimate for blocks of size 2^( 7) =       0.000417118285

      target function =      -0.951202688475
              le_mean =     -17.212459249056
             les_mean =     296.544969650657
             stat err =       0.000413540557
             autocorr =       1.238274042384
   target nu stat err =       0.000413540557
   target dn stat err =       0.001886795172
      target stat err =       0.003392627469
              std dev =       0.525562925207
             le_variance =       0.276216388352


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.951202570672        initial
     3.9062e+01     3.9062e+02             3.5234e-05        -0.951204448277  <--
     1.5625e+02     1.5625e+03             8.8165e-06        -0.951203511779
     6.2500e+02     6.2500e+03             2.2046e-06        -0.951202688475

*****************************************************************************
Applying the update for shift_i =   3.9062e+01     and shift_s =   3.9062e+02
*****************************************************************************

  Execution time = 2.9424e+01
  </log>
  <optVariables href="H2O.s007.opt.xml">
 uu_0                 1.977294e-01 1 1  ON 0
 uu_1                 4.329873e-02 1 1  ON 1
 uu_2                -4.189515e-02 1 1  ON 2
 uu_3                -9.235725e-02 1 1  ON 3
 uu_4                -1.237620e-01 1 1  ON 4
 uu_5                -1.319007e-01 1 1  ON 5
 uu_6                -1.107236e-01 1 1  ON 6
 uu_7                -4.250016e-02 1 1  ON 7
 uu_8                 8.649955e-02 1 1  ON 8
 uu_9                 1.220570e-01 1 1  ON 9
 ud_0                 3.027590e-01 1 1  ON 10
 ud_1                 7.594221e-02 1 1  ON 11
 ud_2                -1.844429e-02 1 1  ON 12
 ud_3                -6.887261e-02 1 1  ON 13
 ud_4                -1.085306e-01 1 1  ON 14
 ud_5                -1.357327e-01 1 1  ON 15
 ud_6                -1.369242e-01 1 1  ON 16
 ud_7                -9.606704e-02 1 1  ON 17
 ud_8                 1.396870e-03 1 1  ON 18
 ud_9                 9.066759e-02 1 1  ON 19
 eO_0                -6.845923e-01 1 1  ON 20
 eO_1                -4.098435e-01 1 1  ON 21
 eO_2                -4.964325e-02 1 1  ON 22
 eO_3                 1.714396e-01 1 1  ON 23
 eO_4                 2.548107e-01 1 1  ON 24
 eO_5                 2.930653e-01 1 1  ON 25
 eO_6                 2.514159e-01 1 1  ON 26
 eO_7                 1.164863e-01 1 1  ON 27
 eO_8                 2.796039e-02 1 1  ON 28
 eO_9                 1.837727e-02 1 1  ON 29
eH1_0                -1.951900e-01 1 1  ON 30
eH1_1                -9.632862e-02 1 1  ON 31
eH1_2                -4.928754e-02 1 1  ON 32
eH1_3                -1.898309e-02 1 1  ON 33
eH1_4                 1.662819e-02 1 1  ON 34
eH1_5                 2.420835e-02 1 1  ON 35
eH1_6                 7.670720e-02 1 1  ON 36
eH1_7                 1.107304e-01 1 1  ON 37
eH1_8                 9.201144e-02 1 1  ON 38
eH1_9                 2.427277e-02 1 1  ON 39
eH2_0                -1.961645e-01 1 1  ON 40
eH2_1                -9.716594e-02 1 1  ON 41
eH2_2                -5.030604e-02 1 1  ON 42
eH2_3                -2.015544e-02 1 1  ON 43
eH2_4                 1.553472e-02 1 1  ON 44
eH2_5                 2.428186e-02 1 1  ON 45
eH2_6                 7.651223e-02 1 1  ON 46
eH2_7                 1.129221e-01 1 1  ON 47
eH2_8                 9.606894e-02 1 1  ON 48
eH2_9                 2.646703e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5735e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s008 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s008 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=8  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7199e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.174
    reference variance = 0.161172
====================================================
  Execution time = 2.0616e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s008
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7968e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5600e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279696858972
                                         uncertainty =       0.003221855818

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279696858972
                                         uncertainty =       0.003221855818

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373949220
  error estimate for blocks of size 2^( 2) =       0.000387304584
  error estimate for blocks of size 2^( 3) =       0.000399338267
  error estimate for blocks of size 2^( 4) =       0.000407661283
  error estimate for blocks of size 2^( 5) =       0.000413128831
  error estimate for blocks of size 2^( 6) =       0.000414607317
  error estimate for blocks of size 2^( 7) =       0.000416347717

      target function =      -0.945137777383
              le_mean =     -17.212935895429
             les_mean =     296.564838038737
             stat err =       0.000412936287
             autocorr =       1.219384956183
   target nu stat err =       0.000412936287
   target dn stat err =       0.003146961525
      target stat err =       0.005501352719
              std dev =       0.528844058717
             le_variance =       0.279676038440


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721293589543e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+00, overlap shift 9.7656e+01 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945168650459       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945172295554       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945174151723       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945174989197       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945175804243       residual = 4.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945176317105       residual = 6.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945176908155       residual = 7.20e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945177403239       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945177537802       residual = 3.65e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945177628257       residual = 3.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945177686040       residual = 3.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945177719302       residual = 2.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945177733326       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945177766720       residual = 7.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.945177819395       residual = 6.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945177859912       residual = 5.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.945177848986       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945177883864       residual = 7.95e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945177881071       residual = 5.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945177882512       residual = 5.70e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945177886401       residual = 1.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945177881115       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945177881944       residual = 2.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945177884724       residual = 1.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.945177886442       residual = 1.81e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+00 is 6.763797e-05

solving harmonic davidson linear method for identity shift 3.9062e+01, overlap shift 3.9062e+02 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945168650459       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945169567236       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945170034125       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945170244902       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945170449240       residual = 4.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945170577932       residual = 6.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945170726400       residual = 7.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945170850729       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945170884430       residual = 3.64e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945170907084       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945170921585       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945170929790       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945170933671       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945170941801       residual = 7.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.945170954896       residual = 6.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945170965005       residual = 5.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.945170962230       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945170970915       residual = 7.83e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945170970227       residual = 5.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945170970579       residual = 5.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945170971548       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945170970228       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945170970432       residual = 2.27e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945170971123       residual = 1.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.945170971544       residual = 1.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+01 is 1.693841e-05

solving harmonic davidson linear method for identity shift 1.5625e+02, overlap shift 1.5625e+03 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945168650459       residual = 1.81e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945168880000       residual = 1.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945168996901       residual = 1.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945169049685       residual = 1.28e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945169100805       residual = 4.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945169133008       residual = 6.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945169170170       residual = 7.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945169201286       residual = 1.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945169209715       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945169215381       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945169219010       residual = 3.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945169221054       residual = 2.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945169222050       residual = 2.27e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945169224068       residual = 7.47e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.945169227337       residual = 6.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945169229862       residual = 5.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.945169229166       residual = 2.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945169231335       residual = 7.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945169231163       residual = 5.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945169231251       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945169231493       residual = 1.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945169231163       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945169231214       residual = 2.25e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945169231387       residual = 1.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.945169231490       residual = 1.78e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+02 is 4.236414e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.843010 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6207e+01
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 1.977422e-01 1 1  ON 0
 uu_1                 4.331007e-02 1 1  ON 1
 uu_2                -4.188847e-02 1 1  ON 2
 uu_3                -9.235311e-02 1 1  ON 3
 uu_4                -1.237599e-01 1 1  ON 4
 uu_5                -1.319026e-01 1 1  ON 5
 uu_6                -1.107336e-01 1 1  ON 6
 uu_7                -4.251710e-02 1 1  ON 7
 uu_8                 8.648449e-02 1 1  ON 8
 uu_9                 1.220601e-01 1 1  ON 9
 ud_0                 3.027552e-01 1 1  ON 10
 ud_1                 7.594034e-02 1 1  ON 11
 ud_2                -1.845346e-02 1 1  ON 12
 ud_3                -6.888283e-02 1 1  ON 13
 ud_4                -1.085343e-01 1 1  ON 14
 ud_5                -1.357248e-01 1 1  ON 15
 ud_6                -1.369079e-01 1 1  ON 16
 ud_7                -9.605583e-02 1 1  ON 17
 ud_8                 1.389420e-03 1 1  ON 18
 ud_9                 9.066488e-02 1 1  ON 19
 eO_0                -6.846053e-01 1 1  ON 20
 eO_1                -4.098529e-01 1 1  ON 21
 eO_2                -4.964096e-02 1 1  ON 22
 eO_3                 1.714439e-01 1 1  ON 23
 eO_4                 2.548153e-01 1 1  ON 24
 eO_5                 2.930663e-01 1 1  ON 25
 eO_6                 2.514196e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796042e-02 1 1  ON 28
 eO_9                 1.837802e-02 1 1  ON 29
eH1_0                -1.952023e-01 1 1  ON 30
eH1_1                -9.633126e-02 1 1  ON 31
eH1_2                -4.928208e-02 1 1  ON 32
eH1_3                -1.897506e-02 1 1  ON 33
eH1_4                 1.663233e-02 1 1  ON 34
eH1_5                 2.420595e-02 1 1  ON 35
eH1_6                 7.670594e-02 1 1  ON 36
eH1_7                 1.107280e-01 1 1  ON 37
eH1_8                 9.201419e-02 1 1  ON 38
eH1_9                 2.427315e-02 1 1  ON 39
eH2_0                -1.961785e-01 1 1  ON 40
eH2_1                -9.716917e-02 1 1  ON 41
eH2_2                -5.029908e-02 1 1  ON 42
eH2_3                -2.014492e-02 1 1  ON 43
eH2_4                 1.553988e-02 1 1  ON 44
eH2_5                 2.427745e-02 1 1  ON 45
eH2_6                 7.650663e-02 1 1  ON 46
eH2_7                 1.129214e-01 1 1  ON 47
eH2_8                 9.607349e-02 1 1  ON 48
eH2_9                 2.646767e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 8
    time step          = 0.05
    reference energy   = -17.1819
    reference variance = 0.19957
====================================================
  Execution time = 2.0631e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s008
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7513e-01
  Total weights = 2.0000e+06
  Execution time = 1.8352e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275205770825
                                         uncertainty =       0.002232558914

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275205770825
                                         uncertainty =       0.002232558914

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370893929
  error estimate for blocks of size 2^( 2) =       0.000384433574
  error estimate for blocks of size 2^( 3) =       0.000397006730
  error estimate for blocks of size 2^( 4) =       0.000405786564
  error estimate for blocks of size 2^( 5) =       0.000411467042
  error estimate for blocks of size 2^( 6) =       0.000413627347
  error estimate for blocks of size 2^( 7) =       0.000415777437

      target function =      -0.953137026373
              le_mean =     -17.211742382043
             les_mean =     296.519200301085
             stat err =       0.000411664597
             autocorr =       1.231934424422
   target nu stat err =       0.000411664597
   target dn stat err =       0.002053548332
      target stat err =       0.003686762098
              std dev =       0.524523224296
             le_variance =       0.275124612826

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275211625870
                                         uncertainty =       0.002232721406

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275211625870
                                         uncertainty =       0.002232721406

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370897869
  error estimate for blocks of size 2^( 2) =       0.000384436579
  error estimate for blocks of size 2^( 3) =       0.000397009633
  error estimate for blocks of size 2^( 4) =       0.000405789999
  error estimate for blocks of size 2^( 5) =       0.000411471093
  error estimate for blocks of size 2^( 6) =       0.000413632254
  error estimate for blocks of size 2^( 7) =       0.000415783771

      target function =      -0.953126763356
              le_mean =     -17.211742112774
             les_mean =     296.519196876921
             stat err =       0.000411669279
             autocorr =       1.231936272694
   target nu stat err =       0.000411669279
   target dn stat err =       0.002053654753
      target stat err =       0.003686867208
              std dev =       0.524528796001
             le_variance =       0.275130457834

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275208705046
                                         uncertainty =       0.002232640566

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275208705046
                                         uncertainty =       0.002232640566

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370895903
  error estimate for blocks of size 2^( 2) =       0.000384435076
  error estimate for blocks of size 2^( 3) =       0.000397008179
  error estimate for blocks of size 2^( 4) =       0.000405788279
  error estimate for blocks of size 2^( 5) =       0.000411469066
  error estimate for blocks of size 2^( 6) =       0.000413629800
  error estimate for blocks of size 2^( 7) =       0.000415780608

      target function =      -0.953131883197
              le_mean =     -17.211742244555
             les_mean =     296.519198497445
             stat err =       0.000411666938
             autocorr =       1.231935318853
   target nu stat err =       0.000411666938
   target dn stat err =       0.002053601795
      target stat err =       0.003686814981
              std dev =       0.524526016510
             le_variance =       0.275127541995

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275206137060
                                         uncertainty =       0.002232569132

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275206137060
                                         uncertainty =       0.002232569132

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370894175
  error estimate for blocks of size 2^( 2) =       0.000384433761
  error estimate for blocks of size 2^( 3) =       0.000397006910
  error estimate for blocks of size 2^( 4) =       0.000405786777
  error estimate for blocks of size 2^( 5) =       0.000411467294
  error estimate for blocks of size 2^( 6) =       0.000413627653
  error estimate for blocks of size 2^( 7) =       0.000415777833

      target function =      -0.953136384434
              le_mean =     -17.211742364597
             les_mean =     296.519200066141
             stat err =       0.000411664889
             autocorr =       1.231934534093
   target nu stat err =       0.000411664889
   target dn stat err =       0.002053555022
      target stat err =       0.003686768726
              std dev =       0.524523572805
             le_variance =       0.275124978428


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.953137026373        initial  <--
     9.7656e+00     9.7656e+01             6.7638e-05        -0.953126763356
     3.9062e+01     3.9062e+02             1.6938e-05        -0.953131883197
     1.5625e+02     1.5625e+03             4.2364e-06        -0.953136384434

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.9293
  </log>
  <optVariables href="H2O.s008.opt.xml">
 uu_0                 1.977294e-01 1 1  ON 0
 uu_1                 4.329873e-02 1 1  ON 1
 uu_2                -4.189515e-02 1 1  ON 2
 uu_3                -9.235725e-02 1 1  ON 3
 uu_4                -1.237620e-01 1 1  ON 4
 uu_5                -1.319007e-01 1 1  ON 5
 uu_6                -1.107236e-01 1 1  ON 6
 uu_7                -4.250016e-02 1 1  ON 7
 uu_8                 8.649955e-02 1 1  ON 8
 uu_9                 1.220570e-01 1 1  ON 9
 ud_0                 3.027590e-01 1 1  ON 10
 ud_1                 7.594221e-02 1 1  ON 11
 ud_2                -1.844429e-02 1 1  ON 12
 ud_3                -6.887261e-02 1 1  ON 13
 ud_4                -1.085306e-01 1 1  ON 14
 ud_5                -1.357327e-01 1 1  ON 15
 ud_6                -1.369242e-01 1 1  ON 16
 ud_7                -9.606704e-02 1 1  ON 17
 ud_8                 1.396870e-03 1 1  ON 18
 ud_9                 9.066759e-02 1 1  ON 19
 eO_0                -6.845923e-01 1 1  ON 20
 eO_1                -4.098435e-01 1 1  ON 21
 eO_2                -4.964325e-02 1 1  ON 22
 eO_3                 1.714396e-01 1 1  ON 23
 eO_4                 2.548107e-01 1 1  ON 24
 eO_5                 2.930653e-01 1 1  ON 25
 eO_6                 2.514159e-01 1 1  ON 26
 eO_7                 1.164863e-01 1 1  ON 27
 eO_8                 2.796039e-02 1 1  ON 28
 eO_9                 1.837727e-02 1 1  ON 29
eH1_0                -1.951900e-01 1 1  ON 30
eH1_1                -9.632862e-02 1 1  ON 31
eH1_2                -4.928754e-02 1 1  ON 32
eH1_3                -1.898309e-02 1 1  ON 33
eH1_4                 1.662819e-02 1 1  ON 34
eH1_5                 2.420835e-02 1 1  ON 35
eH1_6                 7.670720e-02 1 1  ON 36
eH1_7                 1.107304e-01 1 1  ON 37
eH1_8                 9.201144e-02 1 1  ON 38
eH1_9                 2.427277e-02 1 1  ON 39
eH2_0                -1.961645e-01 1 1  ON 40
eH2_1                -9.716594e-02 1 1  ON 41
eH2_2                -5.030604e-02 1 1  ON 42
eH2_3                -2.015544e-02 1 1  ON 43
eH2_4                 1.553472e-02 1 1  ON 44
eH2_5                 2.428186e-02 1 1  ON 45
eH2_6                 7.651223e-02 1 1  ON 46
eH2_7                 1.129221e-01 1 1  ON 47
eH2_8                 9.606894e-02 1 1  ON 48
eH2_9                 2.646703e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6143e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s009 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s009 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=9  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7197e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.2848
    reference variance = 0.264457
====================================================
  Execution time = 2.2750e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s009
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8704e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5373e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287101658253
                                         uncertainty =       0.004876668253

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287101658253
                                         uncertainty =       0.004876668253

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378838353
  error estimate for blocks of size 2^( 2) =       0.000392134100
  error estimate for blocks of size 2^( 3) =       0.000404232375
  error estimate for blocks of size 2^( 4) =       0.000412827790
  error estimate for blocks of size 2^( 5) =       0.000417526132
  error estimate for blocks of size 2^( 6) =       0.000419958850
  error estimate for blocks of size 2^( 7) =       0.000418250412

      target function =      -0.932550331594
              le_mean =     -17.212382012892
             les_mean =     296.553131409446
             stat err =       0.000417140796
             autocorr =       1.212432171822
   target nu stat err =       0.000417140796
   target dn stat err =       0.005089622566
      target stat err =       0.008603985316
              std dev =       0.535758336586
             le_variance =       0.287036995221


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721238201289e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932629278013       residual = 1.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932629661726       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932629767758       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932629816829       residual = 8.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932629868609       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932629916720       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932629941571       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932629973786       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932629993956       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932629997244       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932630006097       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932630017840       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932630023315       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932630028323       residual = 6.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932630029386       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932630032013       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932630033121       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.932630035456       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932630035073       residual = 3.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.932630035121       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.932630034917       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932630035309       residual = 3.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.932630035533       residual = 1.81e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.932630035537       residual = 1.18e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.932630035590       residual = 1.82e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 7.075447e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932629278013       residual = 1.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932629373998       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932629400525       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932629412800       residual = 8.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932629425748       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932629437781       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932629443998       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932629452054       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932629457099       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932629457922       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932629460136       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932629463073       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932629464441       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932629465693       residual = 6.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932629465958       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932629466614       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932629466892       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.932629467475       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932629467378       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.932629467390       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.932629467341       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932629467438       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.932629467494       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.932629467497       residual = 1.08e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.932629467508       residual = 1.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 1.769229e-06

solving harmonic davidson linear method for identity shift 1.5625e+03, overlap shift 1.5625e+04 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932629278013       residual = 1.66e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932629302013       residual = 1.74e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932629308646       residual = 1.04e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932629311715       residual = 8.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932629314952       residual = 5.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932629317961       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932629319514       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932629321529       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932629322790       residual = 3.78e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932629322998       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932629323547       residual = 3.94e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932629324288       residual = 1.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932629324627       residual = 1.17e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932629324942       residual = 6.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932629325003       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932629325173       residual = 3.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932629325239       residual = 1.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.932629325382       residual = 1.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932629325358       residual = 3.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.932629325361       residual = 1.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.932629325354       residual = 1.73e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932629325375       residual = 3.14e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.932629325392       residual = 1.79e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.932629325390       residual = 1.06e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.932629325391       residual = 1.84e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5625e+03 is 4.423301e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.862873 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8318e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 1.977302e-01 1 1  ON 0
 uu_1                 4.329943e-02 1 1  ON 1
 uu_2                -4.189471e-02 1 1  ON 2
 uu_3                -9.235704e-02 1 1  ON 3
 uu_4                -1.237618e-01 1 1  ON 4
 uu_5                -1.319008e-01 1 1  ON 5
 uu_6                -1.107235e-01 1 1  ON 6
 uu_7                -4.250125e-02 1 1  ON 7
 uu_8                 8.649809e-02 1 1  ON 8
 uu_9                 1.220571e-01 1 1  ON 9
 ud_0                 3.027583e-01 1 1  ON 10
 ud_1                 7.594208e-02 1 1  ON 11
 ud_2                -1.844494e-02 1 1  ON 12
 ud_3                -6.887340e-02 1 1  ON 13
 ud_4                -1.085309e-01 1 1  ON 14
 ud_5                -1.357319e-01 1 1  ON 15
 ud_6                -1.369228e-01 1 1  ON 16
 ud_7                -9.606607e-02 1 1  ON 17
 ud_8                 1.396321e-03 1 1  ON 18
 ud_9                 9.066740e-02 1 1  ON 19
 eO_0                -6.845922e-01 1 1  ON 20
 eO_1                -4.098438e-01 1 1  ON 21
 eO_2                -4.964272e-02 1 1  ON 22
 eO_3                 1.714404e-01 1 1  ON 23
 eO_4                 2.548105e-01 1 1  ON 24
 eO_5                 2.930635e-01 1 1  ON 25
 eO_6                 2.514161e-01 1 1  ON 26
 eO_7                 1.164870e-01 1 1  ON 27
 eO_8                 2.796043e-02 1 1  ON 28
 eO_9                 1.837729e-02 1 1  ON 29
eH1_0                -1.951915e-01 1 1  ON 30
eH1_1                -9.632895e-02 1 1  ON 31
eH1_2                -4.928713e-02 1 1  ON 32
eH1_3                -1.898255e-02 1 1  ON 33
eH1_4                 1.662906e-02 1 1  ON 34
eH1_5                 2.420885e-02 1 1  ON 35
eH1_6                 7.670657e-02 1 1  ON 36
eH1_7                 1.107301e-01 1 1  ON 37
eH1_8                 9.201176e-02 1 1  ON 38
eH1_9                 2.427278e-02 1 1  ON 39
eH2_0                -1.961655e-01 1 1  ON 40
eH2_1                -9.716621e-02 1 1  ON 41
eH2_2                -5.030563e-02 1 1  ON 42
eH2_3                -2.015516e-02 1 1  ON 43
eH2_4                 1.553467e-02 1 1  ON 44
eH2_5                 2.428208e-02 1 1  ON 45
eH2_6                 7.651240e-02 1 1  ON 46
eH2_7                 1.129222e-01 1 1  ON 47
eH2_8                 9.606920e-02 1 1  ON 48
eH2_9                 2.646704e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 9
    time step          = 0.05
    reference energy   = -17.0405
    reference variance = 2.88155
====================================================
  Execution time = 2.0370e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s009
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8978e-01
  Total weights = 2.0000e+06
  Execution time = 1.8261e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289570147270
                                         uncertainty =       0.010001139937

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289570147270
                                         uncertainty =       0.010001139937

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380644351
  error estimate for blocks of size 2^( 2) =       0.000393927498
  error estimate for blocks of size 2^( 3) =       0.000406227792
  error estimate for blocks of size 2^( 4) =       0.000414641987
  error estimate for blocks of size 2^( 5) =       0.000419679025
  error estimate for blocks of size 2^( 6) =       0.000421021317
  error estimate for blocks of size 2^( 7) =       0.000423239916

      target function =      -0.927686501662
              le_mean =     -17.212853845619
             les_mean =     296.572117609417
             stat err =       0.000419645561
             autocorr =       1.215420312835
   target nu stat err =       0.000419645561
   target dn stat err =       0.010132153589
      target stat err =       0.016921568071
              std dev =       0.538312403418
             le_variance =       0.289780243673

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289570029279
                                         uncertainty =       0.010000876973

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289570029279
                                         uncertainty =       0.010000876973

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380644272
  error estimate for blocks of size 2^( 2) =       0.000393927496
  error estimate for blocks of size 2^( 3) =       0.000406227901
  error estimate for blocks of size 2^( 4) =       0.000414642228
  error estimate for blocks of size 2^( 5) =       0.000419679350
  error estimate for blocks of size 2^( 6) =       0.000421021739
  error estimate for blocks of size 2^( 7) =       0.000423240370

      target function =      -0.927686716519
              le_mean =     -17.212853855987
             les_mean =     296.572117846661
             stat err =       0.000419645922
             autocorr =       1.215422902440
   target nu stat err =       0.000419645922
   target dn stat err =       0.010131890238
      target stat err =       0.016921137035
              std dev =       0.538312292236
             le_variance =       0.289780123973

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289570088164
                                         uncertainty =       0.010001008373

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289570088164
                                         uncertainty =       0.010001008373

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380644311
  error estimate for blocks of size 2^( 2) =       0.000393927497
  error estimate for blocks of size 2^( 3) =       0.000406227847
  error estimate for blocks of size 2^( 4) =       0.000414642107
  error estimate for blocks of size 2^( 5) =       0.000419679188
  error estimate for blocks of size 2^( 6) =       0.000421021528
  error estimate for blocks of size 2^( 7) =       0.000423240143

      target function =      -0.927686609282
              le_mean =     -17.212853850790
             les_mean =     296.572117727478
             stat err =       0.000419645742
             autocorr =       1.215421608097
   target nu stat err =       0.000419645742
   target dn stat err =       0.010132021832
      target stat err =       0.016921352424
              std dev =       0.538312347724
             le_variance =       0.289780183712

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289570139872
                                         uncertainty =       0.010001123489

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.289570139872
                                         uncertainty =       0.010001123489

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000380644346
  error estimate for blocks of size 2^( 2) =       0.000393927498
  error estimate for blocks of size 2^( 3) =       0.000406227799
  error estimate for blocks of size 2^( 4) =       0.000414642002
  error estimate for blocks of size 2^( 5) =       0.000419679046
  error estimate for blocks of size 2^( 6) =       0.000421021343
  error estimate for blocks of size 2^( 7) =       0.000423239945

      target function =      -0.927686515131
              le_mean =     -17.212853846264
             les_mean =     296.572117624109
             stat err =       0.000419645584
             autocorr =       1.215420474767
   target nu stat err =       0.000419645584
   target dn stat err =       0.010132137117
      target stat err =       0.016921541111
              std dev =       0.538312396447
             le_variance =       0.289780236168


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.927686501662        initial
     9.7656e+01     9.7656e+02             7.0754e-06        -0.927686716519  <--
     3.9062e+02     3.9062e+03             1.7692e-06        -0.927686609282
     1.5625e+03     1.5625e+04             4.4233e-07        -0.927686515131

*****************************************************************************
Applying the update for shift_i =   9.7656e+01     and shift_s =   9.7656e+02
*****************************************************************************

  Execution time = 2.9602e+01
  </log>
  <optVariables href="H2O.s009.opt.xml">
 uu_0                 1.977323e-01 1 1  ON 0
 uu_1                 4.330152e-02 1 1  ON 1
 uu_2                -4.189339e-02 1 1  ON 2
 uu_3                -9.235642e-02 1 1  ON 3
 uu_4                -1.237614e-01 1 1  ON 4
 uu_5                -1.319009e-01 1 1  ON 5
 uu_6                -1.107234e-01 1 1  ON 6
 uu_7                -4.250449e-02 1 1  ON 7
 uu_8                 8.649372e-02 1 1  ON 8
 uu_9                 1.220574e-01 1 1  ON 9
 ud_0                 3.027560e-01 1 1  ON 10
 ud_1                 7.594167e-02 1 1  ON 11
 ud_2                -1.844687e-02 1 1  ON 12
 ud_3                -6.887574e-02 1 1  ON 13
 ud_4                -1.085317e-01 1 1  ON 14
 ud_5                -1.357297e-01 1 1  ON 15
 ud_6                -1.369187e-01 1 1  ON 16
 ud_7                -9.606316e-02 1 1  ON 17
 ud_8                 1.394677e-03 1 1  ON 18
 ud_9                 9.066680e-02 1 1  ON 19
 eO_0                -6.845919e-01 1 1  ON 20
 eO_1                -4.098446e-01 1 1  ON 21
 eO_2                -4.964113e-02 1 1  ON 22
 eO_3                 1.714426e-01 1 1  ON 23
 eO_4                 2.548096e-01 1 1  ON 24
 eO_5                 2.930582e-01 1 1  ON 25
 eO_6                 2.514169e-01 1 1  ON 26
 eO_7                 1.164891e-01 1 1  ON 27
 eO_8                 2.796056e-02 1 1  ON 28
 eO_9                 1.837732e-02 1 1  ON 29
eH1_0                -1.951960e-01 1 1  ON 30
eH1_1                -9.632995e-02 1 1  ON 31
eH1_2                -4.928589e-02 1 1  ON 32
eH1_3                -1.898090e-02 1 1  ON 33
eH1_4                 1.663169e-02 1 1  ON 34
eH1_5                 2.421037e-02 1 1  ON 35
eH1_6                 7.670467e-02 1 1  ON 36
eH1_7                 1.107294e-01 1 1  ON 37
eH1_8                 9.201269e-02 1 1  ON 38
eH1_9                 2.427283e-02 1 1  ON 39
eH2_0                -1.961687e-01 1 1  ON 40
eH2_1                -9.716701e-02 1 1  ON 41
eH2_2                -5.030442e-02 1 1  ON 42
eH2_3                -2.015434e-02 1 1  ON 43
eH2_4                 1.553451e-02 1 1  ON 44
eH2_5                 2.428273e-02 1 1  ON 45
eH2_6                 7.651289e-02 1 1  ON 46
eH2_7                 1.129223e-01 1 1  ON 47
eH2_8                 9.606999e-02 1 1  ON 48
eH2_9                 2.646707e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7927e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s010 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s010 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=10  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7194e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2041
    reference variance = 0.129426
====================================================
  Execution time = 2.0466e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s010
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7731e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5524e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277389500052
                                         uncertainty =       0.001883447465

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277389500052
                                         uncertainty =       0.001883447465

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372363027
  error estimate for blocks of size 2^( 2) =       0.000386016949
  error estimate for blocks of size 2^( 3) =       0.000398223747
  error estimate for blocks of size 2^( 4) =       0.000406907894
  error estimate for blocks of size 2^( 5) =       0.000413848599
  error estimate for blocks of size 2^( 6) =       0.000416673295
  error estimate for blocks of size 2^( 7) =       0.000420588091

      target function =      -0.949315165430
              le_mean =     -17.211800961284
             les_mean =     296.523400639990
             stat err =       0.000414504470
             autocorr =       1.239154139112
   target nu stat err =       0.000414504470
   target dn stat err =       0.002083331639
      target stat err =       0.003710163303
              std dev =       0.526600842940
             le_variance =       0.277308447785


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721180096128e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+01, overlap shift 2.4414e+02 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949326720618       residual = 9.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949327705624       residual = 9.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949327951243       residual = 9.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949328155736       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949328464513       residual = 6.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949328647865       residual = 3.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949328714899       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949328774468       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949328817868       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949328853385       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.949328874616       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.949328891693       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.949328920358       residual = 7.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.949328924943       residual = 5.84e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.949328943828       residual = 2.52e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.949328950954       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.949328954708       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.949328953634       residual = 2.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.949328953296       residual = 8.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.949328953559       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.949328954902       residual = 2.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.949328955678       residual = 7.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.949328957240       residual = 2.56e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.949328956944       residual = 6.79e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+01 is 1.864711e-05

solving harmonic davidson linear method for identity shift 9.7656e+01, overlap shift 9.7656e+02 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949326720618       residual = 9.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949326967468       residual = 9.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949327029056       residual = 9.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949327080334       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949327157612       residual = 6.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949327203538       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949327220340       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949327235254       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949327246124       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949327255016       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.949327260335       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.949327264608       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.949327271777       residual = 7.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.949327272918       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.949327277639       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.949327279416       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.949327280354       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.949327280084       residual = 2.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.949327279998       residual = 7.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.949327280064       residual = 1.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.949327280399       residual = 2.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.949327280593       residual = 7.33e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.949327280983       residual = 2.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.949327280908       residual = 6.73e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+01 is 4.668340e-06

solving harmonic davidson linear method for identity shift 3.9062e+02, overlap shift 3.9062e+03 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949326720618       residual = 9.87e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949326782368       residual = 9.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949326797777       residual = 9.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949326810606       residual = 1.01e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.949326829931       residual = 6.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.949326841418       residual = 3.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.949326845621       residual = 2.45e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.949326849351       residual = 1.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.949326852069       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.949326854293       residual = 1.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.949326855624       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.949326856693       residual = 1.49e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.949326858484       residual = 7.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.949326858769       residual = 5.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.949326859950       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.949326860394       residual = 1.66e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.949326860627       residual = 1.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.949326860560       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.949326860539       residual = 7.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.949326860556       residual = 1.61e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.949326860640       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.949326860687       residual = 7.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.949326860786       residual = 2.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.949326860767       residual = 6.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+02 is 1.167496e-06

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.880992 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6048e+01
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 1.977349e-01 1 1  ON 0
 uu_1                 4.330334e-02 1 1  ON 1
 uu_2                -4.189304e-02 1 1  ON 2
 uu_3                -9.235720e-02 1 1  ON 3
 uu_4                -1.237620e-01 1 1  ON 4
 uu_5                -1.319016e-01 1 1  ON 5
 uu_6                -1.107235e-01 1 1  ON 6
 uu_7                -4.250617e-02 1 1  ON 7
 uu_8                 8.649027e-02 1 1  ON 8
 uu_9                 1.220587e-01 1 1  ON 9
 ud_0                 3.027538e-01 1 1  ON 10
 ud_1                 7.594105e-02 1 1  ON 11
 ud_2                -1.844945e-02 1 1  ON 12
 ud_3                -6.887868e-02 1 1  ON 13
 ud_4                -1.085327e-01 1 1  ON 14
 ud_5                -1.357277e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.605946e-02 1 1  ON 17
 ud_8                 1.392653e-03 1 1  ON 18
 ud_9                 9.066630e-02 1 1  ON 19
 eO_0                -6.845960e-01 1 1  ON 20
 eO_1                -4.098472e-01 1 1  ON 21
 eO_2                -4.963825e-02 1 1  ON 22
 eO_3                 1.714458e-01 1 1  ON 23
 eO_4                 2.548085e-01 1 1  ON 24
 eO_5                 2.930537e-01 1 1  ON 25
 eO_6                 2.514193e-01 1 1  ON 26
 eO_7                 1.164923e-01 1 1  ON 27
 eO_8                 2.796094e-02 1 1  ON 28
 eO_9                 1.837746e-02 1 1  ON 29
eH1_0                -1.952002e-01 1 1  ON 30
eH1_1                -9.632929e-02 1 1  ON 31
eH1_2                -4.928334e-02 1 1  ON 32
eH1_3                -1.897894e-02 1 1  ON 33
eH1_4                 1.663162e-02 1 1  ON 34
eH1_5                 2.420752e-02 1 1  ON 35
eH1_6                 7.670340e-02 1 1  ON 36
eH1_7                 1.107306e-01 1 1  ON 37
eH1_8                 9.201462e-02 1 1  ON 38
eH1_9                 2.427300e-02 1 1  ON 39
eH2_0                -1.961724e-01 1 1  ON 40
eH2_1                -9.716552e-02 1 1  ON 41
eH2_2                -5.030068e-02 1 1  ON 42
eH2_3                -2.015151e-02 1 1  ON 43
eH2_4                 1.553555e-02 1 1  ON 44
eH2_5                 2.428027e-02 1 1  ON 45
eH2_6                 7.650975e-02 1 1  ON 46
eH2_7                 1.129209e-01 1 1  ON 47
eH2_8                 9.607097e-02 1 1  ON 48
eH2_9                 2.646744e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 10
    time step          = 0.05
    reference energy   = -17.2958
    reference variance = 0.276497
====================================================
  Execution time = 1.9997e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s010
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7504e-01
  Total weights = 2.0000e+06
  Execution time = 1.8264e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274871591900
                                         uncertainty =       0.002231552948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274871591900
                                         uncertainty =       0.002231552948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370838832
  error estimate for blocks of size 2^( 2) =       0.000384868713
  error estimate for blocks of size 2^( 3) =       0.000396958186
  error estimate for blocks of size 2^( 4) =       0.000406328628
  error estimate for blocks of size 2^( 5) =       0.000412039977
  error estimate for blocks of size 2^( 6) =       0.000416287439
  error estimate for blocks of size 2^( 7) =       0.000415531325

      target function =      -0.953258346260
              le_mean =     -17.212404094343
             les_mean =     296.541897447958
             stat err =       0.000412546842
             autocorr =       1.237588102590
   target nu stat err =       0.000412546842
   target dn stat err =       0.002332753156
      target stat err =       0.004174711929
              std dev =       0.524445305556
             le_variance =       0.275042878519

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274872790091
                                         uncertainty =       0.002231615027

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274872790091
                                         uncertainty =       0.002231615027

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370839638
  error estimate for blocks of size 2^( 2) =       0.000384869492
  error estimate for blocks of size 2^( 3) =       0.000396959087
  error estimate for blocks of size 2^( 4) =       0.000406329863
  error estimate for blocks of size 2^( 5) =       0.000412041113
  error estimate for blocks of size 2^( 6) =       0.000416288822
  error estimate for blocks of size 2^( 7) =       0.000415532703

      target function =      -0.953256238726
              le_mean =     -17.212404160990
             les_mean =     296.541900938533
             stat err =       0.000412548125
             autocorr =       1.237590417309
   target nu stat err =       0.000412548125
   target dn stat err =       0.002332800484
      target stat err =       0.004174776631
              std dev =       0.524446446079
             le_variance =       0.275044074805

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274872191423
                                         uncertainty =       0.002231584051

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274872191423
                                         uncertainty =       0.002231584051

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370839235
  error estimate for blocks of size 2^( 2) =       0.000384869102
  error estimate for blocks of size 2^( 3) =       0.000396958636
  error estimate for blocks of size 2^( 4) =       0.000406329246
  error estimate for blocks of size 2^( 5) =       0.000412040545
  error estimate for blocks of size 2^( 6) =       0.000416288131
  error estimate for blocks of size 2^( 7) =       0.000415532015

      target function =      -0.953257291747
              le_mean =     -17.212404127567
             les_mean =     296.541899190265
             stat err =       0.000412547484
             autocorr =       1.237589260022
   target nu stat err =       0.000412547484
   target dn stat err =       0.002332776864
      target stat err =       0.004174744349
              std dev =       0.524445876223
             le_variance =       0.275043477087

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274871666780
                                         uncertainty =       0.002231556838

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274871666780
                                         uncertainty =       0.002231556838

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370838882
  error estimate for blocks of size 2^( 2) =       0.000384868762
  error estimate for blocks of size 2^( 3) =       0.000396958242
  error estimate for blocks of size 2^( 4) =       0.000406328705
  error estimate for blocks of size 2^( 5) =       0.000412040048
  error estimate for blocks of size 2^( 6) =       0.000416287526
  error estimate for blocks of size 2^( 7) =       0.000415531411

      target function =      -0.953258214552
              le_mean =     -17.212404098479
             les_mean =     296.541897665101
             stat err =       0.000412546922
             autocorr =       1.237588247212
   target nu stat err =       0.000412546922
   target dn stat err =       0.002332756120
      target stat err =       0.004174715984
              std dev =       0.524445376832
             le_variance =       0.275042953280


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.953258346260        initial  <--
     2.4414e+01     2.4414e+02             1.8647e-05        -0.953256238726
     9.7656e+01     9.7656e+02             4.6683e-06        -0.953257291747
     3.9062e+02     3.9062e+03             1.1675e-06        -0.953258214552

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2543
  </log>
  <optVariables href="H2O.s010.opt.xml">
 uu_0                 1.977323e-01 1 1  ON 0
 uu_1                 4.330152e-02 1 1  ON 1
 uu_2                -4.189339e-02 1 1  ON 2
 uu_3                -9.235642e-02 1 1  ON 3
 uu_4                -1.237614e-01 1 1  ON 4
 uu_5                -1.319009e-01 1 1  ON 5
 uu_6                -1.107234e-01 1 1  ON 6
 uu_7                -4.250449e-02 1 1  ON 7
 uu_8                 8.649372e-02 1 1  ON 8
 uu_9                 1.220574e-01 1 1  ON 9
 ud_0                 3.027560e-01 1 1  ON 10
 ud_1                 7.594167e-02 1 1  ON 11
 ud_2                -1.844687e-02 1 1  ON 12
 ud_3                -6.887574e-02 1 1  ON 13
 ud_4                -1.085317e-01 1 1  ON 14
 ud_5                -1.357297e-01 1 1  ON 15
 ud_6                -1.369187e-01 1 1  ON 16
 ud_7                -9.606316e-02 1 1  ON 17
 ud_8                 1.394677e-03 1 1  ON 18
 ud_9                 9.066680e-02 1 1  ON 19
 eO_0                -6.845919e-01 1 1  ON 20
 eO_1                -4.098446e-01 1 1  ON 21
 eO_2                -4.964113e-02 1 1  ON 22
 eO_3                 1.714426e-01 1 1  ON 23
 eO_4                 2.548096e-01 1 1  ON 24
 eO_5                 2.930582e-01 1 1  ON 25
 eO_6                 2.514169e-01 1 1  ON 26
 eO_7                 1.164891e-01 1 1  ON 27
 eO_8                 2.796056e-02 1 1  ON 28
 eO_9                 1.837732e-02 1 1  ON 29
eH1_0                -1.951960e-01 1 1  ON 30
eH1_1                -9.632995e-02 1 1  ON 31
eH1_2                -4.928589e-02 1 1  ON 32
eH1_3                -1.898090e-02 1 1  ON 33
eH1_4                 1.663169e-02 1 1  ON 34
eH1_5                 2.421037e-02 1 1  ON 35
eH1_6                 7.670467e-02 1 1  ON 36
eH1_7                 1.107294e-01 1 1  ON 37
eH1_8                 9.201269e-02 1 1  ON 38
eH1_9                 2.427283e-02 1 1  ON 39
eH2_0                -1.961687e-01 1 1  ON 40
eH2_1                -9.716701e-02 1 1  ON 41
eH2_2                -5.030442e-02 1 1  ON 42
eH2_3                -2.015434e-02 1 1  ON 43
eH2_4                 1.553451e-02 1 1  ON 44
eH2_5                 2.428273e-02 1 1  ON 45
eH2_6                 7.651289e-02 1 1  ON 46
eH2_7                 1.129223e-01 1 1  ON 47
eH2_8                 9.606999e-02 1 1  ON 48
eH2_9                 2.646707e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5309e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s011 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s011 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=11  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7199e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.1786
    reference variance = 0.132358
====================================================
  Execution time = 2.0518e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s011
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8340e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5232e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283454553326
                                         uncertainty =       0.003383376022

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283454553326
                                         uncertainty =       0.003383376022

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376433597
  error estimate for blocks of size 2^( 2) =       0.000389822338
  error estimate for blocks of size 2^( 3) =       0.000402377362
  error estimate for blocks of size 2^( 4) =       0.000411116684
  error estimate for blocks of size 2^( 5) =       0.000416455452
  error estimate for blocks of size 2^( 6) =       0.000417670051
  error estimate for blocks of size 2^( 7) =       0.000418490685

      target function =      -0.938776364805
              le_mean =     -17.211902905385
             les_mean =     296.533005988008
             stat err =       0.000415933218
             autocorr =       1.220872912362
   target nu stat err =       0.000415933218
   target dn stat err =       0.003461746626
      target stat err =       0.005950097730
              std dev =       0.532357497651
             le_variance =       0.283404505306


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721190290539e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+02, overlap shift 2.4414e+03 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938813297831       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938813476079       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938813518465       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938813559472       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938813593805       residual = 4.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938813617432       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938813629658       residual = 4.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938813646282       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938813651332       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938813655032       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938813657527       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938813661543       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938813662940       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.938813663581       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938813664385       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938813665614       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938813665404       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.938813666378       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938813666403       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.938813666414       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.938813666917       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.938813667010       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938813666984       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938813667036       residual = 6.48e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+02 is 2.844142e-06

solving harmonic davidson linear method for identity shift 9.7656e+02, overlap shift 9.7656e+03 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938813297831       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938813342404       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938813353003       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938813363258       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938813371841       residual = 4.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938813377750       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938813380806       residual = 4.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938813384961       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938813386225       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938813387152       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938813387774       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938813388782       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938813389129       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.938813389286       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938813389490       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938813389798       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938813389743       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.938813389984       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938813389994       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.938813389994       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.938813390122       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.938813390145       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938813390136       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938813390151       residual = 6.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+02 is 7.110900e-07

solving harmonic davidson linear method for identity shift 3.9062e+03, overlap shift 3.9062e+04 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938813297831       residual = 2.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938813308975       residual = 1.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938813311625       residual = 1.48e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938813314189       residual = 1.59e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938813316337       residual = 4.48e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938813317810       residual = 4.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938813318575       residual = 4.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938813319614       residual = 1.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938813319928       residual = 4.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938813320165       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938813320308       residual = 2.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938813320558       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938813320654       residual = 1.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.938813320697       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938813320744       residual = 5.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938813320835       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938813320798       residual = 2.54e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.938813320865       residual = 6.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938813320860       residual = 5.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.938813320875       residual = 2.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.938813320900       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.938813320907       residual = 1.16e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938813320909       residual = 3.02e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938813320914       residual = 6.47e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+03 is 1.777759e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.899141 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6070e+01
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 1.977327e-01 1 1  ON 0
 uu_1                 4.330180e-02 1 1  ON 1
 uu_2                -4.189322e-02 1 1  ON 2
 uu_3                -9.235633e-02 1 1  ON 3
 uu_4                -1.237613e-01 1 1  ON 4
 uu_5                -1.319009e-01 1 1  ON 5
 uu_6                -1.107237e-01 1 1  ON 6
 uu_7                -4.250499e-02 1 1  ON 7
 uu_8                 8.649323e-02 1 1  ON 8
 uu_9                 1.220575e-01 1 1  ON 9
 ud_0                 3.027558e-01 1 1  ON 10
 ud_1                 7.594164e-02 1 1  ON 11
 ud_2                -1.844720e-02 1 1  ON 12
 ud_3                -6.887614e-02 1 1  ON 13
 ud_4                -1.085318e-01 1 1  ON 14
 ud_5                -1.357295e-01 1 1  ON 15
 ud_6                -1.369182e-01 1 1  ON 16
 ud_7                -9.606261e-02 1 1  ON 17
 ud_8                 1.394483e-03 1 1  ON 18
 ud_9                 9.066674e-02 1 1  ON 19
 eO_0                -6.845921e-01 1 1  ON 20
 eO_1                -4.098447e-01 1 1  ON 21
 eO_2                -4.964077e-02 1 1  ON 22
 eO_3                 1.714428e-01 1 1  ON 23
 eO_4                 2.548094e-01 1 1  ON 24
 eO_5                 2.930575e-01 1 1  ON 25
 eO_6                 2.514170e-01 1 1  ON 26
 eO_7                 1.164895e-01 1 1  ON 27
 eO_8                 2.796059e-02 1 1  ON 28
 eO_9                 1.837734e-02 1 1  ON 29
eH1_0                -1.951964e-01 1 1  ON 30
eH1_1                -9.633001e-02 1 1  ON 31
eH1_2                -4.928558e-02 1 1  ON 32
eH1_3                -1.898056e-02 1 1  ON 33
eH1_4                 1.663184e-02 1 1  ON 34
eH1_5                 2.421016e-02 1 1  ON 35
eH1_6                 7.670450e-02 1 1  ON 36
eH1_7                 1.107293e-01 1 1  ON 37
eH1_8                 9.201283e-02 1 1  ON 38
eH1_9                 2.427286e-02 1 1  ON 39
eH2_0                -1.961692e-01 1 1  ON 40
eH2_1                -9.716688e-02 1 1  ON 41
eH2_2                -5.030394e-02 1 1  ON 42
eH2_3                -2.015394e-02 1 1  ON 43
eH2_4                 1.553464e-02 1 1  ON 44
eH2_5                 2.428236e-02 1 1  ON 45
eH2_6                 7.651266e-02 1 1  ON 46
eH2_7                 1.129222e-01 1 1  ON 47
eH2_8                 9.607008e-02 1 1  ON 48
eH2_9                 2.646712e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 11
    time step          = 0.05
    reference energy   = -17.2084
    reference variance = 0.293924
====================================================
  Execution time = 2.0573e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s011
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7629e-01
  Total weights = 2.0000e+06
  Execution time = 1.8278e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276313124849
                                         uncertainty =       0.003995731158

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276313124849
                                         uncertainty =       0.003995731158

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371679135
  error estimate for blocks of size 2^( 2) =       0.000385237377
  error estimate for blocks of size 2^( 3) =       0.000397751301
  error estimate for blocks of size 2^( 4) =       0.000406594716
  error estimate for blocks of size 2^( 5) =       0.000411728514
  error estimate for blocks of size 2^( 6) =       0.000413494638
  error estimate for blocks of size 2^( 7) =       0.000416541491

      target function =      -0.951037955520
              le_mean =     -17.212451030758
             les_mean =     296.544761106740
             stat err =       0.000412089840
             autocorr =       1.229270474999
   target nu stat err =       0.000412089840
   target dn stat err =       0.003763270053
      target stat err =       0.006635317630
              std dev =       0.525633673420
             le_variance =       0.276290758633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276313232236
                                         uncertainty =       0.003995763120

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276313232236
                                         uncertainty =       0.003995763120

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371679207
  error estimate for blocks of size 2^( 2) =       0.000385237450
  error estimate for blocks of size 2^( 3) =       0.000397751410
  error estimate for blocks of size 2^( 4) =       0.000406594875
  error estimate for blocks of size 2^( 5) =       0.000411728706
  error estimate for blocks of size 2^( 6) =       0.000413494858
  error estimate for blocks of size 2^( 7) =       0.000416541785

      target function =      -0.951037766959
              le_mean =     -17.212451026129
             les_mean =     296.544761054730
             stat err =       0.000412090056
             autocorr =       1.229271289166
   target nu stat err =       0.000412090056
   target dn stat err =       0.003763298223
      target stat err =       0.006635364026
              std dev =       0.525633775536
             le_variance =       0.276290865984

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276313178539
                                         uncertainty =       0.003995747143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276313178539
                                         uncertainty =       0.003995747143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371679171
  error estimate for blocks of size 2^( 2) =       0.000385237413
  error estimate for blocks of size 2^( 3) =       0.000397751356
  error estimate for blocks of size 2^( 4) =       0.000406594796
  error estimate for blocks of size 2^( 5) =       0.000411728610
  error estimate for blocks of size 2^( 6) =       0.000413494748
  error estimate for blocks of size 2^( 7) =       0.000416541638

      target function =      -0.951037861247
              le_mean =     -17.212451028439
             les_mean =     296.544761080586
             stat err =       0.000412089948
             autocorr =       1.229270882127
   target nu stat err =       0.000412089948
   target dn stat err =       0.003763284141
      target stat err =       0.006635340834
              std dev =       0.525633724474
             le_variance =       0.276290812304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276313131559
                                         uncertainty =       0.003995733157

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276313131559
                                         uncertainty =       0.003995733157

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371679139
  error estimate for blocks of size 2^( 2) =       0.000385237381
  error estimate for blocks of size 2^( 3) =       0.000397751307
  error estimate for blocks of size 2^( 4) =       0.000406594726
  error estimate for blocks of size 2^( 5) =       0.000411728526
  error estimate for blocks of size 2^( 6) =       0.000413494652
  error estimate for blocks of size 2^( 7) =       0.000416541509

      target function =      -0.951037943738
              le_mean =     -17.212451030468
             les_mean =     296.544761103456
             stat err =       0.000412089853
             autocorr =       1.229270525893
   target nu stat err =       0.000412089853
   target dn stat err =       0.003763271814
      target stat err =       0.006635320530
              std dev =       0.525633679800
             le_variance =       0.276290765340


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.951037955520        initial  <--
     2.4414e+02     2.4414e+03             2.8441e-06        -0.951037766959
     9.7656e+02     9.7656e+03             7.1109e-07        -0.951037861247
     3.9062e+03     3.9062e+04             1.7778e-07        -0.951037943738

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.8421
  </log>
  <optVariables href="H2O.s011.opt.xml">
 uu_0                 1.977323e-01 1 1  ON 0
 uu_1                 4.330152e-02 1 1  ON 1
 uu_2                -4.189339e-02 1 1  ON 2
 uu_3                -9.235642e-02 1 1  ON 3
 uu_4                -1.237614e-01 1 1  ON 4
 uu_5                -1.319009e-01 1 1  ON 5
 uu_6                -1.107234e-01 1 1  ON 6
 uu_7                -4.250449e-02 1 1  ON 7
 uu_8                 8.649372e-02 1 1  ON 8
 uu_9                 1.220574e-01 1 1  ON 9
 ud_0                 3.027560e-01 1 1  ON 10
 ud_1                 7.594167e-02 1 1  ON 11
 ud_2                -1.844687e-02 1 1  ON 12
 ud_3                -6.887574e-02 1 1  ON 13
 ud_4                -1.085317e-01 1 1  ON 14
 ud_5                -1.357297e-01 1 1  ON 15
 ud_6                -1.369187e-01 1 1  ON 16
 ud_7                -9.606316e-02 1 1  ON 17
 ud_8                 1.394677e-03 1 1  ON 18
 ud_9                 9.066680e-02 1 1  ON 19
 eO_0                -6.845919e-01 1 1  ON 20
 eO_1                -4.098446e-01 1 1  ON 21
 eO_2                -4.964113e-02 1 1  ON 22
 eO_3                 1.714426e-01 1 1  ON 23
 eO_4                 2.548096e-01 1 1  ON 24
 eO_5                 2.930582e-01 1 1  ON 25
 eO_6                 2.514169e-01 1 1  ON 26
 eO_7                 1.164891e-01 1 1  ON 27
 eO_8                 2.796056e-02 1 1  ON 28
 eO_9                 1.837732e-02 1 1  ON 29
eH1_0                -1.951960e-01 1 1  ON 30
eH1_1                -9.632995e-02 1 1  ON 31
eH1_2                -4.928589e-02 1 1  ON 32
eH1_3                -1.898090e-02 1 1  ON 33
eH1_4                 1.663169e-02 1 1  ON 34
eH1_5                 2.421037e-02 1 1  ON 35
eH1_6                 7.670467e-02 1 1  ON 36
eH1_7                 1.107294e-01 1 1  ON 37
eH1_8                 9.201269e-02 1 1  ON 38
eH1_9                 2.427283e-02 1 1  ON 39
eH2_0                -1.961687e-01 1 1  ON 40
eH2_1                -9.716701e-02 1 1  ON 41
eH2_2                -5.030442e-02 1 1  ON 42
eH2_3                -2.015434e-02 1 1  ON 43
eH2_4                 1.553451e-02 1 1  ON 44
eH2_5                 2.428273e-02 1 1  ON 45
eH2_6                 7.651289e-02 1 1  ON 46
eH2_7                 1.129223e-01 1 1  ON 47
eH2_8                 9.606999e-02 1 1  ON 48
eH2_9                 2.646707e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5918e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s012 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s012 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=12  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.2217
    reference variance = 0.207346
====================================================
  Execution time = 2.2764e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s012
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7923e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5377e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278653071489
                                         uncertainty =       0.002619455245

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278653071489
                                         uncertainty =       0.002619455245

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373648203
  error estimate for blocks of size 2^( 2) =       0.000387194761
  error estimate for blocks of size 2^( 3) =       0.000399256388
  error estimate for blocks of size 2^( 4) =       0.000408191079
  error estimate for blocks of size 2^( 5) =       0.000412716025
  error estimate for blocks of size 2^( 6) =       0.000415330767
  error estimate for blocks of size 2^( 7) =       0.000416837386

      target function =      -0.945956936156
              le_mean =     -17.212169578460
             les_mean =     296.538007417704
             stat err =       0.000413268814
             autocorr =       1.223318296872
   target nu stat err =       0.000413268814
   target dn stat err =       0.002799168496
      target stat err =       0.004906733044
              std dev =       0.528418356651
             le_variance =       0.279225959646


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721216957846e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945981243046       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945981252958       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945981255241       residual = 7.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945981258162       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945981260607       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945981262429       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945981263235       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945981263990       residual = 7.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945981264345       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945981264844       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945981265364       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945981265528       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945981265815       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945981265985       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.945981265961       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945981266034       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.945981266161       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945981266230       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945981266224       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945981266178       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945981266197       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945981266165       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945981266207       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945981266222       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.945981266217       residual = 5.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 2.760590e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945981243046       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945981245524       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945981246095       residual = 7.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945981246825       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945981247434       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945981247905       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945981248104       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945981248294       residual = 7.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945981248410       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945981248467       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945981248638       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945981248673       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945981248763       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945981248818       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.945981248787       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945981248798       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.945981248827       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945981248826       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945981248829       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945981248853       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945981248831       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945981248734       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945981248834       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945981248839       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.945981248813       residual = 5.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 6.901530e-08

solving harmonic davidson linear method for identity shift 3.9062e+04, overlap shift 3.9062e+05 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945981243046       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945981243665       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945981243808       residual = 7.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945981243983       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945981244155       residual = 4.28e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945981244322       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945981244361       residual = 3.39e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945981244318       residual = 7.52e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945981244404       residual = 4.79e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945981244318       residual = 3.61e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945981244401       residual = 4.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945981244541       residual = 1.58e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945981244475       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945981244521       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.945981244392       residual = 3.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945981244411       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.945981244066       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945981244641       residual = 5.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945981244618       residual = 6.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945981244252       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945981244351       residual = 2.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945981244408       residual = 1.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945981244407       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945981244040       residual = 1.23e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.945981244548       residual = 5.16e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.9062e+04 is 1.725385e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.919112 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8333e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 1.977323e-01 1 1  ON 0
 uu_1                 4.330155e-02 1 1  ON 1
 uu_2                -4.189337e-02 1 1  ON 2
 uu_3                -9.235641e-02 1 1  ON 3
 uu_4                -1.237614e-01 1 1  ON 4
 uu_5                -1.319009e-01 1 1  ON 5
 uu_6                -1.107235e-01 1 1  ON 6
 uu_7                -4.250454e-02 1 1  ON 7
 uu_8                 8.649370e-02 1 1  ON 8
 uu_9                 1.220574e-01 1 1  ON 9
 ud_0                 3.027560e-01 1 1  ON 10
 ud_1                 7.594166e-02 1 1  ON 11
 ud_2                -1.844691e-02 1 1  ON 12
 ud_3                -6.887577e-02 1 1  ON 13
 ud_4                -1.085317e-01 1 1  ON 14
 ud_5                -1.357297e-01 1 1  ON 15
 ud_6                -1.369186e-01 1 1  ON 16
 ud_7                -9.606309e-02 1 1  ON 17
 ud_8                 1.394640e-03 1 1  ON 18
 ud_9                 9.066679e-02 1 1  ON 19
 eO_0                -6.845919e-01 1 1  ON 20
 eO_1                -4.098446e-01 1 1  ON 21
 eO_2                -4.964111e-02 1 1  ON 22
 eO_3                 1.714426e-01 1 1  ON 23
 eO_4                 2.548096e-01 1 1  ON 24
 eO_5                 2.930582e-01 1 1  ON 25
 eO_6                 2.514169e-01 1 1  ON 26
 eO_7                 1.164892e-01 1 1  ON 27
 eO_8                 2.796057e-02 1 1  ON 28
 eO_9                 1.837732e-02 1 1  ON 29
eH1_0                -1.951960e-01 1 1  ON 30
eH1_1                -9.632995e-02 1 1  ON 31
eH1_2                -4.928587e-02 1 1  ON 32
eH1_3                -1.898088e-02 1 1  ON 33
eH1_4                 1.663170e-02 1 1  ON 34
eH1_5                 2.421038e-02 1 1  ON 35
eH1_6                 7.670466e-02 1 1  ON 36
eH1_7                 1.107294e-01 1 1  ON 37
eH1_8                 9.201271e-02 1 1  ON 38
eH1_9                 2.427284e-02 1 1  ON 39
eH2_0                -1.961687e-01 1 1  ON 40
eH2_1                -9.716700e-02 1 1  ON 41
eH2_2                -5.030440e-02 1 1  ON 42
eH2_3                -2.015432e-02 1 1  ON 43
eH2_4                 1.553449e-02 1 1  ON 44
eH2_5                 2.428272e-02 1 1  ON 45
eH2_6                 7.651287e-02 1 1  ON 46
eH2_7                 1.129223e-01 1 1  ON 47
eH2_8                 9.607001e-02 1 1  ON 48
eH2_9                 2.646707e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 12
    time step          = 0.05
    reference energy   = -17.1413
    reference variance = 0.212231
====================================================
  Execution time = 2.0011e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s012
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7599e-01
  Total weights = 2.0000e+06
  Execution time = 1.8135e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276017967550
                                         uncertainty =       0.001985430534

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276017967550
                                         uncertainty =       0.001985430534

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371474014
  error estimate for blocks of size 2^( 2) =       0.000384758780
  error estimate for blocks of size 2^( 3) =       0.000396864654
  error estimate for blocks of size 2^( 4) =       0.000405657286
  error estimate for blocks of size 2^( 5) =       0.000410047491
  error estimate for blocks of size 2^( 6) =       0.000412750059
  error estimate for blocks of size 2^( 7) =       0.000412872080

      target function =      -0.951624976971
              le_mean =     -17.211825348124
             les_mean =     296.522917561983
             stat err =       0.000410331729
             autocorr =       1.220150278893
   target nu stat err =       0.000410331729
   target dn stat err =       0.001955085547
      target stat err =       0.003506795924
              std dev =       0.525343588180
             le_variance =       0.275985885642

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276017967444
                                         uncertainty =       0.001985430311

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276017967444
                                         uncertainty =       0.001985430311

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371474014
  error estimate for blocks of size 2^( 2) =       0.000384758782
  error estimate for blocks of size 2^( 3) =       0.000396864661
  error estimate for blocks of size 2^( 4) =       0.000405657297
  error estimate for blocks of size 2^( 5) =       0.000410047504
  error estimate for blocks of size 2^( 6) =       0.000412750073
  error estimate for blocks of size 2^( 7) =       0.000412872091

      target function =      -0.951624977267
              le_mean =     -17.211825349075
             les_mean =     296.522917594529
             stat err =       0.000410331741
             autocorr =       1.220150353308
   target nu stat err =       0.000410331741
   target dn stat err =       0.001955085304
      target stat err =       0.003506795521
              std dev =       0.525343588005
             le_variance =       0.275985885458

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276017967497
                                         uncertainty =       0.001985430422

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276017967497
                                         uncertainty =       0.001985430422

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371474014
  error estimate for blocks of size 2^( 2) =       0.000384758781
  error estimate for blocks of size 2^( 3) =       0.000396864658
  error estimate for blocks of size 2^( 4) =       0.000405657291
  error estimate for blocks of size 2^( 5) =       0.000410047497
  error estimate for blocks of size 2^( 6) =       0.000412750066
  error estimate for blocks of size 2^( 7) =       0.000412872086

      target function =      -0.951624977119
              le_mean =     -17.211825348600
             les_mean =     296.522917578256
             stat err =       0.000410331735
             autocorr =       1.220150316099
   target nu stat err =       0.000410331735
   target dn stat err =       0.001955085426
      target stat err =       0.003506795723
              std dev =       0.525343588093
             le_variance =       0.275985885550

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276017967543
                                         uncertainty =       0.001985430520

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276017967543
                                         uncertainty =       0.001985430520

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371474014
  error estimate for blocks of size 2^( 2) =       0.000384758781
  error estimate for blocks of size 2^( 3) =       0.000396864655
  error estimate for blocks of size 2^( 4) =       0.000405657287
  error estimate for blocks of size 2^( 5) =       0.000410047492
  error estimate for blocks of size 2^( 6) =       0.000412750059
  error estimate for blocks of size 2^( 7) =       0.000412872080

      target function =      -0.951624976989
              le_mean =     -17.211825348184
             les_mean =     296.522917564017
             stat err =       0.000410331730
             autocorr =       1.220150283540
   target nu stat err =       0.000410331730
   target dn stat err =       0.001955085532
      target stat err =       0.003506795899
              std dev =       0.525343588169
             le_variance =       0.275985885630


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.951624976971        initial
     2.4414e+03     2.4414e+04             2.7606e-07        -0.951624977267  <--
     9.7656e+03     9.7656e+04             6.9015e-08        -0.951624977119
     3.9062e+04     3.9062e+05             1.7254e-08        -0.951624976989

*****************************************************************************
Applying the update for shift_i =   2.4414e+03     and shift_s =   2.4414e+04
*****************************************************************************

  Execution time = 2.9464e+01
  </log>
  <optVariables href="H2O.s012.opt.xml">
 uu_0                 1.977324e-01 1 1  ON 0
 uu_1                 4.330162e-02 1 1  ON 1
 uu_2                -4.189331e-02 1 1  ON 2
 uu_3                -9.235639e-02 1 1  ON 3
 uu_4                -1.237614e-01 1 1  ON 4
 uu_5                -1.319010e-01 1 1  ON 5
 uu_6                -1.107235e-01 1 1  ON 6
 uu_7                -4.250466e-02 1 1  ON 7
 uu_8                 8.649364e-02 1 1  ON 8
 uu_9                 1.220574e-01 1 1  ON 9
 ud_0                 3.027559e-01 1 1  ON 10
 ud_1                 7.594160e-02 1 1  ON 11
 ud_2                -1.844702e-02 1 1  ON 12
 ud_3                -6.887587e-02 1 1  ON 13
 ud_4                -1.085317e-01 1 1  ON 14
 ud_5                -1.357296e-01 1 1  ON 15
 ud_6                -1.369184e-01 1 1  ON 16
 ud_7                -9.606288e-02 1 1  ON 17
 ud_8                 1.394531e-03 1 1  ON 18
 ud_9                 9.066676e-02 1 1  ON 19
 eO_0                -6.845920e-01 1 1  ON 20
 eO_1                -4.098447e-01 1 1  ON 21
 eO_2                -4.964105e-02 1 1  ON 22
 eO_3                 1.714426e-01 1 1  ON 23
 eO_4                 2.548095e-01 1 1  ON 24
 eO_5                 2.930580e-01 1 1  ON 25
 eO_6                 2.514169e-01 1 1  ON 26
 eO_7                 1.164893e-01 1 1  ON 27
 eO_8                 2.796058e-02 1 1  ON 28
 eO_9                 1.837732e-02 1 1  ON 29
eH1_0                -1.951962e-01 1 1  ON 30
eH1_1                -9.632995e-02 1 1  ON 31
eH1_2                -4.928583e-02 1 1  ON 32
eH1_3                -1.898080e-02 1 1  ON 33
eH1_4                 1.663173e-02 1 1  ON 34
eH1_5                 2.421042e-02 1 1  ON 35
eH1_6                 7.670461e-02 1 1  ON 36
eH1_7                 1.107294e-01 1 1  ON 37
eH1_8                 9.201276e-02 1 1  ON 38
eH1_9                 2.427285e-02 1 1  ON 39
eH2_0                -1.961688e-01 1 1  ON 40
eH2_1                -9.716697e-02 1 1  ON 41
eH2_2                -5.030435e-02 1 1  ON 42
eH2_3                -2.015428e-02 1 1  ON 43
eH2_4                 1.553443e-02 1 1  ON 44
eH2_5                 2.428266e-02 1 1  ON 45
eH2_6                 7.651282e-02 1 1  ON 46
eH2_7                 1.129224e-01 1 1  ON 47
eH2_8                 9.607008e-02 1 1  ON 48
eH2_9                 2.646708e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7803e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s013 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s013 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=13  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7197e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.2508
    reference variance = 0.459156
====================================================
  Execution time = 2.0507e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s013
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8171e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6372e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281611809382
                                         uncertainty =       0.003166739643

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281611809382
                                         uncertainty =       0.003166739643

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375305638
  error estimate for blocks of size 2^( 2) =       0.000389183119
  error estimate for blocks of size 2^( 3) =       0.000401441183
  error estimate for blocks of size 2^( 4) =       0.000411065402
  error estimate for blocks of size 2^( 5) =       0.000416892818
  error estimate for blocks of size 2^( 6) =       0.000418460394
  error estimate for blocks of size 2^( 7) =       0.000421493949

      target function =      -0.941655127100
              le_mean =     -17.212552925398
             les_mean =     296.553686712047
             stat err =       0.000416978141
             autocorr =       1.234401385955
   target nu stat err =       0.000416978141
   target dn stat err =       0.002946748103
      target stat err =       0.005117922214
              std dev =       0.530762322769
             le_variance =       0.281708643271


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721255292540e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941681628932       residual = 1.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941681689410       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941681705555       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941681718523       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941681728726       residual = 5.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941681736367       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941681743731       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941681746052       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941681748413       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941681749678       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941681750828       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941681751798       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941681752647       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941681752849       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941681753484       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941681753819       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941681754208       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941681754434       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941681754523       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941681754442       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941681754539       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941681754548       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941681754659       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941681754654       residual = 9.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 1.122887e-06

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941681628932       residual = 1.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941681644053       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941681648090       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941681651332       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941681653882       residual = 5.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941681655798       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941681657633       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941681658218       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941681658807       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941681659118       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941681659413       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941681659655       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941681659865       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941681659915       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941681660077       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941681660158       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941681660258       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941681660312       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941681660336       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941681660310       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941681660329       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941681660337       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941681660361       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941681660367       residual = 9.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 2.807373e-07

solving harmonic davidson linear method for identity shift 9.7656e+03, overlap shift 9.7656e+04 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941681628932       residual = 1.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941681632713       residual = 1.54e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941681633722       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941681634531       residual = 1.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941681635165       residual = 5.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941681635642       residual = 4.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941681636127       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941681636253       residual = 1.99e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941681636413       residual = 6.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941681636439       residual = 3.59e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941681636549       residual = 2.93e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941681636614       residual = 2.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941681636675       residual = 1.23e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941681636670       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941681636724       residual = 5.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941681636739       residual = 3.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941681636775       residual = 3.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941681636767       residual = 7.87e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941681636771       residual = 2.43e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941681636795       residual = 4.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941681636786       residual = 2.47e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941681636811       residual = 2.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941681636816       residual = 4.39e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941681636768       residual = 9.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.7656e+03 is 7.018529e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.937197 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6173e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 1.977325e-01 1 1  ON 0
 uu_1                 4.330175e-02 1 1  ON 1
 uu_2                -4.189322e-02 1 1  ON 2
 uu_3                -9.235633e-02 1 1  ON 3
 uu_4                -1.237614e-01 1 1  ON 4
 uu_5                -1.319010e-01 1 1  ON 5
 uu_6                -1.107236e-01 1 1  ON 6
 uu_7                -4.250484e-02 1 1  ON 7
 uu_8                 8.649343e-02 1 1  ON 8
 uu_9                 1.220575e-01 1 1  ON 9
 ud_0                 3.027557e-01 1 1  ON 10
 ud_1                 7.594150e-02 1 1  ON 11
 ud_2                -1.844720e-02 1 1  ON 12
 ud_3                -6.887604e-02 1 1  ON 13
 ud_4                -1.085317e-01 1 1  ON 14
 ud_5                -1.357294e-01 1 1  ON 15
 ud_6                -1.369182e-01 1 1  ON 16
 ud_7                -9.606265e-02 1 1  ON 17
 ud_8                 1.394493e-03 1 1  ON 18
 ud_9                 9.066673e-02 1 1  ON 19
 eO_0                -6.845920e-01 1 1  ON 20
 eO_1                -4.098447e-01 1 1  ON 21
 eO_2                -4.964099e-02 1 1  ON 22
 eO_3                 1.714426e-01 1 1  ON 23
 eO_4                 2.548094e-01 1 1  ON 24
 eO_5                 2.930579e-01 1 1  ON 25
 eO_6                 2.514170e-01 1 1  ON 26
 eO_7                 1.164894e-01 1 1  ON 27
 eO_8                 2.796059e-02 1 1  ON 28
 eO_9                 1.837732e-02 1 1  ON 29
eH1_0                -1.951964e-01 1 1  ON 30
eH1_1                -9.632988e-02 1 1  ON 31
eH1_2                -4.928569e-02 1 1  ON 32
eH1_3                -1.898074e-02 1 1  ON 33
eH1_4                 1.663169e-02 1 1  ON 34
eH1_5                 2.421036e-02 1 1  ON 35
eH1_6                 7.670459e-02 1 1  ON 36
eH1_7                 1.107293e-01 1 1  ON 37
eH1_8                 9.201282e-02 1 1  ON 38
eH1_9                 2.427286e-02 1 1  ON 39
eH2_0                -1.961689e-01 1 1  ON 40
eH2_1                -9.716695e-02 1 1  ON 41
eH2_2                -5.030421e-02 1 1  ON 42
eH2_3                -2.015413e-02 1 1  ON 43
eH2_4                 1.553444e-02 1 1  ON 44
eH2_5                 2.428250e-02 1 1  ON 45
eH2_6                 7.651276e-02 1 1  ON 46
eH2_7                 1.129224e-01 1 1  ON 47
eH2_8                 9.607011e-02 1 1  ON 48
eH2_9                 2.646710e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 13
    time step          = 0.05
    reference energy   = -17.1645
    reference variance = 0.207407
====================================================
  Execution time = 2.0151e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s013
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8249e-01
  Total weights = 2.0000e+06
  Execution time = 1.8183e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282384953006
                                         uncertainty =       0.003541293500

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282384953006
                                         uncertainty =       0.003541293500

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375824389
  error estimate for blocks of size 2^( 2) =       0.000389350647
  error estimate for blocks of size 2^( 3) =       0.000401985963
  error estimate for blocks of size 2^( 4) =       0.000410586662
  error estimate for blocks of size 2^( 5) =       0.000416467406
  error estimate for blocks of size 2^( 6) =       0.000418740596
  error estimate for blocks of size 2^( 7) =       0.000419418762

      target function =      -0.940313076816
              le_mean =     -17.212403048012
             les_mean =     296.549306488634
             stat err =       0.000416303357
             autocorr =       1.227015094416
   target nu stat err =       0.000416303357
   target dn stat err =       0.003615282643
      target stat err =       0.006236163706
              std dev =       0.531495947924
             le_variance =       0.282487942660

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282384952427
                                         uncertainty =       0.003541291225

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282384952427
                                         uncertainty =       0.003541291225

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375824388
  error estimate for blocks of size 2^( 2) =       0.000389350661
  error estimate for blocks of size 2^( 3) =       0.000401986004
  error estimate for blocks of size 2^( 4) =       0.000410586735
  error estimate for blocks of size 2^( 5) =       0.000416467505
  error estimate for blocks of size 2^( 6) =       0.000418740696
  error estimate for blocks of size 2^( 7) =       0.000419418865

      target function =      -0.940313078014
              le_mean =     -17.212403050740
             les_mean =     296.549306581803
             stat err =       0.000416303450
             autocorr =       1.227015647588
   target nu stat err =       0.000416303450
   target dn stat err =       0.003615279977
      target stat err =       0.006236159243
              std dev =       0.531495947219
             le_variance =       0.282487941911

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282384952714
                                         uncertainty =       0.003541292363

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282384952714
                                         uncertainty =       0.003541292363

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375824389
  error estimate for blocks of size 2^( 2) =       0.000389350654
  error estimate for blocks of size 2^( 3) =       0.000401985983
  error estimate for blocks of size 2^( 4) =       0.000410586698
  error estimate for blocks of size 2^( 5) =       0.000416467456
  error estimate for blocks of size 2^( 6) =       0.000418740646
  error estimate for blocks of size 2^( 7) =       0.000419418814

      target function =      -0.940313077419
              le_mean =     -17.212403049376
             les_mean =     296.549306535203
             stat err =       0.000416303403
             autocorr =       1.227015371011
   target nu stat err =       0.000416303403
   target dn stat err =       0.003615281310
      target stat err =       0.006236161474
              std dev =       0.531495947569
             le_variance =       0.282487942283

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282384952969
                                         uncertainty =       0.003541293358

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282384952969
                                         uncertainty =       0.003541293358

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375824389
  error estimate for blocks of size 2^( 2) =       0.000389350648
  error estimate for blocks of size 2^( 3) =       0.000401985966
  error estimate for blocks of size 2^( 4) =       0.000410586666
  error estimate for blocks of size 2^( 5) =       0.000416467412
  error estimate for blocks of size 2^( 6) =       0.000418740603
  error estimate for blocks of size 2^( 7) =       0.000419418769

      target function =      -0.940313076892
              le_mean =     -17.212403048183
             les_mean =     296.549306494453
             stat err =       0.000416303363
             autocorr =       1.227015128999
   target nu stat err =       0.000416303363
   target dn stat err =       0.003615282477
      target stat err =       0.006236163427
              std dev =       0.531495947879
             le_variance =       0.282487942612


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940313076816        initial
     6.1035e+02     6.1035e+03             1.1229e-06        -0.940313078014  <--
     2.4414e+03     2.4414e+04             2.8074e-07        -0.940313077419
     9.7656e+03     9.7656e+04             7.0185e-08        -0.940313076892

*****************************************************************************
Applying the update for shift_i =   6.1035e+02     and shift_s =   6.1035e+03
*****************************************************************************

  Execution time = 2.9372e+01
  </log>
  <optVariables href="H2O.s013.opt.xml">
 uu_0                 1.977329e-01 1 1  ON 0
 uu_1                 4.330211e-02 1 1  ON 1
 uu_2                -4.189292e-02 1 1  ON 2
 uu_3                -9.235616e-02 1 1  ON 3
 uu_4                -1.237613e-01 1 1  ON 4
 uu_5                -1.319012e-01 1 1  ON 5
 uu_6                -1.107239e-01 1 1  ON 6
 uu_7                -4.250537e-02 1 1  ON 7
 uu_8                 8.649278e-02 1 1  ON 8
 uu_9                 1.220577e-01 1 1  ON 9
 ud_0                 3.027552e-01 1 1  ON 10
 ud_1                 7.594122e-02 1 1  ON 11
 ud_2                -1.844772e-02 1 1  ON 12
 ud_3                -6.887654e-02 1 1  ON 13
 ud_4                -1.085318e-01 1 1  ON 14
 ud_5                -1.357290e-01 1 1  ON 15
 ud_6                -1.369173e-01 1 1  ON 16
 ud_7                -9.606195e-02 1 1  ON 17
 ud_8                 1.394379e-03 1 1  ON 18
 ud_9                 9.066663e-02 1 1  ON 19
 eO_0                -6.845922e-01 1 1  ON 20
 eO_1                -4.098448e-01 1 1  ON 21
 eO_2                -4.964078e-02 1 1  ON 22
 eO_3                 1.714427e-01 1 1  ON 23
 eO_4                 2.548092e-01 1 1  ON 24
 eO_5                 2.930574e-01 1 1  ON 25
 eO_6                 2.514173e-01 1 1  ON 26
 eO_7                 1.164897e-01 1 1  ON 27
 eO_8                 2.796061e-02 1 1  ON 28
 eO_9                 1.837733e-02 1 1  ON 29
eH1_0                -1.951970e-01 1 1  ON 30
eH1_1                -9.632969e-02 1 1  ON 31
eH1_2                -4.928526e-02 1 1  ON 32
eH1_3                -1.898056e-02 1 1  ON 33
eH1_4                 1.663158e-02 1 1  ON 34
eH1_5                 2.421018e-02 1 1  ON 35
eH1_6                 7.670452e-02 1 1  ON 36
eH1_7                 1.107293e-01 1 1  ON 37
eH1_8                 9.201298e-02 1 1  ON 38
eH1_9                 2.427289e-02 1 1  ON 39
eH2_0                -1.961692e-01 1 1  ON 40
eH2_1                -9.716687e-02 1 1  ON 41
eH2_2                -5.030379e-02 1 1  ON 42
eH2_3                -2.015367e-02 1 1  ON 43
eH2_4                 1.553448e-02 1 1  ON 44
eH2_5                 2.428199e-02 1 1  ON 45
eH2_6                 7.651257e-02 1 1  ON 46
eH2_7                 1.129223e-01 1 1  ON 47
eH2_8                 9.607021e-02 1 1  ON 48
eH2_9                 2.646714e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5551e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s014 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s014 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=14  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1982
    reference variance = 0.20096
====================================================
  Execution time = 2.0445e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s014
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7761e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 6.3448e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277666271664
                                         uncertainty =       0.001927834759

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277666271664
                                         uncertainty =       0.001927834759

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372562387
  error estimate for blocks of size 2^( 2) =       0.000386264464
  error estimate for blocks of size 2^( 3) =       0.000399174334
  error estimate for blocks of size 2^( 4) =       0.000407845439
  error estimate for blocks of size 2^( 5) =       0.000413321991
  error estimate for blocks of size 2^( 6) =       0.000415996809
  error estimate for blocks of size 2^( 7) =       0.000417353685

      target function =      -0.948790701299
              le_mean =     -17.212000219543
             les_mean =     296.530556883630
             stat err =       0.000413629481
             autocorr =       1.232607922891
   target nu stat err =       0.000413629481
   target dn stat err =       0.001938206503
      target stat err =       0.003460224508
              std dev =       0.526882780981
             le_variance =       0.277605464894


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721200021954e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948802328198       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948802502099       residual = 9.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948802542714       residual = 6.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948802573694       residual = 7.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948802606362       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948802621978       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948802632020       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948802643160       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948802655900       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948802657923       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948802660212       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.948802661351       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.948802660373       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.948802660052       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.948802662355       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.948802663830       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.948802663877       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.948802665725       residual = 4.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.948802666250       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.948802665956       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.948802666034       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948802666063       residual = 4.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.948802666223       residual = 2.98e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.948802666252       residual = 6.40e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 3.269007e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948802328198       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948802371690       residual = 9.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948802381849       residual = 6.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948802389598       residual = 7.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948802397766       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948802401671       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948802404183       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948802406969       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948802410152       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948802410659       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948802411232       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.948802411516       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.948802411272       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.948802411192       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.948802411768       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.948802412136       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.948802412147       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.948802412611       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.948802412740       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.948802412668       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.948802412686       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948802412694       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.948802412734       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.948802412742       residual = 6.39e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 8.174312e-07

solving harmonic davidson linear method for identity shift 2.4414e+03, overlap shift 2.4414e+04 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948802328198       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948802339072       residual = 9.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948802341612       residual = 6.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948802343550       residual = 7.94e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948802345591       residual = 2.72e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948802346571       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948802347193       residual = 3.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948802347888       residual = 6.17e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948802348688       residual = 2.35e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948802348815       residual = 1.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948802348962       residual = 1.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.948802349026       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.948802348974       residual = 6.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.948802348950       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.948802349087       residual = 3.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.948802349191       residual = 1.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.948802349179       residual = 2.87e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.948802349304       residual = 4.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.948802349331       residual = 3.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.948802349316       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.948802349321       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948802349327       residual = 4.64e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.948802349323       residual = 2.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.948802349336       residual = 6.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.4414e+03 is 2.043690e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.955424 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8056e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.977331e-01 1 1  ON 0
 uu_1                 4.330227e-02 1 1  ON 1
 uu_2                -4.189286e-02 1 1  ON 2
 uu_3                -9.235614e-02 1 1  ON 3
 uu_4                -1.237612e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107241e-01 1 1  ON 6
 uu_7                -4.250562e-02 1 1  ON 7
 uu_8                 8.649227e-02 1 1  ON 8
 uu_9                 1.220579e-01 1 1  ON 9
 ud_0                 3.027548e-01 1 1  ON 10
 ud_1                 7.594115e-02 1 1  ON 11
 ud_2                -1.844816e-02 1 1  ON 12
 ud_3                -6.887704e-02 1 1  ON 13
 ud_4                -1.085319e-01 1 1  ON 14
 ud_5                -1.357285e-01 1 1  ON 15
 ud_6                -1.369165e-01 1 1  ON 16
 ud_7                -9.606176e-02 1 1  ON 17
 ud_8                 1.394093e-03 1 1  ON 18
 ud_9                 9.066672e-02 1 1  ON 19
 eO_0                -6.845923e-01 1 1  ON 20
 eO_1                -4.098449e-01 1 1  ON 21
 eO_2                -4.964033e-02 1 1  ON 22
 eO_3                 1.714428e-01 1 1  ON 23
 eO_4                 2.548088e-01 1 1  ON 24
 eO_5                 2.930567e-01 1 1  ON 25
 eO_6                 2.514174e-01 1 1  ON 26
 eO_7                 1.164903e-01 1 1  ON 27
 eO_8                 2.796065e-02 1 1  ON 28
 eO_9                 1.837735e-02 1 1  ON 29
eH1_0                -1.951974e-01 1 1  ON 30
eH1_1                -9.632940e-02 1 1  ON 31
eH1_2                -4.928478e-02 1 1  ON 32
eH1_3                -1.898022e-02 1 1  ON 33
eH1_4                 1.663158e-02 1 1  ON 34
eH1_5                 2.420978e-02 1 1  ON 35
eH1_6                 7.670406e-02 1 1  ON 36
eH1_7                 1.107291e-01 1 1  ON 37
eH1_8                 9.201317e-02 1 1  ON 38
eH1_9                 2.427292e-02 1 1  ON 39
eH2_0                -1.961699e-01 1 1  ON 40
eH2_1                -9.716682e-02 1 1  ON 41
eH2_2                -5.030348e-02 1 1  ON 42
eH2_3                -2.015346e-02 1 1  ON 43
eH2_4                 1.553460e-02 1 1  ON 44
eH2_5                 2.428199e-02 1 1  ON 45
eH2_6                 7.651232e-02 1 1  ON 46
eH2_7                 1.129221e-01 1 1  ON 47
eH2_8                 9.607044e-02 1 1  ON 48
eH2_9                 2.646730e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 14
    time step          = 0.05
    reference energy   = -17.1656
    reference variance = 0.333592
====================================================
  Execution time = 2.0055e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s014
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8185e-01
  Total weights = 2.0000e+06
  Execution time = 1.8208e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281903453810
                                         uncertainty =       0.003325135177

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281903453810
                                         uncertainty =       0.003325135177

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375402349
  error estimate for blocks of size 2^( 2) =       0.000388968876
  error estimate for blocks of size 2^( 3) =       0.000401024344
  error estimate for blocks of size 2^( 4) =       0.000410121092
  error estimate for blocks of size 2^( 5) =       0.000414333384
  error estimate for blocks of size 2^( 6) =       0.000417078598
  error estimate for blocks of size 2^( 7) =       0.000416307303

      target function =      -0.941415824473
              le_mean =     -17.212174443217
             les_mean =     296.540802770025
             stat err =       0.000414460094
             autocorr =       1.218909524829
   target nu stat err =       0.000414460094
   target dn stat err =       0.003386432687
      target stat err =       0.005857989693
              std dev =       0.530899093266
             le_variance =       0.281853847231

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281903401714
                                         uncertainty =       0.003325132303

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281903401714
                                         uncertainty =       0.003325132303

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375402314
  error estimate for blocks of size 2^( 2) =       0.000388968836
  error estimate for blocks of size 2^( 3) =       0.000401024330
  error estimate for blocks of size 2^( 4) =       0.000410121119
  error estimate for blocks of size 2^( 5) =       0.000414333432
  error estimate for blocks of size 2^( 6) =       0.000417078623
  error estimate for blocks of size 2^( 7) =       0.000416307352

      target function =      -0.941415913337
              le_mean =     -17.212174448962
             les_mean =     296.540802915872
             stat err =       0.000414460131
             autocorr =       1.218909969306
   target nu stat err =       0.000414460131
   target dn stat err =       0.003386429182
      target stat err =       0.005857984900
              std dev =       0.530899044356
             le_variance =       0.281853795298

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281903427730
                                         uncertainty =       0.003325133739

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281903427730
                                         uncertainty =       0.003325133739

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375402332
  error estimate for blocks of size 2^( 2) =       0.000388968856
  error estimate for blocks of size 2^( 3) =       0.000401024337
  error estimate for blocks of size 2^( 4) =       0.000410121105
  error estimate for blocks of size 2^( 5) =       0.000414333408
  error estimate for blocks of size 2^( 6) =       0.000417078610
  error estimate for blocks of size 2^( 7) =       0.000416307327

      target function =      -0.941415868961
              le_mean =     -17.212174446085
             les_mean =     296.540802842781
             stat err =       0.000414460113
             autocorr =       1.218909747050
   target nu stat err =       0.000414460113
   target dn stat err =       0.003386430933
      target stat err =       0.005857987295
              std dev =       0.530899068781
             le_variance =       0.281853821232

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281903450547
                                         uncertainty =       0.003325134997

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281903450547
                                         uncertainty =       0.003325134997

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375402347
  error estimate for blocks of size 2^( 2) =       0.000388968873
  error estimate for blocks of size 2^( 3) =       0.000401024343
  error estimate for blocks of size 2^( 4) =       0.000410121094
  error estimate for blocks of size 2^( 5) =       0.000414333387
  error estimate for blocks of size 2^( 6) =       0.000417078599
  error estimate for blocks of size 2^( 7) =       0.000416307306

      target function =      -0.941415830039
              le_mean =     -17.212174443575
             les_mean =     296.540802779101
             stat err =       0.000414460096
             autocorr =       1.218909552601
   target nu stat err =       0.000414460096
   target dn stat err =       0.003386432468
      target stat err =       0.005857989393
              std dev =       0.530899090203
             le_variance =       0.281853843978


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.941415824473        initial
     1.5259e+02     1.5259e+03             3.2690e-06        -0.941415913337  <--
     6.1035e+02     6.1035e+03             8.1743e-07        -0.941415868961
     2.4414e+03     2.4414e+04             2.0437e-07        -0.941415830039

*****************************************************************************
Applying the update for shift_i =   1.5259e+02     and shift_s =   1.5259e+03
*****************************************************************************

  Execution time = 2.9256e+01
  </log>
  <optVariables href="H2O.s014.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250636e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844948e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393233e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7318e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s015 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s015 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=15  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7197e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.1124
    reference variance = 0.284813
====================================================
  Execution time = 2.0309e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s015
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7900e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6393e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279058268705
                                         uncertainty =       0.001990195299

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279058268705
                                         uncertainty =       0.001990195299

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373499773
  error estimate for blocks of size 2^( 2) =       0.000387575923
  error estimate for blocks of size 2^( 3) =       0.000399093594
  error estimate for blocks of size 2^( 4) =       0.000407892230
  error estimate for blocks of size 2^( 5) =       0.000413328594
  error estimate for blocks of size 2^( 6) =       0.000416319114
  error estimate for blocks of size 2^( 7) =       0.000417815239

      target function =      -0.946347417804
              le_mean =     -17.212242150759
             les_mean =     296.540283877430
             stat err =       0.000413838794
             autocorr =       1.227670206313
   target nu stat err =       0.000413838794
   target dn stat err =       0.002228745479
      target stat err =       0.003937457492
              std dev =       0.528208444236
             le_variance =       0.279004160562


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721224215076e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+01, overlap shift 3.8147e+02 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946362611647       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946363447805       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946363647397       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946363781801       residual = 8.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946363912204       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946364003413       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946364060488       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946364126446       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946364149875       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946364171588       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946364174357       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946364182343       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946364201489       residual = 8.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946364215908       residual = 5.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946364220302       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946364223753       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946364222671       residual = 2.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946364226591       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946364227650       residual = 4.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946364226988       residual = 1.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946364227580       residual = 2.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946364228590       residual = 8.93e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946364229376       residual = 2.38e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946364229089       residual = 7.69e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+01 is 1.446834e-05

solving harmonic davidson linear method for identity shift 1.5259e+02, overlap shift 1.5259e+03 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946362611647       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946362821009       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946362871010       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946362904642       residual = 8.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946362937275       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946362960109       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946362974395       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946362990902       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946362996767       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946363002199       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946363002893       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946363004889       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946363009679       residual = 8.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946363013283       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946363014379       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946363015243       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946363014972       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946363015950       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946363016214       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946363016049       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946363016197       residual = 2.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946363016449       residual = 8.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946363016644       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946363016573       residual = 7.65e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+02 is 3.617693e-06

solving harmonic davidson linear method for identity shift 6.1035e+02, overlap shift 6.1035e+03 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946362611647       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946362664008       residual = 1.06e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946362676514       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946362684925       residual = 8.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946362693084       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946362698796       residual = 2.81e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946362702367       residual = 3.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946362706495       residual = 1.01e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946362707962       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946362709321       residual = 2.12e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946362709494       residual = 2.62e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946362709994       residual = 1.63e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946362711190       residual = 8.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946362712092       residual = 5.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946362712363       residual = 3.28e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946362712582       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946362712515       residual = 2.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946362712758       residual = 2.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946362712824       residual = 4.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946362712784       residual = 1.58e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946362712819       residual = 2.89e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946362712880       residual = 8.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946362712933       residual = 2.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946362712914       residual = 7.64e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+02 is 9.044612e-07

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.973557 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5978e+01
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.977357e-01 1 1  ON 0
 uu_1                 4.330508e-02 1 1  ON 1
 uu_2                -4.189136e-02 1 1  ON 2
 uu_3                -9.235555e-02 1 1  ON 3
 uu_4                -1.237606e-01 1 1  ON 4
 uu_5                -1.319015e-01 1 1  ON 5
 uu_6                -1.107263e-01 1 1  ON 6
 uu_7                -4.250845e-02 1 1  ON 7
 uu_8                 8.648713e-02 1 1  ON 8
 uu_9                 1.220589e-01 1 1  ON 9
 ud_0                 3.027524e-01 1 1  ON 10
 ud_1                 7.594061e-02 1 1  ON 11
 ud_2                -1.845132e-02 1 1  ON 12
 ud_3                -6.888058e-02 1 1  ON 13
 ud_4                -1.085328e-01 1 1  ON 14
 ud_5                -1.357250e-01 1 1  ON 15
 ud_6                -1.369111e-01 1 1  ON 16
 ud_7                -9.605863e-02 1 1  ON 17
 ud_8                 1.391533e-03 1 1  ON 18
 ud_9                 9.066666e-02 1 1  ON 19
 eO_0                -6.845947e-01 1 1  ON 20
 eO_1                -4.098468e-01 1 1  ON 21
 eO_2                -4.963795e-02 1 1  ON 22
 eO_3                 1.714445e-01 1 1  ON 23
 eO_4                 2.548076e-01 1 1  ON 24
 eO_5                 2.930531e-01 1 1  ON 25
 eO_6                 2.514190e-01 1 1  ON 26
 eO_7                 1.164934e-01 1 1  ON 27
 eO_8                 2.796083e-02 1 1  ON 28
 eO_9                 1.837748e-02 1 1  ON 29
eH1_0                -1.952015e-01 1 1  ON 30
eH1_1                -9.632883e-02 1 1  ON 31
eH1_2                -4.928234e-02 1 1  ON 32
eH1_3                -1.897800e-02 1 1  ON 33
eH1_4                 1.663192e-02 1 1  ON 34
eH1_5                 2.420832e-02 1 1  ON 35
eH1_6                 7.670246e-02 1 1  ON 36
eH1_7                 1.107290e-01 1 1  ON 37
eH1_8                 9.201462e-02 1 1  ON 38
eH1_9                 2.427321e-02 1 1  ON 39
eH2_0                -1.961745e-01 1 1  ON 40
eH2_1                -9.716711e-02 1 1  ON 41
eH2_2                -5.030138e-02 1 1  ON 42
eH2_3                -2.015177e-02 1 1  ON 43
eH2_4                 1.553480e-02 1 1  ON 44
eH2_5                 2.428097e-02 1 1  ON 45
eH2_6                 7.651269e-02 1 1  ON 46
eH2_7                 1.129215e-01 1 1  ON 47
eH2_8                 9.607190e-02 1 1  ON 48
eH2_9                 2.646794e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 15
    time step          = 0.05
    reference energy   = -17.2529
    reference variance = 0.238962
====================================================
  Execution time = 1.9792e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s015
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8012e-01
  Total weights = 2.0000e+06
  Execution time = 1.8166e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280150564889
                                         uncertainty =       0.002935358857

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280150564889
                                         uncertainty =       0.002935358857

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374249120
  error estimate for blocks of size 2^( 2) =       0.000387956901
  error estimate for blocks of size 2^( 3) =       0.000400889085
  error estimate for blocks of size 2^( 4) =       0.000410048408
  error estimate for blocks of size 2^( 5) =       0.000414847738
  error estimate for blocks of size 2^( 6) =       0.000417825239
  error estimate for blocks of size 2^( 7) =       0.000419286730

      target function =      -0.944392097522
              le_mean =     -17.212427462663
             les_mean =     296.547783824944
             stat err =       0.000415502029
             autocorr =       1.232607260391
   target nu stat err =       0.000415502029
   target dn stat err =       0.002757546902
      target stat err =       0.004822776295
              std dev =       0.529268181140
             le_variance =       0.280124807567

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280151104029
                                         uncertainty =       0.002935377011

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280151104029
                                         uncertainty =       0.002935377011

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374249479
  error estimate for blocks of size 2^( 2) =       0.000387957227
  error estimate for blocks of size 2^( 3) =       0.000400889508
  error estimate for blocks of size 2^( 4) =       0.000410048981
  error estimate for blocks of size 2^( 5) =       0.000414848508
  error estimate for blocks of size 2^( 6) =       0.000417826014
  error estimate for blocks of size 2^( 7) =       0.000419287753

      target function =      -0.944391170362
              le_mean =     -17.212427419530
             les_mean =     296.547782878016
             stat err =       0.000415502814
             autocorr =       1.232609553037
   target nu stat err =       0.000415502814
   target dn stat err =       0.002757552231
      target stat err =       0.004822775855
              std dev =       0.529268689314
             le_variance =       0.280125345489

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280150834259
                                         uncertainty =       0.002935367942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280150834259
                                         uncertainty =       0.002935367942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374249299
  error estimate for blocks of size 2^( 2) =       0.000387957064
  error estimate for blocks of size 2^( 3) =       0.000400889296
  error estimate for blocks of size 2^( 4) =       0.000410048694
  error estimate for blocks of size 2^( 5) =       0.000414848123
  error estimate for blocks of size 2^( 6) =       0.000417825626
  error estimate for blocks of size 2^( 7) =       0.000419287242

      target function =      -0.944391634293
              le_mean =     -17.212427440979
             les_mean =     296.547783347231
             stat err =       0.000415502421
             autocorr =       1.232608407281
   target nu stat err =       0.000415502421
   target dn stat err =       0.002757549567
      target stat err =       0.004822776077
              std dev =       0.529268435038
             le_variance =       0.280125076328

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280150598517
                                         uncertainty =       0.002935359993

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280150598517
                                         uncertainty =       0.002935359993

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374249142
  error estimate for blocks of size 2^( 2) =       0.000387956921
  error estimate for blocks of size 2^( 3) =       0.000400889111
  error estimate for blocks of size 2^( 4) =       0.000410048444
  error estimate for blocks of size 2^( 5) =       0.000414847786
  error estimate for blocks of size 2^( 6) =       0.000417825287
  error estimate for blocks of size 2^( 7) =       0.000419286794

      target function =      -0.944392039693
              le_mean =     -17.212427459942
             les_mean =     296.547783764820
             stat err =       0.000415502078
             autocorr =       1.232607403736
   target nu stat err =       0.000415502078
   target dn stat err =       0.002757547235
      target stat err =       0.004822776268
              std dev =       0.529268212837
             le_variance =       0.280124841119


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.944392097522        initial  <--
     3.8147e+01     3.8147e+02             1.4468e-05        -0.944391170362
     1.5259e+02     1.5259e+03             3.6177e-06        -0.944391634293
     6.1035e+02     6.1035e+03             9.0446e-07        -0.944392039693

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9921
  </log>
  <optVariables href="H2O.s015.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250636e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844948e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393233e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4976e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s016 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s016 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=16  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7196e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.2046
    reference variance = 0.301211
====================================================
  Execution time = 2.0392e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s016
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9257e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5586e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291961014761
                                         uncertainty =       0.005261610550

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.291961014761
                                         uncertainty =       0.005261610550

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000382474510
  error estimate for blocks of size 2^( 2) =       0.000395871715
  error estimate for blocks of size 2^( 3) =       0.000408561608
  error estimate for blocks of size 2^( 4) =       0.000416974958
  error estimate for blocks of size 2^( 5) =       0.000423297021
  error estimate for blocks of size 2^( 6) =       0.000424992532
  error estimate for blocks of size 2^( 7) =       0.000426021682

      target function =      -0.923367894636
              le_mean =     -17.211746109978
             les_mean =     296.536777509427
             stat err =       0.000422821548
             autocorr =       1.222106996489
   target nu stat err =       0.000422821548
   target dn stat err =       0.005256124777
      target stat err =       0.008700071130
              std dev =       0.540900639087
             le_variance =       0.292573501364


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721174610998e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+02, overlap shift 3.8147e+03 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923449087033       residual = 2.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923449213402       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923449236772       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923449254778       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923449266953       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923449277620       residual = 5.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923449283871       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923449294622       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923449296325       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923449298585       residual = 4.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923449302045       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923449303358       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923449304370       residual = 9.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923449305068       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923449305369       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923449305734       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923449306521       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923449306715       residual = 4.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.923449306854       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.923449306963       residual = 2.32e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.923449307020       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.923449307061       residual = 6.89e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.923449307093       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.923449307115       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.923449307092       residual = 7.21e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+02 is 1.399641e-06

solving harmonic davidson linear method for identity shift 1.5259e+03, overlap shift 1.5259e+04 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923449087033       residual = 2.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923449118630       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923449124473       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923449128975       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923449132021       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923449134686       residual = 5.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923449136250       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923449138934       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923449139364       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923449139923       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923449140791       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923449141122       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923449141377       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923449141549       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923449141620       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923449141715       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923449141911       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923449141960       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.923449141994       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.923449142022       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.923449142035       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.923449142050       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.923449142062       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.923449142058       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.923449142059       residual = 7.20e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+03 is 3.499368e-07

solving harmonic davidson linear method for identity shift 6.1035e+03, overlap shift 6.1035e+04 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.923449087033       residual = 2.15e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.923449094932       residual = 1.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.923449096393       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.923449097522       residual = 1.07e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.923449098282       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.923449098952       residual = 5.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.923449099335       residual = 2.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.923449099999       residual = 4.16e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923449100118       residual = 4.27e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.923449100255       residual = 4.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.923449100465       residual = 2.14e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.923449100558       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.923449100600       residual = 9.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.923449100650       residual = 6.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.923449100677       residual = 3.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923449100704       residual = 3.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.923449100751       residual = 3.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923449100736       residual = 4.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.923449100763       residual = 3.80e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.923449100775       residual = 2.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.923449100776       residual = 1.78e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.923449100787       residual = 6.88e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.923449100795       residual = 2.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.923449100804       residual = 1.44e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.923449100793       residual = 7.20e-10           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+03 is 8.748586e-08

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               0.993436 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5982e+01
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.977337e-01 1 1  ON 0
 uu_1                 4.330287e-02 1 1  ON 1
 uu_2                -4.189263e-02 1 1  ON 2
 uu_3                -9.235605e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319012e-01 1 1  ON 5
 uu_6                -1.107247e-01 1 1  ON 6
 uu_7                -4.250657e-02 1 1  ON 7
 uu_8                 8.649056e-02 1 1  ON 8
 uu_9                 1.220587e-01 1 1  ON 9
 ud_0                 3.027536e-01 1 1  ON 10
 ud_1                 7.594085e-02 1 1  ON 11
 ud_2                -1.844965e-02 1 1  ON 12
 ud_3                -6.887876e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357267e-01 1 1  ON 15
 ud_6                -1.369137e-01 1 1  ON 16
 ud_7                -9.606103e-02 1 1  ON 17
 ud_8                 1.393021e-03 1 1  ON 18
 ud_9                 9.066692e-02 1 1  ON 19
 eO_0                -6.845924e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963885e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548073e-01 1 1  ON 24
 eO_5                 2.930543e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164922e-01 1 1  ON 27
 eO_8                 2.796079e-02 1 1  ON 28
 eO_9                 1.837742e-02 1 1  ON 29
eH1_0                -1.951985e-01 1 1  ON 30
eH1_1                -9.632858e-02 1 1  ON 31
eH1_2                -4.928318e-02 1 1  ON 32
eH1_3                -1.897905e-02 1 1  ON 33
eH1_4                 1.663158e-02 1 1  ON 34
eH1_5                 2.420831e-02 1 1  ON 35
eH1_6                 7.670274e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201379e-02 1 1  ON 38
eH1_9                 2.427307e-02 1 1  ON 39
eH2_0                -1.961721e-01 1 1  ON 40
eH2_1                -9.716656e-02 1 1  ON 41
eH2_2                -5.030230e-02 1 1  ON 42
eH2_3                -2.015259e-02 1 1  ON 43
eH2_4                 1.553502e-02 1 1  ON 44
eH2_5                 2.428169e-02 1 1  ON 45
eH2_6                 7.651132e-02 1 1  ON 46
eH2_7                 1.129215e-01 1 1  ON 47
eH2_8                 9.607124e-02 1 1  ON 48
eH2_9                 2.646781e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 16
    time step          = 0.05
    reference energy   = -17.279
    reference variance = 1.0975
====================================================
  Execution time = 1.9903e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s016
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8662e-01
  Total weights = 2.0000e+06
  Execution time = 1.8202e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286553012463
                                         uncertainty =       0.003147258881

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286553012463
                                         uncertainty =       0.003147258881

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378563056
  error estimate for blocks of size 2^( 2) =       0.000392126912
  error estimate for blocks of size 2^( 3) =       0.000404431877
  error estimate for blocks of size 2^( 4) =       0.000413601097
  error estimate for blocks of size 2^( 5) =       0.000418772544
  error estimate for blocks of size 2^( 6) =       0.000422048590
  error estimate for blocks of size 2^( 7) =       0.000425749524

      target function =      -0.933289441507
              le_mean =     -17.212572719345
             les_mean =     296.559279450606
             stat err =       0.000420042939
             autocorr =       1.231149855874
   target nu stat err =       0.000420042939
   target dn stat err =       0.003172266050
      target stat err =       0.005405877336
              std dev =       0.535369008433
             le_variance =       0.286619975191

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286553037780
                                         uncertainty =       0.003147254265

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286553037780
                                         uncertainty =       0.003147254265

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378563072
  error estimate for blocks of size 2^( 2) =       0.000392126970
  error estimate for blocks of size 2^( 3) =       0.000404431985
  error estimate for blocks of size 2^( 4) =       0.000413601244
  error estimate for blocks of size 2^( 5) =       0.000418772707
  error estimate for blocks of size 2^( 6) =       0.000422048775
  error estimate for blocks of size 2^( 7) =       0.000425749715

      target function =      -0.933289400120
              le_mean =     -17.212572722704
             les_mean =     296.559279590692
             stat err =       0.000420043110
             autocorr =       1.231150755179
   target nu stat err =       0.000420043110
   target dn stat err =       0.003172262032
      target stat err =       0.005405870226
              std dev =       0.535369031261
             le_variance =       0.286619999634

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286553025116
                                         uncertainty =       0.003147256573

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286553025116
                                         uncertainty =       0.003147256573

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378563064
  error estimate for blocks of size 2^( 2) =       0.000392126941
  error estimate for blocks of size 2^( 3) =       0.000404431931
  error estimate for blocks of size 2^( 4) =       0.000413601171
  error estimate for blocks of size 2^( 5) =       0.000418772626
  error estimate for blocks of size 2^( 6) =       0.000422048683
  error estimate for blocks of size 2^( 7) =       0.000425749619

      target function =      -0.933289420823
              le_mean =     -17.212572721023
             les_mean =     296.559279520607
             stat err =       0.000420043025
             autocorr =       1.231150305570
   target nu stat err =       0.000420043025
   target dn stat err =       0.003172264041
      target stat err =       0.005405873781
              std dev =       0.535369019842
             le_variance =       0.286619987407

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286553014044
                                         uncertainty =       0.003147258592

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286553014044
                                         uncertainty =       0.003147258592

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378563057
  error estimate for blocks of size 2^( 2) =       0.000392126916
  error estimate for blocks of size 2^( 3) =       0.000404431883
  error estimate for blocks of size 2^( 4) =       0.000413601106
  error estimate for blocks of size 2^( 5) =       0.000418772555
  error estimate for blocks of size 2^( 6) =       0.000422048602
  error estimate for blocks of size 2^( 7) =       0.000425749536

      target function =      -0.933289438922
              le_mean =     -17.212572719554
             les_mean =     296.559279459351
             stat err =       0.000420042950
             autocorr =       1.231149912075
   target nu stat err =       0.000420042950
   target dn stat err =       0.003172265799
      target stat err =       0.005405876892
              std dev =       0.535369009859
             le_variance =       0.286619976717


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.933289441507        initial  <--
     3.8147e+02     3.8147e+03             1.3996e-06        -0.933289400120
     1.5259e+03     1.5259e+04             3.4994e-07        -0.933289420823
     6.1035e+03     6.1035e+04             8.7486e-08        -0.933289438922

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1361
  </log>
  <optVariables href="H2O.s016.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250636e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844948e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393233e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5123e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s017 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s017 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=17  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.175
    reference variance = 0.277465
====================================================
  Execution time = 2.0367e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s017
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8693e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7576e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287009841457
                                         uncertainty =       0.003305212595

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287009841457
                                         uncertainty =       0.003305212595

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378771021
  error estimate for blocks of size 2^( 2) =       0.000392202998
  error estimate for blocks of size 2^( 3) =       0.000404491477
  error estimate for blocks of size 2^( 4) =       0.000413145799
  error estimate for blocks of size 2^( 5) =       0.000417111387
  error estimate for blocks of size 2^( 6) =       0.000420034182
  error estimate for blocks of size 2^( 7) =       0.000421273225

      target function =      -0.932787001200
              le_mean =     -17.212060604870
             les_mean =     296.541965094471
             stat err =       0.000417891148
             autocorr =       1.217230583830
   target nu stat err =       0.000417891148
   target dn stat err =       0.003435120071
      target stat err =       0.005832803975
              std dev =       0.535663114502
             le_variance =       0.286934972238


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721206060487e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+03, overlap shift 3.8147e+04 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932822126698       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932822134282       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932822138005       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932822139736       residual = 7.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932822141073       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932822142269       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932822143144       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932822144003       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932822144263       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932822144260       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932822144346       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932822144450       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932822144557       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932822144618       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932822144691       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932822144679       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932822144683       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.932822144706       residual = 9.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932822144707       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.932822144719       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.932822144728       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932822144753       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.932822144745       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.932822144746       residual = 4.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+03 is 1.527448e-07

solving harmonic davidson linear method for identity shift 1.5259e+04, overlap shift 1.5259e+05 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932822126698       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932822128594       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932822129525       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932822129958       residual = 7.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932822130292       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932822130591       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932822130796       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932822131023       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932822131089       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932822131089       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932822131105       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932822131116       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932822131139       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932822131174       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932822131219       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932822131202       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932822131232       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.932822131211       residual = 9.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932822131201       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.932822131174       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.932822131169       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932822131268       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.932822131194       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.932822131233       residual = 4.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+04 is 3.818660e-08

solving harmonic davidson linear method for identity shift 6.1035e+04, overlap shift 6.1035e+05 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932822126698       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932822127172       residual = 1.64e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932822127405       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932822127513       residual = 7.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932822127596       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.932822127671       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932822127726       residual = 3.93e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932822127780       residual = 1.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.932822127796       residual = 3.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932822127796       residual = 1.33e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.932822127801       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.932822127807       residual = 1.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.932822127689       residual = 8.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.932822127943       residual = 5.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.932822127813       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932822127655       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.932822127530       residual = 1.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.932822127614       residual = 9.86e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.932822127791       residual = 5.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.932822128029       residual = 3.55e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.932822127666       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932822127760       residual = 7.50e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.932822127796       residual = 1.35e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.932822127711       residual = 4.97e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+04 is 9.546676e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.125766 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.9794e+01
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.977336e-01 1 1  ON 0
 uu_1                 4.330277e-02 1 1  ON 1
 uu_2                -4.189266e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250638e-02 1 1  ON 7
 uu_8                 8.649071e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844950e-02 1 1  ON 12
 ud_3                -6.887858e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606115e-02 1 1  ON 17
 ud_8                 1.393223e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963897e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930545e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632856e-02 1 1  ON 31
eH1_2                -4.928335e-02 1 1  ON 32
eH1_3                -1.897919e-02 1 1  ON 33
eH1_4                 1.663157e-02 1 1  ON 34
eH1_5                 2.420857e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201373e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961720e-01 1 1  ON 40
eH2_1                -9.716668e-02 1 1  ON 41
eH2_2                -5.030254e-02 1 1  ON 42
eH2_3                -2.015279e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607114e-02 1 1  ON 48
eH2_9                 2.646777e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 17
    time step          = 0.05
    reference energy   = -17.2788
    reference variance = 0.307587
====================================================
  Execution time = 1.9730e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s017
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8248e-01
  Total weights = 2.0000e+06
  Execution time = 1.8193e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282516435993
                                         uncertainty =       0.004939789909

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282516435993
                                         uncertainty =       0.004939789909

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375816798
  error estimate for blocks of size 2^( 2) =       0.000389461097
  error estimate for blocks of size 2^( 3) =       0.000401875435
  error estimate for blocks of size 2^( 4) =       0.000411208234
  error estimate for blocks of size 2^( 5) =       0.000416243798
  error estimate for blocks of size 2^( 6) =       0.000419185367
  error estimate for blocks of size 2^( 7) =       0.000420786742

      target function =      -0.940328845451
              le_mean =     -17.212005657898
             les_mean =     296.535615156854
             stat err =       0.000416856035
             autocorr =       1.230324897257
   target nu stat err =       0.000416856035
   target dn stat err =       0.004578265465
      target stat err =       0.007869771369
              std dev =       0.531485212012
             le_variance =       0.282476530588

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282516441226
                                         uncertainty =       0.004939790197

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282516441226
                                         uncertainty =       0.004939790197

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375816801
  error estimate for blocks of size 2^( 2) =       0.000389461102
  error estimate for blocks of size 2^( 3) =       0.000401875441
  error estimate for blocks of size 2^( 4) =       0.000411208243
  error estimate for blocks of size 2^( 5) =       0.000416243809
  error estimate for blocks of size 2^( 6) =       0.000419185380
  error estimate for blocks of size 2^( 7) =       0.000420786755

      target function =      -0.940328836469
              le_mean =     -17.212005657377
             les_mean =     296.535615144179
             stat err =       0.000416856047
             autocorr =       1.230324941732
   target nu stat err =       0.000416856047
   target dn stat err =       0.004578265574
      target stat err =       0.007869771399
              std dev =       0.531485216964
             le_variance =       0.282476535851

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282516438610
                                         uncertainty =       0.004939790053

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282516438610
                                         uncertainty =       0.004939790053

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375816799
  error estimate for blocks of size 2^( 2) =       0.000389461100
  error estimate for blocks of size 2^( 3) =       0.000401875438
  error estimate for blocks of size 2^( 4) =       0.000411208239
  error estimate for blocks of size 2^( 5) =       0.000416243803
  error estimate for blocks of size 2^( 6) =       0.000419185374
  error estimate for blocks of size 2^( 7) =       0.000420786749

      target function =      -0.940328840960
              le_mean =     -17.212005657637
             les_mean =     296.535615150516
             stat err =       0.000416856041
             autocorr =       1.230324919498
   target nu stat err =       0.000416856041
   target dn stat err =       0.004578265520
      target stat err =       0.007869771384
              std dev =       0.531485214488
             le_variance =       0.282476533219

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282516436320
                                         uncertainty =       0.004939789927

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282516436320
                                         uncertainty =       0.004939789927

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375816798
  error estimate for blocks of size 2^( 2) =       0.000389461098
  error estimate for blocks of size 2^( 3) =       0.000401875435
  error estimate for blocks of size 2^( 4) =       0.000411208235
  error estimate for blocks of size 2^( 5) =       0.000416243799
  error estimate for blocks of size 2^( 6) =       0.000419185368
  error estimate for blocks of size 2^( 7) =       0.000420786743

      target function =      -0.940328844890
              le_mean =     -17.212005657865
             les_mean =     296.535615156061
             stat err =       0.000416856036
             autocorr =       1.230324900032
   target nu stat err =       0.000416856036
   target dn stat err =       0.004578265472
      target stat err =       0.007869771370
              std dev =       0.531485212322
             le_variance =       0.282476530917


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940328845451        initial  <--
     3.8147e+03     3.8147e+04             1.5274e-07        -0.940328836469
     1.5259e+04     1.5259e+05             3.8187e-08        -0.940328840960
     6.1035e+04     6.1035e+05             9.5467e-09        -0.940328844890

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9515
  </log>
  <optVariables href="H2O.s017.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250636e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844948e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393233e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8752e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s018 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s018 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=18  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.172
    reference variance = 0.213024
====================================================
  Execution time = 2.0443e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s018
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.9841e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5275e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298490235483
                                         uncertainty =       0.023069449907

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.298490235483
                                         uncertainty =       0.023069449907

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000386269226
  error estimate for blocks of size 2^( 2) =       0.000399797416
  error estimate for blocks of size 2^( 3) =       0.000411501244
  error estimate for blocks of size 2^( 4) =       0.000420500395
  error estimate for blocks of size 2^( 5) =       0.000425445132
  error estimate for blocks of size 2^( 6) =       0.000428784038
  error estimate for blocks of size 2^( 7) =       0.000433157464

      target function =      -0.912413917513
              le_mean =     -17.212171952901
             les_mean =     296.557271017034
             stat err =       0.000426971757
             autocorr =       1.221850523143
   target nu stat err =       0.000426971757
   target dn stat err =       0.022656329918
      target stat err =       0.036572194564
              std dev =       0.546267178238
             le_variance =       0.298407830020


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721217195290e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+04, overlap shift 3.8147e+05 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913885179077       residual = 2.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913885181014       residual = 8.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913885182848       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913885184041       residual = 4.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913885184768       residual = 3.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913885185408       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913885186118       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913885186667       residual = 5.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913885186802       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913885187121       residual = 7.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913885187548       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913885187572       residual = 6.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913885187588       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913885187800       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913885187804       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913885187746       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913885187881       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913885187649       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913885187991       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913885187857       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913885187658       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913885187960       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913885187768       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913885188020       residual = 8.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913885188165       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913885187977       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+04 is 5.878320e-08

solving harmonic davidson linear method for identity shift 1.5259e+05, overlap shift 1.5259e+06 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913885179077       residual = 2.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913885179561       residual = 8.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913885180020       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913885180318       residual = 4.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913885180509       residual = 3.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913885180862       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913885180710       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913885180734       residual = 5.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913885180941       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913885181523       residual = 7.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913885181131       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913885181017       residual = 6.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913885181187       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913885181038       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913885181680       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913885181227       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913885181249       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913885181142       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913885180707       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913885181223       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913885181443       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913885181709       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913885181069       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913885180977       residual = 8.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913885180468       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913885181373       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+05 is 1.469581e-08

solving harmonic davidson linear method for identity shift 6.1035e+05, overlap shift 6.1035e+06 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.913885179077       residual = 2.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.913885179198       residual = 8.92e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.913885179313       residual = 4.65e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.913885179387       residual = 4.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.913885179328       residual = 3.83e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.913885180497       residual = 2.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.913885179725       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.913885179160       residual = 5.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.913885180091       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.913885177979       residual = 7.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.913885179832       residual = 3.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.913885179818       residual = 6.46e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.913885179206       residual = 4.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.913885179546       residual = 3.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.913885180063       residual = 3.20e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.913885178005       residual = 2.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.913885179049       residual = 1.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.913885181634       residual = 6.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.913885179216       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.913885181205       residual = 1.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.913885179300       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.913885181172       residual = 2.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.913885179259       residual = 1.21e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.913885178107       residual = 8.55e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.913885181878       residual = 1.40e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.913885178543       residual = 3.67e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         25 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+05 is 3.673954e-09

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.147469 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6003e+01
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330276e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393231e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632855e-02 1 1  ON 31
eH1_2                -4.928337e-02 1 1  ON 32
eH1_3                -1.897921e-02 1 1  ON 33
eH1_4                 1.663157e-02 1 1  ON 34
eH1_5                 2.420858e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428196e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 18
    time step          = 0.05
    reference energy   = -17.2718
    reference variance = 0.247485
====================================================
  Execution time = 1.9796e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s018
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7517e-01
  Total weights = 2.0000e+06
  Execution time = 1.8092e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275231383397
                                         uncertainty =       0.002310769844

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275231383397
                                         uncertainty =       0.002310769844

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370921851
  error estimate for blocks of size 2^( 2) =       0.000384683356
  error estimate for blocks of size 2^( 3) =       0.000397195158
  error estimate for blocks of size 2^( 4) =       0.000406040168
  error estimate for blocks of size 2^( 5) =       0.000411978919
  error estimate for blocks of size 2^( 6) =       0.000414121517
  error estimate for blocks of size 2^( 7) =       0.000416324473

      target function =      -0.953066491178
              le_mean =     -17.211555020674
             les_mean =     296.512792130693
             stat err =       0.000412116269
             autocorr =       1.234453353134
   target nu stat err =       0.000412116269
   target dn stat err =       0.002249238243
      target stat err =       0.004021952448
              std dev =       0.524562711775
             le_variance =       0.275166038585

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275231386496
                                         uncertainty =       0.002310769858

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275231386496
                                         uncertainty =       0.002310769858

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370921853
  error estimate for blocks of size 2^( 2) =       0.000384683359
  error estimate for blocks of size 2^( 3) =       0.000397195162
  error estimate for blocks of size 2^( 4) =       0.000406040172
  error estimate for blocks of size 2^( 5) =       0.000411978924
  error estimate for blocks of size 2^( 6) =       0.000414121522
  error estimate for blocks of size 2^( 7) =       0.000416324478

      target function =      -0.953066485737
              le_mean =     -17.211555020627
             les_mean =     296.512792132162
             stat err =       0.000412116274
             autocorr =       1.234453365368
   target nu stat err =       0.000412116274
   target dn stat err =       0.002249238261
      target stat err =       0.004021952435
              std dev =       0.524562714730
             le_variance =       0.275166041684

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275231384947
                                         uncertainty =       0.002310769851

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275231384947
                                         uncertainty =       0.002310769851

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370921852
  error estimate for blocks of size 2^( 2) =       0.000384683358
  error estimate for blocks of size 2^( 3) =       0.000397195160
  error estimate for blocks of size 2^( 4) =       0.000406040170
  error estimate for blocks of size 2^( 5) =       0.000411978921
  error estimate for blocks of size 2^( 6) =       0.000414121520
  error estimate for blocks of size 2^( 7) =       0.000416324476

      target function =      -0.953066488458
              le_mean =     -17.211555020650
             les_mean =     296.512792131427
             stat err =       0.000412116272
             autocorr =       1.234453359247
   target nu stat err =       0.000412116272
   target dn stat err =       0.002249238252
      target stat err =       0.004021952441
              std dev =       0.524562713252
             le_variance =       0.275166040135

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275231383591
                                         uncertainty =       0.002310769845

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275231383591
                                         uncertainty =       0.002310769845

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370921851
  error estimate for blocks of size 2^( 2) =       0.000384683356
  error estimate for blocks of size 2^( 3) =       0.000397195158
  error estimate for blocks of size 2^( 4) =       0.000406040168
  error estimate for blocks of size 2^( 5) =       0.000411978919
  error estimate for blocks of size 2^( 6) =       0.000414121518
  error estimate for blocks of size 2^( 7) =       0.000416324474

      target function =      -0.953066490838
              le_mean =     -17.211555020671
             les_mean =     296.512792130785
             stat err =       0.000412116270
             autocorr =       1.234453353900
   target nu stat err =       0.000412116270
   target dn stat err =       0.002249238245
      target stat err =       0.004021952447
              std dev =       0.524562711960
             le_variance =       0.275166038779


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.953066491178        initial  <--
     3.8147e+04     3.8147e+05             5.8783e-08        -0.953066485737
     1.5259e+05     1.5259e+06             1.4696e-08        -0.953066488458
     6.1035e+05     6.1035e+06             3.6740e-09        -0.953066490838

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9635
  </log>
  <optVariables href="H2O.s018.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250636e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844948e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393233e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4972e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s019 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s019 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=19  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.2398
    reference variance = 0.281155
====================================================
  Execution time = 2.0589e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s019
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7915e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5934e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279106246294
                                         uncertainty =       0.002839587666

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279106246294
                                         uncertainty =       0.002839587666

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373594382
  error estimate for blocks of size 2^( 2) =       0.000387340689
  error estimate for blocks of size 2^( 3) =       0.000399592333
  error estimate for blocks of size 2^( 4) =       0.000408801919
  error estimate for blocks of size 2^( 5) =       0.000414269052
  error estimate for blocks of size 2^( 6) =       0.000417121715
  error estimate for blocks of size 2^( 7) =       0.000417912451

      target function =      -0.946070945999
              le_mean =     -17.212698251669
             les_mean =     296.556126487992
             stat err =       0.000414526284
             autocorr =       1.231128748452
   target nu stat err =       0.000414526284
   target dn stat err =       0.002963331621
      target stat err =       0.005194747397
              std dev =       0.528342241874
             le_variance =       0.279145524548


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721269825167e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946098454727       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946098454795       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946098454818       residual = 9.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946098454829       residual = 8.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946098454508       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946098455244       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946098454378       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946098454335       residual = 9.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946098455104       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946098455952       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946098453700       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946098454432       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946098455782       residual = 7.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946098454583       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946098455416       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946098454140       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946098454727       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946098454283       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946098455002       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946098456595       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946098453713       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946098454269       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946098456256       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946098454238       residual = 6.44e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 1.473790e-09

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946098454727       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946098454744       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946098454750       residual = 9.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946098454753       residual = 8.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946098453624       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946098456181       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946098452254       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946098456635       residual = 9.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946098454761       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946098452100       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946098455488       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946098450880       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946098456755       residual = 7.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946098452263       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946098455754       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946098452457       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946098457537       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946098459993       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946098453844       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946098456980       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946098451516       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946098457873       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946098456122       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946098449498       residual = 6.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 3.684473e-10

solving harmonic davidson linear method for identity shift 6.1035e+06, overlap shift 6.1035e+07 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946098454727       residual = 1.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946098454731       residual = 1.00e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946098454733       residual = 9.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946098454734       residual = 8.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946098450632       residual = 3.31e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946098454809       residual = 2.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946098444054       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946098466199       residual = 9.53e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946098448009       residual = 2.38e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946098455871       residual = 1.88e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946098433629       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946098429098       residual = 2.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946098481311       residual = 7.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946098479037       residual = 6.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946098449922       residual = 3.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946098455855       residual = 2.20e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946098440760       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946098456637       residual = 8.49e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946098437143       residual = 4.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946098471087       residual = 2.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946098434444       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946098431870       residual = 8.75e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946098436282       residual = 3.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946098434523       residual = 6.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 6.1035e+06 is 9.211078e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.165618 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6212e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250636e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844948e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393233e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 19
    time step          = 0.05
    reference energy   = -17.1745
    reference variance = 0.447396
====================================================
  Execution time = 2.2037e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s019
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8311e-01
  Total weights = 2.0000e+06
  Execution time = 1.8174e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283138432534
                                         uncertainty =       0.005414283211

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283138432534
                                         uncertainty =       0.005414283211

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376240093
  error estimate for blocks of size 2^( 2) =       0.000390025471
  error estimate for blocks of size 2^( 3) =       0.000401963525
  error estimate for blocks of size 2^( 4) =       0.000410736869
  error estimate for blocks of size 2^( 5) =       0.000415885147
  error estimate for blocks of size 2^( 6) =       0.000419499952
  error estimate for blocks of size 2^( 7) =       0.000420391617

      target function =      -0.939214006981
              le_mean =     -17.212249511493
             les_mean =     296.544646318986
             stat err =       0.000416628396
             autocorr =       1.226217722669
   target nu stat err =       0.000416628396
   target dn stat err =       0.005001910632
      target stat err =       0.008575367085
              std dev =       0.532083841761
             le_variance =       0.283113214663

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283138432502
                                         uncertainty =       0.005414283181

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283138432502
                                         uncertainty =       0.005414283181

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376240093
  error estimate for blocks of size 2^( 2) =       0.000390025471
  error estimate for blocks of size 2^( 3) =       0.000401963525
  error estimate for blocks of size 2^( 4) =       0.000410736869
  error estimate for blocks of size 2^( 5) =       0.000415885148
  error estimate for blocks of size 2^( 6) =       0.000419499952
  error estimate for blocks of size 2^( 7) =       0.000420391618

      target function =      -0.939214007036
              le_mean =     -17.212249511486
             les_mean =     296.544646318729
             stat err =       0.000416628396
             autocorr =       1.226217723114
   target nu stat err =       0.000416628396
   target dn stat err =       0.005001910602
      target stat err =       0.008575367034
              std dev =       0.532083841731
             le_variance =       0.283113214631

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283138432518
                                         uncertainty =       0.005414283196

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283138432518
                                         uncertainty =       0.005414283196

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376240093
  error estimate for blocks of size 2^( 2) =       0.000390025471
  error estimate for blocks of size 2^( 3) =       0.000401963525
  error estimate for blocks of size 2^( 4) =       0.000410736869
  error estimate for blocks of size 2^( 5) =       0.000415885147
  error estimate for blocks of size 2^( 6) =       0.000419499952
  error estimate for blocks of size 2^( 7) =       0.000420391617

      target function =      -0.939214007009
              le_mean =     -17.212249511489
             les_mean =     296.544646318857
             stat err =       0.000416628396
             autocorr =       1.226217722889
   target nu stat err =       0.000416628396
   target dn stat err =       0.005001910617
      target stat err =       0.008575367060
              std dev =       0.532083841746
             le_variance =       0.283113214647

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283138432532
                                         uncertainty =       0.005414283209

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283138432532
                                         uncertainty =       0.005414283209

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376240093
  error estimate for blocks of size 2^( 2) =       0.000390025471
  error estimate for blocks of size 2^( 3) =       0.000401963525
  error estimate for blocks of size 2^( 4) =       0.000410736869
  error estimate for blocks of size 2^( 5) =       0.000415885147
  error estimate for blocks of size 2^( 6) =       0.000419499952
  error estimate for blocks of size 2^( 7) =       0.000420391617

      target function =      -0.939214006985
              le_mean =     -17.212249511492
             les_mean =     296.544646318970
             stat err =       0.000416628396
             autocorr =       1.226217722694
   target nu stat err =       0.000416628396
   target dn stat err =       0.005001910630
      target stat err =       0.008575367082
              std dev =       0.532083841759
             le_variance =       0.283113214661


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.939214006981        initial
     3.8147e+05     3.8147e+06             1.4738e-09        -0.939214007036  <--
     1.5259e+06     1.5259e+07             3.6845e-10        -0.939214007009
     6.1035e+06     6.1035e+07             9.2111e-11        -0.939214006985

*****************************************************************************
Applying the update for shift_i =   3.8147e+05     and shift_s =   3.8147e+06
*****************************************************************************

  Execution time = 3.1281e+01
  </log>
  <optVariables href="H2O.s019.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250636e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844948e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7499e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s020 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s020 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=20  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.2263
    reference variance = 0.301569
====================================================
  Execution time = 2.0531e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s020
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7639e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5429e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276428828958
                                         uncertainty =       0.002150632093

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276428828958
                                         uncertainty =       0.002150632093

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371746571
  error estimate for blocks of size 2^( 2) =       0.000385469485
  error estimate for blocks of size 2^( 3) =       0.000397657910
  error estimate for blocks of size 2^( 4) =       0.000407089814
  error estimate for blocks of size 2^( 5) =       0.000411652680
  error estimate for blocks of size 2^( 6) =       0.000414961393
  error estimate for blocks of size 2^( 7) =       0.000416677170

      target function =      -0.950883469300
              le_mean =     -17.212737954948
             les_mean =     296.554738794327
             stat err =       0.000412595264
             autocorr =       1.231840657456
   target nu stat err =       0.000412595264
   target dn stat err =       0.002173875429
      target stat err =       0.003883655611
              std dev =       0.525729043168
             le_variance =       0.276391026830


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721273795495e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+04, overlap shift 9.5367e+05 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950898213436       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950898213728       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950898213837       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.950898213895       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950898213937       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.950898214081       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.950898214004       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.950898214012       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.950898214041       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.950898213856       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.950898213975       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.950898214135       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.950898214059       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.950898214168       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.950898214284       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.950898213552       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.950898214313       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.950898214281       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.950898213775       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.950898214958       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.950898213951       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.950898214524       residual = 9.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.950898214008       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.950898214253       residual = 8.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+04 is 6.177110e-09

solving harmonic davidson linear method for identity shift 3.8147e+05, overlap shift 3.8147e+06 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950898213436       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950898213509       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950898213536       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.950898213555       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950898213884       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.950898213794       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.950898214092       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.950898213728       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.950898213973       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.950898214201       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.950898213386       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.950898212802       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.950898213463       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.950898213243       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.950898214446       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.950898213056       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.950898214245       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.950898213112       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.950898213696       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.950898214843       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.950898213112       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.950898213895       residual = 9.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.950898215634       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.950898212785       residual = 8.86e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+05 is 1.544278e-09

solving harmonic davidson linear method for identity shift 1.5259e+06, overlap shift 1.5259e+07 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950898213436       residual = 1.36e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950898213454       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950898213461       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.950898213466       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950898213443       residual = 4.23e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.950898211909       residual = 2.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.950898215439       residual = 4.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.950898214436       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.950898215555       residual = 3.36e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.950898210408       residual = 2.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.950898215437       residual = 3.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.950898213310       residual = 2.60e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.950898212339       residual = 1.26e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.950898208122       residual = 7.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.950898212579       residual = 5.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.950898218781       residual = 2.55e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.950898213819       residual = 2.60e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.950898217504       residual = 5.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.950898207638       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.950898203776       residual = 2.62e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.950898212602       residual = 1.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.950898211227       residual = 9.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.950898221388       residual = 3.90e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.950898217535       residual = 8.85e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+06 is 3.860687e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.183765 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6103e+01
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 20
    time step          = 0.05
    reference energy   = -17.1371
    reference variance = 0.196126
====================================================
  Execution time = 2.0072e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s020
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7903e-01
  Total weights = 2.0000e+06
  Execution time = 1.8193e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278989128762
                                         uncertainty =       0.003495338675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278989128762
                                         uncertainty =       0.003495338675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373519541
  error estimate for blocks of size 2^( 2) =       0.000387131938
  error estimate for blocks of size 2^( 3) =       0.000399489067
  error estimate for blocks of size 2^( 4) =       0.000409146263
  error estimate for blocks of size 2^( 5) =       0.000414714998
  error estimate for blocks of size 2^( 6) =       0.000417580094
  error estimate for blocks of size 2^( 7) =       0.000419767558

      target function =      -0.946267249434
              le_mean =     -17.212540632185
             les_mean =     296.550588570391
             stat err =       0.000415302228
             autocorr =       1.236237367804
   target nu stat err =       0.000415302228
   target dn stat err =       0.003192174842
      target stat err =       0.005588440474
              std dev =       0.528236400937
             le_variance =       0.279033695274

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278989128821
                                         uncertainty =       0.003495338675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278989128821
                                         uncertainty =       0.003495338675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373519541
  error estimate for blocks of size 2^( 2) =       0.000387131938
  error estimate for blocks of size 2^( 3) =       0.000399489068
  error estimate for blocks of size 2^( 4) =       0.000409146263
  error estimate for blocks of size 2^( 5) =       0.000414714998
  error estimate for blocks of size 2^( 6) =       0.000417580094
  error estimate for blocks of size 2^( 7) =       0.000419767558

      target function =      -0.946267249331
              le_mean =     -17.212540632197
             les_mean =     296.550588570857
             stat err =       0.000415302228
             autocorr =       1.236237369115
   target nu stat err =       0.000415302228
   target dn stat err =       0.003192174835
      target stat err =       0.005588440462
              std dev =       0.528236400992
             le_variance =       0.279033695333

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278989128791
                                         uncertainty =       0.003495338675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278989128791
                                         uncertainty =       0.003495338675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373519541
  error estimate for blocks of size 2^( 2) =       0.000387131938
  error estimate for blocks of size 2^( 3) =       0.000399489067
  error estimate for blocks of size 2^( 4) =       0.000409146263
  error estimate for blocks of size 2^( 5) =       0.000414714998
  error estimate for blocks of size 2^( 6) =       0.000417580094
  error estimate for blocks of size 2^( 7) =       0.000419767558

      target function =      -0.946267249382
              le_mean =     -17.212540632191
             les_mean =     296.550588570624
             stat err =       0.000415302228
             autocorr =       1.236237368472
   target nu stat err =       0.000415302228
   target dn stat err =       0.003192174838
      target stat err =       0.005588440468
              std dev =       0.528236400964
             le_variance =       0.279033695304

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278989128766
                                         uncertainty =       0.003495338675

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278989128766
                                         uncertainty =       0.003495338675

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373519541
  error estimate for blocks of size 2^( 2) =       0.000387131938
  error estimate for blocks of size 2^( 3) =       0.000399489067
  error estimate for blocks of size 2^( 4) =       0.000409146263
  error estimate for blocks of size 2^( 5) =       0.000414714998
  error estimate for blocks of size 2^( 6) =       0.000417580094
  error estimate for blocks of size 2^( 7) =       0.000419767558

      target function =      -0.946267249427
              le_mean =     -17.212540632186
             les_mean =     296.550588570420
             stat err =       0.000415302228
             autocorr =       1.236237367894
   target nu stat err =       0.000415302228
   target dn stat err =       0.003192174841
      target stat err =       0.005588440473
              std dev =       0.528236400940
             le_variance =       0.279033695278


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946267249434        initial  <--
     9.5367e+04     9.5367e+05             6.1771e-09        -0.946267249331
     3.8147e+05     3.8147e+06             1.5443e-09        -0.946267249382
     1.5259e+06     1.5259e+07             3.8607e-10        -0.946267249427

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2985
  </log>
  <optVariables href="H2O.s020.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250636e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844948e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5407e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s021 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s021 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=21  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1685
    reference variance = 0.229785
====================================================
  Execution time = 2.0355e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s021
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7627e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5598e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276270076320
                                         uncertainty =       0.002073942669

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276270076320
                                         uncertainty =       0.002073942669

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371666711
  error estimate for blocks of size 2^( 2) =       0.000385081608
  error estimate for blocks of size 2^( 3) =       0.000397229476
  error estimate for blocks of size 2^( 4) =       0.000406737333
  error estimate for blocks of size 2^( 5) =       0.000411922787
  error estimate for blocks of size 2^( 6) =       0.000414341223
  error estimate for blocks of size 2^( 7) =       0.000415618678

      target function =      -0.951112981720
              le_mean =     -17.212047617857
             les_mean =     296.530855349358
             stat err =       0.000412155005
             autocorr =       1.229741494209
   target nu stat err =       0.000412155005
   target dn stat err =       0.002256545982
      target stat err =       0.004022168535
              std dev =       0.525616103366
             le_variance =       0.276272288117


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721204761786e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951128649773       residual = 8.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951128649795       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951128649804       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.951128649810       residual = 9.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.951128649362       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.951128650010       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.951128649389       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.951128649836       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.951128650599       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.951128648801       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.951128650691       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.951128645319       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.951128654407       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.951128650467       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.951128654191       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.951128648744       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.951128649785       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.951128652843       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.951128646450       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.951128648744       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.951128653158       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.951128652609       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.951128649427       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.951128650435       residual = 5.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 5.612717e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951128649773       residual = 8.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951128649779       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951128649781       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.951128647712       residual = 9.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.951128649565       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.951128645441       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.951128651125       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.951128640589       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.951128647182       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.951128640700       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.951128653863       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.951128645424       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.951128643014       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.951128644690       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.951128650366       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.951128651531       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.951128719153       residual = 4.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.951128663122       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.951128659475       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.951128648959       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.951128644159       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.951128635734       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.951128662139       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.951128644200       residual = 5.32e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 1.403186e-10

solving harmonic davidson linear method for identity shift 1.5259e+07, overlap shift 1.5259e+08 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951128649773       residual = 8.25e-03           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951128649774       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951128649775       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.951128649776       residual = 9.05e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.951128645817       residual = 4.13e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.951128665073       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.951128623687       residual = 2.67e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.951128616813       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.951128643435       residual = 4.19e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.951128631523       residual = 2.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.951128658007       residual = 2.86e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.951128624517       residual = 1.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.951128656816       residual = 7.26e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.951128656635       residual = 6.63e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.951128641356       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.951128656964       residual = 2.51e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.951128619274       residual = 4.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.951128582228       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.951128543746       residual = 4.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.951128708388       residual = 1.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.951128631582       residual = 1.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.951128553354       residual = 1.31e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.951128656413       residual = 3.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.951128669706       residual = 5.31e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.5259e+07 is 3.507814e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.201865 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5944e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250636e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 21
    time step          = 0.05
    reference energy   = -17.1788
    reference variance = 0.205742
====================================================
  Execution time = 1.9820e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s021
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7726e-01
  Total weights = 2.0000e+06
  Execution time = 1.8182e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277316730617
                                         uncertainty =       0.002161866361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277316730617
                                         uncertainty =       0.002161866361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372329697
  error estimate for blocks of size 2^( 2) =       0.000386012546
  error estimate for blocks of size 2^( 3) =       0.000398393753
  error estimate for blocks of size 2^( 4) =       0.000407645329
  error estimate for blocks of size 2^( 5) =       0.000413077390
  error estimate for blocks of size 2^( 6) =       0.000414461034
  error estimate for blocks of size 2^( 7) =       0.000416065046

      target function =      -0.949378679601
              le_mean =     -17.212319963377
             les_mean =     296.541217189283
             stat err =       0.000412812200
             autocorr =       1.229276823078
   target nu stat err =       0.000412812200
   target dn stat err =       0.002321634418
      target stat err =       0.004121704065
              std dev =       0.526553706881
             le_variance =       0.277258806230

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277316730614
                                         uncertainty =       0.002161866361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277316730614
                                         uncertainty =       0.002161866361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372329697
  error estimate for blocks of size 2^( 2) =       0.000386012546
  error estimate for blocks of size 2^( 3) =       0.000398393753
  error estimate for blocks of size 2^( 4) =       0.000407645329
  error estimate for blocks of size 2^( 5) =       0.000413077390
  error estimate for blocks of size 2^( 6) =       0.000414461034
  error estimate for blocks of size 2^( 7) =       0.000416065046

      target function =      -0.949378679605
              le_mean =     -17.212319963378
             les_mean =     296.541217189301
             stat err =       0.000412812200
             autocorr =       1.229276823379
   target nu stat err =       0.000412812200
   target dn stat err =       0.002321634417
      target stat err =       0.004121704065
              std dev =       0.526553706879
             le_variance =       0.277258806228

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277316730616
                                         uncertainty =       0.002161866361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277316730616
                                         uncertainty =       0.002161866361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372329697
  error estimate for blocks of size 2^( 2) =       0.000386012546
  error estimate for blocks of size 2^( 3) =       0.000398393753
  error estimate for blocks of size 2^( 4) =       0.000407645329
  error estimate for blocks of size 2^( 5) =       0.000413077390
  error estimate for blocks of size 2^( 6) =       0.000414461034
  error estimate for blocks of size 2^( 7) =       0.000416065046

      target function =      -0.949378679603
              le_mean =     -17.212319963378
             les_mean =     296.541217189292
             stat err =       0.000412812200
             autocorr =       1.229276823231
   target nu stat err =       0.000412812200
   target dn stat err =       0.002321634418
      target stat err =       0.004121704065
              std dev =       0.526553706880
             le_variance =       0.277258806229

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277316730617
                                         uncertainty =       0.002161866361

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277316730617
                                         uncertainty =       0.002161866361

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372329697
  error estimate for blocks of size 2^( 2) =       0.000386012546
  error estimate for blocks of size 2^( 3) =       0.000398393753
  error estimate for blocks of size 2^( 4) =       0.000407645329
  error estimate for blocks of size 2^( 5) =       0.000413077390
  error estimate for blocks of size 2^( 6) =       0.000414461034
  error estimate for blocks of size 2^( 7) =       0.000416065046

      target function =      -0.949378679601
              le_mean =     -17.212319963378
             les_mean =     296.541217189284
             stat err =       0.000412812200
             autocorr =       1.229276823105
   target nu stat err =       0.000412812200
   target dn stat err =       0.002321634418
      target stat err =       0.004121704065
              std dev =       0.526553706881
             le_variance =       0.277258806230


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949378679601        initial
     9.5367e+05     9.5367e+06             5.6127e-10        -0.949378679605  <--
     3.8147e+06     3.8147e+07             1.4032e-10        -0.949378679603
     1.5259e+07     1.5259e+08             3.5078e-11        -0.949378679601

*****************************************************************************
Applying the update for shift_i =   9.5367e+05     and shift_s =   9.5367e+06
*****************************************************************************

  Execution time = 2.9005e+01
  </log>
  <optVariables href="H2O.s021.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4955e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s022 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s022 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=22  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7199e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.2092
    reference variance = 0.254129
====================================================
  Execution time = 2.0307e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s022
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8348e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5735e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283489704904
                                         uncertainty =       0.003322476113

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283489704904
                                         uncertainty =       0.003322476113

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376486781
  error estimate for blocks of size 2^( 2) =       0.000389817131
  error estimate for blocks of size 2^( 3) =       0.000401792228
  error estimate for blocks of size 2^( 4) =       0.000410933430
  error estimate for blocks of size 2^( 5) =       0.000415403519
  error estimate for blocks of size 2^( 6) =       0.000417736675
  error estimate for blocks of size 2^( 7) =       0.000419153635

      target function =      -0.938648504083
              le_mean =     -17.211705836539
             les_mean =     296.526302254997
             stat err =       0.000415806815
             autocorr =       1.219786271104
   target nu stat err =       0.000415806815
   target dn stat err =       0.003565703264
      target stat err =       0.006121935359
              std dev =       0.532432712357
             le_variance =       0.283484593188


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721170583654e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+05, overlap shift 2.3842e+06 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938687263434       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938687263576       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938687263606       residual = 7.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938687263630       residual = 6.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938687263651       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938687263675       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938687263684       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938687264079       residual = 9.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938687263693       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938687263421       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938687263696       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938687263709       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938687263330       residual = 7.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.938687263601       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938687263532       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938687263362       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938687263602       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.938687264694       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938687263121       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.938687264667       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.938687263878       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.938687263193       residual = 5.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938687263841       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938687264357       residual = 4.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+05 is 2.396190e-09

solving harmonic davidson linear method for identity shift 9.5367e+05, overlap shift 9.5367e+06 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938687263434       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938687263469       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938687263477       residual = 7.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938687263425       residual = 6.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938687263488       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938687262871       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938687263757       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938687263498       residual = 9.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938687263499       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938687265746       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938687266476       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938687263498       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938687265319       residual = 7.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.938687261657       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938687261573       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938687265941       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938687266493       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.938687259309       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938687258549       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.938687259332       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.938687265486       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.938687261547       residual = 5.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938687260010       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938687262719       residual = 4.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+05 is 5.990483e-10

solving harmonic davidson linear method for identity shift 3.8147e+06, overlap shift 3.8147e+07 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938687263434       residual = 1.71e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938687263443       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938687263445       residual = 7.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938687263638       residual = 6.95e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938687265538       residual = 4.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938687266575       residual = 3.12e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938687268132       residual = 2.26e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938687268082       residual = 9.14e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938687264450       residual = 1.82e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938687266094       residual = 1.24e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938687258160       residual = 1.83e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938687264794       residual = 1.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938687264341       residual = 7.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.938687253655       residual = 4.33e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938687266004       residual = 2.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938687252014       residual = 1.23e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938687250700       residual = 1.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.938687257644       residual = 4.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938687248225       residual = 6.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.938687263241       residual = 2.45e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.938687246643       residual = 1.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.938687260871       residual = 5.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938687254520       residual = 1.70e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938687249926       residual = 4.33e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+06 is 1.497630e-10

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.219950 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5910e+01
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 22
    time step          = 0.05
    reference energy   = -17.1862
    reference variance = 0.234205
====================================================
  Execution time = 2.1296e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s022
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8323e-01
  Total weights = 2.0000e+06
  Execution time = 2.0909e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283181534976
                                         uncertainty =       0.004150644947

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283181534976
                                         uncertainty =       0.004150644947

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376319555
  error estimate for blocks of size 2^( 2) =       0.000389795584
  error estimate for blocks of size 2^( 3) =       0.000402164781
  error estimate for blocks of size 2^( 4) =       0.000411412785
  error estimate for blocks of size 2^( 5) =       0.000417606348
  error estimate for blocks of size 2^( 6) =       0.000420986730
  error estimate for blocks of size 2^( 7) =       0.000422359322

      target function =      -0.939008727293
              le_mean =     -17.212700860209
             les_mean =     296.560303576905
             stat err =       0.000418091296
             autocorr =       1.234322596471
   target nu stat err =       0.000418091296
   target dn stat err =       0.004170400020
      target stat err =       0.007165281702
              std dev =       0.532196218951
             le_variance =       0.283232815466

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283181534987
                                         uncertainty =       0.004150644938

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283181534987
                                         uncertainty =       0.004150644938

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376319555
  error estimate for blocks of size 2^( 2) =       0.000389795584
  error estimate for blocks of size 2^( 3) =       0.000402164781
  error estimate for blocks of size 2^( 4) =       0.000411412785
  error estimate for blocks of size 2^( 5) =       0.000417606348
  error estimate for blocks of size 2^( 6) =       0.000420986730
  error estimate for blocks of size 2^( 7) =       0.000422359322

      target function =      -0.939008727273
              le_mean =     -17.212700860210
             les_mean =     296.560303576936
             stat err =       0.000418091296
             autocorr =       1.234322597052
   target nu stat err =       0.000418091296
   target dn stat err =       0.004170400011
      target stat err =       0.007165281687
              std dev =       0.532196218962
             le_variance =       0.283232815477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283181534982
                                         uncertainty =       0.004150644942

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283181534982
                                         uncertainty =       0.004150644942

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376319555
  error estimate for blocks of size 2^( 2) =       0.000389795584
  error estimate for blocks of size 2^( 3) =       0.000402164781
  error estimate for blocks of size 2^( 4) =       0.000411412785
  error estimate for blocks of size 2^( 5) =       0.000417606348
  error estimate for blocks of size 2^( 6) =       0.000420986730
  error estimate for blocks of size 2^( 7) =       0.000422359322

      target function =      -0.939008727283
              le_mean =     -17.212700860210
             les_mean =     296.560303576920
             stat err =       0.000418091296
             autocorr =       1.234322596762
   target nu stat err =       0.000418091296
   target dn stat err =       0.004170400016
      target stat err =       0.007165281695
              std dev =       0.532196218956
             le_variance =       0.283232815471

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283181534977
                                         uncertainty =       0.004150644946

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283181534977
                                         uncertainty =       0.004150644946

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376319555
  error estimate for blocks of size 2^( 2) =       0.000389795584
  error estimate for blocks of size 2^( 3) =       0.000402164781
  error estimate for blocks of size 2^( 4) =       0.000411412785
  error estimate for blocks of size 2^( 5) =       0.000417606348
  error estimate for blocks of size 2^( 6) =       0.000420986730
  error estimate for blocks of size 2^( 7) =       0.000422359322

      target function =      -0.939008727292
              le_mean =     -17.212700860210
             les_mean =     296.560303576907
             stat err =       0.000418091296
             autocorr =       1.234322596501
   target nu stat err =       0.000418091296
   target dn stat err =       0.004170400019
      target stat err =       0.007165281701
              std dev =       0.532196218951
             le_variance =       0.283232815466


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.939008727293        initial  <--
     2.3842e+05     2.3842e+06             2.3962e-09        -0.939008727273
     9.5367e+05     9.5367e+06             5.9905e-10        -0.939008727283
     3.8147e+06     3.8147e+07             1.4976e-10        -0.939008727292

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 30.7942
  </log>
  <optVariables href="H2O.s022.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6710e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s023 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s023 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=23  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7199e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1754
    reference variance = 0.216946
====================================================
  Execution time = 2.0393e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s023
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7926e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5424e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279348758563
                                         uncertainty =       0.003364418139

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279348758563
                                         uncertainty =       0.003364418139

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373674158
  error estimate for blocks of size 2^( 2) =       0.000387279886
  error estimate for blocks of size 2^( 3) =       0.000399676022
  error estimate for blocks of size 2^( 4) =       0.000408722575
  error estimate for blocks of size 2^( 5) =       0.000414498672
  error estimate for blocks of size 2^( 6) =       0.000417244096
  error estimate for blocks of size 2^( 7) =       0.000418183896

      target function =      -0.945869030573
              le_mean =     -17.212461036691
             les_mean =     296.548079552714
             stat err =       0.000414662310
             autocorr =       1.231410905322
   target nu stat err =       0.000414662310
   target dn stat err =       0.003250336801
      target stat err =       0.005682619867
              std dev =       0.528455062193
             le_variance =       0.279264752757


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721246103669e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945901875897       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945901875910       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945901875914       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945901875917       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945901875919       residual = 5.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945901875921       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945901875923       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945901875923       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945901875924       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945901875924       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945901875925       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945901873536       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945901877473       residual = 1.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945901875925       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.945901875925       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945901881326       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.945901878503       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945901867964       residual = 9.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945901874360       residual = 6.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945901877007       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945901873403       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945901861781       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945901875045       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945901864515       residual = 9.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 2.548215e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945901875897       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945901875900       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945901875901       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945901872047       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945901875915       residual = 5.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945901867699       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945901875903       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945901867808       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945901906952       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945901862959       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945901881230       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945901865180       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945901899240       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945901847600       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.945901912566       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945901860767       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.945901832167       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945901891755       residual = 9.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945901858808       residual = 6.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945901881645       residual = 2.84e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945901838886       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945901861148       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945901882638       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945901864410       residual = 9.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 6.370458e-11

solving harmonic davidson linear method for identity shift 3.8147e+07, overlap shift 3.8147e+08 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.945901875897       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.945901875898       residual = 1.53e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.945901875898       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.945901875898       residual = 1.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.945901875898       residual = 5.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.945901875899       residual = 3.18e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.945901917718       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.945901875899       residual = 2.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.945901777385       residual = 6.13e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.945901899912       residual = 3.79e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945901838222       residual = 4.77e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.945901875899       residual = 2.65e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.945901875899       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.945901884801       residual = 9.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.945901931090       residual = 5.67e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.945902060004       residual = 3.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.945901745520       residual = 3.19e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.945901885555       residual = 9.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945901841745       residual = 6.13e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.945901850149       residual = 2.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.945901973181       residual = 3.51e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.945901941206       residual = 1.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.945901924200       residual = 3.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.945901822749       residual = 9.52e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.8147e+07 is 1.592739e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.238292 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5965e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 23
    time step          = 0.05
    reference energy   = -17.1995
    reference variance = 0.211552
====================================================
  Execution time = 1.9688e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s023
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7457e-01
  Total weights = 2.0000e+06
  Execution time = 1.8176e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274540914237
                                         uncertainty =       0.001876756222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274540914237
                                         uncertainty =       0.001876756222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370520467
  error estimate for blocks of size 2^( 2) =       0.000384525657
  error estimate for blocks of size 2^( 3) =       0.000397531197
  error estimate for blocks of size 2^( 4) =       0.000406337047
  error estimate for blocks of size 2^( 5) =       0.000412044151
  error estimate for blocks of size 2^( 6) =       0.000414610546
  error estimate for blocks of size 2^( 7) =       0.000416362706

      target function =      -0.954101581858
              le_mean =     -17.212204802935
             les_mean =     296.534564873374
             stat err =       0.000412338612
             autocorr =       1.238464623420
   target nu stat err =       0.000412338612
   target dn stat err =       0.001856297323
      target stat err =       0.003358278907
              std dev =       0.523995069136
             le_variance =       0.274570832479

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274540914235
                                         uncertainty =       0.001876756222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274540914235
                                         uncertainty =       0.001876756222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370520467
  error estimate for blocks of size 2^( 2) =       0.000384525657
  error estimate for blocks of size 2^( 3) =       0.000397531197
  error estimate for blocks of size 2^( 4) =       0.000406337047
  error estimate for blocks of size 2^( 5) =       0.000412044151
  error estimate for blocks of size 2^( 6) =       0.000414610546
  error estimate for blocks of size 2^( 7) =       0.000416362706

      target function =      -0.954101581862
              le_mean =     -17.212204802935
             les_mean =     296.534564873377
             stat err =       0.000412338612
             autocorr =       1.238464623475
   target nu stat err =       0.000412338612
   target dn stat err =       0.001856297322
      target stat err =       0.003358278906
              std dev =       0.523995069134
             le_variance =       0.274570832477

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274540914236
                                         uncertainty =       0.001876756222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274540914236
                                         uncertainty =       0.001876756222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370520467
  error estimate for blocks of size 2^( 2) =       0.000384525657
  error estimate for blocks of size 2^( 3) =       0.000397531197
  error estimate for blocks of size 2^( 4) =       0.000406337047
  error estimate for blocks of size 2^( 5) =       0.000412044151
  error estimate for blocks of size 2^( 6) =       0.000414610546
  error estimate for blocks of size 2^( 7) =       0.000416362706

      target function =      -0.954101581860
              le_mean =     -17.212204802935
             les_mean =     296.534564873376
             stat err =       0.000412338612
             autocorr =       1.238464623451
   target nu stat err =       0.000412338612
   target dn stat err =       0.001856297322
      target stat err =       0.003358278906
              std dev =       0.523995069135
             le_variance =       0.274570832478

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274540914237
                                         uncertainty =       0.001876756222

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.274540914237
                                         uncertainty =       0.001876756222

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370520467
  error estimate for blocks of size 2^( 2) =       0.000384525657
  error estimate for blocks of size 2^( 3) =       0.000397531197
  error estimate for blocks of size 2^( 4) =       0.000406337047
  error estimate for blocks of size 2^( 5) =       0.000412044151
  error estimate for blocks of size 2^( 6) =       0.000414610546
  error estimate for blocks of size 2^( 7) =       0.000416362706

      target function =      -0.954101581858
              le_mean =     -17.212204802935
             les_mean =     296.534564873375
             stat err =       0.000412338612
             autocorr =       1.238464623429
   target nu stat err =       0.000412338612
   target dn stat err =       0.001856297323
      target stat err =       0.003358278907
              std dev =       0.523995069136
             le_variance =       0.274570832479


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.954101581858        initial
     2.3842e+06     2.3842e+07             2.5482e-10        -0.954101581862  <--
     9.5367e+06     9.5367e+07             6.3705e-11        -0.954101581860
     3.8147e+07     3.8147e+08             1.5927e-11        -0.954101581858

*****************************************************************************
Applying the update for shift_i =   2.3842e+06     and shift_s =   2.3842e+07
*****************************************************************************

  Execution time = 2.8908e+01
  </log>
  <optVariables href="H2O.s023.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4879e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s024 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s024 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=24  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7199e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.198
    reference variance = 0.167664
====================================================
  Execution time = 2.0157e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s024
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8247e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6004e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282327422454
                                         uncertainty =       0.003611865738

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282327422454
                                         uncertainty =       0.003611865738

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375810612
  error estimate for blocks of size 2^( 2) =       0.000389265936
  error estimate for blocks of size 2^( 3) =       0.000401403183
  error estimate for blocks of size 2^( 4) =       0.000410224784
  error estimate for blocks of size 2^( 5) =       0.000415501246
  error estimate for blocks of size 2^( 6) =       0.000419457283
  error estimate for blocks of size 2^( 7) =       0.000420844042

      target function =      -0.940348052076
              le_mean =     -17.212485246552
             les_mean =     296.552115453978
             stat err =       0.000416506839
             autocorr =       1.228304926775
   target nu stat err =       0.000416506839
   target dn stat err =       0.003402505782
      target stat err =       0.005876117575
              std dev =       0.531476464628
             le_variance =       0.282467232453


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721248524655e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+05, overlap shift 5.9605e+06 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940384064963       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940384065019       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940384065035       residual = 9.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940384064792       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940384065056       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940384066236       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940384065068       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940384065011       residual = 9.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940384063826       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940384064378       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.940384064776       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.940384067625       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.940384068338       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.940384066350       residual = 8.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.940384067118       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.940384063507       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.940384063951       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.940384066323       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.940384066370       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.940384065293       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.940384066163       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.940384066308       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.940384064282       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.940384065534       residual = 9.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+05 is 1.155315e-09

solving harmonic davidson linear method for identity shift 2.3842e+06, overlap shift 2.3842e+07 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940384064963       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940384064977       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940384064981       residual = 9.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940384064981       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940384064986       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940384065478       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940384066432       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940384063120       residual = 9.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940384063561       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940384064519       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.940384072296       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.940384064489       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.940384059510       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.940384072935       residual = 8.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.940384064893       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.940384070856       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.940384064993       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.940384062784       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.940384059310       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.940384065434       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.940384067613       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.940384068132       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.940384065257       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.940384062503       residual = 9.46e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+06 is 2.888292e-10

solving harmonic davidson linear method for identity shift 9.5367e+06, overlap shift 9.5367e+07 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940384064963       residual = 1.60e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940384064967       residual = 1.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.940384064968       residual = 9.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.940384066606       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.940384070075       residual = 4.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940384061792       residual = 3.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.940384071406       residual = 4.53e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.940384070004       residual = 9.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.940384086123       residual = 3.56e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.940384063332       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.940384070191       residual = 3.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.940384080899       residual = 1.84e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.940384072566       residual = 1.03e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.940384080373       residual = 8.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.940384064800       residual = 4.81e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.940384075013       residual = 2.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.940384017399       residual = 2.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.940384051206       residual = 9.30e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.940384077778       residual = 7.59e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.940384064856       residual = 2.69e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.940384052307       residual = 3.12e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.940384062668       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.940384085744       residual = 4.21e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.940384074428       residual = 9.45e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+06 is 7.220733e-11

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.256517 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5787e+01
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 24
    time step          = 0.05
    reference energy   = -17.1966
    reference variance = 0.225065
====================================================
  Execution time = 1.9808e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s024
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7527e-01
  Total weights = 2.0000e+06
  Execution time = 1.8250e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275290156624
                                         uncertainty =       0.001609295481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275290156624
                                         uncertainty =       0.001609295481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370991370
  error estimate for blocks of size 2^( 2) =       0.000384754788
  error estimate for blocks of size 2^( 3) =       0.000397296696
  error estimate for blocks of size 2^( 4) =       0.000406730957
  error estimate for blocks of size 2^( 5) =       0.000413436661
  error estimate for blocks of size 2^( 6) =       0.000415653571
  error estimate for blocks of size 2^( 7) =       0.000415785508

      target function =      -0.952834968988
              le_mean =     -17.213472381361
             les_mean =     296.578900479992
             stat err =       0.000412901674
             autocorr =       1.238698674135
   target nu stat err =       0.000412901674
   target dn stat err =       0.001747317858
      target stat err =       0.003171411236
              std dev =       0.524661027483
             le_variance =       0.275269193759

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275290156632
                                         uncertainty =       0.001609295480

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275290156632
                                         uncertainty =       0.001609295480

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370991370
  error estimate for blocks of size 2^( 2) =       0.000384754788
  error estimate for blocks of size 2^( 3) =       0.000397296696
  error estimate for blocks of size 2^( 4) =       0.000406730957
  error estimate for blocks of size 2^( 5) =       0.000413436661
  error estimate for blocks of size 2^( 6) =       0.000415653571
  error estimate for blocks of size 2^( 7) =       0.000415785509

      target function =      -0.952834968974
              le_mean =     -17.213472381364
             les_mean =     296.578900480101
             stat err =       0.000412901674
             autocorr =       1.238698674490
   target nu stat err =       0.000412901674
   target dn stat err =       0.001747317857
      target stat err =       0.003171411234
              std dev =       0.524661027490
             le_variance =       0.275269193767

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275290156628
                                         uncertainty =       0.001609295481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275290156628
                                         uncertainty =       0.001609295481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370991370
  error estimate for blocks of size 2^( 2) =       0.000384754788
  error estimate for blocks of size 2^( 3) =       0.000397296696
  error estimate for blocks of size 2^( 4) =       0.000406730957
  error estimate for blocks of size 2^( 5) =       0.000413436661
  error estimate for blocks of size 2^( 6) =       0.000415653571
  error estimate for blocks of size 2^( 7) =       0.000415785509

      target function =      -0.952834968981
              le_mean =     -17.213472381362
             les_mean =     296.578900480046
             stat err =       0.000412901674
             autocorr =       1.238698674313
   target nu stat err =       0.000412901674
   target dn stat err =       0.001747317858
      target stat err =       0.003171411235
              std dev =       0.524661027486
             le_variance =       0.275269193763

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275290156624
                                         uncertainty =       0.001609295481

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275290156624
                                         uncertainty =       0.001609295481

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370991370
  error estimate for blocks of size 2^( 2) =       0.000384754788
  error estimate for blocks of size 2^( 3) =       0.000397296696
  error estimate for blocks of size 2^( 4) =       0.000406730957
  error estimate for blocks of size 2^( 5) =       0.000413436661
  error estimate for blocks of size 2^( 6) =       0.000415653571
  error estimate for blocks of size 2^( 7) =       0.000415785508

      target function =      -0.952834968987
              le_mean =     -17.213472381361
             les_mean =     296.578900479999
             stat err =       0.000412901674
             autocorr =       1.238698674141
   target nu stat err =       0.000412901674
   target dn stat err =       0.001747317858
      target stat err =       0.003171411236
              std dev =       0.524661027483
             le_variance =       0.275269193759


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.952834968988        initial  <--
     5.9605e+05     5.9605e+06             1.1553e-09        -0.952834968974
     2.3842e+06     2.3842e+07             2.8883e-10        -0.952834968981
     9.5367e+06     9.5367e+07             7.2207e-11        -0.952834968987

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0657
  </log>
  <optVariables href="H2O.s024.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4859e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s025 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s025 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=25  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7199e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2429
    reference variance = 0.179688
====================================================
  Execution time = 2.2397e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s025
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8209e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5594e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282146203166
                                         uncertainty =       0.003678844571

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282146203166
                                         uncertainty =       0.003678844571

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375560712
  error estimate for blocks of size 2^( 2) =       0.000389135973
  error estimate for blocks of size 2^( 3) =       0.000401763474
  error estimate for blocks of size 2^( 4) =       0.000411068366
  error estimate for blocks of size 2^( 5) =       0.000416649973
  error estimate for blocks of size 2^( 6) =       0.000419769110
  error estimate for blocks of size 2^( 7) =       0.000420721865

      target function =      -0.941054645698
              le_mean =     -17.211106903161
             les_mean =     296.504292387380
             stat err =       0.000417052328
             autocorr =       1.233163874481
   target nu stat err =       0.000417052328
   target dn stat err =       0.003618253696
      target stat err =       0.006235507759
              std dev =       0.531123052010
             le_variance =       0.282091696376


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721110690316e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+06, overlap shift 5.9605e+07 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941095020452       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941095020458       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941095020459       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941095020460       residual = 9.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941095016424       residual = 5.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941095022341       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941095011805       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941095012106       residual = 6.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941095025834       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941095018145       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941095029530       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941095018005       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941095022850       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941095018466       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941095016528       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941095009645       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941094989083       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941095016301       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941095018271       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941095010881       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941094995854       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941095006960       residual = 1.92e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941095006880       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941095030623       residual = 9.23e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+06 is 9.804496e-11

solving harmonic davidson linear method for identity shift 2.3842e+07, overlap shift 2.3842e+08 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941095020452       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941095020453       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941095020454       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941095020454       residual = 9.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941095020199       residual = 5.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941094977548       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941095007544       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941095077685       residual = 6.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941095024186       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941094983180       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941095050483       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941094981694       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941095012290       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941094986064       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941094953603       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941095007299       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941095014013       residual = 2.44e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941094991852       residual = 8.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941094944115       residual = 5.98e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941094963366       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941095080349       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941095000558       residual = 1.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941095012621       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941094999997       residual = 9.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+07 is 2.451101e-11

solving harmonic davidson linear method for identity shift 9.5367e+07, overlap shift 9.5367e+08 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941095020452       residual = 1.70e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941095020452       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941095020452       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941095020453       residual = 9.22e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941094965720       residual = 5.97e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941095020024       residual = 3.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941094928457       residual = 3.30e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941095019424       residual = 6.40e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941095222767       residual = 4.87e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941095112003       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941094987949       residual = 3.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941094752155       residual = 2.19e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941094950421       residual = 1.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941095066645       residual = 8.30e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941095147109       residual = 5.82e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941095035172       residual = 2.38e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941094896539       residual = 2.45e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941094935829       residual = 8.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941095177589       residual = 5.97e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941094891490       residual = 2.14e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941094908933       residual = 1.26e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941094823376       residual = 1.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941094857539       residual = 6.51e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941094878580       residual = 9.25e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+07 is 6.127284e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.274617 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7985e+01
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 25
    time step          = 0.05
    reference energy   = -17.2462
    reference variance = 0.40529
====================================================
  Execution time = 2.0031e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s025
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8006e-01
  Total weights = 2.0000e+06
  Execution time = 1.8200e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279994147635
                                         uncertainty =       0.002518952047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279994147635
                                         uncertainty =       0.002518952047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374206296
  error estimate for blocks of size 2^( 2) =       0.000388198950
  error estimate for blocks of size 2^( 3) =       0.000400495261
  error estimate for blocks of size 2^( 4) =       0.000409919754
  error estimate for blocks of size 2^( 5) =       0.000416408773
  error estimate for blocks of size 2^( 6) =       0.000419619470
  error estimate for blocks of size 2^( 7) =       0.000422444149

      target function =      -0.944524757242
              le_mean =     -17.211998144033
             les_mean =     296.532940673483
             stat err =       0.000417098036
             autocorr =       1.242379026324
   target nu stat err =       0.000417098036
   target dn stat err =       0.002572023198
      target stat err =       0.004504626274
              std dev =       0.529207618338
             le_variance =       0.280060703307

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279994147641
                                         uncertainty =       0.002518952048

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279994147641
                                         uncertainty =       0.002518952048

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374206296
  error estimate for blocks of size 2^( 2) =       0.000388198950
  error estimate for blocks of size 2^( 3) =       0.000400495261
  error estimate for blocks of size 2^( 4) =       0.000409919754
  error estimate for blocks of size 2^( 5) =       0.000416408773
  error estimate for blocks of size 2^( 6) =       0.000419619470
  error estimate for blocks of size 2^( 7) =       0.000422444149

      target function =      -0.944524757232
              le_mean =     -17.211998144033
             les_mean =     296.532940673492
             stat err =       0.000417098036
             autocorr =       1.242379026340
   target nu stat err =       0.000417098036
   target dn stat err =       0.002572023198
      target stat err =       0.004504626274
              std dev =       0.529207618344
             le_variance =       0.280060703313

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279994147638
                                         uncertainty =       0.002518952047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279994147638
                                         uncertainty =       0.002518952047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374206296
  error estimate for blocks of size 2^( 2) =       0.000388198950
  error estimate for blocks of size 2^( 3) =       0.000400495261
  error estimate for blocks of size 2^( 4) =       0.000409919754
  error estimate for blocks of size 2^( 5) =       0.000416408773
  error estimate for blocks of size 2^( 6) =       0.000419619470
  error estimate for blocks of size 2^( 7) =       0.000422444149

      target function =      -0.944524757237
              le_mean =     -17.211998144033
             les_mean =     296.532940673488
             stat err =       0.000417098036
             autocorr =       1.242379026338
   target nu stat err =       0.000417098036
   target dn stat err =       0.002572023198
      target stat err =       0.004504626274
              std dev =       0.529207618341
             le_variance =       0.280060703310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279994147635
                                         uncertainty =       0.002518952047

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279994147635
                                         uncertainty =       0.002518952047

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374206296
  error estimate for blocks of size 2^( 2) =       0.000388198950
  error estimate for blocks of size 2^( 3) =       0.000400495261
  error estimate for blocks of size 2^( 4) =       0.000409919754
  error estimate for blocks of size 2^( 5) =       0.000416408773
  error estimate for blocks of size 2^( 6) =       0.000419619470
  error estimate for blocks of size 2^( 7) =       0.000422444149

      target function =      -0.944524757242
              le_mean =     -17.211998144033
             les_mean =     296.532940673484
             stat err =       0.000417098036
             autocorr =       1.242379026305
   target nu stat err =       0.000417098036
   target dn stat err =       0.002572023198
      target stat err =       0.004504626274
              std dev =       0.529207618339
             le_variance =       0.280060703308


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.944524757242        initial  <--
     5.9605e+06     5.9605e+07             9.8045e-11        -0.944524757232
     2.3842e+07     2.3842e+08             2.4511e-11        -0.944524757237
     9.5367e+07     9.5367e+08             6.1273e-12        -0.944524757242

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2665
  </log>
  <optVariables href="H2O.s025.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7258e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s026 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s026 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=26  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2364
    reference variance = 0.303395
====================================================
  Execution time = 2.0347e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s026
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8174e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5733e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281687878736
                                         uncertainty =       0.002946487087

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281687878736
                                         uncertainty =       0.002946487087

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375327721
  error estimate for blocks of size 2^( 2) =       0.000388920533
  error estimate for blocks of size 2^( 3) =       0.000401201954
  error estimate for blocks of size 2^( 4) =       0.000410104325
  error estimate for blocks of size 2^( 5) =       0.000415792797
  error estimate for blocks of size 2^( 6) =       0.000418778351
  error estimate for blocks of size 2^( 7) =       0.000418955212

      target function =      -0.941583776629
              le_mean =     -17.212839861512
             les_mean =     296.563597752903
             stat err =       0.000415907671
             autocorr =       1.227927084945
   target nu stat err =       0.000415907671
   target dn stat err =       0.002890466178
      target stat err =       0.005024094025
              std dev =       0.530793552815
             le_variance =       0.281741795710


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721283986151e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941610047350       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941610047350       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941610047350       residual = 9.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941610047350       residual = 8.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941610047350       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941609982249       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941610047350       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941610047350       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941610108210       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941610047351       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941610013615       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941610022834       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941610020835       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941610065390       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941610028583       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941609947236       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941610134320       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941609974536       residual = 3.37e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941610178144       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941610123873       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941609991739       residual = 1.57e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941609940157       residual = 1.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941609846559       residual = 3.32e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941609994686       residual = 2.71e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+07 is 9.066125e-12

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941610047350       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941610047350       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941610047350       residual = 9.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941610047350       residual = 8.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941610005617       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941609985114       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941610065198       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941609607945       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941610251047       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941609695034       residual = 3.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941610445382       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941609302647       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941610047350       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941610819933       residual = 6.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941610231761       residual = 3.16e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941610074506       residual = 1.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941610504333       residual = 2.40e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941609305707       residual = 3.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941610141770       residual = 2.39e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941609668729       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941610056727       residual = 1.85e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941611491700       residual = 1.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941609915791       residual = 3.29e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941610428511       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+08 is 2.266565e-12

solving harmonic davidson linear method for identity shift 9.5367e+08, overlap shift 9.5367e+09 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941610047350       residual = 1.27e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941610047350       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.941610047350       residual = 9.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.941610047349       residual = 8.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941610047819       residual = 3.77e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.941610047350       residual = 2.46e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941610726344       residual = 3.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.941608883390       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.941608591892       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.941610618982       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.941610590312       residual = 1.96e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.941610886693       residual = 1.56e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.941608595991       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.941612542995       residual = 6.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.941608571103       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.941609739339       residual = 1.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.941609347121       residual = 2.42e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.941609452082       residual = 3.40e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941613246591       residual = 2.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.941604701159       residual = 1.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.941605601658       residual = 9.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.941605173501       residual = 2.52e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.941607930527       residual = 3.85e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.941604233614       residual = 5.26e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.5367e+08 is 5.672996e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.292842 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5949e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 26
    time step          = 0.05
    reference energy   = -17.2472
    reference variance = 0.166537
====================================================
  Execution time = 1.9788e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s026
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7912e-01
  Total weights = 2.0000e+06
  Execution time = 1.8264e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279199637855
                                         uncertainty =       0.001873557766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279199637855
                                         uncertainty =       0.001873557766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373575882
  error estimate for blocks of size 2^( 2) =       0.000387388221
  error estimate for blocks of size 2^( 3) =       0.000399500461
  error estimate for blocks of size 2^( 4) =       0.000408505652
  error estimate for blocks of size 2^( 5) =       0.000414309975
  error estimate for blocks of size 2^( 6) =       0.000416264323
  error estimate for blocks of size 2^( 7) =       0.000416420024

      target function =      -0.946142548787
              le_mean =     -17.212487819211
             les_mean =     296.548854666466
             stat err =       0.000413874993
             autocorr =       1.227384719343
   target nu stat err =       0.000413874993
   target dn stat err =       0.002046632266
      target stat err =       0.003628353421
              std dev =       0.528316079193
             le_variance =       0.279117879534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279199637855
                                         uncertainty =       0.001873557766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279199637855
                                         uncertainty =       0.001873557766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373575882
  error estimate for blocks of size 2^( 2) =       0.000387388221
  error estimate for blocks of size 2^( 3) =       0.000399500461
  error estimate for blocks of size 2^( 4) =       0.000408505652
  error estimate for blocks of size 2^( 5) =       0.000414309975
  error estimate for blocks of size 2^( 6) =       0.000416264323
  error estimate for blocks of size 2^( 7) =       0.000416420024

      target function =      -0.946142548788
              le_mean =     -17.212487819211
             les_mean =     296.548854666464
             stat err =       0.000413874993
             autocorr =       1.227384719342
   target nu stat err =       0.000413874993
   target dn stat err =       0.002046632266
      target stat err =       0.003628353421
              std dev =       0.528316079193
             le_variance =       0.279117879533

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279199637855
                                         uncertainty =       0.001873557766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279199637855
                                         uncertainty =       0.001873557766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373575882
  error estimate for blocks of size 2^( 2) =       0.000387388221
  error estimate for blocks of size 2^( 3) =       0.000399500461
  error estimate for blocks of size 2^( 4) =       0.000408505652
  error estimate for blocks of size 2^( 5) =       0.000414309975
  error estimate for blocks of size 2^( 6) =       0.000416264323
  error estimate for blocks of size 2^( 7) =       0.000416420024

      target function =      -0.946142548787
              le_mean =     -17.212487819211
             les_mean =     296.548854666465
             stat err =       0.000413874993
             autocorr =       1.227384719346
   target nu stat err =       0.000413874993
   target dn stat err =       0.002046632266
      target stat err =       0.003628353421
              std dev =       0.528316079193
             le_variance =       0.279117879534

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279199637855
                                         uncertainty =       0.001873557766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279199637855
                                         uncertainty =       0.001873557766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373575882
  error estimate for blocks of size 2^( 2) =       0.000387388221
  error estimate for blocks of size 2^( 3) =       0.000399500461
  error estimate for blocks of size 2^( 4) =       0.000408505652
  error estimate for blocks of size 2^( 5) =       0.000414309975
  error estimate for blocks of size 2^( 6) =       0.000416264323
  error estimate for blocks of size 2^( 7) =       0.000416420024

      target function =      -0.946142548787
              le_mean =     -17.212487819211
             les_mean =     296.548854666466
             stat err =       0.000413874993
             autocorr =       1.227384719337
   target nu stat err =       0.000413874993
   target dn stat err =       0.002046632266
      target stat err =       0.003628353421
              std dev =       0.528316079193
             le_variance =       0.279117879534


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946142548787        initial
     5.9605e+07     5.9605e+08             9.0661e-12        -0.946142548788  <--
     2.3842e+08     2.3842e+09             2.2666e-12        -0.946142548787
     9.5367e+08     9.5367e+09             5.6730e-13        -0.946142548787

*****************************************************************************
Applying the update for shift_i =   5.9605e+07     and shift_s =   5.9605e+08
*****************************************************************************

  Execution time = 2.9047e+01
  </log>
  <optVariables href="H2O.s026.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5002e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s027 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s027 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=27  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1937
    reference variance = 0.265207
====================================================
  Execution time = 2.0140e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s027
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7915e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.7830e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279155083686
                                         uncertainty =       0.002547728766

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279155083686
                                         uncertainty =       0.002547728766

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373596209
  error estimate for blocks of size 2^( 2) =       0.000387068237
  error estimate for blocks of size 2^( 3) =       0.000399344323
  error estimate for blocks of size 2^( 4) =       0.000408402522
  error estimate for blocks of size 2^( 5) =       0.000414158742
  error estimate for blocks of size 2^( 6) =       0.000416255449
  error estimate for blocks of size 2^( 7) =       0.000419972170

      target function =      -0.946095400976
              le_mean =     -17.212174498942
             les_mean =     296.538099097765
             stat err =       0.000414697221
             autocorr =       1.232132257082
   target nu stat err =       0.000414697221
   target dn stat err =       0.002542459006
      target stat err =       0.004469723731
              std dev =       0.528344826144
             le_variance =       0.279148255313


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721217449894e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+07, overlap shift 1.4901e+08 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946115644999       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946115645001       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946115645001       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946115645002       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946115641142       residual = 6.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946115643488       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946115650230       residual = 4.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946115662051       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946115613288       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946115688447       residual = 3.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946115652623       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946115656440       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946115642102       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946115665047       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946115648938       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946115661020       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946115640107       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946115640116       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946115633750       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946115674853       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946115653116       residual = 2.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946115680368       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946115606655       residual = 3.53e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946115595402       residual = 8.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+07 is 4.813069e-11

solving harmonic davidson linear method for identity shift 5.9605e+07, overlap shift 5.9605e+08 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946115644999       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946115644999       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946115644999       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946115644999       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946115645040       residual = 6.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946115619506       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946115691836       residual = 4.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946115590293       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946115602505       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946115647230       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946115639991       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946115582081       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946115739402       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946115469635       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946115471731       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946115540950       residual = 2.72e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946115648069       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946115694209       residual = 3.71e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946115652741       residual = 5.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946115480108       residual = 1.63e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946115486674       residual = 2.22e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946115645942       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946115551324       residual = 3.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946115455970       residual = 8.36e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+07 is 1.203155e-11

solving harmonic davidson linear method for identity shift 2.3842e+08, overlap shift 2.3842e+09 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946115644999       residual = 1.42e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946115644999       residual = 1.62e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946115644999       residual = 1.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946115644999       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946115644671       residual = 6.09e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946115577269       residual = 5.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946115500584       residual = 4.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946115365786       residual = 1.58e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946116049521       residual = 3.63e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946115606660       residual = 3.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946115698772       residual = 3.47e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946115761093       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946115509926       residual = 1.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946115875298       residual = 7.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946116290589       residual = 3.68e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946114864690       residual = 2.71e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946115838343       residual = 4.86e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946116475565       residual = 3.68e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946115669305       residual = 5.38e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946115247116       residual = 1.64e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946115296095       residual = 2.20e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946114947819       residual = 1.09e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946115482842       residual = 3.57e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946115864837       residual = 8.20e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+08 is 3.007720e-12

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.310983 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5953e+01
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 27
    time step          = 0.05
    reference energy   = -17.1579
    reference variance = 0.189762
====================================================
  Execution time = 2.0027e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s027
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7874e-01
  Total weights = 2.0000e+06
  Execution time = 1.8217e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278762050570
                                         uncertainty =       0.003137390639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278762050570
                                         uncertainty =       0.003137390639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373321474
  error estimate for blocks of size 2^( 2) =       0.000386733221
  error estimate for blocks of size 2^( 3) =       0.000399238666
  error estimate for blocks of size 2^( 4) =       0.000408130765
  error estimate for blocks of size 2^( 5) =       0.000414290979
  error estimate for blocks of size 2^( 6) =       0.000417251451
  error estimate for blocks of size 2^( 7) =       0.000421259704

      target function =      -0.946793567315
              le_mean =     -17.212194333235
             les_mean =     296.538371472244
             stat err =       0.000415233225
             autocorr =       1.237138286251
   target nu stat err =       0.000415233225
   target dn stat err =       0.003236817369
      target stat err =       0.005667589149
              std dev =       0.527956292300
             le_variance =       0.278737846579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278762050571
                                         uncertainty =       0.003137390639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278762050571
                                         uncertainty =       0.003137390639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373321474
  error estimate for blocks of size 2^( 2) =       0.000386733221
  error estimate for blocks of size 2^( 3) =       0.000399238666
  error estimate for blocks of size 2^( 4) =       0.000408130765
  error estimate for blocks of size 2^( 5) =       0.000414290979
  error estimate for blocks of size 2^( 6) =       0.000417251451
  error estimate for blocks of size 2^( 7) =       0.000421259704

      target function =      -0.946793567313
              le_mean =     -17.212194333235
             les_mean =     296.538371472246
             stat err =       0.000415233225
             autocorr =       1.237138286268
   target nu stat err =       0.000415233225
   target dn stat err =       0.003236817369
      target stat err =       0.005667589149
              std dev =       0.527956292301
             le_variance =       0.278737846580

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278762050571
                                         uncertainty =       0.003137390639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278762050571
                                         uncertainty =       0.003137390639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373321474
  error estimate for blocks of size 2^( 2) =       0.000386733221
  error estimate for blocks of size 2^( 3) =       0.000399238666
  error estimate for blocks of size 2^( 4) =       0.000408130765
  error estimate for blocks of size 2^( 5) =       0.000414290979
  error estimate for blocks of size 2^( 6) =       0.000417251451
  error estimate for blocks of size 2^( 7) =       0.000421259704

      target function =      -0.946793567314
              le_mean =     -17.212194333235
             les_mean =     296.538371472245
             stat err =       0.000415233225
             autocorr =       1.237138286267
   target nu stat err =       0.000415233225
   target dn stat err =       0.003236817369
      target stat err =       0.005667589149
              std dev =       0.527956292300
             le_variance =       0.278737846579

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278762050570
                                         uncertainty =       0.003137390639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278762050570
                                         uncertainty =       0.003137390639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373321474
  error estimate for blocks of size 2^( 2) =       0.000386733221
  error estimate for blocks of size 2^( 3) =       0.000399238666
  error estimate for blocks of size 2^( 4) =       0.000408130765
  error estimate for blocks of size 2^( 5) =       0.000414290979
  error estimate for blocks of size 2^( 6) =       0.000417251451
  error estimate for blocks of size 2^( 7) =       0.000421259704

      target function =      -0.946793567315
              le_mean =     -17.212194333235
             les_mean =     296.538371472244
             stat err =       0.000415233225
             autocorr =       1.237138286246
   target nu stat err =       0.000415233225
   target dn stat err =       0.003236817369
      target stat err =       0.005667589149
              std dev =       0.527956292300
             le_variance =       0.278737846579


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.946793567315        initial  <--
     1.4901e+07     1.4901e+08             4.8131e-11        -0.946793567313
     5.9605e+07     5.9605e+08             1.2032e-11        -0.946793567314
     2.3842e+08     2.3842e+09             3.0077e-12        -0.946793567315

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2582
  </log>
  <optVariables href="H2O.s027.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5217e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s028 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s028 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=28  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.2192
    reference variance = 0.344269
====================================================
  Execution time = 2.2383e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s028
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7751e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5352e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277499238137
                                         uncertainty =       0.002224538639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277499238137
                                         uncertainty =       0.002224538639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372496026
  error estimate for blocks of size 2^( 2) =       0.000386009574
  error estimate for blocks of size 2^( 3) =       0.000398642570
  error estimate for blocks of size 2^( 4) =       0.000407806004
  error estimate for blocks of size 2^( 5) =       0.000414683785
  error estimate for blocks of size 2^( 6) =       0.000417620998
  error estimate for blocks of size 2^( 7) =       0.000419698488

      target function =      -0.948958879582
              le_mean =     -17.212008576971
             les_mean =     296.530745693608
             stat err =       0.000414952319
             autocorr =       1.240946629962
   target nu stat err =       0.000414952319
   target dn stat err =       0.002240985207
      target stat err =       0.003978349605
              std dev =       0.526788931766
             le_variance =       0.277506578631


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721200857697e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948974304713       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948974304713       residual = 7.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948974304713       residual = 7.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948974310851       residual = 6.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948974248175       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948974304713       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948974256828       residual = 7.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948974274478       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948974260823       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948974448631       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948974194183       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.948974309802       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.948974422562       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.948974300491       residual = 7.06e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.948973992967       residual = 3.92e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.948974478731       residual = 2.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.948974195464       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.948974040035       residual = 4.02e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.948974397333       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.948974297356       residual = 1.24e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.948973837994       residual = 1.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948974634870       residual = 8.62e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.948974573025       residual = 3.71e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.948974348946       residual = 3.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+08 is 3.568570e-12

solving harmonic davidson linear method for identity shift 5.9605e+08, overlap shift 5.9605e+09 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948974304713       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948974304713       residual = 7.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948974304713       residual = 7.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948974304713       residual = 6.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948974147565       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948974290881       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948974771004       residual = 7.33e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948974845357       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948975159619       residual = 1.90e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948974795909       residual = 2.28e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948973651796       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.948971573104       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.948974047665       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.948976010101       residual = 7.08e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.948974018279       residual = 3.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.948972466455       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.948974210328       residual = 3.46e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.948974767166       residual = 3.96e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.948973231250       residual = 3.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.948976328169       residual = 1.25e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.948973873845       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948974054366       residual = 8.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.948975779835       residual = 3.76e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.948972139202       residual = 5.38e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+08 is 8.919230e-13

solving harmonic davidson linear method for identity shift 2.3842e+09, overlap shift 2.3842e+10 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948974304713       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948974304713       residual = 7.29e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948974304713       residual = 7.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948974304713       residual = 6.52e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.948974304748       residual = 2.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.948976532746       residual = 2.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.948976931298       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.948971643530       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.948975084870       residual = 1.89e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.948971738150       residual = 2.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.948970197462       residual = 1.66e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.948975256548       residual = 1.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.948972204770       residual = 1.07e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.948975559851       residual = 7.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.948974355180       residual = 3.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.948969782170       residual = 2.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.948966798021       residual = 3.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.948981431505       residual = 4.18e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.948978864965       residual = 3.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.948973534389       residual = 1.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.948975018931       residual = 1.65e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948971013945       residual = 8.12e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.948966090857       residual = 4.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.948976010624       residual = 5.09e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 2.3842e+09 is 2.233189e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.329247 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7950e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 28
    time step          = 0.05
    reference energy   = -17.1241
    reference variance = 0.376065
====================================================
  Execution time = 1.9862e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s028
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7721e-01
  Total weights = 2.0000e+06
  Execution time = 1.8200e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277171733458
                                         uncertainty =       0.002486244948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277171733458
                                         uncertainty =       0.002486244948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372293890
  error estimate for blocks of size 2^( 2) =       0.000385829577
  error estimate for blocks of size 2^( 3) =       0.000398112630
  error estimate for blocks of size 2^( 4) =       0.000407209686
  error estimate for blocks of size 2^( 5) =       0.000412638256
  error estimate for blocks of size 2^( 6) =       0.000416484178
  error estimate for blocks of size 2^( 7) =       0.000418979474

      target function =      -0.949470330820
              le_mean =     -17.212319830423
             les_mean =     296.541159286916
             stat err =       0.000413827898
             autocorr =       1.235571021359
   target nu stat err =       0.000413827898
   target dn stat err =       0.002409659468
      target stat err =       0.004273925629
              std dev =       0.526503068134
             le_variance =       0.277205480754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277171733458
                                         uncertainty =       0.002486244948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277171733458
                                         uncertainty =       0.002486244948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372293890
  error estimate for blocks of size 2^( 2) =       0.000385829577
  error estimate for blocks of size 2^( 3) =       0.000398112630
  error estimate for blocks of size 2^( 4) =       0.000407209686
  error estimate for blocks of size 2^( 5) =       0.000412638256
  error estimate for blocks of size 2^( 6) =       0.000416484178
  error estimate for blocks of size 2^( 7) =       0.000418979474

      target function =      -0.949470330820
              le_mean =     -17.212319830423
             les_mean =     296.541159286916
             stat err =       0.000413827898
             autocorr =       1.235571021358
   target nu stat err =       0.000413827898
   target dn stat err =       0.002409659468
      target stat err =       0.004273925629
              std dev =       0.526503068134
             le_variance =       0.277205480754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277171733458
                                         uncertainty =       0.002486244948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277171733458
                                         uncertainty =       0.002486244948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372293890
  error estimate for blocks of size 2^( 2) =       0.000385829577
  error estimate for blocks of size 2^( 3) =       0.000398112630
  error estimate for blocks of size 2^( 4) =       0.000407209686
  error estimate for blocks of size 2^( 5) =       0.000412638256
  error estimate for blocks of size 2^( 6) =       0.000416484178
  error estimate for blocks of size 2^( 7) =       0.000418979474

      target function =      -0.949470330820
              le_mean =     -17.212319830423
             les_mean =     296.541159286916
             stat err =       0.000413827898
             autocorr =       1.235571021362
   target nu stat err =       0.000413827898
   target dn stat err =       0.002409659468
      target stat err =       0.004273925629
              std dev =       0.526503068134
             le_variance =       0.277205480754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277171733458
                                         uncertainty =       0.002486244948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277171733458
                                         uncertainty =       0.002486244948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372293890
  error estimate for blocks of size 2^( 2) =       0.000385829577
  error estimate for blocks of size 2^( 3) =       0.000398112630
  error estimate for blocks of size 2^( 4) =       0.000407209686
  error estimate for blocks of size 2^( 5) =       0.000412638256
  error estimate for blocks of size 2^( 6) =       0.000416484178
  error estimate for blocks of size 2^( 7) =       0.000418979474

      target function =      -0.949470330820
              le_mean =     -17.212319830423
             les_mean =     296.541159286916
             stat err =       0.000413827898
             autocorr =       1.235571021361
   target nu stat err =       0.000413827898
   target dn stat err =       0.002409659468
      target stat err =       0.004273925629
              std dev =       0.526503068134
             le_variance =       0.277205480754


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949470330820        initial
     1.4901e+08     1.4901e+09             3.5686e-12        -0.949470330820  <--
     5.9605e+08     5.9605e+09             8.9192e-13        -0.949470330820
     2.3842e+09     2.3842e+10             2.2332e-13        -0.949470330820

*****************************************************************************
Applying the update for shift_i =   1.4901e+08     and shift_s =   1.4901e+09
*****************************************************************************

  Execution time = 2.9216e+01
  </log>
  <optVariables href="H2O.s028.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7173e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s029 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s029 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=29  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1898
    reference variance = 0.176756
====================================================
  Execution time = 2.0304e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s029
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7875e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5100e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278799123477
                                         uncertainty =       0.003099191297

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278799123477
                                         uncertainty =       0.003099191297

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373329377
  error estimate for blocks of size 2^( 2) =       0.000387197659
  error estimate for blocks of size 2^( 3) =       0.000399923375
  error estimate for blocks of size 2^( 4) =       0.000409321050
  error estimate for blocks of size 2^( 5) =       0.000414918032
  error estimate for blocks of size 2^( 6) =       0.000418678251
  error estimate for blocks of size 2^( 7) =       0.000418323531

      target function =      -0.946792665399
              le_mean =     -17.211760171800
             les_mean =     296.523437719448
             stat err =       0.000415310216
             autocorr =       1.237544708663
   target nu stat err =       0.000415310216
   target dn stat err =       0.003102035171
      target stat err =       0.005431363911
              std dev =       0.527967468010
             le_variance =       0.278749647277


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721176017180e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+07, overlap shift 3.7253e+08 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946822853794       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946822853795       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946822853795       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946822866033       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946822851697       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946822835058       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946822860252       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946822819359       residual = 9.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946822746792       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946822831897       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946822801410       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946822856867       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946822920477       residual = 9.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946822802545       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946822875061       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946822798822       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946822874432       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946822907499       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946822709843       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946822832363       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946822760557       residual = 5.94e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946822778389       residual = 9.00e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946822917819       residual = 3.65e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946822839585       residual = 2.68e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+07 is 1.302947e-11

solving harmonic davidson linear method for identity shift 1.4901e+08, overlap shift 1.4901e+09 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946822853794       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946822853794       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946822853794       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946822853795       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946822818842       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946822807622       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946823111377       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946822853794       residual = 9.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946822869040       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946822953478       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946822983436       residual = 1.54e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946822731705       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946822739012       residual = 9.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946822886207       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946823104207       residual = 3.62e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946822775582       residual = 2.01e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946822890654       residual = 2.15e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946822613922       residual = 4.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946822960384       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946822882550       residual = 1.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946822200374       residual = 5.91e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946823147489       residual = 8.97e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946822553992       residual = 3.67e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946822760529       residual = 2.66e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+08 is 3.256326e-12

solving harmonic davidson linear method for identity shift 5.9605e+08, overlap shift 5.9605e+09 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946822853794       residual = 1.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946822853794       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946822853794       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.946822543036       residual = 1.26e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.946822853794       residual = 4.84e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.946823089207       residual = 3.15e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.946823533327       residual = 4.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.946822749387       residual = 9.01e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.946823110062       residual = 3.75e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.946822288367       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946822600561       residual = 1.55e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.946823249200       residual = 1.44e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.946823322582       residual = 9.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946823255270       residual = 5.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.946822236707       residual = 3.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.946822444343       residual = 2.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946824316764       residual = 2.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.946822393074       residual = 4.10e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.946822750831       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.946822574721       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.946823747470       residual = 5.83e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.946824092027       residual = 9.31e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.946823233342       residual = 3.61e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.946822842870       residual = 2.92e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+08 is 8.146963e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.347470 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5843e+01
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 29
    time step          = 0.05
    reference energy   = -17.1217
    reference variance = 0.258223
====================================================
  Execution time = 1.9699e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s029
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8261e-01
  Total weights = 2.0000e+06
  Execution time = 1.8201e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282642954517
                                         uncertainty =       0.004254204702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282642954517
                                         uncertainty =       0.004254204702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375907566
  error estimate for blocks of size 2^( 2) =       0.000389198540
  error estimate for blocks of size 2^( 3) =       0.000401643638
  error estimate for blocks of size 2^( 4) =       0.000410581790
  error estimate for blocks of size 2^( 5) =       0.000416638619
  error estimate for blocks of size 2^( 6) =       0.000419475300
  error estimate for blocks of size 2^( 7) =       0.000420325966

      target function =      -0.940112873705
              le_mean =     -17.211812240845
             les_mean =     296.529093468873
             stat err =       0.000416755419
             autocorr =       1.229137240359
   target nu stat err =       0.000416755419
   target dn stat err =       0.004295830600
      target stat err =       0.007382721402
              std dev =       0.531613577789
             le_variance =       0.282612996089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282642954517
                                         uncertainty =       0.004254204702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282642954517
                                         uncertainty =       0.004254204702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375907566
  error estimate for blocks of size 2^( 2) =       0.000389198540
  error estimate for blocks of size 2^( 3) =       0.000401643638
  error estimate for blocks of size 2^( 4) =       0.000410581790
  error estimate for blocks of size 2^( 5) =       0.000416638619
  error estimate for blocks of size 2^( 6) =       0.000419475300
  error estimate for blocks of size 2^( 7) =       0.000420325966

      target function =      -0.940112873704
              le_mean =     -17.211812240845
             les_mean =     296.529093468873
             stat err =       0.000416755419
             autocorr =       1.229137240360
   target nu stat err =       0.000416755419
   target dn stat err =       0.004295830601
      target stat err =       0.007382721403
              std dev =       0.531613577789
             le_variance =       0.282612996089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282642954517
                                         uncertainty =       0.004254204702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282642954517
                                         uncertainty =       0.004254204702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375907566
  error estimate for blocks of size 2^( 2) =       0.000389198540
  error estimate for blocks of size 2^( 3) =       0.000401643638
  error estimate for blocks of size 2^( 4) =       0.000410581790
  error estimate for blocks of size 2^( 5) =       0.000416638619
  error estimate for blocks of size 2^( 6) =       0.000419475300
  error estimate for blocks of size 2^( 7) =       0.000420325966

      target function =      -0.940112873704
              le_mean =     -17.211812240845
             les_mean =     296.529093468873
             stat err =       0.000416755419
             autocorr =       1.229137240348
   target nu stat err =       0.000416755419
   target dn stat err =       0.004295830600
      target stat err =       0.007382721402
              std dev =       0.531613577789
             le_variance =       0.282612996089

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282642954517
                                         uncertainty =       0.004254204702

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282642954517
                                         uncertainty =       0.004254204702

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375907566
  error estimate for blocks of size 2^( 2) =       0.000389198540
  error estimate for blocks of size 2^( 3) =       0.000401643638
  error estimate for blocks of size 2^( 4) =       0.000410581790
  error estimate for blocks of size 2^( 5) =       0.000416638619
  error estimate for blocks of size 2^( 6) =       0.000419475300
  error estimate for blocks of size 2^( 7) =       0.000420325966

      target function =      -0.940112873705
              le_mean =     -17.211812240845
             les_mean =     296.529093468873
             stat err =       0.000416755419
             autocorr =       1.229137240353
   target nu stat err =       0.000416755419
   target dn stat err =       0.004295830600
      target stat err =       0.007382721402
              std dev =       0.531613577789
             le_variance =       0.282612996089


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940112873705        initial  <--
     3.7253e+07     3.7253e+08             1.3029e-11        -0.940112873704
     1.4901e+08     1.4901e+09             3.2563e-12        -0.940112873704
     5.9605e+08     5.9605e+09             8.1470e-13        -0.940112873705

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9236
  </log>
  <optVariables href="H2O.s029.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4773e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s030 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s030 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=30  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7199e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.1998
    reference variance = 0.186731
====================================================
  Execution time = 2.0551e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s030
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8380e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5235e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283879361349
                                         uncertainty =       0.004007397668

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283879361349
                                         uncertainty =       0.004007397668

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376699343
  error estimate for blocks of size 2^( 2) =       0.000390119540
  error estimate for blocks of size 2^( 3) =       0.000402254220
  error estimate for blocks of size 2^( 4) =       0.000411349214
  error estimate for blocks of size 2^( 5) =       0.000415987523
  error estimate for blocks of size 2^( 6) =       0.000419262001
  error estimate for blocks of size 2^( 7) =       0.000421735520

      target function =      -0.938107785800
              le_mean =     -17.211553447024
             les_mean =     296.521376708184
             stat err =       0.000417083564
             autocorr =       1.225903900544
   target nu stat err =       0.000417083564
   target dn stat err =       0.003715721985
      target stat err =       0.006366795956
              std dev =       0.532733320084
             le_variance =       0.283804790328


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721155344702e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+08, overlap shift 3.7253e+09 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938150176709       residual = 1.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938150176709       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938150176709       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938150165450       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938150176709       residual = 6.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938150176709       residual = 5.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938149216438       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938150087602       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938149957787       residual = 5.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938150013035       residual = 3.71e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938150149209       residual = 4.35e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938149510483       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938149979615       residual = 1.67e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.938150784662       residual = 1.01e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938151246159       residual = 5.98e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938151415098       residual = 4.09e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938150096209       residual = 5.73e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.938149537504       residual = 9.23e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938149902942       residual = 6.19e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.938149568836       residual = 3.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.938149251634       residual = 3.72e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.938150006211       residual = 1.27e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938149553266       residual = 1.74e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938150019937       residual = 7.98e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         23 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+08 is 1.736565e-12

solving harmonic davidson linear method for identity shift 1.4901e+09, overlap shift 1.4901e+10 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938150176709       residual = 1.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938150176709       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938150176709       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938150176709       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938150176709       residual = 6.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938150176709       residual = 5.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938150734224       residual = 6.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938150176709       residual = 1.79e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938153720590       residual = 5.43e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938147836003       residual = 3.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938151775604       residual = 4.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938150467643       residual = 2.82e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938153932053       residual = 1.68e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.938146976372       residual = 9.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938149397801       residual = 5.99e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938152126420       residual = 4.07e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938151568854       residual = 5.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.938148286642       residual = 9.28e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938145442651       residual = 6.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.938148594664       residual = 3.17e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.938151456881       residual = 3.79e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.938151957648       residual = 1.34e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938153142513       residual = 1.73e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938146696306       residual = 1.09e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.938154147036       residual = 6.17e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         24 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+09 is 4.336641e-13

solving harmonic davidson linear method for identity shift 5.9605e+09, overlap shift 5.9605e+10 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.938150176709       residual = 1.75e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.938150176709       residual = 1.71e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.938150176709       residual = 2.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.938150176709       residual = 1.55e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.938152008849       residual = 6.60e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.938142440091       residual = 5.44e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.938148640035       residual = 6.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.938155980889       residual = 1.80e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.938149937067       residual = 5.44e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.938155784088       residual = 3.72e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.938118145119       residual = 4.45e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.938151997040       residual = 2.81e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.938148323055       residual = 1.70e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.938144459856       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.938139432684       residual = 6.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938144322157       residual = 4.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.938160947417       residual = 5.91e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.938144046501       residual = 9.36e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.938165576295       residual = 6.90e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.938146919635       residual = 3.35e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.938153337486       residual = 4.11e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.938164263731       residual = 2.08e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.938155941029       residual = 3.34e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.938163716842       residual = 2.42e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.938135222348       residual = 7.16e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.938109368100       residual = 1.50e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.938150926901       residual = 8.00e-09           smallest_sin_value = 1.00e+00
davidson solver converged in         26 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+09 is 1.081797e-13

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.368185 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6109e+01
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 30
    time step          = 0.05
    reference energy   = -17.205
    reference variance = 0.171019
====================================================
  Execution time = 2.2018e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s030
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7650e-01
  Total weights = 2.0000e+06
  Execution time = 1.8198e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276424493131
                                         uncertainty =       0.001965468148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276424493131
                                         uncertainty =       0.001965468148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371821289
  error estimate for blocks of size 2^( 2) =       0.000385364518
  error estimate for blocks of size 2^( 3) =       0.000397754387
  error estimate for blocks of size 2^( 4) =       0.000406848947
  error estimate for blocks of size 2^( 5) =       0.000411814583
  error estimate for blocks of size 2^( 6) =       0.000415520296
  error estimate for blocks of size 2^( 7) =       0.000417366975

      target function =      -0.950709190044
              le_mean =     -17.212210336484
             les_mean =     296.536686671665
             stat err =       0.000412887700
             autocorr =       1.233091733199
   target nu stat err =       0.000412887700
   target dn stat err =       0.001968118449
      target stat err =       0.003526094135
              std dev =       0.525834710303
             le_variance =       0.276502142559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276424493131
                                         uncertainty =       0.001965468148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276424493131
                                         uncertainty =       0.001965468148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371821289
  error estimate for blocks of size 2^( 2) =       0.000385364518
  error estimate for blocks of size 2^( 3) =       0.000397754387
  error estimate for blocks of size 2^( 4) =       0.000406848947
  error estimate for blocks of size 2^( 5) =       0.000411814583
  error estimate for blocks of size 2^( 6) =       0.000415520296
  error estimate for blocks of size 2^( 7) =       0.000417366975

      target function =      -0.950709190044
              le_mean =     -17.212210336484
             les_mean =     296.536686671665
             stat err =       0.000412887700
             autocorr =       1.233091733197
   target nu stat err =       0.000412887700
   target dn stat err =       0.001968118449
      target stat err =       0.003526094135
              std dev =       0.525834710303
             le_variance =       0.276502142559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276424493131
                                         uncertainty =       0.001965468148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276424493131
                                         uncertainty =       0.001965468148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371821289
  error estimate for blocks of size 2^( 2) =       0.000385364518
  error estimate for blocks of size 2^( 3) =       0.000397754387
  error estimate for blocks of size 2^( 4) =       0.000406848947
  error estimate for blocks of size 2^( 5) =       0.000411814583
  error estimate for blocks of size 2^( 6) =       0.000415520296
  error estimate for blocks of size 2^( 7) =       0.000417366975

      target function =      -0.950709190044
              le_mean =     -17.212210336484
             les_mean =     296.536686671665
             stat err =       0.000412887700
             autocorr =       1.233091733196
   target nu stat err =       0.000412887700
   target dn stat err =       0.001968118449
      target stat err =       0.003526094135
              std dev =       0.525834710302
             le_variance =       0.276502142559

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276424493131
                                         uncertainty =       0.001965468148

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276424493131
                                         uncertainty =       0.001965468148

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371821289
  error estimate for blocks of size 2^( 2) =       0.000385364518
  error estimate for blocks of size 2^( 3) =       0.000397754387
  error estimate for blocks of size 2^( 4) =       0.000406848947
  error estimate for blocks of size 2^( 5) =       0.000411814583
  error estimate for blocks of size 2^( 6) =       0.000415520296
  error estimate for blocks of size 2^( 7) =       0.000417366975

      target function =      -0.950709190044
              le_mean =     -17.212210336484
             les_mean =     296.536686671665
             stat err =       0.000412887700
             autocorr =       1.233091733192
   target nu stat err =       0.000412887700
   target dn stat err =       0.001968118449
      target stat err =       0.003526094135
              std dev =       0.525834710302
             le_variance =       0.276502142559


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.950709190044        initial  <--
     3.7253e+08     3.7253e+09             1.7366e-12        -0.950709190044
     1.4901e+09     1.4901e+10             4.3366e-13        -0.950709190044
     5.9605e+09     5.9605e+10             1.0818e-13        -0.950709190044

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.2171
  </log>
  <optVariables href="H2O.s030.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7332e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s031 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s031 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=31  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7199e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.2045
    reference variance = 0.261229
====================================================
  Execution time = 2.0248e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s031
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7607e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4974e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276162736125
                                         uncertainty =       0.001963112732

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276162736125
                                         uncertainty =       0.001963112732

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371533269
  error estimate for blocks of size 2^( 2) =       0.000385325940
  error estimate for blocks of size 2^( 3) =       0.000397757259
  error estimate for blocks of size 2^( 4) =       0.000406385099
  error estimate for blocks of size 2^( 5) =       0.000411825823
  error estimate for blocks of size 2^( 6) =       0.000413786876
  error estimate for blocks of size 2^( 7) =       0.000415342946

      target function =      -0.951448581561
              le_mean =     -17.212462642469
             les_mean =     296.544944019738
             stat err =       0.000411835186
             autocorr =       1.228715906506
   target nu stat err =       0.000411835186
   target dn stat err =       0.002149064720
      target stat err =       0.003843187730
              std dev =       0.525427387356
             le_variance =       0.276073939384


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721246264247e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+09, overlap shift 3.7253e+10 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951463016337       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951463016337       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951463016337       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.951463016337       residual = 8.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.951463016337       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.951463016337       residual = 2.51e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.951463016337       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.951463016337       residual = 9.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.951463016337       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.951463016337       residual = 8.61e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.951463016337       residual = 8.90e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.951463016337       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.951463016337       residual = 1.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.951463016337       residual = 3.05e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.951471312310       residual = 2.53e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.951455526527       residual = 2.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.951462505953       residual = 1.12e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.951453404954       residual = 6.66e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.951457638757       residual = 2.33e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.951461930783       residual = 1.41e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.951455252413       residual = 9.66e-08           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.951465731121       residual = 6.54e-08           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.951463646092       residual = 2.95e-08           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.951464284666       residual = 1.26e-08           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.951462411179       residual = 1.43e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.951443236004       residual = 4.36e-08           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.951455610277       residual = 1.04e-08           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.951491265574       residual = 8.41e-08           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.951505035692       residual = 1.67e-07           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.951458919924       residual = 4.05e-08           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.951336013911       residual = 1.43e-06           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.951377720912       residual = 6.88e-07           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.951401679697       residual = 3.04e-07           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.951658089969       residual = 3.97e-06           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.951734229313       residual = 6.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.951704245001       residual = 8.22e-06           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.951490117483       residual = 7.02e-06           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.951750974706       residual = 2.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.952935118908       residual = 2.84e-04           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.952033306172       residual = 2.98e-04           smallest_sin_value = 9.98e-01
davidson iteration   40 stopping due to small subspace S singular value of 9.64e-01
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+09 is 1.312814e-13

solving harmonic davidson linear method for identity shift 1.4901e+10, overlap shift 1.4901e+11 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951463016337       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951463016337       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951463016337       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.951463016337       residual = 8.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.951463016337       residual = 2.34e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.951463016337       residual = 2.47e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.951463016337       residual = 1.10e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.951463016337       residual = 9.62e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.951457737232       residual = 2.00e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.951495544211       residual = 9.10e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.951471197945       residual = 9.03e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.951445886465       residual = 1.38e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.951446289227       residual = 1.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.951447826131       residual = 3.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.951433687354       residual = 2.49e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.951456056365       residual = 2.13e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.951483062233       residual = 1.29e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.951468718230       residual = 5.42e-07           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.951480635025       residual = 3.07e-07           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.951467441923       residual = 4.06e-07           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.951501669845       residual = 3.93e-07           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.951488231746       residual = 3.56e-07           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.951453290582       residual = 1.05e-07           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.951417286132       residual = 2.01e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.951484710116       residual = 7.15e-08           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.951565715144       residual = 9.15e-07           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.951374285179       residual = 7.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.951439198363       residual = 3.91e-07           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.951333538297       residual = 2.34e-06           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.951334330545       residual = 1.50e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.951429033178       residual = 3.46e-07           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.951462373497       residual = 1.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.951489456983       residual = 9.95e-06           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.950332275633       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.954517172081       residual = 8.55e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.952106046540       residual = 9.36e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.950672819333       residual = 2.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.949448914022       residual = 2.99e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.954282669958       residual = 3.27e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.952256465186       residual = 1.22e-04           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.945849790106       residual = 3.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   41:   krylov dim =  42   tar_fn =      -0.951077401764       residual = 9.57e-04           smallest_sin_value = 9.92e-01
davidson iteration   42 stopping due to small subspace S singular value of 6.53e-01
davidson solver did not converge after         42 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+10 is 3.262619e-14

solving harmonic davidson linear method for identity shift 5.9605e+10, overlap shift 5.9605e+11 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.951463016337       residual = 1.28e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.951463016337       residual = 1.13e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.951463016337       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.951463016337       residual = 8.90e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.951527700561       residual = 2.40e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.951463016337       residual = 2.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.951475053027       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.951401567849       residual = 1.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.951599034594       residual = 2.24e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.951463016337       residual = 8.00e-06           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.951472453875       residual = 9.11e-06           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.951349036413       residual = 1.25e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.951514657134       residual = 9.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.951441930270       residual = 5.80e-06           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.951465995693       residual = 3.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.951540285618       residual = 2.37e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.951096251393       residual = 1.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.951381575177       residual = 2.88e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.951326272899       residual = 2.31e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.951390041856       residual = 1.27e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.951620833933       residual = 2.94e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.952058666901       residual = 2.75e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.951630591546       residual = 2.93e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.951402015885       residual = 4.60e-07           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.952037577190       residual = 3.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.950826763447       residual = 3.90e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.950918656112       residual = 3.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.952290273858       residual = 1.07e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.950798704667       residual = 3.74e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.951122847421       residual = 1.43e-05           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.951068724392       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.950161986016       residual = 2.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.949703441719       residual = 3.73e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.949069068387       residual = 2.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.946234112885       residual = 2.54e-03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.948031067962       residual = 2.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.977116698412       residual = 6.14e-02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.939609922831       residual = 1.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.968596590977       residual = 3.23e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.953599069111       residual = 3.48e-03           smallest_sin_value = 9.91e-01
davidson iteration   40 stopping due to small subspace S singular value of 7.46e-01
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+10 is 8.330283e-15

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.448970 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5837e+01
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 31
    time step          = 0.05
    reference energy   = -17.1878
    reference variance = 0.21352
====================================================
  Execution time = 2.0087e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s031
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8335e-01
  Total weights = 2.0000e+06
  Execution time = 1.8151e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283443263469
                                         uncertainty =       0.003808070733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283443263469
                                         uncertainty =       0.003808070733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376396516
  error estimate for blocks of size 2^( 2) =       0.000390301618
  error estimate for blocks of size 2^( 3) =       0.000402470226
  error estimate for blocks of size 2^( 4) =       0.000411660341
  error estimate for blocks of size 2^( 5) =       0.000416836150
  error estimate for blocks of size 2^( 6) =       0.000419372773
  error estimate for blocks of size 2^( 7) =       0.000420949449

      target function =      -0.938857685707
              le_mean =     -17.212003040721
             les_mean =     296.536397207083
             stat err =       0.000417204678
             autocorr =       1.228590489100
   target nu stat err =       0.000417204678
   target dn stat err =       0.003823536187
      target stat err =       0.006565118586
              std dev =       0.532305058184
             le_variance =       0.283348674968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283443263469
                                         uncertainty =       0.003808070733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283443263469
                                         uncertainty =       0.003808070733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376396516
  error estimate for blocks of size 2^( 2) =       0.000390301618
  error estimate for blocks of size 2^( 3) =       0.000402470226
  error estimate for blocks of size 2^( 4) =       0.000411660341
  error estimate for blocks of size 2^( 5) =       0.000416836150
  error estimate for blocks of size 2^( 6) =       0.000419372773
  error estimate for blocks of size 2^( 7) =       0.000420949449

      target function =      -0.938857685707
              le_mean =     -17.212003040721
             les_mean =     296.536397207083
             stat err =       0.000417204678
             autocorr =       1.228590489098
   target nu stat err =       0.000417204678
   target dn stat err =       0.003823536187
      target stat err =       0.006565118586
              std dev =       0.532305058184
             le_variance =       0.283348674968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283443263469
                                         uncertainty =       0.003808070733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283443263469
                                         uncertainty =       0.003808070733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376396516
  error estimate for blocks of size 2^( 2) =       0.000390301618
  error estimate for blocks of size 2^( 3) =       0.000402470226
  error estimate for blocks of size 2^( 4) =       0.000411660341
  error estimate for blocks of size 2^( 5) =       0.000416836150
  error estimate for blocks of size 2^( 6) =       0.000419372773
  error estimate for blocks of size 2^( 7) =       0.000420949449

      target function =      -0.938857685707
              le_mean =     -17.212003040721
             les_mean =     296.536397207083
             stat err =       0.000417204678
             autocorr =       1.228590489099
   target nu stat err =       0.000417204678
   target dn stat err =       0.003823536187
      target stat err =       0.006565118586
              std dev =       0.532305058184
             le_variance =       0.283348674968

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283443263469
                                         uncertainty =       0.003808070733

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283443263469
                                         uncertainty =       0.003808070733

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376396516
  error estimate for blocks of size 2^( 2) =       0.000390301618
  error estimate for blocks of size 2^( 3) =       0.000402470226
  error estimate for blocks of size 2^( 4) =       0.000411660341
  error estimate for blocks of size 2^( 5) =       0.000416836150
  error estimate for blocks of size 2^( 6) =       0.000419372773
  error estimate for blocks of size 2^( 7) =       0.000420949449

      target function =      -0.938857685707
              le_mean =     -17.212003040721
             les_mean =     296.536397207083
             stat err =       0.000417204678
             autocorr =       1.228590489098
   target nu stat err =       0.000417204678
   target dn stat err =       0.003823536187
      target stat err =       0.006565118586
              std dev =       0.532305058184
             le_variance =       0.283348674968


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.938857685707        initial  <--
     3.7253e+09     3.7253e+10             1.3128e-13        -0.938857685707
     1.4901e+10     1.4901e+11             3.2626e-14        -0.938857685707
     5.9605e+10     5.9605e+11             8.3303e-15        -0.938857685707

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2866
  </log>
  <optVariables href="H2O.s031.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5130e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s032 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s032 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=32  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7199e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.0837
    reference variance = 0.210328
====================================================
  Execution time = 2.0283e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s032
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8012e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5635e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279994987785
                                         uncertainty =       0.002200276720

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279994987785
                                         uncertainty =       0.002200276720

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374248137
  error estimate for blocks of size 2^( 2) =       0.000388243905
  error estimate for blocks of size 2^( 3) =       0.000400455752
  error estimate for blocks of size 2^( 4) =       0.000409206984
  error estimate for blocks of size 2^( 5) =       0.000414231595
  error estimate for blocks of size 2^( 6) =       0.000417563163
  error estimate for blocks of size 2^( 7) =       0.000415504644

      target function =      -0.944401491427
              le_mean =     -17.212438704088
             les_mean =     296.548169337317
             stat err =       0.000414126596
             autocorr =       1.224466627549
   target nu stat err =       0.000414126596
   target dn stat err =       0.002280141048
      target stat err =       0.004010313813
              std dev =       0.529266790369
             le_variance =       0.280123335388


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721243870409e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+10, overlap shift 3.7253e+11 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944417560725       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944417560725       residual = 9.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944417560725       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944413396510       residual = 8.03e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944417560819       residual = 3.62e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944410160312       residual = 3.19e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944418747529       residual = 2.56e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944437113599       residual = 9.84e-05           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944486077456       residual = 3.31e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944403301974       residual = 2.15e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944429355752       residual = 1.51e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944470354081       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944323335079       residual = 6.48e-06           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944446165123       residual = 1.06e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944398907839       residual = 6.35e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944549598892       residual = 4.70e-06           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944526891839       residual = 3.17e-06           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944564484367       residual = 2.25e-06           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.944367450957       residual = 1.69e-06           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944305348405       residual = 2.14e-06           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944353399651       residual = 1.04e-06           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944260830374       residual = 2.85e-06           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944187614057       residual = 5.39e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944107172155       residual = 8.75e-06           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.944347363878       residual = 2.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.943886889403       residual = 2.42e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.944143454045       residual = 1.11e-05           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.944097921309       residual = 8.32e-06           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.944732776287       residual = 1.30e-05           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.944524606188       residual = 6.36e-06           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.945021473610       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.945681045207       residual = 1.57e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.947669098557       residual = 9.16e-04           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.944595347723       residual = 7.69e-05           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.944164018577       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.943925860614       residual = 4.37e-05           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.945828582382       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.945514883534       residual = 5.40e-04           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.948648271088       residual = 5.15e-03           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.950312055737       residual = 3.84e-03           smallest_sin_value = 9.96e-01
davidson iteration   40 stopping due to small subspace S singular value of 8.91e-01
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+10 is 1.294484e-14

solving harmonic davidson linear method for identity shift 1.4901e+11, overlap shift 1.4901e+12 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944417560725       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944417560725       residual = 9.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944417560725       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944533694080       residual = 8.55e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944417560725       residual = 3.57e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944393677780       residual = 3.32e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944248764005       residual = 2.78e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944226166064       residual = 1.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.944483915189       residual = 4.32e-05           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.944685986329       residual = 3.21e-05           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.944386242859       residual = 2.18e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944338758296       residual = 1.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944000902572       residual = 3.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.944044033601       residual = 2.89e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944455783244       residual = 9.58e-06           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.944589195953       residual = 1.16e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.944621790534       residual = 1.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.944737058511       residual = 1.13e-05           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.945165035320       residual = 5.00e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.944020082055       residual = 2.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944718032995       residual = 1.57e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.944159537504       residual = 1.78e-05           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.944454879774       residual = 3.24e-06           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.944276035866       residual = 1.10e-05           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.943731891969       residual = 4.53e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.951166637530       residual = 4.22e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.945400892796       residual = 1.17e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.948390669796       residual = 1.50e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.945748684484       residual = 5.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.946333400651       residual = 4.06e-04           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.941786521231       residual = 8.24e-04           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.944753451619       residual = 4.80e-04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.949961705197       residual = 1.15e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.942016825174       residual = 8.34e-04           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.980693032669       residual = 1.21e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.983437326686       residual = 4.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.958253710144       residual = 1.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.954061370093       residual = 2.22e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.931185531375       residual = 2.24e-02           smallest_sin_value = 9.99e-01
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.953233707993       residual = 2.79e-01           smallest_sin_value = 9.97e-01
davidson iteration   40 stopping due to small subspace S singular value of 7.82e-01
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+11 is 3.127250e-15

solving harmonic davidson linear method for identity shift 5.9605e+11, overlap shift 5.9605e+12 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944417560725       residual = 1.08e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944417560725       residual = 9.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.944417560725       residual = 1.30e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.944173809046       residual = 7.63e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.944491663425       residual = 5.00e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.944397840818       residual = 2.91e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.944134834444       residual = 3.04e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.944423495227       residual = 2.64e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.943016004807       residual = 2.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.943257102004       residual = 1.35e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.945106879383       residual = 7.34e-05           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.944182990204       residual = 2.04e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.944954053219       residual = 1.25e-04           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.946225349800       residual = 3.56e-04           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.944234379144       residual = 1.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.943221983106       residual = 1.76e-04           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.946048409563       residual = 3.90e-04           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.942003253929       residual = 6.27e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.947714375747       residual = 9.89e-04           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.942965261969       residual = 2.14e-04           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.944681056712       residual = 1.45e-04           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.948578004230       residual = 1.77e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.939442011718       residual = 2.35e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.949246224106       residual = 2.34e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.940735269680       residual = 1.49e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.938652046531       residual = 3.76e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.939953993170       residual = 3.03e-03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.935233202003       residual = 9.48e-03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.928221195776       residual = 3.05e-02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.938822452384       residual = 3.32e-03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.921490233836       residual = 5.47e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.987255672180       residual = 1.76e-01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.967732038469       residual = 5.89e-02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.789920643667       residual = 2.47e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -0.917733061425       residual = 2.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.914295771647       residual = 2.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -1.022562688506       residual = 7.09e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.912782957233       residual = 3.39e-01           smallest_sin_value = 1.00e+00
davidson iteration   38 stopping due to small subspace S singular value of 9.90e-01
davidson solver did not converge after         38 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+11 is 7.405671e-16

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.519697 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5928e+01
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 32
    time step          = 0.05
    reference energy   = -17.2647
    reference variance = 0.235576
====================================================
  Execution time = 1.9866e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s032
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7821e-01
  Total weights = 2.0000e+06
  Execution time = 1.8236e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278200831411
                                         uncertainty =       0.002588707701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278200831411
                                         uncertainty =       0.002588707701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372968452
  error estimate for blocks of size 2^( 2) =       0.000386586865
  error estimate for blocks of size 2^( 3) =       0.000398991353
  error estimate for blocks of size 2^( 4) =       0.000409033090
  error estimate for blocks of size 2^( 5) =       0.000415417764
  error estimate for blocks of size 2^( 6) =       0.000415687876
  error estimate for blocks of size 2^( 7) =       0.000417201715

      target function =      -0.947708280447
              le_mean =     -17.212558047988
             les_mean =     296.550365347887
             stat err =       0.000414335111
             autocorr =       1.234125368369
   target nu stat err =       0.000414335111
   target dn stat err =       0.002500595958
      target stat err =       0.004416213266
              std dev =       0.527457042453
             le_variance =       0.278210931633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278200831411
                                         uncertainty =       0.002588707701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278200831411
                                         uncertainty =       0.002588707701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372968452
  error estimate for blocks of size 2^( 2) =       0.000386586865
  error estimate for blocks of size 2^( 3) =       0.000398991353
  error estimate for blocks of size 2^( 4) =       0.000409033090
  error estimate for blocks of size 2^( 5) =       0.000415417764
  error estimate for blocks of size 2^( 6) =       0.000415687876
  error estimate for blocks of size 2^( 7) =       0.000417201715

      target function =      -0.947708280447
              le_mean =     -17.212558047988
             les_mean =     296.550365347887
             stat err =       0.000414335111
             autocorr =       1.234125368369
   target nu stat err =       0.000414335111
   target dn stat err =       0.002500595958
      target stat err =       0.004416213266
              std dev =       0.527457042453
             le_variance =       0.278210931633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278200831411
                                         uncertainty =       0.002588707701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278200831411
                                         uncertainty =       0.002588707701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372968452
  error estimate for blocks of size 2^( 2) =       0.000386586865
  error estimate for blocks of size 2^( 3) =       0.000398991353
  error estimate for blocks of size 2^( 4) =       0.000409033090
  error estimate for blocks of size 2^( 5) =       0.000415417764
  error estimate for blocks of size 2^( 6) =       0.000415687876
  error estimate for blocks of size 2^( 7) =       0.000417201715

      target function =      -0.947708280447
              le_mean =     -17.212558047988
             les_mean =     296.550365347887
             stat err =       0.000414335111
             autocorr =       1.234125368365
   target nu stat err =       0.000414335111
   target dn stat err =       0.002500595958
      target stat err =       0.004416213266
              std dev =       0.527457042453
             le_variance =       0.278210931633

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278200831411
                                         uncertainty =       0.002588707701

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278200831411
                                         uncertainty =       0.002588707701

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372968452
  error estimate for blocks of size 2^( 2) =       0.000386586865
  error estimate for blocks of size 2^( 3) =       0.000398991353
  error estimate for blocks of size 2^( 4) =       0.000409033090
  error estimate for blocks of size 2^( 5) =       0.000415417764
  error estimate for blocks of size 2^( 6) =       0.000415687876
  error estimate for blocks of size 2^( 7) =       0.000417201715

      target function =      -0.947708280447
              le_mean =     -17.212558047988
             les_mean =     296.550365347887
             stat err =       0.000414335111
             autocorr =       1.234125368369
   target nu stat err =       0.000414335111
   target dn stat err =       0.002500595958
      target stat err =       0.004416213266
              std dev =       0.527457042453
             le_variance =       0.278210931633


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947708280447        initial  <--
     3.7253e+10     3.7253e+11             1.2945e-14        -0.947708280447
     1.4901e+11     1.4901e+12             3.1273e-15        -0.947708280447
     5.9605e+11     5.9605e+12             7.4057e-16        -0.947708280447

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1311
  </log>
  <optVariables href="H2O.s032.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5066e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s033 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s033 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=33  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.172
    reference variance = 0.214302
====================================================
  Execution time = 2.0025e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s033
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8752e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5611e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287626090653
                                         uncertainty =       0.010043375122

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287626090653
                                         uncertainty =       0.010043375122

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379154976
  error estimate for blocks of size 2^( 2) =       0.000392579211
  error estimate for blocks of size 2^( 3) =       0.000405188637
  error estimate for blocks of size 2^( 4) =       0.000414014158
  error estimate for blocks of size 2^( 5) =       0.000420139342
  error estimate for blocks of size 2^( 6) =       0.000423870298
  error estimate for blocks of size 2^( 7) =       0.000427692467

      target function =      -0.931500857473
              le_mean =     -17.212241418175
             les_mean =     296.548771485363
             stat err =       0.000421429066
             autocorr =       1.235422344971
   target nu stat err =       0.000421429066
   target dn stat err =       0.010486424594
      target stat err =       0.017635809900
              std dev =       0.536206109235
             le_variance =       0.287516991581


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721224141818e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+11, overlap shift 3.7253e+12 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931831070406       residual = 2.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931831070406       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931831070406       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931831070406       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931831070406       residual = 9.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931993663393       residual = 5.98e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.932290909553       residual = 3.75e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932101769659       residual = 1.02e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930209850767       residual = 3.16e-04           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931648182966       residual = 1.33e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.933396404280       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.931587025112       residual = 7.48e-05           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.931556341252       residual = 5.73e-05           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.931590323885       residual = 1.80e-05           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.931844580628       residual = 3.91e-05           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.932390955530       residual = 4.31e-05           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.931756718274       residual = 7.09e-05           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.930662695858       residual = 1.93e-04           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.931819332431       residual = 7.29e-05           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.932539304026       residual = 4.08e-05           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.931774261256       residual = 7.22e-05           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.932941081086       residual = 1.36e-04           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.929384731540       residual = 4.66e-04           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.927988104219       residual = 1.23e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.931542738966       residual = 5.87e-05           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.932088946411       residual = 6.50e-05           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.934074114171       residual = 7.79e-04           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.929339702603       residual = 8.49e-04           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.938067425802       residual = 6.00e-03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.922497382170       residual = 3.03e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.932780066567       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.934486999923       residual = 3.31e-02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.979398265436       residual = 2.24e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.961620549593       residual = 1.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -1.013929650882       residual = 6.43e-01           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.007048541842       residual = 5.88e-01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.904395422272       residual = 3.03e-01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.895412597099       residual = 8.06e-01           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.949950745571       residual = 7.91e-02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -0.898719376236       residual = 3.03e-01           smallest_sin_value = 9.96e-01
davidson iteration   40 stopping due to small subspace S singular value of 7.80e-01
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+11 is 1.747251e-15

solving harmonic davidson linear method for identity shift 1.4901e+12, overlap shift 1.4901e+13 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931831070406       residual = 2.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931831070406       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931831070406       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931831070406       residual = 1.11e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.931831070406       residual = 9.21e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.931831068615       residual = 5.37e-04           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.931766535951       residual = 6.06e-04           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.931173772675       residual = 3.41e-04           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.930846852556       residual = 1.27e-03           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.932679727785       residual = 9.53e-04           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.930090342717       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.926560151647       residual = 2.19e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.937164498741       residual = 3.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.936429590642       residual = 2.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.933993494590       residual = 1.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.938290842141       residual = 3.99e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.924103533584       residual = 8.46e-03           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.927246878807       residual = 2.30e-03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.930335764114       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.912164022563       residual = 3.78e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.932401589474       residual = 1.92e-03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.939274172430       residual = 6.55e-03           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.920645344069       residual = 9.61e-03           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.926204845074       residual = 5.69e-03           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.928692392469       residual = 5.68e-03           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.929030020843       residual = 3.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.966528275486       residual = 2.12e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.916491454993       residual = 3.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.960124698081       residual = 1.46e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.912074109383       residual = 4.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.930767524226       residual = 1.50e-02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.930800466695       residual = 8.44e-03           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.900033905059       residual = 7.44e-01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.801164610141       residual = 1.80e+00           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -1.029278455390       residual = 1.68e+00           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -0.660210113727       residual = 8.13e+00           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.965013985155       residual = 2.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -0.938571286181       residual = 1.64e+00           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.966862135297       residual = 7.03e+00           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -1.207388669053       residual = 8.26e+00           smallest_sin_value = 9.92e-01
davidson iteration   40 stopping due to small subspace S singular value of 6.42e-01
davidson solver did not converge after         40 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+12 is 3.552698e-16

solving harmonic davidson linear method for identity shift 5.9605e+12, overlap shift 5.9605e+13 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931831070406       residual = 2.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931831070406       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.931831070406       residual = 1.45e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.931831070406       residual = 3.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.935075614950       residual = 3.56e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.929067829447       residual = 2.37e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.930497431328       residual = 6.94e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.932181963704       residual = 1.12e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.931524210199       residual = 1.30e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.931368128272       residual = 1.01e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.946789250300       residual = 3.37e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.924936789139       residual = 8.20e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.924581925017       residual = 1.20e-02           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.927421217937       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.970752276887       residual = 1.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.923332406794       residual = 4.27e-02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.929407949418       residual = 2.34e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.923101453406       residual = 2.95e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.941328544326       residual = 3.10e-02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.933333296991       residual = 3.71e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.923597791463       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.957626966858       residual = 1.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.958525429849       residual = 2.59e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.927778425349       residual = 1.25e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.863876239878       residual = 9.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.934629855096       residual = 9.41e-01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -1.021668039117       residual = 8.31e-01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -1.017794347714       residual = 3.16e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.892048345717       residual = 1.40e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -1.056065489476       residual = 2.28e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.797065706626       residual = 2.53e+00           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.738329848874       residual = 1.03e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -1.109600014739       residual = 9.38e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.821925231459       residual = 2.93e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =       0.406470323148       residual = 6.39e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.322865907179       residual = 2.45e+01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.135862479544       residual = 2.02e+02           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -1.112734287379       residual = 3.48e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =       1.518666290239       residual = 6.75e+02           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -1.854683555976       residual = 2.33e+02           smallest_sin_value = 1.00e+00
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.042858950449       residual = 2.99e+02           smallest_sin_value = 9.98e-01
davidson iteration   41 stopping due to small subspace S singular value of 9.25e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+12 is 8.328341e-17

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.596200 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5674e+01
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 33
    time step          = 0.05
    reference energy   = -17.1995
    reference variance = 0.369144
====================================================
  Execution time = 2.2084e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s033
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8284e-01
  Total weights = 2.0000e+06
  Execution time = 1.8140e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282854873775
                                         uncertainty =       0.003265749269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282854873775
                                         uncertainty =       0.003265749269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376059502
  error estimate for blocks of size 2^( 2) =       0.000389748252
  error estimate for blocks of size 2^( 3) =       0.000402087044
  error estimate for blocks of size 2^( 4) =       0.000411493373
  error estimate for blocks of size 2^( 5) =       0.000415848139
  error estimate for blocks of size 2^( 6) =       0.000417693966
  error estimate for blocks of size 2^( 7) =       0.000418068327

      target function =      -0.939705928258
              le_mean =     -17.212653685140
             les_mean =     296.558288241923
             stat err =       0.000415775951
             autocorr =       1.222378203610
   target nu stat err =       0.000415775951
   target dn stat err =       0.003066761971
      target stat err =       0.005300796479
              std dev =       0.531828448627
             le_variance =       0.282841498769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282854873775
                                         uncertainty =       0.003265749269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282854873775
                                         uncertainty =       0.003265749269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376059502
  error estimate for blocks of size 2^( 2) =       0.000389748252
  error estimate for blocks of size 2^( 3) =       0.000402087044
  error estimate for blocks of size 2^( 4) =       0.000411493373
  error estimate for blocks of size 2^( 5) =       0.000415848139
  error estimate for blocks of size 2^( 6) =       0.000417693966
  error estimate for blocks of size 2^( 7) =       0.000418068327

      target function =      -0.939705928258
              le_mean =     -17.212653685140
             les_mean =     296.558288241923
             stat err =       0.000415775951
             autocorr =       1.222378203606
   target nu stat err =       0.000415775951
   target dn stat err =       0.003066761971
      target stat err =       0.005300796479
              std dev =       0.531828448627
             le_variance =       0.282841498769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282854873775
                                         uncertainty =       0.003265749269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282854873775
                                         uncertainty =       0.003265749269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376059502
  error estimate for blocks of size 2^( 2) =       0.000389748252
  error estimate for blocks of size 2^( 3) =       0.000402087044
  error estimate for blocks of size 2^( 4) =       0.000411493373
  error estimate for blocks of size 2^( 5) =       0.000415848139
  error estimate for blocks of size 2^( 6) =       0.000417693966
  error estimate for blocks of size 2^( 7) =       0.000418068327

      target function =      -0.939705928258
              le_mean =     -17.212653685140
             les_mean =     296.558288241923
             stat err =       0.000415775951
             autocorr =       1.222378203606
   target nu stat err =       0.000415775951
   target dn stat err =       0.003066761971
      target stat err =       0.005300796479
              std dev =       0.531828448627
             le_variance =       0.282841498769

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282854873775
                                         uncertainty =       0.003265749269

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282854873775
                                         uncertainty =       0.003265749269

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376059502
  error estimate for blocks of size 2^( 2) =       0.000389748252
  error estimate for blocks of size 2^( 3) =       0.000402087044
  error estimate for blocks of size 2^( 4) =       0.000411493373
  error estimate for blocks of size 2^( 5) =       0.000415848139
  error estimate for blocks of size 2^( 6) =       0.000417693966
  error estimate for blocks of size 2^( 7) =       0.000418068327

      target function =      -0.939705928258
              le_mean =     -17.212653685140
             les_mean =     296.558288241923
             stat err =       0.000415775951
             autocorr =       1.222378203606
   target nu stat err =       0.000415775951
   target dn stat err =       0.003066761971
      target stat err =       0.005300796479
              std dev =       0.531828448627
             le_variance =       0.282841498769


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.939705928258        initial  <--
     3.7253e+11     3.7253e+12             1.7473e-15        -0.939705928258
     1.4901e+12     1.4901e+13             3.5527e-16        -0.939705928258
     5.9605e+12     5.9605e+13             8.3283e-17        -0.939705928258

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.3006
  </log>
  <optVariables href="H2O.s033.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6981e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s034 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s034 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=34  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.2524
    reference variance = 0.3968
====================================================
  Execution time = 2.0257e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s034
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 4.0358e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5253e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.403694786921
                                         uncertainty =       0.110652859239

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.403694786921
                                         uncertainty =       0.110652859239

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000449210366
  error estimate for blocks of size 2^( 2) =       0.000460699301
  error estimate for blocks of size 2^( 3) =       0.000470826573
  error estimate for blocks of size 2^( 4) =       0.000478714455
  error estimate for blocks of size 2^( 5) =       0.000483681007
  error estimate for blocks of size 2^( 6) =       0.000485269475
  error estimate for blocks of size 2^( 7) =       0.000485246293

      target function =      -0.750088847930
              le_mean =     -17.212186555787
             les_mean =     296.662945734846
             stat err =       0.000483227807
             autocorr =       1.157189001575
   target nu stat err =       0.000483227807
   target dn stat err =       0.110611290063
      target stat err =       0.123740353038
              std dev =       0.635279391619
             le_variance =       0.403579905416


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721218655579e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+12, overlap shift 3.7253e+13 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.770538466342       residual = 5.22e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.770538466342       residual = 2.06e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.770538466342       residual = 6.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.771534526531       residual = 1.48e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.769373740804       residual = 4.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.770546113569       residual = 4.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.771289799767       residual = 3.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.773980386070       residual = 3.24e-03           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.770182219482       residual = 1.23e-02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.769097701552       residual = 8.67e-03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.764480611278       residual = 8.43e-03           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.774990948678       residual = 8.40e-03           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.766546886730       residual = 6.21e-03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.768856947075       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.772096837635       residual = 2.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.764572772557       residual = 8.29e-03           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.746234322858       residual = 6.83e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.775348866101       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.767839520088       residual = 4.70e-03           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.769923188992       residual = 6.49e-02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.766628633321       residual = 1.53e-02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.781826827026       residual = 1.80e-02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.744212495289       residual = 1.02e-01           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.747057741527       residual = 8.02e-02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.813651930904       residual = 1.98e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.782972973642       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.755358508065       residual = 4.16e-02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.765452216373       residual = 6.08e-02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.716712534483       residual = 4.20e-01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.634196796742       residual = 2.36e+00           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.853501443770       residual = 8.45e-01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.288975985658       residual = 2.71e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.649583971849       residual = 2.14e+00           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.312144547086       residual = 2.60e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =      -1.306765204323       residual = 1.19e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =      -1.175062161804       residual = 2.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -0.678040751772       residual = 6.72e+01           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =      -1.362799794634       residual = 1.24e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =      -0.871863775135       residual = 1.98e+01           smallest_sin_value = 1.00e+00
davidson iteration   39:   krylov dim =  40   tar_fn =      -4.423417852909       residual = 2.53e+03           smallest_sin_value = 9.97e-01
davidson iteration   40:   krylov dim =  41   tar_fn =      -0.201349069702       residual = 1.83e+02           smallest_sin_value = 9.92e-01
davidson iteration   41 stopping due to small subspace S singular value of 7.53e-01
davidson solver did not converge after         41 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+12 is 7.336345e-16

solving harmonic davidson linear method for identity shift 1.4901e+13, overlap shift 1.4901e+14 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.770538466342       residual = 5.22e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.770538466342       residual = 2.06e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.770538466342       residual = 6.49e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.762860663695       residual = 1.67e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.770538466342       residual = 3.75e-03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.780999698383       residual = 3.01e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.772706776265       residual = 8.77e-03           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.769016466314       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.752501057530       residual = 2.19e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.751050646700       residual = 8.13e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.769710441802       residual = 4.66e-02           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.754902833252       residual = 5.29e-02           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.722039024499       residual = 3.23e-01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.814054781396       residual = 1.93e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.763380559570       residual = 3.17e-02           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.756260084010       residual = 2.73e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.775645386597       residual = 3.04e-02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.840495149536       residual = 5.52e-01           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.740260592012       residual = 4.62e-01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.991928634353       residual = 5.75e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.689285200260       residual = 7.32e-01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.826527416315       residual = 6.26e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.907907287933       residual = 3.00e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.556567454466       residual = 5.56e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.775684022045       residual = 1.14e-01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -1.004986959791       residual = 7.82e+00           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.633645358147       residual = 4.60e+00           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.933283067984       residual = 4.65e+00           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -0.735409799148       residual = 2.98e+00           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -1.081011470202       residual = 1.56e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -1.765434494403       residual = 1.46e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -2.748001309122       residual = 5.21e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.570757680591       residual = 2.60e+01           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =       4.101059265210       residual = 5.44e+03           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =       1.144383241138       residual = 1.06e+03           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =       1.495544469366       residual = 1.01e+03           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =       2.150740825807       residual = 1.20e+03           smallest_sin_value = 9.97e-01
davidson iteration   37 stopping due to small subspace S singular value of 9.80e-01
davidson solver did not converge after         37 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+13 is 1.557217e-16

solving harmonic davidson linear method for identity shift 5.9605e+13, overlap shift 5.9605e+14 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.770538466342       residual = 5.22e-01           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.770538466342       residual = 2.06e-01           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.770538466342       residual = 6.39e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.751080982045       residual = 6.02e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.770538467610       residual = 2.26e-02           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.721554615483       residual = 2.69e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.780973821811       residual = 2.99e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.763717399391       residual = 1.07e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.820300865004       residual = 5.61e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.700776468306       residual = 6.51e-01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.773305818776       residual = 1.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.680290659011       residual = 2.15e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.603249544610       residual = 3.76e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.949941049071       residual = 4.00e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.755428427516       residual = 4.67e-01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.516137254495       residual = 7.58e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.977742685052       residual = 6.99e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.537688677244       residual = 7.54e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -1.019059676857       residual = 9.69e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.768955642234       residual = 1.91e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -0.623325708474       residual = 3.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.699627350365       residual = 8.17e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.062651388059       residual = 9.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.543311815201       residual = 9.20e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.049546762241       residual = 5.34e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -1.183280273807       residual = 3.11e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.455654297797       residual = 1.65e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.234862415447       residual = 3.02e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =       1.508340554969       residual = 5.31e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -1.053199399287       residual = 6.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =       0.214151587797       residual = 1.64e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -2.205192141554       residual = 3.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =      -0.258831003533       residual = 1.02e+03           smallest_sin_value = 1.00e+00
davidson iteration   33 stopping due to too large eigenvalue change
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+13 is 3.830561e-17

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.658934 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5856e+01
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 34
    time step          = 0.05
    reference energy   = -17.1511
    reference variance = 0.171225
====================================================
  Execution time = 1.9762e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s034
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7771e-01
  Total weights = 2.0000e+06
  Execution time = 1.8178e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277696754636
                                         uncertainty =       0.002303450440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277696754636
                                         uncertainty =       0.002303450440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372633796
  error estimate for blocks of size 2^( 2) =       0.000386170663
  error estimate for blocks of size 2^( 3) =       0.000398780774
  error estimate for blocks of size 2^( 4) =       0.000408477387
  error estimate for blocks of size 2^( 5) =       0.000413668759
  error estimate for blocks of size 2^( 6) =       0.000416609682
  error estimate for blocks of size 2^( 7) =       0.000418930434

      target function =      -0.948597910111
              le_mean =     -17.212045155373
             les_mean =     296.532210183234
             stat err =       0.000414421566
             autocorr =       1.236859056647
   target nu stat err =       0.000414421566
   target dn stat err =       0.002386849375
      target stat err =       0.004225049232
              std dev =       0.526983767761
             le_variance =       0.277711891484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277696754636
                                         uncertainty =       0.002303450440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277696754636
                                         uncertainty =       0.002303450440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372633796
  error estimate for blocks of size 2^( 2) =       0.000386170663
  error estimate for blocks of size 2^( 3) =       0.000398780774
  error estimate for blocks of size 2^( 4) =       0.000408477387
  error estimate for blocks of size 2^( 5) =       0.000413668759
  error estimate for blocks of size 2^( 6) =       0.000416609682
  error estimate for blocks of size 2^( 7) =       0.000418930434

      target function =      -0.948597910111
              le_mean =     -17.212045155373
             les_mean =     296.532210183234
             stat err =       0.000414421566
             autocorr =       1.236859056647
   target nu stat err =       0.000414421566
   target dn stat err =       0.002386849375
      target stat err =       0.004225049232
              std dev =       0.526983767761
             le_variance =       0.277711891484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277696754636
                                         uncertainty =       0.002303450440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277696754636
                                         uncertainty =       0.002303450440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372633796
  error estimate for blocks of size 2^( 2) =       0.000386170663
  error estimate for blocks of size 2^( 3) =       0.000398780774
  error estimate for blocks of size 2^( 4) =       0.000408477387
  error estimate for blocks of size 2^( 5) =       0.000413668759
  error estimate for blocks of size 2^( 6) =       0.000416609682
  error estimate for blocks of size 2^( 7) =       0.000418930434

      target function =      -0.948597910111
              le_mean =     -17.212045155373
             les_mean =     296.532210183234
             stat err =       0.000414421566
             autocorr =       1.236859056647
   target nu stat err =       0.000414421566
   target dn stat err =       0.002386849375
      target stat err =       0.004225049232
              std dev =       0.526983767761
             le_variance =       0.277711891484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277696754636
                                         uncertainty =       0.002303450440

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277696754636
                                         uncertainty =       0.002303450440

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372633796
  error estimate for blocks of size 2^( 2) =       0.000386170663
  error estimate for blocks of size 2^( 3) =       0.000398780774
  error estimate for blocks of size 2^( 4) =       0.000408477387
  error estimate for blocks of size 2^( 5) =       0.000413668759
  error estimate for blocks of size 2^( 6) =       0.000416609682
  error estimate for blocks of size 2^( 7) =       0.000418930434

      target function =      -0.948597910111
              le_mean =     -17.212045155373
             les_mean =     296.532210183234
             stat err =       0.000414421566
             autocorr =       1.236859056644
   target nu stat err =       0.000414421566
   target dn stat err =       0.002386849375
      target stat err =       0.004225049232
              std dev =       0.526983767761
             le_variance =       0.277711891484


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.948597910111        initial  <--
     3.7253e+12     3.7253e+13             7.3363e-16        -0.948597910111
     1.4901e+13     1.4901e+14             1.5572e-16        -0.948597910111
     5.9605e+13     5.9605e+14             3.8306e-17        -0.948597910111

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9595
  </log>
  <optVariables href="H2O.s034.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4822e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s035 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s035 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=35  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.2012
    reference variance = 0.143297
====================================================
  Execution time = 2.0219e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s035
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7717e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5160e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277205007017
                                         uncertainty =       0.002028905552

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277205007017
                                         uncertainty =       0.002028905552

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372272512
  error estimate for blocks of size 2^( 2) =       0.000385604440
  error estimate for blocks of size 2^( 3) =       0.000398069854
  error estimate for blocks of size 2^( 4) =       0.000406426967
  error estimate for blocks of size 2^( 5) =       0.000412530571
  error estimate for blocks of size 2^( 6) =       0.000415458760
  error estimate for blocks of size 2^( 7) =       0.000415723872

      target function =      -0.949538048043
              le_mean =     -17.212127015267
             les_mean =     296.534489896816
             stat err =       0.000412535043
             autocorr =       1.228003918099
   target nu stat err =       0.000412535043
   target dn stat err =       0.002025059517
      target stat err =       0.003613995043
              std dev =       0.526472834749
             le_variance =       0.277173645728


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721212701527e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 3.7253e+13, overlap shift 3.7253e+14 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949550728655       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949550728655       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949550728655       residual = 1.41e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.949550728655       residual = 9.33e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932704979043       residual = 1.09e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.958328207375       residual = 8.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.952949389413       residual = 1.82e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.951044203140       residual = 5.72e-02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.923281540071       residual = 1.86e-01           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.965242151317       residual = 8.94e-02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.990848736683       residual = 1.61e-01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.935948797248       residual = 5.56e-01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.831625442279       residual = 1.35e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.872062457145       residual = 4.99e-01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.840528428848       residual = 3.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.959819453236       residual = 2.64e-01           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.976147801470       residual = 3.04e-01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -1.057461470114       residual = 1.24e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.709450402104       residual = 8.98e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.983309438905       residual = 2.23e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -1.109733095816       residual = 5.07e+00           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.908602589752       residual = 4.27e-01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -0.772574850218       residual = 2.71e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -0.996236565449       residual = 5.75e-01           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -1.347605426753       residual = 1.61e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -1.476123583357       residual = 2.81e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.476633757238       residual = 1.90e+01           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -0.637956364478       residual = 2.31e+01           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -1.057434542389       residual = 2.75e+01           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -1.400009897153       residual = 3.53e+01           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -0.419586362520       residual = 2.28e+01           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.554708397032       residual = 1.37e+01           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =       0.885221757850       residual = 2.53e+02           smallest_sin_value = 1.00e+00
davidson iteration   33:   krylov dim =  34   tar_fn =      -0.619164159928       residual = 5.04e+01           smallest_sin_value = 1.00e+00
davidson iteration   34:   krylov dim =  35   tar_fn =       0.152926739026       residual = 5.81e+02           smallest_sin_value = 1.00e+00
davidson iteration   35:   krylov dim =  36   tar_fn =       0.845352979910       residual = 4.15e+02           smallest_sin_value = 1.00e+00
davidson iteration   36:   krylov dim =  37   tar_fn =      -8.062858964426       residual = 8.59e+03           smallest_sin_value = 1.00e+00
davidson iteration   37:   krylov dim =  38   tar_fn =       1.803188824689       residual = 8.94e+02           smallest_sin_value = 1.00e+00
davidson iteration   38:   krylov dim =  39   tar_fn =       0.969147548052       residual = 1.56e+03           smallest_sin_value = 1.00e+00
davidson iteration   39 stopping due to too large eigenvalue change
davidson solver did not converge after         39 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+13 is 3.983884e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+14, overlap shift 1.4901e+15 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949550728655       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949550728655       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949550728655       residual = 1.01e-01           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.972825426361       residual = 5.94e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.941748570216       residual = 1.51e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.940887890994       residual = 3.19e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -1.030849622257       residual = 5.77e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.889076617174       residual = 3.44e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.987945111145       residual = 1.76e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.882135077893       residual = 8.67e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -1.013304057620       residual = 5.00e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.895463320820       residual = 3.86e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.920052899611       residual = 9.19e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -1.263231570221       residual = 1.16e+01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.972512908987       residual = 9.39e+00           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -0.916649136326       residual = 9.83e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.976523884229       residual = 4.43e+01           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.843703265623       residual = 3.84e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.918584542616       residual = 1.42e+01           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.936151774326       residual = 1.18e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -1.882243286826       residual = 8.46e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -1.382135316795       residual = 1.65e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.686499011022       residual = 2.24e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -2.225970743499       residual = 2.06e+02           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.816054473126       residual = 1.98e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -1.745238692345       residual = 1.64e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -3.730919746500       residual = 8.54e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =       3.621266782438       residual = 1.82e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -2.046283279434       residual = 2.42e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -0.055908048734       residual = 1.15e+03           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =       1.799722997014       residual = 1.43e+03           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =     -10.918958754203       residual = 1.48e+04           smallest_sin_value = 1.00e+00
davidson iteration   32:   krylov dim =  33   tar_fn =       5.134867153038       residual = 4.18e+03           smallest_sin_value = 1.00e+00
davidson iteration   33 stopping due to too large eigenvalue change
davidson solver did not converge after         33 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+14 is 8.402570e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 5.9605e+14, overlap shift 5.9605e+15 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.949550728655       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.949550728655       residual = 1.39e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.949550728655       residual = 6.19e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -1.087925663755       residual = 1.53e+00           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.964086019580       residual = 1.56e-01           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -1.230876913143       residual = 6.75e+00           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.778058822710       residual = 2.53e+00           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.400657141252       residual = 9.48e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -1.682683408087       residual = 1.83e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.408847679085       residual = 1.51e+02           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.771108624214       residual = 1.23e+01           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -1.248888273917       residual = 9.59e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =       2.742682558971       residual = 1.49e+03           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =       2.543225786129       residual = 1.16e+03           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.498126354605       residual = 5.88e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =       0.415790171199       residual = 2.76e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.094893986823       residual = 1.05e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -4.790819028204       residual = 1.75e+03           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -2.622946512902       residual = 3.33e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =       0.349819629251       residual = 5.76e+02           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -4.756981250580       residual = 1.38e+03           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =       6.541704122134       residual = 4.80e+03           smallest_sin_value = 1.00e+00
davidson iteration   22 stopping due to too large eigenvalue change
davidson solver did not converge after         22 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 5.9605e+14 is 2.100642e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.703359 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5790e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 35
    time step          = 0.05
    reference energy   = -17.265
    reference variance = 0.170314
====================================================
  Execution time = 2.0017e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s035
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.0408e-01
  Total weights = 2.0000e+06
  Execution time = 1.8238e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304190806120
                                         uncertainty =       0.014654948807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304190806120
                                         uncertainty =       0.014654948807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389922442
  error estimate for blocks of size 2^( 2) =       0.000403056202
  error estimate for blocks of size 2^( 3) =       0.000415726213
  error estimate for blocks of size 2^( 4) =       0.000424656603
  error estimate for blocks of size 2^( 5) =       0.000430479407
  error estimate for blocks of size 2^( 6) =       0.000432987787
  error estimate for blocks of size 2^( 7) =       0.000433012435

      target function =      -0.904123890196
              le_mean =     -17.212638243635
             les_mean =     296.578994174994
             stat err =       0.000430284058
             autocorr =       1.217738533571
   target nu stat err =       0.000430284058
   target dn stat err =       0.015090983363
      target stat err =       0.023925992039
              std dev =       0.551433605056
             le_variance =       0.304079020785

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304190806120
                                         uncertainty =       0.014654948807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304190806120
                                         uncertainty =       0.014654948807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389922442
  error estimate for blocks of size 2^( 2) =       0.000403056202
  error estimate for blocks of size 2^( 3) =       0.000415726213
  error estimate for blocks of size 2^( 4) =       0.000424656603
  error estimate for blocks of size 2^( 5) =       0.000430479407
  error estimate for blocks of size 2^( 6) =       0.000432987787
  error estimate for blocks of size 2^( 7) =       0.000433012435

      target function =      -0.904123890196
              le_mean =     -17.212638243635
             les_mean =     296.578994174994
             stat err =       0.000430284058
             autocorr =       1.217738533570
   target nu stat err =       0.000430284058
   target dn stat err =       0.015090983363
      target stat err =       0.023925992039
              std dev =       0.551433605056
             le_variance =       0.304079020785

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304190806120
                                         uncertainty =       0.014654948807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304190806120
                                         uncertainty =       0.014654948807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389922442
  error estimate for blocks of size 2^( 2) =       0.000403056202
  error estimate for blocks of size 2^( 3) =       0.000415726213
  error estimate for blocks of size 2^( 4) =       0.000424656603
  error estimate for blocks of size 2^( 5) =       0.000430479407
  error estimate for blocks of size 2^( 6) =       0.000432987787
  error estimate for blocks of size 2^( 7) =       0.000433012435

      target function =      -0.904123890196
              le_mean =     -17.212638243635
             les_mean =     296.578994174994
             stat err =       0.000430284058
             autocorr =       1.217738533571
   target nu stat err =       0.000430284058
   target dn stat err =       0.015090983363
      target stat err =       0.023925992039
              std dev =       0.551433605056
             le_variance =       0.304079020785

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304190806120
                                         uncertainty =       0.014654948807

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.304190806120
                                         uncertainty =       0.014654948807

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000389922442
  error estimate for blocks of size 2^( 2) =       0.000403056202
  error estimate for blocks of size 2^( 3) =       0.000415726213
  error estimate for blocks of size 2^( 4) =       0.000424656603
  error estimate for blocks of size 2^( 5) =       0.000430479407
  error estimate for blocks of size 2^( 6) =       0.000432987787
  error estimate for blocks of size 2^( 7) =       0.000433012435

      target function =      -0.904123890196
              le_mean =     -17.212638243635
             les_mean =     296.578994174994
             stat err =       0.000430284058
             autocorr =       1.217738533571
   target nu stat err =       0.000430284058
   target dn stat err =       0.015090983363
      target stat err =       0.023925992039
              std dev =       0.551433605056
             le_variance =       0.304079020785


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.904123890196        initial
     3.7253e+13     3.7253e+14             3.9839e-18        -0.904123890196  <--
     1.4901e+14     1.4901e+15             8.4026e-19        -0.904123890196
     5.9605e+14     5.9605e+15             2.1006e-19        -0.904123890196

*****************************************************************************
Applying the update for shift_i =   3.7253e+13     and shift_s =   3.7253e+14
*****************************************************************************

  Execution time = 3.2694e+01
  </log>
  <optVariables href="H2O.s035.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8490e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s036 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s036 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=36  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7199e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.2292
    reference variance = 0.255153
====================================================
  Execution time = 2.0166e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s036
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8199e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6433e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281956842951
                                         uncertainty =       0.002958069627

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281956842951
                                         uncertainty =       0.002958069627

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375492637
  error estimate for blocks of size 2^( 2) =       0.000388884431
  error estimate for blocks of size 2^( 3) =       0.000401056009
  error estimate for blocks of size 2^( 4) =       0.000410168872
  error estimate for blocks of size 2^( 5) =       0.000415379522
  error estimate for blocks of size 2^( 6) =       0.000419087092
  error estimate for blocks of size 2^( 7) =       0.000420961551

      target function =      -0.941161549198
              le_mean =     -17.212709479547
             les_mean =     296.559356927728
             stat err =       0.000416399259
             autocorr =       1.229750605427
   target nu stat err =       0.000416399259
   target dn stat err =       0.003109455326
      target stat err =       0.005390340237
              std dev =       0.531026780345
             le_variance =       0.281989441444


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721270947955e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+12, overlap shift 9.3132e+13 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941191511625       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941191511625       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+12 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.7253e+13, overlap shift 3.7253e+14 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941191511625       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941191511625       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+13 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.4901e+14, overlap shift 1.4901e+15 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.941191511625       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.941191511625       residual = 1.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+14 is 0.000000e+00

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.704416 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5821e+01
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 36
    time step          = 0.05
    reference energy   = -17.1236
    reference variance = 0.245253
====================================================
  Execution time = 2.0036e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s036
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8547e-01
  Total weights = 2.0000e+06
  Execution time = 1.8188e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285502979296
                                         uncertainty =       0.006033399883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285502979296
                                         uncertainty =       0.006033399883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377804382
  error estimate for blocks of size 2^( 2) =       0.000391589081
  error estimate for blocks of size 2^( 3) =       0.000404500509
  error estimate for blocks of size 2^( 4) =       0.000414170332
  error estimate for blocks of size 2^( 5) =       0.000418371653
  error estimate for blocks of size 2^( 6) =       0.000421872262
  error estimate for blocks of size 2^( 7) =       0.000422502537

      target function =      -0.935172740232
              le_mean =     -17.212079720669
             les_mean =     296.541160469398
             stat err =       0.000419229196
             autocorr =       1.231314687485
   target nu stat err =       0.000419229196
   target dn stat err =       0.006176235731
      target stat err =       0.010481198449
              std dev =       0.534296080340
             le_variance =       0.285472301466

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285502979296
                                         uncertainty =       0.006033399883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285502979296
                                         uncertainty =       0.006033399883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377804382
  error estimate for blocks of size 2^( 2) =       0.000391589081
  error estimate for blocks of size 2^( 3) =       0.000404500509
  error estimate for blocks of size 2^( 4) =       0.000414170332
  error estimate for blocks of size 2^( 5) =       0.000418371653
  error estimate for blocks of size 2^( 6) =       0.000421872262
  error estimate for blocks of size 2^( 7) =       0.000422502537

      target function =      -0.935172740232
              le_mean =     -17.212079720669
             les_mean =     296.541160469398
             stat err =       0.000419229196
             autocorr =       1.231314687485
   target nu stat err =       0.000419229196
   target dn stat err =       0.006176235731
      target stat err =       0.010481198449
              std dev =       0.534296080340
             le_variance =       0.285472301466

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285502979296
                                         uncertainty =       0.006033399883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285502979296
                                         uncertainty =       0.006033399883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377804382
  error estimate for blocks of size 2^( 2) =       0.000391589081
  error estimate for blocks of size 2^( 3) =       0.000404500509
  error estimate for blocks of size 2^( 4) =       0.000414170332
  error estimate for blocks of size 2^( 5) =       0.000418371653
  error estimate for blocks of size 2^( 6) =       0.000421872262
  error estimate for blocks of size 2^( 7) =       0.000422502537

      target function =      -0.935172740232
              le_mean =     -17.212079720669
             les_mean =     296.541160469398
             stat err =       0.000419229196
             autocorr =       1.231314687485
   target nu stat err =       0.000419229196
   target dn stat err =       0.006176235731
      target stat err =       0.010481198449
              std dev =       0.534296080340
             le_variance =       0.285472301466

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285502979296
                                         uncertainty =       0.006033399883

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285502979296
                                         uncertainty =       0.006033399883

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377804382
  error estimate for blocks of size 2^( 2) =       0.000391589081
  error estimate for blocks of size 2^( 3) =       0.000404500509
  error estimate for blocks of size 2^( 4) =       0.000414170332
  error estimate for blocks of size 2^( 5) =       0.000418371653
  error estimate for blocks of size 2^( 6) =       0.000421872262
  error estimate for blocks of size 2^( 7) =       0.000422502537

      target function =      -0.935172740232
              le_mean =     -17.212079720669
             les_mean =     296.541160469398
             stat err =       0.000419229196
             autocorr =       1.231314687485
   target nu stat err =       0.000419229196
   target dn stat err =       0.006176235731
      target stat err =       0.010481198449
              std dev =       0.534296080340
             le_variance =       0.285472301466


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.935172740232        initial  <--
     9.3132e+12     9.3132e+13             0.0000e+00        -0.935172740232
     3.7253e+13     3.7253e+14             0.0000e+00        -0.935172740232
     1.4901e+14     1.4901e+15             0.0000e+00        -0.935172740232

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.2617
  </log>
  <optVariables href="H2O.s036.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5089e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s037 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s037 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=37  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7198e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.3047
    reference variance = 0.418112
====================================================
  Execution time = 2.0137e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s037
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7806e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5872e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278026923297
                                         uncertainty =       0.002406595887

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278026923297
                                         uncertainty =       0.002406595887

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372865418
  error estimate for blocks of size 2^( 2) =       0.000386322971
  error estimate for blocks of size 2^( 3) =       0.000398205740
  error estimate for blocks of size 2^( 4) =       0.000407053460
  error estimate for blocks of size 2^( 5) =       0.000411772241
  error estimate for blocks of size 2^( 6) =       0.000412546085
  error estimate for blocks of size 2^( 7) =       0.000412553300

      target function =      -0.947973825093
              le_mean =     -17.212638822930
             les_mean =     296.552992350178
             stat err =       0.000410981272
             autocorr =       1.214898092767
   target nu stat err =       0.000410981272
   target dn stat err =       0.002426165950
      target stat err =       0.004290666077
              std dev =       0.527311331729
             le_variance =       0.278057240570


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721263882293e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+13, overlap shift 9.3132e+14 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947991865043       residual = 2.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947991865043       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947991865043       residual = 7.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947991865037       residual = 8.90e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947991919251       residual = 8.74e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.934420028856       residual = 1.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.991121833484       residual = 1.60e-01           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.918868127678       residual = 2.40e+00           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -0.905113102010       residual = 2.92e+00           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -1.035830033359       residual = 1.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -0.911500388826       residual = 1.52e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.964453814782       residual = 5.89e+00           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =      -0.873993334903       residual = 9.91e+00           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -0.902507244753       residual = 2.37e+00           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -1.409462118249       residual = 2.95e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =      -1.053220485230       residual = 1.21e+00           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =      -0.957760051024       residual = 2.81e+00           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =      -0.827512610057       residual = 2.12e+00           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -0.916438920388       residual = 4.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -0.785005427399       residual = 4.91e+00           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -1.292590493374       residual = 1.16e+01           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -1.366817296251       residual = 3.17e+01           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -1.007767377562       residual = 3.63e+00           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -1.012377947077       residual = 4.04e+00           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =      -0.756502622074       residual = 4.02e+01           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -0.714505130205       residual = 1.19e+01           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =      -0.873879503816       residual = 4.58e+02           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =       0.454867158382       residual = 3.49e+02           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -2.926614006748       residual = 3.33e+02           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =      -2.161576609909       residual = 7.10e+02           smallest_sin_value = 1.00e+00
davidson iteration   30:   krylov dim =  31   tar_fn =      -1.280278069332       residual = 3.17e+02           smallest_sin_value = 1.00e+00
davidson iteration   31:   krylov dim =  32   tar_fn =      -0.754749237125       residual = 1.50e+03           smallest_sin_value = 1.00e+00
davidson iteration   32 stopping due to too large eigenvalue change
davidson solver did not converge after         32 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+13 is 2.992900e-18

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+14, overlap shift 3.7253e+15 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947991865043       residual = 2.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947991865043       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947991865043       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947991865043       residual = 1.17e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947991865016       residual = 3.45e+00           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947991860198       residual = 4.57e-02           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.957748080203       residual = 2.85e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -0.908604523621       residual = 1.42e-01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =       0.157027011114       residual = 1.02e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.305671309102       residual = 3.50e+01           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =      -1.173645372390       residual = 8.96e+00           smallest_sin_value = 1.00e+00
davidson iteration   11:   krylov dim =  12   tar_fn =      -0.628695959650       residual = 3.40e+01           smallest_sin_value = 1.00e+00
davidson iteration   12:   krylov dim =  13   tar_fn =       0.075404728494       residual = 9.52e+01           smallest_sin_value = 1.00e+00
davidson iteration   13:   krylov dim =  14   tar_fn =      -1.050512718428       residual = 9.67e+01           smallest_sin_value = 1.00e+00
davidson iteration   14:   krylov dim =  15   tar_fn =      -0.870590420015       residual = 4.29e+01           smallest_sin_value = 1.00e+00
davidson iteration   15:   krylov dim =  16   tar_fn =       0.316372185202       residual = 2.06e+02           smallest_sin_value = 1.00e+00
davidson iteration   16:   krylov dim =  17   tar_fn =       0.356055203339       residual = 1.61e+02           smallest_sin_value = 1.00e+00
davidson iteration   17:   krylov dim =  18   tar_fn =       0.080734415605       residual = 1.65e+02           smallest_sin_value = 1.00e+00
davidson iteration   18:   krylov dim =  19   tar_fn =      -2.257859932157       residual = 1.76e+02           smallest_sin_value = 1.00e+00
davidson iteration   19:   krylov dim =  20   tar_fn =      -1.539688709548       residual = 5.85e+01           smallest_sin_value = 1.00e+00
davidson iteration   20:   krylov dim =  21   tar_fn =      -2.664246209354       residual = 3.49e+02           smallest_sin_value = 1.00e+00
davidson iteration   21:   krylov dim =  22   tar_fn =      -0.520070835896       residual = 2.64e+02           smallest_sin_value = 1.00e+00
davidson iteration   22:   krylov dim =  23   tar_fn =      -2.082553520379       residual = 8.62e+02           smallest_sin_value = 1.00e+00
davidson iteration   23:   krylov dim =  24   tar_fn =      -1.352793009652       residual = 1.14e+04           smallest_sin_value = 1.00e+00
davidson iteration   24:   krylov dim =  25   tar_fn =       1.260763129125       residual = 4.30e+02           smallest_sin_value = 1.00e+00
davidson iteration   25:   krylov dim =  26   tar_fn =      -3.964366726147       residual = 9.09e+02           smallest_sin_value = 1.00e+00
davidson iteration   26:   krylov dim =  27   tar_fn =       4.365966522486       residual = 5.06e+03           smallest_sin_value = 1.00e+00
davidson iteration   27:   krylov dim =  28   tar_fn =      -7.321865069975       residual = 6.11e+03           smallest_sin_value = 1.00e+00
davidson iteration   28:   krylov dim =  29   tar_fn =      -6.904326364185       residual = 6.67e+03           smallest_sin_value = 1.00e+00
davidson iteration   29:   krylov dim =  30   tar_fn =       5.460223836943       residual = 9.09e+03           smallest_sin_value = 1.00e+00
davidson iteration   30 stopping due to too large eigenvalue change
davidson solver did not converge after         30 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+14 is 5.100708e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+15, overlap shift 1.4901e+16 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.947991865043       residual = 2.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.947991865043       residual = 1.34e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.947991865043       residual = 1.79e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.947991865043       residual = 1.07e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.947991865043       residual = 6.07e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.947991865120       residual = 3.12e-01           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.941058442214       residual = 5.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -2.941680357453       residual = 3.31e+02           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =      -3.021119416662       residual = 3.64e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =      -0.471783521417       residual = 2.29e+02           smallest_sin_value = 1.00e+00
davidson iteration   10 stopping due to too large eigenvalue change
davidson solver did not converge after         10 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+15 is 1.869411e-19

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.730861 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5762e+01
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 37
    time step          = 0.05
    reference energy   = -17.1724
    reference variance = 0.185636
====================================================
  Execution time = 1.9825e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s037
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.9033e-01
  Total weights = 2.0000e+06
  Execution time = 1.8715e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290415034986
                                         uncertainty =       0.005535700615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290415034986
                                         uncertainty =       0.005535700615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381005955
  error estimate for blocks of size 2^( 2) =       0.000394579842
  error estimate for blocks of size 2^( 3) =       0.000406710275
  error estimate for blocks of size 2^( 4) =       0.000415271288
  error estimate for blocks of size 2^( 5) =       0.000420030087
  error estimate for blocks of size 2^( 6) =       0.000423697930
  error estimate for blocks of size 2^( 7) =       0.000423453638

      target function =      -0.926998683716
              le_mean =     -17.212567988253
             les_mean =     296.562827681301
             stat err =       0.000420613236
             autocorr =       1.218715518496
   target nu stat err =       0.000420613236
   target dn stat err =       0.005837198222
      target stat err =       0.009746230210
              std dev =       0.538823789611
             le_variance =       0.290331076250

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290415034986
                                         uncertainty =       0.005535700615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290415034986
                                         uncertainty =       0.005535700615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381005955
  error estimate for blocks of size 2^( 2) =       0.000394579842
  error estimate for blocks of size 2^( 3) =       0.000406710275
  error estimate for blocks of size 2^( 4) =       0.000415271288
  error estimate for blocks of size 2^( 5) =       0.000420030087
  error estimate for blocks of size 2^( 6) =       0.000423697930
  error estimate for blocks of size 2^( 7) =       0.000423453638

      target function =      -0.926998683716
              le_mean =     -17.212567988253
             les_mean =     296.562827681301
             stat err =       0.000420613236
             autocorr =       1.218715518496
   target nu stat err =       0.000420613236
   target dn stat err =       0.005837198222
      target stat err =       0.009746230210
              std dev =       0.538823789611
             le_variance =       0.290331076250

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290415034986
                                         uncertainty =       0.005535700615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290415034986
                                         uncertainty =       0.005535700615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381005955
  error estimate for blocks of size 2^( 2) =       0.000394579842
  error estimate for blocks of size 2^( 3) =       0.000406710275
  error estimate for blocks of size 2^( 4) =       0.000415271288
  error estimate for blocks of size 2^( 5) =       0.000420030087
  error estimate for blocks of size 2^( 6) =       0.000423697930
  error estimate for blocks of size 2^( 7) =       0.000423453638

      target function =      -0.926998683716
              le_mean =     -17.212567988253
             les_mean =     296.562827681301
             stat err =       0.000420613236
             autocorr =       1.218715518496
   target nu stat err =       0.000420613236
   target dn stat err =       0.005837198222
      target stat err =       0.009746230210
              std dev =       0.538823789611
             le_variance =       0.290331076250

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290415034986
                                         uncertainty =       0.005535700615

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.290415034986
                                         uncertainty =       0.005535700615

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000381005955
  error estimate for blocks of size 2^( 2) =       0.000394579842
  error estimate for blocks of size 2^( 3) =       0.000406710275
  error estimate for blocks of size 2^( 4) =       0.000415271288
  error estimate for blocks of size 2^( 5) =       0.000420030087
  error estimate for blocks of size 2^( 6) =       0.000423697930
  error estimate for blocks of size 2^( 7) =       0.000423453638

      target function =      -0.926998683716
              le_mean =     -17.212567988253
             les_mean =     296.562827681301
             stat err =       0.000420613236
             autocorr =       1.218715518496
   target nu stat err =       0.000420613236
   target dn stat err =       0.005837198222
      target stat err =       0.009746230210
              std dev =       0.538823789611
             le_variance =       0.290331076250


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.926998683716        initial  <--
     9.3132e+13     9.3132e+14             2.9929e-18        -0.926998683716
     3.7253e+14     3.7253e+15             5.1007e-19        -0.926998683716
     1.4901e+15     1.4901e+16             1.8694e-19        -0.926998683716

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1380
  </log>
  <optVariables href="H2O.s037.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4906e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s038 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s038 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=38  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7199e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.1625
    reference variance = 0.279457
====================================================
  Execution time = 2.0055e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s038
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8123e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5358e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281193322481
                                         uncertainty =       0.003217932501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281193322481
                                         uncertainty =       0.003217932501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374984422
  error estimate for blocks of size 2^( 2) =       0.000388147137
  error estimate for blocks of size 2^( 3) =       0.000400330596
  error estimate for blocks of size 2^( 4) =       0.000409416940
  error estimate for blocks of size 2^( 5) =       0.000414774771
  error estimate for blocks of size 2^( 6) =       0.000418240579
  error estimate for blocks of size 2^( 7) =       0.000419686683

      target function =      -0.942498851112
              le_mean =     -17.212155232767
             les_mean =     296.539514249610
             stat err =       0.000415529743
             autocorr =       1.227941789029
   target nu stat err =       0.000415529743
   target dn stat err =       0.003132223911
      target stat err =       0.005438259871
              std dev =       0.530308055132
             le_variance =       0.281226633338


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721215523277e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+14, overlap shift 9.3132e+15 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942529399628       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942529399628       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+14 is 0.000000e+00

solving harmonic davidson linear method for identity shift 3.7253e+15, overlap shift 3.7253e+16 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942529399628       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942529399628       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to small subspace S singular value of 6.20e-01
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+15 is 0.000000e+00

solving harmonic davidson linear method for identity shift 1.4901e+16, overlap shift 1.4901e+17 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942529399628       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942529399628       residual = 1.61e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+16 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.731892 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5603e+01
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 38
    time step          = 0.05
    reference energy   = -17.2321
    reference variance = 0.657546
====================================================
  Execution time = 1.9955e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s038
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7925e-01
  Total weights = 2.0000e+06
  Execution time = 1.8089e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279281533449
                                         uncertainty =       0.003056296777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279281533449
                                         uncertainty =       0.003056296777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373667497
  error estimate for blocks of size 2^( 2) =       0.000387421966
  error estimate for blocks of size 2^( 3) =       0.000400515417
  error estimate for blocks of size 2^( 4) =       0.000409839313
  error estimate for blocks of size 2^( 5) =       0.000415372650
  error estimate for blocks of size 2^( 6) =       0.000418936139
  error estimate for blocks of size 2^( 7) =       0.000422604926

      target function =      -0.945926862397
              le_mean =     -17.211523656934
             les_mean =     296.515801250927
             stat err =       0.000416688257
             autocorr =       1.243517427385
   target nu stat err =       0.000416688257
   target dn stat err =       0.003121234759
      target stat err =       0.005452289758
              std dev =       0.528445642770
             le_variance =       0.279254797362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279281533449
                                         uncertainty =       0.003056296777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279281533449
                                         uncertainty =       0.003056296777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373667497
  error estimate for blocks of size 2^( 2) =       0.000387421966
  error estimate for blocks of size 2^( 3) =       0.000400515417
  error estimate for blocks of size 2^( 4) =       0.000409839313
  error estimate for blocks of size 2^( 5) =       0.000415372650
  error estimate for blocks of size 2^( 6) =       0.000418936139
  error estimate for blocks of size 2^( 7) =       0.000422604926

      target function =      -0.945926862397
              le_mean =     -17.211523656934
             les_mean =     296.515801250927
             stat err =       0.000416688257
             autocorr =       1.243517427385
   target nu stat err =       0.000416688257
   target dn stat err =       0.003121234759
      target stat err =       0.005452289758
              std dev =       0.528445642770
             le_variance =       0.279254797362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279281533449
                                         uncertainty =       0.003056296777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279281533449
                                         uncertainty =       0.003056296777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373667497
  error estimate for blocks of size 2^( 2) =       0.000387421966
  error estimate for blocks of size 2^( 3) =       0.000400515417
  error estimate for blocks of size 2^( 4) =       0.000409839313
  error estimate for blocks of size 2^( 5) =       0.000415372650
  error estimate for blocks of size 2^( 6) =       0.000418936139
  error estimate for blocks of size 2^( 7) =       0.000422604926

      target function =      -0.945926862397
              le_mean =     -17.211523656934
             les_mean =     296.515801250927
             stat err =       0.000416688257
             autocorr =       1.243517427385
   target nu stat err =       0.000416688257
   target dn stat err =       0.003121234759
      target stat err =       0.005452289758
              std dev =       0.528445642770
             le_variance =       0.279254797362

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279281533449
                                         uncertainty =       0.003056296777

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279281533449
                                         uncertainty =       0.003056296777

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373667497
  error estimate for blocks of size 2^( 2) =       0.000387421966
  error estimate for blocks of size 2^( 3) =       0.000400515417
  error estimate for blocks of size 2^( 4) =       0.000409839313
  error estimate for blocks of size 2^( 5) =       0.000415372650
  error estimate for blocks of size 2^( 6) =       0.000418936139
  error estimate for blocks of size 2^( 7) =       0.000422604926

      target function =      -0.945926862397
              le_mean =     -17.211523656934
             les_mean =     296.515801250927
             stat err =       0.000416688257
             autocorr =       1.243517427385
   target nu stat err =       0.000416688257
   target dn stat err =       0.003121234759
      target stat err =       0.005452289758
              std dev =       0.528445642770
             le_variance =       0.279254797362


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.945926862397        initial  <--
     9.3132e+14     9.3132e+15             0.0000e+00        -0.945926862397
     3.7253e+15     3.7253e+16             0.0000e+00        -0.945926862397
     1.4901e+16     1.4901e+17             0.0000e+00        -0.945926862397

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.7043
  </log>
  <optVariables href="H2O.s038.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8313e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s039 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s039 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=39  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7199e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.181
    reference variance = 0.217317
====================================================
  Execution time = 2.0045e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s039
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8079e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6032e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280859758515
                                         uncertainty =       0.003432702030

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280859758515
                                         uncertainty =       0.003432702030

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374696002
  error estimate for blocks of size 2^( 2) =       0.000388319211
  error estimate for blocks of size 2^( 3) =       0.000400243934
  error estimate for blocks of size 2^( 4) =       0.000409279936
  error estimate for blocks of size 2^( 5) =       0.000413834491
  error estimate for blocks of size 2^( 6) =       0.000416526101
  error estimate for blocks of size 2^( 7) =       0.000419035375

      target function =      -0.943206949846
              le_mean =     -17.212763231164
             les_mean =     296.560012099959
             stat err =       0.000414668976
             autocorr =       1.224743009187
   target nu stat err =       0.000414668976
   target dn stat err =       0.003497182867
      target stat err =       0.006076272361
              std dev =       0.529900168202
             le_variance =       0.280794188261


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721276323116e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+15, overlap shift 9.3132e+16 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943244816509       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943244816509       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943244816509       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943244816509       residual = 9.88e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943244816509       residual = 3.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943244835704       residual = 3.47e-03           smallest_sin_value = 1.00e+00
davidson iteration    6:   krylov dim =   7   tar_fn =      -0.943244626464       residual = 6.64e-02           smallest_sin_value = 1.00e+00
davidson iteration    7:   krylov dim =   8   tar_fn =      -1.722510520664       residual = 4.81e+01           smallest_sin_value = 1.00e+00
davidson iteration    8:   krylov dim =   9   tar_fn =       1.261839449483       residual = 4.10e+02           smallest_sin_value = 1.00e+00
davidson iteration    9:   krylov dim =  10   tar_fn =       4.408483302587       residual = 4.50e+03           smallest_sin_value = 1.00e+00
davidson iteration   10:   krylov dim =  11   tar_fn =       4.198087981527       residual = 2.19e+05           smallest_sin_value = 1.00e+00
davidson iteration   11 stopping due to too large eigenvalue change
davidson solver did not converge after         11 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+15 is 3.018640e-20

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+16, overlap shift 3.7253e+17 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943244816509       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943244816509       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943244816509       residual = 1.60e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943244816455       residual = 4.93e-01           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =     -10.280373020015       residual = 7.33e+03           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -5.624038813440       residual = 1.87e+03           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+16 is 3.677482e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+17, overlap shift 1.4901e+18 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943244816509       residual = 1.55e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943244816509       residual = 1.15e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943244816509       residual = 1.66e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+17 is 9.193705e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.734749 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5662e+01
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 39
    time step          = 0.05
    reference energy   = -17.2354
    reference variance = 0.239222
====================================================
  Execution time = 1.9914e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s039
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8025e-01
  Total weights = 2.0000e+06
  Execution time = 1.8170e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280296370056
                                         uncertainty =       0.003454077064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280296370056
                                         uncertainty =       0.003454077064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374334284
  error estimate for blocks of size 2^( 2) =       0.000388161289
  error estimate for blocks of size 2^( 3) =       0.000401303808
  error estimate for blocks of size 2^( 4) =       0.000410380397
  error estimate for blocks of size 2^( 5) =       0.000416451258
  error estimate for blocks of size 2^( 6) =       0.000419326127
  error estimate for blocks of size 2^( 7) =       0.000421264887

      target function =      -0.944160444839
              le_mean =     -17.212315177334
             les_mean =     296.544045935528
             stat err =       0.000416855667
             autocorr =       1.240087163339
   target nu stat err =       0.000416855667
   target dn stat err =       0.003633642780
      target stat err =       0.006317429892
              std dev =       0.529388620753
             le_variance =       0.280252311783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280296370056
                                         uncertainty =       0.003454077064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280296370056
                                         uncertainty =       0.003454077064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374334284
  error estimate for blocks of size 2^( 2) =       0.000388161289
  error estimate for blocks of size 2^( 3) =       0.000401303808
  error estimate for blocks of size 2^( 4) =       0.000410380397
  error estimate for blocks of size 2^( 5) =       0.000416451258
  error estimate for blocks of size 2^( 6) =       0.000419326127
  error estimate for blocks of size 2^( 7) =       0.000421264887

      target function =      -0.944160444839
              le_mean =     -17.212315177334
             les_mean =     296.544045935528
             stat err =       0.000416855667
             autocorr =       1.240087163337
   target nu stat err =       0.000416855667
   target dn stat err =       0.003633642780
      target stat err =       0.006317429892
              std dev =       0.529388620753
             le_variance =       0.280252311783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280296370056
                                         uncertainty =       0.003454077064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280296370056
                                         uncertainty =       0.003454077064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374334284
  error estimate for blocks of size 2^( 2) =       0.000388161289
  error estimate for blocks of size 2^( 3) =       0.000401303808
  error estimate for blocks of size 2^( 4) =       0.000410380397
  error estimate for blocks of size 2^( 5) =       0.000416451258
  error estimate for blocks of size 2^( 6) =       0.000419326127
  error estimate for blocks of size 2^( 7) =       0.000421264887

      target function =      -0.944160444839
              le_mean =     -17.212315177334
             les_mean =     296.544045935528
             stat err =       0.000416855667
             autocorr =       1.240087163337
   target nu stat err =       0.000416855667
   target dn stat err =       0.003633642780
      target stat err =       0.006317429892
              std dev =       0.529388620753
             le_variance =       0.280252311783

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280296370056
                                         uncertainty =       0.003454077064

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280296370056
                                         uncertainty =       0.003454077064

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374334284
  error estimate for blocks of size 2^( 2) =       0.000388161289
  error estimate for blocks of size 2^( 3) =       0.000401303808
  error estimate for blocks of size 2^( 4) =       0.000410380397
  error estimate for blocks of size 2^( 5) =       0.000416451258
  error estimate for blocks of size 2^( 6) =       0.000419326127
  error estimate for blocks of size 2^( 7) =       0.000421264887

      target function =      -0.944160444839
              le_mean =     -17.212315177334
             les_mean =     296.544045935528
             stat err =       0.000416855667
             autocorr =       1.240087163337
   target nu stat err =       0.000416855667
   target dn stat err =       0.003633642780
      target stat err =       0.006317429892
              std dev =       0.529388620753
             le_variance =       0.280252311783


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.944160444839        initial  <--
     9.3132e+15     9.3132e+16             3.0186e-20        -0.944160444839
     3.7253e+16     3.7253e+17             3.6775e-21        -0.944160444839
     1.4901e+17     1.4901e+18             9.1937e-22        -0.944160444839

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1234
  </log>
  <optVariables href="H2O.s039.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4792e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s040 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s040 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=40  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7199e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.1896
    reference variance = 0.251882
====================================================
  Execution time = 2.0126e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s040
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8435e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5999e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284339491285
                                         uncertainty =       0.005542727677

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284339491285
                                         uncertainty =       0.005542727677

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377062538
  error estimate for blocks of size 2^( 2) =       0.000390540804
  error estimate for blocks of size 2^( 3) =       0.000402498268
  error estimate for blocks of size 2^( 4) =       0.000411264634
  error estimate for blocks of size 2^( 5) =       0.000415702711
  error estimate for blocks of size 2^( 6) =       0.000417956721
  error estimate for blocks of size 2^( 7) =       0.000420262472

      target function =      -0.937060860178
              le_mean =     -17.212661703057
             les_mean =     296.560075076294
             stat err =       0.000416296634
             autocorr =       1.218930733620
   target nu stat err =       0.000416296634
   target dn stat err =       0.005601448978
      target stat err =       0.009559585335
              std dev =       0.533246954584
             le_variance =       0.284352314573


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721266170306e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+16, overlap shift 9.3132e+17 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937156333524       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937156333524       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937156333524       residual = 1.97e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+16 is 1.361387e-21

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+17, overlap shift 3.7253e+18 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937156333524       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937156333524       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937156333524       residual = 7.11e-04           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.937156333524       residual = 1.30e+01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+17 is 2.983299e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+18, overlap shift 1.4901e+19 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.937156333524       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.937156333524       residual = 1.18e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.937156333524       residual = 1.98e-03           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+18 is 8.508671e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.736200 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5738e+01
  </log>
  <optVariables href="H2O.s040.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 40
    time step          = 0.05
    reference energy   = -17.2643
    reference variance = 0.231449
====================================================
  Execution time = 2.0195e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s040
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8309e-01
  Total weights = 2.0000e+06
  Execution time = 1.8185e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283126603641
                                         uncertainty =       0.004990739349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283126603641
                                         uncertainty =       0.004990739349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376226358
  error estimate for blocks of size 2^( 2) =       0.000390042392
  error estimate for blocks of size 2^( 3) =       0.000401989182
  error estimate for blocks of size 2^( 4) =       0.000410820194
  error estimate for blocks of size 2^( 5) =       0.000416072768
  error estimate for blocks of size 2^( 6) =       0.000420197300
  error estimate for blocks of size 2^( 7) =       0.000420738079

      target function =      -0.939253743400
              le_mean =     -17.212191405491
             les_mean =     296.542625381986
             stat err =       0.000416957085
             autocorr =       1.228242949174
   target nu stat err =       0.000416957085
   target dn stat err =       0.004998285818
      target stat err =       0.008569000429
              std dev =       0.532064417423
             le_variance =       0.283092544288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283126603641
                                         uncertainty =       0.004990739349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283126603641
                                         uncertainty =       0.004990739349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376226358
  error estimate for blocks of size 2^( 2) =       0.000390042392
  error estimate for blocks of size 2^( 3) =       0.000401989182
  error estimate for blocks of size 2^( 4) =       0.000410820194
  error estimate for blocks of size 2^( 5) =       0.000416072768
  error estimate for blocks of size 2^( 6) =       0.000420197300
  error estimate for blocks of size 2^( 7) =       0.000420738079

      target function =      -0.939253743400
              le_mean =     -17.212191405491
             les_mean =     296.542625381986
             stat err =       0.000416957085
             autocorr =       1.228242949174
   target nu stat err =       0.000416957085
   target dn stat err =       0.004998285818
      target stat err =       0.008569000429
              std dev =       0.532064417423
             le_variance =       0.283092544288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283126603641
                                         uncertainty =       0.004990739349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283126603641
                                         uncertainty =       0.004990739349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376226358
  error estimate for blocks of size 2^( 2) =       0.000390042392
  error estimate for blocks of size 2^( 3) =       0.000401989182
  error estimate for blocks of size 2^( 4) =       0.000410820194
  error estimate for blocks of size 2^( 5) =       0.000416072768
  error estimate for blocks of size 2^( 6) =       0.000420197300
  error estimate for blocks of size 2^( 7) =       0.000420738079

      target function =      -0.939253743400
              le_mean =     -17.212191405491
             les_mean =     296.542625381986
             stat err =       0.000416957085
             autocorr =       1.228242949174
   target nu stat err =       0.000416957085
   target dn stat err =       0.004998285818
      target stat err =       0.008569000429
              std dev =       0.532064417423
             le_variance =       0.283092544288

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283126603641
                                         uncertainty =       0.004990739349

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.283126603641
                                         uncertainty =       0.004990739349

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000376226358
  error estimate for blocks of size 2^( 2) =       0.000390042392
  error estimate for blocks of size 2^( 3) =       0.000401989182
  error estimate for blocks of size 2^( 4) =       0.000410820194
  error estimate for blocks of size 2^( 5) =       0.000416072768
  error estimate for blocks of size 2^( 6) =       0.000420197300
  error estimate for blocks of size 2^( 7) =       0.000420738079

      target function =      -0.939253743400
              le_mean =     -17.212191405491
             les_mean =     296.542625381986
             stat err =       0.000416957085
             autocorr =       1.228242949174
   target nu stat err =       0.000416957085
   target dn stat err =       0.004998285818
      target stat err =       0.008569000429
              std dev =       0.532064417423
             le_variance =       0.283092544288


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.939253743400        initial  <--
     9.3132e+16     9.3132e+17             1.3614e-21        -0.939253743400
     3.7253e+17     3.7253e+18             2.9833e-22        -0.939253743400
     1.4901e+18     1.4901e+19             8.5087e-23        -0.939253743400

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.4157
  </log>
  <optVariables href="H2O.s040.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5160e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s041 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s041 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=41  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.1875
    reference variance = 0.152262
====================================================
  Execution time = 2.2350e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s041
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7780e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6418e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277866810522
                                         uncertainty =       0.002462952379

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277866810522
                                         uncertainty =       0.002462952379

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372690757
  error estimate for blocks of size 2^( 2) =       0.000386385425
  error estimate for blocks of size 2^( 3) =       0.000399279756
  error estimate for blocks of size 2^( 4) =       0.000409342363
  error estimate for blocks of size 2^( 5) =       0.000415333878
  error estimate for blocks of size 2^( 6) =       0.000418691127
  error estimate for blocks of size 2^( 7) =       0.000421732186

      target function =      -0.948444960413
              le_mean =     -17.212264717976
             les_mean =     296.539853383070
             stat err =       0.000416274888
             autocorr =       1.247565000768
   target nu stat err =       0.000416274888
   target dn stat err =       0.002173636984
      target stat err =       0.003861527128
              std dev =       0.527064322717
             le_variance =       0.277796800281


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721226471798e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+17, overlap shift 9.3132e+18 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948459550940       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948459550940       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948459550940       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948459550935       residual = 2.65e+01           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+17 is 1.476163e-22

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+18, overlap shift 3.7253e+19 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948459550940       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948459550940       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948459550946       residual = 2.89e+03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948459651911       residual = 1.23e+02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+18 is 3.690408e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+19, overlap shift 1.4901e+20 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948459550940       residual = 1.44e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948459550940       residual = 1.08e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.948459550940       residual = 1.09e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.948459550940       residual = 1.02e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+19 is 1.168112e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.737839 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8004e+01
  </log>
  <optVariables href="H2O.s041.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 41
    time step          = 0.05
    reference energy   = -17.2434
    reference variance = 0.242452
====================================================
  Execution time = 1.9948e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s041
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7280e-01
  Total weights = 2.0000e+06
  Execution time = 1.8194e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272802129410
                                         uncertainty =       0.001898074460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272802129410
                                         uncertainty =       0.001898074460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369325307
  error estimate for blocks of size 2^( 2) =       0.000383042767
  error estimate for blocks of size 2^( 3) =       0.000395216627
  error estimate for blocks of size 2^( 4) =       0.000404886050
  error estimate for blocks of size 2^( 5) =       0.000409703284
  error estimate for blocks of size 2^( 6) =       0.000413578980
  error estimate for blocks of size 2^( 7) =       0.000416316649

      target function =      -0.957233693407
              le_mean =     -17.211951452338
             les_mean =     296.524075025374
             stat err =       0.000411121241
             autocorr =       1.239143766497
   target nu stat err =       0.000411121241
   target dn stat err =       0.001792715163
      target stat err =       0.003267914084
              std dev =       0.522304857483
             le_variance =       0.272802364151

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272802129410
                                         uncertainty =       0.001898074460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272802129410
                                         uncertainty =       0.001898074460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369325307
  error estimate for blocks of size 2^( 2) =       0.000383042767
  error estimate for blocks of size 2^( 3) =       0.000395216627
  error estimate for blocks of size 2^( 4) =       0.000404886050
  error estimate for blocks of size 2^( 5) =       0.000409703284
  error estimate for blocks of size 2^( 6) =       0.000413578980
  error estimate for blocks of size 2^( 7) =       0.000416316649

      target function =      -0.957233693407
              le_mean =     -17.211951452338
             les_mean =     296.524075025374
             stat err =       0.000411121241
             autocorr =       1.239143766497
   target nu stat err =       0.000411121241
   target dn stat err =       0.001792715163
      target stat err =       0.003267914084
              std dev =       0.522304857483
             le_variance =       0.272802364151

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272802129410
                                         uncertainty =       0.001898074460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272802129410
                                         uncertainty =       0.001898074460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369325307
  error estimate for blocks of size 2^( 2) =       0.000383042767
  error estimate for blocks of size 2^( 3) =       0.000395216627
  error estimate for blocks of size 2^( 4) =       0.000404886050
  error estimate for blocks of size 2^( 5) =       0.000409703284
  error estimate for blocks of size 2^( 6) =       0.000413578980
  error estimate for blocks of size 2^( 7) =       0.000416316649

      target function =      -0.957233693407
              le_mean =     -17.211951452338
             les_mean =     296.524075025374
             stat err =       0.000411121241
             autocorr =       1.239143766497
   target nu stat err =       0.000411121241
   target dn stat err =       0.001792715163
      target stat err =       0.003267914084
              std dev =       0.522304857483
             le_variance =       0.272802364151

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272802129410
                                         uncertainty =       0.001898074460

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.272802129410
                                         uncertainty =       0.001898074460

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000369325307
  error estimate for blocks of size 2^( 2) =       0.000383042767
  error estimate for blocks of size 2^( 3) =       0.000395216627
  error estimate for blocks of size 2^( 4) =       0.000404886050
  error estimate for blocks of size 2^( 5) =       0.000409703284
  error estimate for blocks of size 2^( 6) =       0.000413578980
  error estimate for blocks of size 2^( 7) =       0.000416316649

      target function =      -0.957233693407
              le_mean =     -17.211951452338
             les_mean =     296.524075025374
             stat err =       0.000411121241
             autocorr =       1.239143766497
   target nu stat err =       0.000411121241
   target dn stat err =       0.001792715163
      target stat err =       0.003267914084
              std dev =       0.522304857483
             le_variance =       0.272802364151


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.957233693407        initial  <--
     9.3132e+17     9.3132e+18             1.4762e-22        -0.957233693407
     3.7253e+18     3.7253e+19             3.6904e-23        -0.957233693407
     1.4901e+19     1.4901e+20             1.1681e-23        -0.957233693407

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1731
  </log>
  <optVariables href="H2O.s041.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7183e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s042 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s042 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=42  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.249
    reference variance = 0.165549
====================================================
  Execution time = 2.0180e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s042
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8621e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6176e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286278148773
                                         uncertainty =       0.005814838128

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286278148773
                                         uncertainty =       0.005814838128

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378294584
  error estimate for blocks of size 2^( 2) =       0.000392249567
  error estimate for blocks of size 2^( 3) =       0.000404603206
  error estimate for blocks of size 2^( 4) =       0.000413686439
  error estimate for blocks of size 2^( 5) =       0.000419278702
  error estimate for blocks of size 2^( 6) =       0.000421711634
  error estimate for blocks of size 2^( 7) =       0.000424773614

      target function =      -0.933942979329
              le_mean =     -17.211759832765
             les_mean =     296.530889981807
             stat err =       0.000419862597
             autocorr =       1.231839508906
   target nu stat err =       0.000419862597
   target dn stat err =       0.006157550187
      target stat err =       0.010415860831
              std dev =       0.534989330870
             le_variance =       0.286213584145


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721175983276e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+18, overlap shift 9.3132e+19 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934057032401       residual = 2.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934057032401       residual = 8.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934057032401       residual = 1.05e-02           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934057032402       residual = 1.58e+03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934057032401       residual = 9.24e-04           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+18 is 1.445792e-23

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+19, overlap shift 3.7253e+20 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934057032401       residual = 2.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934057032401       residual = 8.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934057032401       residual = 2.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+19 is 3.614479e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+20, overlap shift 1.4901e+21 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934057032401       residual = 2.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934057032401       residual = 8.83e-04           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934057032401       residual = 2.25e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+20 is 9.036198e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.739406 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5810e+01
  </log>
  <optVariables href="H2O.s042.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 42
    time step          = 0.05
    reference energy   = -17.2533
    reference variance = 0.268717
====================================================
  Execution time = 1.9808e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s042
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8002e-01
  Total weights = 2.0000e+06
  Execution time = 1.8062e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280020194893
                                         uncertainty =       0.002396303906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280020194893
                                         uncertainty =       0.002396303906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374181689
  error estimate for blocks of size 2^( 2) =       0.000387808086
  error estimate for blocks of size 2^( 3) =       0.000400361606
  error estimate for blocks of size 2^( 4) =       0.000409714565
  error estimate for blocks of size 2^( 5) =       0.000414540231
  error estimate for blocks of size 2^( 6) =       0.000417872376
  error estimate for blocks of size 2^( 7) =       0.000418197634

      target function =      -0.944552779292
              le_mean =     -17.212895252081
             les_mean =     296.563786691573
             stat err =       0.000415081201
             autocorr =       1.230555110829
   target nu stat err =       0.000415081201
   target dn stat err =       0.002265007846
      target stat err =       0.003989762054
              std dev =       0.529172819109
             le_variance =       0.280023872484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280020194893
                                         uncertainty =       0.002396303906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280020194893
                                         uncertainty =       0.002396303906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374181689
  error estimate for blocks of size 2^( 2) =       0.000387808086
  error estimate for blocks of size 2^( 3) =       0.000400361606
  error estimate for blocks of size 2^( 4) =       0.000409714565
  error estimate for blocks of size 2^( 5) =       0.000414540231
  error estimate for blocks of size 2^( 6) =       0.000417872376
  error estimate for blocks of size 2^( 7) =       0.000418197634

      target function =      -0.944552779292
              le_mean =     -17.212895252081
             les_mean =     296.563786691573
             stat err =       0.000415081201
             autocorr =       1.230555110829
   target nu stat err =       0.000415081201
   target dn stat err =       0.002265007846
      target stat err =       0.003989762054
              std dev =       0.529172819109
             le_variance =       0.280023872484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280020194893
                                         uncertainty =       0.002396303906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280020194893
                                         uncertainty =       0.002396303906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374181689
  error estimate for blocks of size 2^( 2) =       0.000387808086
  error estimate for blocks of size 2^( 3) =       0.000400361606
  error estimate for blocks of size 2^( 4) =       0.000409714565
  error estimate for blocks of size 2^( 5) =       0.000414540231
  error estimate for blocks of size 2^( 6) =       0.000417872376
  error estimate for blocks of size 2^( 7) =       0.000418197634

      target function =      -0.944552779292
              le_mean =     -17.212895252081
             les_mean =     296.563786691573
             stat err =       0.000415081201
             autocorr =       1.230555110829
   target nu stat err =       0.000415081201
   target dn stat err =       0.002265007846
      target stat err =       0.003989762054
              std dev =       0.529172819109
             le_variance =       0.280023872484

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280020194893
                                         uncertainty =       0.002396303906

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280020194893
                                         uncertainty =       0.002396303906

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374181689
  error estimate for blocks of size 2^( 2) =       0.000387808086
  error estimate for blocks of size 2^( 3) =       0.000400361606
  error estimate for blocks of size 2^( 4) =       0.000409714565
  error estimate for blocks of size 2^( 5) =       0.000414540231
  error estimate for blocks of size 2^( 6) =       0.000417872376
  error estimate for blocks of size 2^( 7) =       0.000418197634

      target function =      -0.944552779292
              le_mean =     -17.212895252081
             les_mean =     296.563786691573
             stat err =       0.000415081201
             autocorr =       1.230555110829
   target nu stat err =       0.000415081201
   target dn stat err =       0.002265007846
      target stat err =       0.003989762054
              std dev =       0.529172819109
             le_variance =       0.280023872484


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.944552779292        initial  <--
     9.3132e+18     9.3132e+19             1.4458e-23        -0.944552779292
     3.7253e+19     3.7253e+20             3.6145e-24        -0.944552779292
     1.4901e+20     1.4901e+21             9.0362e-25        -0.944552779292

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9475
  </log>
  <optVariables href="H2O.s042.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4764e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s043 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s043 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=43  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.1609
    reference variance = 0.239216
====================================================
  Execution time = 2.0218e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s043
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8708e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5470e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287118993598
                                         uncertainty =       0.006066062996

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287118993598
                                         uncertainty =       0.006066062996

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378864819
  error estimate for blocks of size 2^( 2) =       0.000392209155
  error estimate for blocks of size 2^( 3) =       0.000404869092
  error estimate for blocks of size 2^( 4) =       0.000414165932
  error estimate for blocks of size 2^( 5) =       0.000419569058
  error estimate for blocks of size 2^( 6) =       0.000421141358
  error estimate for blocks of size 2^( 7) =       0.000422293818

      target function =      -0.932452119328
              le_mean =     -17.212308246306
             les_mean =     296.550632124859
             stat err =       0.000419292541
             autocorr =       1.224801516437
   target nu stat err =       0.000419292541
   target dn stat err =       0.006116699228
      target stat err =       0.010325089355
              std dev =       0.535795765714
             le_variance =       0.287077102557


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721230824631e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+19, overlap shift 9.3132e+20 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932566619575       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932566619575       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932566619575       residual = 1.05e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.932566619575       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.932566677475       residual = 1.68e+04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.926891841134       residual = 1.29e+00           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+19 is 1.809647e-24

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+20, overlap shift 3.7253e+21 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932566619575       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932566619575       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932566619575       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+20 is 3.452725e-25

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+21, overlap shift 1.4901e+22 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.932566619575       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.932566619575       residual = 1.22e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.932566619575       residual = 1.87e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+21 is 8.631812e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.741048 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5778e+01
  </log>
  <optVariables href="H2O.s043.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 43
    time step          = 0.05
    reference energy   = -17.295
    reference variance = 0.495626
====================================================
  Execution time = 1.9879e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s043
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8074e-01
  Total weights = 2.0000e+06
  Execution time = 1.7973e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280538595273
                                         uncertainty =       0.002738865588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280538595273
                                         uncertainty =       0.002738865588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374657552
  error estimate for blocks of size 2^( 2) =       0.000388475825
  error estimate for blocks of size 2^( 3) =       0.000401037733
  error estimate for blocks of size 2^( 4) =       0.000410562955
  error estimate for blocks of size 2^( 5) =       0.000415696567
  error estimate for blocks of size 2^( 6) =       0.000417713632
  error estimate for blocks of size 2^( 7) =       0.000417642531

      target function =      -0.943346190764
              le_mean =     -17.212190645465
             les_mean =     296.540243237747
             stat err =       0.000415403921
             autocorr =       1.229340534508
   target nu stat err =       0.000415403921
   target dn stat err =       0.002841678928
      target stat err =       0.004953161620
              std dev =       0.529845791046
             le_variance =       0.280736562289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280538595273
                                         uncertainty =       0.002738865588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280538595273
                                         uncertainty =       0.002738865588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374657552
  error estimate for blocks of size 2^( 2) =       0.000388475825
  error estimate for blocks of size 2^( 3) =       0.000401037733
  error estimate for blocks of size 2^( 4) =       0.000410562955
  error estimate for blocks of size 2^( 5) =       0.000415696567
  error estimate for blocks of size 2^( 6) =       0.000417713632
  error estimate for blocks of size 2^( 7) =       0.000417642531

      target function =      -0.943346190764
              le_mean =     -17.212190645465
             les_mean =     296.540243237747
             stat err =       0.000415403921
             autocorr =       1.229340534508
   target nu stat err =       0.000415403921
   target dn stat err =       0.002841678928
      target stat err =       0.004953161620
              std dev =       0.529845791046
             le_variance =       0.280736562289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280538595273
                                         uncertainty =       0.002738865588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280538595273
                                         uncertainty =       0.002738865588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374657552
  error estimate for blocks of size 2^( 2) =       0.000388475825
  error estimate for blocks of size 2^( 3) =       0.000401037733
  error estimate for blocks of size 2^( 4) =       0.000410562955
  error estimate for blocks of size 2^( 5) =       0.000415696567
  error estimate for blocks of size 2^( 6) =       0.000417713632
  error estimate for blocks of size 2^( 7) =       0.000417642531

      target function =      -0.943346190764
              le_mean =     -17.212190645465
             les_mean =     296.540243237747
             stat err =       0.000415403921
             autocorr =       1.229340534508
   target nu stat err =       0.000415403921
   target dn stat err =       0.002841678928
      target stat err =       0.004953161620
              std dev =       0.529845791046
             le_variance =       0.280736562289

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280538595273
                                         uncertainty =       0.002738865588

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280538595273
                                         uncertainty =       0.002738865588

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374657552
  error estimate for blocks of size 2^( 2) =       0.000388475825
  error estimate for blocks of size 2^( 3) =       0.000401037733
  error estimate for blocks of size 2^( 4) =       0.000410562955
  error estimate for blocks of size 2^( 5) =       0.000415696567
  error estimate for blocks of size 2^( 6) =       0.000417713632
  error estimate for blocks of size 2^( 7) =       0.000417642531

      target function =      -0.943346190764
              le_mean =     -17.212190645465
             les_mean =     296.540243237747
             stat err =       0.000415403921
             autocorr =       1.229340534508
   target nu stat err =       0.000415403921
   target dn stat err =       0.002841678928
      target stat err =       0.004953161620
              std dev =       0.529845791046
             le_variance =       0.280736562289


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.943346190764        initial  <--
     9.3132e+19     9.3132e+20             1.8096e-24        -0.943346190764
     3.7253e+20     3.7253e+21             3.4527e-25        -0.943346190764
     1.4901e+21     1.4901e+22             8.6318e-26        -0.943346190764

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9887
  </log>
  <optVariables href="H2O.s043.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4772e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s044 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s044 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=44  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.2342
    reference variance = 0.146247
====================================================
  Execution time = 2.1956e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s044
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8668e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6503e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286706037300
                                         uncertainty =       0.003357857405

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286706037300
                                         uncertainty =       0.003357857405

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378600754
  error estimate for blocks of size 2^( 2) =       0.000391733557
  error estimate for blocks of size 2^( 3) =       0.000404468453
  error estimate for blocks of size 2^( 4) =       0.000413909127
  error estimate for blocks of size 2^( 5) =       0.000420137907
  error estimate for blocks of size 2^( 6) =       0.000424199983
  error estimate for blocks of size 2^( 7) =       0.000426128827

      target function =      -0.933213572124
              le_mean =     -17.212182343548
             les_mean =     296.545897945859
             stat err =       0.000421093961
             autocorr =       1.237072287354
   target nu stat err =       0.000421093961
   target dn stat err =       0.003431426253
      target stat err =       0.005834048512
              std dev =       0.535422320836
             le_variance =       0.286677061649


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721218234355e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+20, overlap shift 9.3132e+21 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933248784421       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933248784421       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+20 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+21, overlap shift 3.7253e+22 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933248784421       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933248784421       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+21 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+22, overlap shift 1.4901e+23 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933248784421       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933248784421       residual = 1.54e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.742143 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.7618e+01
  </log>
  <optVariables href="H2O.s044.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 44
    time step          = 0.05
    reference energy   = -17.0977
    reference variance = 0.266117
====================================================
  Execution time = 1.9811e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s044
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8680e-01
  Total weights = 2.0000e+06
  Execution time = 1.8014e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286807081393
                                         uncertainty =       0.005341046143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286807081393
                                         uncertainty =       0.005341046143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378680742
  error estimate for blocks of size 2^( 2) =       0.000392004868
  error estimate for blocks of size 2^( 3) =       0.000404106201
  error estimate for blocks of size 2^( 4) =       0.000413603894
  error estimate for blocks of size 2^( 5) =       0.000418389679
  error estimate for blocks of size 2^( 6) =       0.000421120757
  error estimate for blocks of size 2^( 7) =       0.000422282845

      target function =      -0.932956193916
              le_mean =     -17.212126110451
             les_mean =     296.544083307302
             stat err =       0.000418849294
             autocorr =       1.223401859230
   target nu stat err =       0.000418849294
   target dn stat err =       0.005537202073
      target stat err =       0.009358910980
              std dev =       0.535535441072
             le_variance =       0.286798208645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286807081393
                                         uncertainty =       0.005341046143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286807081393
                                         uncertainty =       0.005341046143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378680742
  error estimate for blocks of size 2^( 2) =       0.000392004868
  error estimate for blocks of size 2^( 3) =       0.000404106201
  error estimate for blocks of size 2^( 4) =       0.000413603894
  error estimate for blocks of size 2^( 5) =       0.000418389679
  error estimate for blocks of size 2^( 6) =       0.000421120757
  error estimate for blocks of size 2^( 7) =       0.000422282845

      target function =      -0.932956193916
              le_mean =     -17.212126110451
             les_mean =     296.544083307302
             stat err =       0.000418849294
             autocorr =       1.223401859230
   target nu stat err =       0.000418849294
   target dn stat err =       0.005537202073
      target stat err =       0.009358910980
              std dev =       0.535535441072
             le_variance =       0.286798208645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286807081393
                                         uncertainty =       0.005341046143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286807081393
                                         uncertainty =       0.005341046143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378680742
  error estimate for blocks of size 2^( 2) =       0.000392004868
  error estimate for blocks of size 2^( 3) =       0.000404106201
  error estimate for blocks of size 2^( 4) =       0.000413603894
  error estimate for blocks of size 2^( 5) =       0.000418389679
  error estimate for blocks of size 2^( 6) =       0.000421120757
  error estimate for blocks of size 2^( 7) =       0.000422282845

      target function =      -0.932956193916
              le_mean =     -17.212126110451
             les_mean =     296.544083307302
             stat err =       0.000418849294
             autocorr =       1.223401859230
   target nu stat err =       0.000418849294
   target dn stat err =       0.005537202073
      target stat err =       0.009358910980
              std dev =       0.535535441072
             le_variance =       0.286798208645

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286807081393
                                         uncertainty =       0.005341046143

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286807081393
                                         uncertainty =       0.005341046143

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378680742
  error estimate for blocks of size 2^( 2) =       0.000392004868
  error estimate for blocks of size 2^( 3) =       0.000404106201
  error estimate for blocks of size 2^( 4) =       0.000413603894
  error estimate for blocks of size 2^( 5) =       0.000418389679
  error estimate for blocks of size 2^( 6) =       0.000421120757
  error estimate for blocks of size 2^( 7) =       0.000422282845

      target function =      -0.932956193916
              le_mean =     -17.212126110451
             les_mean =     296.544083307302
             stat err =       0.000418849294
             autocorr =       1.223401859230
   target nu stat err =       0.000418849294
   target dn stat err =       0.005537202073
      target stat err =       0.009358910980
              std dev =       0.535535441072
             le_variance =       0.286798208645


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.932956193916        initial  <--
     9.3132e+20     9.3132e+21             0.0000e+00        -0.932956193916
     3.7253e+21     3.7253e+22             0.0000e+00        -0.932956193916
     1.4901e+22     1.4901e+23             0.0000e+00        -0.932956193916

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9549
  </log>
  <optVariables href="H2O.s044.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6579e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s045 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s045 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=45  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.1758
    reference variance = 0.236253
====================================================
  Execution time = 2.0132e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s045
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8675e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5098e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286834435130
                                         uncertainty =       0.005372397091

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286834435130
                                         uncertainty =       0.005372397091

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378646264
  error estimate for blocks of size 2^( 2) =       0.000392269602
  error estimate for blocks of size 2^( 3) =       0.000404253666
  error estimate for blocks of size 2^( 4) =       0.000413336911
  error estimate for blocks of size 2^( 5) =       0.000419580203
  error estimate for blocks of size 2^( 6) =       0.000423541951
  error estimate for blocks of size 2^( 7) =       0.000426014838

      target function =      -0.933047932233
              le_mean =     -17.211939419470
             les_mean =     296.537604422021
             stat err =       0.000420618476
             autocorr =       1.233983461475
   target nu stat err =       0.000420618476
   target dn stat err =       0.005743093417
      target stat err =       0.009703405520
              std dev =       0.535486681345
             le_variance =       0.286745985897


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721193941947e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+21, overlap shift 9.3132e+22 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933148199770       residual = 2.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933148199770       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933148199770       residual = 2.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+21 is 1.686764e-26

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+22, overlap shift 3.7253e+23 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933148199770       residual = 2.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933148199770       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933148199770       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933149356796       residual = 1.69e+06           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933148199769       residual = 5.65e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.933228164215       residual = 2.36e+05           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+22 is 6.996423e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+23, overlap shift 1.4901e+24 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.933148199770       residual = 2.00e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.933148199770       residual = 1.84e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.933148199770       residual = 1.16e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.933148199769       residual = 1.37e-02           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.933147998044       residual = 3.82e+04           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+23 is 1.169490e-27

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.743964 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5654e+01
  </log>
  <optVariables href="H2O.s045.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 45
    time step          = 0.05
    reference energy   = -17.1889
    reference variance = 0.235604
====================================================
  Execution time = 1.9972e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s045
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7742e-01
  Total weights = 2.0000e+06
  Execution time = 1.7981e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277461911019
                                         uncertainty =       0.002240727328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277461911019
                                         uncertainty =       0.002240727328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372436606
  error estimate for blocks of size 2^( 2) =       0.000386081514
  error estimate for blocks of size 2^( 3) =       0.000398588131
  error estimate for blocks of size 2^( 4) =       0.000407541995
  error estimate for blocks of size 2^( 5) =       0.000412598609
  error estimate for blocks of size 2^( 6) =       0.000415053146
  error estimate for blocks of size 2^( 7) =       0.000415675534

      target function =      -0.949118369903
              le_mean =     -17.211885378166
             les_mean =     296.526416183528
             stat err =       0.000412717321
             autocorr =       1.228006514621
   target nu stat err =       0.000412717321
   target dn stat err =       0.002212840392
      target stat err =       0.003929791069
              std dev =       0.526704899447
             le_variance =       0.277418051102

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277461911019
                                         uncertainty =       0.002240727328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277461911019
                                         uncertainty =       0.002240727328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372436606
  error estimate for blocks of size 2^( 2) =       0.000386081514
  error estimate for blocks of size 2^( 3) =       0.000398588131
  error estimate for blocks of size 2^( 4) =       0.000407541995
  error estimate for blocks of size 2^( 5) =       0.000412598609
  error estimate for blocks of size 2^( 6) =       0.000415053146
  error estimate for blocks of size 2^( 7) =       0.000415675534

      target function =      -0.949118369903
              le_mean =     -17.211885378166
             les_mean =     296.526416183528
             stat err =       0.000412717321
             autocorr =       1.228006514621
   target nu stat err =       0.000412717321
   target dn stat err =       0.002212840392
      target stat err =       0.003929791069
              std dev =       0.526704899447
             le_variance =       0.277418051102

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277461911019
                                         uncertainty =       0.002240727328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277461911019
                                         uncertainty =       0.002240727328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372436606
  error estimate for blocks of size 2^( 2) =       0.000386081514
  error estimate for blocks of size 2^( 3) =       0.000398588131
  error estimate for blocks of size 2^( 4) =       0.000407541995
  error estimate for blocks of size 2^( 5) =       0.000412598609
  error estimate for blocks of size 2^( 6) =       0.000415053146
  error estimate for blocks of size 2^( 7) =       0.000415675534

      target function =      -0.949118369903
              le_mean =     -17.211885378166
             les_mean =     296.526416183528
             stat err =       0.000412717321
             autocorr =       1.228006514621
   target nu stat err =       0.000412717321
   target dn stat err =       0.002212840392
      target stat err =       0.003929791069
              std dev =       0.526704899447
             le_variance =       0.277418051102

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277461911019
                                         uncertainty =       0.002240727328

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277461911019
                                         uncertainty =       0.002240727328

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372436606
  error estimate for blocks of size 2^( 2) =       0.000386081514
  error estimate for blocks of size 2^( 3) =       0.000398588131
  error estimate for blocks of size 2^( 4) =       0.000407541995
  error estimate for blocks of size 2^( 5) =       0.000412598609
  error estimate for blocks of size 2^( 6) =       0.000415053146
  error estimate for blocks of size 2^( 7) =       0.000415675534

      target function =      -0.949118369903
              le_mean =     -17.211885378166
             les_mean =     296.526416183528
             stat err =       0.000412717321
             autocorr =       1.228006514621
   target nu stat err =       0.000412717321
   target dn stat err =       0.002212840392
      target stat err =       0.003929791069
              std dev =       0.526704899447
             le_variance =       0.277418051102


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.949118369903        initial  <--
     9.3132e+21     9.3132e+22             1.6868e-26        -0.949118369903
     3.7253e+22     3.7253e+23             6.9964e-27        -0.949118369903
     1.4901e+23     1.4901e+24             1.1695e-27        -0.949118369903

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0945
  </log>
  <optVariables href="H2O.s045.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4755e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s046 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s046 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=46  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.2055
    reference variance = 0.37602
====================================================
  Execution time = 2.0157e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s046
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7773e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5623e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277737497395
                                         uncertainty =       0.002267133215

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.277737497395
                                         uncertainty =       0.002267133215

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372646973
  error estimate for blocks of size 2^( 2) =       0.000386196176
  error estimate for blocks of size 2^( 3) =       0.000398991350
  error estimate for blocks of size 2^( 4) =       0.000407812008
  error estimate for blocks of size 2^( 5) =       0.000412971120
  error estimate for blocks of size 2^( 6) =       0.000415199533
  error estimate for blocks of size 2^( 7) =       0.000415185364

      target function =      -0.948558889326
              le_mean =     -17.212246523022
             les_mean =     296.539161762962
             stat err =       0.000412792006
             autocorr =       1.227064415483
   target nu stat err =       0.000412792006
   target dn stat err =       0.002202821267
      target stat err =       0.003910896903
              std dev =       0.527002402781
             le_variance =       0.277731532537


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721224652302e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+22, overlap shift 9.3132e+23 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948573889225       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948573889225       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+22 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+23, overlap shift 3.7253e+24 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948573889225       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948573889225       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+23 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+24, overlap shift 1.4901e+25 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.948573889225       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.948573889225       residual = 1.24e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.745051 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5731e+01
  </log>
  <optVariables href="H2O.s046.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 46
    time step          = 0.05
    reference energy   = -17.2002
    reference variance = 0.187688
====================================================
  Execution time = 2.1926e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s046
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8176e-01
  Total weights = 2.0000e+06
  Execution time = 1.8018e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281797131874
                                         uncertainty =       0.003732697632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281797131874
                                         uncertainty =       0.003732697632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375341662
  error estimate for blocks of size 2^( 2) =       0.000388660949
  error estimate for blocks of size 2^( 3) =       0.000401127260
  error estimate for blocks of size 2^( 4) =       0.000410357080
  error estimate for blocks of size 2^( 5) =       0.000416373751
  error estimate for blocks of size 2^( 6) =       0.000420003029
  error estimate for blocks of size 2^( 7) =       0.000423737478

      target function =      -0.941570666464
              le_mean =     -17.212058955598
             les_mean =     296.536736076655
             stat err =       0.000417617834
             autocorr =       1.237954060155
   target nu stat err =       0.000417617834
   target dn stat err =       0.003700294052
      target stat err =       0.006393663064
              std dev =       0.530813269013
             le_variance =       0.281762726560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281797131874
                                         uncertainty =       0.003732697632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281797131874
                                         uncertainty =       0.003732697632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375341662
  error estimate for blocks of size 2^( 2) =       0.000388660949
  error estimate for blocks of size 2^( 3) =       0.000401127260
  error estimate for blocks of size 2^( 4) =       0.000410357080
  error estimate for blocks of size 2^( 5) =       0.000416373751
  error estimate for blocks of size 2^( 6) =       0.000420003029
  error estimate for blocks of size 2^( 7) =       0.000423737478

      target function =      -0.941570666464
              le_mean =     -17.212058955598
             les_mean =     296.536736076655
             stat err =       0.000417617834
             autocorr =       1.237954060155
   target nu stat err =       0.000417617834
   target dn stat err =       0.003700294052
      target stat err =       0.006393663064
              std dev =       0.530813269013
             le_variance =       0.281762726560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281797131874
                                         uncertainty =       0.003732697632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281797131874
                                         uncertainty =       0.003732697632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375341662
  error estimate for blocks of size 2^( 2) =       0.000388660949
  error estimate for blocks of size 2^( 3) =       0.000401127260
  error estimate for blocks of size 2^( 4) =       0.000410357080
  error estimate for blocks of size 2^( 5) =       0.000416373751
  error estimate for blocks of size 2^( 6) =       0.000420003029
  error estimate for blocks of size 2^( 7) =       0.000423737478

      target function =      -0.941570666464
              le_mean =     -17.212058955598
             les_mean =     296.536736076655
             stat err =       0.000417617834
             autocorr =       1.237954060155
   target nu stat err =       0.000417617834
   target dn stat err =       0.003700294052
      target stat err =       0.006393663064
              std dev =       0.530813269013
             le_variance =       0.281762726560

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281797131874
                                         uncertainty =       0.003732697632

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281797131874
                                         uncertainty =       0.003732697632

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375341662
  error estimate for blocks of size 2^( 2) =       0.000388660949
  error estimate for blocks of size 2^( 3) =       0.000401127260
  error estimate for blocks of size 2^( 4) =       0.000410357080
  error estimate for blocks of size 2^( 5) =       0.000416373751
  error estimate for blocks of size 2^( 6) =       0.000420003029
  error estimate for blocks of size 2^( 7) =       0.000423737478

      target function =      -0.941570666464
              le_mean =     -17.212058955598
             les_mean =     296.536736076655
             stat err =       0.000417617834
             autocorr =       1.237954060155
   target nu stat err =       0.000417617834
   target dn stat err =       0.003700294052
      target stat err =       0.006393663064
              std dev =       0.530813269013
             le_variance =       0.281762726560


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.941570666464        initial  <--
     9.3132e+22     9.3132e+23             0.0000e+00        -0.941570666464
     3.7253e+23     3.7253e+24             0.0000e+00        -0.941570666464
     1.4901e+24     1.4901e+25             0.0000e+00        -0.941570666464

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.0647
  </log>
  <optVariables href="H2O.s046.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6804e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s047 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s047 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=47  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.1831
    reference variance = 0.369318
====================================================
  Execution time = 2.0186e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s047
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8090e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6028e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280891523627
                                         uncertainty =       0.002935681034

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280891523627
                                         uncertainty =       0.002935681034

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374769899
  error estimate for blocks of size 2^( 2) =       0.000388379213
  error estimate for blocks of size 2^( 3) =       0.000401132991
  error estimate for blocks of size 2^( 4) =       0.000410480059
  error estimate for blocks of size 2^( 5) =       0.000415571974
  error estimate for blocks of size 2^( 6) =       0.000417691640
  error estimate for blocks of size 2^( 7) =       0.000418650947

      target function =      -0.943045852915
              le_mean =     -17.212341079833
             les_mean =     296.545590261689
             stat err =       0.000415598655
             autocorr =       1.229755757828
   target nu stat err =       0.000415598655
   target dn stat err =       0.003043833287
      target stat err =       0.005295803836
              std dev =       0.530004673229
             le_variance =       0.280904953644


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721234107983e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+23, overlap shift 9.3132e+24 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943074107927       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943074107927       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943074107927       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    3: stopping due to imaginary component in cost function
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+23 is 1.378664e-28

solving harmonic davidson linear method for identity shift 3.7253e+24, overlap shift 3.7253e+25 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943074107927       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943074107927       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943074107927       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943074107927       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+24 is 6.307668e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+25, overlap shift 1.4901e+26 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943074107927       residual = 1.34e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943074107927       residual = 1.70e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.943074107927       residual = 1.68e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.943074107927       residual = 1.14e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.943074107927       residual = 4.08e-04           smallest_sin_value = 1.00e+00
davidson iteration    5:   krylov dim =   6   tar_fn =      -0.943147061392       residual = 3.73e+08           smallest_sin_value = 1.00e+00
davidson iteration    6 stopping due to too large eigenvalue change
davidson solver did not converge after          6 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+25 is 2.087388e-29

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.746746 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5801e+01
  </log>
  <optVariables href="H2O.s047.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 47
    time step          = 0.05
    reference energy   = -17.1586
    reference variance = 0.248412
====================================================
  Execution time = 2.0368e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s047
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8444e-01
  Total weights = 2.0000e+06
  Execution time = 1.8033e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284537429466
                                         uncertainty =       0.004002102518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284537429466
                                         uncertainty =       0.004002102518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377120635
  error estimate for blocks of size 2^( 2) =       0.000390515388
  error estimate for blocks of size 2^( 3) =       0.000402574343
  error estimate for blocks of size 2^( 4) =       0.000411251218
  error estimate for blocks of size 2^( 5) =       0.000416936059
  error estimate for blocks of size 2^( 6) =       0.000419976633
  error estimate for blocks of size 2^( 7) =       0.000421634648

      target function =      -0.936981560331
              le_mean =     -17.212332854171
             les_mean =     296.548842086507
             stat err =       0.000417449639
             autocorr =       1.225314544214
   target nu stat err =       0.000417449639
   target dn stat err =       0.003849767261
      target stat err =       0.006587596112
              std dev =       0.533329115965
             le_variance =       0.284439945936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284537429466
                                         uncertainty =       0.004002102518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284537429466
                                         uncertainty =       0.004002102518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377120635
  error estimate for blocks of size 2^( 2) =       0.000390515388
  error estimate for blocks of size 2^( 3) =       0.000402574343
  error estimate for blocks of size 2^( 4) =       0.000411251218
  error estimate for blocks of size 2^( 5) =       0.000416936059
  error estimate for blocks of size 2^( 6) =       0.000419976633
  error estimate for blocks of size 2^( 7) =       0.000421634648

      target function =      -0.936981560331
              le_mean =     -17.212332854171
             les_mean =     296.548842086507
             stat err =       0.000417449639
             autocorr =       1.225314544214
   target nu stat err =       0.000417449639
   target dn stat err =       0.003849767261
      target stat err =       0.006587596112
              std dev =       0.533329115965
             le_variance =       0.284439945936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284537429466
                                         uncertainty =       0.004002102518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284537429466
                                         uncertainty =       0.004002102518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377120635
  error estimate for blocks of size 2^( 2) =       0.000390515388
  error estimate for blocks of size 2^( 3) =       0.000402574343
  error estimate for blocks of size 2^( 4) =       0.000411251218
  error estimate for blocks of size 2^( 5) =       0.000416936059
  error estimate for blocks of size 2^( 6) =       0.000419976633
  error estimate for blocks of size 2^( 7) =       0.000421634648

      target function =      -0.936981560331
              le_mean =     -17.212332854171
             les_mean =     296.548842086507
             stat err =       0.000417449639
             autocorr =       1.225314544214
   target nu stat err =       0.000417449639
   target dn stat err =       0.003849767261
      target stat err =       0.006587596112
              std dev =       0.533329115965
             le_variance =       0.284439945936

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284537429466
                                         uncertainty =       0.004002102518

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.284537429466
                                         uncertainty =       0.004002102518

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000377120635
  error estimate for blocks of size 2^( 2) =       0.000390515388
  error estimate for blocks of size 2^( 3) =       0.000402574343
  error estimate for blocks of size 2^( 4) =       0.000411251218
  error estimate for blocks of size 2^( 5) =       0.000416936059
  error estimate for blocks of size 2^( 6) =       0.000419976633
  error estimate for blocks of size 2^( 7) =       0.000421634648

      target function =      -0.936981560331
              le_mean =     -17.212332854171
             les_mean =     296.548842086507
             stat err =       0.000417449639
             autocorr =       1.225314544214
   target nu stat err =       0.000417449639
   target dn stat err =       0.003849767261
      target stat err =       0.006587596112
              std dev =       0.533329115965
             le_variance =       0.284439945936


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.936981560331        initial  <--
     9.3132e+23     9.3132e+24             1.3787e-28        -0.936981560331
     3.7253e+24     3.7253e+25             6.3077e-29        -0.936981560331
     1.4901e+25     1.4901e+26             2.0874e-29        -0.936981560331

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5200
  </log>
  <optVariables href="H2O.s047.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5327e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s048 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s048 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=48  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.1706
    reference variance = 0.156014
====================================================
  Execution time = 2.0120e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s048
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8002e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5509e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280089678041
                                         uncertainty =       0.002750571709

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280089678041
                                         uncertainty =       0.002750571709

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374177468
  error estimate for blocks of size 2^( 2) =       0.000387941935
  error estimate for blocks of size 2^( 3) =       0.000400450899
  error estimate for blocks of size 2^( 4) =       0.000409686780
  error estimate for blocks of size 2^( 5) =       0.000416063996
  error estimate for blocks of size 2^( 6) =       0.000419171930
  error estimate for blocks of size 2^( 7) =       0.000422091600

      target function =      -0.944617790974
              le_mean =     -17.211463560041
             les_mean =     296.514495293291
             stat err =       0.000416753576
             autocorr =       1.240518964350
   target nu stat err =       0.000416753576
   target dn stat err =       0.002790765768
      target stat err =       0.004873010260
              std dev =       0.529166849565
             le_variance =       0.280017554679


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721146356004e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+24, overlap shift 9.3132e+25 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944642115549       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944642115549       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+24 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+25, overlap shift 3.7253e+26 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944642115549       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944642115549       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+26, overlap shift 1.4901e+27 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.944642115549       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.944642115549       residual = 1.12e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.747841 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5684e+01
  </log>
  <optVariables href="H2O.s048.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 48
    time step          = 0.05
    reference energy   = -17.2252
    reference variance = 0.307145
====================================================
  Execution time = 2.0229e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s048
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8694e-01
  Total weights = 2.0000e+06
  Execution time = 1.8173e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286890086400
                                         uncertainty =       0.006437139304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286890086400
                                         uncertainty =       0.006437139304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378775784
  error estimate for blocks of size 2^( 2) =       0.000392124057
  error estimate for blocks of size 2^( 3) =       0.000404385225
  error estimate for blocks of size 2^( 4) =       0.000413069027
  error estimate for blocks of size 2^( 5) =       0.000417708752
  error estimate for blocks of size 2^( 6) =       0.000421580477
  error estimate for blocks of size 2^( 7) =       0.000421934684

      target function =      -0.932678095242
              le_mean =     -17.212028567158
             les_mean =     296.540869441546
             stat err =       0.000418573235
             autocorr =       1.221176671567
   target nu stat err =       0.000418573235
   target dn stat err =       0.006643806865
      target stat err =       0.011209760021
              std dev =       0.535669850158
             le_variance =       0.286942188368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286890086400
                                         uncertainty =       0.006437139304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286890086400
                                         uncertainty =       0.006437139304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378775784
  error estimate for blocks of size 2^( 2) =       0.000392124057
  error estimate for blocks of size 2^( 3) =       0.000404385225
  error estimate for blocks of size 2^( 4) =       0.000413069027
  error estimate for blocks of size 2^( 5) =       0.000417708752
  error estimate for blocks of size 2^( 6) =       0.000421580477
  error estimate for blocks of size 2^( 7) =       0.000421934684

      target function =      -0.932678095242
              le_mean =     -17.212028567158
             les_mean =     296.540869441546
             stat err =       0.000418573235
             autocorr =       1.221176671567
   target nu stat err =       0.000418573235
   target dn stat err =       0.006643806865
      target stat err =       0.011209760021
              std dev =       0.535669850158
             le_variance =       0.286942188368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286890086400
                                         uncertainty =       0.006437139304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286890086400
                                         uncertainty =       0.006437139304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378775784
  error estimate for blocks of size 2^( 2) =       0.000392124057
  error estimate for blocks of size 2^( 3) =       0.000404385225
  error estimate for blocks of size 2^( 4) =       0.000413069027
  error estimate for blocks of size 2^( 5) =       0.000417708752
  error estimate for blocks of size 2^( 6) =       0.000421580477
  error estimate for blocks of size 2^( 7) =       0.000421934684

      target function =      -0.932678095242
              le_mean =     -17.212028567158
             les_mean =     296.540869441546
             stat err =       0.000418573235
             autocorr =       1.221176671567
   target nu stat err =       0.000418573235
   target dn stat err =       0.006643806865
      target stat err =       0.011209760021
              std dev =       0.535669850158
             le_variance =       0.286942188368

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286890086400
                                         uncertainty =       0.006437139304

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286890086400
                                         uncertainty =       0.006437139304

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378775784
  error estimate for blocks of size 2^( 2) =       0.000392124057
  error estimate for blocks of size 2^( 3) =       0.000404385225
  error estimate for blocks of size 2^( 4) =       0.000413069027
  error estimate for blocks of size 2^( 5) =       0.000417708752
  error estimate for blocks of size 2^( 6) =       0.000421580477
  error estimate for blocks of size 2^( 7) =       0.000421934684

      target function =      -0.932678095242
              le_mean =     -17.212028567158
             les_mean =     296.540869441546
             stat err =       0.000418573235
             autocorr =       1.221176671567
   target nu stat err =       0.000418573235
   target dn stat err =       0.006643806865
      target stat err =       0.011209760021
              std dev =       0.535669850158
             le_variance =       0.286942188368


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.932678095242        initial  <--
     9.3132e+24     9.3132e+25             0.0000e+00        -0.932678095242
     3.7253e+25     3.7253e+26             0.0000e+00        -0.932678095242
     1.4901e+26     1.4901e+27             0.0000e+00        -0.932678095242

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3852
  </log>
  <optVariables href="H2O.s048.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5076e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s049 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s049 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=49  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7200e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.2287
    reference variance = 0.195374
====================================================
  Execution time = 2.0126e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s049
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7901e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6135e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279068546405
                                         uncertainty =       0.001990420176

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279068546405
                                         uncertainty =       0.001990420176

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373502241
  error estimate for blocks of size 2^( 2) =       0.000386928452
  error estimate for blocks of size 2^( 3) =       0.000399794069
  error estimate for blocks of size 2^( 4) =       0.000409177461
  error estimate for blocks of size 2^( 5) =       0.000415063856
  error estimate for blocks of size 2^( 6) =       0.000417942810
  error estimate for blocks of size 2^( 7) =       0.000420952262

      target function =      -0.946354881876
              le_mean =     -17.211957980732
             les_mean =     296.530505238846
             stat err =       0.000415784097
             autocorr =       1.239222599175
   target nu stat err =       0.000415784097
   target dn stat err =       0.002046220659
      target stat err =       0.003626260374
              std dev =       0.528211934616
             le_variance =       0.279007847871


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721195798073e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+25, overlap shift 9.3132e+26 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946367641422       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946367641422       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+25 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+26, overlap shift 3.7253e+27 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946367641422       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946367641422       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+27, overlap shift 1.4901e+28 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946367641422       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946367641422       residual = 1.14e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.748926 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5753e+01
  </log>
  <optVariables href="H2O.s049.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 49
    time step          = 0.05
    reference energy   = -17.2264
    reference variance = 0.204676
====================================================
  Execution time = 2.1762e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s049
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8244e-01
  Total weights = 2.0000e+06
  Execution time = 1.8030e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282381833060
                                         uncertainty =       0.002983277948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282381833060
                                         uncertainty =       0.002983277948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375791447
  error estimate for blocks of size 2^( 2) =       0.000389318227
  error estimate for blocks of size 2^( 3) =       0.000401316779
  error estimate for blocks of size 2^( 4) =       0.000409562104
  error estimate for blocks of size 2^( 5) =       0.000414980150
  error estimate for blocks of size 2^( 6) =       0.000416146714
  error estimate for blocks of size 2^( 7) =       0.000416581916

      target function =      -0.940372023150
              le_mean =     -17.213132246218
             les_mean =     296.574360008061
             stat err =       0.000414317721
             autocorr =       1.215551141971
   target nu stat err =       0.000414317721
   target dn stat err =       0.002923279791
      target stat err =       0.005069356667
              std dev =       0.531449361182
             le_variance =       0.282438423501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282381833060
                                         uncertainty =       0.002983277948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282381833060
                                         uncertainty =       0.002983277948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375791447
  error estimate for blocks of size 2^( 2) =       0.000389318227
  error estimate for blocks of size 2^( 3) =       0.000401316779
  error estimate for blocks of size 2^( 4) =       0.000409562104
  error estimate for blocks of size 2^( 5) =       0.000414980150
  error estimate for blocks of size 2^( 6) =       0.000416146714
  error estimate for blocks of size 2^( 7) =       0.000416581916

      target function =      -0.940372023150
              le_mean =     -17.213132246218
             les_mean =     296.574360008061
             stat err =       0.000414317721
             autocorr =       1.215551141971
   target nu stat err =       0.000414317721
   target dn stat err =       0.002923279791
      target stat err =       0.005069356667
              std dev =       0.531449361182
             le_variance =       0.282438423501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282381833060
                                         uncertainty =       0.002983277948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282381833060
                                         uncertainty =       0.002983277948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375791447
  error estimate for blocks of size 2^( 2) =       0.000389318227
  error estimate for blocks of size 2^( 3) =       0.000401316779
  error estimate for blocks of size 2^( 4) =       0.000409562104
  error estimate for blocks of size 2^( 5) =       0.000414980150
  error estimate for blocks of size 2^( 6) =       0.000416146714
  error estimate for blocks of size 2^( 7) =       0.000416581916

      target function =      -0.940372023150
              le_mean =     -17.213132246218
             les_mean =     296.574360008061
             stat err =       0.000414317721
             autocorr =       1.215551141971
   target nu stat err =       0.000414317721
   target dn stat err =       0.002923279791
      target stat err =       0.005069356667
              std dev =       0.531449361182
             le_variance =       0.282438423501

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282381833060
                                         uncertainty =       0.002983277948

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282381833060
                                         uncertainty =       0.002983277948

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375791447
  error estimate for blocks of size 2^( 2) =       0.000389318227
  error estimate for blocks of size 2^( 3) =       0.000401316779
  error estimate for blocks of size 2^( 4) =       0.000409562104
  error estimate for blocks of size 2^( 5) =       0.000414980150
  error estimate for blocks of size 2^( 6) =       0.000416146714
  error estimate for blocks of size 2^( 7) =       0.000416581916

      target function =      -0.940372023150
              le_mean =     -17.213132246218
             les_mean =     296.574360008061
             stat err =       0.000414317721
             autocorr =       1.215551141971
   target nu stat err =       0.000414317721
   target dn stat err =       0.002923279791
      target stat err =       0.005069356667
              std dev =       0.531449361182
             le_variance =       0.282438423501


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.940372023150        initial  <--
     9.3132e+25     9.3132e+26             0.0000e+00        -0.940372023150
     3.7253e+26     3.7253e+27             0.0000e+00        -0.940372023150
     1.4901e+27     1.4901e+28             0.0000e+00        -0.940372023150

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 31.0654
  </log>
  <optVariables href="H2O.s049.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.6825e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s050 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s050 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=50  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.2327
    reference variance = 0.239039
====================================================
  Execution time = 2.0706e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s050
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8037e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5435e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280357064295
                                         uncertainty =       0.002817182508

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280357064295
                                         uncertainty =       0.002817182508

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374410492
  error estimate for blocks of size 2^( 2) =       0.000387932017
  error estimate for blocks of size 2^( 3) =       0.000400485939
  error estimate for blocks of size 2^( 4) =       0.000409438140
  error estimate for blocks of size 2^( 5) =       0.000414961217
  error estimate for blocks of size 2^( 6) =       0.000417326079
  error estimate for blocks of size 2^( 7) =       0.000419143606

      target function =      -0.943971069955
              le_mean =     -17.212445417562
             les_mean =     296.548643544745
             stat err =       0.000415217261
             autocorr =       1.229857454702
   target nu stat err =       0.000415217261
   target dn stat err =       0.002931287360
      target stat err =       0.005114916555
              std dev =       0.529496395067
             le_variance =       0.280366432389


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721244541756e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+26, overlap shift 9.3132e+27 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943997567601       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943997567601       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+26 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+27, overlap shift 3.7253e+28 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943997567601       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943997567601       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+28, overlap shift 1.4901e+29 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.943997567601       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.943997567601       residual = 1.19e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.750053 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6262e+01
  </log>
  <optVariables href="H2O.s050.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 50
    time step          = 0.05
    reference energy   = -17.25
    reference variance = 0.296083
====================================================
  Execution time = 2.0397e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s050
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8583e-01
  Total weights = 2.0000e+06
  Execution time = 1.8090e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285783580131
                                         uncertainty =       0.005600226966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285783580131
                                         uncertainty =       0.005600226966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378039857
  error estimate for blocks of size 2^( 2) =       0.000391271933
  error estimate for blocks of size 2^( 3) =       0.000403446235
  error estimate for blocks of size 2^( 4) =       0.000412198658
  error estimate for blocks of size 2^( 5) =       0.000418025743
  error estimate for blocks of size 2^( 6) =       0.000422057596
  error estimate for blocks of size 2^( 7) =       0.000423249945

      target function =      -0.934619253927
              le_mean =     -17.211528589749
             les_mean =     296.522544519617
             stat err =       0.000418882986
             autocorr =       1.227750897546
   target nu stat err =       0.000418882986
   target dn stat err =       0.005774521075
      target stat err =       0.009780970537
              std dev =       0.534629092729
             le_variance =       0.285828266792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285783580131
                                         uncertainty =       0.005600226966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285783580131
                                         uncertainty =       0.005600226966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378039857
  error estimate for blocks of size 2^( 2) =       0.000391271933
  error estimate for blocks of size 2^( 3) =       0.000403446235
  error estimate for blocks of size 2^( 4) =       0.000412198658
  error estimate for blocks of size 2^( 5) =       0.000418025743
  error estimate for blocks of size 2^( 6) =       0.000422057596
  error estimate for blocks of size 2^( 7) =       0.000423249945

      target function =      -0.934619253927
              le_mean =     -17.211528589749
             les_mean =     296.522544519617
             stat err =       0.000418882986
             autocorr =       1.227750897546
   target nu stat err =       0.000418882986
   target dn stat err =       0.005774521075
      target stat err =       0.009780970537
              std dev =       0.534629092729
             le_variance =       0.285828266792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285783580131
                                         uncertainty =       0.005600226966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285783580131
                                         uncertainty =       0.005600226966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378039857
  error estimate for blocks of size 2^( 2) =       0.000391271933
  error estimate for blocks of size 2^( 3) =       0.000403446235
  error estimate for blocks of size 2^( 4) =       0.000412198658
  error estimate for blocks of size 2^( 5) =       0.000418025743
  error estimate for blocks of size 2^( 6) =       0.000422057596
  error estimate for blocks of size 2^( 7) =       0.000423249945

      target function =      -0.934619253927
              le_mean =     -17.211528589749
             les_mean =     296.522544519617
             stat err =       0.000418882986
             autocorr =       1.227750897546
   target nu stat err =       0.000418882986
   target dn stat err =       0.005774521075
      target stat err =       0.009780970537
              std dev =       0.534629092729
             le_variance =       0.285828266792

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285783580131
                                         uncertainty =       0.005600226966

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.285783580131
                                         uncertainty =       0.005600226966

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378039857
  error estimate for blocks of size 2^( 2) =       0.000391271933
  error estimate for blocks of size 2^( 3) =       0.000403446235
  error estimate for blocks of size 2^( 4) =       0.000412198658
  error estimate for blocks of size 2^( 5) =       0.000418025743
  error estimate for blocks of size 2^( 6) =       0.000422057596
  error estimate for blocks of size 2^( 7) =       0.000423249945

      target function =      -0.934619253927
              le_mean =     -17.211528589749
             les_mean =     296.522544519617
             stat err =       0.000418882986
             autocorr =       1.227750897546
   target nu stat err =       0.000418882986
   target dn stat err =       0.005774521075
      target stat err =       0.009780970537
              std dev =       0.534629092729
             le_variance =       0.285828266792


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.934619253927        initial  <--
     9.3132e+26     9.3132e+27             0.0000e+00        -0.934619253927
     3.7253e+27     3.7253e+28             0.0000e+00        -0.934619253927
     1.4901e+28     1.4901e+29             0.0000e+00        -0.934619253927

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.5671
  </log>
  <optVariables href="H2O.s050.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5835e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s051 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s051 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=51  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.2183
    reference variance = 0.139115
====================================================
  Execution time = 2.0590e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s051
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.0557e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6388e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305587335573
                                         uncertainty =       0.016691595430

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.305587335573
                                         uncertainty =       0.016691595430

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000390875722
  error estimate for blocks of size 2^( 2) =       0.000403685978
  error estimate for blocks of size 2^( 3) =       0.000415581770
  error estimate for blocks of size 2^( 4) =       0.000424052716
  error estimate for blocks of size 2^( 5) =       0.000429093918
  error estimate for blocks of size 2^( 6) =       0.000431974038
  error estimate for blocks of size 2^( 7) =       0.000435199206

      target function =      -0.901591614316
              le_mean =     -17.212919607403
             les_mean =     296.590168917977
             stat err =       0.000430079970
             autocorr =       1.210656784834
   target nu stat err =       0.000430079970
   target dn stat err =       0.016754045032
      target stat err =       0.026430354608
              std dev =       0.552781747020
             le_variance =       0.305567659839


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721291960740e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+27, overlap shift 9.3132e+28 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902367151895       residual = 2.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902367151895       residual = 2.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+27 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+28, overlap shift 3.7253e+29 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902367151895       residual = 2.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902367151895       residual = 2.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+28 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+29, overlap shift 1.4901e+30 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.902367151895       residual = 2.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.902367151895       residual = 2.32e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.751165 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6241e+01
  </log>
  <optVariables href="H2O.s051.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 51
    time step          = 0.05
    reference energy   = -17.1298
    reference variance = 0.194385
====================================================
  Execution time = 2.0042e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s051
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8602e-01
  Total weights = 2.0000e+06
  Execution time = 1.8074e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286025949260
                                         uncertainty =       0.003309983850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286025949260
                                         uncertainty =       0.003309983850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378169323
  error estimate for blocks of size 2^( 2) =       0.000391760939
  error estimate for blocks of size 2^( 3) =       0.000404373269
  error estimate for blocks of size 2^( 4) =       0.000413545161
  error estimate for blocks of size 2^( 5) =       0.000419282563
  error estimate for blocks of size 2^( 6) =       0.000422741872
  error estimate for blocks of size 2^( 7) =       0.000423269710

      target function =      -0.934293024298
              le_mean =     -17.212489870282
             les_mean =     296.555831465076
             stat err =       0.000419709827
             autocorr =       1.231758827262
   target nu stat err =       0.000419709827
   target dn stat err =       0.003564757598
      target stat err =       0.006074186240
              std dev =       0.534812185285
             le_variance =       0.286024073529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286025949260
                                         uncertainty =       0.003309983850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286025949260
                                         uncertainty =       0.003309983850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378169323
  error estimate for blocks of size 2^( 2) =       0.000391760939
  error estimate for blocks of size 2^( 3) =       0.000404373269
  error estimate for blocks of size 2^( 4) =       0.000413545161
  error estimate for blocks of size 2^( 5) =       0.000419282563
  error estimate for blocks of size 2^( 6) =       0.000422741872
  error estimate for blocks of size 2^( 7) =       0.000423269710

      target function =      -0.934293024298
              le_mean =     -17.212489870282
             les_mean =     296.555831465076
             stat err =       0.000419709827
             autocorr =       1.231758827262
   target nu stat err =       0.000419709827
   target dn stat err =       0.003564757598
      target stat err =       0.006074186240
              std dev =       0.534812185285
             le_variance =       0.286024073529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286025949260
                                         uncertainty =       0.003309983850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286025949260
                                         uncertainty =       0.003309983850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378169323
  error estimate for blocks of size 2^( 2) =       0.000391760939
  error estimate for blocks of size 2^( 3) =       0.000404373269
  error estimate for blocks of size 2^( 4) =       0.000413545161
  error estimate for blocks of size 2^( 5) =       0.000419282563
  error estimate for blocks of size 2^( 6) =       0.000422741872
  error estimate for blocks of size 2^( 7) =       0.000423269710

      target function =      -0.934293024298
              le_mean =     -17.212489870282
             les_mean =     296.555831465076
             stat err =       0.000419709827
             autocorr =       1.231758827262
   target nu stat err =       0.000419709827
   target dn stat err =       0.003564757598
      target stat err =       0.006074186240
              std dev =       0.534812185285
             le_variance =       0.286024073529

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286025949260
                                         uncertainty =       0.003309983850

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286025949260
                                         uncertainty =       0.003309983850

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378169323
  error estimate for blocks of size 2^( 2) =       0.000391760939
  error estimate for blocks of size 2^( 3) =       0.000404373269
  error estimate for blocks of size 2^( 4) =       0.000413545161
  error estimate for blocks of size 2^( 5) =       0.000419282563
  error estimate for blocks of size 2^( 6) =       0.000422741872
  error estimate for blocks of size 2^( 7) =       0.000423269710

      target function =      -0.934293024298
              le_mean =     -17.212489870282
             les_mean =     296.555831465076
             stat err =       0.000419709827
             autocorr =       1.231758827262
   target nu stat err =       0.000419709827
   target dn stat err =       0.003564757598
      target stat err =       0.006074186240
              std dev =       0.534812185285
             le_variance =       0.286024073529


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.934293024298        initial  <--
     9.3132e+27     9.3132e+28             0.0000e+00        -0.934293024298
     3.7253e+28     3.7253e+29             0.0000e+00        -0.934293024298
     1.4901e+29     1.4901e+30             0.0000e+00        -0.934293024298

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 32.2121
  </log>
  <optVariables href="H2O.s051.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.8459e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s052 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s052 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=52  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.2511
    reference variance = 0.210865
====================================================
  Execution time = 2.0453e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s052
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7687e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5641e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276919788894
                                         uncertainty =       0.002474367295

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276919788894
                                         uncertainty =       0.002474367295

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000372070032
  error estimate for blocks of size 2^( 2) =       0.000385826493
  error estimate for blocks of size 2^( 3) =       0.000398241948
  error estimate for blocks of size 2^( 4) =       0.000407139157
  error estimate for blocks of size 2^( 5) =       0.000411842682
  error estimate for blocks of size 2^( 6) =       0.000413510158
  error estimate for blocks of size 2^( 7) =       0.000415762263

      target function =      -0.950053331149
              le_mean =     -17.212154121281
             les_mean =     296.535121573966
             stat err =       0.000412063565
             autocorr =       1.226532463466
   target nu stat err =       0.000412063565
   target dn stat err =       0.002682118072
      target stat err =       0.004746353791
              std dev =       0.526186485648
             le_variance =       0.276872217678


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721215412128e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+28, overlap shift 9.3132e+29 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950076091836       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950076091836       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950076091836       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.950076091802       residual = 1.13e-02           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+28 is 1.833124e-33

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+29, overlap shift 3.7253e+30 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950076091836       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950076091836       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950076091836       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.950076092035       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950076103210       residual = 8.82e+01           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+29 is 4.582810e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+30, overlap shift 1.4901e+31 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.950076091836       residual = 1.38e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.950076091836       residual = 1.36e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.950076091836       residual = 1.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.950076092035       residual = 2.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.950076103210       residual = 8.82e+01           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+30 is 1.145702e-34

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.752968 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6030e+01
  </log>
  <optVariables href="H2O.s052.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 52
    time step          = 0.05
    reference energy   = -17.1927
    reference variance = 0.130434
====================================================
  Execution time = 1.9818e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s052
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7384e-01
  Total weights = 2.0000e+06
  Execution time = 1.8073e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273862396294
                                         uncertainty =       0.001702047172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273862396294
                                         uncertainty =       0.001702047172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370028254
  error estimate for blocks of size 2^( 2) =       0.000383551598
  error estimate for blocks of size 2^( 3) =       0.000396032655
  error estimate for blocks of size 2^( 4) =       0.000405645425
  error estimate for blocks of size 2^( 5) =       0.000410907210
  error estimate for blocks of size 2^( 6) =       0.000414804604
  error estimate for blocks of size 2^( 7) =       0.000416450178

      target function =      -0.955384968516
              le_mean =     -17.212332056313
             les_mean =     296.538216497172
             stat err =       0.000411951854
             autocorr =       1.239433274804
   target nu stat err =       0.000411951854
   target dn stat err =       0.001840240626
      target stat err =       0.003340121100
              std dev =       0.523298975071
             le_variance =       0.273841817310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273862396294
                                         uncertainty =       0.001702047172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273862396294
                                         uncertainty =       0.001702047172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370028254
  error estimate for blocks of size 2^( 2) =       0.000383551598
  error estimate for blocks of size 2^( 3) =       0.000396032655
  error estimate for blocks of size 2^( 4) =       0.000405645425
  error estimate for blocks of size 2^( 5) =       0.000410907210
  error estimate for blocks of size 2^( 6) =       0.000414804604
  error estimate for blocks of size 2^( 7) =       0.000416450178

      target function =      -0.955384968516
              le_mean =     -17.212332056313
             les_mean =     296.538216497172
             stat err =       0.000411951854
             autocorr =       1.239433274804
   target nu stat err =       0.000411951854
   target dn stat err =       0.001840240626
      target stat err =       0.003340121100
              std dev =       0.523298975071
             le_variance =       0.273841817310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273862396294
                                         uncertainty =       0.001702047172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273862396294
                                         uncertainty =       0.001702047172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370028254
  error estimate for blocks of size 2^( 2) =       0.000383551598
  error estimate for blocks of size 2^( 3) =       0.000396032655
  error estimate for blocks of size 2^( 4) =       0.000405645425
  error estimate for blocks of size 2^( 5) =       0.000410907210
  error estimate for blocks of size 2^( 6) =       0.000414804604
  error estimate for blocks of size 2^( 7) =       0.000416450178

      target function =      -0.955384968516
              le_mean =     -17.212332056313
             les_mean =     296.538216497172
             stat err =       0.000411951854
             autocorr =       1.239433274804
   target nu stat err =       0.000411951854
   target dn stat err =       0.001840240626
      target stat err =       0.003340121100
              std dev =       0.523298975071
             le_variance =       0.273841817310

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273862396294
                                         uncertainty =       0.001702047172

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.273862396294
                                         uncertainty =       0.001702047172

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370028254
  error estimate for blocks of size 2^( 2) =       0.000383551598
  error estimate for blocks of size 2^( 3) =       0.000396032655
  error estimate for blocks of size 2^( 4) =       0.000405645425
  error estimate for blocks of size 2^( 5) =       0.000410907210
  error estimate for blocks of size 2^( 6) =       0.000414804604
  error estimate for blocks of size 2^( 7) =       0.000416450178

      target function =      -0.955384968516
              le_mean =     -17.212332056313
             les_mean =     296.538216497172
             stat err =       0.000411951854
             autocorr =       1.239433274804
   target nu stat err =       0.000411951854
   target dn stat err =       0.001840240626
      target stat err =       0.003340121100
              std dev =       0.523298975071
             le_variance =       0.273841817310


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.955384968516        initial  <--
     9.3132e+28     9.3132e+29             1.8331e-33        -0.955384968516
     3.7253e+29     3.7253e+30             4.5828e-34        -0.955384968516
     1.4901e+30     1.4901e+31             1.1457e-34        -0.955384968516

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0068
  </log>
  <optVariables href="H2O.s052.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5043e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s053 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s053 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=53  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7201e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.2362
    reference variance = 0.212513
====================================================
  Execution time = 2.0148e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s053
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7211e+01
  VMC Evar = 2.8269e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.4983e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282783130843
                                         uncertainty =       0.006297059039

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.282783130843
                                         uncertainty =       0.006297059039

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000375957612
  error estimate for blocks of size 2^( 2) =       0.000389506930
  error estimate for blocks of size 2^( 3) =       0.000401927212
  error estimate for blocks of size 2^( 4) =       0.000411000548
  error estimate for blocks of size 2^( 5) =       0.000415949236
  error estimate for blocks of size 2^( 6) =       0.000417585310
  error estimate for blocks of size 2^( 7) =       0.000418041624

      target function =      -0.939942807389
              le_mean =     -17.211342534415
             les_mean =     296.512999947414
             stat err =       0.000415644179
             autocorr =       1.222265749027
   target nu stat err =       0.000415644179
   target dn stat err =       0.006241668906
      target stat err =       0.010684041137
              std dev =       0.531684353550
             le_variance =       0.282688251809


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721134253441e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+29, overlap shift 9.3132e+30 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940064164870       residual = 2.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940064164870       residual = 2.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+29 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+30, overlap shift 3.7253e+31 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940064164870       residual = 2.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940064164870       residual = 2.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+30 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+31, overlap shift 1.4901e+32 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.940064164870       residual = 2.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.940064164870       residual = 2.35e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+31 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.754075 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5658e+01
  </log>
  <optVariables href="H2O.s053.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 53
    time step          = 0.05
    reference energy   = -17.265
    reference variance = 0.226887
====================================================
  Execution time = 2.0111e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s053
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7846e-01
  Total weights = 2.0000e+06
  Execution time = 1.8144e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278490027794
                                         uncertainty =       0.002935025524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278490027794
                                         uncertainty =       0.002935025524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373135486
  error estimate for blocks of size 2^( 2) =       0.000386875444
  error estimate for blocks of size 2^( 3) =       0.000399201026
  error estimate for blocks of size 2^( 4) =       0.000408155578
  error estimate for blocks of size 2^( 5) =       0.000414214339
  error estimate for blocks of size 2^( 6) =       0.000417181249
  error estimate for blocks of size 2^( 7) =       0.000418292729

      target function =      -0.947285405474
              le_mean =     -17.212115906845
             les_mean =     296.535394033182
             stat err =       0.000414460974
             autocorr =       1.233769924147
   target nu stat err =       0.000414460974
   target dn stat err =       0.002884201541
      target stat err =       0.005066147801
              std dev =       0.527693264836
             le_variance =       0.278460181754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278490027794
                                         uncertainty =       0.002935025524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278490027794
                                         uncertainty =       0.002935025524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373135486
  error estimate for blocks of size 2^( 2) =       0.000386875444
  error estimate for blocks of size 2^( 3) =       0.000399201026
  error estimate for blocks of size 2^( 4) =       0.000408155578
  error estimate for blocks of size 2^( 5) =       0.000414214339
  error estimate for blocks of size 2^( 6) =       0.000417181249
  error estimate for blocks of size 2^( 7) =       0.000418292729

      target function =      -0.947285405474
              le_mean =     -17.212115906845
             les_mean =     296.535394033182
             stat err =       0.000414460974
             autocorr =       1.233769924147
   target nu stat err =       0.000414460974
   target dn stat err =       0.002884201541
      target stat err =       0.005066147801
              std dev =       0.527693264836
             le_variance =       0.278460181754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278490027794
                                         uncertainty =       0.002935025524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278490027794
                                         uncertainty =       0.002935025524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373135486
  error estimate for blocks of size 2^( 2) =       0.000386875444
  error estimate for blocks of size 2^( 3) =       0.000399201026
  error estimate for blocks of size 2^( 4) =       0.000408155578
  error estimate for blocks of size 2^( 5) =       0.000414214339
  error estimate for blocks of size 2^( 6) =       0.000417181249
  error estimate for blocks of size 2^( 7) =       0.000418292729

      target function =      -0.947285405474
              le_mean =     -17.212115906845
             les_mean =     296.535394033182
             stat err =       0.000414460974
             autocorr =       1.233769924147
   target nu stat err =       0.000414460974
   target dn stat err =       0.002884201541
      target stat err =       0.005066147801
              std dev =       0.527693264836
             le_variance =       0.278460181754

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278490027794
                                         uncertainty =       0.002935025524

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278490027794
                                         uncertainty =       0.002935025524

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373135486
  error estimate for blocks of size 2^( 2) =       0.000386875444
  error estimate for blocks of size 2^( 3) =       0.000399201026
  error estimate for blocks of size 2^( 4) =       0.000408155578
  error estimate for blocks of size 2^( 5) =       0.000414214339
  error estimate for blocks of size 2^( 6) =       0.000417181249
  error estimate for blocks of size 2^( 7) =       0.000418292729

      target function =      -0.947285405474
              le_mean =     -17.212115906845
             les_mean =     296.535394033182
             stat err =       0.000414460974
             autocorr =       1.233769924147
   target nu stat err =       0.000414460974
   target dn stat err =       0.002884201541
      target stat err =       0.005066147801
              std dev =       0.527693264836
             le_variance =       0.278460181754


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947285405474        initial  <--
     9.3132e+29     9.3132e+30             0.0000e+00        -0.947285405474
     3.7253e+30     3.7253e+31             0.0000e+00        -0.947285405474
     1.4901e+31     1.4901e+32             0.0000e+00        -0.947285405474

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.3134
  </log>
  <optVariables href="H2O.s053.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4978e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s054 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s054 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=54  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7202e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.2239
    reference variance = 0.140818
====================================================
  Execution time = 2.0286e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s054
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8605e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5033e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286126703393
                                         uncertainty =       0.004728125501

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.286126703393
                                         uncertainty =       0.004728125501

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000378185502
  error estimate for blocks of size 2^( 2) =       0.000391999962
  error estimate for blocks of size 2^( 3) =       0.000404362960
  error estimate for blocks of size 2^( 4) =       0.000413513772
  error estimate for blocks of size 2^( 5) =       0.000419495249
  error estimate for blocks of size 2^( 6) =       0.000423624208
  error estimate for blocks of size 2^( 7) =       0.000424196043

      target function =      -0.934250990435
              le_mean =     -17.211823842680
             les_mean =     296.532928396475
             stat err =       0.000420207318
             autocorr =       1.234574977098
   target nu stat err =       0.000420207318
   target dn stat err =       0.005176282041
      target stat err =       0.008772204556
              std dev =       0.534835066213
             le_variance =       0.286048548051


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721182384268e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+30, overlap shift 9.3132e+31 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934331666811       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934331666811       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934331666811       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934331666811       residual = 7.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+30 is 2.990119e-35

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+31, overlap shift 3.7253e+32 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934331666811       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934331666811       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934331666811       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934331666811       residual = 7.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4 stopping due to too large eigenvalue change
davidson solver did not converge after          4 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+31 is 7.475296e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+32, overlap shift 1.4901e+33 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.934331666811       residual = 1.31e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.934331666811       residual = 2.33e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.934331666811       residual = 1.29e-03           smallest_sin_value = 1.00e+00
davidson iteration    3:   krylov dim =   4   tar_fn =      -0.934331666811       residual = 7.50e-04           smallest_sin_value = 1.00e+00
davidson iteration    4:   krylov dim =   5   tar_fn =      -0.934331893921       residual = 1.08e+02           smallest_sin_value = 1.00e+00
davidson iteration    5 stopping due to too large eigenvalue change
davidson solver did not converge after          5 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+32 is 1.868824e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.755801 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5803e+01
  </log>
  <optVariables href="H2O.s054.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 54
    time step          = 0.05
    reference energy   = -17.208
    reference variance = 0.17777
====================================================
  Execution time = 1.9832e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s054
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7671e-01
  Total weights = 2.0000e+06
  Execution time = 1.8031e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276699214765
                                         uncertainty =       0.002122013801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276699214765
                                         uncertainty =       0.002122013801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371958319
  error estimate for blocks of size 2^( 2) =       0.000385910438
  error estimate for blocks of size 2^( 3) =       0.000398686236
  error estimate for blocks of size 2^( 4) =       0.000407323990
  error estimate for blocks of size 2^( 5) =       0.000412998184
  error estimate for blocks of size 2^( 6) =       0.000415276211
  error estimate for blocks of size 2^( 7) =       0.000415570264

      target function =      -0.950349947738
              le_mean =     -17.212220910429
             les_mean =     296.537254513218
             stat err =       0.000412792162
             autocorr =       1.231613194452
   target nu stat err =       0.000412792162
   target dn stat err =       0.002145038818
      target stat err =       0.003826146069
              std dev =       0.526028499384
             le_variance =       0.276705982165

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276699214765
                                         uncertainty =       0.002122013801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276699214765
                                         uncertainty =       0.002122013801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371958319
  error estimate for blocks of size 2^( 2) =       0.000385910438
  error estimate for blocks of size 2^( 3) =       0.000398686236
  error estimate for blocks of size 2^( 4) =       0.000407323990
  error estimate for blocks of size 2^( 5) =       0.000412998184
  error estimate for blocks of size 2^( 6) =       0.000415276211
  error estimate for blocks of size 2^( 7) =       0.000415570264

      target function =      -0.950349947738
              le_mean =     -17.212220910429
             les_mean =     296.537254513218
             stat err =       0.000412792162
             autocorr =       1.231613194452
   target nu stat err =       0.000412792162
   target dn stat err =       0.002145038818
      target stat err =       0.003826146069
              std dev =       0.526028499384
             le_variance =       0.276705982165

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276699214765
                                         uncertainty =       0.002122013801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276699214765
                                         uncertainty =       0.002122013801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371958319
  error estimate for blocks of size 2^( 2) =       0.000385910438
  error estimate for blocks of size 2^( 3) =       0.000398686236
  error estimate for blocks of size 2^( 4) =       0.000407323990
  error estimate for blocks of size 2^( 5) =       0.000412998184
  error estimate for blocks of size 2^( 6) =       0.000415276211
  error estimate for blocks of size 2^( 7) =       0.000415570264

      target function =      -0.950349947738
              le_mean =     -17.212220910429
             les_mean =     296.537254513218
             stat err =       0.000412792162
             autocorr =       1.231613194452
   target nu stat err =       0.000412792162
   target dn stat err =       0.002145038818
      target stat err =       0.003826146069
              std dev =       0.526028499384
             le_variance =       0.276705982165

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276699214765
                                         uncertainty =       0.002122013801

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276699214765
                                         uncertainty =       0.002122013801

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371958319
  error estimate for blocks of size 2^( 2) =       0.000385910438
  error estimate for blocks of size 2^( 3) =       0.000398686236
  error estimate for blocks of size 2^( 4) =       0.000407323990
  error estimate for blocks of size 2^( 5) =       0.000412998184
  error estimate for blocks of size 2^( 6) =       0.000415276211
  error estimate for blocks of size 2^( 7) =       0.000415570264

      target function =      -0.950349947738
              le_mean =     -17.212220910429
             les_mean =     296.537254513218
             stat err =       0.000412792162
             autocorr =       1.231613194452
   target nu stat err =       0.000412792162
   target dn stat err =       0.002145038818
      target stat err =       0.003826146069
              std dev =       0.526028499384
             le_variance =       0.276705982165


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.950349947738        initial  <--
     9.3132e+30     9.3132e+31             2.9901e-35        -0.950349947738
     3.7253e+31     3.7253e+32             7.4753e-36        -0.950349947738
     1.4901e+32     1.4901e+33             1.8688e-36        -0.950349947738

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.0102
  </log>
  <optVariables href="H2O.s054.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4819e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s055 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s055 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=55  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.2083
    reference variance = 0.166409
====================================================
  Execution time = 2.2474e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s055
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7919e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5791e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279251615535
                                         uncertainty =       0.002252410639

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.279251615535
                                         uncertainty =       0.002252410639

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373626813
  error estimate for blocks of size 2^( 2) =       0.000387117562
  error estimate for blocks of size 2^( 3) =       0.000399393296
  error estimate for blocks of size 2^( 4) =       0.000407991779
  error estimate for blocks of size 2^( 5) =       0.000413783976
  error estimate for blocks of size 2^( 6) =       0.000416138402
  error estimate for blocks of size 2^( 7) =       0.000417061418

      target function =      -0.946018612169
              le_mean =     -17.212153874672
             les_mean =     296.537434856776
             stat err =       0.000413743894
             autocorr =       1.226272880870
   target nu stat err =       0.000413743894
   target dn stat err =       0.002446845074
      target stat err =       0.004305400512
              std dev =       0.528388106418
             le_variance =       0.279193991004


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721215387467e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+31, overlap shift 9.3132e+32 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946037260131       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946037260131       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946037260131       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+31 is 1.306215e-36

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+32, overlap shift 3.7253e+33 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946037260131       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946037260131       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946037260131       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+32 is 3.265538e-37

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+33, overlap shift 1.4901e+34 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.946037260131       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.946037260131       residual = 1.31e-03           smallest_sin_value = 1.00e+00
davidson iteration    2:   krylov dim =   3   tar_fn =      -0.946037260131       residual = 1.16e-02           smallest_sin_value = 1.00e+00
davidson iteration    3 stopping due to too large eigenvalue change
davidson solver did not converge after          3 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+33 is 8.163845e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.757142 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.8065e+01
  </log>
  <optVariables href="H2O.s055.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 55
    time step          = 0.05
    reference energy   = -17.2391
    reference variance = 0.271448
====================================================
  Execution time = 1.9825e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s055
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.8031e-01
  Total weights = 2.0000e+06
  Execution time = 1.7988e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280361324000
                                         uncertainty =       0.002774657879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280361324000
                                         uncertainty =       0.002774657879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374373395
  error estimate for blocks of size 2^( 2) =       0.000387957020
  error estimate for blocks of size 2^( 3) =       0.000400355146
  error estimate for blocks of size 2^( 4) =       0.000409094799
  error estimate for blocks of size 2^( 5) =       0.000414387975
  error estimate for blocks of size 2^( 6) =       0.000418058849
  error estimate for blocks of size 2^( 7) =       0.000419337385

      target function =      -0.944082966087
              le_mean =     -17.212114699383
             les_mean =     296.537203161825
             stat err =       0.000415219752
             autocorr =       1.230115963829
   target nu stat err =       0.000415219752
   target dn stat err =       0.002868118304
      target stat err =       0.005005106633
              std dev =       0.529443932117
             le_variance =       0.280310877255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280361324000
                                         uncertainty =       0.002774657879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280361324000
                                         uncertainty =       0.002774657879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374373395
  error estimate for blocks of size 2^( 2) =       0.000387957020
  error estimate for blocks of size 2^( 3) =       0.000400355146
  error estimate for blocks of size 2^( 4) =       0.000409094799
  error estimate for blocks of size 2^( 5) =       0.000414387975
  error estimate for blocks of size 2^( 6) =       0.000418058849
  error estimate for blocks of size 2^( 7) =       0.000419337385

      target function =      -0.944082966087
              le_mean =     -17.212114699383
             les_mean =     296.537203161825
             stat err =       0.000415219752
             autocorr =       1.230115963829
   target nu stat err =       0.000415219752
   target dn stat err =       0.002868118304
      target stat err =       0.005005106633
              std dev =       0.529443932117
             le_variance =       0.280310877255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280361324000
                                         uncertainty =       0.002774657879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280361324000
                                         uncertainty =       0.002774657879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374373395
  error estimate for blocks of size 2^( 2) =       0.000387957020
  error estimate for blocks of size 2^( 3) =       0.000400355146
  error estimate for blocks of size 2^( 4) =       0.000409094799
  error estimate for blocks of size 2^( 5) =       0.000414387975
  error estimate for blocks of size 2^( 6) =       0.000418058849
  error estimate for blocks of size 2^( 7) =       0.000419337385

      target function =      -0.944082966087
              le_mean =     -17.212114699383
             les_mean =     296.537203161825
             stat err =       0.000415219752
             autocorr =       1.230115963829
   target nu stat err =       0.000415219752
   target dn stat err =       0.002868118304
      target stat err =       0.005005106633
              std dev =       0.529443932117
             le_variance =       0.280310877255

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280361324000
                                         uncertainty =       0.002774657879

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.280361324000
                                         uncertainty =       0.002774657879

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374373395
  error estimate for blocks of size 2^( 2) =       0.000387957020
  error estimate for blocks of size 2^( 3) =       0.000400355146
  error estimate for blocks of size 2^( 4) =       0.000409094799
  error estimate for blocks of size 2^( 5) =       0.000414387975
  error estimate for blocks of size 2^( 6) =       0.000418058849
  error estimate for blocks of size 2^( 7) =       0.000419337385

      target function =      -0.944082966087
              le_mean =     -17.212114699383
             les_mean =     296.537203161825
             stat err =       0.000415219752
             autocorr =       1.230115963829
   target nu stat err =       0.000415219752
   target dn stat err =       0.002868118304
      target stat err =       0.005005106633
              std dev =       0.529443932117
             le_variance =       0.280310877255


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.944082966087        initial  <--
     9.3132e+31     9.3132e+32             1.3062e-36        -0.944082966087
     3.7253e+32     3.7253e+33             3.2655e-37        -0.944082966087
     1.4901e+33     1.4901e+34             8.1638e-38        -0.944082966087

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9321
  </log>
  <optVariables href="H2O.s055.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.7003e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s056 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s056 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=56  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7203e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.2512
    reference variance = 0.228254
====================================================
  Execution time = 2.0510e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s056
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 3.1644e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5299e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316548531224
                                         uncertainty =       0.030642655975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.316548531224
                                         uncertainty =       0.030642655975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000397771074
  error estimate for blocks of size 2^( 2) =       0.000410532465
  error estimate for blocks of size 2^( 3) =       0.000422534056
  error estimate for blocks of size 2^( 4) =       0.000430532626
  error estimate for blocks of size 2^( 5) =       0.000436301513
  error estimate for blocks of size 2^( 6) =       0.000440669121
  error estimate for blocks of size 2^( 7) =       0.000442525014

      target function =      -0.883095465645
              le_mean =     -17.212610371556
             les_mean =     296.590399299627
             stat err =       0.000437507068
             autocorr =       1.209772620897
   target nu stat err =       0.000437507068
   target dn stat err =       0.030931312172
      target stat err =       0.046863807072
              std dev =       0.562533247771
             le_variance =       0.316443654848


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721261037156e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+32, overlap shift 9.3132e+33 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.885567964900       residual = 8.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.885567964900       residual = 8.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+32 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+33, overlap shift 3.7253e+34 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.885567964900       residual = 8.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.885567964900       residual = 8.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+33 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+34, overlap shift 1.4901e+35 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.885567964900       residual = 8.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.885567964900       residual = 8.96e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.758231 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6052e+01
  </log>
  <optVariables href="H2O.s056.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 56
    time step          = 0.05
    reference energy   = -17.238
    reference variance = 0.151755
====================================================
  Execution time = 1.9816e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s056
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7829e-01
  Total weights = 2.0000e+06
  Execution time = 1.8069e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278331951477
                                         uncertainty =       0.003322911661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278331951477
                                         uncertainty =       0.003322911661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373022555
  error estimate for blocks of size 2^( 2) =       0.000386295979
  error estimate for blocks of size 2^( 3) =       0.000398252638
  error estimate for blocks of size 2^( 4) =       0.000407630136
  error estimate for blocks of size 2^( 5) =       0.000412432624
  error estimate for blocks of size 2^( 6) =       0.000414613608
  error estimate for blocks of size 2^( 7) =       0.000415257845

      target function =      -0.947568342818
              le_mean =     -17.212098152597
             les_mean =     296.534614329072
             stat err =       0.000412483553
             autocorr =       1.222765249531
   target nu stat err =       0.000412483553
   target dn stat err =       0.003407707504
      target stat err =       0.005969504661
              std dev =       0.527533556821
             le_variance =       0.278291653572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278331951477
                                         uncertainty =       0.003322911661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278331951477
                                         uncertainty =       0.003322911661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373022555
  error estimate for blocks of size 2^( 2) =       0.000386295979
  error estimate for blocks of size 2^( 3) =       0.000398252638
  error estimate for blocks of size 2^( 4) =       0.000407630136
  error estimate for blocks of size 2^( 5) =       0.000412432624
  error estimate for blocks of size 2^( 6) =       0.000414613608
  error estimate for blocks of size 2^( 7) =       0.000415257845

      target function =      -0.947568342818
              le_mean =     -17.212098152597
             les_mean =     296.534614329072
             stat err =       0.000412483553
             autocorr =       1.222765249531
   target nu stat err =       0.000412483553
   target dn stat err =       0.003407707504
      target stat err =       0.005969504661
              std dev =       0.527533556821
             le_variance =       0.278291653572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278331951477
                                         uncertainty =       0.003322911661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278331951477
                                         uncertainty =       0.003322911661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373022555
  error estimate for blocks of size 2^( 2) =       0.000386295979
  error estimate for blocks of size 2^( 3) =       0.000398252638
  error estimate for blocks of size 2^( 4) =       0.000407630136
  error estimate for blocks of size 2^( 5) =       0.000412432624
  error estimate for blocks of size 2^( 6) =       0.000414613608
  error estimate for blocks of size 2^( 7) =       0.000415257845

      target function =      -0.947568342818
              le_mean =     -17.212098152597
             les_mean =     296.534614329072
             stat err =       0.000412483553
             autocorr =       1.222765249531
   target nu stat err =       0.000412483553
   target dn stat err =       0.003407707504
      target stat err =       0.005969504661
              std dev =       0.527533556821
             le_variance =       0.278291653572

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278331951477
                                         uncertainty =       0.003322911661

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278331951477
                                         uncertainty =       0.003322911661

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373022555
  error estimate for blocks of size 2^( 2) =       0.000386295979
  error estimate for blocks of size 2^( 3) =       0.000398252638
  error estimate for blocks of size 2^( 4) =       0.000407630136
  error estimate for blocks of size 2^( 5) =       0.000412432624
  error estimate for blocks of size 2^( 6) =       0.000414613608
  error estimate for blocks of size 2^( 7) =       0.000415257845

      target function =      -0.947568342818
              le_mean =     -17.212098152597
             les_mean =     296.534614329072
             stat err =       0.000412483553
             autocorr =       1.222765249531
   target nu stat err =       0.000412483553
   target dn stat err =       0.003407707504
      target stat err =       0.005969504661
              std dev =       0.527533556821
             le_variance =       0.278291653572


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947568342818        initial  <--
     9.3132e+32     9.3132e+33             0.0000e+00        -0.947568342818
     3.7253e+33     3.7253e+34             0.0000e+00        -0.947568342818
     1.4901e+34     1.4901e+35             0.0000e+00        -0.947568342818

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.9588
  </log>
  <optVariables href="H2O.s056.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5017e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s057 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s057 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=57  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.2145
    reference variance = 0.20063
====================================================
  Execution time = 2.0802e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s057
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7517e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5886e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275172499993
                                         uncertainty =       0.001946269975

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.275172499993
                                         uncertainty =       0.001946269975

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000370924281
  error estimate for blocks of size 2^( 2) =       0.000384735051
  error estimate for blocks of size 2^( 3) =       0.000397026016
  error estimate for blocks of size 2^( 4) =       0.000406703139
  error estimate for blocks of size 2^( 5) =       0.000412212481
  error estimate for blocks of size 2^( 6) =       0.000415118089
  error estimate for blocks of size 2^( 7) =       0.000415968135

      target function =      -0.953061934865
              le_mean =     -17.211668634736
             les_mean =     296.516706699482
             stat err =       0.000412500461
             autocorr =       1.236739830804
   target nu stat err =       0.000412500461
   target dn stat err =       0.001877643817
      target stat err =       0.003384269661
              std dev =       0.524566149403
             le_variance =       0.275169645100


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721166863474e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+33, overlap shift 9.3132e+34 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.953072909063       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.953072909063       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+33 is 1.167873e-38

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+34, overlap shift 3.7253e+35 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.953072909063       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.953072909063       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+34 is 2.919683e-39

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+35, overlap shift 1.4901e+36 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.953072909063       residual = 1.18e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.953072909063       residual = 1.10e-03           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+35 is 7.299209e-40

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.759285 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.6404e+01
  </log>
  <optVariables href="H2O.s057.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 57
    time step          = 0.05
    reference energy   = -17.2181
    reference variance = 0.758379
====================================================
  Execution time = 1.9626e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s057
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7829e-01
  Total weights = 2.0000e+06
  Execution time = 1.8076e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278321795074
                                         uncertainty =       0.002186454916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278321795074
                                         uncertainty =       0.002186454916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373022337
  error estimate for blocks of size 2^( 2) =       0.000386634201
  error estimate for blocks of size 2^( 3) =       0.000399256190
  error estimate for blocks of size 2^( 4) =       0.000408329133
  error estimate for blocks of size 2^( 5) =       0.000413959746
  error estimate for blocks of size 2^( 6) =       0.000416054709
  error estimate for blocks of size 2^( 7) =       0.000416605242

      target function =      -0.947569057586
              le_mean =     -17.212662850564
             les_mean =     296.554053596005
             stat err =       0.000413737207
             autocorr =       1.230210642865
   target nu stat err =       0.000413737207
   target dn stat err =       0.002151179572
      target stat err =       0.003818298158
              std dev =       0.527533248203
             le_variance =       0.278291327960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278321795074
                                         uncertainty =       0.002186454916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278321795074
                                         uncertainty =       0.002186454916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373022337
  error estimate for blocks of size 2^( 2) =       0.000386634201
  error estimate for blocks of size 2^( 3) =       0.000399256190
  error estimate for blocks of size 2^( 4) =       0.000408329133
  error estimate for blocks of size 2^( 5) =       0.000413959746
  error estimate for blocks of size 2^( 6) =       0.000416054709
  error estimate for blocks of size 2^( 7) =       0.000416605242

      target function =      -0.947569057586
              le_mean =     -17.212662850564
             les_mean =     296.554053596005
             stat err =       0.000413737207
             autocorr =       1.230210642865
   target nu stat err =       0.000413737207
   target dn stat err =       0.002151179572
      target stat err =       0.003818298158
              std dev =       0.527533248203
             le_variance =       0.278291327960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278321795074
                                         uncertainty =       0.002186454916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278321795074
                                         uncertainty =       0.002186454916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373022337
  error estimate for blocks of size 2^( 2) =       0.000386634201
  error estimate for blocks of size 2^( 3) =       0.000399256190
  error estimate for blocks of size 2^( 4) =       0.000408329133
  error estimate for blocks of size 2^( 5) =       0.000413959746
  error estimate for blocks of size 2^( 6) =       0.000416054709
  error estimate for blocks of size 2^( 7) =       0.000416605242

      target function =      -0.947569057586
              le_mean =     -17.212662850564
             les_mean =     296.554053596005
             stat err =       0.000413737207
             autocorr =       1.230210642865
   target nu stat err =       0.000413737207
   target dn stat err =       0.002151179572
      target stat err =       0.003818298158
              std dev =       0.527533248203
             le_variance =       0.278291327960

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278321795074
                                         uncertainty =       0.002186454916

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.278321795074
                                         uncertainty =       0.002186454916

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000373022337
  error estimate for blocks of size 2^( 2) =       0.000386634201
  error estimate for blocks of size 2^( 3) =       0.000399256190
  error estimate for blocks of size 2^( 4) =       0.000408329133
  error estimate for blocks of size 2^( 5) =       0.000413959746
  error estimate for blocks of size 2^( 6) =       0.000416054709
  error estimate for blocks of size 2^( 7) =       0.000416605242

      target function =      -0.947569057586
              le_mean =     -17.212662850564
             les_mean =     296.554053596005
             stat err =       0.000413737207
             autocorr =       1.230210642865
   target nu stat err =       0.000413737207
   target dn stat err =       0.002151179572
      target stat err =       0.003818298158
              std dev =       0.527533248203
             le_variance =       0.278291327960


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.947569057586        initial  <--
     9.3132e+33     9.3132e+34             1.1679e-38        -0.947569057586
     3.7253e+34     3.7253e+35             2.9197e-39        -0.947569057586
     1.4901e+35     1.4901e+36             7.2992e-40        -0.947569057586

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 28.7739
  </log>
  <optVariables href="H2O.s057.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5184e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s058 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s058 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=58  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2174
    reference variance = 0.166438
====================================================
  Execution time = 2.0389e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s058
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8763e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.5571e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287683044080
                                         uncertainty =       0.004978124466

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.287683044080
                                         uncertainty =       0.004978124466

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000379227780
  error estimate for blocks of size 2^( 2) =       0.000392712346
  error estimate for blocks of size 2^( 3) =       0.000404685830
  error estimate for blocks of size 2^( 4) =       0.000413348632
  error estimate for blocks of size 2^( 5) =       0.000418806206
  error estimate for blocks of size 2^( 6) =       0.000422940069
  error estimate for blocks of size 2^( 7) =       0.000423616521

      target function =      -0.931546048450
              le_mean =     -17.212581904286
             les_mean =     296.560603085978
             stat err =       0.000419677857
             autocorr =       1.224705939309
   target nu stat err =       0.000419677857
   target dn stat err =       0.005016216251
      target stat err =       0.008466327093
              std dev =       0.536309069511
             le_variance =       0.287627418040


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721258190429e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+34, overlap shift 9.3132e+35 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931622314745       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931622314745       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+34 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+35, overlap shift 3.7253e+36 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931622314745       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931622314745       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+36, overlap shift 1.4901e+37 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.931622314745       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.931622314745       residual = 2.56e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.760325 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5958e+01
  </log>
  <optVariables href="H2O.s058.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 58
    time step          = 0.05
    reference energy   = -17.2485
    reference variance = 0.64574
====================================================
  Execution time = 1.9957e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s058
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7212e+01
  VMC Evar = 2.7660e-01
  Total weights = 2.0000e+06
  Execution time = 1.8144e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276361962069
                                         uncertainty =       0.003868506191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276361962069
                                         uncertainty =       0.003868506191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371890458
  error estimate for blocks of size 2^( 2) =       0.000385206442
  error estimate for blocks of size 2^( 3) =       0.000397168307
  error estimate for blocks of size 2^( 4) =       0.000405719522
  error estimate for blocks of size 2^( 5) =       0.000411010592
  error estimate for blocks of size 2^( 6) =       0.000414020333
  error estimate for blocks of size 2^( 7) =       0.000416675071

      target function =      -0.950507093011
              le_mean =     -17.211729578020
             les_mean =     296.520239953973
             stat err =       0.000411856379
             autocorr =       1.226482974661
   target nu stat err =       0.000411856379
   target dn stat err =       0.003932572111
      target stat err =       0.006912641667
              std dev =       0.525932529326
             le_variance =       0.276605025404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276361962069
                                         uncertainty =       0.003868506191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276361962069
                                         uncertainty =       0.003868506191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371890458
  error estimate for blocks of size 2^( 2) =       0.000385206442
  error estimate for blocks of size 2^( 3) =       0.000397168307
  error estimate for blocks of size 2^( 4) =       0.000405719522
  error estimate for blocks of size 2^( 5) =       0.000411010592
  error estimate for blocks of size 2^( 6) =       0.000414020333
  error estimate for blocks of size 2^( 7) =       0.000416675071

      target function =      -0.950507093011
              le_mean =     -17.211729578020
             les_mean =     296.520239953973
             stat err =       0.000411856379
             autocorr =       1.226482974661
   target nu stat err =       0.000411856379
   target dn stat err =       0.003932572111
      target stat err =       0.006912641667
              std dev =       0.525932529326
             le_variance =       0.276605025404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276361962069
                                         uncertainty =       0.003868506191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276361962069
                                         uncertainty =       0.003868506191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371890458
  error estimate for blocks of size 2^( 2) =       0.000385206442
  error estimate for blocks of size 2^( 3) =       0.000397168307
  error estimate for blocks of size 2^( 4) =       0.000405719522
  error estimate for blocks of size 2^( 5) =       0.000411010592
  error estimate for blocks of size 2^( 6) =       0.000414020333
  error estimate for blocks of size 2^( 7) =       0.000416675071

      target function =      -0.950507093011
              le_mean =     -17.211729578020
             les_mean =     296.520239953973
             stat err =       0.000411856379
             autocorr =       1.226482974661
   target nu stat err =       0.000411856379
   target dn stat err =       0.003932572111
      target stat err =       0.006912641667
              std dev =       0.525932529326
             le_variance =       0.276605025404

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276361962069
                                         uncertainty =       0.003868506191

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276361962069
                                         uncertainty =       0.003868506191

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371890458
  error estimate for blocks of size 2^( 2) =       0.000385206442
  error estimate for blocks of size 2^( 3) =       0.000397168307
  error estimate for blocks of size 2^( 4) =       0.000405719522
  error estimate for blocks of size 2^( 5) =       0.000411010592
  error estimate for blocks of size 2^( 6) =       0.000414020333
  error estimate for blocks of size 2^( 7) =       0.000416675071

      target function =      -0.950507093011
              le_mean =     -17.211729578020
             les_mean =     296.520239953973
             stat err =       0.000411856379
             autocorr =       1.226482974661
   target nu stat err =       0.000411856379
   target dn stat err =       0.003932572111
      target stat err =       0.006912641667
              std dev =       0.525932529326
             le_variance =       0.276605025404


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.950507093011        initial  <--
     9.3132e+34     9.3132e+35             0.0000e+00        -0.950507093011
     3.7253e+35     3.7253e+36             0.0000e+00        -0.950507093011
     1.4901e+36     1.4901e+37             0.0000e+00        -0.950507093011

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1510
  </log>
  <optVariables href="H2O.s058.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.5115e+01 secs
  Reusing QMCFixedSampleLinearOptimize
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>

=========================================================
  Start QMCFixedSampleLinearOptimize
  File Root H2O.s059 append = no 
=========================================================
  Skip QMCDriver::putQMCInfo 
  Resetting Properties of the walkers 1 x 15

=========================================================
  Start VMC
  File Root H2O.s059 append = no 
=========================================================
Using existing walkers 
  Resetting Properties of the walkers 1 x 15

<vmc function="put">
  qmc_counter=59  my_counter=0
  time step      = 5.0000e-02
  blocks         = 125
  steps          = 125
  substeps       = 10
  current        = 0
  target samples = 2.0000e+06
  walkers/mpi    = 1

  stepsbetweensamples = 1
<parameter name="blocks" condition="int">125</parameter>
<parameter name="blocks_between_recompute" condition="int">0</parameter>
<parameter name="check_properties" condition="int">100</parameter>
<parameter name="checkproperties" condition="int">100</parameter>
<parameter name="current" condition="int">0</parameter>
<parameter name="dmcwalkersperthread" condition="real">1.5625e+04</parameter>
<parameter name="fermionicweight" condition="real">1.0000e-04</parameter>
<parameter name="jastrowweight" condition="real">0.0000e+00</parameter>
<parameter name="maxcpusecs" condition="real">3.6000e+05</parameter>
<parameter name="mg_beta" condition="real">0.0000e+00</parameter>
<parameter name="mg_gamma" condition="real">0.0000e+00</parameter>
<parameter name="modifiedguiding" condition="string">ParameterDerivativeAdjusted</parameter>
<parameter name="orboptweight" condition="real">0.0000e+00</parameter>
<parameter name="record_configs" condition="int">0</parameter>
<parameter name="record_walkers" condition="int">1</parameter>
<parameter name="recordconfigs" condition="int">0</parameter>
<parameter name="recordwalkers" condition="int">1</parameter>
<parameter name="rewind" condition="int">0</parameter>
<parameter name="samples" condition="real">2.0000e+06</parameter>
<parameter name="samplesperthread" condition="real">1.5625e+04</parameter>
<parameter name="steps" condition="int">125</parameter>
<parameter name="stepsbetweensamples" condition="int">1</parameter>
<parameter name="store_configs" condition="int">0</parameter>
<parameter name="storeconfigs" condition="int">0</parameter>
<parameter name="sub_steps" condition="int">10</parameter>
<parameter name="substeps" condition="int">10</parameter>
<parameter name="tau" condition="au">5.0000e-02</parameter>
<parameter name="time_step" condition="au">5.0000e-02</parameter>
<parameter name="timestep" condition="au">5.0000e-02</parameter>
<parameter name="use_drift" condition="string">no</parameter>
<parameter name="usedrift" condition="string">no</parameter>
<parameter name="walkers" condition="int">1</parameter>
<parameter name="warmup_steps" condition="int">1000</parameter>
<parameter name="warmupsteps" condition="int">1000</parameter>
  DumpConfig==false Nothing (configurations, state) will be saved.
  Walker Samples are dumped every 1 steps.
</vmc>
    Restarting, cummulative properties:
      energy     = -1.7204e+01
      variance   = 0.0000e+00
      r2accepted = 1.0000e-10
      r2proposed = 1.0000e-10
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
 Using QMCCostFunction::QMCCostFunction
   Going to include the derivatives of NonLocalECP
 Using Default Cost Function: Cost = <|E-E_ff|^2>
  Set drift_modifier UNR parameter a = 1.0000e+00
  EstimatorManagerBase::add replace LocalEnergy estimator.
  EstimatorManagerBase::add replace LocalEnergy estimator.
Double check: filter_param_: false and ratio_threshold_: 0.0000e+00
Now doing initialize, nblock: 1, nkeps: 1
Start of engine's reset
Before block part of reset
end of engine's reset
entering engine_start function
<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
Using ParameterDeriv Adjusted Guiding Function

  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
  Anonymous Buffer size per walker : 16008 Bytes.
MEMORY increase 0 MB VMC::resetRun
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.2005
    reference variance = 0.24473
====================================================
  Execution time = 2.0097e+01
</vmc>
<opt stage="setup">
  <log>
     Reading configurations from h5FileRoot H2O.s059
  QMCCostFunction is created with 1 threads.
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
Value of Filter Bool: false before_first_block_sample: true onDescentStep: false
Before engine_checkConfigurations
Double check filter inside engine_checkConfig: false
 w_tot 1.5625e+04
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.8120e-01
  Total weights = 2.000000000e+06
Before sample_finish
calling setComputed function
After engine_checkConfig
  Execution time = 5.6390e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281209704308
                                         uncertainty =       0.003319568667

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.281209704308
                                         uncertainty =       0.003319568667

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000374965748
  error estimate for blocks of size 2^( 2) =       0.000388137620
  error estimate for blocks of size 2^( 3) =       0.000400501284
  error estimate for blocks of size 2^( 4) =       0.000409835900
  error estimate for blocks of size 2^( 5) =       0.000415403798
  error estimate for blocks of size 2^( 6) =       0.000419011946
  error estimate for blocks of size 2^( 7) =       0.000422092229

      target function =      -0.942507159584
              le_mean =     -17.212904243054
             les_mean =     296.565270964198
             stat err =       0.000416585968
             autocorr =       1.234315205217
   target nu stat err =       0.000416585968
   target dn stat err =       0.003310258109
      target stat err =       0.005750232676
              std dev =       0.530281646157
             le_variance =       0.281198624250


*************************************************************************************************
Solving the linear method equations on the initial sample with initial energy -1.721290424305e+01
*************************************************************************************************


*********************************************************
Solving the linear method equations on the initial sample
*********************************************************

Inside this version of call_engine, dep_ptr->n_tot(): 50
Check correct_vf_var_size: 153, current size: 0
Inside version of engine_update_build_matrix that takes matrices hh and ss as input
solving harmonic davidson linear method for identity shift 9.3132e+35, overlap shift 9.3132e+36 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942541067535       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942541067535       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 9.3132e+35 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 3.7253e+36, overlap shift 3.7253e+37 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942541067535       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942541067535       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 3.7253e+36 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

solving harmonic davidson linear method for identity shift 1.4901e+37, overlap shift 1.4901e+38 and omega -1.7729e+01

iteration solving starts here(engine) 


davidson iteration    0:   krylov dim =   1   tar_fn =      -0.942541067535       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    1:   krylov dim =   2   tar_fn =      -0.942541067535       residual = 1.52e-02           smallest_sin_value = 1.00e+00
davidson iteration    2 stopping due to too large eigenvalue change
davidson solver did not converge after          2 iterations

On rank 0, check n_tot: 51 and evec_eigen.size(): 51
The largest weight on the derivative vector for shift 1.4901e+37 is 0.000000e+00

The largest weight on derivative vector is too large or it's a bad solve, and this update will not be used

About to broadcast update vector

Printing all timers used during this execution:
  eigen solver                               1.761426 seconds

After print_timers
After EngineObj->wfn_update_compute(), N is: 51 and numParams is: 50

************************************************************
Updating the guiding function with the middle shift's update
************************************************************

  Execution time = 2.5748e+01
  </log>
  <optVariables href="H2O.s059.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>

*************************************************************
Generating a new sample based on the updated guiding function
*************************************************************

<optimization-report>
<vmc stage="main" blocks="125">
  Cannot make clones again. Use existing 1 clones
  Initial partition of walkers 0 1 
  Using Particle by Particle moves
  Walker moves without drift
  Total Sample Size   =2000000
  Walker distribution on root = 0 1 
  Using Locality Approximation
====================================================
  SimpleFixedNodeBranch::finalize after a VMC block
    QMC counter        = 59
    time step          = 0.05
    reference energy   = -17.2677
    reference variance = 0.253056
====================================================
  Execution time = 1.9824e+01
</vmc>
<opt stage="setup">
  <log>
   Reading configurations from h5FileRoot H2O.s059
  Using Nonlocal PP in Opt: NonLocalECP
   Number of samples loaded to each thread : 15625 
  VMC Eavg = -1.7213e+01
  VMC Evar = 2.7637e-01
  Total weights = 2.0000e+06
  Execution time = 1.9252e+00
  </log>
</opt>
<opt stage="main" walkers="15625">
  <log>

******************************************************************
Comparing different shifts' cost function values on updated sample
******************************************************************

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276382264722
                                         uncertainty =       0.002834695944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276382264722
                                         uncertainty =       0.002834695944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371731948
  error estimate for blocks of size 2^( 2) =       0.000385188706
  error estimate for blocks of size 2^( 3) =       0.000397228660
  error estimate for blocks of size 2^( 4) =       0.000406238021
  error estimate for blocks of size 2^( 5) =       0.000412486619
  error estimate for blocks of size 2^( 6) =       0.000415656087
  error estimate for blocks of size 2^( 7) =       0.000416349107

      target function =      -0.950913445562
              le_mean =     -17.212802959828
             les_mean =     296.556954878467
             stat err =       0.000412682459
             autocorr =       1.232458325594
   target nu stat err =       0.000412682459
   target dn stat err =       0.002546354078
      target stat err =       0.004526307217
              std dev =       0.525708362851
             le_variance =       0.276369282771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276382264722
                                         uncertainty =       0.002834695944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276382264722
                                         uncertainty =       0.002834695944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371731948
  error estimate for blocks of size 2^( 2) =       0.000385188706
  error estimate for blocks of size 2^( 3) =       0.000397228660
  error estimate for blocks of size 2^( 4) =       0.000406238021
  error estimate for blocks of size 2^( 5) =       0.000412486619
  error estimate for blocks of size 2^( 6) =       0.000415656087
  error estimate for blocks of size 2^( 7) =       0.000416349107

      target function =      -0.950913445562
              le_mean =     -17.212802959828
             les_mean =     296.556954878467
             stat err =       0.000412682459
             autocorr =       1.232458325594
   target nu stat err =       0.000412682459
   target dn stat err =       0.002546354078
      target stat err =       0.004526307217
              std dev =       0.525708362851
             le_variance =       0.276369282771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276382264722
                                         uncertainty =       0.002834695944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276382264722
                                         uncertainty =       0.002834695944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371731948
  error estimate for blocks of size 2^( 2) =       0.000385188706
  error estimate for blocks of size 2^( 3) =       0.000397228660
  error estimate for blocks of size 2^( 4) =       0.000406238021
  error estimate for blocks of size 2^( 5) =       0.000412486619
  error estimate for blocks of size 2^( 6) =       0.000415656087
  error estimate for blocks of size 2^( 7) =       0.000416349107

      target function =      -0.950913445562
              le_mean =     -17.212802959828
             les_mean =     296.556954878467
             stat err =       0.000412682459
             autocorr =       1.232458325594
   target nu stat err =       0.000412682459
   target dn stat err =       0.002546354078
      target stat err =       0.004526307217
              std dev =       0.525708362851
             le_variance =       0.276369282771

Start of engine's reset
Before block part of reset
end of engine's reset
Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276382264722
                                         uncertainty =       0.002834695944

Now for a blocking analysis of energy uncertainty:

energy and target function accumulation statistics:


Restored printouts from recurive_blocking in energy_target_accu

Crude block analysis of variance gives:     variance =       0.276382264722
                                         uncertainty =       0.002834695944

Now for a blocking analysis of energy uncertainty:

  error estimate for blocks of size 2^( 1) =       0.000371731948
  error estimate for blocks of size 2^( 2) =       0.000385188706
  error estimate for blocks of size 2^( 3) =       0.000397228660
  error estimate for blocks of size 2^( 4) =       0.000406238021
  error estimate for blocks of size 2^( 5) =       0.000412486619
  error estimate for blocks of size 2^( 6) =       0.000415656087
  error estimate for blocks of size 2^( 7) =       0.000416349107

      target function =      -0.950913445562
              le_mean =     -17.212802959828
             les_mean =     296.556954878467
             stat err =       0.000412682459
             autocorr =       1.232458325594
   target nu stat err =       0.000412682459
   target dn stat err =       0.002546354078
      target stat err =       0.004526307217
              std dev =       0.525708362851
             le_variance =       0.276369282771


        shift_i        shift_s       max param change    cost function value
   ------------   ------------   --------------------   --------------------
            N/A            N/A                    N/A        -0.950913445562        initial  <--
     9.3132e+35     9.3132e+36             0.0000e+00        -0.950913445562
     3.7253e+36     3.7253e+37             0.0000e+00        -0.950913445562
     1.4901e+37     1.4901e+38             0.0000e+00        -0.950913445562

***********************************************************
Reverting to old parameters and increasing shift magnitudes
***********************************************************

  Execution time = 29.1191
  </log>
  <optVariables href="H2O.s059.opt.xml">
 uu_0                 1.977335e-01 1 1  ON 0
 uu_1                 4.330275e-02 1 1  ON 1
 uu_2                -4.189267e-02 1 1  ON 2
 uu_3                -9.235608e-02 1 1  ON 3
 uu_4                -1.237610e-01 1 1  ON 4
 uu_5                -1.319011e-01 1 1  ON 5
 uu_6                -1.107245e-01 1 1  ON 6
 uu_7                -4.250637e-02 1 1  ON 7
 uu_8                 8.649074e-02 1 1  ON 8
 uu_9                 1.220586e-01 1 1  ON 9
 ud_0                 3.027539e-01 1 1  ON 10
 ud_1                 7.594091e-02 1 1  ON 11
 ud_2                -1.844949e-02 1 1  ON 12
 ud_3                -6.887856e-02 1 1  ON 13
 ud_4                -1.085322e-01 1 1  ON 14
 ud_5                -1.357271e-01 1 1  ON 15
 ud_6                -1.369140e-01 1 1  ON 16
 ud_7                -9.606118e-02 1 1  ON 17
 ud_8                 1.393232e-03 1 1  ON 18
 ud_9                 9.066699e-02 1 1  ON 19
 eO_0                -6.845925e-01 1 1  ON 20
 eO_1                -4.098450e-01 1 1  ON 21
 eO_2                -4.963899e-02 1 1  ON 22
 eO_3                 1.714430e-01 1 1  ON 23
 eO_4                 2.548074e-01 1 1  ON 24
 eO_5                 2.930546e-01 1 1  ON 25
 eO_6                 2.514179e-01 1 1  ON 26
 eO_7                 1.164920e-01 1 1  ON 27
 eO_8                 2.796077e-02 1 1  ON 28
 eO_9                 1.837741e-02 1 1  ON 29
eH1_0                -1.951983e-01 1 1  ON 30
eH1_1                -9.632854e-02 1 1  ON 31
eH1_2                -4.928336e-02 1 1  ON 32
eH1_3                -1.897920e-02 1 1  ON 33
eH1_4                 1.663156e-02 1 1  ON 34
eH1_5                 2.420856e-02 1 1  ON 35
eH1_6                 7.670269e-02 1 1  ON 36
eH1_7                 1.107286e-01 1 1  ON 37
eH1_8                 9.201372e-02 1 1  ON 38
eH1_9                 2.427304e-02 1 1  ON 39
eH2_0                -1.961719e-01 1 1  ON 40
eH2_1                -9.716667e-02 1 1  ON 41
eH2_2                -5.030255e-02 1 1  ON 42
eH2_3                -2.015281e-02 1 1  ON 43
eH2_4                 1.553497e-02 1 1  ON 44
eH2_5                 2.428197e-02 1 1  ON 45
eH2_6                 7.651160e-02 1 1  ON 46
eH2_7                 1.129216e-01 1 1  ON 47
eH2_8                 9.607113e-02 1 1  ON 48
eH2_9                 2.646776e-02 1 1  ON 49
  </optVariables>
eH1
Array
eH2
Array
eO
Array
ud
Array
uu
Array
   Restore the number of walkers to 1, removing 0 walkers.
</opt>
</optimization-report>
  QMC Execution time = 5.4872e+01 secs
  Total Execution time = 3.3609e+03 secs

=========================================================
  A new xml input file : H2O.s059.cont.xml
